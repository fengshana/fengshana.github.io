<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>âœ¨Fsnâœ¨</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://fengshana.github.io/"/>
  <updated>2020-06-16T00:06:22.840Z</updated>
  <id>https://fengshana.github.io/</id>
  
  <author>
    <name>Fsnâœ¨ğŸ§™â€â™€ï¸âœ¨</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Gradleå…¥é—¨</title>
    <link href="https://fengshana.github.io/2020/06/16/%E3%80%90Gradle%E3%80%91/Gradle%E5%85%A5%E9%97%A8/"/>
    <id>https://fengshana.github.io/2020/06/16/%E3%80%90Gradle%E3%80%91/Gradle%E5%85%A5%E9%97%A8/</id>
    <published>2020-06-15T21:03:11.245Z</published>
    <updated>2020-06-16T00:06:22.840Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è§‚çœ‹ç¬”è®°ï¼š<code>https://www.bilibili.com/video/BV1iW411C7CV?from=search&amp;seid=6869625427262249863</code>ã€‚<br>ç›¸å…³ç¬”è®°æˆªå›¾æ”¾åœ¨qq:198866436çš„ç©ºé—´ç›¸å†Œå½“ä¸­äº†ï¼›</p><h2 id="gradleä»‹ç»01"><a href="#gradleä»‹ç»01" class="headerlink" title="gradleä»‹ç»01"></a>gradleä»‹ç»01</h2><h3 id="è¯¾ç¨‹å¼•å¯¼è¯­"><a href="#è¯¾ç¨‹å¼•å¯¼è¯­" class="headerlink" title="è¯¾ç¨‹å¼•å¯¼è¯­"></a>è¯¾ç¨‹å¼•å¯¼è¯­</h3><p>javaä½œä¸ºä¸€é—¨ä¸–ç•Œçº§ä¸»æµç¼–ç¨‹è¯­è¨€ï¼Œæœ‰ä¸€æ¬¾é«˜æ•ˆæ˜“ç”¨çš„é¡¹ç›®ç®¡ç†å·¥å…·æ˜¯javaå¼€å‘è€…å…±åŒè¿½æ±‚çš„å¿ƒæ„¿å’Œç›®æ ‡ã€‚<br>æ˜¯2000å¹´Antï¼ˆé¡¹ç›®ç®¡ç†å·¥å…·ï¼Œå¾ˆå¥½çš„è§£å†³åœ¨é¡¹ç›®å¼€å‘å½“ä¸­ä¸€ç³»åˆ—ç¹çé—®é¢˜ï¼Œä½†æ˜¯å¥½æ™¯ä¸é•¿ï¼ŒAntåˆæš´éœ²å‡ºäº†å…¶è‡ªèº«çš„ä¸€äº›é—®é¢˜ï¼‰ï¼Œåæœ‰2004å¹´Mavenï¼ˆé¡¹ç›®ç®¡ç†å·¥å…·ï¼Œä½¿ç”¨ç‡éå¸¸é«˜ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨æœ‰ä¸è¶³ä¹‹å¤„ï¼‰ä¸¤ä¸ªå·¥å…·çš„è¯ç”Ÿï¼Œéƒ½åœ¨Javaå¸‚åœºä¸Šå–å¾—äº†å·¨å¤§çš„æˆåŠŸï¼Œä½†æ˜¯äºŒè€…éƒ½æœ‰ä¸€å®šçš„ä¸è¶³å’Œå±€é™æ€§ã€‚</p><p>Mavenå…·æœ‰ä¸¤å¤§ç‰¹æ€§ï¼š</p><ol><li>ç®¡ç†jaråŒ…ï¼ˆæœ€ä¸»è¦çš„åŠŸèƒ½ï¼‰<ul><li>å¦‚ä½•ç®¡ç†jaråŒ…<ul><li>mavenå°†çœŸæ­£çš„jaråŒ…å­˜æ”¾åœ¨ä»“åº“ä¸­ï¼Œé¡¹ç›®ä¸­å­˜æ”¾ç€æ‰€ä¾èµ–çš„jaråŒ…çš„åæ ‡ï¼›è¿™ä¸ªåæ ‡çš„é…ç½®ä½¿ç”¨çš„æ˜¯XMLæ–‡ä»¶æ¥è¿›è¡Œé…ç½®çš„ï¼›éšç€é¡¹ç›®æ‰€ä¾èµ–çš„jaråŒ…è¶Šæ¥è¶Šå¤šï¼ŒXMLæ–‡ä»¶å½“ä¸­çš„åæ ‡ä¹Ÿå°±è¶Šæ¥è¶Šå¤šä»è€Œå¯¼è‡´XMLæ–‡ä»¶è¶Šæ¥è¶Šå¤§ï¼ŒXMLé‡Œé¢çš„å†…å®¹ä¹Ÿå°±ä¼šå˜å¾—è¶Šæ¥è¶Šç¹çï¼Œè¿™ä¸ªå°±æ˜¯å¾ˆå¤šçš„javaå¼€å‘è€…æ‰€ä¸æƒ³çœ‹åˆ°çš„ä¸€ä¸ªç°è±¡ï¼Œè€Œgradleçš„å‡ºç°å°±å¾ˆå¥½çš„å¼¥è¡¥äº†è¿™ä¸€ç¼ºé™·ï¼›gradleä¸ä½¿ç”¨XMLæ¥è¿›è¡Œé…ç½®ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€ç§æ–°çš„è¯­è¨€å«åšGroovyï¼›Groovyæ˜¯ä¸€ç§æ–°çš„ç¼–ç¨‹è¯­è¨€ï¼Œé¦–å…ˆå¯¹javaåšäº†ä¸€ä¸ªå…¨é¢çš„å…¼å®¹ï¼Œä¹Ÿå°±æ˜¯æ‰€æœ‰çš„javaè¯­è¨€åœ¨Groovyç¯å¢ƒä¸‹éƒ½æ˜¯å¯ä»¥è¿›è¡Œæ‰§è¡Œçš„ï¼›å½“ç„¶groovyä¹Ÿæœ‰å¾ˆå¤šå…¶è‡ªå·±çš„ç‰¹æ€§ï¼›ä½¿å¾—ç¼–ç¨‹å˜å¾—æ›´åŠ çš„ç®€å•ï¼›èåˆæ€§ä¹Ÿæ›´åŠ çš„é«˜ï¼›ä¹Ÿå°±æ˜¯è¯´å¦‚æœæƒ³å­¦ä¹ Gradleå°±éœ€è¦å¯¹Groovyè¯­è¨€æœ‰ä¸€ä¸ªå¤§æ¦‚çš„è®¤è¯†ï¼›Gradleå·¥å…·ç°é˜¶æ®µä¸»è¦åº”ç”¨äºJavaåº”ç”¨ï¼›</li></ul></li></ul></li><li>æ„å»ºé¡¹ç›®</li></ol><p>2012å¹´åŸºäºAntå’ŒMavenäº§ç”Ÿçš„Gradleï¼Œå¼¥è¡¥äº†Antå’ŒMavençš„ä¸è¶³ï¼Œå¸¦æ¥äº†ä¸€äº›æ›´é«˜æ•ˆçš„ç‰¹ç‚¹ã€‚<br>å®ƒä½¿ç”¨ä¸€ç§åŸºäºGroovyçš„ç‰¹å®šé¢†åŸŸè¯­è¨€ï¼ˆDSLï¼‰æ¥å£°æ˜é¡¹ç›®é…ç½®ï¼ŒæŠ›å¼ƒäº†åŸºäºXMLçš„å„ç§ç¹çé…ç½®ã€‚<br>é¢å‘Javaåº”ç”¨ä¸ºä¸»ã€‚<br>å½“å‰å…¶æ”¯æŒçš„è¯­è¨€é™äºJavaã€Groovyå’ŒScalaï¼Œè®¡åˆ’æœªæ¥å°†æ”¯æŒæ›´å¤šçš„è¯­è¨€ã€‚</p><h3 id="è¯¾ç¨‹ç®€ä»‹"><a href="#è¯¾ç¨‹ç®€ä»‹" class="headerlink" title="è¯¾ç¨‹ç®€ä»‹"></a>è¯¾ç¨‹ç®€ä»‹</h3><p>æœ¬è¯¾ç¨‹ä¸»è¦åˆ†ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤æ¥è®²è§£gradleå·¥å…·çš„ä½¿ç”¨ï¼š</p><ol><li>Gradleå®‰è£…é…ç½®ï¼ˆWindowsç‰ˆï¼‰</li><li>Gradleå’Œideaé›†æˆ</li><li>Groovyè¯­è¨€ç®€å•ä»‹ç»</li><li>Gradleä»“åº“çš„é…ç½®</li><li>Gradleå…¥é—¨æ¡ˆä¾‹</li><li>Gradleåˆ›å»ºJava webå·¥ç¨‹å¹¶åœ¨tomcatä¸‹è¿è¡Œ</li><li>Gradleæ„å»ºå¤šæ¨¡å—é¡¹ç›®</li></ol><h2 id="è¯¾ç¨‹ä»‹ç»"><a href="#è¯¾ç¨‹ä»‹ç»" class="headerlink" title="è¯¾ç¨‹ä»‹ç»"></a>è¯¾ç¨‹ä»‹ç»</h2><h2 id="gradleçš„å®‰è£…"><a href="#gradleçš„å®‰è£…" class="headerlink" title="gradleçš„å®‰è£…"></a>gradleçš„å®‰è£…</h2><p>ä¸‹è½½å®æ—¶æœ€æ–°çš„Gradleç‰ˆæœ¬ï¼š<code>https://gradle.org/releases/</code>ã€‚</p><p>ç‚¹å‡»<code>Download: binary-only or complete</code>å½“ä¸­çš„<code>binary-only</code>æˆ–è€…<code>complete</code>å³å¯ä¸‹è½½ï¼›<br>ä¸‹è½½å¥½çš„gradleæ˜¯ä¸€ä¸ªå‹ç¼©åŒ…çš„å½¢å¼ï¼›<br>å³é¦–å…ˆéœ€è¦è¿›è¡Œè§£å‹ï¼›</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">v6.5</span><br><span class="line">Jun 02, 2020</span><br><span class="line"></span><br><span class="line">Download: binary-only <span class="keyword">or</span> complete</span><br><span class="line">User Manual</span><br><span class="line">API Javadoc</span><br><span class="line">DSL Reference</span><br><span class="line">Release Notes</span><br><span class="line">v6.4.1</span><br><span class="line">May 15, 2020</span><br><span class="line"></span><br><span class="line">Download: binary-only <span class="keyword">or</span> complete</span><br><span class="line">User Manual</span><br><span class="line">API Javadoc</span><br><span class="line">DSL Reference</span><br><span class="line">Release Notes</span><br><span class="line">v6.4</span><br><span class="line">May 05, 2020</span><br><span class="line"></span><br><span class="line">Download: binary-only <span class="keyword">or</span> complete</span><br><span class="line">User Manual</span><br><span class="line">API Javadoc</span><br><span class="line">DSL Reference</span><br><span class="line">Release Notes</span><br><span class="line"><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span></span><br></pre></td></tr></table></figure><p>gradleçš„ç›®å½•ç»“æ„ï¼š</p><ul><li>bin<ul><li>gradle</li><li>gradle.bat(æ„å»ºé¡¹ç›®éå¸¸é‡è¦çš„å‘½ä»¤ï¼Œæ‰€ä»¥è¯´ä¹‹åå¦‚æœæƒ³è¦ç”¨gradleæ„å»ºé¡¹ç›®å°±éœ€è¦ç”¨åˆ°è¿™ä¸ªæ–‡ä»¶ï¼›)</li></ul></li><li>caches(cacheså³ç¼“å­˜ï¼Œç”±äºæ˜¯å´­æ–°ä¸‹è½½å¥½çš„ï¼Œæ‰€ä»¥æš‚æ—¶æ²¡æœ‰ç¼“å­˜)<ul><li>4.7</li><li>jars-3</li><li>modules-2<ul><li>files-2.1</li><li>metadata-2.56<ul><li>descriptors</li><li>module-artifact.bin</li><li>module-artifacts.bin</li><li>module-metadata.bin</li><li>resource-at-url.bin</li></ul></li><li>modules-2.lock</li></ul></li><li>transforms-1<ul><li>transform-1.lock</li></ul></li></ul></li><li>daemon<ul><li>4.7</li></ul></li><li>init.d<ul><li>readme.txt</li></ul></li><li>lib(è‡ªèº«è¿è¡Œæ‰€éœ€è¦çš„ä¸€äº›ç¯å¢ƒå¦‚jaråŒ…/pluginsæ’ä»¶ç­‰)<ul><li>plugins</li><li>annotations-13.0.jar</li><li>â€¦..</li></ul></li><li>media</li><li>native</li><li>wrapper</li><li>getting-started.html</li><li>LICENSE</li><li>NOTICE</li></ul><p>ä¸ºäº†æ›´å¥½çš„ä½¿ç”¨gradleéœ€è¦å¯¹gradleè¿›è¡Œç¯å¢ƒå˜é‡çš„é…ç½®ï¼›</p><blockquote><p>Gradle ç¯å¢ƒå˜é‡é…ç½®</p></blockquote><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">================================================</span><br><span class="line">Gradleç›®å½•ï¼šF:\Gradle\gradle-4.4-all\gradle-4.4</span><br><span class="line"></span><br><span class="line">ç‚¹å‡»-æˆ‘çš„ç”µè„‘</span><br><span class="line">â†“â†“â†“â†“â†“â†“</span><br><span class="line">å³å‡»</span><br><span class="line">â†“â†“â†“â†“â†“â†“</span><br><span class="line">ç‚¹å‡»-å±æ€§</span><br><span class="line">â†“â†“â†“â†“â†“â†“</span><br><span class="line">ç‚¹å‡»-é«˜çº§ç³»ç»Ÿè®¾ç½®</span><br><span class="line">â†“â†“â†“â†“â†“â†“</span><br><span class="line">ç‚¹å‡»-ç¯å¢ƒå˜é‡</span><br><span class="line">â†“â†“â†“â†“â†“â†“</span><br><span class="line">ç‚¹å‡»-ç³»ç»Ÿå˜é‡</span><br><span class="line">â†“â†“â†“â†“â†“â†“</span><br><span class="line">ç‚¹å‡»-æ–°å»ºï¼ˆWï¼‰...</span><br><span class="line">â†“â†“â†“â†“â†“â†“</span><br><span class="line">å˜é‡åï¼ˆNï¼‰ï¼šGRADLE<span class="emphasis">_HOME</span></span><br><span class="line"><span class="emphasis">å˜é‡å€¼ï¼ˆVï¼‰ï¼šF:\Gradle\gradle-4.4-all\gradle-4.4</span></span><br><span class="line"><span class="emphasis">â†“â†“â†“â†“â†“â†“</span></span><br><span class="line"><span class="emphasis">æ‰¾åˆ°Path</span></span><br><span class="line"><span class="emphasis">â†“â†“â†“â†“â†“â†“</span></span><br><span class="line"><span class="emphasis">ç‚¹å‡»-ç¼–è¾‘</span></span><br><span class="line"><span class="emphasis">â†“â†“â†“â†“â†“â†“</span></span><br><span class="line"><span class="emphasis">æ–°å»ºï¼ˆNï¼‰</span></span><br><span class="line"><span class="emphasis">%GRADLE_</span>HOME%\bin</span><br><span class="line">â†“â†“â†“â†“â†“â†“</span><br><span class="line">ç‚¹å‡»-ç¡®å®š</span><br><span class="line">â†“â†“â†“â†“â†“â†“</span><br><span class="line">ç‚¹å‡»-ç¡®å®š</span><br><span class="line">================================================</span><br></pre></td></tr></table></figure><blockquote><p>å¦‚ä½•éªŒè¯Gradleé…ç½®æˆåŠŸ</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">======================================</span></span><br><span class="line"><span class="string">windows+ré”®ï¼šé”®å…¥cmdï¼›æ‰“å¼€å‘½ä»¤æç¤ºç¬¦ï¼›</span></span><br><span class="line"><span class="string">å‘½ä»¤è¡Œé”®å…¥ï¼šgradle</span> <span class="string">-v</span> <span class="comment">#å›è½¦</span></span><br><span class="line"></span><br><span class="line"><span class="string">Microsoft</span> <span class="string">Windows</span> <span class="string">[Version</span> <span class="number">10.0</span><span class="number">.17763</span><span class="number">.1282</span><span class="string">]</span></span><br><span class="line"><span class="string">(c)</span> <span class="number">2018</span> <span class="string">Microsoft</span> <span class="string">Corporationã€‚ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="string">C:\Users\ASUS&gt;gradle</span> <span class="string">-v</span></span><br><span class="line"><span class="attr">Picked up JAVA_TOOL_OPTIONS:</span> <span class="string">-Dfile.encoding=UTF-8</span></span><br><span class="line"></span><br><span class="line"><span class="string">------------------------------------------------------------</span></span><br><span class="line"><span class="string">Gradle</span> <span class="number">4.4</span></span><br><span class="line"><span class="string">------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Build time:</span>   <span class="number">2017</span><span class="number">-12</span><span class="number">-06</span> <span class="number">09</span><span class="string">:05:06</span> <span class="string">UTC</span></span><br><span class="line"><span class="attr">Revision:</span>     <span class="string">cf7821a6f79f8e2a598df21780e3ff7ce8db2b82</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Groovy:</span>       <span class="number">2.4</span><span class="number">.12</span></span><br><span class="line"><span class="attr">Ant:</span>          <span class="string">Apache</span> <span class="string">Ant(TM)</span> <span class="string">version</span> <span class="number">1.9</span><span class="number">.9</span> <span class="string">compiled</span> <span class="string">on</span> <span class="string">February</span> <span class="number">2</span> <span class="number">2017</span></span><br><span class="line"><span class="attr">JVM:</span>          <span class="number">1.8</span><span class="string">.0_202</span> <span class="string">(Oracle</span> <span class="string">Corporation</span> <span class="number">25.202</span><span class="string">-b08)</span></span><br><span class="line"><span class="attr">OS:</span>           <span class="string">Windows</span> <span class="number">10</span> <span class="number">10.0</span> <span class="string">amd64</span></span><br><span class="line"></span><br><span class="line"><span class="string">C:\Users\ASUS&gt;</span> <span class="string">exit</span> <span class="comment"># é€€å‡º</span></span><br><span class="line"><span class="string">=====================================</span></span><br><span class="line"><span class="string">å¦‚æœå‡ºç°ä»¥ä¸Šä¿¡æ¯åŠGradleå®‰è£…æˆåŠŸï¼›</span></span><br></pre></td></tr></table></figure><h2 id="gradleä»‹ç»02"><a href="#gradleä»‹ç»02" class="headerlink" title="gradleä»‹ç»02"></a>gradleä»‹ç»02</h2><p>åœ¨ideaå½“ä¸­åˆ›å»ºgradleé¡¹ç›®ï¼›<br>é¦–å…ˆæ‰“å¼€ideaï¼›</p><p>GroupId: å…¬å¸/ç»„ç»‡åç§°<br>ArtifactId: é¡¹ç›®åç§°<br>Version: ç‰ˆæœ¬å·<br>gradleçš„è¿è¡Œéœ€è¦ç”¨åˆ°jdkçš„ç¯å¢ƒï¼›</p><ol><li><p>é¦–å…ˆæŒ‡å®šåˆšåˆšå®‰è£…çš„gradleåœ¨ä»€ä¹ˆåœ°æ–¹ï¼Œå³é€‰æ‹©Use local gradle wrapper(recommended)ï¼ˆå³æœ¬åœ°å®‰è£…çš„gradleï¼Œé€‰æ‹©äº†ä¹‹åä¼šå‘ç°å®ƒä¼šå»è‡ªåŠ¨æ‰¾æœ¬åœ°æ‰€å®‰è£…çš„gradleï¼‰</p></li><li><p>gradleçš„è¿è¡Œéœ€è¦ç”¨åˆ°jdkçš„ç¯å¢ƒï¼›é‚£ä¹ˆå°±éœ€è¦åœ¨Gradle JVMå½“ä¸­é€‰æ‹©å¥½è‡ªå·±æœ¬åœ°çš„jdkç¯å¢ƒï¼›ç¡®è®¤ä¸€ä¸‹Gradle JVMå½“ä¸­æ‰€å½•å…¥çš„æ˜¯å¦ä¸ºæœ¬åœ°jdkçš„ä½ç½®ï¼›</p></li><li><p>Use auto-importé€‰é¡¹è¿›è¡Œå‹¾é€‰ä¸Šï¼›Use auto-importçš„å«ä¹‰ä¸ºï¼šåœ¨é¡¹ç›®å¼€å‘æ—¶çªç„¶å¯¼å…¥äº†ä¸€ä¸ªcçš„jaråŒ…ï¼›é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±éœ€è¦gradleæ¥è‡ªåŠ¨å°†è¿™ä¸ªjaråŒ…çš„åæ ‡ä½ç½®ç»™æ‰¾åˆ°ï¼›å¹¶ä¸”å¯¼å…¥è¿›æ¥å³å¯ï¼›</p></li><li><p>å…¶ä½™çš„ä¸éœ€è¦åšæ”¹å˜ä½¿ç”¨é»˜è®¤å³å¯ï¼›</p></li></ol><p>Use auto-import è‡ªåŠ¨å¯¼å…¥</p><p>Project name: é¡¹ç›®åç§°<br>Project location: é¡¹ç›®æ”¾ç½®çš„ç›®å½•</p><p>ç‚¹å‡»Finishå³å¯ï¼›<br>å½“å‰åˆ›å»ºçš„è¯¥é¡¹ç›®å°±å¯ä»¥ä½¿ç”¨gradleåšå¼€å‘äº†ï¼›<br>å½“gradleåœ¨åˆ›å»ºçš„æ—¶å€™å°½é‡è®©jdkä¸º1.8æˆ–è€…æ˜¯ç”µè„‘æ˜¯ä¸€ä¸ªè”ç½‘çš„çŠ¶æ€ï¼›<br>å› ä¸ºè¦å»ç½‘ä¸Šä¸‹è½½ä¸€äº›ç›¸åº”çš„æ’ä»¶ï¼›</p><h2 id="gradleé¡¹ç›®ç›®å½•ç»“æ„ä»‹ç»"><a href="#gradleé¡¹ç›®ç›®å½•ç»“æ„ä»‹ç»" class="headerlink" title="gradleé¡¹ç›®ç›®å½•ç»“æ„ä»‹ç»"></a>gradleé¡¹ç›®ç›®å½•ç»“æ„ä»‹ç»</h2><p>åœ¨å¼€å‘çš„æ—¶å€™ï¼Œéƒ½è®²ç©¶é…ç½®æ–‡ä»¶ä¸ä»£ç åˆ†ç¦»åŸåˆ™ï¼Œè®²ç©¶è¯¥åŸåˆ™çš„åŸå› åœ¨äºå› ä¸ºæœ€ç»ˆé¡¹ç›®å¼€å‘å®Œæˆä¹‹åæ˜¯éœ€è¦å‘å¸ƒåˆ°çº¿ä¸Šçš„ï¼Œé‚£ä¹ˆå‘å¸ƒåˆ°çº¿ä¸Šçš„æ—¶å€™åªéœ€è¦å‘å¸ƒæ­£å¼çš„æºç å³å¯ï¼›åœ¨æ­£å¼æºç å¼€å‘è¿‡ç¨‹ä¸­å°†äº§ç”Ÿå¤§é‡çš„æµ‹è¯•æ–‡ä»¶å³å•å…ƒæµ‹è¯•ï¼›<br>src/main/java æ”¾ç½®æ­£å¼ä»£ç ç›®å½•<br>src/main/resources æ”¾ç½®æ­£å¼é…ç½®æ–‡ä»¶ç›®å½•<br>src/test/java æ”¾ç½®å•å…ƒæµ‹è¯•ä»£ç ç›®å½•<br>src/test/resources æ”¾ç½®æµ‹è¯•é…ç½®æ–‡ä»¶ç›®å½•<br>src/main/webapp æ”¾ç½®é¡µé¢å…ƒç´ ï¼Œæ¯”å¦‚ï¼šjsï¼Œcssï¼Œimgï¼Œjspï¼Œhtmlç­‰ç­‰</p><h2 id="groovyç®€å•è¯­æ³•"><a href="#groovyç®€å•è¯­æ³•" class="headerlink" title="groovyç®€å•è¯­æ³•"></a>groovyç®€å•è¯­æ³•</h2><p>ä¸è¿›è¡Œåˆ›å»ºgradleå·¥ç¨‹ä¸€æ ·å¯ä»¥æ¥è¿›è¡Œä½¿ç”¨è¯¥ç¼–è¾‘å™¨ï¼›<br>groovyæ›´åŠ çš„éšæ„ï¼›</p><blockquote><p>ä»£ç </p></blockquote><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä»‹ç»groovyç¼–ç¨‹è¯­è¨€</span></span><br><span class="line"><span class="comment">// java: System.out.println("");</span></span><br><span class="line"><span class="built_in">println</span>(<span class="string">"hello, good morning, fsn"</span>);</span><br><span class="line"><span class="comment">// groovyå¯ä»¥çœç•¥è¯­å¥æœ€æœ«å°¾çš„åˆ†å·</span></span><br><span class="line"><span class="built_in">println</span>(<span class="string">"hello world"</span>)</span><br><span class="line"><span class="comment">//groovyä¸­å¯ä»¥çœç•¥å°æ‹¬å·</span></span><br><span class="line"><span class="built_in">println</span><span class="string">"hello world, hello, world"</span></span><br><span class="line"><span class="comment">//groovyä¸­å¦‚ä½•å®šä¹‰å˜é‡ï¼Œæœ€åçš„åˆ†å·åŠ ä¸åŠ éƒ½è¡Œ</span></span><br><span class="line"><span class="comment">//def å¼±ç±»å‹ï¼›æœ‰ç‚¹ç±»ä¼¼äºåœ¨JavaScriptå½“ä¸­çš„var;</span></span><br><span class="line"><span class="comment">//groovyä¼šè‡ªåŠ¨æ ¹æ®æƒ…å†µæ¥ç»™å˜é‡èµ‹äºˆå¯¹åº”çš„ç±»å‹ï¼›</span></span><br><span class="line"><span class="comment">//æ ¹æ®å˜é‡ååé¢çš„å–å€¼æ¥è¿›è¡Œåˆ¤æ–­æ˜¯ä»€ä¹ˆæ ·çš„ç±»å‹ï¼›</span></span><br><span class="line"><span class="comment">//int ç±»å‹</span></span><br><span class="line">def abc = <span class="number">21</span>;</span><br><span class="line">def defg = <span class="number">22</span></span><br><span class="line"><span class="built_in">println</span> abc</span><br><span class="line"><span class="built_in">println</span> abc+defg</span><br><span class="line"><span class="comment">//string ç±»å‹</span></span><br><span class="line">def s = <span class="string">"laowang"</span></span><br><span class="line"><span class="built_in">println</span> s</span><br><span class="line"><span class="comment">//å®šä¹‰ä¸€ä¸ªé›†åˆç±»å‹</span></span><br><span class="line">def list = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>,<span class="string">'f'</span>,<span class="string">'g'</span>]</span><br><span class="line"><span class="comment">//å¾€listä¸­æ·»åŠ å…ƒç´ </span></span><br><span class="line">list &lt;&lt; <span class="string">'h'</span></span><br><span class="line"><span class="comment">//å–å‡ºlistä¸­ç¬¬ä¸‰ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="built_in">println</span> list.<span class="built_in">get</span>(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">println</span> list.<span class="built_in">size</span>()</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; list.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">    <span class="built_in">println</span> list.<span class="built_in">get</span>(i)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å®šä¹‰ä¸€ä¸ªmap</span></span><br><span class="line">def <span class="built_in">map</span> = [<span class="string">'key1'</span>:<span class="string">'value1'</span>,<span class="string">'key2'</span>:<span class="string">'value2'</span>]</span><br><span class="line"><span class="comment">//å‘mapå½“ä¸­æ·»åŠ é”®å€¼å¯¹</span></span><br><span class="line"><span class="built_in">map</span>.key3 = <span class="string">'value3'</span></span><br><span class="line"><span class="comment">//æ‰“å°å‡ºkey3çš„å–å€¼</span></span><br><span class="line"><span class="built_in">println</span> <span class="built_in">map</span>.<span class="built_in">get</span>(<span class="string">'key3'</span>)</span><br></pre></td></tr></table></figure><blockquote><p>ç»“æœ</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> //ä»‹ç»groovyç¼–ç¨‹è¯­è¨€</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> // java: System.out.println(<span class="string">""</span>);</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> println(<span class="string">"hello, good morning, fsn"</span>);</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> // groovyå¯ä»¥çœç•¥è¯­å¥æœ€æœ«å°¾çš„åˆ†å·</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> println(<span class="string">"hello world"</span>)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> //groovyä¸­å¯ä»¥çœç•¥å°æ‹¬å·</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> println<span class="string">"hello world, hello, world"</span></span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> //groovyä¸­å¦‚ä½•å®šä¹‰å˜é‡ï¼Œæœ€åçš„åˆ†å·åŠ ä¸åŠ éƒ½è¡Œ</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> //def å¼±ç±»å‹ï¼›æœ‰ç‚¹ç±»ä¼¼äºåœ¨JavaScriptå½“ä¸­çš„var;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> //groovyä¼šè‡ªåŠ¨æ ¹æ®æƒ…å†µæ¥ç»™å˜é‡èµ‹äºˆå¯¹åº”çš„ç±»å‹ï¼›</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> //æ ¹æ®å˜é‡ååé¢çš„å–å€¼æ¥è¿›è¡Œåˆ¤æ–­æ˜¯ä»€ä¹ˆæ ·çš„ç±»å‹ï¼›</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> //int ç±»å‹</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> def abc = 21;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> def defg = 22</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> println abc</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> println abc+defg</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> //string ç±»å‹</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> def s = <span class="string">"laowang"</span></span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> println s</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> //å®šä¹‰ä¸€ä¸ªé›†åˆç±»å‹</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> def list = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>,<span class="string">'f'</span>,<span class="string">'g'</span>]</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> //å¾€listä¸­æ·»åŠ å…ƒç´ </span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> list &lt;&lt; <span class="string">'h'</span></span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> //å–å‡ºlistä¸­ç¬¬ä¸‰ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> println list.get(2)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> println list.size()</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> <span class="keyword">for</span> (int i = 0; i &lt; list.size(); i++) &#123;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">     println list.get(i)</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> &#125;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> //å®šä¹‰ä¸€ä¸ªmap</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> def map = [<span class="string">'key1'</span>:<span class="string">'value1'</span>,<span class="string">'key2'</span>:<span class="string">'value2'</span>]</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> //å‘mapå½“ä¸­æ·»åŠ é”®å€¼å¯¹</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> map.key3 = <span class="string">'value3'</span></span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> println map.get(<span class="string">'key3'</span>)</span></span><br><span class="line">hello, good morning, fsn</span><br><span class="line">hello world</span><br><span class="line">hello world, hello, world</span><br><span class="line">21</span><br><span class="line">43</span><br><span class="line">laowang</span><br><span class="line">c</span><br><span class="line">8</span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">c</span><br><span class="line">d</span><br><span class="line">e</span><br><span class="line">f</span><br><span class="line">g</span><br><span class="line">h</span><br><span class="line">value3</span><br></pre></td></tr></table></figure><h2 id="groovyä¸­çš„é—­åŒ…"><a href="#groovyä¸­çš„é—­åŒ…" class="headerlink" title="groovyä¸­çš„é—­åŒ…"></a>groovyä¸­çš„é—­åŒ…</h2><blockquote><p>Closureä¸å¯å¯¼å…¥å…¶ä»–åŒ…</p></blockquote><figure class="highlight flix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.sun.corba.se.spi.orbutil.closure.Closure</span><br><span class="line"><span class="comment">//groovyä¸­çš„é—­åŒ…</span></span><br><span class="line"><span class="comment">//ä»‹ç»ï¼šä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿ</span></span><br><span class="line"><span class="comment">//é—­åŒ…å…¶å®å°±æ˜¯ä¸€æ®µä»£ç å—ï¼Œåœ¨gradleä¸­ï¼Œä¸»è¦æ˜¯æŠŠé—­åŒ…å½“å‚æ•°æ¥è¿›è¡Œä½¿ç”¨</span></span><br><span class="line"><span class="comment">//é¦–å…ˆéœ€è¦è¿›è¡Œå®šä¹‰ä¸€ä¸ªé—­åŒ…</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span> </span>= &#123;</span><br><span class="line">    println <span class="string">"hello, fsn !"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å†å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œè¯¥æ–¹æ³•é‡Œé¢éœ€è¦é—­åŒ…ç±»å‹çš„å‚æ•°</span></span><br><span class="line"><span class="comment">//Closure closureä¸è¦å¯¼jaråŒ…ï¼Œä»»ä½•ä¸€ä¸ªåŒ…éƒ½ä¸è¦å¯¼å…¥</span></span><br><span class="line"><span class="comment">//åœ¨groovyå½“ä¸­Closureè¯¥å•è¯å°±è¡¨ç¤ºé—­åŒ…ï¼›å¦‚æœå¯¼åŒ…è¿›æ¥å°±ä¼šå‡ºé”™ï¼›</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">method1</span></span>(Closure closure)&#123;</span><br><span class="line">    closure()</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è°ƒç”¨æ–¹æ³•method1()</span></span><br><span class="line">method1(test)</span><br></pre></td></tr></table></figure><blockquote><p>ç¤ºä¾‹æŠ¥é”™</p></blockquote><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">F:\jdk\jdk1.<span class="number">8202</span>\jdk\bin\java.exe -<span class="module-access"><span class="module"><span class="identifier">Dtools</span>.</span></span>jar=F:\jdk\jdk1.<span class="number">8202</span>\jdk\lib\tools.jar <span class="string">"-Dgroovy.home=F:\ideaUI\IntelliJ IDEA 2018.3.1"</span> <span class="string">"-Dgroovy.starter.conf=F:\ideaUI\IntelliJ IDEA 2018.3.1\plugins\Groovy\lib\groovy-starter.conf"</span> -<span class="module-access"><span class="module"><span class="identifier">Dfile</span>.</span></span>encoding=UTF-<span class="number">8</span> -classpath <span class="string">"F:\ideaUI\IntelliJ IDEA 2018.3.1\lib\idea_rt.jar"</span> com.intellij.rt.execution.CommandLineWrapper C:\Users\ASUS\AppData\Local\Temp\idea_classpath1957904038 org.codehaus.groovy.tools.GroovyStarter --conf <span class="string">"F:\ideaUI\IntelliJ IDEA 2018.3.1\plugins\Groovy\lib\groovy-starter.conf"</span> --main groovy.ui.GroovyMain -p <span class="string">"F:\ideaUI\IntelliJ IDEA 2018.3.1\plugins\Groovy\lib\console.groovy"</span></span><br><span class="line"></span><br><span class="line">&gt; import com.sun.corba.se.spi.orbutil.closure.Closure</span><br><span class="line">&gt; <span class="comment">//groovyä¸­çš„é—­åŒ…</span></span><br><span class="line">&gt; <span class="comment">//ä»‹ç»ï¼šä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿ</span></span><br><span class="line">&gt; <span class="comment">//é—­åŒ…å…¶å®å°±æ˜¯ä¸€æ®µä»£ç å—ï¼Œåœ¨gradleä¸­ï¼Œä¸»è¦æ˜¯æŠŠé—­åŒ…å½“å‚æ•°æ¥è¿›è¡Œä½¿ç”¨</span></span><br><span class="line">&gt; <span class="comment">//é¦–å…ˆéœ€è¦è¿›è¡Œå®šä¹‰ä¸€ä¸ªé—­åŒ…</span></span><br><span class="line">&gt; def test = &#123;</span><br><span class="line">&gt;     println <span class="string">"hello, fsn !"</span></span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt; <span class="comment">//å†å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œè¯¥æ–¹æ³•é‡Œé¢éœ€è¦é—­åŒ…ç±»å‹çš„å‚æ•°</span></span><br><span class="line">&gt; <span class="comment">//Closure closureä¸è¦å¯¼jaråŒ…ï¼Œä»»ä½•ä¸€ä¸ªåŒ…éƒ½ä¸è¦å¯¼å…¥</span></span><br><span class="line">&gt; <span class="comment">//åœ¨groovyå½“ä¸­Closureè¯¥å•è¯å°±è¡¨ç¤ºé—­åŒ…ï¼›å¦‚æœå¯¼åŒ…è¿›æ¥å°±ä¼šå‡ºé”™ï¼›</span></span><br><span class="line">&gt; def method1(Closure closure)&#123;</span><br><span class="line">&gt;     closure<span class="literal">()</span></span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt; <span class="comment">//è°ƒç”¨æ–¹æ³•method1()</span></span><br><span class="line">&gt; method1(test)</span><br><span class="line">hello, good morning, fsn</span><br><span class="line">hello world</span><br><span class="line">hello world, hello, world</span><br><span class="line"><span class="number">21</span></span><br><span class="line"><span class="number">43</span></span><br><span class="line">laowang</span><br><span class="line">c</span><br><span class="line"><span class="number">8</span></span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">c</span><br><span class="line">d</span><br><span class="line">e</span><br><span class="line">f</span><br><span class="line">g</span><br><span class="line">h</span><br><span class="line">value3</span><br><span class="line">groovy.lang.MissingMethodException: No signature <span class="keyword">of</span> <span class="keyword">method</span>: com.sun.proxy.$<span class="module-access"><span class="module"><span class="identifier">Proxy5</span>.</span></span>call<span class="literal">()</span> is applicable for argument types: <span class="literal">()</span> values: <span class="literal">[]</span></span><br><span class="line">Possible solutions: wait<span class="literal">()</span>, any<span class="literal">()</span>, wait(long), each(groovy.lang.Closure), any(groovy.lang.Closure), wait(long, <span class="built_in">int</span>)</span><br><span class="line">at org.codehaus.groovy.runtime.<span class="module-access"><span class="module"><span class="identifier">ScriptBytecodeAdapter</span>.</span></span>unwrap(<span class="module-access"><span class="module"><span class="identifier">ScriptBytecodeAdapter</span>.</span></span>java:<span class="number">71</span>)</span><br><span class="line">at org.codehaus.groovy.runtime.callsite.<span class="module-access"><span class="module"><span class="identifier">PojoMetaClassSite</span>.</span></span>call(<span class="module-access"><span class="module"><span class="identifier">PojoMetaClassSite</span>.</span></span>java:<span class="number">48</span>)</span><br><span class="line">at org.codehaus.groovy.runtime.callsite.<span class="module-access"><span class="module"><span class="identifier">CallSiteArray</span>.</span></span>default<span class="constructor">Call(CallSiteArray.<span class="params">java</span>:47)</span></span><br><span class="line">at org.codehaus.groovy.runtime.callsite.<span class="module-access"><span class="module"><span class="identifier">AbstractCallSite</span>.</span></span>call(<span class="module-access"><span class="module"><span class="identifier">AbstractCallSite</span>.</span></span>java:<span class="number">116</span>)</span><br><span class="line">at org.codehaus.groovy.runtime.callsite.<span class="module-access"><span class="module"><span class="identifier">AbstractCallSite</span>.</span></span>call(<span class="module-access"><span class="module"><span class="identifier">AbstractCallSite</span>.</span></span>java:<span class="number">120</span>)</span><br><span class="line">at ideaGroovyConsole.method1(ideaGroovyConsole.groovy:<span class="number">50</span>)</span><br><span class="line">at sun.reflect.<span class="module-access"><span class="module"><span class="identifier">NativeMethodAccessorImpl</span>.</span></span>invoke0(Native Method)</span><br><span class="line">at sun.reflect.<span class="module-access"><span class="module"><span class="identifier">NativeMethodAccessorImpl</span>.</span></span>invoke(<span class="module-access"><span class="module"><span class="identifier">NativeMethodAccessorImpl</span>.</span></span>java:<span class="number">62</span>)</span><br><span class="line">at sun.reflect.<span class="module-access"><span class="module"><span class="identifier">DelegatingMethodAccessorImpl</span>.</span></span>invoke(<span class="module-access"><span class="module"><span class="identifier">DelegatingMethodAccessorImpl</span>.</span></span>java:<span class="number">43</span>)</span><br><span class="line">at java.lang.reflect.<span class="module-access"><span class="module"><span class="identifier">Method</span>.</span></span>invoke(<span class="module-access"><span class="module"><span class="identifier">Method</span>.</span></span>java:<span class="number">498</span>)</span><br><span class="line">at org.codehaus.groovy.runtime.callsite.<span class="module-access"><span class="module"><span class="identifier">PogoMetaMethodSite$PogoCachedMethodSiteNoUnwrap</span>.</span></span>invoke(<span class="module-access"><span class="module"><span class="identifier">PogoMetaMethodSite</span>.</span></span>java:<span class="number">190</span>)</span><br><span class="line">at org.codehaus.groovy.runtime.callsite.<span class="module-access"><span class="module"><span class="identifier">PogoMetaMethodSite</span>.</span></span>call<span class="constructor">Current(PogoMetaMethodSite.<span class="params">java</span>:59)</span></span><br><span class="line">at org.codehaus.groovy.runtime.callsite.<span class="module-access"><span class="module"><span class="identifier">CallSiteArray</span>.</span></span>default<span class="constructor">CallCurrent(CallSiteArray.<span class="params">java</span>:51)</span></span><br><span class="line">at org.codehaus.groovy.runtime.callsite.<span class="module-access"><span class="module"><span class="identifier">AbstractCallSite</span>.</span></span>call<span class="constructor">Current(AbstractCallSite.<span class="params">java</span>:157)</span></span><br><span class="line">at org.codehaus.groovy.runtime.callsite.<span class="module-access"><span class="module"><span class="identifier">AbstractCallSite</span>.</span></span>call<span class="constructor">Current(AbstractCallSite.<span class="params">java</span>:169)</span></span><br><span class="line">at ideaGroovyConsole.run(ideaGroovyConsole.groovy:<span class="number">53</span>)</span><br><span class="line">at groovy.lang.<span class="module-access"><span class="module"><span class="identifier">GroovyShell</span>.</span></span>run<span class="constructor">ScriptOrMainOrTestOrRunnable(GroovyShell.<span class="params">java</span>:263)</span></span><br><span class="line">at groovy.lang.<span class="module-access"><span class="module"><span class="identifier">GroovyShell</span>.</span></span>run(<span class="module-access"><span class="module"><span class="identifier">GroovyShell</span>.</span></span>java:<span class="number">507</span>)</span><br><span class="line">at groovy.lang.<span class="module-access"><span class="module"><span class="identifier">GroovyShell</span>.</span></span>run(<span class="module-access"><span class="module"><span class="identifier">GroovyShell</span>.</span></span>java:<span class="number">486</span>)</span><br><span class="line">at sun.reflect.<span class="module-access"><span class="module"><span class="identifier">NativeMethodAccessorImpl</span>.</span></span>invoke0(Native Method)</span><br><span class="line">at sun.reflect.<span class="module-access"><span class="module"><span class="identifier">NativeMethodAccessorImpl</span>.</span></span>invoke(<span class="module-access"><span class="module"><span class="identifier">NativeMethodAccessorImpl</span>.</span></span>java:<span class="number">62</span>)</span><br><span class="line">at sun.reflect.<span class="module-access"><span class="module"><span class="identifier">DelegatingMethodAccessorImpl</span>.</span></span>invoke(<span class="module-access"><span class="module"><span class="identifier">DelegatingMethodAccessorImpl</span>.</span></span>java:<span class="number">43</span>)</span><br><span class="line">at java.lang.reflect.<span class="module-access"><span class="module"><span class="identifier">Method</span>.</span></span>invoke(<span class="module-access"><span class="module"><span class="identifier">Method</span>.</span></span>java:<span class="number">498</span>)</span><br><span class="line">at org.codehaus.groovy.runtime.callsite.<span class="module-access"><span class="module"><span class="identifier">PogoMetaMethodSite$PogoCachedMethodSite</span>.</span></span>invoke(<span class="module-access"><span class="module"><span class="identifier">PogoMetaMethodSite</span>.</span></span>java:<span class="number">169</span>)</span><br><span class="line">at org.codehaus.groovy.runtime.callsite.<span class="module-access"><span class="module"><span class="identifier">PogoMetaMethodSite</span>.</span></span>call(<span class="module-access"><span class="module"><span class="identifier">PogoMetaMethodSite</span>.</span></span>java:<span class="number">71</span>)</span><br><span class="line">at org.codehaus.groovy.runtime.callsite.<span class="module-access"><span class="module"><span class="identifier">AbstractCallSite</span>.</span></span>call(<span class="module-access"><span class="module"><span class="identifier">AbstractCallSite</span>.</span></span>java:<span class="number">136</span>)</span><br><span class="line">at console.run(console.groovy:<span class="number">11</span>)</span><br><span class="line">at groovy.ui.<span class="module-access"><span class="module"><span class="identifier">GroovyMain</span>.</span></span>process<span class="constructor">Reader(GroovyMain.<span class="params">java</span>:576)</span></span><br><span class="line">at groovy.ui.<span class="module-access"><span class="module"><span class="identifier">GroovyMain</span>.</span></span>process<span class="constructor">Files(GroovyMain.<span class="params">java</span>:485)</span></span><br><span class="line">at groovy.ui.<span class="module-access"><span class="module"><span class="identifier">GroovyMain</span>.</span></span>run(<span class="module-access"><span class="module"><span class="identifier">GroovyMain</span>.</span></span>java:<span class="number">327</span>)</span><br><span class="line">at groovy.ui.<span class="module-access"><span class="module"><span class="identifier">GroovyMain</span>.</span></span>process(<span class="module-access"><span class="module"><span class="identifier">GroovyMain</span>.</span></span>java:<span class="number">315</span>)</span><br><span class="line">at groovy.ui.<span class="module-access"><span class="module"><span class="identifier">GroovyMain</span>.</span></span>process<span class="constructor">Args(GroovyMain.<span class="params">java</span>:134)</span></span><br><span class="line">at groovy.ui.<span class="module-access"><span class="module"><span class="identifier">GroovyMain</span>.</span></span>main(<span class="module-access"><span class="module"><span class="identifier">GroovyMain</span>.</span></span>java:<span class="number">114</span>)</span><br><span class="line">at sun.reflect.<span class="module-access"><span class="module"><span class="identifier">NativeMethodAccessorImpl</span>.</span></span>invoke0(Native Method)</span><br><span class="line">at sun.reflect.<span class="module-access"><span class="module"><span class="identifier">NativeMethodAccessorImpl</span>.</span></span>invoke(<span class="module-access"><span class="module"><span class="identifier">NativeMethodAccessorImpl</span>.</span></span>java:<span class="number">62</span>)</span><br><span class="line">at sun.reflect.<span class="module-access"><span class="module"><span class="identifier">DelegatingMethodAccessorImpl</span>.</span></span>invoke(<span class="module-access"><span class="module"><span class="identifier">DelegatingMethodAccessorImpl</span>.</span></span>java:<span class="number">43</span>)</span><br><span class="line">at java.lang.reflect.<span class="module-access"><span class="module"><span class="identifier">Method</span>.</span></span>invoke(<span class="module-access"><span class="module"><span class="identifier">Method</span>.</span></span>java:<span class="number">498</span>)</span><br><span class="line">at org.codehaus.groovy.tools.<span class="module-access"><span class="module"><span class="identifier">GroovyStarter</span>.</span></span>root<span class="constructor">Loader(GroovyStarter.<span class="params">java</span>:116)</span></span><br><span class="line">at org.codehaus.groovy.tools.<span class="module-access"><span class="module"><span class="identifier">GroovyStarter</span>.</span></span>main(<span class="module-access"><span class="module"><span class="identifier">GroovyStarter</span>.</span></span>java:<span class="number">138</span>)</span><br><span class="line">at sun.reflect.<span class="module-access"><span class="module"><span class="identifier">NativeMethodAccessorImpl</span>.</span></span>invoke0(Native Method)</span><br><span class="line">at sun.reflect.<span class="module-access"><span class="module"><span class="identifier">NativeMethodAccessorImpl</span>.</span></span>invoke(<span class="module-access"><span class="module"><span class="identifier">NativeMethodAccessorImpl</span>.</span></span>java:<span class="number">62</span>)</span><br><span class="line">at sun.reflect.<span class="module-access"><span class="module"><span class="identifier">DelegatingMethodAccessorImpl</span>.</span></span>invoke(<span class="module-access"><span class="module"><span class="identifier">DelegatingMethodAccessorImpl</span>.</span></span>java:<span class="number">43</span>)</span><br><span class="line">at java.lang.reflect.<span class="module-access"><span class="module"><span class="identifier">Method</span>.</span></span>invoke(<span class="module-access"><span class="module"><span class="identifier">Method</span>.</span></span>java:<span class="number">498</span>)</span><br><span class="line">at com.intellij.rt.execution.<span class="module-access"><span class="module"><span class="identifier">CommandLineWrapper</span>.</span></span>main(<span class="module-access"><span class="module"><span class="identifier">CommandLineWrapper</span>.</span></span>java:<span class="number">67</span>)</span><br></pre></td></tr></table></figure><blockquote><p>æ­£ç¡®ç¤ºæ„</p></blockquote><figure class="highlight flix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//groovyä¸­çš„é—­åŒ…</span></span><br><span class="line"><span class="comment">//ä»‹ç»ï¼šä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿ</span></span><br><span class="line"><span class="comment">//é—­åŒ…å…¶å®å°±æ˜¯ä¸€æ®µä»£ç å—ï¼Œåœ¨gradleä¸­ï¼Œä¸»è¦æ˜¯æŠŠé—­åŒ…å½“å‚æ•°æ¥è¿›è¡Œä½¿ç”¨</span></span><br><span class="line"><span class="comment">//é¦–å…ˆéœ€è¦è¿›è¡Œå®šä¹‰ä¸€ä¸ªé—­åŒ…</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span> </span>= &#123;</span><br><span class="line">    println <span class="string">"hello, fsn !"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å†å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œè¯¥æ–¹æ³•é‡Œé¢éœ€è¦é—­åŒ…ç±»å‹çš„å‚æ•°</span></span><br><span class="line"><span class="comment">//Closure closureä¸è¦å¯¼jaråŒ…ï¼Œä»»ä½•ä¸€ä¸ªåŒ…éƒ½ä¸è¦å¯¼å…¥</span></span><br><span class="line"><span class="comment">//åœ¨groovyå½“ä¸­Closureè¯¥å•è¯å°±è¡¨ç¤ºé—­åŒ…ï¼›å¦‚æœå¯¼åŒ…è¿›æ¥å°±ä¼šå‡ºé”™ï¼›</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">method1</span></span>(Closure closure)&#123;</span><br><span class="line">    closure()</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è°ƒç”¨æ–¹æ³•method1()</span></span><br><span class="line">method1(test)</span><br></pre></td></tr></table></figure><blockquote><p>æ­£ç¡®ç»“æœ</p></blockquote><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">hello,</span> fsn !</span><br></pre></td></tr></table></figure><blockquote><p>å¤§æ¦‚çš„æ‰§è¡Œæµç¨‹</p></blockquote><p>é¦–å…ˆmethod1()æ–¹æ³•éœ€è¦ä¸€ä¸ªå‚æ•°Closure closureï¼Œé—­åŒ…ç±»å‹çš„å‚æ•°ï¼›<br>è€Œä¸Šé¢çš„testå˜é‡æ­£å¥½æ˜¯ä¸€ä¸ªé—­åŒ…ç±»å‹ï¼›<br>æ‰€ä»¥å¯ä»¥å°†testå˜é‡ä¼ é€’ä¸‹æ¥åˆ°method1()æ–¹æ³•å½“ä¸­ï¼›<br>åœ¨method1()æ‹¿åˆ°è¯¥é—­åŒ…å‚æ•°ä¹‹åå¹¶æ²¡æœ‰å…¶ä»–çš„åŠ¨ä½œä»…ä»…åªæ˜¯æ‰§è¡Œäº†é—­åŒ…æ–¹æ³•ï¼Œå³æ‰§è¡Œäº†test()æ–¹æ³•å½“ä¸­çš„ä»£ç ï¼›è€Œé—­åŒ…æ–¹æ³•å³test()æ–¹æ³•å½“ä¸­çš„ä»£ç å³ä¸ºè¾“å‡ºæ‰“å°ï¼›</p><blockquote><p>å¸¦æœ‰å‚æ•°çš„é—­åŒ…ä»£ç </p></blockquote><figure class="highlight flix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®šä¹‰ä¸€ä¸ªå¸¦æœ‰å‚æ•°çš„é—­åŒ…æ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test2</span> </span>= &#123;</span><br><span class="line">    v -&gt;</span><br><span class="line">        println <span class="string">"hello $&#123;v&#125;"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œæ–¹æ³•é‡Œé¢éœ€è¦é—­åŒ…ç±»å‹çš„å‚æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">method2</span></span>(Closure closure)&#123;</span><br><span class="line">    closure(<span class="string">"éš”å£è€ç‹"</span>)</span><br><span class="line">&#125;</span><br><span class="line">method2(test2)</span><br></pre></td></tr></table></figure><blockquote><p>ç»“æœæ‰“å°</p></blockquote><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hello</span> éš”å£è€ç‹</span><br></pre></td></tr></table></figure><h2 id="gradleé…ç½®æ–‡ä»¶çš„ä»‹ç»"><a href="#gradleé…ç½®æ–‡ä»¶çš„ä»‹ç»" class="headerlink" title="gradleé…ç½®æ–‡ä»¶çš„ä»‹ç»"></a>gradleé…ç½®æ–‡ä»¶çš„ä»‹ç»</h2><blockquote><p>build.gradle</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">====================================================================</span><br><span class="line">https://mvnrepository.com/artifact/org.springframework/spring-context/5.0.2.RELEASE</span><br><span class="line"></span><br><span class="line">å¦‚æœæ˜¯mavenå·¥ç¨‹ç›´æ¥é€‰æ‹©Mavenå³å¯ï¼›</span><br><span class="line">&lt;!<span class="comment">-- https://mvnrepository.com/artifact/org.springframework/spring-context --&gt;</span></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-<span class="keyword">context</span>&lt;/artifactId&gt;</span><br><span class="line">    &lt;<span class="keyword">version</span>&gt;<span class="number">5.0</span><span class="number">.2</span>.RELEASE&lt;/<span class="keyword">version</span>&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">å¦‚æœæ˜¯Gradleå·¥ç¨‹åˆ™é€‰æ‹©Gradleå³å¯ï¼›</span><br><span class="line">// https://mvnrepository.com/artifact/org.springframework/spring-<span class="keyword">context</span></span><br><span class="line">compile <span class="keyword">group</span>: <span class="string">'org.springframework'</span>, <span class="keyword">name</span>: <span class="string">'spring-context'</span>, <span class="keyword">version</span>: <span class="string">'5.0.2.RELEASE'</span></span><br><span class="line">====================================================================</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è¿è¡Œçš„ç¯å¢ƒ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">plugins &#123;</span><br><span class="line">    <span class="keyword">id</span> <span class="string">'java'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * group å…¬å¸/å›¢é˜Ÿå</span></span><br><span class="line"><span class="comment"> * version ç‰ˆæœ¬</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">group</span> <span class="string">'com.fsn'</span></span><br><span class="line"><span class="keyword">version</span> <span class="string">'1.0-SNAPSHOT'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * java jdkç‰ˆæœ¬</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">sourceCompatibility = <span class="number">1.8</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŒ‡å®šæ‰€ä½¿ç”¨ä»“åº“çš„è·¯å¾„</span></span><br><span class="line"><span class="comment"> * mavenCentral() è¡¨ç¤ºä½¿ç”¨ä¸­å¤®ä»“åº“ï¼Œæ­¤åˆ»é¡¹ç›®ä¸­æ‰€éœ€è¦çš„jaråŒ…éƒ½ä¼šé»˜è®¤ä»ä¸­å¤®ä»“åº“ä¸‹è½½åˆ°æœ¬åœ°æŒ‡å®šç›®å½•</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">repositories &#123;</span><br><span class="line">    mavenCentral()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1. gradleå·¥ç¨‹æ‰€æœ‰çš„jaråŒ…çš„åæ ‡éƒ½åœ¨dependencieså±æ€§å†…æ”¾ç½®</span></span><br><span class="line"><span class="comment"> * 2. æ¯ä¸€ä¸ªjaråŒ…çš„åæ ‡éƒ½ç”±ä¸‰ä¸ªåŸºæœ¬å…ƒç´ ç»„æˆ groupã€nameã€version</span></span><br><span class="line"><span class="comment"> * 3. testCompile è¡¨ç¤ºè¯¥jaråŒ…åœ¨æµ‹è¯•çš„æ—¶å€™èµ·ä½œç”¨ï¼Œè¯¥å±æ€§ä¸ºjaråŒ…çš„ä½œç”¨åŸŸï¼›</span></span><br><span class="line"><span class="comment"> *    åœ¨gradleé‡Œé¢æ·»åŠ åæ ‡çš„æ—¶å€™éƒ½è¦å¸¦ä¸ŠjaråŒ…çš„ä½œç”¨åŸŸ</span></span><br><span class="line"><span class="comment"> * compile/testCompileå…¶å®æ˜¯ä¸€ä¸ªæ–¹æ³•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">dependencies &#123;</span><br><span class="line">    testCompile <span class="keyword">group</span>: <span class="string">'junit'</span>, <span class="keyword">name</span>: <span class="string">'junit'</span>, <span class="keyword">version</span>: <span class="string">'4.12'</span></span><br><span class="line">    compile <span class="keyword">group</span>: <span class="string">'org.springframework'</span>, <span class="keyword">name</span>: <span class="string">'spring-context'</span>, <span class="keyword">version</span>: <span class="string">'5.0.2.RELEASE'</span></span><br><span class="line">&#125;</span><br><span class="line">====================================================================</span><br></pre></td></tr></table></figure><h2 id="è®©gradleä½¿ç”¨æœ¬åœ°mavenä»“åº“"><a href="#è®©gradleä½¿ç”¨æœ¬åœ°mavenä»“åº“" class="headerlink" title="è®©gradleä½¿ç”¨æœ¬åœ°mavenä»“åº“"></a>è®©gradleä½¿ç”¨æœ¬åœ°mavenä»“åº“</h2><h2 id="gradleä»‹ç»03"><a href="#gradleä»‹ç»03" class="headerlink" title="gradleä»‹ç»03"></a>gradleä»‹ç»03</h2><h2 id="gradleå¼€å‘webå·¥ç¨‹"><a href="#gradleå¼€å‘webå·¥ç¨‹" class="headerlink" title="gradleå¼€å‘webå·¥ç¨‹"></a>gradleå¼€å‘webå·¥ç¨‹</h2><h2 id="gradleå·¥ç¨‹æ‹†åˆ†ä¸èšåˆ"><a href="#gradleå·¥ç¨‹æ‹†åˆ†ä¸èšåˆ" class="headerlink" title="gradleå·¥ç¨‹æ‹†åˆ†ä¸èšåˆ"></a>gradleå·¥ç¨‹æ‹†åˆ†ä¸èšåˆ</h2>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;è§‚çœ‹ç¬”è®°ï¼š&lt;code&gt;https://www.bilibili.com/video/BV1iW411C7CV?from=search&amp;amp
      
    
    </summary>
    
    
      <category term="ç¬”è®°" scheme="https://fengshana.github.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="ç¬”è®°" scheme="https://fengshana.github.io/tags/%E7%AC%94%E8%AE%B0/"/>
    
      <category term="Gradle" scheme="https://fengshana.github.io/tags/Gradle/"/>
    
  </entry>
  
  <entry>
    <title>javaå¿…å¤‡åŸºç¡€æ•™ç¨‹-MongoDBåŸºç¡€å…¥é—¨åˆ°é«˜çº§è¿›é˜¶</title>
    <link href="https://fengshana.github.io/2020/06/11/%E3%80%90MongoDB%E3%80%91/java%E5%BF%85%E5%A4%87%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B-MongoDB%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8%E5%88%B0%E9%AB%98%E7%BA%A7%E8%BF%9B%E9%98%B6/"/>
    <id>https://fengshana.github.io/2020/06/11/%E3%80%90MongoDB%E3%80%91/java%E5%BF%85%E5%A4%87%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B-MongoDB%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8%E5%88%B0%E9%AB%98%E7%BA%A7%E8%BF%9B%E9%98%B6/</id>
    <published>2020-06-11T15:48:50.000Z</published>
    <updated>2020-06-11T18:35:01.964Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è§‚çœ‹é“¾æ¥ï¼š<code>https://www.bilibili.com/video/BV1bJ411x7mq?from=search&amp;seid=450814707258177810</code>ã€‚</p><h2 id="è¯¾ç¨‹ç›®æ ‡"><a href="#è¯¾ç¨‹ç›®æ ‡" class="headerlink" title="è¯¾ç¨‹ç›®æ ‡"></a>è¯¾ç¨‹ç›®æ ‡</h2><blockquote><p>MongoDBå¿«é€Ÿä¸Šæ‰‹</p></blockquote><ul><li>MongoDBç›¸å…³æ¦‚å¿µ<ul><li>ä¸šåŠ¡åº”ç”¨åœºæ™¯</li><li>MongoDBç®€ä»‹</li><li>ä½“ç³»ç»“æ„</li><li>æ•°æ®æ¨¡å‹</li><li>MongoDBçš„ç‰¹ç‚¹</li></ul></li><li>å•æœºéƒ¨ç½²<ul><li>Windowsç³»ç»Ÿä¸­çš„å®‰è£…å¯åŠ¨</li><li>Shellè¿æ¥ï¼ˆmongoå‘½ä»¤ï¼‰</li><li>Compass-å›¾å½¢åŒ–ç•Œé¢å®¢æˆ·ç«¯</li><li>Linuxç³»ç»Ÿä¸­çš„å®‰è£…å¯åŠ¨å’Œè¿æ¥</li></ul></li><li>åŸºæœ¬å¸¸ç”¨å‘½ä»¤<ul><li>æ¡ˆä¾‹éœ€æ±‚</li><li>æ•°æ®åº“æ“ä½œ<ul><li>é€‰æ‹©å’Œåˆ›å»ºæ•°æ®åº“</li><li>æ•°æ®åº“çš„åˆ é™¤</li></ul></li><li>é›†åˆæ“ä½œ<ul><li>é›†åˆçš„æ˜¾å¼åˆ›å»ºï¼ˆäº†è§£ï¼‰</li><li>é›†åˆçš„éšå¼åˆ›å»º</li><li>é›†åˆçš„åˆ é™¤</li></ul></li><li>æ–‡æ¡£åŸºæœ¬CRUD<ul><li>æ–‡æ¡£çš„æ’å…¥</li><li>æ–‡æ¡£çš„åŸºæœ¬æŸ¥è¯¢</li><li>æ–‡æ¡£çš„åŸºæœ¬ä¿®æ”¹</li><li>åˆ é™¤æ–‡æ¡£</li></ul></li><li>æ–‡æ¡£çš„åˆ†é¡µæŸ¥è¯¢<ul><li>ç»Ÿè®¡æŸ¥è¯¢</li><li>åˆ†é¡µåˆ—è¡¨æŸ¥è¯¢</li></ul></li></ul></li></ul><h3 id="MongoDBå¿«é€Ÿä¸Šæ‰‹"><a href="#MongoDBå¿«é€Ÿä¸Šæ‰‹" class="headerlink" title="MongoDBå¿«é€Ÿä¸Šæ‰‹"></a>MongoDBå¿«é€Ÿä¸Šæ‰‹</h3><p>MongoDBç”¨èµ·æ¥ - å¿«é€Ÿä¸Šæ‰‹ &amp; é›†ç¾¤å’Œå®‰å…¨ç³»åˆ—</p><p>è¯¾ç¨‹ç›®æ ‡ï¼š</p><ul><li>ç†è§£MongoDBçš„ä¸šåŠ¡åœºæ™¯ã€ç†Ÿæ‚‰MongoDBçš„ç®€ä»‹ã€ç‰¹ç‚¹å’Œä½“ç³»ç»“æ„ã€æ•°æ®ç±»å‹ç­‰ã€‚</li><li>èƒ½å¤Ÿåœ¨windowså’Œlinuxä¸‹å®‰è£…å’Œå¯åŠ¨MongoDBã€å›¾å½¢åŒ–ç®¡ç†ç•Œé¢Compassçš„å®‰è£…ä½¿ç”¨</li><li>æŒæ¡MongoDBåŸºæœ¬å¸¸ç”¨å‘½ä»¤å®ç°æ•°æ®çš„CRUD</li><li>æŒæ¡MongoDBçš„ç´¢å¼•ç±»å‹ã€ç´¢å¼•ç®¡ç†ã€æ‰§è¡Œè®¡åˆ’ã€‚</li><li>ä½¿ç”¨Spring Data MongoDBï¼ˆJavaæ¡†æ¶ï¼‰å®Œæˆæ–‡ç« è¯„è®ºä¸šåŠ¡çš„å¼€å‘</li></ul><h3 id="MongoDBç›¸å…³æ¦‚å¿µ"><a href="#MongoDBç›¸å…³æ¦‚å¿µ" class="headerlink" title="MongoDBç›¸å…³æ¦‚å¿µ"></a>MongoDBç›¸å…³æ¦‚å¿µ</h3><h4 id="ä¸šåŠ¡åº”ç”¨åœºæ™¯"><a href="#ä¸šåŠ¡åº”ç”¨åœºæ™¯" class="headerlink" title="ä¸šåŠ¡åº”ç”¨åœºæ™¯"></a>ä¸šåŠ¡åº”ç”¨åœºæ™¯</h4><p>ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“ï¼ˆå¦‚MySQLï¼‰ï¼Œåœ¨æ•°æ®æ“ä½œçš„ â€œä¸‰é«˜â€ éœ€æ±‚ä»¥åŠåº”å¯¹ Web2.0çš„ç½‘ç«™éœ€æ±‚é¢å‰ï¼Œæ˜¾å¾—åŠ›ä¸ä»å¿ƒã€‚<br>è§£é‡Šï¼šâ€œä¸‰é«˜â€éœ€æ±‚</p><ul><li>High proformance - å¯¹æ•°æ®<strong>é«˜å¹¶å‘è¯»å†™</strong>çš„éœ€æ±‚ã€‚</li><li>Huge Storage - å¯¹<strong>æµ·é‡æ•°æ®</strong>çš„<strong>é«˜æ•ˆç‡å­˜å‚¨å’Œè®¿é—®</strong>çš„éœ€æ±‚ã€‚</li><li>High Scalability &amp;&amp; High Availability - å¯¹<strong>æ•°æ®åº“</strong>çš„<strong>é«˜æ‰©å±•æ€§å’Œé«˜å¯ç”¨æ€§</strong>çš„éœ€æ±‚ã€‚</li></ul><p>è€Œ<strong>MongoDBå¯åº”å¯¹â€œä¸‰é«˜â€éœ€æ±‚</strong>ã€‚</p><h2 id="MongoDB-åº”ç”¨åœºæ™¯"><a href="#MongoDB-åº”ç”¨åœºæ™¯" class="headerlink" title="MongoDB-åº”ç”¨åœºæ™¯"></a>MongoDB-åº”ç”¨åœºæ™¯</h2><h2 id="MongoDBç®€ä»‹-amp-ä½“ç³»ç»“æ„-amp-æ•°æ®æ¨¡å‹-amp-ç‰¹ç‚¹"><a href="#MongoDBç®€ä»‹-amp-ä½“ç³»ç»“æ„-amp-æ•°æ®æ¨¡å‹-amp-ç‰¹ç‚¹" class="headerlink" title="MongoDBç®€ä»‹ &amp; ä½“ç³»ç»“æ„ &amp; æ•°æ®æ¨¡å‹ &amp; ç‰¹ç‚¹"></a>MongoDBç®€ä»‹ &amp; ä½“ç³»ç»“æ„ &amp; æ•°æ®æ¨¡å‹ &amp; ç‰¹ç‚¹</h2><h2 id="windowså¯åŠ¨å’Œéƒ¨ç½²"><a href="#windowså¯åŠ¨å’Œéƒ¨ç½²" class="headerlink" title="windowså¯åŠ¨å’Œéƒ¨ç½²"></a>windowså¯åŠ¨å’Œéƒ¨ç½²</h2><h2 id="shellè¿æ¥-amp-compassä½¿ç”¨"><a href="#shellè¿æ¥-amp-compassä½¿ç”¨" class="headerlink" title="shellè¿æ¥ &amp; compassä½¿ç”¨"></a>shellè¿æ¥ &amp; compassä½¿ç”¨</h2><h2 id="linuxç³»ç»Ÿä¸­çš„å®‰è£…å¯åŠ¨å’Œè¿æ¥"><a href="#linuxç³»ç»Ÿä¸­çš„å®‰è£…å¯åŠ¨å’Œè¿æ¥" class="headerlink" title="linuxç³»ç»Ÿä¸­çš„å®‰è£…å¯åŠ¨å’Œè¿æ¥"></a>linuxç³»ç»Ÿä¸­çš„å®‰è£…å¯åŠ¨å’Œè¿æ¥</h2><h2 id="æ•°æ®åº“çš„åˆ›å»ºå’Œåˆ é™¤"><a href="#æ•°æ®åº“çš„åˆ›å»ºå’Œåˆ é™¤" class="headerlink" title="æ•°æ®åº“çš„åˆ›å»ºå’Œåˆ é™¤"></a>æ•°æ®åº“çš„åˆ›å»ºå’Œåˆ é™¤</h2><h2 id="é›†åˆçš„åˆ›å»ºå’Œåˆ é™¤"><a href="#é›†åˆçš„åˆ›å»ºå’Œåˆ é™¤" class="headerlink" title="é›†åˆçš„åˆ›å»ºå’Œåˆ é™¤"></a>é›†åˆçš„åˆ›å»ºå’Œåˆ é™¤</h2><h2 id="æ–‡æ¡£çš„æ’å…¥å’ŒæŸ¥è¯¢"><a href="#æ–‡æ¡£çš„æ’å…¥å’ŒæŸ¥è¯¢" class="headerlink" title="æ–‡æ¡£çš„æ’å…¥å’ŒæŸ¥è¯¢"></a>æ–‡æ¡£çš„æ’å…¥å’ŒæŸ¥è¯¢</h2><h2 id="æ–‡æ¡£æ’å…¥ä½¿ç”¨-try-catch"><a href="#æ–‡æ¡£æ’å…¥ä½¿ç”¨-try-catch" class="headerlink" title="æ–‡æ¡£æ’å…¥ä½¿ç”¨ try catch"></a>æ–‡æ¡£æ’å…¥ä½¿ç”¨ try catch</h2><h2 id="æ–‡æ¡£çš„æ›´æ–°æ“ä½œ"><a href="#æ–‡æ¡£çš„æ›´æ–°æ“ä½œ" class="headerlink" title="æ–‡æ¡£çš„æ›´æ–°æ“ä½œ"></a>æ–‡æ¡£çš„æ›´æ–°æ“ä½œ</h2><h2 id="æ–‡æ¡£çš„åˆ é™¤æ“ä½œ"><a href="#æ–‡æ¡£çš„åˆ é™¤æ“ä½œ" class="headerlink" title="æ–‡æ¡£çš„åˆ é™¤æ“ä½œ"></a>æ–‡æ¡£çš„åˆ é™¤æ“ä½œ</h2><h2 id="æ–‡æ¡£çš„åˆ†é¡µæŸ¥è¯¢"><a href="#æ–‡æ¡£çš„åˆ†é¡µæŸ¥è¯¢" class="headerlink" title="æ–‡æ¡£çš„åˆ†é¡µæŸ¥è¯¢"></a>æ–‡æ¡£çš„åˆ†é¡µæŸ¥è¯¢</h2><h2 id="æ–‡æ¡£çš„æ›´å¤šæŸ¥è¯¢"><a href="#æ–‡æ¡£çš„æ›´å¤šæŸ¥è¯¢" class="headerlink" title="æ–‡æ¡£çš„æ›´å¤šæŸ¥è¯¢"></a>æ–‡æ¡£çš„æ›´å¤šæŸ¥è¯¢</h2><h2 id="ç´¢å¼•çš„æ¦‚è¿°å’Œç±»å‹"><a href="#ç´¢å¼•çš„æ¦‚è¿°å’Œç±»å‹" class="headerlink" title="ç´¢å¼•çš„æ¦‚è¿°å’Œç±»å‹"></a>ç´¢å¼•çš„æ¦‚è¿°å’Œç±»å‹</h2><h2 id="ç´¢å¼•çš„ç®¡ç†æ“ä½œ"><a href="#ç´¢å¼•çš„ç®¡ç†æ“ä½œ" class="headerlink" title="ç´¢å¼•çš„ç®¡ç†æ“ä½œ"></a>ç´¢å¼•çš„ç®¡ç†æ“ä½œ</h2><h2 id="ç´¢å¼•çš„ä½¿ç”¨-æ‰§è¡Œè®¡åˆ’"><a href="#ç´¢å¼•çš„ä½¿ç”¨-æ‰§è¡Œè®¡åˆ’" class="headerlink" title="ç´¢å¼•çš„ä½¿ç”¨ æ‰§è¡Œè®¡åˆ’"></a>ç´¢å¼•çš„ä½¿ç”¨ æ‰§è¡Œè®¡åˆ’</h2><h2 id="ç´¢å¼•çš„ä½¿ç”¨-æ¶µç›–çš„æŸ¥è¯¢"><a href="#ç´¢å¼•çš„ä½¿ç”¨-æ¶µç›–çš„æŸ¥è¯¢" class="headerlink" title="ç´¢å¼•çš„ä½¿ç”¨ æ¶µç›–çš„æŸ¥è¯¢"></a>ç´¢å¼•çš„ä½¿ç”¨ æ¶µç›–çš„æŸ¥è¯¢</h2><h2 id="æ–‡ç« è¯„è®º-éœ€æ±‚-amp-è¡¨ç»“æ„-amp-æŠ€æœ¯é€‰å‹"><a href="#æ–‡ç« è¯„è®º-éœ€æ±‚-amp-è¡¨ç»“æ„-amp-æŠ€æœ¯é€‰å‹" class="headerlink" title="æ–‡ç« è¯„è®º éœ€æ±‚ &amp; è¡¨ç»“æ„ &amp; æŠ€æœ¯é€‰å‹"></a>æ–‡ç« è¯„è®º éœ€æ±‚ &amp; è¡¨ç»“æ„ &amp; æŠ€æœ¯é€‰å‹</h2><h2 id="æ–‡ç« å¾®æœåŠ¡æ¨¡å—æ­å»º"><a href="#æ–‡ç« å¾®æœåŠ¡æ¨¡å—æ­å»º" class="headerlink" title="æ–‡ç« å¾®æœåŠ¡æ¨¡å—æ­å»º"></a>æ–‡ç« å¾®æœåŠ¡æ¨¡å—æ­å»º</h2><h2 id="æ–‡ç« è¯„è®ºå®ä½“ç±»çš„ç¼–å†™"><a href="#æ–‡ç« è¯„è®ºå®ä½“ç±»çš„ç¼–å†™" class="headerlink" title="æ–‡ç« è¯„è®ºå®ä½“ç±»çš„ç¼–å†™"></a>æ–‡ç« è¯„è®ºå®ä½“ç±»çš„ç¼–å†™</h2><h2 id="æ–‡ç« è¯„è®ºçš„åŸºæœ¬å¢åˆ æ”¹æŸ¥"><a href="#æ–‡ç« è¯„è®ºçš„åŸºæœ¬å¢åˆ æ”¹æŸ¥" class="headerlink" title="æ–‡ç« è¯„è®ºçš„åŸºæœ¬å¢åˆ æ”¹æŸ¥"></a>æ–‡ç« è¯„è®ºçš„åŸºæœ¬å¢åˆ æ”¹æŸ¥</h2><h2 id="æ ¹æ®ä¸Šçº§IDæŸ¥è¯¢æ–‡ç« è¯„è®ºçš„åˆ†é¡µåˆ—è¡¨"><a href="#æ ¹æ®ä¸Šçº§IDæŸ¥è¯¢æ–‡ç« è¯„è®ºçš„åˆ†é¡µåˆ—è¡¨" class="headerlink" title="æ ¹æ®ä¸Šçº§IDæŸ¥è¯¢æ–‡ç« è¯„è®ºçš„åˆ†é¡µåˆ—è¡¨"></a>æ ¹æ®ä¸Šçº§IDæŸ¥è¯¢æ–‡ç« è¯„è®ºçš„åˆ†é¡µåˆ—è¡¨</h2><h2 id="MongoTemplateå®ç°è¯„è®ºç‚¹èµ"><a href="#MongoTemplateå®ç°è¯„è®ºç‚¹èµ" class="headerlink" title="MongoTemplateå®ç°è¯„è®ºç‚¹èµ"></a>MongoTemplateå®ç°è¯„è®ºç‚¹èµ</h2><h2 id="è¯¾ç¨‹ç›®æ ‡-å‰¯æœ¬é›†çš„ä¸‰ä¸ªè§’è‰²"><a href="#è¯¾ç¨‹ç›®æ ‡-å‰¯æœ¬é›†çš„ä¸‰ä¸ªè§’è‰²" class="headerlink" title="è¯¾ç¨‹ç›®æ ‡ å‰¯æœ¬é›†çš„ä¸‰ä¸ªè§’è‰²"></a>è¯¾ç¨‹ç›®æ ‡ å‰¯æœ¬é›†çš„ä¸‰ä¸ªè§’è‰²</h2><h2 id="å‰¯æœ¬é›†çš„åˆ›å»º"><a href="#å‰¯æœ¬é›†çš„åˆ›å»º" class="headerlink" title="å‰¯æœ¬é›†çš„åˆ›å»º"></a>å‰¯æœ¬é›†çš„åˆ›å»º</h2><h2 id="åˆå§‹åŒ–å‰¯æœ¬é›†"><a href="#åˆå§‹åŒ–å‰¯æœ¬é›†" class="headerlink" title="åˆå§‹åŒ–å‰¯æœ¬é›†"></a>åˆå§‹åŒ–å‰¯æœ¬é›†</h2><h2 id="æ·»åŠ å‰¯æœ¬èŠ‚ç‚¹å’Œä»²è£èŠ‚ç‚¹"><a href="#æ·»åŠ å‰¯æœ¬èŠ‚ç‚¹å’Œä»²è£èŠ‚ç‚¹" class="headerlink" title="æ·»åŠ å‰¯æœ¬èŠ‚ç‚¹å’Œä»²è£èŠ‚ç‚¹"></a>æ·»åŠ å‰¯æœ¬èŠ‚ç‚¹å’Œä»²è£èŠ‚ç‚¹</h2><h2 id="å‰¯æœ¬é›†åˆæ•°æ®çš„è¯»å†™æ“ä½œ"><a href="#å‰¯æœ¬é›†åˆæ•°æ®çš„è¯»å†™æ“ä½œ" class="headerlink" title="å‰¯æœ¬é›†åˆæ•°æ®çš„è¯»å†™æ“ä½œ"></a>å‰¯æœ¬é›†åˆæ•°æ®çš„è¯»å†™æ“ä½œ</h2><h2 id="ä»²è£èŠ‚ç‚¹æ•°æ®æ“ä½œ"><a href="#ä»²è£èŠ‚ç‚¹æ•°æ®æ“ä½œ" class="headerlink" title="ä»²è£èŠ‚ç‚¹æ•°æ®æ“ä½œ"></a>ä»²è£èŠ‚ç‚¹æ•°æ®æ“ä½œ</h2><h2 id="ä¸»èŠ‚ç‚¹çš„é€‰ä¸¾åŸåˆ™"><a href="#ä¸»èŠ‚ç‚¹çš„é€‰ä¸¾åŸåˆ™" class="headerlink" title="ä¸»èŠ‚ç‚¹çš„é€‰ä¸¾åŸåˆ™"></a>ä¸»èŠ‚ç‚¹çš„é€‰ä¸¾åŸåˆ™</h2><h2 id="æ•…éšœæµ‹è¯•-1"><a href="#æ•…éšœæµ‹è¯•-1" class="headerlink" title="æ•…éšœæµ‹è¯•_1"></a>æ•…éšœæµ‹è¯•_1</h2><h2 id="æ•…éšœæµ‹è¯•"><a href="#æ•…éšœæµ‹è¯•" class="headerlink" title="æ•…éšœæµ‹è¯•"></a>æ•…éšœæµ‹è¯•</h2><h2 id="SpringDataè¿æ¥å‰¯æœ¬é›†"><a href="#SpringDataè¿æ¥å‰¯æœ¬é›†" class="headerlink" title="SpringDataè¿æ¥å‰¯æœ¬é›†"></a>SpringDataè¿æ¥å‰¯æœ¬é›†</h2><h2 id="åˆ†ç‰‡æ¦‚å¿µ-amp-æ¶æ„ç›®æ ‡"><a href="#åˆ†ç‰‡æ¦‚å¿µ-amp-æ¶æ„ç›®æ ‡" class="headerlink" title="åˆ†ç‰‡æ¦‚å¿µ &amp; æ¶æ„ç›®æ ‡"></a>åˆ†ç‰‡æ¦‚å¿µ &amp; æ¶æ„ç›®æ ‡</h2><h2 id="åˆ†ç‰‡ç¬¬ä¸€å¥—å’Œç¬¬äºŒå¥—å‰¯æœ¬é›†æ­å»º"><a href="#åˆ†ç‰‡ç¬¬ä¸€å¥—å’Œç¬¬äºŒå¥—å‰¯æœ¬é›†æ­å»º" class="headerlink" title="åˆ†ç‰‡ç¬¬ä¸€å¥—å’Œç¬¬äºŒå¥—å‰¯æœ¬é›†æ­å»º"></a>åˆ†ç‰‡ç¬¬ä¸€å¥—å’Œç¬¬äºŒå¥—å‰¯æœ¬é›†æ­å»º</h2><h2 id="é…ç½®å‰¯æœ¬é›†æ­å»º"><a href="#é…ç½®å‰¯æœ¬é›†æ­å»º" class="headerlink" title="é…ç½®å‰¯æœ¬é›†æ­å»º"></a>é…ç½®å‰¯æœ¬é›†æ­å»º</h2><h2 id="åˆå§‹åŒ–ä¸‰å¥—å‰¯æœ¬é›†"><a href="#åˆå§‹åŒ–ä¸‰å¥—å‰¯æœ¬é›†" class="headerlink" title="åˆå§‹åŒ–ä¸‰å¥—å‰¯æœ¬é›†"></a>åˆå§‹åŒ–ä¸‰å¥—å‰¯æœ¬é›†</h2><h2 id="ç¬¬ä¸€ä¸ªè·¯ç”±èŠ‚ç‚¹åˆ›å»º"><a href="#ç¬¬ä¸€ä¸ªè·¯ç”±èŠ‚ç‚¹åˆ›å»º" class="headerlink" title="ç¬¬ä¸€ä¸ªè·¯ç”±èŠ‚ç‚¹åˆ›å»º"></a>ç¬¬ä¸€ä¸ªè·¯ç”±èŠ‚ç‚¹åˆ›å»º</h2><h2 id="è·¯ç”±èŠ‚ç‚¹è¿›è¡Œåˆ†ç‰‡æ“ä½œ"><a href="#è·¯ç”±èŠ‚ç‚¹è¿›è¡Œåˆ†ç‰‡æ“ä½œ" class="headerlink" title="è·¯ç”±èŠ‚ç‚¹è¿›è¡Œåˆ†ç‰‡æ“ä½œ"></a>è·¯ç”±èŠ‚ç‚¹è¿›è¡Œåˆ†ç‰‡æ“ä½œ</h2><h2 id="åˆ†ç‰‡ç­–ç•¥-å“ˆå¸Œ-amp-èŒƒå›´æ¼”ç¤º"><a href="#åˆ†ç‰‡ç­–ç•¥-å“ˆå¸Œ-amp-èŒƒå›´æ¼”ç¤º" class="headerlink" title="åˆ†ç‰‡ç­–ç•¥ å“ˆå¸Œ &amp; èŒƒå›´æ¼”ç¤º"></a>åˆ†ç‰‡ç­–ç•¥ å“ˆå¸Œ &amp; èŒƒå›´æ¼”ç¤º</h2><h2 id="å†å¢åŠ ä¸€ä¸ªè·¯ç”±èŠ‚ç‚¹"><a href="#å†å¢åŠ ä¸€ä¸ªè·¯ç”±èŠ‚ç‚¹" class="headerlink" title="å†å¢åŠ ä¸€ä¸ªè·¯ç”±èŠ‚ç‚¹"></a>å†å¢åŠ ä¸€ä¸ªè·¯ç”±èŠ‚ç‚¹</h2><h2 id="compass-amp-springDataè¿æ¥æµ‹è¯•"><a href="#compass-amp-springDataè¿æ¥æµ‹è¯•" class="headerlink" title="compass &amp; springDataè¿æ¥æµ‹è¯•"></a>compass &amp; springDataè¿æ¥æµ‹è¯•</h2><h2 id="å®‰å…¨è®¤è¯ç®€ä»‹"><a href="#å®‰å…¨è®¤è¯ç®€ä»‹" class="headerlink" title="å®‰å…¨è®¤è¯ç®€ä»‹"></a>å®‰å…¨è®¤è¯ç®€ä»‹</h2><h2 id="æ·»åŠ ç”¨æˆ·å’Œæƒé™"><a href="#æ·»åŠ ç”¨æˆ·å’Œæƒé™" class="headerlink" title="æ·»åŠ ç”¨æˆ·å’Œæƒé™"></a>æ·»åŠ ç”¨æˆ·å’Œæƒé™</h2><h2 id="å•å®ä¾‹-æœåŠ¡ç«¯å¼€å¯-amp-å®¢æˆ·ç«¯ç™»å½•éªŒè¯"><a href="#å•å®ä¾‹-æœåŠ¡ç«¯å¼€å¯-amp-å®¢æˆ·ç«¯ç™»å½•éªŒè¯" class="headerlink" title="å•å®ä¾‹-æœåŠ¡ç«¯å¼€å¯ &amp; å®¢æˆ·ç«¯ç™»å½•éªŒè¯"></a>å•å®ä¾‹-æœåŠ¡ç«¯å¼€å¯ &amp; å®¢æˆ·ç«¯ç™»å½•éªŒè¯</h2><h2 id="springDataè®¤è¯è¿æ¥"><a href="#springDataè®¤è¯è¿æ¥" class="headerlink" title="springDataè®¤è¯è¿æ¥"></a>springDataè®¤è¯è¿æ¥</h2><h2 id="å‰¯æœ¬é›†å®‰å…¨è®¤è¯"><a href="#å‰¯æœ¬é›†å®‰å…¨è®¤è¯" class="headerlink" title="å‰¯æœ¬é›†å®‰å…¨è®¤è¯"></a>å‰¯æœ¬é›†å®‰å…¨è®¤è¯</h2><h2 id="åˆ†ç‰‡é›†ç¾¤å®‰å…¨è®¤è¯"><a href="#åˆ†ç‰‡é›†ç¾¤å®‰å…¨è®¤è¯" class="headerlink" title="åˆ†ç‰‡é›†ç¾¤å®‰å…¨è®¤è¯"></a>åˆ†ç‰‡é›†ç¾¤å®‰å…¨è®¤è¯</h2>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;è§‚çœ‹é“¾æ¥ï¼š&lt;code&gt;https://www.bilibili.com/video/BV1bJ411x7mq?from=search&amp;amp
      
    
    </summary>
    
    
      <category term="MongoDB" scheme="https://fengshana.github.io/categories/MongoDB/"/>
    
    
      <category term="MongoDB" scheme="https://fengshana.github.io/tags/MongoDB/"/>
    
  </entry>
  
  <entry>
    <title>æ·±å…¥ç†è§£java8</title>
    <link href="https://fengshana.github.io/2020/06/11/%E3%80%90JDK8%E3%80%91/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3java8/"/>
    <id>https://fengshana.github.io/2020/06/11/%E3%80%90JDK8%E3%80%91/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3java8/</id>
    <published>2020-06-11T15:48:50.000Z</published>
    <updated>2020-06-15T04:29:07.295Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è§‚çœ‹ç¬”è®°ï¼š<a href="https://www.bilibili.com/video/BV1w4411e7T8?p=1" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1w4411e7T8?p=1</a>  </p><p>çœ‹å®Œä¹¦ä¹‹åä¸€å®šè¦åšæ€»ç»“ï¼›å°†ä¹¦ä¸­çš„å†…å®¹æˆ–è€…æ˜¯è§†é¢‘ä¸­çš„å†…å®¹å½¢æˆè‡ªå·±çš„çŸ¥è¯†ä½“ç³»ï¼›è¿™æ ·çš„è¯è¿™ä¸ªä¹¦çš„ç›®çš„æˆ–è€…æ˜¯è¿™ä¸ªè§†é¢‘çš„ç›®çš„æ‰è¾¾åˆ°äº†ï¼›<br>ä¸å»ºè®®å°†è§†é¢‘ä¸è¦ç¿»æ¥è¦†å»çš„çœ‹ï¼›åœ¨è¾¹çœ‹çš„åŒæ—¶å°†è‡ªå·±ä¸äº†è§£çš„æˆ–è€…æ˜¯ä¸€äº›é‡ç‚¹åšå¥½è®°å½•ï¼›ä»¥åŠæ¥ä¸‹æ¥ä¸€å®šè¦åŠ¨æ‰‹è‡ªå·±è¦å»ç¼–å†™ä»£ç ï¼›å¦åˆ™çœ‹è§†é¢‘å°±è·Ÿçœ‹ä¹¦ä¸€æ ·è¿‡ä¸¤å¤©å°±å…¨å¿˜äº†ï¼›å¿˜äº†çš„ç»“æœå°±æ˜¯çœ‹å®Œä¹‹ååˆè¦é‡å¤´å»çœ‹ä¸€éï¼›è§†é¢‘ä¹Ÿæ˜¯ä¸€æ ·ï¼›æ‰€èŠ±è´¹çš„æ—¶é—´æˆæœ¬å¤§ï¼›<br>è¯¥è®°å½•çš„æ—¶å€™è®°å½•åšç¬”è®°çš„æ—¶å€™åšç¬”è®°æ•²ä»£ç çš„æ—¶å€™æ•²ä»£ç è¯¥çœ‹æºä»£ç çš„æ—¶å€™çœ‹æºä»£ç ï¼›<br>çœ‹è§†é¢‘ç»éä¸€ä¸ªç›®çš„ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªæ‰‹æ®µï¼›çœ‹ä¹¦ä¹Ÿåªæ˜¯ä¸€ä¸ªæ‰‹æ®µï¼›ä¸èƒ½å°†çœ‹ä¹¦å½“åšæ˜¯ä¸€ä¸ªç›®çš„ï¼›<br>å¦‚æœè¯´æ˜¯æŠŠçœ‹ä¹¦æˆ–è€…æ˜¯çœ‹è§†é¢‘å½“åšæ˜¯ä¸€ç§ç›®çš„çš„è¯ï¼Œé‚£ä¹ˆè¿™æ˜¯ä¸€ç§é”™è¯¯çš„åšæ³•ï¼›<br>å°†æ•ˆç‡æå‡ä¸Šæ¥ï¼›è¿™æ ·ä¸ä»…ä»…æ˜¯è§†é¢‘ä»¥åŠçœ‹ä¹¦æ‰èƒ½å¤Ÿå»å‘æŒ¥å®ƒæœ€å¤§çš„æ•ˆæœï¼›</p><p>(ç³»ç»Ÿå®Œæ•´æ·±å…¥)  </p><ul><li>è¯¾ç¨‹è¯´æ˜ï¼ˆè¯¾ç¨‹çš„å‘å¸ƒé¡ºåºï¼‰<ul><li>â‘  æ·±å…¥Java8<ul><li>jdk8ç›¸å…³å†…å®¹</li></ul></li><li>â‘£ å¹¶å‘ä¸Netty<ul><li>Nettyè¿™ä¸ªæ¡†æ¶æœ¬èº«æ¯”è¾ƒå¤æ‚ï¼›</li><li>å¦‚ä½•å°†Nettyç”¨å¥½ï¼ŒNettyæ¶‰åŠåˆ°çš„ä¸€äº›æ¨¡å¼æ¶‰åŠåˆ°çš„ä¸€äº›åº•å±‚çš„å†…å®¹ï¼›</li><li>åŒ…æ‹¬å¯¹äºRPCçš„æ”¯æŒã€å¯¹äºWebSocketè¿™ç§é•¿è¿æ¥çš„æ”¯æŒï¼ŒNettyæ˜¯å¦‚ä½•å®ç°çš„ï¼›Nettyæ¥å£ã€APIä¹Ÿæ˜¯åŸºäºå¼‚æ­¥å¤„ç†ï¼›</li><li>ä¸€æ—¦æ¥è§¦åˆ°å¼‚æ­¥ï¼Œå¤æ‚åº¦ä¸Šå‡ï¼›</li><li>Nettyé«˜æ€§èƒ½å¯ä»¥å¤„ç†å¤§é‡çš„å¹¶å‘ï¼Œå…¶ååé‡ä¹Ÿæ˜¯ä¸é”™çš„ï¼›</li><li>å› æ­¤åœ¨å¾ˆå¤šçš„äº’è”ç½‘å…¬å¸ä¹Ÿæ˜¯å¾—åˆ°äº†å¾ˆå¤šçš„åº”ç”¨ï¼›</li><li>Nettyä¸Nodejsä¸€æ ·ä¹Ÿæ˜¯åŸºäºå¼‚æ­¥ï¼Œå¼‚æ­¥å¤„ç†ï¼›</li><li>Nettyå½“ä¸­çš„æ¥å£ï¼Œæˆ–è€…æ˜¯APIå…¶å®éƒ½æ˜¯å¼‚æ­¥çš„ï¼›ï¼ˆè€Œä¸€æ—¦æ¶‰åŠåˆ°å¼‚æ­¥ï¼Œå¤æ‚ç¨‹åº¦ç«‹åˆ»ä¸Šå‡ï¼›ï¼‰</li><li>å› ä¸ºå¼‚æ­¥ï¼Œæ¯”å¦‚è¯´å†™SpringMVCã€Servletè¿™ç§æ˜¯ä¸ä¸€æ ·çš„ï¼›å› ä¸ºç›¸å¯¹äºSpringMVCè¿™ç§æ¡†æ¶æ¥è¯´ï¼Œå‘ä¸€ä¸ªè¯·æ±‚ï¼Œç„¶åæœåŠ¡ç«¯ç”¨ä¸€ä¸ªçº¿ç¨‹å»å¤„ç†å‰ç«¯å‘è¿‡æ¥çš„è¿™ä¸ªè¯·æ±‚ï¼Œä»æ¥å—è¯·æ±‚åˆ°ä¸€ç›´å°†è¿™ä¸ªå“åº”åé¦ˆç»™å‰ç«¯ï¼Œè¿™å…¶ä¸­éƒ½æ˜¯ç”±ä¸€ä¸ªçº¿ç¨‹æ¥è¿›è¡Œå®Œæˆçš„ä¸€ä¸ªå®Œæ•´å¤„ç†ï¼›å³æ•´ä¸ªæµç¨‹éƒ½æ˜¯æ¸…æ¥šè€Œåˆè‡ªç„¶çš„ï¼›</li><li>è€Œä¸€æ—¦æ¶‰åŠåˆ°å¼‚æ­¥å°±ä¸æ˜¯è¿™ä¸ªæ ·å­äº†ï¼Œå¼‚æ­¥ä¸€èˆ¬éƒ½æ˜¯åŸºäºäº‹ä»¶ï¼ŒåŸºäºå›è°ƒçš„ï¼›</li><li>é‚£ä¹ˆå½“è¿™ä¸ªäº‹ä»¶ä¸€æ—¦å‘ç”Ÿäº†ï¼Œé‚£ä¹ˆå…¶å¯¹åº”çš„æ–¹æ³•å°±ä¼šè¢«è°ƒç”¨ï¼Œå³è¢«æŸä¸ªçº¿ç¨‹è°ƒç”¨ï¼›è€Œçº¿ç¨‹å®Œæˆä¹‹åè¯¥çº¿ç¨‹ä¸ä¼šå»ç»§ç»­å¾€ä¸‹èµ°ï¼Œè€Œæ˜¯å»å¤„ç†å…¶ä»–åœ°æ–¹å»äº†ï¼›</li><li>é‚£ä¹ˆç­‰è¿™ä¸ªäº‹ä»¶for exampleï¼šIOæ“ä½œå®Œæˆä¹‹åï¼Œè¯¥æ¡†æ¶/çº¿ç¨‹æ”¶åˆ°äº‹ä»¶çš„ä¸€ä¸ªç´§æ€¥çš„é€šçŸ¥é‚£ä¹ˆå…¶å°±å°†ä¼šå»ç´§æ¥ç€åç»­çš„ä»£ç ï¼›</li><li>å…³äºNettyæˆ–è€…æ˜¯Nodejsæ¥è¯´ï¼Œæ„Ÿè§‰å°±æ˜¯ç¨‹åºåœ¨æ•´ä¸ªæ‰§è¡Œè¿‡ç¨‹å½“ä¸­å°±æ˜¯è·³æ¥è·³å»çš„ï¼›ä¸€ä¼šè·³åˆ°è¿™é‡Œä¸€ä¼šè·³åˆ°å“ªé‡Œï¼Œå³æ²¡æœ‰ä¸€ä¸ªå¯¹å¼‚æ­¥å¥½çš„ä¸€ä¸ªç†è§£çš„è¯é‚£ä¹ˆæ˜¯ä¸å¤ªå®¹æ˜“è¿™ä¸¤ä¸ªæ¡†æ¶æˆ–è€…æ˜¯è¿™ä¸¤é—¨æŠ€æœ¯çš„ï¼›è€Œè¿™ä¸¤é—¨æŠ€æœ¯æœ¬èº«åˆæ˜¯æ¯”è¾ƒé‡è¦çš„ï¼›</li><li>åŸºæœ¬æˆä¸ºå›½å†…äº’è”ç½‘å…¬å¸çš„æ ‡é…ï¼›å› ä¸ºNettyæ˜¯é«˜æ€§èƒ½çš„ï¼›å¯ä»¥å¤„ç†å¤§é‡çš„å¹¶å‘ï¼›ååé‡ä¹Ÿæ˜¯ä¸é”™çš„ï¼›å› æ­¤åœ¨å¾ˆå¤šçš„äº’è”ç½‘å…¬å¸éƒ½å¾—åˆ°å’Œå¹¿æ³›åœ°åº”ç”¨ï¼›</li><li>è®²Nettyè¿˜ä¼šæ¶‰åŠåˆ°Nettyåº•å±‚çš„ä¸€äº›æºä»£ç çš„æ¢³ç†ï¼›</li></ul></li><li>â‘¤ JVM<ul><li>å…³äºJVMçš„ä»‹ç»</li><li>è™½ç„¶æ¯å¤©éƒ½åœ¨JVMä¸Šå¼€å‘ï¼Œç¨‹åºè·‘åœ¨JVMä¸Šé¢ï¼›ä½†æ˜¯å¯¹äºJVMçš„äº†è§£å¹¶ä¸æ˜¯å¾ˆå¤šäººèƒ½å¤Ÿåšåˆ°çš„ä¸€ä»¶äº‹æƒ…ï¼›è€Œä¸”JVMå½“ä¸­æ¶‰åŠåˆ°çš„çŸ¥è¯†ä½“ç³»ç†è®ºä½“ç³»ä»¥åŠæ–¹æ³•å®è·µæ˜¯éå¸¸å¤šçš„ï¼›è€Œä¸”æ¶‰åŠåˆ°ä¸€äº›ç›¸å…³çš„ä¸€äº›å·¥å…·ï¼›</li><li>Javaå†…å­˜æ¨¡å‹ã€å„ç§é”ã€å¯è§æ€§ã€åŸå­æ€§æœ‰åºæ€§ç­‰éƒ½æ˜¯éå¸¸ç»†èŠ‚åŒ–ï¼Œè€Œä¸”åˆè·Ÿè®¡ç®—æœºç†è®ºç¡¬ä»¶ç­‰çº§åˆ«ç›¸å…³çš„ï¼›</li></ul></li><li>â‘¢ Node<ul><li>å…³äºNodejsçš„ä»‹ç»ï¼›</li><li>æ— è®ºæ˜¯åšå‰ç«¯è¿˜æ˜¯åšåå°ï¼ŒNodejséƒ½æ˜¯éœ€è¦å»æŒæ¡çš„ä¸€é—¨é‡è¦çš„æŠ€æœ¯ï¼›</li><li>å› ä¸ºé€šè¿‡Nodejså¯ä»¥å°†å‰åç«¯æ‰“é€šï¼›</li><li>æ­£æ‰€è°“å…¨æ ˆå·¥ç¨‹å¸ˆï¼›å…¨æ ˆå·¥ç¨‹å¸ˆæœ€æ—©å°±æ˜¯æ¥è‡ªäºåŸæ¥åšå‰ç«¯å¼€å‘å³ç”¨jså»å†™ä»£ç çš„åªèƒ½åšç•Œé¢ä¸Šçš„ä¸€äº›åŠŸèƒ½ï¼Œç°åœ¨ä¹Ÿå¯ä»¥è½¬åˆ°åç«¯è¿›è¡Œå¼€å‘ï¼Œå³é€šè¿‡Nodejsä¹Ÿå¯ä»¥è½¬åˆ°åç«¯å¼€å‘ï¼›</li><li>é€šè¿‡è¿™æ ·ä¸€ç§æ–¹å¼å°±å¯ä»¥å°†å‰åç«¯æ‰“é€šï¼›</li><li>å¯ä»¥é€šè¿‡ä¸€ç§è¯­è¨€æ—¢å¯ä»¥ä¸€è¾¹å†™å‰ç«¯åˆå¯ä»¥ä¸€è¾¹å†™åç«¯ï¼›</li><li>ç”šè‡³å‰åç«¯åˆ†ç¦»æ¨¡å¼ä¹Ÿæ˜¯å¯ä»¥é€šè¿‡Nodejsåšä¸­é—´çš„è½¬ä»‹å’Œæ¡¥æ¢ï¼›</li><li>Nodejsæœ¬èº«åŸºäºå¼‚æ­¥ï¼ŒNodejséƒ½æ˜¯å¼‚æ­¥å¤„ç†çš„ï¼›</li></ul></li><li>â‘¡ Springç²¾é«“<ul><li>å…³äºSpringåŸç†çŸ¥è¯†çš„ä¸€ä¸ªä»‹ç»å’Œè®²è§£</li></ul></li></ul></li></ul><p>å¼‚æ­¥åŸºäºäº‹ä»¶åŸºäºå›è°ƒå½“æŸä¸ªäº‹ä»¶å‘ç”Ÿäº†ä»è€ŒæŸäº›çº¿ç¨‹å°±ä¼šè°ƒç”¨ç›¸åº”çš„æ–¹æ³•ï¼›<br>çº¿ç¨‹å®Œæˆä¹‹åä¸ä¼šç»§ç»­å¾€ä¸‹èµ°è€Œæ˜¯å¤„ç†å…¶ä»–ä»»åŠ¡å»äº†ï¼›</p><h2 id="JAVA8æ–°ç‰¹æ€§è¯¾ç¨‹ä»‹ç»"><a href="#JAVA8æ–°ç‰¹æ€§è¯¾ç¨‹ä»‹ç»" class="headerlink" title="JAVA8æ–°ç‰¹æ€§è¯¾ç¨‹ä»‹ç»"></a>JAVA8æ–°ç‰¹æ€§è¯¾ç¨‹ä»‹ç»</h2><p>ä»‹ç»ï¼š<br>Java 8 å¯è°“Javaè¯­è¨€å†å²ä¸Šå˜åŒ–æœ€å¤§çš„ä¸€ä¸ªç‰ˆæœ¬ã€‚<br>å…¶æ‰¿è¯ºè¦ è°ƒæ•´Javaç¼–ç¨‹å‘ç€ <code>å‡½æ•°å¼é£æ ¼</code> è¿ˆè¿›ï¼Œ<br>è¿™æœ‰åŠ©äºç¼–å†™å‡º æ›´ä¸º<code>ç®€æ´ã€è¡¨è¾¾åŠ›æ›´å¼º</code>ï¼Œ<br>å¹¶ä¸”åœ¨å¾ˆå¤šæƒ…å†µä¸‹èƒ½å¤Ÿåˆ©ç”¨<code>å¹¶è¡Œç¡¬ä»¶</code>çš„ä»£ç <br>(å¹¶è¡Œç¡¬ä»¶ä»£ç ï¼šä¹‹å‰çš„<code>ä¸²è¡Œ</code>æ‰§è¡Œæµç¨‹ä»£ç ï¼Œç°åœ¨é€šè¿‡java8çš„ä¸€äº›æ–°ç‰¹æ€§ï¼Œæ¯”å¦‚è¯´Streamæµã€Lambdaè¡¨è¾¾å¼ç­‰ä¹‹ç±»çš„å°±å¯ä»¥<code>å¹¶è¡ŒåŒ–</code>çš„æ‰§è¡Œï¼›)ã€‚<br>æœ¬é—¨è¯¾ç¨‹å°†ä¼šæ·±å…¥ä»‹ç» Java8æ–°ç‰¹æ€§ï¼Œ<br>å°†ä¼šé€šè¿‡æœ¬é—¨è¯¾ç¨‹çš„å­¦ä¹ æ·±å…¥æŒæ¡Java8æ–°å¢ç‰¹æ€§å¹¶èƒ½çµæ´»è¿ç”¨åœ¨é¡¹ç›®ä¸­ã€‚<br>å­¦ä¹ è€…å°†å­¦ä¹ åˆ°å¦‚ä½•é€šè¿‡Lambdaè¡¨è¾¾å¼ä½¿ç”¨ä¸€è¡Œä»£ç ç¼–å†™Javaå‡½æ•°ï¼Œ<br>å¦‚æœé€šè¿‡è¿™ç§åŠŸèƒ½ä½¿ç”¨æ–°çš„Stream APIï¼ˆå³æµAPIï¼‰è¿›è¡Œç¼–ç¨‹ï¼Œ<br>å¦‚ä½•å°†å†—[ rÇ’ng ] é•¿çš„é›†åˆå¤„ç†ä»£ç å‹ç¼©ä¸ºç®€å•ä¸”å¯è¯»æ€§æ›´å¥½çš„æµç¨‹åºã€‚<br>å­¦ä¹ åˆ›å»ºå’Œæ¶ˆè´¹æµçš„æœºåˆ¶ï¼Œåˆ†æå…¶æ€§èƒ½ï¼Œèƒ½å¤Ÿåˆ¤æ–­ä½•æ—¶åº”è¯¥è°ƒç”¨APIçš„å¹¶è¡Œæ‰§è¡Œç‰¹æ€§ã€‚</p><p>ä¸å‡½æ•°å¼ç›¸å¯¹çš„ä¹‹å‰çš„é‚£ç§ç¼–ç¨‹æ–¹å¼ç§°ä¹‹ä¸ºå‘½ä»¤å¼ç¼–ç¨‹ï¼ˆå³ç»™å®ƒä¸€ä¸ªæŒ‡ä»¤å®ƒå°±æ‰§è¡Œä¸€ä¸ªæŒ‡ä»¤ï¼‰ï¼›<br>ä¹‹å‰javaé’ˆå¯¹çš„æ˜¯æ•°æ®ï¼Œå³ç»§æ‰¿å°è£…å¤šæ€ï¼›é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹æ€§ï¼›</p><ul><li>Java 8æ–°ç‰¹æ€§ä»‹ç»ï¼ˆæ¦‚è§ˆä¸€ä¸‹Java8æœ‰å“ªä¸€äº›æ–°ç‰¹æ€§ï¼‰</li><li>Lambdaè¡¨è¾¾å¼ä»‹ç»<ul><li>é€šè¿‡Lambdaè¡¨è¾¾å¼Javaä»ä¸€ä¸ªçº¯ç²¹çš„é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€è½¬å‘å‡½æ•°å¼çš„ç¼–ç¨‹è¯­è¨€ï¼›</li><li>å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ä¹‹å‰ä¹Ÿåœ¨å¾ˆå¤šçš„è¯­è¨€å½“ä¸­éƒ½æœ‰è¿‡ä½“ç°ï¼›</li><li>æ¯”å¦‚è¯´Pythonï¼Œå³Pythonæ”¯æŒLambdaè¡¨è¾¾å¼å³ä¸€ç§å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ï¼›</li><li>å¦å¤–åƒJavaScriptï¼Œæœ¬è´¨ä¸Šä¹Ÿæ˜¯å±äºä¸€ç§å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ï¼›å½“ç„¶JavaScriptä¹Ÿæ˜¯é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ï¼›</li><li>é‚£ä¹ˆå¦å¤–åƒScalaï¼ŒScalaæœ¬èº«å°±æ˜¯èåˆäº†é¢å‘å¯¹è±¡ä»¥åŠå‡½æ•°å¼è¿™ä¸¤ç§ç‰¹æ€§çš„é™æ€è¯­è¨€ï¼Œå¹¶ä¸”Scalaæ˜¯å¯ä»¥è¿è¡Œåœ¨JVMä¹‹ä¸Šçš„ï¼›</li><li>å‡½æ•°å¼ç¼–ç¨‹æœ€æ—©åªæ˜¯ä¸€å°éƒ¨åˆ†äººæ‰€æ¨å´‡çš„ä¸€ç§æ–¹å¼ï¼›å‡½æ•°å¼ç¼–ç¨‹å·²ç»ç”±æ¥å·²ä¹…ï¼›ä½†æ˜¯ä¹‹å‰ä¸€ç›´æ²¡æœ‰æµè¡Œèµ·æ¥ï¼›è‡ªä»è¿™å‡ å¹´å¤§æ•°æ®çš„å‡ºç°ï¼›å‡½æ•°å¼ç¼–ç¨‹å¼€å§‹å´­éœ²å¤´è§’æ¸æ¸è¢«æ›´å¤šçš„äººæ¥å—ï¼›</li><li>ä¸å‡½æ•°å¼ç¼–ç¨‹ç›¸å¯¹çš„ä¹‹å‰ä¸€ç›´ä½¿ç”¨çš„ç¼–ç¨‹æ–¹å¼å³å‘½ä»¤å¼çš„ç¼–ç¨‹ï¼›å‘½ä»¤å¼çš„ç¼–ç¨‹å³ç»™å®ƒä¸€ä¸ªæŒ‡ä»¤è®©å®ƒæ‰§è¡Œå°±å¯ä»¥äº†ï¼›</li><li>ä¹‹å‰æ¯”å¦‚è¯´åƒjavaè¿™ç§é¢å‘å¯¹è±¡è¿™æ ·çš„ç¼–ç¨‹è¯­è¨€é’ˆå¯¹çš„æ˜¯æ•°æ®ï¼Œå³é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹æ€§ï¼ˆå°è£…ç»§æ‰¿å¤šæ€ï¼‰ï¼›<ul><li>æ¯”å¦‚è¯´å°è£…ï¼Œå…¶å®ä½¿ç”¨é¢å‘å¯¹è±¡è¯­è¨€å®é™…ä¸Šæœ€ç»ˆæ“ä½œçš„å°±æ˜¯æ•°æ®ï¼ˆå°†å¯¹è±¡å°è£…åˆ°æ•°æ®å½“ä¸­ï¼Œè¿™ä¸ªå¯¹è±¡å¯ä»¥åœ¨æ„é€ æ–¹æ³•æˆ–è€…æ˜¯å„ä¸ªå±‚æ¬¡è°ƒç”¨ä¹‹é—´è¿›è¡Œå½¼æ­¤å€¼çš„ä¼ é€’ï¼Œä¼ é€’å®Œæˆä¹‹åå¯¹è¿™ä¸ªæ•°æ®è¿›è¡Œå¤„ç†ï¼Œå¤„ç†å®Œæˆä¹‹åå†å»å¯¹å…¶ä¸€ä¸ªæå–ã€æŠ½è±¡ç­‰ç›¸å…³æ“ä½œï¼Œå¤„ç†æœ€åå¯èƒ½éœ€è¦å°†è¿™ä¸ªæ•°æ®ä¿å­˜åœ¨æ•°æ®åº“å½“ä¸­ï¼Œä¿å­˜å®Œæˆä¹‹åå†å¯¹æ•°æ®åšä¸€ä¸ªé¢å¤–çš„åŒ…è£…æˆ–è€…è¯´ä¸€äº›å…¶ä»–çš„å¤„ç†ç„¶åè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œç„¶åå®¢æˆ·ç«¯çœ‹åˆ°çš„å°±æ˜¯å¤„ç†å®Œæˆçš„ç»“æœï¼‰ï¼›</li><li>é‚£ä¹ˆé¢å‘å¯¹è±¡è¯­è¨€å…¶æ‰€é’ˆå¯¹çš„ç›®æ ‡å…¶å®å°±æ˜¯dataï¼Œå³æ•°æ®ï¼›</li></ul></li><li>è€Œå‡½æ•°å¼ç¼–ç¨‹è¯­è¨€æ‰€é¢å‘çš„æ˜¯è¡Œä¸ºï¼›</li><li>ä»€ä¹ˆå«åšé¢å‘å¯¹è±¡æ˜¯é¢å‘çš„æ•°æ®ï¼Œè€Œå‡½æ•°å¼é¢å‘è¡Œä¸ºå‘¢ï¼Ÿ<ul><li>æ¯”å¦‚è¯´javaå½“ä¸­åœ¨è¿›è¡Œæ–¹æ³•ä¼ é€’çš„æ—¶å€™ï¼Œä»è¿™å½“ä¸­ä»æ¥ä¼ é€’çš„éƒ½æ˜¯å‚æ•°ï¼Œå³ä¼ å€¼ï¼›å³å°†æ•°å€¼ä¼ é€’ç»™ä¸€ä¸ªæ–¹æ³•ï¼Œå¦‚æœæ˜¯åŸç”Ÿç±»å‹çš„è¯ç›´æ¥å°†å€¼å¤åˆ¶è¿‡å»ä¼ ä¸€ä»½ï¼›å¦‚æœæ˜¯å¼•ç”¨å¯¹è±¡ç±»å‹çš„è¯ç›´æ¥å°†å¼•ç”¨å¤åˆ¶è¿‡å»ï¼Œç„¶åä¸¤ä¸ªå¼•ç”¨ä¼šæŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼›æ€»çš„æ¥è¯´å³è¿›è¡Œæ•°æ®çš„ä¼ é€’ï¼›</li><li>è€ŒLambdaè¡¨è¾¾å¼åˆ™å¯ä»¥é€šè¿‡æ–¹æ³•æ¥æŠŠä¸€ä¸ªæ–¹æ³•å‚æ•°ï¼Œç”šè‡³æ˜¯å¯ä»¥æ˜¯ä¸€ä¸ªè¡Œä¸ºï¼Œå¯ä»¥å°†è¯¥è¡Œä¸ºä½œä¸ºå‚æ•°ä½œä¸ºä¸åŒçš„è°ƒç”¨ä¹‹é—´æˆ–è€…æ˜¯ä¸åŒçš„å±‚æ¬¡ä¹‹é—´è¿›è¡Œä¼ é€’ï¼›è¿™ä¸€ç§ç¼–ç¨‹æ–¹å¼ä¸ä¹‹å‰çš„ç¼–ç¨‹æ–¹å¼æ˜¯æœ‰è¿™å¤©å£¤ä¹‹åˆ«çš„ï¼›åŒºåˆ«éå¸¸çš„æ˜æ˜¾ï¼›è€Œå‡½æ•°å¼ç¼–ç¨‹æ–¹å¼è¿™ç§ç¼–ç¨‹è¡Œä¸ºåœ¨æŒæ¡ä¹‹åå¯ä»¥ç»™å·¥ä½œæ•ˆç‡çš„ä¸€ä¸ªæå¤§æå‡ï¼Œä½¿å¾—ä»£ç çš„å¯è¯»æ€§å…¶å®æ›´å¥½ï¼›ï¼ˆä¸€å¼€å§‹å˜æ‰­ï¼Œæ—¶é—´ä¹…äº†ä¹‹åå°±ä¼šè§‰å¾—è¿™ç§æ–¹å¼æ›´å¥½ï¼Œåœ¨æ•ˆç‡ä¸Šä¹Ÿæœ‰ä¸€ä¸ªå¾ˆå¤§çš„æå‡ï¼›ï¼‰</li><li>é’ˆå¯¹äºä¼ é€’è¡Œä¸ºï¼Œå†ä¸¾ä¸€ä¸ªä¾‹å­ï¼š<ul><li>æ¯”å¦‚è¯´åŸæ¥è¿›è¡Œä¸¤ä¸ªæ•´æ•°è¿›è¡Œæ±‚å’Œçš„ä¸€ä¸ªæ–¹å¼ï¼›<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">ä¼ é€’ä¸¤ä¸ªæ•´å‹æ•°æ®ï¼›è¿”å›è¿™ä¸ªä¸¤ä¸ªæ•°æ®æ±‚å’Œçš„ç»“æœ</span></span><br><span class="line"><span class="comment">å½“å‰ä¼ é€’çš„å³ä¸ºæ•°æ®ï¼Œå³å€¼æœ¬èº«ï¼›</span></span><br><span class="line"><span class="comment">è€Œå‡½æ•°å¼ç¼–ç¨‹ä¼ é€’çš„æ˜¯è¡Œä¸ºï¼›</span></span><br><span class="line"><span class="comment">ç”šè‡³å¯ä»¥å°†add()è¿™æ ·ä¸€ä¸ªæ–¹æ³•ä½œä¸ºä¸€ä¸ªè¡Œä¸ºå‚æ•°ç»™è¿›è¡Œä¼ é€’è¿›å»ï¼›</span></span><br><span class="line"><span class="comment">é‚£ä¹ˆè¿™æ ·ä¸€ç§æ–¹å¼å¯¹äºjdk8ä¹‹å‰å…¶ä»–ç‰ˆæœ¬æ¥è¯´å…¶å®æ˜¯ä¸€ç§é¢ è¦†æ€§çš„åˆ›æ–°ï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">( <span class="keyword">int</span> a , <span class="keyword">int</span> b )</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span>  a + b ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul></li></ul></li><li>ä½¿ç”¨Lambdaè¡¨è¾¾å¼ä»£æ›¿åŒ¿åå†…éƒ¨ç±»</li><li>Lambdaè¡¨è¾¾å¼çš„ä½œç”¨</li><li>å¤–éƒ¨è¿­ä»£ä¸å†…éƒ¨è¿­ä»£</li><li>Java Lambdaè¡¨è¾¾å¼è¯­æ³•è¯¦è§£</li><li>å‡½æ•°å¼æ¥å£è¯¦è§£<ul><li>å³FunctionalInterfaceï¼›</li><li>å‡½æ•°å¼æ¥å£ä¸Lambdaè¡¨è¾¾å¼å¯†åˆ‡ç›¸å…³ï¼›</li><li>Lambdaè¡¨è¾¾å¼ä¸Streamæµä¹‹é—´ä¹Ÿæ˜¯å¯†åˆ‡ç›¸å…³çš„ï¼›é‚£ä¹ˆé€šè¿‡è¿™ä¸¤ç§æ–°ç‰¹æ€§çš„èåˆæ”¹å˜äº†ä»¥å‰æ“ä½œé›†åˆçš„é‚£ç§ç¬¨æ‹™çš„åŠæ³•ï¼›ç‰¹åˆ«æ˜¯åƒæ“ä½œåŒ¿åå†…éƒ¨ç±»ï¼›</li><li>åŒ¿åå†…éƒ¨ç±»æˆ–è€…æ˜¯æ–¹æ³•å›è°ƒåœ¨ä»€ä¹ˆæ—¶å€™ä¼šè¿›è¡Œä½¿ç”¨ï¼Ÿæ¯”å¦‚è¯´åœ¨ç¼–å†™androidæ—¶ï¼Œå°±å­˜åœ¨æœ‰å¤§é‡çš„åŒ¿åå†…éƒ¨ç±»ï¼›å› ä¸ºandroidå¼€å‘å’ŒåƒAWTæˆ–è€…æ˜¯Swingé‚£ç§ç•Œé¢å¼€å‘æ˜¯ä¸€æ ·çš„æ˜¯åŸºäºäº‹ä»¶çš„ï¼Œå³ç»™ä¸€ä¸ªæ§ä»¶æ³¨å†Œäº†ä¸€ä¸ªäº‹ä»¶ï¼›é‚£ä¹ˆå½“é‚£ä¸ªäº‹ä»¶å‘ç”Ÿäº†æ¯”å¦‚è¯´ç”¨æˆ·ç‚¹å‡»äº†æŸä¸ªæŒ‰é’®çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªæŒ‰é’®ç›¸å…³çš„æ–¹æ³•å›è°ƒå°±ä¼šå¾—åˆ°æ‰§è¡Œï¼›è€Œè¿™ç§å›è°ƒéƒ½æ˜¯åŸºäºäº‹ä»¶çš„ï¼›è€Œè¿™ç§æ–¹æ³•å›è°ƒéƒ½æ˜¯åŸºäºåŒ¿åå†…éƒ¨ç±»çš„å½¢å¼æ¥å»è¿›è¡Œè¡¨è¾¾å’Œå®ç°çš„ï¼›è™½ç„¶é€šè¿‡è¿™ç§åŒ¿åå†…éƒ¨ç±»çš„æ–¹å¼å·²ç»ååˆ†ç†Ÿæ‚‰ä½†æ˜¯å­˜åœ¨å•°å—¦ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å¯ä»¥é€šè¿‡Lambdaè¡¨è¾¾å¼æå¤§çš„å»è¿›è¡Œæ”¹å–„è¿™æ ·ä¸€ç§ç°çŠ¶ï¼›</li></ul></li><li>ä¼ é€’å€¼ä¸ä¼ é€’è¡Œä¸º</li><li>Streamæ·±åº¦è§£æ</li><li>Stream APIè¯¦è§£</li><li>ä¸²è¡Œæµä¸å¹¶è¡Œæµ</li><li>Streamæ„æˆ</li><li>Streamæºç”Ÿæˆæ–¹å¼</li><li>Streamæ“ä½œç±»å‹</li><li>Streamè½¬æ¢</li><li>Optionalè¯¦è§£<ul><li>Java8 å¼•å…¥äº†å…³äºOptionalçš„ä¸€ä¸ªå¢å¼ºï¼›</li><li>Optionalåœ¨java8 å‡ºç°ä¹‹å‰å°±å·²ç»å‡ºç°åœ¨äº†Googleçš„Guavaåº“å½“ä¸­äº†ï¼›</li><li>Google Guavaæ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„åº“ï¼›æä¾›äº†éå¸¸å¤šçš„æ–°ç‰¹æ€§åŒ…æ‹¬åƒå¯¹é›†åˆçš„å¢å¼ºï¼›ï¼ˆæ¯”å¦‚è¯´è¦å¯¹ä¸¤ä¸ªé›†åˆè¿›è¡Œæ±‚äº¤é›†å¹¶é›†å·®é›†è¡¥é›†ç­‰ç­‰åŠŸèƒ½ï¼Œå¦‚æœæ˜¯è‡ªå·±å†™ä»£ç çš„è¯è¿˜æ˜¯æ¯”è¾ƒç¹ççš„ï¼Œé€šè¿‡Googleçš„Guavaæ¡†æ¶å¯ä»¥éå¸¸æ–¹ä¾¿çš„å»å®ç°è¿™äº›å…³äºé›†åˆçš„æ“ä½œï¼‰ï¼›å¦å¤–Google Guavaä¹Ÿæä¾›äº†å¯¹Optionalçš„ä¸€ä¸ªæ”¯æŒï¼›</li><li>Optionalæ˜¯ä»€ä¹ˆï¼Ÿå¯ä»¥ç†è§£ä¸ºé˜²æ­¢åœ¨javaä»£ç å½“ä¸­å‡ºç°NullPointerExceptionè¿™æ ·ä¸€ç§æƒ…å†µæ‰€ä½œå‡ºçš„ä¸€ä¸ªå¤„ç†ï¼›NullPointerExceptionç©ºæŒ‡é’ˆå¼‚å¸¸æ˜¯ä¸€ç§æœ€ä¸ºå¸¸è§çš„ä¸€ç§å¼‚å¸¸ç±»å‹ï¼›é‚£ä¹ˆè¿™ç§å¼‚å¸¸å‡ºç°çš„æ ¹æœ¬åŸå› åœ¨äºåœ¨ä½¿ç”¨æŸä¸€ä¸ªå¼•ç”¨çš„æ—¶å€™ï¼Œæ–­å®šå…¶ä¸€å®šä¸ä¸ºç©ºç„¶åå»è¿›è¡Œè°ƒç”¨äº†è¯¥å¼•ç”¨çš„ä¸€äº›æ–¹æ³•ï¼Œä½†æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹è¿™ä¸ªå¼•ç”¨ç¡®å®æ˜¯ä¸ºç©ºäº†ï¼Œé‚£ä¹ˆåœ¨è¿™ç§æƒ…å†µä¸‹å°±ä¼šå‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼›å³java 8 å¯¹äºè¿™ç§æƒ…å†µä½œäº†ä¸€ä¸ªå¢å¼ºï¼›å…¶å®å½“å‰ç°ä¸‹å¾ˆå¤šè¯­è¨€éƒ½æä¾›äº†å¯¹Optionalçš„æ”¯æŒï¼›é™¤äº†Googleçš„Guavaåº“æä¾›äº†Optionalä¹‹å¤–ï¼Œå¦‚æœåšandroidå¼€å‘ï¼Œä½¿ç”¨Kotlinçš„è¯ï¼Œ<ul><li>Kotlinæ˜¯ç”±IntelliJ IDEAæ‰€åœ¨çš„å…¬å¸JetBrainsæ‰€æ¨å‡ºçš„ä¸€ä¸ªè¿è¡ŒäºJVMä¹‹ä¸Šçš„è¯­è¨€ï¼Œå®ƒé¢å‘çš„é¢†åŸŸä¸»è¦æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯é¢å‘æµè§ˆå™¨ç«¯ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯é¢å‘å®‰å“å¼€å‘ï¼›ç‰¹åˆ«æ˜¯å®‰å“å¼€å‘ï¼Œå…¶åº”ç”¨åœºæ™¯æ˜¯æ¯”è¾ƒå¹¿é˜”çš„ï¼›å› ä¸ºç°åœ¨çš„å®‰å“å¼€å‘è¿˜æ— æ³•ä½¿ç”¨Java8ï¼›ä¹‹å‰åªèƒ½å¤Ÿä½¿ç”¨Java 6ï¼›è€ŒJava 6å®é™…ä¸Šæ˜¯æ²¡æœ‰Lambdaè¡¨è¾¾å¼çš„æ”¯æŒçš„ï¼›é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±ç”±ä¸€äº›ç¬¬ä¸‰æ–¹çš„å·¥å…·æ¥è¿›è¡Œæä¾›ï¼Œé‚£ä¹ˆKotlinå°±å¾ˆå¥½çš„å¼¥è¡¥äº†è¿™ä¸€ç‚¹ï¼›ç”±Kotlinå¼€å‘å®‰å“å¯ä»¥ä½¿ä»£ç éå¸¸ç²¾ç®€ï¼ŒåŒæ—¶åˆèƒ½å¤Ÿåˆ©ç”¨éå¸¸å¼ºå¤§çš„Lambdaè¡¨è¾¾å¼çš„ç‰¹æ€§ï¼›Kotlinä¹Ÿæä¾›äº†å¯¹Optionalçš„æ”¯æŒï¼›</li><li>é™¤äº†åƒKotlinè¿˜æœ‰åƒAppleæœ€æ–°æ¨å‡ºçš„Swiftè¯­è¨€ï¼ŒSwiftè¯­è¨€ä¹Ÿæä¾›äº†å¯¹Optionalç›´æ¥çš„æ”¯æŒï¼Œé€šè¿‡æšä¸¾çš„æ–¹å¼æ”¯æŒOptionalï¼›Java8ä¹Ÿæä¾›äº†å¯¹Optionalçš„æ”¯æŒï¼›</li></ul></li></ul></li><li>é»˜è®¤æ–¹æ³•è¯¦è§£<ul><li>é»˜è®¤æ–¹æ³•é¢ è¦†äº†ä¹‹å‰å¯¹javaæ¥å£çš„ä¸€ä¸ªè®¤è¯†ï¼›</li><li>javaæ¥å£ï¼Œä»€ä¹ˆæ˜¯æ¥å£ï¼Ÿå³æ‰€æœ‰çš„æ–¹æ³•éƒ½æ˜¯æŠ½è±¡çš„ï¼Œæ²¡æœ‰å…·ä½“å®ç°çš„æ–¹æ³•ï¼›ä½†æ˜¯ä»java8å¼€å§‹è¿™ä¸ªæ¦‚å¿µå°±ä¸å†æˆç«‹äº†ï¼›</li></ul></li><li>æ–¹æ³•ä¸æ„é€ æ–¹æ³•å¼•ç”¨</li><li>Predicateæ¥å£è¯¦è§£<ul><li>Predicateçš„å«ä¹‰å³è°“è¯ï¼›åœ¨å‡½æ•°å¼æ¥å£å½“ä¸­ä½¿ç”¨çš„æœ€å¤šçš„ä¸€ä¸ªæ¦‚å¿µï¼›</li></ul></li><li>Functionæ¥å£è¯¦è§£</li><li>Consumeræ¥å£å‰–æ</li><li>Filterä»‹ç»<ul><li>è¿‡æ»¤</li></ul></li><li>Map-Reduceè®²è§£ã€ä¸­é—´æ“ä½œä¸ç»ˆæ­¢æ“ä½œ<ul><li>Map-Reduceå‡ºç°äº†å·²ç»æœ‰å¾ˆå¤šå¹´äº†ï¼›éšç€Hadoopè¿™ç§å¤§æ•°æ®æ¡†æ¶ï¼ŒMap-Reduceç°åœ¨ä¹Ÿè¶Šæ¥è¶Šè¢«äººæ‰€ç†è§£å’Œæ‰€çŸ¥é“ï¼›Map-Reduceå³å…ˆè¿›è¡ŒMapå³æ˜ å°„ï¼Œç„¶åå†è¿›è¡ŒReduceï¼ŒReduceç†è§£ä¸ºç²¾ç®€æ”¶æ•›ç­‰å«ä¹‰ï¼Œå˜æˆä¸€ä¸ªå€¼æ¥ä½œä¸ºç»“æœè¿›è¡Œè¾“å‡ºï¼›</li></ul></li><li>æ–°çš„Date APIåˆ†æ<ul><li>å¯¹äºjdkæ¥è¯´åŸå…ˆçš„æ—¥æœŸAPIä¸€ç›´ä¸ºäººæ‰€è¯Ÿç—…å¤ªä½çº§ï¼Œé—®é¢˜å¤ªå¤šï¼›</li><li>é¦–å…ˆå¯¹äºæ—¶åŒºçš„æ”¯æŒå·®åŠ²ä»¥åŠæ—¥æœŸçš„ä¸€äº›æ“ä½œä¹Ÿæ˜¯ååˆ†ä½æ•ˆçš„ï¼›</li><li>æ¯”å¦‚è¯´æƒ³è¦è¿›è¡Œè®¡ç®—å½“å‰è¯¥å¤©çš„åä¸‰å¤©æ˜¯æ˜ŸæœŸå‡ ï¼Œå¦‚æœä½¿ç”¨Javaå½“ä¸­å·²æœ‰çš„Date APIæ¥è¯´ï¼Œæ˜¯éš¾ä»¥åšåˆ°çš„ï¼Œå³ä¾¿åšåˆ°ä¹Ÿæ˜¯éå¸¸éº»çƒ¦çš„ï¼›è€Œä¸”åƒJava Date APIå½“ä¸­æ¯”è¾ƒè€çš„Calendarã€Dateç­‰æ—¥æœŸç›¸å…³å¤„ç†ç±»çš„æ—¶å€™ï¼Œå…¶ä¸»è¦å°±æ˜¯æ“ä½œè¿™å‡ ä¸ªç±»ï¼›è€Œä¸”Dateå½“ä¸­æœ‰å¾ˆå¤šæ–¹æ³•è¿‡æœŸï¼›</li><li>æ‰€æœ‰å°±æœ‰äººå¼€å‘äº†Joda Timeï¼ŒJoda Timeå¯ä»¥éå¸¸æ–¹ä¾¿çš„å®ç°ä¹‹å‰æ‰€æå‡ºçš„é‚£ä¸ªéœ€æ±‚å³æƒ³è¦è¿›è¡Œè®¡ç®—å½“å‰è¯¥å¤©çš„åä¸‰å¤©æ˜¯æ˜ŸæœŸå‡ ã€å½“å‰è¯¥å¤©å†åŠ ä¸¤ä¸ªæœˆæ˜¯æ˜ŸæœŸå‡ è¿™ç§ï¼Œé€šè¿‡Joda Timeéå¸¸ç®€å•çš„é€šè¿‡ä¸€ä¸ªæ–¹æ³•è°ƒç”¨å³å¯ï¼›è€Œä¸”Joda Timeä¸Java DateåŸç”ŸAPIä¹‹é—´æ˜¯å¯ä»¥ç›¸äº’è¿›è¡Œè½¬æ¢çš„ï¼›æ‰€ä»¥Joda Timeå°±å¾—åˆ°äº†éå¸¸å¹¿æ³›çš„åº”ç”¨ï¼›åæ¥Oracleå€Ÿé‰´äº†Joda Timeå½“ä¸­å¾ˆå¤šæ–°çš„è®¾è®¡æ€æƒ³æ‰€ä»¥åœ¨Java 8å½“ä¸­æä¾›äº†æ–°çš„æ—¥æœŸAPIï¼›å…¶åŠŸèƒ½ä¸Joda Timeå·®ä¸å¤šåœ¨ä¸€ä¸ªå±‚æ¬¡ä¸Šäº†ï¼›</li></ul></li></ul><p>ä½¿ç”¨Lambdaè¡¨è¾¾å¼æ˜¯Java8å½“ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒåŠŸèƒ½ï¼Œä»å­¦ä¹ è€…çš„è§’åº¦æ¥çœ‹å¾…java8å¸¦æ¥çš„ä¾¿æ·æ€§ï¼Œæ–°çš„ç‰¹ç‚¹ä»¥åŠåŠŸèƒ½ä¸Šçš„å¢å¼ºï¼›<br>java8 å³javaçš„ç¬¬8ä¸ªç‰ˆæœ¬ï¼Œé‚£ä¹ˆå®ƒçš„å‡ºç°å¸¦æ¥äº†å˜é©æ€§çš„ç‰¹æ€§ï¼Œé‚£ä¹ˆè¿™ç§å˜é©æ€§çš„ç‰¹æ€§å…¶å®å¯¹äºjavaæ¥è¯´æ˜¯éå¸¸éå¸¸éš¾ä»¥å®ç°çš„ï¼›å¹¶ä¸æ˜¯è¯´éš¾ä»¥æ˜¯å®ç°è¯¥åŠŸèƒ½ï¼Œè€Œæ˜¯è¯´å®ƒè¦å®ç°å¦‚æ­¤ä¹‹å¤šé‡è¦è€Œåˆé¢ è¦†æ€§çš„æ–°ç‰¹æ€§çš„åŒæ—¶ï¼Œåˆè¦èƒ½å…¼å®¹ä¸è€ç‰ˆæœ¬çš„ç‰¹æ€§ä»¥åŠåŠŸèƒ½ä»¥åŠè¯­è¨€ä¸Šçš„è¿™äº›ç‰¹ç‚¹ï¼Œå…¶å®è¿™ä¸€ç‚¹éå¸¸éš¾ä»¥å®ç°ï¼›<br>äº§ç”Ÿæ–°ç‰¹æ€§çš„åŒæ—¶åˆä¸ä¼šå¯¹è€ç‰ˆæœ¬çš„ä½¿ç”¨äº§ç”Ÿå¹²æ‰°ï¼›å³åœ¨jdk5ã€6ã€7ä¸Šçš„å¼€å‘ä»£ç å¹³æ»‘åˆ°jdk8ä¸Šä¾æ—§å¯ä»¥å…¼å®¹ä»£ç ç­‰ç‰¹æ€§è¿™æ˜¯æå…¶å›°éš¾çš„ä¸€ä»¶äº‹æƒ…ï¼›<br>ä¿æŒåœ¨å¢åŠ java8çš„æ–°ç‰¹æ€§çš„åŒæ—¶åˆä¸ä¼šå¯¹åŸæœ‰çš„åŠŸèƒ½é€ æˆç ´åæ€§çš„å½±å“ï¼›æ‰€ä»¥æä¾›äº†åƒå‡½æ•°å¼æ¥å£ã€é»˜è®¤æ–¹æ³•ç­‰è¿™ç§æ–°ç‰¹æ€§ï¼›è€Œå‡½æ•°å¼æ¥å£åˆæˆ–è€…æ˜¯é»˜è®¤æ–¹æ³•è¿™ç§æ–°åŠŸèƒ½åœ¨å¯¹äºè€ç‰ˆæœ¬javaçš„è§†è§’æ¥çœ‹æ˜¯å¾ˆå¥‡æ€ªçš„ï¼ˆæ¥å£å½“ä¸­æ€ä¹ˆèƒ½æœ‰æ–¹æ³•çš„å®ç°å‘¢ï¼‰ï¼›è¿™æ˜¯ç”±äºè¦å¢åŠ æ–°ç‰¹æ€§çš„åŒæ—¶åˆè¦å»å…¼å®¹è€ç‰ˆæœ¬æ‰€åšå‡ºçš„ä¸€ç§æƒè¡¡å’ŒæŠ˜ä¸­ï¼›</p><h2 id="JAVA8æ–°ç‰¹æ€§è¯¾ç¨‹ä»‹ç»ç»­"><a href="#JAVA8æ–°ç‰¹æ€§è¯¾ç¨‹ä»‹ç»ç»­" class="headerlink" title="JAVA8æ–°ç‰¹æ€§è¯¾ç¨‹ä»‹ç»ç»­"></a>JAVA8æ–°ç‰¹æ€§è¯¾ç¨‹ä»‹ç»ç»­</h2><p><strong>å¹¶å‘ä¸Netty</strong>  </p><p>ä»‹ç»ï¼šNetty å¯è°“æ˜¯å›½å†…å¤–è¯¸å¤šäº’è”ç½‘å…¬å¸çš„æ ‡é…ã€‚<br>å…¶é«˜æ€§èƒ½çš„å¼‚æ­¥é€šä¿¡æ¡†æ¶ã€NIOæ”¯æŒã€WebSocketçš„å¼ºå¤§å®ç°ä½¿å¾—å…¶æˆä¸ºå¾ˆå¤šå¤§å‹äº’è”ç½‘å…¬å¸åœ¨å¤„ç†é«˜å¹¶å‘æ—¶çš„é¦–é€‰ã€‚<br>ä¸è¿‡ï¼Œç”±äºNettyæ¶æ„å¤æ‚ï¼Œæ¨¡å—ä¼—å¤šï¼Œå­¦ä¹ æ›²çº¿é™¡å³­ï¼Œè®©å¾ˆå¤šäººæœ›è€Œå´æ­¥ã€‚<br>å¸‚é¢ä¸Šçš„å‡ æœ¬Nettyç›¸å…³å›¾ä¹¦ä¹Ÿåªæ˜¯å¯¹å…¶è¿›è¡Œäº†ç²—æµ…çš„ä»‹ç»ï¼ˆå…¥é—¨ï¼‰ï¼Œå¹¶æ— æ³•ç›´æ¥åº”ç”¨åˆ°å®é™…é¡¹ç›®ä¸­ã€‚<br>è¯¥è¯¾ç¨‹å°±æ˜¯ä¸ºäº†å¸®åŠ©å¤§å®¶æ·±å…¥ä¸”é€å½»å­¦ä¹ Nettyçš„ã€‚<br>Nettyæ·±å…¥æŒæ¡éœ€è¦å¤§é‡çš„å®è·µæ€è€ƒå’Œæ€»ç»“ï¼›<br>nettyçš„å®˜ç½‘ï¼š<code>https://netty.io</code>ã€‚<br>Nettyä¸ä¹‹å‰æ‰€å­¦ä¹ çš„SpringMVCã€Struts2ç­‰æ¡†æ¶ä¸ä¸€æ ·ï¼›SpringMVCã€Struts2è§£å†³çš„å³MVCè¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼Œå³å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯ï¼Œå®¢æˆ·ç«¯å¦‚ä½•å°†æ•°æ®ä¼ é€’ç»™åˆ°æœåŠ¡å™¨ç«¯ï¼ŒæœåŠ¡å™¨ç«¯æŒ‰ç…§æ¡†æ¶çš„è®¾å®šå®šä¹‰å¥½å„ä¸ªå±‚æ¬¡æ¥æ”¶æ•°æ®ï¼Œæ¥æ”¶æ•°æ®ä¹‹ååˆ™ç›¸åº”çš„Controllerå°±ä¼šå»è°ƒç”¨serviceæ–¹æ³•ï¼Œè€Œserviceåˆ™å»è°ƒç”¨daoå±‚ï¼›å³ä¼ ç»Ÿçš„éå¸¸ç»å…¸çš„å¤šå±‚æ¶æ„è®¾è®¡æ¨¡å¼ï¼›<br>Nettyæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªç½‘ç»œé€šä¿¡åº”ç”¨æ¡†æ¶ï¼›è€Œä¸”Nettyæœ¬èº«æ˜¯å¯¹äºåº•å±‚çš„æ— è®ºæ˜¯TCPè¿˜æ˜¯HTTPåšäº†ä¸€å±‚è–„è–„çš„å°è£…ï¼›é‚£ä¹ˆNettyæœ¬èº«åˆæ˜¯åŸºäºå®Œå…¨å¼‚æ­¥çš„è¿™æ ·ä¸€ç§æ¡†æ¶ï¼Œå¼‚æ­¥çš„é€šä¿¡æ¨¡å¼ï¼Œå³NIOï¼›Nettyæºä»£ç å¤æ‚ï¼›</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">Netty is an asynchronous event-driven network application framework for rapid development of maintainable high performance protocol servers &amp; clients.</span><br><span class="line"></span><br><span class="line">Netty æ˜¯ ä¸€ä¸ª å¼‚æ­¥çš„ äº‹ä»¶é©±åŠ¨ ç½‘ç»œåº”ç”¨æ¡†æ¶ï¼Œ</span><br><span class="line">é’ˆå¯¹äº å¯ç»´æŠ¤ï¼ˆmaintainableï¼‰çš„ é«˜æ€§èƒ½åè®® æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯çš„å¿«é€Ÿï¼ˆrapidï¼‰å¼€å‘ï¼ˆdevelopmentï¼‰ï¼›</span><br><span class="line"></span><br><span class="line">Netty is a NIO client server framework which enables quick and easy development of network applications such as protocol servers and clients.</span><br><span class="line"></span><br><span class="line">Netty æ˜¯ä¸€ä¸ªå¼‚æ­¥çš„IOå®¢æˆ·ç«¯æœåŠ¡æ¡†æ¶ï¼›ï¼ˆNettyå¯¹äºç½‘ç»œåè®®åˆ†å±‚çš„è¿™æ ·ä¸€ç§æ”¯æŒï¼›Nettyçš„å‡çº§å…·æœ‰ç ´åæ€§ï¼Œæ¯”å¦‚è¯´åŒ…çš„åå­—å‘ç”Ÿå˜åŒ–ä¹‹ç±»çš„ï¼ŒåŸæ¥å…¶åŒ…åæ˜¯ä»¥ org.jbosså¼€å¤´ï¼Œç°åœ¨ä»¥io.nettyå¼€å¤´ï¼›ä¹‹å‰è¿˜å‡ºç°è¿‡netty5è¯¥ç‰ˆæœ¬ï¼Œä¸æ˜¯æœ€ç»ˆç‰ˆè€Œæ˜¯é˜¿å°”æ³•ç‰ˆæœ¬ï¼›å‡ºç°æœ‰ç›¸å½“é•¿ä¸€æ®µæ—¶é—´ä¹‹ååˆä»ç½‘ç«™ä¸Šæ’¤æ‰äº†ï¼›å¯ä»¥åˆ°å…¶githubä¸Šçœ‹netty5çš„åˆ†æ”¯ä»¥åŠä¸ºä»€ä¹ˆnetty5ä¼šè¢«å–æ¶ˆçš„åŸå› ã€‚ï¼‰</span><br><span class="line"></span><br><span class="line">It greatly simplifies and streamlines network programming such as TCP and UDP socket server.</span><br><span class="line">'Quick and easy' doesn't mean that a resulting application will suffer from a maintainability or a performance issue.</span><br><span class="line"></span><br><span class="line">Netty hash been designed carefully <span class="keyword">with</span> the experiences earned <span class="keyword">from</span> the implementation <span class="keyword">of</span> a lot <span class="keyword">of</span> protocols such <span class="keyword">as</span> <span class="keyword">FTP</span>, SMTP, <span class="keyword">HTTP</span>, <span class="keyword">and</span> various <span class="built_in">binary</span> <span class="keyword">and</span> <span class="built_in">text</span>-based legacy protocols,</span><br><span class="line"></span><br><span class="line"><span class="keyword">As</span> a <span class="keyword">result</span>, Netty <span class="keyword">hash</span> succeeded <span class="keyword">to</span> find a way <span class="keyword">to</span> achieve ease <span class="keyword">of</span> development , <span class="keyword">performance</span>, stability, <span class="keyword">and</span> flexibility <span class="keyword">without</span> a compromise.</span><br><span class="line"></span><br><span class="line">Features</span><br><span class="line"></span><br><span class="line">Design // è®¾è®¡</span><br><span class="line">  * Unified API <span class="keyword">for</span> various transport types - blocking <span class="keyword">and</span> non-blocking socket</span><br><span class="line">  * Based <span class="keyword">on</span> a flexible <span class="keyword">and</span> extensible <span class="keyword">event</span> <span class="keyword">model</span> which allows <span class="keyword">clear</span> separation <span class="keyword">of</span> concerns</span><br><span class="line">  * Highly customizable <span class="keyword">thread</span> <span class="keyword">model</span> - single <span class="keyword">thread</span>, one <span class="keyword">or</span> more <span class="keyword">thread</span> pools such <span class="keyword">as</span> SEDA</span><br><span class="line">  * <span class="literal">True</span> connectionles datagram socket support(since <span class="number">3.1</span>)</span><br><span class="line"></span><br><span class="line">Ease <span class="keyword">of</span> <span class="keyword">use</span> //æ˜“äºä½¿ç”¨ï¼Œå¿«é€Ÿå¼€å‘</span><br><span class="line">  * Well-documented Javadoc, <span class="keyword">user</span> guide <span class="keyword">and</span> examples</span><br><span class="line">  * <span class="keyword">No</span> additional dependencies, JDK5(Netty <span class="number">3.</span>x) <span class="keyword">or</span> <span class="number">6</span>(Netty <span class="number">4.</span>x) <span class="keyword">is</span> enough</span><br><span class="line">    * Note: <span class="keyword">Some</span> components such <span class="keyword">as</span> <span class="keyword">HTTP</span>/<span class="number">2</span> might have more requirements. Please refer <span class="keyword">to</span> the Requirements page <span class="keyword">for</span> more information.</span><br><span class="line"></span><br><span class="line"><span class="keyword">Performance</span></span><br><span class="line">  * Better throughput, <span class="keyword">lower</span> latency</span><br><span class="line">  * <span class="keyword">Less</span> <span class="keyword">resource</span> consumption</span><br><span class="line">  * Minimized unnecessary <span class="keyword">memory</span> copy</span><br><span class="line"></span><br><span class="line"><span class="keyword">Security</span></span><br><span class="line">  * <span class="keyword">Complete</span> SSL/TLS <span class="keyword">and</span> StartTLS support</span><br><span class="line"></span><br><span class="line">Community</span><br><span class="line">  * <span class="keyword">Release</span> early, <span class="keyword">release</span> often</span><br><span class="line">  * The author has been writing similar frameworks since <span class="number">2003</span> <span class="keyword">and</span> he still finds your feed back precious !</span><br></pre></td></tr></table></figure><ul><li>Nettyä»‹ç»<ul><li>Nettyå¹²ä»€ä¹ˆï¼Œåšä»€ä¹ˆäº‹æƒ…çš„ä»¥åŠæ€ä¹ˆåš</li><li>ä»å®è§‚çš„è§’åº¦ä»‹ç»Nettyçš„æ¶æ„ä»¥åŠNettyçš„æ¨¡å—åˆ†æ</li><li>çŸ¥å…¶ç„¶</li></ul></li><li>Nettyæ¶æ„å®ç°</li><li>Nettyæ¨¡å—åˆ†æ</li><li>Netty HTTP Tunnel</li><li>Nettyå¯¹Socketçš„å®ç°<ul><li>Socketç¼–ç¨‹ä¸€ç›´ä»¥æ¥éƒ½æ˜¯ä¸€ä¸ªéš¾ç‚¹ï¼›å› ä¸ºSocketå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç§æ¯”è¾ƒåº•å±‚çš„ç½‘ç»œç¼–ç¨‹æ¨¡å¼ï¼›å®ƒåœ¨åŸºäºä¼ ç»ŸHTTPåº”ç”¨å±‚çš„ç¼–ç¨‹ï¼Œå› ä¸ºHTTPæ˜¯ä½äºOSI/ISOä¸ƒå±‚ç½‘ç»œå‚è€ƒæ¨¡å‹æœ€ä¸Šå±‚ï¼Œæ˜¯ä¸€ç§åº”ç”¨å±‚çš„æ¨¡å‹ï¼›å°†åº•å±‚çš„ä¸€äº›ä¸œè¥¿éƒ½å·²ç»å°è£…å¥½äº†ï¼›åªéœ€è¦é’ˆå¯¹HTTPå³å¯ï¼›ç›¸å¯¹äºHTTPæ¥è¯´socketæ›´åŠ å¤æ‚ï¼›</li></ul></li><li>Nettyå‹ç¼©ä¸è§£å‹ç¼©</li><li>Nettyå¯¹äºRPCçš„æ”¯æ´<ul><li>RPCï¼šRemote Procedure Call-è¿œç¨‹è¿‡ç¨‹è°ƒç”¨(ç™¾åº¦)ï¼›</li><li>è¯¥è§†é¢‘ä¸Šè®²è¿°çš„RPCæ˜¯Remote Procedure communication-è¿œç¨‹è¿‡ç¨‹é€šä¿¡</li><li>å¯¹äºä¸€äº›åˆ†å¸ƒå¼åº”ç”¨æ¥è¯´ï¼Œæ¨¡å—ä¸æ¨¡å—æˆ–è€…ç³»ç»Ÿä¸ç³»ç»Ÿä¹‹é—´éƒ½æ˜¯åœ¨å†…ç½‘å½“ä¸­è¿›è¡Œé€šä¿¡çš„ï¼Œé¡¶å¤šä¹Ÿæ˜¯è·¨æœºæˆ¿ï¼Œä¸ç®¡æ˜¯ä¸æ˜¯è·¨æœºæˆ¿æ•´ä¸ªä¹Ÿæ˜¯åœ¨å…¬å¸çš„æœåŠ¡ç«¯è¿›è¡Œé€šä¿¡ï¼›è¿™ç§é€šä¿¡æ¨¡å¼å­˜åœ¨ä¸¤ç§æ¨¡å¼ï¼šç¬¬ä¸€ç§æ¨¡å¼æ˜¯é€šè¿‡ä¼ ç»Ÿçš„HTTPçš„æ–¹å¼ï¼Œå³REST fullæ–¹å¼ï¼Œå¼€å‘èµ·æ¥æ¯”è¾ƒå®¹æ˜“ï¼Œåªè¦æä¾›ç›¸åº”çš„httpæ¥å£å³å¯ï¼›ç¬¬äºŒç§æ–¹å¼å³é€šè¿‡RPCçš„æ–¹å¼ï¼Œé‚£ä¹ˆRPCè¿™ç§æ–¹å¼æ›´ä¸ºåº•å±‚çš„å®ç°ï¼Œç±»ä¼¼javaå½“ä¸­çš„RMIï¼ŒRMIå³Remote Method Invocation è¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼ŒRMIå³RPCçš„ä¸€ç§ç‰¹ä¾‹ï¼Œå› ä¸ºRMIåªèƒ½å¤Ÿè¢«ç”¨åˆ°javaå½“ä¸­ï¼›å¤šå¹´ä¹‹å‰æµè¡Œçš„EZBï¼ŒEZBå…¶åº•å±‚å°±æ˜¯ä½¿ç”¨RMIè¿›è¡Œå®ç°çš„ï¼›ï¼ˆEZBç°åœ¨å¤§å¤šç”¨åœ¨é“¶è¡Œï¼Œè€Œäº’è”ç½‘å…¬å¸ä½¿ç”¨çš„å°‘ï¼›ï¼‰RPCå¯ä»¥ç›¸æ¯”äºRMIæ¥è¯´å¯ä»¥å®ç°å¤šè¯­è¨€å³å¼‚æ„å¹³å°ä¹‹é—´çš„é€šä¿¡ï¼Œæ¯”å¦‚è¯´javaå¯ä»¥ç›´æ¥è°ƒç”¨pythonçš„ä¸€ä¸ªæ–¹æ³•ï¼ˆæ­¤å¤„pythonä¸æ˜¯æä¾›ä¸€ä¸ªhttpæ¥å£ä»è€Œjavaå»è°ƒç”¨æ¥å£è¿™ç§æ¨¡å¼ï¼Œå› ä¸ºé€šè¿‡HTTPæ¥å£æ–¹å¼æ¥è°ƒç”¨çš„ä¸å®Œå…¨æ˜¯ä¸è¯­è¨€æ— å…³çš„ï¼Œåªè¦å®šä¹‰å¥½æ¥å£å®šä¹‰å¥½å®ç°ï¼Œå®¢æˆ·ç«¯å°±å¯ä»¥è¿›è¡Œè°ƒç”¨ï¼Œä¸ç®¡æ˜¯æ€ä¹ˆå»è¿›è¡Œå®ç°çš„ï¼›å¯¹äºRPCæ¥è¯´ä¸æ˜¯è¿™æ ·çš„ï¼ŒRPCæœ¬èº«å°±æ˜¯é€šè¿‡æ¡†æ¶çš„èµ„æºï¼Œï¼ˆæ¡†æ¶èµ„æºè¿™äº›ï¼‰è‡ªå·±å†™æ˜¯ä¸å¤ªç°å®éå¸¸å¤æ‚ï¼Œé€šè¿‡æ¡†æ¶çš„ä¸€äº›èµ„æºæ¥å»è¿›è¡Œè°ƒç”¨ï¼Œè€Œä¸”æ˜¯å¯ä»¥å®ç°å¼‚æ„å¹³å°ä¹‹é—´çš„è°ƒç”¨ï¼Œæ¯”å¦‚è¯´ç°åœ¨å¾ˆå¤šäº’è”ç½‘å…¬å¸éƒ½åœ¨ä½¿ç”¨é˜¿é‡Œçš„dubboï¼Œæœ‰ä¸€äº›å…¬å¸å¯¹dubboåšäº†ä¸€äº›æ‰©å±•ï¼Œé‚£ä¹ˆdubboå¯ä»¥è¯´æ˜¯ä¸€ç«™å¼çš„è¿™ç§åˆ†å¸ƒå¼æ¡†æ¶ï¼Œåº•å±‚ä¹Ÿæä¾›äº†RPCçš„æ”¯æŒï¼Œæä¾›äº†å…³äºåˆ†å¸ƒå¼çš„è¿™äº›åŸºç¡€è®¾æ–½ç­‰ç­‰ï¼‰</li></ul></li><li>WebSocketè¿æ¥å»ºç«‹æ–¹å¼ä¸ç”Ÿå‘½å‘¨æœŸåˆ†è§£<ul><li>WebSocketæœ¬èº«æ¥æºäºHTML5ï¼ŒHTML5åœ¨æå‡ºä¹‹åˆå°±ç»™å‡ºäº†WebSocketçš„ä¸€äº›èµ„æºï¼ŒWebSocketä¹Ÿæ­£å¼æˆä¸ºHTML5çš„ä¸€éƒ¨åˆ†ã€‚</li><li>WebSocketä¸»è¦åšçš„äº‹æƒ…å³ä¸ºé•¿è¿æ¥ï¼›å¯¹åº”äºä¸é•¿è¿æ¥ç›¸å¯¹çš„å³çŸ­è¿æ¥ï¼ŒHTTPå³ä¸ºä¸€ç§çŸ­è¿æ¥ï¼ˆä»€ä¹ˆå«åšçŸ­è¿æ¥ï¼Œå®¢æˆ·ç«¯å»è®¿é—®æœåŠ¡ç«¯ï¼Œå®¢æˆ·ç«¯å‘èµ·ä¸€ä¸ªè¯·æ±‚ï¼Œç„¶åæœåŠ¡ç«¯æ¥æ”¶åˆ°è¿™ä¸ªè¯·æ±‚ä¹‹åï¼Œé¡¶å¤šå¯ä»¥é€šè¿‡HTTPçš„keep-aliveè¿™æ ·çš„ç‰¹æ€§è®©è¿™ä¸ªè¿æ¥ä¿æŒä¸€æ®µæ—¶é—´ä¸è¢«å…³é—­æ‰ï¼Œä½†æ˜¯ä¸€æ®µæ—¶é—´ä¹‹åå¦‚æœå®¢æˆ·ç«¯ä¸å†å»ç»™æœåŠ¡ç«¯å‘é€æ›´å¤šçš„è¯·æ±‚çš„è¯ï¼Œè¿™ä¸ªè¿æ¥å°±ä¼šè¢«å…³é—­æ‰äº†ï¼Œæ‰€ä»¥HTTPæœ¬èº«æ˜¯ä¸€ç§æ— çŠ¶æ€çš„åè®®ï¼Œä¸€å®šæ˜¯ç”±å®¢æˆ·ç«¯ä¸»åŠ¨çš„å‘èµ·è¿™ä¸ªè¯·æ±‚ï¼Œç„¶åæœåŠ¡ç«¯å»æ¥æ”¶è¯·æ±‚ï¼Œæ¥ç€æœåŠ¡ç«¯å°†å“åº”è¿”å›ç»™å®¢æˆ·ç«¯ï¼›æ¥ç€å®¢æˆ·ç«¯å†å»å‘èµ·æ–°çš„è¯·æ±‚ï¼ŒæœåŠ¡ç«¯å†å»å¤„ç†å†å»å°†å“åº”è¿”å›ç»™å‰ç«¯ï¼›è¿™å¯¹äºä¼ ç»ŸHTTP1.0ä»¥åŠ1.1çš„æ–¹å¼ï¼›ç°åœ¨HTTP2åœ¨å¾ˆå¤šæµè§ˆå™¨å†…ä¹Ÿé€æ¸å¼€å§‹æä¾›é•¿è¿æ¥äº†ï¼‰ï¼›</li><li>ä½†æ˜¯å¯¹äºWebSocketæ¥è¯´ï¼ŒWebSocketæ˜¯ç›®å‰ä¸ºä¸»æœ€ä¸ºæˆç†Ÿä¹Ÿæ˜¯æ ‡å‡†åŒ–çš„ä¸€ç§é•¿è¿æ¥çš„å®ç°ï¼ŒWebSocketçš„å®ç°æ–¹å¼å…¶å®æ˜¯åŸºäºHTTPçš„ï¼›é¦–å…ˆï¼›å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘èµ·ä¸€ä¸ªè¿æ¥è¯·æ±‚ï¼Œè¿æ¥ä¸€æ—¦å»ºç«‹å¥½ä¹‹åï¼Œå°†è¿™ä¸ªè¿æ¥upgradeå‡çº§æˆWebSocketçš„åè®®ï¼›WebSocketåè®®è¡¨ç°ä¸ºwsï¼›</li><li>ï¼ˆæ¯”å¦‚è¯´è®¿é—®ä¸€ä¸ªç½‘ç«™æ—¶é€šå¸¸éƒ½æ˜¯http://â€¦ æˆ–è€…æ˜¯https://â€¦ å¼€å¤´ï¼›è€ŒWebSocketå³ws://â€¦ å¼€å¤´åé¢æ¥åœ°å€ï¼›å¦‚æœå¸¦è¯ä¹¦çš„è¯å³wss://â€¦ ä¸httpsç±»ä¼¼ï¼›ï¼‰WebSocketç‰¹åˆ«é€‚åˆäºå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯éœ€è¦ä¿æŒåŒå‘ï¼Œå³å…¨åŒå·¥é€šä¿¡çš„è¿™æ ·ä¸€ç§åœºæ™¯ï¼Œæ¢ç§è¯´æ³•å³å®ç°æœåŠ¡ç«¯çš„æ¨é€ï¼›åœ¨WebSocketå‡ºç°ä¹‹å‰å®ç°æœåŠ¡ç«¯çš„æ¨é€ä¹Ÿæœ‰ï¼Œä½†æ˜¯è¿™äº›æŠ€æœ¯å…¶å®éƒ½æ˜¯å‡çš„æ¨é€ï¼›</li><li>å‡çš„æ¨é€ï¼šï¼ˆå³è½®è¯¢ï¼Œå®¢æˆ·ç«¯ä¸æ–­å‘æœåŠ¡ç«¯å‘èµ·è¯·æ±‚è®¿é—®ï¼Œæ¯”å¦‚è¯´5sæˆ–è€…æ˜¯10sç­‰æ—¶é—´æ®µé—´éš”è½®è¯¢å‘èµ·ä¸€ä¸ªè¯·æ±‚åˆ¤æ–­æœåŠ¡ç«¯æœ‰æ²¡æœ‰ç›¸åº”çš„æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰çš„è¯åˆ™æ­¤æ¬¡è½®è¯¢ç»“æŸï¼Œéš”ä¸€æ®µæ—¶é—´é—´éš”ä¹‹åå†å»å‘èµ·è¯·æ±‚ï¼‰ï¼›è¿™ç§è½®è¯¢æ–¹å¼æ˜¯éå¸¸ä¸ä¼˜é›…çš„ï¼›å› ä¸ºå¤§å¤šæ•°çš„è½®è¯¢éƒ½æ˜¯æ— æ„ä¹‰æ— æ•ˆæœçš„ï¼›HTTPè¿˜æœ‰ä¸€ä¸ªç¼ºé™·å³åœ¨äºæ¯ä¸€æ¬¡çš„è¯·æ±‚å“åº”éƒ½ä¼šå¸¦æœ‰HTTPçš„headerï¼Œç§°ä¹‹ä¸ºå¤´ï¼Œç„¶è€Œç»å¤§å¤šæ•°æ•°æ®åªå æ®äº†ä¸€å°éƒ¨åˆ†ï¼Œåœ¨æ¯ä¸€æ¬¡è¯·æ±‚å“åº”æ•°æ®å½“ä¸­ï¼Œheaderéƒ¨åˆ†å€’æ˜¯å æ®å¾ˆäº†å¾ˆå¤šçš„ç½‘ç»œæµé‡ï¼Œè€ŒçœŸæ­£æ‰€éœ€è¦åŒ…å½“ä¸­çš„æ•°æ®å¾ˆå°‘ï¼Œå³è¿™å®é™…ä¸Šæ˜¯ä¸€ç§éå¸¸ä¸å¥½çš„æ–¹å¼ï¼›</li><li>ç„¶è€ŒWebSocketå°±å®Œå…¨è§£å†³äº†è¿™æ ·ä¸€ç§é—®é¢˜ï¼›å³ä¸€æ—¦å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯å»ºç«‹å¥½è¿æ¥ä¹‹åï¼Œä¸ç®¡æ˜¯æœåŠ¡ç«¯è¿˜æ˜¯å®¢æˆ·ç«¯éƒ½å¯ä»¥å‘å¯¹æ–¹è¿›è¡Œæ¨è¯·æ±‚ï¼Œå³æ‰€è°“å…¨åŒå·¥ï¼Œå³å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯éƒ½å¯ä»¥å‘å¯¹æ–¹è¿›è¡Œæ¨é€æ•°æ®ï¼Œè€Œä¸”æ•°æ®æœ¬èº«å¯ä»¥ä¸å¸¦headerï¼Œä»…ä»…æ˜¯åŒ…å«çœŸæ­£éœ€è¦çš„æ•°æ®æœ¬èº«ï¼Œè¿™å³WebSocketå®ç°çš„ä¸€ä¸ªä¼˜åŠ¿ï¼›å¯¹äºåƒæ‰‹æœºç«¯å³ç§»åŠ¨ç«¯è¦å®ç°çš„èŠå¤©åº”ç”¨ï¼Œå°±éœ€è¦é•¿è¿æ¥ï¼Œé‚£ä¹ˆä½¿ç”¨WebSocketå°±å±äºä¸€ç§æ¯”è¾ƒå¥½çš„ä¸€ç§å®ç°æ–¹å¼ï¼›WebSocketé€‚åˆç”¨äºæ‰‹æœºç«¯ä»¥åŠå³æ—¶é€šä¿¡è¿™æ ·ä¸€ç§åœºæ™¯çš„ï¼›Nettyå¯¹äºWebSocketæœ¬èº«æä¾›äº†éå¸¸å®Œå¤‡çš„æ”¯æŒï¼›é€šè¿‡è‹¥å¹²ä¸ªå›è°ƒæ–¹æ³•å°±å¯ä»¥æ¯”è¾ƒå¥½çš„å»å®ç°WebSocketè¿™ç§é•¿è¿æ¥çš„é€šä¿¡ï¼›</li></ul></li><li>WebSocketæœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯å¼€å‘</li><li>RPCæ¡†æ¶åˆ†æ</li><li>Google Protobufä½¿ç”¨æ–¹å¼åˆ†æï¼ˆRPCé‡è¦æ¡†æ¶ï¼‰<ul><li>å¯ä»¥å®ç°å¼‚æ„å¹³å°ä¹‹é—´çš„é€šä¿¡ï¼›æ¯”å¦‚è¯´javaä½œä¸ºå®¢æˆ·ç«¯è°ƒç”¨pythonçš„æœåŠ¡ç«¯ï¼Œæˆ–è€…æ˜¯Rubyçš„å®¢æˆ·ç«¯è°ƒç”¨javaçš„æœåŠ¡ç«¯ï¼Œè¿™éƒ½æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼›RPCæ¡†æ¶æ¨¡å¼éƒ½æ˜¯æ¯”è¾ƒç±»ä¼¼çš„ï¼Œä¸å¤–ä¹æ˜¯è¦å»ç¼–å†™ä¸€ä¸ªä¸­é—´çš„æ–‡ä»¶ç§°ä¹‹ä¸ºæè¿°æ–‡ä»¶ï¼Œç„¶åé€šè¿‡æ¡†æ¶æä¾›çš„å·¥å…·æ¥è‡ªåŠ¨å»ç”ŸæˆæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„ä»£ç ï¼›æ¥ç€æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ä»£ç å»ç¼–å†™ç›¸åº”çš„é€»è¾‘å»è°ƒç”¨è‡ªåŠ¨ç”Ÿæˆçš„ä»£ç å®ç°åŒå‘çš„é€šä¿¡ï¼Œåº•å±‚çš„é€šä¿¡éƒ½æ˜¯ç”±è‡ªåŠ¨ç”Ÿæˆçš„ä»£ç å»å®Œæˆçš„ï¼›</li></ul></li><li>Apache Thriftä½¿ç”¨æ–¹å¼ä¸æ–‡ä»¶ç¼–å†™æ–¹å¼åˆ†æï¼ˆRPCé‡è¦æ¡†æ¶ï¼‰<ul><li>å¯ä»¥å®ç°å¼‚æ„å¹³å°ä¹‹é—´çš„é€šä¿¡ï¼›</li><li>ç”¨äºåœ¨å…¬å¸å†…ç½‘å®ç°RPCçš„é€šä¿¡ï¼Œä¹Ÿæ”¯æŒå¼‚æ„è¯­è¨€ä¹‹é—´çš„é€šä¿¡ï¼Œæ•ˆç‡é«˜ï¼Œç›¸æ¯”äºä¼ ç»ŸHTTPæ–¹å¼æ•ˆç‡é«˜å¾ˆå¤šï¼›</li></ul></li><li>Nettyå¤§æ–‡ä»¶ä¼ é€æ”¯æŒ</li><li>å¯æ‰©å±•çš„äº‹ä»¶æ¨¡å‹</li><li>Nettyç»Ÿä¸€é€šä¿¡API</li><li>é›¶æ‹·è´åœ¨Nettyä¸­çš„å®ç°ä¸æ”¯æŒ</li><li>TCPç²˜åŒ…ä¸æ‹†åŒ…åˆ†æ<ul><li>TCPæœ¬èº«éƒ½æ˜¯é€šè¿‡åŒ…çš„æ–¹å¼ï¼Œæœ‰å¯èƒ½å‡ºç°ä¸¤ä¸ªåŒ…é»åœ¨ä¸€èµ·äº†ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªåŒ…æ‹†æˆä¸¤ä¸ªäº†ï¼Œé‚£ä¹ˆNettyå¯¹äºè¿™ç§æƒ…å†µæ˜¯å¦‚ä½•å¤„ç†çš„ï¼›</li></ul></li><li>NIOæ¨¡å‹åœ¨Nettyä¸­çš„å®ç°<ul><li>NIOï¼Œéé˜»å¡æ¨¡å‹åœ¨Nettyä¸­çš„å®ç°ï¼Œè¿™ä¸€ç‚¹éå¸¸é‡è¦ï¼›NIOæœ¬èº«å°±æ˜¯ä¸€ä¸ªéš¾ä»¥æŒæ¡çš„ç‚¹ï¼Œjdkåœ¨å®ç°NIOè¿™ä¸€å—å…¶å®è¿˜æ˜¯æœ‰äº›é—®é¢˜çš„ï¼ŒNettyé€šè¿‡å®ƒçš„åŒ…è£…æˆ–è€…ä¸€äº›å°è£…å±è”½äº†åº•å±‚çš„ä¸€äº›é—®é¢˜å‘ä¸Šå±‚æš´éœ²å‡ºæ¥äº†æ›´åŠ å‹å¥½ä»¥åŠæ›´æ˜“äºä½¿ç”¨çš„æ¥å£ã€‚</li></ul></li><li>Nettyç¼–è§£ç å¼€å‘æŠ€æœ¯</li><li>Nettyé‡è¦ç±»ä¸æ¥å£æºä»£ç å‰–æ</li><li>Channelåˆ†æ<ul><li>Channelåœ¨Nettyä¸­æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼Œå¯ä»¥è®¤ä¸ºChannelå°±æ˜¯ä¸€æ¡è¿æ¥ï¼Œè·Ÿå®¢æˆ·ç«¯çš„Connectionï¼Œé€šè¿‡Channelæ¥è¿›è¡Œæ•°æ®çš„ä¼ é€’ï¼›</li></ul></li><li>åºåˆ—åŒ–è®²è§£</li></ul><p><strong>JVM</strong></p><p>ä»‹ç»ï¼šJVMæ˜¯ä¸€ä¸ªä»¤äººæœ›è€Œå´æ­¥çš„é¢†åŸŸï¼Œå› ä¸ºå®ƒåšå¤§ç²¾æ·±ï¼Œæ¶‰åŠåˆ°çš„å†…å®¹ä¸çŸ¥è¯†ç‚¹éå¸¸ä¹‹å¤šã€‚<br>è™½ç„¶Javaå¼€å‘è€…æ¯å¤©éƒ½åœ¨ä½¿ç”¨JVMï¼Œä½†å¯¹å…¶æ‰€ç ”ç©¶å¹¶ä¸”æ·±å…¥ç ”ç©¶çš„äººå´å°‘ä¹‹åˆå°‘ã€‚<br>ç„¶è€Œï¼ŒJVMçš„é‡è¦æ€§å´åˆæ˜¯ä¸è¨€è€Œå–»çš„ã€‚<br>åŸºäºJVMçš„å„ç§åŠ¨æ€ä¸é™æ€è¯­è¨€ç”Ÿæ€åœˆå·²ç»å¼‚å¸¸ç¹è£äº†ï¼Œå¯¹JVMçš„è¿è¡Œæœºåˆ¶æœ‰ä¸€å®šçš„äº†è§£ä¸ä½†å¯ä»¥æå‡æˆ‘ä»¬çš„ç«äº‰åŠ›ï¼Œè¿˜å¯ä»¥è®©æˆ‘ä»¬åœ¨é¢å¯¹é—®é¢˜æ—¶èƒ½å¤Ÿæ²‰ç€åº”å¯¹ï¼ŒåŠ é€Ÿé—®é¢˜çš„è§£å†³é€Ÿåº¦ï¼›åŒæ—¶è¿˜èƒ½å¤Ÿå¢å¼ºæˆ‘ä»¬çš„è‡ªä¿¡å¿ƒï¼Œè®©æˆ‘ä»¬æ›´åŠ æ¸¸åˆƒæœ‰ä½™ã€‚</p><ul><li>JVMä»‹ç»</li><li>HotSpotè™šæ‹Ÿæœºè®²è§£</li><li>åƒåœ¾æ”¶é›†æ–¹å¼è¯¦è§£</li><li>åƒåœ¾æ”¶é›†ç®—æ³•è¯¦è§£</li><li>åƒåœ¾æ”¶é›†å™¨è¯¦è§£</li><li>åˆ†ä»£åƒåœ¾æ”¶é›†æœºåˆ¶è¯¦è§£</li><li>æ–°ç”Ÿä»£è®²è§£</li><li>è€å¹´ä»£è®²è§£</li><li>G1æ”¶é›†å™¨åˆ†æä¸å®ä¾‹<ul><li>ä»jdk7å¼•å…¥çš„G1æ”¶é›†å™¨ï¼Œåˆ†æ</li></ul></li><li>å¸¸è§ä¸”é‡è¦è™šæ‹Ÿæœºå‚æ•°ç¤ºä¾‹</li><li>æ ˆ</li><li>æ–¹æ³•åŒº</li><li>çº¿ç¨‹å…±äº«å†…å­˜åŒº</li><li>æ ¹æœç´¢ç®—æ³•</li><li>Serialæ”¶é›†å™¨</li><li>ParNewæ”¶é›†å™¨</li><li>ç±»åŠ è½½æœºåˆ¶è¯¦è§£</li><li>ç±»åŠ è½½çš„åŒäº²å§”æ‰˜æœºåˆ¶</li><li>å­—èŠ‚ç æ–‡ä»¶ç”Ÿæˆä¸åˆ†æ</li><li>é­”æ•°<ul><li>å…³äºjdkå­—èŠ‚ç classæ–‡ä»¶çš„åˆ†æ</li></ul></li><li>å¸¸é‡æ± ä¸æ–¹æ³•è¡¨</li><li>å„ç§æŒ‡ä»¤è¯¦è§£</li><li>é”è¯¦è§£</li><li>çº¿ç¨‹å®‰å…¨</li><li>åå‘é”ã€è‡ªæ—‹é”ä¸è½»é‡çº§é”</li><li>JITç¼–è¯‘å™¨</li><li>GCæ—¥å¿—ç”Ÿæˆä¸åˆ†æ</li><li>è™šæ‹Ÿæœºç›‘æ§å·¥å…·è¯¦è§£<ul><li>jmatã€jConsoleâ€¦</li></ul></li><li>jConsoleä½¿ç”¨æ–¹å¼è¯¦è§£</li><li>ä½•ä¸ºé€ƒé€¸ä¸é€ƒé€¸åˆ†æ</li><li>æ–¹æ³•å†…è”</li><li>è™šæ‹Ÿæœºå†…å­˜æ¨¡å‹è¯¦è§£</li></ul><p><strong>Node</strong></p><p>ä»‹ç»ï¼šåœ¨å½“ä¸‹çš„äº’è”ç½‘æ—¶ä»£ï¼ŒNodeçš„é‡è¦æ€§å·²ç»ä¸è¨€è€Œå–»ï¼Œè¯¸å¤šå›½å†…å¤–çš„äº’è”ç½‘å…¬å¸éƒ½å·²ç»æœ‰å¤§é‡çš„é«˜æ€§èƒ½ç³»ç»Ÿè¿è¡Œåœ¨Nodeä¹‹ä¸Šï¼ŒNodeå‡­å€Ÿå…¶å•çº¿ç¨‹ã€å¼‚æ­¥ç­‰ä¸¾æªå®ç°äº†æé«˜çš„æ€§èƒ½åŸºå‡†ã€‚<br>æ­¤å¤–ï¼Œç›®å‰æœ€ä¸ºæµè¡Œçš„Webå¼€å‘æ¨¡å¼æ˜¯å‰åç«¯åˆ†ç¦»çš„å½¢å¼ï¼Œå³å‰ç«¯å¼€å‘è€…ä¸åç«¯å¼€å‘è€…åœ¨è‡ªå·±å–œæ¬¢çš„IDEä¸Šç‹¬ç«‹è¿›è¡Œå¼€å‘ï¼Œ<br>ç„¶åé€šè¿‡HTTPæˆ–æ˜¯RPCç­‰æ–¹å¼å®ç°æ•°æ®ä¸æµç¨‹çš„äº¤äº’ã€‚<br>è¿™ç§å¼€å‘æ¨¡å¼åœ¨Nodeçš„å¼ºå¤§åŠŸèƒ½çš„å¼•é¢†ä¸‹å˜å¾—è¶Šæ¥è¶Šæç¬‘ï¼Œä¹Ÿè¶Šæ¥è¶Šå—åˆ°äº’è”ç½‘å…¬å¸çš„é’çã€‚<br>åœ¨GitHubä¸Šæœç´¢ï¼Œä½ ä¼šçœ‹åˆ°ä¸Nodeç›¸å…³çš„é¡¹ç›®å§‹ç»ˆå‘ˆç°å‡ºç«çˆ†çš„æ€åŠ¿ï¼Œè¿™ä¹Ÿè¿›ä¸€æ­¥è¯æ˜äº†Nodeçš„å·¨å¤§å•†ä¸šä»·å€¼ä¸æŠ€æœ¯ä»·å€¼ã€‚<br>å› æ­¤ï¼Œæ— è®ºæ˜¯å‰ç«¯å¼€å‘è€…ï¼Œè¿˜æ˜¯ä¼ ç»Ÿçš„åå°å¼€å‘è€…ï¼ŒæŒæ¡Nodeå·²ç»æ˜¯åˆ»ä¸å®¹ç¼“äº†ã€‚<br>è€Œä¸”ï¼ŒNodeçš„å®Œç¾æ­æ¡£NPMä¹Ÿæä¾›äº†å¼‚å¸¸ä¸°å¯Œçš„å·¥å…·åŒ…ä¸æ¡†æ¶ä¾›å¼€å‘è€…ä½¿ç”¨ã€‚<br>å­¦ä¹ Nodeåº”è¯¥æ˜¯æ¯ä¸€ä¸ªå¯¹å‰ç«¯å¼€å‘æˆ–æ˜¯åç«¯å¼€å‘æœ‰è¿½æ±‚çš„äººæ‰€å¿…é¡»è¦åšçš„äº‹æƒ…ã€‚</p><p>Nodeæœ¬èº«ä½¿ç”¨javaScriptæ¥è¿›è¡Œç¼–å†™çš„ï¼›<br>å‰åç«¯ä¸åˆ†ç¦»çš„æ¨¡å¼æ¯”å¦‚JSPå¼€å‘ï¼Œæ¯«æ— ç–‘é—®ï¼Œå‰ç«¯ä»£ç ä¸åç«¯ä»£ç è‚¯å®šæ˜¯è€¦åˆåœ¨ä¸€èµ·çš„ï¼›ç¬¬ä¸€ç‚¹ï¼Œå³ä¾¿ä½¿ç”¨å„ç§æ ‡ç­¾ï¼Œæ ‡ç­¾èƒŒåä¹Ÿæ˜¯ä»£ç ï¼›æ ‡ç­¾åªæ˜¯ä»£ç çš„ä¸€ç§è½½ä½“ï¼›æ ‡ç­¾å¯ä»¥è®¤ä¸ºæ˜¯åç«¯ä¸€äº›æºä»£ç çš„è½½ä½“è·Ÿå‰ç«¯çš„htmlã€cssã€jsè‚¯å®šæ˜¯è€¦åˆåœ¨ä¸€èµ·çš„ï¼›<br>ç¬¬äºŒç‚¹ï¼Œå‰ç«¯ä¸€å®šå¾—è¿å°±ç€åç«¯ï¼Œå› ä¸ºæ˜¯JSPå¼€å‘æ‰€ä»¥è‚¯å®šå¾—åœ¨åç«¯çš„IDEï¼ˆideaã€eclipseâ€¦.ï¼‰ä¸Šè¿›è¡Œå¼€å‘ï¼Œè€Œå‰ç«¯å¦‚æœæƒ³ä½¿ç”¨åˆ«çš„è‡ªå·±é¡ºæ‰‹çš„ideåˆ™æ¯”è¾ƒéº»çƒ¦ï¼Œå°±è‚¯å®šåªèƒ½åœ¨åç«¯çš„ideä¸Šè¿›è¡Œå¼€å‘ï¼›<br>ç¬¬ä¸‰ç‚¹ï¼Œå¼€å‘å®Œä¸€ä¸ªåŠŸèƒ½ä¹‹åéœ€è¦æµ‹è¯•ï¼Œæµ‹è¯•å°±éœ€è¦å»å¯åŠ¨åç«¯æœåŠ¡ï¼Œé‚£ä¹ˆæ­¤æ—¶å‰ç«¯è¿˜éœ€è¦å»è¿›è¡Œå­¦ä¹ åç«¯çš„é‚£ä¸€å¥—ä¸œè¥¿å°±éå¸¸éº»çƒ¦äº†ï¼›<br>NPMå¯ä»¥çœ‹åšæ˜¯javaå½“ä¸­çš„gradleä»¥åŠmavenï¼Œå½“ç„¶ä¸æ˜¯ç‰¹åˆ«ä¸€æ ·ï¼›</p><ul><li>Nodeçš„å®‰è£…ä¸é…ç½®ï¼Œä½¿ç”¨NPM</li><li>ä½¿ç”¨nvmï¼ˆNode Version Managerï¼‰æ¥ç®¡ç†Nodeä¸npm<ul><li>Nodeç¤¾åŒºåˆ†è£‚å²ï¼šæœ‰ä¸¤æ‹¨äººå¯¹Nodeçš„å‘å±•å‰æ™¯æŠ±æœ‰ä¸åŒçš„çœ‹æ³•ï¼Œå…¶ä¸­ä¸€æ‹¨äººä»Nodeé¢†åŸŸä¸­èµ°å‡ºæ¥äº†ï¼Œç»™NodeåŒ…åšäº†ä¸€ä¸ªåˆ†æ”¯ï¼Œè¿™ä¸ªæ–°çš„åˆ†æ”¯å«åšio.jsï¼ŒåŸæ¥å«åšNodejsï¼Œæ‰€ä»¥åæ¥Nodeå’Œioè¿™ä¸¤æ‹¨äººç‹¬è‡ªè¿›è¡Œå¼€å‘ï¼Œä»æ­¤å˜åŒ–å°±éå¸¸å¿«äº†ã€‚åæœŸNodejsä¸iojsåˆå¤åˆåœ¨ä¸€èµ·äº†ï¼Œ<code>https://nodejs.org/en/</code>ï¼›ï¼ˆChromeçš„ç‰ˆæœ¬å‘å±•é€Ÿåº¦ä¹Ÿå¾ˆå¿«ï¼‰</li><li>ç”±äºNodeç‰ˆæœ¬å‡çº§éå¸¸å¿«ï¼Œæ‰€ä»¥ä¸å¯èƒ½åœ¨ä¸€å°ç”µè„‘ä¸Šåªè£…ä¸€ä¸ªNodeç‰ˆæœ¬ï¼Œå› ä¸ºNodeå®‰è£…å®Œæˆä¹‹åå†å‡çº§æ˜¯ä¸€ä»¶éå¸¸ç—›è‹¦çš„ä¸€ä»¶äº‹æƒ…ï¼›æ‰€ä»¥å¯ä»¥ä½¿ç”¨å·¥å…·nvmï¼Œå¯ä»¥åœ¨è£…ä»»æ„å¤šä¸ªNodeç‰ˆæœ¬ï¼›è¿™ä¹Ÿæ˜¯ç›¸å½“äºpythonçš„å¼€å‘ç¯å¢ƒä¸€æ ·ï¼Œé€šè¿‡pythonçš„ä¸€äº›åŒ…ç®¡ç†å™¨æ¥å»åœ¨ä¸€å°ç”µè„‘ä¸Šå®‰è£…å¤šä¸ªpythonçš„ç‰ˆæœ¬ï¼›</li></ul></li><li>nvmé…ç½®ä¸é‡è¦å‘½ä»¤è§£è¯»</li><li>Nodeäº‹ä»¶ä¸å›è°ƒæœºåˆ¶<ul><li>Nodeäº‹ä»¶ä¸å›è°ƒæœºåˆ¶ã€Nodeå¼‚æ­¥IOæ¨¡å‹ã€Nodeçš„å•çº¿ç¨‹æ¨¡å‹è¿™ä¸‰ä¸ªæ˜¯äº†è§£Nodeçš„åŸºæœ¬è®¾è®¡æ¶æ„ï¼›</li></ul></li><li>Nodeå¼‚æ­¥IOæ¨¡å‹</li><li>Nodeçš„å•çº¿ç¨‹æ¨¡å‹</li><li>Nodeæ¨¡å—</li><li>npmä½¿ç”¨æ–¹å¼<ul><li>npmé™¤äº†èƒ½åƒmavenã€gradleä¸€æ ·åšåŒ…ç®¡ç†å™¨è¿˜æä¾›äº†NPMScriptè¿™æ ·çš„åŠŸèƒ½ï¼Œå¯ä»¥ä»ä¸­ç¼–å†™è„šæœ¬ï¼›</li></ul></li><li>package.jsonè¯¦è§£</li><li>å…¨å±€å®‰è£…ä¸å±€éƒ¨å®‰è£…æ–¹å¼</li><li>npmé‡è¦åŠŸèƒ½è¯¦è§£</li><li>Nodeå¼‚æ­¥ç¼–ç¨‹è¯¦è§£</li><li>Nodeæµåˆ†æ</li><li>è¾“å…¥ä¸è¾“å‡º</li><li>Nodeç½‘ç»œåŠŸèƒ½</li><li>Nodeçš„æ§åˆ¶å°</li><li>äº‹ä»¶å¾ªç¯æœºåˆ¶</li><li>Nodeè°ƒè¯•</li><li>ä½¿ç”¨exportså¯¹è±¡</li><li>Nodeæ“çºµæ–‡ä»¶ç³»ç»Ÿè¯¦è§£</li><li>Bufferè¯¦è§£</li><li>Nodeçš„é”™è¯¯å¤„ç†æ¨¡å‹</li><li>ä½¿ç”¨Nodeè®¿é—®MongoDB</li><li>ä½¿ç”¨Nodeè®¿é—®MySQL</li><li>ä½¿ç”¨Nodeè®¿é—®Redis</li><li>ä¸­é—´ä»¶è¯¦è§£</li><li>Node WebæœåŠ¡å™¨è¯¦è§£</li><li>WebSocketåœ¨Nodeä¸­çš„å®ç°æ–¹å¼</li><li>WebSocketæ•°æ®ä¼ è¾“</li><li>SocketIOè¯¦è§£</li><li>Expressæˆ–KOAå…¨åŠŸèƒ½è¯¦è§£ï¼ˆå…¨æ–¹ä½è®²è§£Nodeé¢†åŸŸæœ€ä¸ºé‡è¦çš„Webæ¡†æ¶ï¼‰</li></ul><h2 id="lambdaè¡¨è¾¾å¼åˆæ­¥ä¸å‡½æ•°å¼æ¥å£"><a href="#lambdaè¡¨è¾¾å¼åˆæ­¥ä¸å‡½æ•°å¼æ¥å£" class="headerlink" title="lambdaè¡¨è¾¾å¼åˆæ­¥ä¸å‡½æ•°å¼æ¥å£"></a>lambdaè¡¨è¾¾å¼åˆæ­¥ä¸å‡½æ•°å¼æ¥å£</h2><h2 id="æ·±å…¥å‡½æ•°å¼æ¥å£ä¸æ–¹æ³•å¼•ç”¨"><a href="#æ·±å…¥å‡½æ•°å¼æ¥å£ä¸æ–¹æ³•å¼•ç”¨" class="headerlink" title="æ·±å…¥å‡½æ•°å¼æ¥å£ä¸æ–¹æ³•å¼•ç”¨"></a>æ·±å…¥å‡½æ•°å¼æ¥å£ä¸æ–¹æ³•å¼•ç”¨</h2><h2 id="lambdaè¡¨è¾¾å¼æ·±å…¥ä¸æµåˆæ­¥"><a href="#lambdaè¡¨è¾¾å¼æ·±å…¥ä¸æµåˆæ­¥" class="headerlink" title="lambdaè¡¨è¾¾å¼æ·±å…¥ä¸æµåˆæ­¥"></a>lambdaè¡¨è¾¾å¼æ·±å…¥ä¸æµåˆæ­¥</h2><h2 id="functionæ¥å£è¯¦è§£"><a href="#functionæ¥å£è¯¦è§£" class="headerlink" title="functionæ¥å£è¯¦è§£"></a>functionæ¥å£è¯¦è§£</h2><h2 id="functionä¸bifunctionå‡½æ•°å¼æ¥å£è¯¦è§£"><a href="#functionä¸bifunctionå‡½æ•°å¼æ¥å£è¯¦è§£" class="headerlink" title="functionä¸bifunctionå‡½æ•°å¼æ¥å£è¯¦è§£"></a>functionä¸bifunctionå‡½æ•°å¼æ¥å£è¯¦è§£</h2><h2 id="predicateæ·±å…¥å‰–æä¸å‡½æ•°å¼ç¼–ç¨‹æœ¬è´¨"><a href="#predicateæ·±å…¥å‰–æä¸å‡½æ•°å¼ç¼–ç¨‹æœ¬è´¨" class="headerlink" title="predicateæ·±å…¥å‰–æä¸å‡½æ•°å¼ç¼–ç¨‹æœ¬è´¨"></a>predicateæ·±å…¥å‰–æä¸å‡½æ•°å¼ç¼–ç¨‹æœ¬è´¨</h2><h2 id="supplierä¸å‡½æ•°å¼æ¥å£æ€»ç»“"><a href="#supplierä¸å‡½æ•°å¼æ¥å£æ€»ç»“" class="headerlink" title="supplierä¸å‡½æ•°å¼æ¥å£æ€»ç»“"></a>supplierä¸å‡½æ•°å¼æ¥å£æ€»ç»“</h2><h2 id="optionalæ·±å…¥è®²è§£"><a href="#optionalæ·±å…¥è®²è§£" class="headerlink" title="optionalæ·±å…¥è®²è§£"></a>optionalæ·±å…¥è®²è§£</h2><h2 id="æ–¹æ³•å¼•ç”¨è¯¦è§£"><a href="#æ–¹æ³•å¼•ç”¨è¯¦è§£" class="headerlink" title="æ–¹æ³•å¼•ç”¨è¯¦è§£"></a>æ–¹æ³•å¼•ç”¨è¯¦è§£</h2><h2 id="æ–¹æ³•å¼•ç”¨åœºæ™¯å‰–æä¸é»˜è®¤æ–¹æ³•åˆ†æ"><a href="#æ–¹æ³•å¼•ç”¨åœºæ™¯å‰–æä¸é»˜è®¤æ–¹æ³•åˆ†æ" class="headerlink" title="æ–¹æ³•å¼•ç”¨åœºæ™¯å‰–æä¸é»˜è®¤æ–¹æ³•åˆ†æ"></a>æ–¹æ³•å¼•ç”¨åœºæ™¯å‰–æä¸é»˜è®¤æ–¹æ³•åˆ†æ</h2><h2 id="streamä»‹ç»ä¸æ“ä½œæ–¹å¼è¯¦è§£"><a href="#streamä»‹ç»ä¸æ“ä½œæ–¹å¼è¯¦è§£" class="headerlink" title="streamä»‹ç»ä¸æ“ä½œæ–¹å¼è¯¦è§£"></a>streamä»‹ç»ä¸æ“ä½œæ–¹å¼è¯¦è§£</h2><h2 id="streamæ·±åº¦è§£æä¸æºç å®è·µ"><a href="#streamæ·±åº¦è§£æä¸æºç å®è·µ" class="headerlink" title="streamæ·±åº¦è§£æä¸æºç å®è·µ"></a>streamæ·±åº¦è§£æä¸æºç å®è·µ</h2><h2 id="streamå®ä¾‹å‰–æ"><a href="#streamå®ä¾‹å‰–æ" class="headerlink" title="streamå®ä¾‹å‰–æ"></a>streamå®ä¾‹å‰–æ</h2><h2 id="streamé™·é˜±å‰–æ"><a href="#streamé™·é˜±å‰–æ" class="headerlink" title="streamé™·é˜±å‰–æ"></a>streamé™·é˜±å‰–æ</h2><h2 id="å†…éƒ¨è¿­ä»£ä¸å¤–éƒ¨è¿­ä»£æœ¬è´¨å‰–æåŠæµæœ¬æºåˆ†æ"><a href="#å†…éƒ¨è¿­ä»£ä¸å¤–éƒ¨è¿­ä»£æœ¬è´¨å‰–æåŠæµæœ¬æºåˆ†æ" class="headerlink" title="å†…éƒ¨è¿­ä»£ä¸å¤–éƒ¨è¿­ä»£æœ¬è´¨å‰–æåŠæµæœ¬æºåˆ†æ"></a>å†…éƒ¨è¿­ä»£ä¸å¤–éƒ¨è¿­ä»£æœ¬è´¨å‰–æåŠæµæœ¬æºåˆ†æ</h2><h2 id="æµçš„çŸ­è·¯ä¸å¹¶å‘æµ"><a href="#æµçš„çŸ­è·¯ä¸å¹¶å‘æµ" class="headerlink" title="æµçš„çŸ­è·¯ä¸å¹¶å‘æµ"></a>æµçš„çŸ­è·¯ä¸å¹¶å‘æµ</h2><h2 id="streamåˆ†ç»„ä¸åˆ†åŒºè¯¦è§£"><a href="#streamåˆ†ç»„ä¸åˆ†åŒºè¯¦è§£" class="headerlink" title="streamåˆ†ç»„ä¸åˆ†åŒºè¯¦è§£"></a>streamåˆ†ç»„ä¸åˆ†åŒºè¯¦è§£</h2><h2 id="collectoræºç åˆ†æä¸æ”¶é›†å™¨æ ¸å¿ƒ"><a href="#collectoræºç åˆ†æä¸æ”¶é›†å™¨æ ¸å¿ƒ" class="headerlink" title="collectoræºç åˆ†æä¸æ”¶é›†å™¨æ ¸å¿ƒ"></a>collectoræºç åˆ†æä¸æ”¶é›†å™¨æ ¸å¿ƒ</h2><h2 id="collectoråŒä¸€æ€§ä¸ç»“åˆæ€§åˆ†æ"><a href="#collectoråŒä¸€æ€§ä¸ç»“åˆæ€§åˆ†æ" class="headerlink" title="collectoråŒä¸€æ€§ä¸ç»“åˆæ€§åˆ†æ"></a>collectoråŒä¸€æ€§ä¸ç»“åˆæ€§åˆ†æ</h2><h2 id="collectorå¤åˆä¸æ³¨æ„äº‹é¡¹"><a href="#collectorå¤åˆä¸æ³¨æ„äº‹é¡¹" class="headerlink" title="collectorå¤åˆä¸æ³¨æ„äº‹é¡¹"></a>collectorå¤åˆä¸æ³¨æ„äº‹é¡¹</h2><h2 id="æ”¶é›†å™¨ç”¨æ³•è¯¦è§£ä¸å¤šçº§åˆ†ç»„å’Œåˆ†åŒº"><a href="#æ”¶é›†å™¨ç”¨æ³•è¯¦è§£ä¸å¤šçº§åˆ†ç»„å’Œåˆ†åŒº" class="headerlink" title="æ”¶é›†å™¨ç”¨æ³•è¯¦è§£ä¸å¤šçº§åˆ†ç»„å’Œåˆ†åŒº"></a>æ”¶é›†å™¨ç”¨æ³•è¯¦è§£ä¸å¤šçº§åˆ†ç»„å’Œåˆ†åŒº</h2><h2 id="æ¯”è¾ƒå™¨è¯¦è§£ä¸ç±»å‹æ¨æ–­ç‰¹ä¾‹"><a href="#æ¯”è¾ƒå™¨è¯¦è§£ä¸ç±»å‹æ¨æ–­ç‰¹ä¾‹" class="headerlink" title="æ¯”è¾ƒå™¨è¯¦è§£ä¸ç±»å‹æ¨æ–­ç‰¹ä¾‹"></a>æ¯”è¾ƒå™¨è¯¦è§£ä¸ç±»å‹æ¨æ–­ç‰¹ä¾‹</h2><h2 id="æ¯”è¾ƒå™¨æ·±å…¥"><a href="#æ¯”è¾ƒå™¨æ·±å…¥" class="headerlink" title="æ¯”è¾ƒå™¨æ·±å…¥"></a>æ¯”è¾ƒå™¨æ·±å…¥</h2><h2 id="è‡ªå®šä¹‰æ”¶é›†å™¨å®ç°"><a href="#è‡ªå®šä¹‰æ”¶é›†å™¨å®ç°" class="headerlink" title="è‡ªå®šä¹‰æ”¶é›†å™¨å®ç°"></a>è‡ªå®šä¹‰æ”¶é›†å™¨å®ç°</h2><h2 id="è‡ªå®šä¹‰æ”¶é›†å™¨æ·±åº¦å‰–æä¸å¹¶è¡Œæµé™·é˜±"><a href="#è‡ªå®šä¹‰æ”¶é›†å™¨æ·±åº¦å‰–æä¸å¹¶è¡Œæµé™·é˜±" class="headerlink" title="è‡ªå®šä¹‰æ”¶é›†å™¨æ·±åº¦å‰–æä¸å¹¶è¡Œæµé™·é˜±"></a>è‡ªå®šä¹‰æ”¶é›†å™¨æ·±åº¦å‰–æä¸å¹¶è¡Œæµé™·é˜±</h2><h2 id="æ”¶é›†å™¨æšä¸¾ç‰¹æ€§æ·±åº¦è§£æä¸å¹¶è¡ŒæµåŸç†"><a href="#æ”¶é›†å™¨æšä¸¾ç‰¹æ€§æ·±åº¦è§£æä¸å¹¶è¡ŒæµåŸç†" class="headerlink" title="æ”¶é›†å™¨æšä¸¾ç‰¹æ€§æ·±åº¦è§£æä¸å¹¶è¡ŒæµåŸç†"></a>æ”¶é›†å™¨æšä¸¾ç‰¹æ€§æ·±åº¦è§£æä¸å¹¶è¡ŒæµåŸç†</h2><h2 id="collectorså·¥å‚ç±»æºç åˆ†æä¸å®æˆ˜"><a href="#collectorså·¥å‚ç±»æºç åˆ†æä¸å®æˆ˜" class="headerlink" title="collectorså·¥å‚ç±»æºç åˆ†æä¸å®æˆ˜"></a>collectorså·¥å‚ç±»æºç åˆ†æä¸å®æˆ˜</h2><h2 id="groupinbyæºç åˆ†æ"><a href="#groupinbyæºç åˆ†æ" class="headerlink" title="groupinbyæºç åˆ†æ"></a>groupinbyæºç åˆ†æ</h2><h2 id="partioningbyä¸groupingbyconcurrentæºç åˆ†æ"><a href="#partioningbyä¸groupingbyconcurrentæºç åˆ†æ" class="headerlink" title="partioningbyä¸groupingbyconcurrentæºç åˆ†æ"></a>partioningbyä¸groupingbyconcurrentæºç åˆ†æ</h2><h2 id="streamæºç åˆ†æ"><a href="#streamæºç åˆ†æ" class="headerlink" title="streamæºç åˆ†æ"></a>streamæºç åˆ†æ</h2><h2 id="streamä¸basestreamæºç åˆ†æ"><a href="#streamä¸basestreamæºç åˆ†æ" class="headerlink" title="streamä¸basestreamæºç åˆ†æ"></a>streamä¸basestreamæºç åˆ†æ</h2><h2 id="åˆ†å‰²è¿­ä»£å™¨æºç å‰–æ"><a href="#åˆ†å‰²è¿­ä»£å™¨æºç å‰–æ" class="headerlink" title="åˆ†å‰²è¿­ä»£å™¨æºç å‰–æ"></a>åˆ†å‰²è¿­ä»£å™¨æºç å‰–æ</h2><h2 id="åˆ†å‰²è¿­ä»£å™¨ä¸forkjoinè¯¦è§£"><a href="#åˆ†å‰²è¿­ä»£å™¨ä¸forkjoinè¯¦è§£" class="headerlink" title="åˆ†å‰²è¿­ä»£å™¨ä¸forkjoinè¯¦è§£"></a>åˆ†å‰²è¿­ä»£å™¨ä¸forkjoinè¯¦è§£</h2><h2 id="åˆ†å‰²è¿­ä»£å™¨å®ç°åˆ†æ"><a href="#åˆ†å‰²è¿­ä»£å™¨å®ç°åˆ†æ" class="headerlink" title="åˆ†å‰²è¿­ä»£å™¨å®ç°åˆ†æ"></a>åˆ†å‰²è¿­ä»£å™¨å®ç°åˆ†æ</h2><h2 id="ofprimitiveä¸ofintå®ç°åŸç†å‰–æ"><a href="#ofprimitiveä¸ofintå®ç°åŸç†å‰–æ" class="headerlink" title="ofprimitiveä¸ofintå®ç°åŸç†å‰–æ"></a>ofprimitiveä¸ofintå®ç°åŸç†å‰–æ</h2><h2 id="æµæºæ„é€ ä»£ç åˆ†æ"><a href="#æµæºæ„é€ ä»£ç åˆ†æ" class="headerlink" title="æµæºæ„é€ ä»£ç åˆ†æ"></a>æµæºæ„é€ ä»£ç åˆ†æ</h2><h2 id="referencepipelineä¸abstractpipelineæºç æ·±åº¦è§£è¯»"><a href="#referencepipelineä¸abstractpipelineæºç æ·±åº¦è§£è¯»" class="headerlink" title="referencepipelineä¸abstractpipelineæºç æ·±åº¦è§£è¯»"></a>referencepipelineä¸abstractpipelineæºç æ·±åº¦è§£è¯»</h2><h2 id="iteratorspliteratorä¸æµæºæ“ä½œæ–¹å¼è¯¦è§£"><a href="#iteratorspliteratorä¸æµæºæ“ä½œæ–¹å¼è¯¦è§£" class="headerlink" title="iteratorspliteratorä¸æµæºæ“ä½œæ–¹å¼è¯¦è§£"></a>iteratorspliteratorä¸æµæºæ“ä½œæ–¹å¼è¯¦è§£</h2><h2 id="æµè°ƒç”¨æœºåˆ¶ä¸åŸç†å¤§æ­ç§˜"><a href="#æµè°ƒç”¨æœºåˆ¶ä¸åŸç†å¤§æ­ç§˜" class="headerlink" title="æµè°ƒç”¨æœºåˆ¶ä¸åŸç†å¤§æ­ç§˜"></a>æµè°ƒç”¨æœºåˆ¶ä¸åŸç†å¤§æ­ç§˜</h2><h2 id="sinkä¸opwrapsinkæºç è§£è¯»"><a href="#sinkä¸opwrapsinkæºç è§£è¯»" class="headerlink" title="sinkä¸opwrapsinkæºç è§£è¯»"></a>sinkä¸opwrapsinkæºç è§£è¯»</h2><h2 id="terminalopæºç åˆ†æä¸ç»ˆæ­¢æ“ä½œå±‚æ¬¡ä½“ç³»"><a href="#terminalopæºç åˆ†æä¸ç»ˆæ­¢æ“ä½œå±‚æ¬¡ä½“ç³»" class="headerlink" title="terminalopæºç åˆ†æä¸ç»ˆæ­¢æ“ä½œå±‚æ¬¡ä½“ç³»"></a>terminalopæºç åˆ†æä¸ç»ˆæ­¢æ“ä½œå±‚æ¬¡ä½“ç³»</h2><h2 id="æµå»¶è¿Ÿæ±‚å€¼åº•å±‚åˆ†æä¸sinkè¿æ¥æœºåˆ¶æ­ç§˜"><a href="#æµå»¶è¿Ÿæ±‚å€¼åº•å±‚åˆ†æä¸sinkè¿æ¥æœºåˆ¶æ­ç§˜" class="headerlink" title="æµå»¶è¿Ÿæ±‚å€¼åº•å±‚åˆ†æä¸sinkè¿æ¥æœºåˆ¶æ­ç§˜"></a>æµå»¶è¿Ÿæ±‚å€¼åº•å±‚åˆ†æä¸sinkè¿æ¥æœºåˆ¶æ­ç§˜</h2><h2 id="streamä¸­é—´æ“ä½œä¸ç»ˆæ­¢æ“ä½œå±‚æ¬¡ä½“ç³»åˆ†æä¸è®¾è®¡æ€æƒ³å‰–æ"><a href="#streamä¸­é—´æ“ä½œä¸ç»ˆæ­¢æ“ä½œå±‚æ¬¡ä½“ç³»åˆ†æä¸è®¾è®¡æ€æƒ³å‰–æ" class="headerlink" title="streamä¸­é—´æ“ä½œä¸ç»ˆæ­¢æ“ä½œå±‚æ¬¡ä½“ç³»åˆ†æä¸è®¾è®¡æ€æƒ³å‰–æ"></a>streamä¸­é—´æ“ä½œä¸ç»ˆæ­¢æ“ä½œå±‚æ¬¡ä½“ç³»åˆ†æä¸è®¾è®¡æ€æƒ³å‰–æ</h2><h2 id="jodaé¡¹ç›®ä»‹ç»ä¸å®æˆ˜"><a href="#jodaé¡¹ç›®ä»‹ç»ä¸å®æˆ˜" class="headerlink" title="jodaé¡¹ç›®ä»‹ç»ä¸å®æˆ˜"></a>jodaé¡¹ç›®ä»‹ç»ä¸å®æˆ˜</h2><h2 id="java8å…¨æ–°æ—¥æœŸä¸æ—¶é—´apiè¯¦è§£ä¸utcä»‹ç»"><a href="#java8å…¨æ–°æ—¥æœŸä¸æ—¶é—´apiè¯¦è§£ä¸utcä»‹ç»" class="headerlink" title="java8å…¨æ–°æ—¥æœŸä¸æ—¶é—´apiè¯¦è§£ä¸utcä»‹ç»"></a>java8å…¨æ–°æ—¥æœŸä¸æ—¶é—´apiè¯¦è§£ä¸utcä»‹ç»</h2><h2 id="java8å…¨æ–°æ—¥æœŸä¸æ—¶é—´apiå®æˆ˜"><a href="#java8å…¨æ–°æ—¥æœŸä¸æ—¶é—´apiå®æˆ˜" class="headerlink" title="java8å…¨æ–°æ—¥æœŸä¸æ—¶é—´apiå®æˆ˜"></a>java8å…¨æ–°æ—¥æœŸä¸æ—¶é—´apiå®æˆ˜</h2>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;è§‚çœ‹ç¬”è®°ï¼š&lt;a href=&quot;https://www.bilibili.com/video/BV1w4411e7T8?p=1&quot; target=
      
    
    </summary>
    
    
      <category term="jdk8" scheme="https://fengshana.github.io/categories/jdk8/"/>
    
    
      <category term="jdk8" scheme="https://fengshana.github.io/tags/jdk8/"/>
    
      <category term="java" scheme="https://fengshana.github.io/tags/java/"/>
    
  </entry>
  
  <entry>
    <title>Javaé¢è¯•çƒ­ç‚¹é—®é¢˜ï¼ŒsynchronizedåŸç†å‰–æä¸ä¼˜åŒ–</title>
    <link href="https://fengshana.github.io/2020/06/09/%E3%80%90%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JAVA%E8%99%9A%E6%8B%9F%E6%9C%BA%E3%80%91/%E3%80%90%E9%94%81%E3%80%91Java%E9%9D%A2%E8%AF%95%E7%83%AD%E7%82%B9%E9%97%AE%E9%A2%98%EF%BC%8Csynchronized%E5%8E%9F%E7%90%86%E5%89%96%E6%9E%90%E4%B8%8E%E4%BC%98%E5%8C%96/"/>
    <id>https://fengshana.github.io/2020/06/09/%E3%80%90%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JAVA%E8%99%9A%E6%8B%9F%E6%9C%BA%E3%80%91/%E3%80%90%E9%94%81%E3%80%91Java%E9%9D%A2%E8%AF%95%E7%83%AD%E7%82%B9%E9%97%AE%E9%A2%98%EF%BC%8Csynchronized%E5%8E%9F%E7%90%86%E5%89%96%E6%9E%90%E4%B8%8E%E4%BC%98%E5%8C%96/</id>
    <published>2020-06-08T20:20:50.000Z</published>
    <updated>2020-06-08T20:12:36.233Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è§‚çœ‹ç¬”è®°ï¼š<code>https://www.bilibili.com/video/BV1aJ411V763?from=search&amp;seid=6293835933701781647</code></p><p>è§‚çœ‹äº†è¿™ä¸ªè§†é¢‘ä¹‹åï¼Œæˆ‘å»ºè®®å•ŠğŸ˜‰ï¼Œå¯ä»¥å»çœ‹ä¸‹é‚£ä¸ªã€Š<strong>æ·±å…¥javaè™šæ‹Ÿæœº</strong>ã€‹è¿™æœ¬ä¹¦ï¼Œå› ä¸ºè¿™ä¸ªè¯¾è®²çš„å†…å®¹è·Ÿè¿™æœ¬ä¹¦å½“ä¸­çš„<strong>ç¬¬13ç«  çº¿ç¨‹å®‰å…¨ä¸é”ä¼˜åŒ–</strong>ï¼Œå†…å®¹ååˆ†ç›¸ä¼¼ï¼›æ‰€ä»¥æˆ‘è®¤ä¸ºå¯ä»¥å½“åšæ˜¯è¯¾åå¤ä¹ ä¹¦çš„é‚£ç§ï¼›<br>æˆ‘ä¹Ÿæ˜¯ç»è¿‡äº†å¯¹æ¯”ä¸¤è€…çš„å†…å®¹æ‰è¿™ä¹ˆè§‰å¾—ï¼›å› ä¸ºçœŸçš„å¾ˆç›¸ä¼¼ï¼›<br>åŒ…æ‹¬åé¢ä¸¾çš„stringçš„é‚£ä¸ªä¾‹å­ï¼›<br>ä¸ºäº†æˆ‘æ›´æ·±åˆ»çš„è®°å¿†ï¼›æˆ‘å†³å®šæˆ‘è¿˜æ˜¯ä»”ç»†çœ‹ä¸€éè¿™ä¸€éƒ¨åˆ†å†…å®¹ï¼›<br>ï¼ˆç°åœ¨çœ‹æ¥å…¶å®å°±æ˜¯<strong>ç¬¬äº”éƒ¨åˆ† é«˜æ•ˆå¹¶å‘</strong> è·Ÿè¯¥è¯¾ç¨‹è§†é¢‘è®²çš„ éå¸¸éå¸¸ç›¸åŒäº†ï¼›ï¼‰</p><p>ä¸ºäº†åšå®Œè¿™ç‚¹å±ç¬”è®°ï¼Œç†¬çš„æˆ‘çœŸæ˜¯è€çœ¼æ˜èŠ±ï¼›<br>æˆ‘å¯çœŸæ˜¯å¤ªè®¨åŒåšç¬”è®°äº†ï¼›</p><h2 id="è¯¾ç¨‹ä»‹ç»"><a href="#è¯¾ç¨‹ä»‹ç»" class="headerlink" title="è¯¾ç¨‹ä»‹ç»"></a>è¯¾ç¨‹ä»‹ç»</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">typora-root-ur<span class="variable">l:</span> img</span><br><span class="line">typora-<span class="keyword">copy</span>-images-<span class="keyword">to</span>: img</span><br></pre></td></tr></table></figure><h3 id="æ·±å…¥å­¦ä¹ å¹¶å‘ç¼–ç¨‹ä¸­çš„synchronized"><a href="#æ·±å…¥å­¦ä¹ å¹¶å‘ç¼–ç¨‹ä¸­çš„synchronized" class="headerlink" title="æ·±å…¥å­¦ä¹ å¹¶å‘ç¼–ç¨‹ä¸­çš„synchronized"></a>æ·±å…¥å­¦ä¹ å¹¶å‘ç¼–ç¨‹ä¸­çš„synchronized</h3><blockquote><p>è¯¾ç¨‹èƒŒæ™¯  </p></blockquote><p><strong>ç¬¬ä¸€</strong>ï¼š <strong>å¹¶å‘ç¼–ç¨‹</strong>æ˜¯javaçŸ¥è¯†ä½“ç³»å½“ä¸­æ¯”è¾ƒé‡è¦è€Œä¸”æ¯”è¾ƒæ˜¯æ¯”è¾ƒéš¾çš„ä¸€å—å†…å®¹ã€‚  </p><p>å› ä¸º<strong>å¹¶å‘ç¼–ç¨‹</strong>æ¶‰åŠçš„çŸ¥è¯†é¢æ¯”è¾ƒå¹¿ï¼Œç„¶åæ¯”è¾ƒæŠ½è±¡ä¸å¥½ç†è§£ï¼Œ<br>å› æ­¤å¦‚æœæˆ‘ä»¬æƒ³å¾ˆå¥½çš„æŒæ¡å¹¶å‘ç¼–ç¨‹è¿™å—å†…å®¹ï¼Œå…¶å®æ˜¯æœ‰ä¸€å®šéš¾åº¦çš„ã€‚<br><strong>synchronizedçš„åŸç†</strong>ä»¥åŠå…¶<strong>ä¼˜åŒ–</strong>äº†è§£å°‘ã€‚  </p><p><strong>ç¬¬äºŒ</strong>ï¼š <strong>å¹¶å‘ç¼–ç¨‹</strong>åœ¨å®é™…ä¼ä¸šå¼€å‘å½“ä¸­ä¹Ÿæ˜¯ä¼šé‡åˆ°çš„ï¼Œä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„æ¯”è¾ƒæ£˜æ‰‹çš„é—®é¢˜ã€‚  </p><p>ä¸¾ä¸ªä¾‹å­ï¼Œé“é“å”®ç¥¨çš„12306ç½‘ç«™ï¼Œ<br>åœ¨<strong>ä¸€ä¸ªæ—¶é—´æ®µ</strong>å†…ï¼Œå¯èƒ½æœ‰<strong>å¤§é‡</strong>çš„ç”¨æˆ·è¿‡æ¥è¿›è¡Œä¹°ç¥¨ï¼Œé‚£ä¹ˆæ­¤æ—¶å°±éœ€è¦è¿›è¡Œä¿è¯å–å‡ºå»çš„<strong>ç¥¨çš„æ•°é‡</strong>æ˜¯<strong>æ­£ç¡®</strong>çš„ï¼Œæ—¢<strong>ä¸èƒ½è¶…å–</strong>ä¹Ÿ<strong>ä¸èƒ½å°‘å–</strong>ã€‚<br>å¦å¤–è¿˜è¦ä¿è¯æ•´ä¸ªæ‰§è¡Œè¿‡ç¨‹çš„å–ç¥¨çš„<strong>æ‰§è¡Œæ•ˆç‡</strong>æ˜¯æ¯”è¾ƒ<strong>é«˜</strong>çš„ã€‚  </p><p>é‚£ä¹ˆå¯ä»¥é€šè¿‡<strong>synchronized</strong>æ¥è¿›è¡Œ<strong>ä¿è¯å–ç¥¨çš„æ•°é‡</strong>æ˜¯<strong>æ­£ç¡®</strong>çš„ï¼Œæ—¢<strong>ä¸ä¼šè¶…å–</strong>ä¹Ÿ<strong>ä¸ä¼šå°‘å–</strong>ã€‚  </p><p>ä½†æ˜¯åˆè¦å»è€ƒè™‘è¿™ä¸ª<strong>æ€§èƒ½é—®é¢˜</strong>ï¼Œé‚£ä¹ˆå°±å¯ä»¥çœ‹åˆ°<strong>synchronized</strong>åœ¨å®é™…çš„ä¼ä¸šå¼€å‘å½“ä¸­ä¹Ÿæ˜¯ä¸€ä¸ªæ£˜æ‰‹çš„é—®é¢˜ã€‚  </p><p><strong>ç¬¬ä¸‰</strong>ï¼š <strong>å¹¶å‘ç¼–ç¨‹</strong>ç°åœ¨æ˜¯ä¸€ä¸ªçƒ­ç‚¹é¢è¯•é¢˜ã€‚  </p><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">synchronized</span>å½“ä¸­å‡ºç°äº†å¼‚å¸¸ï¼Œä¼šä¸ä¼šé‡Šæ”¾é”ï¼Ÿ</span><br><span class="line"><span class="keyword">synchronized</span>å’ŒLockæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</span><br><span class="line"><span class="keyword">synchronized</span>å’Œ<span class="keyword">volatile</span>æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</span><br><span class="line">etc...</span><br></pre></td></tr></table></figure><p>é¢è¯•å®˜é€šè¿‡å¹¶å‘é¢è¯•é¢˜æ¥è€ƒæŸ¥é¢è¯•è€…çš„<strong>å¹¶å‘ç¼–ç¨‹</strong>æŒæ¡æƒ…å†µï¼Œ<br>æ¥åˆ¤æ–­é¢è¯•è€…æ˜¯å¦èƒ½å¤Ÿæ»¡è¶³ä¼ä¸šéœ€è¦ï¼Œ<br>å¦å¤–ä¹Ÿèƒ½å¤Ÿåˆ¤æ–­é¢è¯•è€…çš„æŠ€æœ¯æ°´å¹³ã€‚  </p><blockquote><p>è¯¾ç¨‹ä»‹ç»</p></blockquote><p>æ·±å…¥å­¦ä¹ <strong>å¹¶å‘ç¼–ç¨‹</strong>ä¸­çš„<strong>synchronized</strong></p><ul><li>ç¬¬ä¸€ç« ï¼š<strong>å¹¶å‘ç¼–ç¨‹</strong>ä¸­çš„<strong>ä¸‰ä¸ªé—®é¢˜</strong><ul><li><strong>å¯è§æ€§</strong><ul><li>æ¡ˆä¾‹ï¼š<ul><li><font style="color:red;">å…±äº«å˜é‡</font>;</li><li>ä¸€ä¸ª<font style="color:red;">çº¿ç¨‹A</font>ä¸æ–­åœ°æ¥<font style="color:red;">è¯»</font>è¿™ä¸ª<font style="color:red;">å…±äº«å˜é‡çš„å€¼</font>ï¼›</li><li>å†ç”¨å¦ä¸€ä¸ª<font style="color:red;">çº¿ç¨‹B</font>å¯¹è¯¥<font style="color:red;">å…±äº«å˜é‡çš„å–å€¼</font>è¿›è¡Œ<font style="color:red;">ä¿®æ”¹</font>ï¼›</li><li>å¯ä»¥è§‚æµ‹åˆ°å¦ä¸€ä¸ª<font style="color:red;">çº¿ç¨‹B</font>å¯¹è¯¥<font style="color:red;">å…±äº«å˜é‡çš„ä¿®æ”¹</font>ï¼›</li><li><font style="color:red;">Açº¿ç¨‹</font>å¹¶<font style="color:red;">ä¸èƒ½å¤Ÿæ„ŸçŸ¥å¾—åˆ°</font>ï¼›</li><li>è¿™å°±å‡ºç°äº†<strong>å¯è§æ€§</strong>é—®é¢˜</li></ul></li><li>ç›®æ ‡<ul><li>å­¦ä¹ ä»€ä¹ˆæ˜¯<strong>å¯è§æ€§</strong>é—®é¢˜</li></ul></li><li><strong>å¯è§æ€§</strong>æ¦‚å¿µ<ul><li><strong>å¯è§æ€§ï¼ˆVIsibilityï¼‰ï¼šæ˜¯æŒ‡å½“ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡è¿›è¡Œäº†ä¿®æ”¹ï¼Œé‚£ä¹ˆå¦å¤–çš„çº¿ç¨‹å¯ä»¥ç«‹å³çœ‹åˆ°ä¿®æ”¹åçš„æœ€æ–°å€¼ã€‚</strong></li></ul></li><li><strong>å¯è§æ€§</strong>æ¼”ç¤º<ul><li>æ¡ˆä¾‹æ¼”ç¤ºï¼š<ul><li>ä¸€ä¸ªAçº¿ç¨‹æ ¹æ®booleanç±»å‹çš„æ ‡è®°flagï¼›whileå¾ªç¯ï¼›</li><li>å¦ä¸€ä¸ªBçº¿ç¨‹æ”¹å˜è¿™ä¸ªflagå˜é‡çš„å€¼ï¼›</li><li>è€Œç¬¬ä¸€ä¸ªwhileå¾ªç¯çš„Açº¿ç¨‹å¹¶ä¸ä¼šåœæ­¢å¾ªç¯ã€‚</li></ul></li></ul></li><li>å°ç»“<ul><li>ä»€ä¹ˆæ˜¯<strong>å¯è§æ€§</strong>?<br><strong>å¯è§æ€§ï¼ˆVisibilityï¼‰ï¼šæ˜¯æŒ‡å½“ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡è¿›è¡Œäº†ä¿®æ”¹ï¼Œé‚£ä¹ˆå¦å¤–çš„çº¿ç¨‹å¯ä»¥ç†è§£çœ‹åˆ°ä¿®æ”¹åçš„æœ€æ–°å€¼</strong>ã€‚</li></ul></li></ul></li><li><strong>åŸå­æ€§</strong><ul><li>æ¡ˆä¾‹ï¼š<br>ä½¿ç”¨i++ï¼Œ<br>é€šè¿‡5ä¸ªçº¿ç¨‹åˆ†åˆ«æ¥è¿›è¡Œæ‰§è¡Œ1000æ¬¡i++ï¼Œ<br>æœ€ç»ˆå¯ä»¥å‘ç°åŠ å‡ºæ¥çš„æ•ˆæœå¹¶éæ˜¯5000ï¼Œ<br>å¯èƒ½ä¼šå°‘äº5000ï¼Œ<br>é‚£ä¹ˆè¿™ä¸ªé—®é¢˜çš„åŸå› å°±åœ¨äº<strong>i++</strong>å¹¶<strong>ä¸æ˜¯ä¸€ä¸ªåŸå­æ“ä½œ</strong>ï¼Œ<br>åˆ°æ—¶ä¼šé€šè¿‡<strong>javaåæ±‡ç¼–</strong>çš„æ–¹å¼æ¥è¿›è¡Œæ¼”ç¤ºåˆ†æè¿™ä¸ªi++å…¶å®æœ‰4æ¡æŒ‡ä»¤</li><li>ç›®æ ‡<ul><li>å­¦ä¹ ä»€ä¹ˆæ˜¯åŸå­æ€§é—®é¢˜</li></ul></li><li><strong>åŸå­æ€§</strong>æ¦‚å¿µ<ul><li><strong>åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼šæŒ‡åœ¨ä¸€æ¬¡æ“ä½œæˆ–å¤šæ¬¡æ“ä½œä¸­ï¼Œå‘€ä¹ˆæ‰€æœ‰çš„æ“ä½œå…¨éƒ¨å¾—åˆ°äº†æ‰§è¡Œå¹¶ä¸”ä¸ä¼šå—åˆ°ä»»ä½•å› ç´ çš„å¹²æ‰°è€Œä¸­æ–­ï¼Œè¦ä¹ˆæ‰€æœ‰çš„æ“ä½œéƒ½ä¸æ‰§è¡Œã€‚</strong></li></ul></li><li><strong>åŸå­æ€§</strong>æ¼”ç¤º<ul><li>æ¡ˆä¾‹æ¼”ç¤ºï¼š5ä¸ªçº¿ç¨‹å„æ‰§è¡Œ1000æ¬¡i++</li></ul></li></ul></li><li><strong>æœ‰åºæ€§</strong><ul><li>ä¸€èˆ¬æ¥æƒ³çš„æ˜¯ç¨‹åºä¼šæŒ‰ç…§<strong>ç¼–å†™çš„ä»£ç çš„é¡ºåº</strong>æ¥è¿›è¡Œæ‰§è¡Œï¼Œ<br>é‚£ä¹ˆå®é™…ä¸Š<strong>ç¨‹åº</strong>ä¼šå»åšä¸€äº›<strong>ä¼˜åŒ–æªæ–½</strong>ï¼Œ<br>ä¸ºäº†è®©ä»£ç çš„<strong>æ‰§è¡Œæ•ˆç‡æ›´é«˜</strong>ä¸€ç‚¹ï¼Œ<br>ä¼šåš<strong>ç¼–è¯‘å™¨å’Œè¿è¡ŒæœŸçš„ä¼˜åŒ–</strong>æ“ä½œï¼Œ<br>è¿™å…¶ä¸­ä¹Ÿæ˜¯ç”¨åˆ°äº†ä¸€ä¸ªæ¡ˆä¾‹ï¼Œ</li><li><em>æœ‰åºæ€§é—®é¢˜*</em>æœ‰å¯èƒ½ä¼šè¢«<strong>é‡æ’åº</strong>ï¼Œ<br>é‚£ä¹ˆå¯¼è‡´åœ¨<strong>å¤šçº¿ç¨‹</strong>çš„æƒ…å†µä¸‹ï¼Œ</li><li><em>æ•°æ®*</em>ä¼šå‡ºç°<strong>é”™ä¹±</strong>ã€‚</li><li>ç›®æ ‡<ul><li>å­¦ä¹ ä»€ä¹ˆæ˜¯<strong>æœ‰åºæ€§</strong>é—®é¢˜</li></ul></li><li><strong>æœ‰åºæ€§</strong>æ¦‚å¿µ<ul><li><strong>æœ‰åºæ€§ï¼ˆOrderingï¼‰: æ˜¯æŒ‡ç¨‹åºä»£ç åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­çš„å…ˆåé¡ºåºï¼Œç”±äºjavaåœ¨ç¼–è¯‘å™¨ä»¥åŠè¿è¡ŒæœŸçš„ä¼˜åŒ–ï¼Œå¯¼è‡´äº†ä»£ç çš„æ‰§è¡Œé¡ºåºæœªå¿…å°±æ˜¯å¼€å‘è€…ç¼–å†™ä»£ç æ—¶çš„é¡ºåºã€‚</strong></li></ul></li><li><strong>æœ‰åºæ€§</strong>æ¼”ç¤º<ul><li>jcstressæ˜¯javaå¹¶å‘å‹æµ‹å·¥å…·â€¦.</li></ul></li></ul></li></ul></li><li>ç¬¬äºŒç« ï¼š<strong>javaå†…å­˜æ¨¡å‹</strong>ï¼ˆ<strong>JMM</strong>ï¼‰ï¼ˆå¼€å§‹è§£å†³é—®é¢˜ï¼‰<ul><li><strong>è®¡ç®—æœºç»“æ„</strong><ul><li>ï¼ˆ<strong>CPU</strong>ã€<strong>å†…å­˜</strong>ã€<strong>ç¼“å­˜</strong>ç”±æ­¤æ¥å¼•å‡º<strong>javaå†…å­˜æ¨¡å‹</strong>ï¼Œ<strong>ä¸»å†…å­˜</strong>ã€<strong>å·¥ä½œå†…å­˜</strong>å¦‚ä½•<strong>æ“ä½œå˜é‡</strong>ï¼‰</li></ul></li><li><strong>javaå†…å­˜æ¨¡å‹</strong><ul><li><strong>ä¸»å†…å­˜</strong>ä¸<strong>å·¥ä½œå†…å­˜</strong>ä¹‹é—´çš„<strong>äº¤äº’</strong></li></ul></li></ul></li><li>ç¬¬ä¸‰ç« ï¼š<strong>synchronized</strong>ä¿è¯<strong>ä¸‰å¤§ç‰¹æ€§</strong><ul><li><strong>synchronized</strong>ä¸<strong>åŸå­æ€§</strong><ul><li>ç›®æ ‡</li><li>ä½¿ç”¨<strong>synchronized</strong>ä¿è¯<strong>åŸå­æ€§</strong></li><li><strong>synchronizedä¿è¯åŸå­æ€§çš„åŸç†</strong></li><li>å°ç»“</li></ul></li><li><strong>synchronized</strong>ä¸<strong>å¯è§æ€§</strong></li><li><strong>synchronized</strong>ä¸<strong>æœ‰åºæ€§</strong></li></ul></li><li>ç¬¬å››ç« ï¼š<strong>synchronized</strong>çš„<strong>ç‰¹æ€§</strong>ï¼ˆ<strong>åŒæ­¥é”æœºåˆ¶</strong>ï¼Œ<strong>synchronized</strong>ä½œä¸ºé”çš„ç‰¹æ€§ï¼‰<ul><li><strong>å¯é‡å…¥ç‰¹æ€§</strong><ul><li>æŒ‡çš„æ˜¯å½“ä¸€ä¸ªçº¿ç¨‹è¿›å…¥åˆ°ä¸€ä¸ªåŒæ­¥ä»£ç å—å½“ä¸­æ—¶ï¼Œ</li><li>è·å–äº†æŸä¸€ä¸ªé”ä¹‹åï¼Œ</li><li>è¿˜èƒ½å¤Ÿå†æ¬¡è¿›å…¥åŒæ­¥ä»£ç å—è·å–åŒä¸€æŠŠé”ã€‚</li><li>å³å¯ä»¥é‡æ–°å†è¿›å…¥ã€‚</li></ul></li><li><strong>ä¸å¯ä¸­æ–­ç‰¹æ€§</strong></li></ul></li><li>ç¬¬äº”ç« ï¼š<strong>synchronized</strong>çš„åŸç†<ul><li><strong>javap</strong> åæ±‡ç¼–</li><li>æ·±å…¥JVMæºç <ul><li>ç›®æ ‡</li><li><strong>monitorç›‘è§†å™¨é”</strong></li><li><strong>monitorç«äº‰</strong></li><li><strong>monitorç­‰å¾…</strong></li><li><strong>monitoré‡Šæ”¾</strong></li><li><strong>monitor</strong>æ˜¯<strong>é‡é‡çº§é”</strong></li></ul></li></ul></li><li>ç¬¬å…­ç« ï¼š<strong>JDK6 synchronizedä¼˜åŒ–</strong><ul><li><strong>CAS</strong></li><li><strong>javaå¯¹è±¡</strong>çš„<strong>å¸ƒå±€</strong><ul><li><strong>é”å‡çº§</strong>è¿‡ç¨‹</li></ul></li><li><strong>åå‘é”</strong></li><li><strong>è½»é‡çº§é”</strong></li><li><strong>é‡é‡çº§é”</strong></li><li><strong>é”æ¶ˆé™¤</strong></li><li><strong>é”ç²—åŒ–</strong></li><li>å¹³æ—¶å†™ä»£ç å¦‚ä½•å¯¹<strong>synchronizedä¼˜åŒ–</strong><ul><li><strong>å‡å°‘synchronizedçš„èŒƒå›´</strong></li><li><strong>é™ä½synchronizedé”çš„ç²’åº¦</strong></li><li><strong>è¯»å†™åˆ†ç¦»</strong></li></ul></li></ul></li></ul><h2 id="å¯è§æ€§é—®é¢˜"><a href="#å¯è§æ€§é—®é¢˜" class="headerlink" title="å¯è§æ€§é—®é¢˜"></a>å¯è§æ€§é—®é¢˜</h2><p>ç¬¬ä¸€ç« ï¼š<strong>å¹¶å‘ç¼–ç¨‹</strong>ä¸­çš„<strong>ä¸‰ä¸ªé—®é¢˜</strong> (å¯è§æ€§ã€åŸå­æ€§ã€æœ‰åºæ€§)</p><p>åœ¨ä½¿ç”¨<strong>å¤šçº¿ç¨‹</strong>è¿›è¡Œ<strong>å¹¶å‘ç¼–ç¨‹</strong>çš„æ—¶å€™ï¼Œå¦‚æœå­˜åœ¨æœ‰<strong>å¤šä¸ªçº¿ç¨‹</strong>æ¥<strong>æ“ä½œå…±äº«æ•°æ®</strong>ï¼Œ<br>é‚£ä¹ˆå¾ˆæœ‰å¯èƒ½è¿™ä¸ª<strong>å…±äº«æ•°æ®çš„å€¼</strong>ä¼šå‡ºç°<strong>é”™ä¹±</strong>ã€‚<br>é‚£ä¹ˆä»¥ä¸Šç§°ä¹‹ä¸º <strong>çº¿ç¨‹å®‰å…¨é—®é¢˜</strong>ã€‚<br>é‚£ä¹ˆå¯¼è‡´ <strong>çº¿ç¨‹å®‰å…¨é—®é¢˜</strong>çš„<strong>æ ¹æœ¬åŸå› </strong>æœ‰è¿™ä¸‰ç§ï¼š</p><ul><li><strong>å¯è§æ€§</strong></li><li><strong>åŸå­æ€§</strong></li><li><strong>æœ‰åºæ€§</strong></li></ul><p>åœ¨è®²è§£<strong>å¯è§æ€§</strong>æ¦‚å¿µä¹‹å‰ï¼Œè¦æ³¨æ„å‡ ä¸ª<strong>å‰ææ¡ä»¶</strong>ï¼š<br><strong>1ã€</strong>  å¦‚æœåªæœ‰ä¸€ä¸ªçº¿ç¨‹æ“ä½œï¼Œé‚£ä¹ˆå°±è‚¯å®šä¸ä¼šå­˜åœ¨çº¿ç¨‹ä¹‹é—´çš„<strong>å¯è§æ€§</strong>é—®é¢˜ã€‚<br><strong>2ã€</strong> è¿˜éœ€è¦å­˜åœ¨æœ‰<strong>å…±äº«æ•°æ®</strong>ï¼Œå¦‚æœæ²¡æœ‰å…±äº«æ•°æ®ï¼Œé‚£ä¹ˆä¹Ÿä¸ä¼šå­˜åœ¨æœ‰å¯è§æ€§é—®é¢˜ã€‚<br><strong>å¯è§æ€§ï¼ˆVisibilityï¼‰</strong>ï¼šæ˜¯æŒ‡ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡è¿›è¡Œä¿®æ”¹ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ç«‹å³å¾—åˆ°ä¿®æ”¹åçš„æœ€æ–°å€¼ã€‚</p><h3 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>å­¦ä¹ ä»€ä¹ˆæ˜¯<strong>å¯è§æ€§é—®é¢˜</strong></p><h3 id="å¯è§æ€§æ¦‚å¿µ"><a href="#å¯è§æ€§æ¦‚å¿µ" class="headerlink" title="å¯è§æ€§æ¦‚å¿µ"></a>å¯è§æ€§æ¦‚å¿µ</h3><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¯è§æ€§ï¼ˆ<span class="keyword">Visibility</span>ï¼‰ï¼šæ˜¯æŒ‡å½“ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡è¿›è¡Œäº†ä¿®æ”¹ï¼Œé‚£ä¹ˆå¦å¤–çš„çº¿ç¨‹å¯ä»¥ç«‹å³çœ‹åˆ°ä¿®æ”¹åçš„æœ€æ–°å€¼ã€‚</span><br></pre></td></tr></table></figure><h3 id="å¯è§æ€§æ¼”ç¤º"><a href="#å¯è§æ€§æ¼”ç¤º" class="headerlink" title="å¯è§æ€§æ¼”ç¤º"></a>å¯è§æ€§æ¼”ç¤º</h3><p>æ¡ˆä¾‹æ¼”ç¤ºï¼š<br>ä¸€ä¸ªçº¿ç¨‹Aæ ¹æ®booleanç±»å‹çš„æ ‡è®°flagï¼Œwhileå¾ªç¯ï¼›<br>å¦ä¸€ä¸ªçº¿ç¨‹Bæ”¹å˜è¿™ä¸ªflagå˜é‡çš„å€¼ï¼›<br>é‚£ä¹ˆçº¿ç¨‹Aå¹¶ä¸ä¼šåœæ­¢å¾ªç¯ã€‚</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">package com.xxx.concurrent_problem;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  æ¡ˆä¾‹æ¼”ç¤ºï¼š</span></span><br><span class="line"><span class="comment">          ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸èƒ½ç«‹å³å¾—åˆ°æœ€æ–°å€¼</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test01Visibility</span>&#123;</span></span><br><span class="line">    <span class="comment">//å¤šä¸ªçº¿ç¨‹éƒ½ä¼šè®¿é—®çš„æ•°æ®ï¼Œæˆ‘ä»¬æˆä¸ºçº¿ç¨‹çš„å…±äº«æ•°æ®</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="built_in">run</span> = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(<span class="keyword">String</span>[] args)</span> throws InterruptedException</span>&#123;</span><br><span class="line">      <span class="comment">//t1çº¿ç¨‹ä¸æ–­çš„æ¥è¯»å–runå…±äº«å˜é‡çš„å–å€¼</span></span><br><span class="line">      Thread t1 = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">run</span>)&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">      t1.start();</span><br><span class="line"></span><br><span class="line">      Thread.sleep(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">      <span class="comment">//t2çº¿ç¨‹å¯¹è¯¥å…±äº«å˜é‡çš„å–å€¼è¿›è¡Œä¿®æ”¹</span></span><br><span class="line">      Thread t2 = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">        <span class="built_in">run</span> =  <span class="literal">false</span>;</span><br><span class="line">        System.out.<span class="built_in">println</span>(<span class="string">"æ—¶é—´åˆ°ï¼Œçº¿å±‚2è®¾ç½®ä¸ºfalse"</span>);</span><br><span class="line">      &#125;);</span><br><span class="line">      t2.start();</span><br><span class="line"></span><br><span class="line">      <span class="comment">//å¯ä»¥è§‚æµ‹å¾—åˆ°t2çº¿ç¨‹å¯¹runå…±äº«å˜é‡çš„ä¿®æ”¹ï¼Œt1çº¿ç¨‹å¹¶ä¸èƒ½å¤Ÿè¯»å–åˆ°æ›´æ”¹äº†ä¹‹åçš„å€¼ï¼›</span></span><br><span class="line">      <span class="comment">//è¿™å°±å‡ºç°äº†å¯è§æ€§é—®é¢˜</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xxx.demo01_concurrent_problem;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  ç›®æ ‡ï¼šæ¼”ç¤ºå¯è§æ€§é—®é¢˜</span></span><br><span class="line"><span class="comment">    1. åˆ›å»ºä¸€ä¸ªå…±äº«å˜é‡</span></span><br><span class="line"><span class="comment">    2. åˆ›å»ºä¸€æ¡çº¿ç¨‹ä¸æ–­è¯»å–å…±äº«å˜é‡</span></span><br><span class="line"><span class="comment">    3. åˆ›å»ºä¸€æ¡çº¿ç¨‹ä¿®æ”¹å…±äº«å˜é‡</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> Test01Visibility&#123;</span><br><span class="line">  <span class="comment">// 1. åˆ›å»ºä¸€ä¸ªå…±äº«å˜é‡ï¼›é™æ€çš„æˆå‘˜å˜é‡ï¼›booleanç±»å‹åä¸ºflagï¼›</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> flag = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String[] args)&#123;</span><br><span class="line">    <span class="comment">/* 2. åˆ›å»ºä¸€æ¡çº¿ç¨‹ä¸æ–­è¯»å–å…±äº«å˜é‡</span></span><br><span class="line"><span class="comment">          é‡‡ç”¨lambdaè¡¨è¾¾å¼çš„æ–¹å¼è¿›è¡Œåˆ›å»ºçº¿ç¨‹</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">new</span> Thread(()-&gt;&#123;</span><br><span class="line">      <span class="keyword">while</span>(flag)&#123;</span><br><span class="line">        <span class="comment">/* å¾ªç¯ï¼Œå¦‚æœè¯¥å¸ƒå°”ç±»å‹å˜é‡çš„å€¼ä¸ºtrueåˆ™ä¸€ç›´å¾ªç¯å¦åˆ™ç»“æŸå¾ªç¯ï¼›</span></span><br><span class="line"><span class="comment">           åœ¨å¾ªç¯å½“ä¸­åƒä¸‡ä¸è¦è¿›è¡Œæ‰“å°ï¼Œæ‰“å°äº†çš„è¯å°±çœ‹ä¸åˆ°æ•ˆæœäº†</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;).start();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    æ²‰ç¡ä¸¤ç§’é’Ÿï¼›</span></span><br><span class="line"><span class="comment">    è®©æ•ˆæœæ›´åŠ æ˜æ˜¾ï¼›</span></span><br><span class="line"><span class="comment">    è¿™æ ·åˆ™æ›´åŠ æ˜æ˜¾çš„æ¥åˆ†æé—®é¢˜</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    Thread.sleep(<span class="number">2000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 3. åˆ›å»ºä¸€æ¡çº¿ç¨‹ä¿®æ”¹å…±äº«å˜é‡</span></span><br><span class="line"><span class="comment">       æ”¾åˆ°lambdaè¡¨è¾¾å¼ä¸­</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">new</span> Thread(()-&gt;&#123;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// å°†flagæ”¹ä¸ºfalseï¼›å¹¶ä¸”è¾“å‡ºæ‰“å°ï¼›</span></span><br><span class="line">      flag = <span class="keyword">false</span>;</span><br><span class="line">      System.out.<span class="keyword">println</span>(<span class="string">"çº¿ç¨‹ä¿®æ”¹äº†å˜é‡çš„å€¼ä¸ºfalse"</span>);</span><br><span class="line">    &#125;).start();</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">  åˆ†æä¸€ä¸‹è¿™æ®µä»£ç ï¼š</span></span><br><span class="line"><span class="comment">  ç¨‹åºä»mainæ–¹æ³•å¼€å§‹æ‰§è¡Œï¼›</span></span><br><span class="line"><span class="comment">  å¼€å¯äº†çº¿ç¨‹Aä¸æ–­è¯»å–å…±äº«å˜é‡çš„å–å€¼è¿›è¡Œå¾ªç¯ï¼›</span></span><br><span class="line"><span class="comment">  å¼€å¯äº†çº¿ç¨‹Bå»è¿›è¡Œä¿®æ”¹å…±äº«å˜é‡çš„å€¼å¹¶æ‰“å°ï¼›</span></span><br><span class="line"><span class="comment">  </span></span><br><span class="line"><span class="comment">  å¤šçº¿ç¨‹æ‰§è¡Œå…·æœ‰ fu jin/fu ji(æˆ‘æ²¡å¬æ¸…)æ€§ï¼Œ</span></span><br><span class="line"><span class="comment">  æœ‰å¯èƒ½å…ˆè¿›è¡Œè·‘Açº¿ç¨‹ä¹Ÿæœ‰å¯èƒ½è·‘Bçº¿ç¨‹ï¼›</span></span><br><span class="line"><span class="comment">  å¦‚æœå…ˆè·‘Bçº¿ç¨‹é‚£ä¹ˆåˆ™çœ‹ä¸åˆ°Açº¿ç¨‹å½“ä¸­çš„å¾ªç¯ï¼›</span></span><br><span class="line"><span class="comment">  ä¸ºäº†è®©è¿™ä¸ªæ•ˆæœæ›´ä½³æ˜æ˜¾ä¸€ç‚¹ï¼›</span></span><br><span class="line"><span class="comment">  æ‰€ä»¥ååŠ äº†ä¸€ä¸ªThread.sleep(2000);</span></span><br><span class="line"><span class="comment">  </span></span><br><span class="line"><span class="comment">  é¦–å…ˆæ‰§è¡Œmainæ–¹æ³•çš„æ—¶å€™ï¼›</span></span><br><span class="line"><span class="comment">  ä¼šåˆ›å»ºå‡ºä¸€ä¸ªçº¿ç¨‹Aï¼›</span></span><br><span class="line"><span class="comment">  è¿™ä¸ªçº¿ç¨‹Aä¼šæ¥è¿›è¡Œè¯»å–å…±äº«å˜é‡Açš„å–å€¼ï¼›</span></span><br><span class="line"><span class="comment">  åˆ™è¯»å–åˆ°flagå…±äº«å˜é‡çš„å–å€¼ä¸ºtrueï¼›</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆè¯¥whileå¾ªç¯åˆ™å°†ä¼šä¸€ç›´è¿›è¡Œå¾ªç¯ï¼›</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆå½“ä¸»çº¿ç¨‹æ²‰ç¡äº†ä¸¤ç§’ä¹‹åï¼Œåˆä¼šå¯åŠ¨ä¸€ä¸ªæ–°çº¿ç¨‹Bï¼›</span></span><br><span class="line"><span class="comment">  æ–°çº¿ç¨‹Bå°†flagå…±äº«å˜é‡çš„å–å€¼å˜ä¸ºäº†falseï¼›</span></span><br><span class="line"><span class="comment">  </span></span><br><span class="line"><span class="comment">  é—®é¢˜å°±åœ¨äºåˆ†æ</span></span><br><span class="line"><span class="comment">  çº¿ç¨‹Aå½“ä¸­é€šè¿‡flagæ¥è¿›è¡Œwhileå¾ªç¯å½“ä¸­çš„è¯¥flagå…±äº«å˜é‡</span></span><br><span class="line"><span class="comment">  æ˜¯å¦ä¹Ÿä»ä¸€å¼€å§‹çš„å–å€¼trueåˆ°åæœŸçš„çº¿ç¨‹Bå½“ä¸­å¯¹å…±äº«å˜é‡flagå–å€¼è¿›è¡Œä¿®æ”¹ä¸ºfalse</span></span><br><span class="line"><span class="comment">  æ˜¯å¦ä¹Ÿæ˜¯åŒæ—¶è¿›è¡Œäº†æ›´æ”¹å–å€¼trueä¸ºfalseï¼›</span></span><br><span class="line"><span class="comment">  å¦‚æœçº¿ç¨‹Aå½“ä¸­çš„å…±äº«å˜é‡flagçš„å–å€¼ä¸çº¿ç¨‹Bæ“ä½œå…±äº«å˜é‡flagçš„å–å€¼åŒæ—¶è¿›è¡Œäº†æ›´æ”¹ï¼›</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆçº¿ç¨‹Aå½“ä¸­æ ¹æ®flagå–å€¼è¿›è¡Œwhileå¾ªç¯çš„å¾ªç¯æ“ä½œå°±ä¼šåœä¸‹æ¥ï¼›</span></span><br><span class="line"><span class="comment">  å¦‚æœæ²¡æœ‰è¿›è¡Œä¿®æ”¹çº¿ç¨‹Aå½“ä¸­çš„flagå…±äº«å˜é‡</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆçº¿ç¨‹Aå½“ä¸­çš„flagå…±äº«å˜é‡çš„å–å€¼å°±å°†è¿˜ä¼šæ˜¯trueï¼Œ</span></span><br><span class="line"><span class="comment">  å³whileå¾ªç¯æ ¹æ®flagå…±äº«å˜é‡çš„å–å€¼trueç»§ç»­å…¶å¾ªç¯æ“ä½œï¼›</span></span><br><span class="line"><span class="comment">  </span></span><br><span class="line"><span class="comment">  æ•ˆæœï¼š</span></span><br><span class="line"><span class="comment">  ç­‰å¾…ä¸¤ç§’ä¹‹åï¼Œè¾“å‡ºäº†çº¿ç¨‹Bå½“ä¸­çš„æ‰“å° â€œçº¿ç¨‹ä¿®æ”¹äº†å˜é‡çš„å€¼ä¸ºfalseâ€ï¼›</span></span><br><span class="line"><span class="comment">  ç„¶è€Œä½†æ˜¯è¿è¡ŒRunçš„çš„çº¢ç¯ä»ç„¶å¼€å¯æ˜¾ç¤ºåœ¨è¿è¡Œç€ï¼›</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆè¿™ä¸ªå°±æ„å‘³ç€ï¼›</span></span><br><span class="line"><span class="comment">  ä¸Šé¢çš„é‚£ä¸ªçº¿ç¨‹Aè¿˜åœ¨while(true)æ‰§è¡Œå½“ä¸­ï¼›</span></span><br><span class="line"><span class="comment">  ä¹Ÿå°±æ˜¯çº¿ç¨‹Aå½“ä¸­çš„å…±äº«å˜é‡</span></span><br><span class="line"><span class="comment">  æ²¡æœ‰å—åˆ°çº¿ç¨‹Bå½“ä¸­æ“ä½œå…±äº«å˜é‡flagå–å€¼ä»trueå˜ä¸ºfalseæ“ä½œçš„å½±å“ï¼›</span></span><br><span class="line"><span class="comment">  flagåœ¨çº¿ç¨‹Aå½“ä¸­å–å€¼ä¾ç„¶è¿˜æ˜¯trueï¼›</span></span><br><span class="line"><span class="comment">  æ‰€ä»¥whileå¾ªç¯æ ¹æ®è¯¥flagå…±äº«å˜é‡çš„å–å€¼ä¾æ—§åœ¨è¿›è¡Œç€å¾ªç¯æ“ä½œã€‚</span></span><br><span class="line"><span class="comment">  å³çº¿ç¨‹Aå½“ä¸­è®¤ä¸ºflagå…±äº«å˜é‡ä¾æ—§æ˜¯trueï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰å»è¿›è¡Œåœæ­¢whileå¾ªç¯ã€‚</span></span><br><span class="line"><span class="comment">  </span></span><br><span class="line"><span class="comment">  è¿™ä¸ªæ—¶å€™å°±å¯ä»¥è¿›è¡Œè§‚å¯Ÿå¾—åˆ° å¯è§æ€§é—®é¢˜ï¼›</span></span><br><span class="line"><span class="comment">  ä¸‹é¢çš„çº¿ç¨‹Bå¯¹å…±äº«å˜é‡flagå–å€¼çš„ä¿®æ”¹ï¼Œè€Œä¸Šé¢çš„çº¿ç¨‹Aå¹¶æ²¡æœ‰ç«‹å³å¾—åˆ°æœ€æ–°çš„ç»“æœï¼›</span></span><br><span class="line"><span class="comment">  </span></span><br><span class="line"><span class="comment">  æœ€ååšä¸ªå°ç»“ï¼š</span></span><br><span class="line"><span class="comment">  å½“å¹¶å‘ç¼–ç¨‹æ—¶ï¼Œå¦‚æœæœ‰å¤šçº¿ç¨‹æ¥è¿›è¡Œæ“ä½œå…±äº«å˜é‡ï¼›</span></span><br><span class="line"><span class="comment">  ä¸€ä¸ªçº¿ç¨‹æ¥è¿›è¡Œè¯»å–æ“ä½œï¼›</span></span><br><span class="line"><span class="comment">  ä¸€ä¸ªçº¿ç¨‹æ¥è¿›è¡Œå†™æ“ä½œï¼›</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆè¿™ä¸ªå½“ä¸­å°±å¯èƒ½ä¼šå‡ºç° çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼›</span></span><br><span class="line"><span class="comment">  å³ä¸€ä¸ªçº¿ç¨‹Bè¿›è¡Œä¿®æ”¹ï¼Œè€Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹Aå¹¶æ²¡æœ‰å¾—åˆ°ä¿®æ”¹åçš„æœ€æ–°å–å€¼ï¼›</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>ä»€ä¹ˆæ˜¯<strong>å¯è§æ€§</strong>ï¼Ÿ</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¯è§æ€§ï¼ˆ<span class="keyword">Visibility</span>ï¼‰ï¼šæ˜¯æŒ‡å½“ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡è¿›è¡Œäº†ä¿®æ”¹ï¼Œé‚£ä¹ˆå¦å¤–çš„çº¿ç¨‹å¯ä»¥ç«‹å³çœ‹åˆ°ä¿®æ”¹åçš„æœ€æ–°å€¼ã€‚</span><br></pre></td></tr></table></figure><h2 id="åŸå­æ€§é—®é¢˜"><a href="#åŸå­æ€§é—®é¢˜" class="headerlink" title="åŸå­æ€§é—®é¢˜"></a>åŸå­æ€§é—®é¢˜</h2><p>ç°åœ¨æ¥çœ‹å¹¶å‘ç¼–ç¨‹ä¸­çš„ç¬¬äºŒä¸ªé—®é¢˜ï¼š<strong>åŸå­æ€§</strong>é—®é¢˜ï¼›<br>å‰æœŸè®²çš„æ˜¯å¹¶å‘ç¼–ç¨‹ä¸­çš„ç¬¬ä¸€ä¸ªé—®é¢˜<strong>å¯è§æ€§</strong>é—®é¢˜ï¼›<br>åæœŸè¦è®²çš„æ˜¯å¹¶å‘ç¼–ç¨‹ä¸­çš„ç¬¬ä¸‰ä¸ªé—®é¢˜<strong>æœ‰åºæ€§</strong>é—®é¢˜ï¼›<br>å­¦ä¹ åˆ†ä¸¤æ­¥ç¬¬ä¸€æ­¥ä»‹ç»<strong>åŸå­æ€§çš„æ¦‚å¿µ</strong>ï¼›<br>ç¬¬äºŒæ­¥é€šè¿‡ä¸€ä¸ªæ¡ˆä¾‹æ¥è¿›è¡Œæ¼”ç¤º<strong>åŸå­æ€§é—®é¢˜</strong>ï¼›</p><h3 id="ç›®æ ‡-1"><a href="#ç›®æ ‡-1" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>å­¦ä¹ ä»€ä¹ˆæ˜¯<strong>åŸå­æ€§é—®é¢˜</strong></p><h3 id="åŸå­æ€§æ¦‚å¿µ"><a href="#åŸå­æ€§æ¦‚å¿µ" class="headerlink" title="åŸå­æ€§æ¦‚å¿µ"></a>åŸå­æ€§æ¦‚å¿µ</h3><p>åŸå­æ€§çš„å‰æï¼š</p><p><strong>1.</strong> éœ€è¦å­˜åœ¨æœ‰<strong>å¤šä¸ªçº¿ç¨‹</strong>ï¼›å¦‚æœæ˜¯ä¸€ä¸ªçº¿ç¨‹ï¼Œæ²¡æœ‰ç«äº‰çš„è¿™ç§æƒ…å†µæ˜¯çœ‹ä¸å‡ºæ¥é—®é¢˜æ‰€åœ¨çš„ï¼›<br><strong>2.</strong> ä¾ç„¶è¿˜æ˜¯éœ€è¦å­˜åœ¨<strong>å…±äº«å˜é‡</strong>ï¼›å³åˆ°æ—¶å€™å¤šä¸ªçº¿ç¨‹æ¥å¯¹å…±äº«å˜é‡æ¥è¿›è¡Œæ“ä½œï¼›</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">åŸå­æ€§ï¼ˆAtomicityï¼‰: åœ¨ä¸€æ¬¡æˆ–å¤šæ¬¡æ“ä½œä¸­ï¼Œè¦ä¹ˆæ‰€æœ‰çš„æ“ä½œéƒ½æ‰§è¡Œ å¹¶ä¸” ä¸ä¼šå— å…¶ä»–å› ç´ å¹²æ‰° è€Œ ä¸­æ–­ï¼Œè¦ä¹ˆæ‰€æœ‰çš„æ“ä½œéƒ½ä¸æ‰§è¡Œï¼›</span></span><br></pre></td></tr></table></figure><h3 id="åŸå­æ€§æ¼”ç¤º"><a href="#åŸå­æ€§æ¼”ç¤º" class="headerlink" title="åŸå­æ€§æ¼”ç¤º"></a>åŸå­æ€§æ¼”ç¤º</h3><p>æ¡ˆä¾‹æ¼”ç¤ºï¼š5ä¸ªçº¿ç¨‹å„æ‰§è¡Œ1000æ¬¡i++</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xxx.demo01_concurrent_problem;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    æ¡ˆä¾‹æ¼”ç¤ºï¼š5ä¸ªçº¿ç¨‹å„æ‰§è¡Œ1000æ¬¡ i++;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> class Test02Atomicity&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">int</span> number = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="keyword">String</span>[] args) <span class="keyword">throws</span> InterruptedException&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5ä¸ªçº¿ç¨‹éƒ½æ‰§è¡Œ1000æ¬¡i++</span></span><br><span class="line">    Runnable increment = () -&gt; &#123;</span><br><span class="line">      <span class="keyword">for</span>( <span class="built_in">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">1000</span>; i++)&#123;</span><br><span class="line">        number++;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5ä¸ªçº¿ç¨‹</span></span><br><span class="line">    ArrayList&lt;Thread&gt; ts = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span> ; i++)&#123;</span><br><span class="line">      Thread t = <span class="keyword">new</span> Thread(increment);</span><br><span class="line">      t.start();</span><br><span class="line">      ts.<span class="built_in">add</span>(t);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(Thread t : ts)&#123;</span><br><span class="line">      t.<span class="built_in">join</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* æœ€ç»ˆçš„æ•ˆæœå³ï¼ŒåŠ å‡ºæ¥çš„æ•ˆæœä¸æ˜¯5000ï¼Œå¯èƒ½ä¼šå°‘äº5000</span></span><br><span class="line"><span class="comment">        é‚£ä¹ˆåŸå› å°±åœ¨äºi++å¹¶ä¸æ˜¯ä¸€ä¸ªåŸå­æ“ä½œ</span></span><br><span class="line"><span class="comment">        åˆ°æ—¶å€™ä¼šé€šè¿‡javaåæ±‡ç¼–çš„æ–¹å¼æ¥è¿›è¡Œæ¼”ç¤ºå’Œåˆ†æï¼Œè¿™ä¸ªi++å…¶å®æœ‰4æ¡æŒ‡ä»¤</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    System.out.<span class="built_in">println</span>(<span class="string">"number = "</span>+ number);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">package com.xxx.demo01_concurrent_problem;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  ç›®æ ‡ï¼šæ¼”ç¤ºåŸå­æ€§é—®é¢˜</span></span><br><span class="line"><span class="comment">      1. å®šä¹‰ä¸€ä¸ªå…±äº«å˜é‡ number</span></span><br><span class="line"><span class="comment">      2. å¯¹numberè¿›è¡Œ 1000æ¬¡çš„++æ“ä½œ</span></span><br><span class="line"><span class="comment">      3. ä½¿ç”¨5ä¸ªçº¿ç¨‹æ¥è¿›è¡Œæ“ä½œ</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02Atomicity</span>&#123;</span></span><br><span class="line">  <span class="comment">// 1. å®šä¹‰ä¸€ä¸ªå…±äº«å˜é‡ numberï¼›å…ˆèµ‹å€¼ä¸º0</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> number = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(<span class="keyword">String</span>[] args)</span> throws InterruptedException</span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* å­˜åœ¨æœ‰5ä¸ªçº¿ç¨‹éœ€è¦æ¥å¯¹numberå…±äº«å˜é‡1000æ¬¡çš„++æ“ä½œ</span></span><br><span class="line"><span class="comment">     2. å¯¹numberè¿›è¡Œ1000çš„++æ“ä½œ</span></span><br><span class="line"><span class="comment">     åšä»»åŠ¡ï¼›ä½¿ç”¨lambdaè¡¨è¾¾å¼æ¥è¿›è¡Œç¼–å†™</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  Runnable increment = () -&gt; &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt; <span class="number">1000</span>; i++)&#123;</span><br><span class="line">      number++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  List&lt;Thread&gt; ts = <span class="keyword">new</span> ArrayList&lt;Thread&gt;();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3. ä½¿ç”¨5ä¸ªçº¿ç¨‹æ¥è¿›è¡Œ</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i&lt; <span class="number">5</span>;i++)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¯¥5ä¸ªçº¿ç¨‹æ‰€åšçš„äº‹æƒ…å³ä¸º ä¸Šé¢çš„incrementæ‰€å®ç°çš„run()</span></span><br><span class="line">    Thread t = <span class="keyword">new</span> Thread(increment);</span><br><span class="line">    t.start();</span><br><span class="line"></span><br><span class="line">    ts.add(t);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(Thread t : <span class="built_in">list</span>)&#123;</span><br><span class="line">      t.join();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰“å°numberçš„å–å€¼</span></span><br><span class="line">    System.out.<span class="built_in">println</span>(<span class="string">"number = "</span>+ number);</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    ç”±äºæœ‰å¯èƒ½å­˜åœ¨ ä¸»çº¿ç¨‹è·‘å¾—æ›´å¿«ï¼›</span></span><br><span class="line"><span class="comment">    æ‰€ä»¥å°±æœ‰å¯èƒ½å‡ºç°5ä¸ªçº¿ç¨‹å…¶run()å½“ä¸­çš„forå¾ªç¯æ²¡æœ‰è·‘å®Œå°±æœ‰å¯èƒ½å»æ‰§è¡Œè¾“å‡ºnumberçš„å–å€¼äº†ï¼›</span></span><br><span class="line"><span class="comment">    ä¸ºäº†ä¸€å®šè¦è®©5ä¸ªçº¿ç¨‹å½“ä¸­çš„forå¾ªç¯è·‘å®Œç„¶åå†æ¥å–numberçš„å–å€¼ï¼›</span></span><br><span class="line"><span class="comment">    è¿™ä¸ªæ—¶å€™ä½¿ç”¨joinçš„æ“ä½œï¼›</span></span><br><span class="line"><span class="comment">    å…ˆæŠŠè¿™ä¸ª5ä¸ªçº¿ç¨‹æ”¾ç½®åˆ°ArrayListé›†åˆtså½“ä¸­ï¼›</span></span><br><span class="line"><span class="comment">    æœ€ååœ¨æ‰“å°ä¹‹å‰éå†ä¸€ä¸‹listé›†åˆtsï¼›</span></span><br><span class="line"><span class="comment">    å¾—åˆ°æ¯ä¸ªçº¿ç¨‹è®©å…¶æ‰§è¡Œjoin();</span></span><br><span class="line"><span class="comment">    æŒ‰ç…§åˆ†æï¼›æ¯ä¸ªçº¿ç¨‹éƒ½æ‰§è¡Œ1000æ¬¡number++ï¼›</span></span><br><span class="line"><span class="comment">    æ­£å¸¸æ¥è¯´æœ€åè¾“å‡ºæ‰“å°è¿™ä¸ªnumberæ—¶çš„æ‰“å°ç»“æœåº”å½“ä¸º5000ï¼›</span></span><br><span class="line"><span class="comment">    é‚£ä¹ˆè¿™ä¸ªè¿è¡Œç»“æœæœ‰å¯èƒ½æ˜¯5000ä¹Ÿæœ‰å¯èƒ½ä¼šå°äº5000ï¼›</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    æ•ˆæœï¼š</span></span><br><span class="line"><span class="comment">    number = 5000</span></span><br><span class="line"><span class="comment">    å¤šè¿è¡Œå‡ æ¬¡</span></span><br><span class="line"><span class="comment">    number = 4542ï¼ˆè¿™æ¬¡è¿è¡Œä¹‹åå°±ä¼šå‘ç°numberçš„å–å€¼å°‘äº†å¾ˆå¤šï¼‰</span></span><br><span class="line"><span class="comment">    é‚£ä¹ˆä¸ºä»€ä¹ˆä¼šå‡ºç°numberå–å€¼å°‘äº†å¾ˆå¤šçš„è¿™ç§æƒ…å†µå‘¢ï¼Ÿ</span></span><br><span class="line"><span class="comment">    é‚£ä¹ˆè¿™æ˜¯ç”±äº i++ï¼ˆnumber++ï¼‰è¿™æ˜¯å¤šä¸ªæ“ä½œï¼›</span></span><br><span class="line"><span class="comment">    è€Œä¸”å…¶æ˜¯é€šè¿‡å¤šçº¿ç¨‹æ¥è¿›è¡Œæ“ä½œçš„ï¼›</span></span><br><span class="line"><span class="comment">    å¹¶æ²¡æœ‰æ¥è¿›è¡Œä¿è¯ i++(number++)è¿™ä¸ªæ“ä½œçš„ä¸€ä¸ªåŸå­æ€§ï¼›</span></span><br><span class="line"><span class="comment">    é‚£ä¹ˆè¿™ä¸ªæ—¶å€™é€šè¿‡javapåæ±‡ç¼–çš„æ–¹å¼æ¥æŸ¥çœ‹i++(number++)åˆ°åº•æ˜¯ç”±å‡ ä¸ªéƒ¨åˆ†æ¥ç»„æˆçš„ï¼›</span></span><br><span class="line"><span class="comment">    æ‰¾åˆ°ç¼–è¯‘åçš„ç»“æœï¼ˆå·¥ç¨‹å/target/classes/com.xxx.demo01_concurrent_problem/Test02Atomicity.classï¼‰</span></span><br><span class="line"><span class="comment">    æ‰¾åˆ°è¯¥æ–‡ä»¶ä¹‹åé€šè¿‡ä½¿ç”¨Windows PowerShellæ‰“å¼€æˆ–è€…æ˜¯é€šè¿‡CMDç­‰å‘½ä»¤è¡Œè¿›è¡Œæ‰“å¼€ä¹Ÿå¯ä»¥ï¼›</span></span><br><span class="line"><span class="comment">    é”®å…¥å‘½ä»¤ï¼šjavap å¯ä»¥å¯¹è¯¥å­—èŠ‚ç æ–‡ä»¶Test02Atomicity.classè¿›è¡Œåæ±‡ç¼–ï¼›</span></span><br><span class="line"><span class="comment">    ä»è€Œçœ‹åˆ°ä¸€äº›å­—èŠ‚ç çš„æŒ‡ä»¤ï¼›</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    javap -p -v .\Test02Atomicity.class</span></span><br><span class="line"><span class="comment">    # -p å³æ˜¾ç¤ºç§æœ‰çš„ï¼›-v å³è¯¦ç»†ä¿¡æ¯ä¹Ÿæ˜¾ç¤ºå‡ºæ¥ï¼›</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    é€šè¿‡åæ±‡ç¼–ä¹‹åå¯ä»¥çœ‹åˆ°å¾ˆå¤šçš„ä»£ç ï¼›</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<strong>javap åæ±‡ç¼–</strong>classæ–‡ä»¶ï¼Œå¾—åˆ°ä¸‹é¢çš„ å­—èŠ‚ç æŒ‡ä»¤ï¼š</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> static <span class="built_in">void</span> lambda$main();</span><br><span class="line">  Code:</span><br><span class="line">     <span class="number">0</span>: iconst_0</span><br><span class="line">     <span class="number">1</span>: istore_0</span><br><span class="line">     <span class="number">2</span>: iload_0</span><br><span class="line">     <span class="number">3</span>: sipush        <span class="number">1000</span></span><br><span class="line">     <span class="number">6</span>: if_           <span class="number">23</span></span><br><span class="line">     <span class="number">9</span>: getstatic     #<span class="number">12</span>               <span class="comment">// Field number:I</span></span><br><span class="line">    <span class="number">12</span>: iconst_1</span><br><span class="line">    <span class="number">13</span>: iadd</span><br><span class="line">    <span class="number">14</span>: putstatic     #<span class="number">12</span>               <span class="comment">// Field number:I</span></span><br><span class="line">    <span class="number">17</span>: linc          <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="number">20</span>: goto</span><br><span class="line">    <span class="number">23</span>: <span class="keyword">return</span></span><br></pre></td></tr></table></figure><p><strong>åæ±‡ç¼–</strong>å†…å®¹ï¼š</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">    offset_delta = <span class="number">27</span></span><br><span class="line">  Exception:</span><br><span class="line">    throws java.lang.InterruptedException</span><br><span class="line"></span><br><span class="line"># é€šè¿‡åæ±‡ç¼–å¯ä»¥çœ‹åˆ°lambdaè¡¨è¾¾å¼çš„ä»£ç åœ¨æ­¤å¤„</span><br><span class="line"><span class="keyword">private</span> static <span class="built_in">void</span> lambda$main$<span class="number">0</span>()</span><br><span class="line">  descriptor: ()V</span><br><span class="line">  flags: ACC_PRIVATE, ACC_STATIC, ACC_SYNTHETIC</span><br><span class="line">  Code:</span><br><span class="line">    stack=<span class="number">2</span>, loclas=<span class="number">1</span>, args_size=<span class="number">0</span></span><br><span class="line">        <span class="number">0</span>: iconst_0</span><br><span class="line">        <span class="number">1</span>: istore_0</span><br><span class="line">        <span class="number">2</span>: iload_0</span><br><span class="line">        <span class="number">3</span>: sipush       <span class="number">1000</span></span><br><span class="line">        <span class="number">6</span>: if_icmpge    <span class="number">23</span></span><br><span class="line">        <span class="number">9</span>: getstatic    #<span class="number">18</span>         <span class="comment">// Field number:I</span></span><br><span class="line">       <span class="number">12</span>: iconst_1</span><br><span class="line">       <span class="number">13</span>: iadd</span><br><span class="line">       <span class="number">14</span>: putstatic    #<span class="number">18</span>         <span class="comment">// Field number:I</span></span><br><span class="line">       <span class="number">17</span>: iinc         <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">       <span class="number">20</span>: goto</span><br><span class="line">       <span class="number">23</span>: <span class="keyword">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">18</span>: <span class="number">0</span></span><br><span class="line">        line <span class="number">19</span>: <span class="number">9</span></span><br><span class="line">        line <span class="number">18</span>: <span class="number">17</span></span><br><span class="line">        line <span class="number">21</span>: <span class="number">23</span></span><br><span class="line">      LocalVariableTable:</span><br><span class="line">        Start  Length   Slot   Name   Signature</span><br><span class="line">            <span class="number">2</span>      <span class="number">21</span>      <span class="number">0</span>      <span class="number">1</span>   I</span><br><span class="line">      StackMapTable: number_of_entries = <span class="number">2</span></span><br><span class="line">        frame_type = <span class="number">252</span> <span class="comment">/* append */</span></span><br><span class="line">          offset_delta = <span class="number">2</span></span><br><span class="line">          locals = [ <span class="built_in">int</span> ]</span><br><span class="line">        frame_type = <span class="number">250</span> <span class="comment">/* chop */</span></span><br><span class="line">          offset_delta = <span class="number">20</span></span><br><span class="line">  static &#123;&#125;:</span><br><span class="line">    descriptor: ()V</span><br><span class="line">    flags: ACC_STATIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">1</span>,  locals=<span class="number">0</span>, args_size=<span class="number">0</span></span><br><span class="line">          <span class="number">0</span>: iconst_0</span><br><span class="line">          <span class="number">1</span>: putstatic  #<span class="number">18</span>         <span class="comment">// Field number:I</span></span><br><span class="line">          <span class="number">4</span>: <span class="keyword">return</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œå¯¹äº number++ è€Œè¨€ï¼ˆnumberä¸ºé™æ€å˜é‡ ï¼‰ï¼Œå®é™…ä¼šäº§ç”Ÿå¦‚ä¸‹çš„JVMå­—èŠ‚ç æŒ‡ä»¤ï¼š</p><blockquote><p>9: getstatic     #18     // Field number:I<br>12: iconst_1<br>13: iadd<br>14: putstatic    #18     // Field number:I</p></blockquote><blockquote><p>ä»£ç å½“ä¸­çš„<br>number++;<br>å¯¹åº”åæ±‡ç¼–ä»£ç å½“ä¸­çš„4å¥<br>9: getstatic     #18     // Field number:I<br>12: iconst_1<br>13: iadd<br>14: putstatic    #18     // Field number:I</p></blockquote><p>å³ <code>number++</code>æ˜¯ç”±<strong>å››æ¡å­—èŠ‚ç æŒ‡ä»¤</strong>ç»„æˆçš„ï¼›<br>é‚£ä¹ˆå…¶ä¸­åœ¨<strong>ä¸€ä¸ªçº¿ç¨‹</strong>ä¸‹æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼›<br>ä½†å¦‚æœæ˜¯æ”¾åœ¨<strong>å¤šçº¿ç¨‹</strong>çš„æƒ…å†µä¸‹é‚£ä¹ˆå°±æ˜¯æœ‰é—®é¢˜çš„ï¼›<br>å½“å‰æ¥è¿›è¡Œåˆ†æä¸‹è¿™ä¸ª<strong>åŸå­æ€§é—®é¢˜</strong>ï¼š<br>ç¨‹åºæœ‰ä¸»æ–¹æ³•mainæ–¹æ³•å¼€å§‹è¿›è¡Œæ‰§è¡Œçš„ï¼›</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line">public class Test02Atomicity&#123;</span><br><span class="line">  // <span class="number">1</span>. å®šä¹‰ä¸€ä¸ªå…±äº«å˜é‡<span class="keyword">number</span></span><br><span class="line">  private static int <span class="keyword">number</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  public static void main(<span class="keyword">String</span>[] args) throws InterruptedException&#123;</span><br><span class="line">    // <span class="number">2</span>. å¯¹<span class="keyword">number</span>è¿›è¡Œ<span class="number">1000</span>çš„++æ“ä½œ</span><br><span class="line">    Runnable increment = ()-&gt;&#123;</span><br><span class="line">      for(int i = <span class="number">0</span>; i<span class="tag">&lt; 1000; i++)&#123;</span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">        number++;</span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">/**</span></span><br><span class="line"><span class="tag">-------------             ------------------------------------------</span></span><br><span class="line"><span class="tag">|           |             |                                        |</span></span><br><span class="line"><span class="tag">|           |             | 9: getstatic    #18  // Field number:I |</span></span><br><span class="line"><span class="tag">| number++; |===========ã€‹|12: iconst_1                            |</span></span><br><span class="line"><span class="tag">|           |             |13: iadd                                |</span></span><br><span class="line"><span class="tag">|           |             |14: putstatic    #18  // Field number:I |</span></span><br><span class="line"><span class="tag">|           |             |                                        |</span></span><br><span class="line"><span class="tag">-------------             ------------------------------------------</span></span><br><span class="line"><span class="tag">*/</span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">      &#125;</span></span><br><span class="line"><span class="tag">    &#125;;</span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">    List&lt;Thread&gt;</span> list = new ArrayList<span class="tag">&lt;Thread&gt;</span>();</span><br><span class="line">    // <span class="number">3</span>. ä½¿ç”¨<span class="number">5</span>ä¸ªçº¿ç¨‹æ¥è¿›è¡Œ</span><br><span class="line">    for(int i = <span class="number">0</span> ; i<span class="tag">&lt; 5; i++)&#123;</span></span><br><span class="line"><span class="tag">      Thread t = new Thread(increment);</span></span><br><span class="line"><span class="tag">      t.start();</span></span><br><span class="line"><span class="tag">      list.add(t);</span></span><br><span class="line"><span class="tag">    &#125;</span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">    for(Thread t: list)&#123;</span></span><br><span class="line"><span class="tag">      t.join();</span></span><br><span class="line"><span class="tag">    &#125;</span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">    System.out.println("number = " + number);</span></span><br><span class="line"><span class="tag">  &#125;</span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">  /**</span></span><br><span class="line"><span class="tag">  ä»¥ä¸‹è¿›è¡Œçº¦å®šï¼šçº¢è‰²çš„ç®­å¤´ä»£è¡¨ä¸»çº¿ç¨‹</span></span><br><span class="line"><span class="tag">  é‚£ä¹ˆä¸»çº¿ç¨‹å…ˆä¼šè¿›è¡Œæ‰§è¡Œï¼ˆmain()ï¼‰ï¼›</span></span><br><span class="line"><span class="tag">  Runnableè¯¥è¯­å¥å…ˆä¸ä¼šè¿›è¡Œæ‰§è¡Œï¼ˆRunnable increment=()-&gt;</span>&#123;...&#125;;ï¼‰ï¼›</span><br><span class="line">  ç„¶åèµ°ä¸‹é¢çš„æ‰§è¡Œè¯­å¥åˆ›å»ºlisté›†åˆï¼ˆList<span class="tag">&lt;Thread&gt;</span> <span class="attr">list=</span>new ArrayList<span class="tag">&lt;Thread&gt;</span>();)ï¼‰</span><br><span class="line">  ä»¥åŠforå¾ªç¯<span class="number">5</span>æ¬¡åˆ›å»ºç”Ÿæˆ<span class="number">5</span>ä¸ªThreadçº¿ç¨‹ï¼›</span><br><span class="line">  ç„¶åè¿™ä¸ªæ—¶å€™æ¯ä¸ªçº¿ç¨‹æ‰ä¼šå»æ‰§è¡Œä¸Šé¢çš„Runnableï¼›</span><br><span class="line">  <span class="number">5</span>ä¸ªçº¿ç¨‹åˆ†æèµ·æ¥æœ‰ç‚¹éº»çƒ¦ï¼›</span><br><span class="line">  å½“å‰åœ¨for()å¾ªç¯åˆ›å»ºç”Ÿæˆ<span class="number">5</span>ä¸ªçº¿ç¨‹é€”ä¸­ï¼Œ</span><br><span class="line">  é‚£ä¹ˆæ­¤æ—¶å½“å‰å‡è®¾å·²ç»åˆ›å»ºç”Ÿæˆçº¿ç¨‹Thread Aä¸çº¿ç¨‹Thread Bï¼›</span><br><span class="line">  </span><br><span class="line">  é‚£ä¹ˆæ­¤æ—¶åœ¨Thread Aä¸Thread BåŒæ—¶éƒ½è¿è¡Œ<span class="literal">start</span>()æ–¹æ³•çš„æ—¶å€™</span><br><span class="line">  é‚£ä¹ˆå°±éƒ½å°†ä¼šå»æ‰§è¡ŒRunnableå½“ä¸­çš„run()æ–¹æ³•å³å¾ªç¯<span class="number">1000</span>æ¬¡çš„<span class="keyword">number</span>++æ“ä½œï¼›</span><br><span class="line">  é‚£ä¹ˆå‡è®¾æ­¤æ—¶çš„<span class="keyword">number</span>å–å€¼ä¸º<span class="number">0</span>ï¼›</span><br><span class="line">  å‡è®¾çº¿ç¨‹Thread Aå…ˆè¿›è¡Œèµ°ï¼Œé‚£ä¹ˆå³å¾ªç¯<span class="number">1000</span>æ¬¡æ‰§è¡Œ<span class="keyword">number</span>++ï¼›</span><br><span class="line">  é‚£ä¹ˆè¿™æ¯ä¸€æ¬¡çš„<span class="keyword">number</span>++éƒ½æ˜¯åœ¨æ‰§è¡Œå­—èŠ‚ç çš„é‚£<span class="number">4</span>æ¡æŒ‡ä»¤ï¼›</span><br><span class="line">  å³</span><br><span class="line">  <span class="number">9</span>:  getstatic <span class="comment">#18</span></span><br><span class="line">  <span class="number">12</span>: iconst_1</span><br><span class="line">  <span class="number">13</span>: iadd</span><br><span class="line">  <span class="number">14</span>: putstatic <span class="comment">#18</span></span><br><span class="line">  <span class="comment">#9: getstaticè¯¥æŒ‡ä»¤å³ä¸ºå–åˆ°å…±äº«å˜é‡numberçš„å–å€¼ï¼Œæ­¤æ—¶ä¸º0</span></span><br><span class="line">  <span class="comment">#12: å­—èŠ‚ç æŒ‡ä»¤ç»§ç»­å¾€ä¸‹æ‰§è¡Œä¸€æ­¥ï¼Œiconst_1è¯¥å­—èŠ‚ç æŒ‡ä»¤çš„å«ä¹‰ä¸ºæ˜¯åœ¨å‡†å¤‡ä¸€ä¸ªå¸¸é‡1</span></span><br><span class="line">  <span class="comment">#13: å‡è®¾å†å¾€ä¸‹èµ°ä¸€æ­¥æ‰§è¡Œå­—èŠ‚ç æŒ‡ä»¤iaddï¼›é‚£ä¹ˆè¯¥æŒ‡ä»¤æ‰§è¡Œåä¼šè®©12: iconst_1 å‡†å¤‡çš„å¸¸é‡1ä¸9: getstatic #18 è·å–å¾—åˆ°çš„number è¯¥å…±äº«å˜é‡çš„å–å€¼è¿›è¡Œç›¸åŠ æ“ä½œï¼›æœ€ç»ˆçš„ç»“æœæ˜¯1ï¼›</span></span><br><span class="line">  </span><br><span class="line">  ä½†æ˜¯æ³¨æ„å‡è®¾æ­¤æ—¶å¹¶æ²¡æœ‰çœŸæ­£å‘ç”Ÿèµ‹å€¼æ“ä½œï¼Œå³è¿ç®—å‡ºç»“æœä¸º<span class="number">1</span>ï¼›</span><br><span class="line">  ä½†æ˜¯å¹¶æ²¡æœ‰èµ‹å€¼ç»™<span class="keyword">number</span>è¯¥å…±äº«å˜é‡çš„å–å€¼ä¸Šï¼›</span><br><span class="line">  ç„¶åæ­¤æ—¶CPUåˆ‡æ¢åˆ°å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä¸Šé¢å»å³çº¿ç¨‹Bä¸Šå»æ‰§è¡Œäº†ï¼›</span><br><span class="line">  é‚£ä¹ˆæ­¤æ—¶å¦å¤–ä¸€ä¸ªçº¿ç¨‹ï¼Œå³çº¿ç¨‹Bï¼Œä¹Ÿè¿›å…¥äº†forå¾ªç¯æ¥æ‰§è¡Œ<span class="keyword">number</span>++æ“ä½œï¼›</span><br><span class="line">  é‚£ä¹ˆçº¿ç¨‹Bä¹Ÿæœ‰å››æ¡å­—èŠ‚ç æŒ‡ä»¤éœ€è¦è¿›è¡Œæ‰§è¡Œï¼›</span><br><span class="line">  </span><br><span class="line">  å…ˆæ‰§è¡Œå­—èŠ‚ç æŒ‡ä»¤çš„ç¬¬ä¸€æ¡æŒ‡ä»¤ <span class="number">9</span>: getstatic <span class="comment">#18 è·å–å¾—åˆ°å…±äº«å˜é‡numberçš„å–å€¼ï¼Œ</span></span><br><span class="line">  ç›®å‰è¯¥å…±äº«å˜é‡çš„å–å€¼æ˜¯æ²¡æœ‰çº¿ç¨‹è¿›è¡Œæ”¹å˜çš„ï¼›</span><br><span class="line">  å³ä¹Ÿå°±æ˜¯è¯´çº¿ç¨‹Aåˆšåˆšåœ¨æ“ä½œ<span class="keyword">number</span>++å­—èŠ‚ç æŒ‡ä»¤æ“ä½œçš„æ­¥éª¤ä¸‰æ—¶åªæ˜¯è¿ç®—å¾—å‡ºè¿ç®—ç»“æœä¸º<span class="number">1</span>ï¼›</span><br><span class="line">  ä½†æ˜¯å¹¶æ²¡æœ‰è¿›è¡Œèµ‹å€¼å°±è¿›è¡Œäº†CPUåˆ‡æ¢åˆ°äº†çº¿ç¨‹Bä¸Šï¼Œ</span><br><span class="line">  æ‰€ä»¥ç›¸å¯¹äºçº¿ç¨‹Bå½“å‰çš„å…±äº«å˜é‡<span class="keyword">number</span>æ¥è¯´ï¼Œçº¿ç¨‹Bè®¤ä¸º<span class="keyword">number</span>å…±äº«å˜é‡çš„å–å€¼æ˜¯<span class="number">0</span>ï¼›</span><br><span class="line">  é‚£ä¹ˆå½“getstaticè·å–å¾—åˆ°å…±äº«å˜é‡<span class="keyword">number</span>çš„å–å€¼ä¹‹åï¼Œ</span><br><span class="line">  ç„¶åæ‰§è¡Œå­—èŠ‚ç æŒ‡ä»¤çš„ç¬¬äºŒæ¡æŒ‡ä»¤ <span class="number">12</span>: iconst_1 å³åŒæ ·æ˜¯å‡†å¤‡ä¸€ä¸ªå¸¸é‡<span class="number">1</span>ï¼›</span><br><span class="line">  å†æ‰§è¡Œå­—èŠ‚ç æŒ‡ä»¤çš„ç¬¬ä¸‰æ¡æŒ‡ä»¤ <span class="number">13</span>: iadd è¿™ä¸ªæ—¶å€™åŒæ ·æ˜¯å°†<span class="keyword">number</span>++æ“ä½œå½“ä¸­çš„ç¬¬ä¸€æ¡å­—èŠ‚ç æŒ‡ä»¤å½“ä¸­<span class="number">9</span>: getstatic <span class="comment">#18 è·å–å¾—åˆ°çš„ å…±äº«å˜é‡numberçš„å–å€¼ä¸ number++æ“ä½œå½“ä¸­çš„ç¬¬äºŒæ¡æŒ‡ä»¤ 12: iconst_1 æ‰€å‡†å¤‡çš„å¸¸é‡1 è¿™ä¸¤è€…è¿›è¡Œç›¸åŠ æ“ä½œï¼›</span></span><br><span class="line">  è¿ç®—ç»“æœå¾—åˆ°<span class="number">1</span>ï¼›</span><br><span class="line">  å‡è®¾çº¿ç¨‹Bå†ç»§ç»­å¾€ä¸‹èµ°ï¼Œ</span><br><span class="line">  é‚£ä¹ˆæ­¤æ—¶åˆ°äº†<span class="keyword">number</span>++æ“ä½œæ‰€å¯¹åº”å­—èŠ‚ç æŒ‡ä»¤çš„ç¬¬å››ä¸ªæŒ‡ä»¤äº†ï¼›</span><br><span class="line">  å³<span class="number">14</span>: putstatic   <span class="comment">#18 ï¼›</span></span><br><span class="line">  é‚£ä¹ˆè¯¥æŒ‡ä»¤æ‰§è¡Œä¹‹åå°±ä¼šå°†æŒ‡ä»¤ä¸‰å½“ä¸­å¾—åˆ°çš„ç»“æœ<span class="number">1</span>èµ‹å€¼ç»™å…±äº«å˜é‡<span class="keyword">number</span>çš„å–å€¼ï¼Œ</span><br><span class="line">  è€Œ<span class="keyword">number</span>å˜é‡çš„å–å€¼æ­¤æ—¶ä»<span class="number">0</span>å˜ä¸º<span class="number">1</span>ï¼›</span><br><span class="line">  é‚£ä¹ˆæ­¤æ—¶è¯¥çº¿ç¨‹çš„ä¸€æ¬¡<span class="keyword">number</span>++æ‰§è¡Œå®Œæˆï¼›</span><br><span class="line"></span><br><span class="line">  å‡è®¾CPUåˆåˆ‡æ¢åˆ°å‰ä¸€æ¡çº¿ç¨‹ï¼Œå³çº¿ç¨‹Aï¼›</span><br><span class="line">  é‚£ä¹ˆåœ¨åˆ‡æ¢åˆ°çº¿ç¨‹Bä¹‹å‰ï¼Œ</span><br><span class="line">  çº¿ç¨‹Açš„<span class="keyword">number</span>++æ“ä½œçš„<span class="number">4</span>æ¡å­—èŠ‚ç æŒ‡ä»¤å·²ç»æ‰§è¡Œå®Œäº†å‰ä¸‰æ¡å³iaddæ‰§è¡Œè¿ç®—å¾—å‡ºè¿ç®—ç»“æœä¸º<span class="number">1</span>ï¼›</span><br><span class="line">  é‚£ä¹ˆæ­¤æ—¶å½“CPUåˆåˆ‡æ¢å›çº¿ç¨‹Aåˆ™ç»§ç»­æ‰§è¡Œ<span class="keyword">number</span>++æ“ä½œå­—èŠ‚ç æŒ‡ä»¤çš„ç¬¬å››æ¡æŒ‡ä»¤å³<span class="number">14</span>: putstatic <span class="comment">#18è¯¥æŒ‡ä»¤ï¼›</span></span><br><span class="line">  åˆ™è¯¥æŒ‡ä»¤åŒæ ·æ˜¯éœ€è¦è¿›è¡Œputå³ç»™å…±äº«å˜é‡<span class="keyword">number</span>è¿›è¡Œèµ‹å€¼æ“ä½œï¼›</span><br><span class="line">  å³å°†Açº¿ç¨‹è¿ç®—å¾—åˆ°çš„<span class="number">1</span>èµ‹å€¼ç»™å·²ç»è¢«çº¿ç¨‹Bä¹‹å‰èµ‹å€¼å¥½<span class="keyword">number</span>ä¸º<span class="number">1</span>çš„å…±äº«å˜é‡å–å€¼ä¸º<span class="number">1</span>ï¼›</span><br><span class="line">  æ‰€ä»¥å½“å‰å…±äº«å˜é‡<span class="keyword">number</span>çš„å–å€¼ä¾æ—§æ˜¯<span class="number">1</span>ï¼›</span><br><span class="line">  é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±çœ‹åˆ°äº†ï¼Œä¸¤ä¸ªçº¿ç¨‹æ‰§è¡Œ<span class="keyword">number</span>++ï¼›</span><br><span class="line">  æŒ‰é“ç†å…¶å€¼åº”è¯¥æ˜¯<span class="number">2</span>ï¼›</span><br><span class="line">  é‚£ä¹ˆå› ä¸º<span class="keyword">number</span>++çš„å­—èŠ‚ç æŒ‡ä»¤è¿™<span class="number">4</span>æ¡å­—èŠ‚ç æŒ‡ä»¤æ²¡æœ‰ä¿è¯å…¶ä¸€ä¸ªåŸå­æ€§ï¼›</span><br><span class="line">  æ‰€ä»¥å‘ç°å¯¼è‡´æœ€åçš„ç»“æœ<span class="keyword">number</span>åªåŠ äº†<span class="number">1</span>ï¼›</span><br><span class="line">  å°±è®©æ•°æ®äº§ç”Ÿäº†é”™è¯¯ï¼›</span><br><span class="line">  é‚£ä¹ˆè¿™ä¸ªé—®é¢˜çš„åŸå› å°±åœ¨äºè®©ä¸¤ä¸ªçº¿ç¨‹æ¥è¿›è¡Œæ“ä½œ<span class="keyword">number</span>++ï¼›</span><br><span class="line">  è€Œ<span class="keyword">number</span>++çš„å­—èŠ‚ç æŒ‡ä»¤åˆæ˜¯å¤šæ¡æŒ‡ä»¤ï¼ˆ<span class="number">4</span>æ¡æŒ‡ä»¤ï¼‰ï¼›</span><br><span class="line">  å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œåˆ°ä¸€åŠçš„æ—¶å€™ï¼›</span><br><span class="line">  CPUåˆåˆ‡æ¢åˆ°å¦å¤–ä¸€ä¸ªçº¿ç¨‹ï¼Œå³å¦å¤–ä¸€ä¸ªçº¿ç¨‹åˆæ¥æ‰§è¡Œäº†ï¼›</span><br><span class="line">  å³ç¬¬äºŒä¸ªçº¿ç¨‹å¹²æ‰°äº†ç¬¬ä¸€ä¸ªçº¿ç¨‹çš„æ‰§è¡Œä»è€Œå¯¼è‡´æ‰§è¡Œç»“æœçš„é”™è¯¯ï¼›</span><br><span class="line">  å³æ²¡æœ‰ä¿è¯åŸå­æ€§ï¼›ï¼ˆå³æ²¡æœ‰ä½¿å¾—åº”è¯¥çš„ç»“æœæ­£ç¡®ï¼‰</span><br><span class="line"></span><br><span class="line">  å°ç»“ï¼š</span><br><span class="line">  åœ¨å¹¶å‘ç¼–ç¨‹çš„æ—¶å€™ï¼Œå¾ˆæœ‰å¯èƒ½ä¼šå‡ºç°åŸå­æ€§é—®é¢˜ï¼›</span><br><span class="line">  å½“ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡æ“ä½œåˆ°ä¸€åŠçš„æ—¶å€™ï¼Œ</span><br><span class="line">  å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä¹Ÿæœ‰å¯èƒ½æ¥å¯¹å…±äº«å˜é‡æ¥è¿›è¡Œæ“ä½œï¼›</span><br><span class="line">  é‚£ä¹ˆæ­¤æ—¶å¦å¤–ä¸€ä¸ªçº¿ç¨‹å°±æœ‰å¯èƒ½ä¼šå¹²æ‰°å‰ä¸€ä¸ªçº¿ç¨‹çš„æ“ä½œï¼›</span><br><span class="line">  è®©å‰ä¸€ä¸ªçº¿ç¨‹çš„æ“ä½œæ²¡æœ‰ä¿è¯å…¶åŸå­æ€§ï¼›</span><br><span class="line">  */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±æ­¤å¯è§ number++ æ˜¯ç”±å¤šæ¡<strong>å­—èŠ‚ç </strong>è¯­å¥ç»„æˆï¼Œ<br>ä»¥ä¸Š<strong>å¤šæ¡æŒ‡ä»¤</strong> åœ¨<strong>ä¸€ä¸ªçº¿ç¨‹çš„æƒ…å†µä¸‹</strong> æ˜¯ä¸ä¼šå‡ºé—®é¢˜çš„ï¼Œ<br>ä½†æ˜¯åœ¨<strong>å¤šçº¿ç¨‹æƒ…å†µä¸‹</strong>å°±å¯èƒ½ä¼šå‡ºç°é—®é¢˜ã€‚<br>æ¯”å¦‚ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œ 13: iadd æ—¶ï¼Œ<br>å¦ä¸€ä¸ªçº¿ç¨‹åˆæ‰§è¡Œ 9: getstaticï¼Œ<br>ä¼šå¯¼è‡´ä¸¤æ¬¡ number++ï¼Œå®é™…ä¸ŠåªåŠ äº†1ã€‚</p><h3 id="å°ç»“-1"><a href="#å°ç»“-1" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>ä»€ä¹ˆæ˜¯<strong>åŸå­æ€§</strong></p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">åŸå­æ€§ï¼ˆAtomicityï¼‰: åœ¨ä¸€æ¬¡çš„æ“ä½œæˆ–å¤šæ¬¡æ“ä½œä¸­ï¼Œè¦ä¹ˆæ‰€æœ‰çš„æ“ä½œå…¨éƒ¨éƒ½å¾—åˆ°äº†æ‰§è¡Œå¹¶ä¸”ä¸ä¼šå—åˆ°ä»»ä½•å› ç´ çš„å¹²æ‰°è€Œä¸­æ–­ï¼Œè¦ä¹ˆæ‰€æœ‰çš„æ“ä½œéƒ½ä¸æ‰§è¡Œã€‚</span></span><br></pre></td></tr></table></figure><h2 id="æœ‰åºæ€§é—®é¢˜"><a href="#æœ‰åºæ€§é—®é¢˜" class="headerlink" title="æœ‰åºæ€§é—®é¢˜"></a>æœ‰åºæ€§é—®é¢˜</h2><h3 id="ç›®æ ‡-2"><a href="#ç›®æ ‡-2" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>å­¦ä¹ ä»€ä¹ˆæ˜¯<strong>æœ‰åºæ€§é—®é¢˜</strong></p><p>å­¦ä¹ åˆ†æˆä¸¤æ­¥ï¼›<br>ç¬¬ä¸€æ­¥ï¼šå­¦ä¹ æœ‰åºæ€§çš„æ¦‚å¿µï¼›<br>ç¬¬äºŒæ­¥ï¼šé€šè¿‡ä¸€ä¸ªæ¡ˆä¾‹æ¥æ¼”ç¤ºæœ‰åºæ€§é—®é¢˜<br>æœ‰åºæ€§ï¼ˆOrderingï¼‰ï¼šæ˜¯æŒ‡ç¨‹åºä¸­ä»£ç çš„æ‰§è¡Œé¡ºåº<br>ä¸€èˆ¬ä¼šè®¤ä¸ºç¼–å†™ä»£ç çš„é¡ºåºå°±æ˜¯ä»£ç æœ€ç»ˆçš„æ‰§è¡Œé¡ºåºï¼›<br>é‚£ä¹ˆå®é™…ä¸Šå¹¶ä¸ä¸€å®šæ˜¯è¿™æ ·çš„ï¼›<br>ä¸ºäº†æé«˜ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ï¼›javaåœ¨ç¼–è¯‘æ—¶å’Œè¿è¡Œæ—¶ä¼šå¯¹ä»£ç è¿›è¡Œä¼˜åŒ–ï¼Œä¼šå¯¼è‡´ç¨‹åºæœ€ç»ˆçš„æ‰§è¡Œé¡ºåºä¸ä¸€å®šå°±æ˜¯ç¼–å†™ä»£ç æ—¶çš„é¡ºåºã€‚<br>æ¥ä¸‹æ¥é€šè¿‡ä¸€ä¸ªæ¡ˆä¾‹æ¥æ¼”ç¤ºæœ‰åºæ€§é—®é¢˜ï¼›</p><h3 id="æœ‰åºæ€§æ¦‚å¿µ"><a href="#æœ‰åºæ€§æ¦‚å¿µ" class="headerlink" title="æœ‰åºæ€§æ¦‚å¿µ"></a>æœ‰åºæ€§æ¦‚å¿µ</h3><p>æœ‰åºæ€§ï¼ˆOrderingï¼‰ï¼šæ˜¯æŒ‡ç¨‹åºä»£ç åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­çš„å…ˆåé¡ºåºï¼Œç”±äºjavaåœ¨ç¼–è¯‘å™¨ä»¥åŠè¿è¡ŒæœŸçš„ä¼˜åŒ–ï¼Œå¯¼è‡´äº†ä»£ç çš„æ‰§è¡Œé¡ºåºæœªå¿…å°±æ˜¯å¼€å‘è€…ç¼–å†™ä»£ç çš„é¡ºåºã€‚</p><h3 id="æœ‰åºæ€§æ¼”ç¤º"><a href="#æœ‰åºæ€§æ¼”ç¤º" class="headerlink" title="æœ‰åºæ€§æ¼”ç¤º"></a>æœ‰åºæ€§æ¼”ç¤º</h3><p><strong>jcstress</strong> æ˜¯javaå¹¶å‘å‹æµ‹å·¥å…·ï¼š </p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//</span>wiki.openjdk.java.net<span class="regexp">/display/</span>CodeTools<span class="regexp">/jcstress</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹pomæ–‡ä»¶ï¼Œæ·»åŠ ä¾èµ–ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.openjdk.jcstress<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jcstress-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;jcstress.version<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä»£ç <br>Test03Orderliness.java</p><figure class="highlight golo"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line">package com.xxx.concurrent_problem;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.openjdk.jcstress.annotations.*;</span><br><span class="line"><span class="keyword">import</span> org.openjdk.jcstress.infra.results.I_Result;</span><br><span class="line"></span><br><span class="line"><span class="meta">@JCStressTest</span></span><br><span class="line"><span class="meta">@OutCome</span>(id = &#123;<span class="string">"1"</span> , <span class="string">"4"</span>&#125;, expect =  Expect.ACCEPTABLE, desc = <span class="string">"ok"</span>)</span><br><span class="line"><span class="meta">@OutCome</span>(id = <span class="number">0</span>, expect = EXPECT.ACCEPTABLE_INTERESTING, desc = <span class="string">"danger"</span>)</span><br><span class="line"><span class="meta">@State</span></span><br><span class="line">public class Test03Orderliness&#123;</span><br><span class="line">    int num = <span class="number">0</span>;</span><br><span class="line">    boolean ready = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    /* çº¿ç¨‹ä¸€ æ‰§è¡Œçš„ä»£ç ï¼›å…ˆè¿›è¡Œåˆ¤æ–­readyçš„å€¼ç„¶åè¿›è¡Œç›¸å…³æ“ä½œï¼›</span><br><span class="line">       I_Resultä¸ºå¹¶å‘å‹æµ‹å·¥å…·è‡ªå¸¦çš„ç±»ï¼›</span><br><span class="line">       <span class="meta">@Actor</span>æ³¨è§£ï¼šè¡¨ç¤ºåˆ°æ—¶å€™æœ‰å¤šä¸ªçº¿ç¨‹æ¥æ‰§è¡Œè¿™ä¸¤ä¸ªæ–¹æ³•ï¼›</span><br><span class="line">       <span class="meta">@JCStressTest</span>æ³¨è§£ï¼šè¡¨ç¤ºç”¨è¿™ä¸ªå¹¶å‘å‹æµ‹å·¥å…·æ¥å¯¹è¿™ä¸ªç±»çš„æ–¹æ³•è¿›è¡Œæµ‹è¯•</span><br><span class="line">       <span class="meta">@OutCome</span>æ³¨è§£ï¼šå¯¹è¾“å‡ºç»“æœçš„å¤„ç†ï¼›</span><br><span class="line">       å¦‚æœå½“idä¸º&#123;<span class="string">"1"</span>,<span class="string">"4"</span>&#125;çš„æ—¶å€™ï¼Œè¡¨ç¤ºè¿™ç§ç»“æœæ˜¯æˆ‘ä»¬æ‰€é¢„æœŸæ‰€æ¥å—çš„ç»“æœï¼Œåˆ™æ‰“å°ä¿¡æ¯<span class="string">"ok"</span>;</span><br><span class="line">       å¦‚æœç¨‹åºæœ€ç»ˆI_Resultå½“ä¸­ä¿å­˜çš„ç»“æœæ˜¯<span class="number">0</span>ï¼›åˆ™ä¹Ÿè®¤ä¸ºç»“æœæ˜¯å¯æ¥å—æ„Ÿå…´è¶£çš„ï¼›ç„¶åæ‰“å°ä¿¡æ¯<span class="string">"danger"</span></span><br><span class="line">       æ¥ä¸‹æ¥åˆ†æä¸‹æœ‰å‡ ç§è¿è¡Œç»“æœï¼›</span><br><span class="line">    */</span><br><span class="line">    <span class="meta">@Actor</span></span><br><span class="line">    public void actor1(I_Result r)&#123;</span><br><span class="line">      <span class="keyword">if</span>(ready)&#123;</span><br><span class="line">        r.r1 = num + num;</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        r.r1 = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //çº¿ç¨‹äºŒ æ‰§è¡Œçš„ä»£ç ï¼›å¯¹ä¸¤ä¸ªå˜é‡è¿›è¡Œç›¸åº”çš„ä¿®æ”¹ï¼›</span><br><span class="line">    <span class="meta">@Actor</span></span><br><span class="line">    public void actor2(I_Result r)&#123;</span><br><span class="line">      num = <span class="number">2</span>;</span><br><span class="line">      ready = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">      ç”»ä¸¤ä¸ªç®­å¤´ä»£è¡¨ä¸¤ä¸ªçº¿ç¨‹ï¼›</span><br><span class="line">      (è“è‰²ç®­å¤´ä¸ç´«è‰²ç®­å¤´)</span><br><span class="line">      è€Œå®é™…ä¸Šè¿™æ ‡æœ‰<span class="meta">@Actor</span>æ³¨è§£çš„ä¸¤ä¸ªæ–¹æ³•æœ‰å¾ˆå¤šçš„çº¿ç¨‹æ¥æ‰§è¡Œï¼›</span><br><span class="line">      é‚£ä¹ˆä¸ºäº†æ¼”ç¤ºæ–¹æ³•ï¼Œä¸€ä¸ªçº¿ç¨‹ä¸€ä¸ªæ–¹æ³•ä¹Ÿæ˜¯å¯ä»¥çš„ï¼›</span><br><span class="line">      é‚£ä¹ˆè¿™é‡Œå­˜åœ¨æœ‰å‡ ç§æƒ…å†µï¼›</span><br><span class="line">      åˆ†æœ‰çº¿ç¨‹Aä¸çº¿ç¨‹Båˆ†åˆ«æ‰§è¡Œactor1(I_Result r)ä¸actor2(I_Result r)ï¼›</span><br><span class="line">      ç¬¬ä¸€ç§æƒ…å†µæ˜¯ä¸Šé¢çš„çº¿ç¨‹Aå…ˆèµ°ï¼›</span><br><span class="line">      æ‰§è¡Œactor1(I_Result r)æ–¹æ³•ï¼›</span><br><span class="line">      åˆ™è·å–å¾—åˆ°å…±äº«å˜é‡ readyå–å€¼ä¸º<span class="literal">false</span>ï¼›</span><br><span class="line">      åˆ™æ­¤æ—¶èµ°<span class="keyword">else</span>å—ï¼›</span><br><span class="line">      å°†<span class="number">1</span>èµ‹å€¼ç»™I_Result rå½“ä¸­çš„æˆå‘˜å˜é‡r1ï¼Œå³å°†r.r1å³I_Resultæˆå‘˜å˜é‡r1å±æ€§çš„å–å€¼ä¿®æ”¹ä¸º<span class="number">1</span>ï¼›</span><br><span class="line"></span><br><span class="line">      è®°å½•ä¸€ä¸‹r.r1(I_Resultä¸­r1å±æ€§å–å€¼çš„å˜åŒ–)ï¼š</span><br><span class="line">      ç»“æœ<span class="number">1</span>ï¼š  <span class="number">1</span></span><br><span class="line"></span><br><span class="line">      æ¥ç€å‡è®¾ç¬¬äºŒç§æƒ…å†µä¸‹é¢çš„çº¿ç¨‹Bå…ˆèµ°ï¼›</span><br><span class="line">      æ‰§è¡Œactor2(I_Result r)æ–¹æ³•ï¼›</span><br><span class="line">      æ‰§è¡Œä»£ç è¯­å¥ç»™å…±äº«å˜é‡numä»¥åŠreadyé‡æ–°èµ‹å€¼ï¼›</span><br><span class="line">      å³numè¯¥æ•°å€¼å˜ä¸ºäº†<span class="number">2</span>ï¼›</span><br><span class="line">      readyè¯¥å¸ƒå°”ç±»å‹å–å€¼å˜ä¸ºäº†<span class="literal">true</span>ï¼›</span><br><span class="line"></span><br><span class="line">      æ¥ç€CPUåˆåˆ‡æ¢åˆ°ä¸Šé¢çš„çº¿ç¨‹Aå½“ä¸­è¿›è¡Œæ‰§è¡Œï¼›</span><br><span class="line">      ç”±äºçº¿ç¨‹Bä¿®æ”¹numä»¥åŠreadyè¿™ä¸¤ä¸ªå…±äº«å˜é‡æˆåŠŸäº†ï¼›</span><br><span class="line">      å³numå–å€¼ä¸º<span class="number">2</span>ï¼›readyå–å€¼ä¸º<span class="literal">true</span>ï¼›</span><br><span class="line">      åˆ™æ­¤æ—¶çº¿ç¨‹Aå†ä¸€æ¬¡è¿›è¡Œåˆ¤æ–­readyè¯¥å˜é‡çš„å–å€¼æ—¶æ­¤æ—¶readyä¸º<span class="literal">true</span>ï¼›</span><br><span class="line">      åˆ™è¿›å…¥actor1(I_Result r)å½“ä¸­çš„<span class="keyword">if</span>å—ä¸­ï¼›</span><br><span class="line">      æ‰§è¡Œèµ‹å€¼è¯­å¥ï¼Œæ­¤æ—¶numå–å€¼ä¸º<span class="number">2</span>ï¼›</span><br><span class="line">      é‚£ä¹ˆæ­¤æ—¶I_Result r.r1å–å€¼åˆè¢«é‡æ–°èµ‹å€¼ä¸ºnum+numï¼Œå³è¿ç®—ç»“æœä¸º<span class="number">4</span>ï¼›</span><br><span class="line">      r.r1å–å€¼é‡æ–°èµ‹å€¼ä¸º<span class="number">4</span>ï¼›</span><br><span class="line"></span><br><span class="line">      è®°å½•ä¸€ä¸‹r.r1(I_Resultä¸­r1å±æ€§å–å€¼çš„å˜åŒ–)ï¼š</span><br><span class="line">      ç»“æœ<span class="number">2</span>ï¼š  <span class="number">4</span></span><br><span class="line"></span><br><span class="line">      ç¬¬ä¸‰ç§å¯èƒ½æ€§ï¼š</span><br><span class="line">      ä¾ç„¶è¿˜æ˜¯å‡è®¾ä¸‹é¢çš„çº¿ç¨‹å…ˆèµ°å³å…ˆèµ°çº¿ç¨‹Bï¼›</span><br><span class="line">      æ‰§è¡Œactor2(I_Result r)æ–¹æ³•ï¼›</span><br><span class="line">      æ‰§è¡Œåˆ°ä»£ç è¯­å¥ num = <span class="number">2</span>; æ—¶ï¼ŒCPUåˆåˆ‡æ¢åˆ°çº¿ç¨‹Aä¸­å»æ‰§è¡Œactor1(I_Result r)æ–¹æ³•äº†ï¼›</span><br><span class="line">      é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±æ˜¯ç”±çº¿ç¨‹Aå»æ‰§è¡Œactor1(I_Result r)æ–¹æ³•ï¼›</span><br><span class="line">      æ­¤æ—¶çº¿ç¨‹Aè·å–å¾—åˆ°readyå˜é‡çš„å–å€¼ï¼šä¸º<span class="literal">false</span>ï¼›</span><br><span class="line">      ç”±äºæ˜¯æ‰§è¡Œçº¿ç¨‹Bæ‰§è¡Œåˆ°num=<span class="number">2</span>;èµ‹å€¼å®Œæˆä¹‹åä½†æ˜¯å¹¶æœªæ‰§è¡Œready=<span class="literal">true</span>è¯¥è¯­å¥ä¹‹å‰CPUè¿›è¡Œåˆ‡æ¢åˆ°äº†çº¿ç¨‹Açš„æ“ä½œä¸Šå»äº†ï¼›</span><br><span class="line">      æ‰€ä»¥æ­¤æ—¶çº¿ç¨‹Aå»è¿›è¡Œè·å–readyå˜é‡æ—¶ï¼Œreadyå˜é‡çš„å–å€¼ä¾æ—§æ˜¯<span class="literal">false</span>ï¼›</span><br><span class="line">      æ‰€ä»¥æ­¤æ—¶ä¸ä¼šè¿›å…¥<span class="keyword">if</span>å—å½“ä¸­è€Œæ˜¯è¿›å…¥<span class="keyword">else</span>å—å½“ä¸­æ‰§è¡Œæ“ä½œä½¿å¾—r.r1=<span class="number">1</span>;</span><br><span class="line">      å³å¯¹I_Result rå½“ä¸­çš„æˆå‘˜å˜é‡r1è¿›è¡Œé‡æ–°èµ‹å€¼ä¸º<span class="number">1</span>ï¼›</span><br><span class="line"></span><br><span class="line">      è®°å½•ä¸€ä¸‹r.r1(I_Resultä¸­r1å±æ€§å–å€¼çš„å˜åŒ–)ï¼š</span><br><span class="line">      ç»“æœ<span class="number">3</span>ï¼š  <span class="number">4</span></span><br><span class="line"></span><br><span class="line">      ç¬¬å››ç§å¯èƒ½æ€§ï¼š</span><br><span class="line">      å¾ˆéš¾å‘ç°ï¼›è¿™æ˜¯ç”±äºjavaåœ¨ç¼–è¯‘æ—¶å’Œè¿è¡Œæ—¶çš„ä¼˜åŒ–ï¼›</span><br><span class="line">      å°±å¯èƒ½ä¼šå¯¹actor2(I_Result r)å½“ä¸­çš„ä»£ç è¯­å¥</span><br><span class="line">      num = <span class="number">2</span>;</span><br><span class="line">      ready = <span class="literal">true</span>;</span><br><span class="line">      è¿›è¡Œé‡æ’åºï¼›</span><br><span class="line">      æ¯”å¦‚è¯´æœ‰å¯èƒ½ä¼šè¢«æ’æˆè¿™æ ·ï¼š</span><br><span class="line">      ready = <span class="literal">true</span>;</span><br><span class="line">      num = <span class="number">2</span>;</span><br><span class="line">      å› ä¸ºè¿™ä¸¤å¥ä»£ç å¹¶æ²¡æœ‰ä»€ä¹ˆç›´æ¥é—´æ¥çš„ä¸€ä¸ªå› æœå…³ç³»ï¼›</span><br><span class="line">      å¦‚æœè¯´é€šè¿‡ç¼–è¯‘æ—¶å’Œè¿è¡Œæ—¶çš„ä¼˜åŒ–ä»£ç å˜æˆäº†</span><br><span class="line">      ready = <span class="literal">true</span>;</span><br><span class="line">      num = <span class="number">2</span>;</span><br><span class="line">      çš„è¿™ç§é¡ºåºåˆ™å†æ¥è¿›è¡Œåˆ†æä¸€ä¸‹ï¼š</span><br><span class="line">      ä¾ç„¶è¿˜æ˜¯å‡è®¾ä¸‹é¢çš„çº¿ç¨‹Bå…ˆèµ°ï¼Œå³æ‰§è¡Œactor2(I_Result r)ï¼›</span><br><span class="line">      åˆ™æ‰§è¡Œäº†ç¬¬ä¸€å¥ready = <span class="literal">true</span>;</span><br><span class="line">      é‚£ä¹ˆæ­¤æ—¶å‡è®¾CPUæ­£å¥½åœ¨ready èµ‹å€¼ä¸º <span class="literal">true</span>ä¹‹åä»¥åŠnum = <span class="number">2</span>èµ‹å€¼ä¹‹å‰åˆåˆ‡æ¢åˆ°äº†ä¸Šé¢çš„é‚£ä¸ªçº¿ç¨‹ï¼Œå³çº¿ç¨‹Aå³æ‰§è¡Œactor1(I_Result r)æ–¹æ³•ï¼›</span><br><span class="line">      é‚£ä¹ˆæ­¤æ—¶çº¿ç¨‹Aåœ¨æ‰§è¡Œactor1(I_Result r)æ—¶é¦–å…ˆä¼šå»è·å–readyè¯¥å…±äº«å˜é‡çš„å–å€¼ï¼Œ</span><br><span class="line">      åˆ™æ­¤æ—¶çš„readyå˜é‡çš„å–å€¼æ˜¯åœ¨çº¿ç¨‹Bçš„æ“ä½œactor2(I_Result r)æ—¶è¿›è¡Œäº†ä¿®æ”¹äº†çš„ï¼Œå¹¶ä¸”èµ‹å€¼æˆåŠŸäº†ï¼›é‚£ä¹ˆè¿™ä¸ªæ—¶å€™çº¿ç¨‹Aè·å–å¾—åˆ°readyçš„å–å€¼ä¸º<span class="literal">true</span>åˆ™è¿›å…¥<span class="keyword">if</span>å—å½“ä¸­æ‰§è¡Œå¯¹I_Result r.r1çš„èµ‹å€¼è¯­å¥ï¼Œr.r1=num+numï¼›é‚£ä¹ˆæ­¤æ—¶çš„numåœ¨çº¿ç¨‹Bçš„æ“ä½œactor2(I_Result r)å¹¶æ²¡æœ‰è¿›è¡Œæ‰§è¡Œï¼Œå³æ²¡æœ‰èµ‹å€¼æˆåŠŸï¼›æ‰€ä»¥æ­¤æ—¶çº¿ç¨‹Aè·å–å¾—åˆ°numçš„å–å€¼ä¾ç„¶ä¸º<span class="number">0</span>ï¼›</span><br><span class="line">      åˆ™æ­¤æ—¶èµ‹å€¼ç»™I_Result r.r1æˆå‘˜å˜é‡çš„å–å€¼ä¸ºnum+num=<span class="number">0</span>;å³èµ‹å€¼ç»™r1çš„å–å€¼ä¸º<span class="number">0</span>ï¼›</span><br><span class="line"></span><br><span class="line">      è®°å½•ä¸€ä¸‹r.r1(I_Resultä¸­r1å±æ€§å–å€¼çš„å˜åŒ–)ï¼š</span><br><span class="line">      ç»“æœ<span class="number">4</span>ï¼š  <span class="number">0</span></span><br><span class="line"></span><br><span class="line">      æ­¤æ—¶å‡ºç°ç»“æœ<span class="number">4</span>: <span class="number">0</span>çš„åŸå› å°±æ˜¯å› ä¸ºactor2(I_Result r)ä¸­çš„ä¸¤å¥ä»£ç çš„æ‰§è¡Œé¡ºåºè¢«é‡æ’åºè¿‡äº†ä»è€Œå¯¼è‡´çš„ï¼›</span><br><span class="line"></span><br><span class="line">      æ•ˆæœï¼š</span><br><span class="line">      é€šè¿‡jcstressæ¥è¿›è¡Œæ£€æµ‹ç»“æœï¼›</span><br><span class="line">      æ‰“å¼€ideaç»ˆç«¯ï¼›å³Terminalï¼›</span><br><span class="line">      é”®å…¥å‘½ä»¤è¡Œï¼šmvn clean install</span><br><span class="line">      å®Œæˆä¹‹åä¼šåœ¨targetç›®å½•å½“ä¸­å½¢æˆä¸¤ä¸ªjaråŒ…ï¼ˆå‰ææ˜¯å®‰è£…äº†jcstressçš„ä¾èµ–ï¼›ï¼‰ - jcstress.jarã€Synchronized<span class="number">-1.0</span>-SNAPSHOT.jar</span><br><span class="line">      æ­¤æ—¶è¿è¡Œjcstress.jarè¯¥jaråŒ…ï¼›</span><br><span class="line">      C:\Users\<span class="number">13666</span>\IdeaProjects\XXX\Synchronized&gt; java -jar target/jcstress.jar</span><br><span class="line">      è¿è¡Œä¹‹åï¼Œè¿›è¡Œå¤šè½®çš„å‹åŠ›æµ‹è¯•ï¼›</span><br><span class="line"></span><br><span class="line">    */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‹åŠ›æµ‹è¯•ç»“æœï¼ˆä»£ç é‡æ’åºæ‰€å¯¼è‡´stateç»“æœå‡ºç°äº†0ï¼‰:</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">    [OK] com.xxx.demo02_concurrent_probleam.Test03Ordering</span><br><span class="line">  ï¼ˆJVM args: [-XX:-TieredCompilation]ï¼‰</span><br><span class="line">Observed state Occurrences         Expectation     Interpretation</span><br><span class="line">             <span class="number">0</span>       <span class="number">5</span>,<span class="number">630</span>  ACCEPTABLE_INTERESTING  danger</span><br><span class="line">             <span class="number">1</span> <span class="number">150</span>,<span class="number">985</span>,<span class="number">557</span>          ACCEPTABLE      ok</span><br><span class="line">             <span class="number">4</span>  <span class="number">41</span>,<span class="number">594</span>,<span class="number">004</span>          ACCEPTABLE      ok</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    [OK] com.xxx.demo02_concurrent_probleam.Test03Ordering</span><br><span class="line">  ï¼ˆJVM args: []ï¼‰</span><br><span class="line">Observed state Occurrences         Expectation     Interpretation</span><br><span class="line">             <span class="number">0</span>       <span class="number">2</span>,<span class="number">787</span>  ACCEPTABLE_INTERESTING  danger</span><br><span class="line">             <span class="number">1</span> <span class="number">113</span>,<span class="number">540</span>,<span class="number">468</span>          ACCEPTABLE      ok</span><br><span class="line">             <span class="number">4</span>  <span class="number">46</span>,<span class="number">388</span>,<span class="number">436</span>          ACCEPTABLE      ok</span><br></pre></td></tr></table></figure><p>I_Result.class<br>jcstressjavaå¹¶å‘å‹æµ‹å·¥å…·å½“ä¸­å¹¶ä¸åªæœ‰I_Resultè¿™ä¸€ä¸ªç±»ï¼›è¿˜å­˜åœ¨æœ‰å¤šä¸ªç±»ä¼¼çš„ç±»æ¥è¿›è¡Œä¿å­˜å„ç§ä¸åŒçš„ç»“æœã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.openjdk.jcstress.infra.results;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> ...</span><br><span class="line"></span><br><span class="line"><span class="meta">@Result</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">I_Result</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">    æˆå‘˜å˜é‡r1 æ¥ä¿å­˜ä¸€ä¸ªintç±»å‹çš„ç»“æœ</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="meta">@Contended</span></span><br><span class="line">  <span class="meta">@jdk</span>.internal.vm.annotation.Contended</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">int</span> r1;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">I_Result</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> result = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> result = <span class="number">31</span> * result + <span class="keyword">this</span>.r1;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span></span>&#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆæœ‰åºæ€§é—®é¢˜ï¼Œæœ‰å¯èƒ½é‡æ’åºä»è€Œå¯¼è‡´åœ¨å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œæ•°æ®å‡ºç°é”™ä¹±é—®é¢˜ã€‚ï¼‰</p><p>I_Result æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæœ‰ä¸€ä¸ªå±æ€§r1 ç”¨æ¥ä¿å­˜ç»“æœï¼Œåœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹å¯èƒ½å‡ºç°å‡ ç§ç»“æœï¼Ÿ</p><p>æƒ…å†µ1ï¼šçº¿ç¨‹1å…ˆæ‰§è¡Œactor1ï¼Œè¿™æ—¶ ready=falseï¼Œæ‰€ä»¥è¿›å…¥elseåˆ†æ”¯ç»“æœä¸º1ã€‚<br>æƒ…å†µ2ï¼šçº¿ç¨‹2æ‰§è¡Œåˆ°actor2ï¼Œæ‰§è¡Œäº†num=2;å’Œready=trueï¼Œçº¿ç¨‹1æ‰§è¡Œï¼Œè¿™å›è¿›å…¥ifåˆ†æ”¯ï¼Œç»“æœä¸º4ï¼›<br>æƒ…å†µ3ï¼šçº¿ç¨‹2å…ˆæ‰§è¡Œactor2ï¼Œåªæ‰§è¡Œnum=2; ä½†æ²¡æ¥å¾—åŠæ‰§è¡Œready=true; çº¿ç¨‹1æ‰§è¡Œï¼Œè¿˜æ˜¯è¿›å…¥elseåˆ†æ”¯ï¼Œç»“æœä¸º1ï¼›<br><strong>è¿˜æœ‰ä¸€ç§ç»“æœä¸º0</strong>ï¼›</p><p>è¿è¡Œæµ‹è¯•ï¼š</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mvn clean <span class="keyword">install</span></span><br><span class="line">java -jar <span class="keyword">target</span>/jcstress.jar</span><br></pre></td></tr></table></figure><h3 id="å°ç»“-2"><a href="#å°ç»“-2" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>ç¨‹åºä»£ç åœ¨æ‰§è¡Œå·¥ç¨‹ä¸­çš„ å…ˆåé¡ºåºï¼Œ<br>ç”±äºjavaåœ¨ ç¼–è¯‘æœŸä»¥åŠè¿è¡ŒæœŸçš„ä¼˜åŒ–ï¼ˆä¸ºäº†æé«˜æ‰§è¡Œæ•ˆç‡ï¼‰ï¼Œ<br>å¯¼è‡´äº† ä»£ç çš„æ‰§è¡Œé¡ºåº æœªå¿…å°±æ˜¯ å¼€å‘è€…ç¼–å†™ä»£ç çš„é¡ºåºã€‚ï¼ˆæœ€ç»ˆç¨‹åºçš„æ‰§è¡Œé¡ºåºå¯èƒ½è·Ÿç¼–å†™çš„é¡ºåºä¸ä¸€æ ·ï¼‰</p><p>æœ€åä¹Ÿå°±èƒ½å¤Ÿäº†è§£åˆ°å¹¶å‘ç¼–ç¨‹å½“ä¸­å­˜åœ¨çš„ä¸‰ä¸ªé—®é¢˜ï¼›<br>å¯è§æ€§ã€åŸå­æ€§ã€æœ‰åºæ€§ï¼›è¿™ä¸‰ä¸ªé—®é¢˜æœ‰å¯èƒ½ä¼šå¯¼è‡´å…±äº«æ•°æ®é”™ä¹±ï¼›<br>ä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼›</p><h2 id="è®¡ç®—æœºç»“æ„"><a href="#è®¡ç®—æœºç»“æ„" class="headerlink" title="è®¡ç®—æœºç»“æ„"></a>è®¡ç®—æœºç»“æ„</h2><p>ç¬¬äºŒç« ï¼šJavaå†…å­˜æ¨¡å‹ï¼ˆJMMï¼‰</p><p>åœ¨ä»‹ç» Javaå†…å­˜æ¨¡å‹ä¹‹å‰ï¼Œå…ˆæ¥çœ‹ä¸€ä¸‹åˆ°åº•ä»€ä¹ˆæ˜¯è®¡ç®—æœºå†…å­˜æ¨¡å‹ã€‚</p><p>å½“ä½¿ç”¨å¤šçº¿ç¨‹å¹¶å‘è®¿é—®å…±äº«èµ„æºçš„æ—¶å€™ï¼Œä¼šå‡ºç°å¯è§æ€§ã€åŸå­æ€§ã€æœ‰åºæ€§ç­‰çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼›<br>ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ä¸‰ç§é—®é¢˜ä»¥åŠå‡ºç°è¿™ä¸‰ç§é—®é¢˜å¦‚ä½•æ¥è¿›è¡Œè§£å†³å‘¢ï¼Ÿ</p><p>è¿™ä¹Ÿæ˜¯ç¬¬äºŒç« æ‰€éœ€è¦å­¦ä¹ çš„å†…å®¹ï¼›javaå†…å­˜æ¨¡å‹ï¼ˆJMMï¼‰ï¼›<br>åœ¨ç¬¬äºŒç« ä¸­åˆ†æˆä¸‰éƒ¨åˆ†æ¥è¿›è¡Œå­¦ä¹ ï¼›<br>é¦–å…ˆä»‹ç»è®¡ç®—æœºçš„ç»“æ„ï¼›é‚£ä¹ˆå°±éœ€è¦äº†è§£çŸ¥é“è®¡ç®—æœºæœ‰å“ªäº›é‡è¦çš„ç»„æˆéƒ¨åˆ†ï¼›<br>ç¬¬äºŒæ¥è¿›è¡Œå­¦ä¹ javaå†…å­˜æ¨¡å‹ï¼›éœ€è¦çŸ¥é“javaå†…å­˜æ¨¡å‹çš„æ¦‚å¿µå’Œä½œç”¨ï¼›<br>æœ€åæ¥è¿›è¡Œå­¦ä¹ javaå†…å­˜æ¨¡å‹å½“ä¸­çš„ä¸»å†…å­˜å’Œå·¥ä½œå†…å­˜ä¹‹é—´æ˜¯å¦‚ä½•è¿›è¡Œæ•°æ®äº¤äº’çš„ï¼›</p><h3 id="ç›®æ ‡-3"><a href="#ç›®æ ‡-3" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>å­¦ä¹ è®¡ç®—æœºçš„ä¸»è¦ç»„æˆ<br>å­¦ä¹ ç¼“å­˜çš„ä½œç”¨</p><h3 id="è®¡ç®—æœºç»“æ„ç®€ä»‹"><a href="#è®¡ç®—æœºç»“æ„ç®€ä»‹" class="headerlink" title="è®¡ç®—æœºç»“æ„ç®€ä»‹"></a>è®¡ç®—æœºç»“æ„ç®€ä»‹</h3><p>1945å¹´6æœˆï¼Œç¾ç± åŒˆç‰™åˆ© ç§‘å­¦å®¶ <strong>å†¯ è¯ºä¾æ›¼</strong> æœ€å…ˆæå‡ºæŠŠ <strong>è®¡ç®—æœº</strong>åˆ†ä½œ <strong>äº”éƒ¨åˆ†</strong>ï¼š<strong>è®¡ç®—å™¨</strong>ã€<strong>æ§åˆ¶å™¨</strong>ã€<strong>å­˜å‚¨å™¨</strong>ã€<strong>è¾“å…¥å’Œè¾“å‡ºè®¾å¤‡</strong>ã€‚<br>ç”±äºä»–å¯¹ ç°ä»£è®¡ç®—æœºæŠ€æœ¯çš„ç‰¹æ®Šè´¡çŒ®ï¼Œå› æ­¤ å†¯ è¯ºä¾æ›¼ åˆè¢«ç§°ä¸º â€œç°ä»£è®¡ç®—æœºä¹‹çˆ¶â€ã€‚  </p><blockquote><p>å†¯è¯ºä¾æ›¼ï¼Œæå‡ºè®¡ç®—æœºç”±äº”å¤§ç»„æˆéƒ¨åˆ†ï¼Œè¾“å…¥è®¾å¤‡ã€è¾“å‡ºè®¾å¤‡ã€å­˜å‚¨å™¨ã€æ§åˆ¶å™¨ã€è¿ç®—å™¨</p><ul><li>è¾“å…¥è®¾å¤‡ï¼šé”®ç›˜ã€é¼ æ ‡ã€æ‰«æä»ªã€etc.</li><li>è¾“å‡ºè®¾å¤‡ï¼šæ˜¾ç¤ºå™¨ã€æ‰“å°æœºã€etc.</li><li>å­˜å‚¨å™¨ï¼šå†…å­˜æ¡</li><li>æ§åˆ¶å™¨ï¼šæ§åˆ¶å™¨+è¿ç®—å™¨â€“â†’CPU</li><li>è¿ç®—å™¨ï¼šæ§åˆ¶å™¨+è¿ç®—å™¨â€“â†’CPU</li></ul></blockquote><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">--------------     -----------------        -------------</span><br><span class="line">|<span class="string"> è¾“å…¥è®¾å¤‡</span>|<span class="string"> ------â†’ </span>|<span class="string">    å­˜å‚¨å™¨    </span>|<span class="string"> -------â†’ </span>|<span class="string"> è¾“å‡ºè®¾å¤‡ </span>|</span><br><span class="line">------------       -----------------         ------------</span><br><span class="line">     â†‘                |<span class="string">  â†‘    </span>|<span class="string">  â†‘                 â†‘</span></span><br><span class="line"><span class="string">     </span>|<span class="string">                </span>|<span class="string">  </span>|<span class="string">    </span>|<span class="string">  </span>|<span class="string">                 </span>|</span><br><span class="line">     |<span class="string">       ---------</span>|<span class="string">--</span>|<span class="string">----</span>|<span class="string">--</span>|<span class="string">----------       </span>|</span><br><span class="line">     |<span class="string">       </span>|<span class="string">        </span>|<span class="string">  </span>|<span class="string">    </span>|<span class="string">  </span>|<span class="string">         </span>|<span class="string">       </span>|</span><br><span class="line">     |<span class="string">       </span>|<span class="string">        â†“  </span>|<span class="string">    â†“  </span>|<span class="string">         </span>|<span class="string">       </span>|</span><br><span class="line">     |<span class="string">       </span>|<span class="string">   ----------  -----------   </span>|<span class="string">       </span>|</span><br><span class="line">     |<span class="string">       </span>|<span class="string">   </span>|<span class="string"> è¿ç®—å™¨ </span>|<span class="string">   </span>|<span class="string"> æ§åˆ¶å™¨ </span>|<span class="string">----</span>|<span class="string">-------</span>|</span><br><span class="line">     |<span class="string">       </span>|<span class="string">   ----------  -----------   </span>|</span><br><span class="line">     |<span class="string">       </span>|<span class="string">                    </span>|<span class="string">        </span>|</span><br><span class="line">     --------|<span class="string">---------------------        </span>|</span><br><span class="line">             |<span class="string">                        CPU  </span>|</span><br><span class="line">             -------------------------------</span><br></pre></td></tr></table></figure><h3 id="CPU"><a href="#CPU" class="headerlink" title="CPU"></a>CPU</h3><p><strong>ä¸­å¤®å¤„ç†å™¨</strong>ï¼ˆ<strong>CPU</strong>ï¼Œ<strong>central processing unit</strong>ï¼‰æ˜¯<strong>è®¡ç®—æœº</strong>ç³»ç»Ÿçš„<strong>è¿ç®—</strong>å’Œ<strong>æ§åˆ¶æ ¸å¿ƒ</strong>ã€‚ï¼ˆç›¸å½“äºäººç±»çš„å¤§è„‘ï¼‰<br>è®¡ç®—æœºåœ¨æ‰§è¡Œç¨‹åºçš„æ—¶å€™ï¼Œæ¯æ¡æŒ‡ä»¤éƒ½æ˜¯åœ¨CPUä¸­æ‰§è¡Œçš„ï¼Œè€Œæ‰§è¡Œçš„æ—¶å€™ï¼Œåˆå…ä¸äº†è¦å’Œæ•°æ®æ‰“äº¤é“ã€‚<br>ç¨‹åºæœ€ç»ˆéƒ½ä¼šå˜æˆ <strong>æŒ‡ä»¤</strong> è®© <strong>CPU</strong> å»æ‰§è¡Œï¼Œå¤„ç†ç¨‹åºä¸­çš„æ•°æ®ã€‚</p><h3 id="å†…å­˜"><a href="#å†…å­˜" class="headerlink" title="å†…å­˜"></a>å†…å­˜</h3><p>è®¡ç®—æœºä¸­æ‰€æœ‰<strong>ç¨‹åº</strong>çš„<strong>è¿è¡Œ</strong> éƒ½æ˜¯åœ¨ <strong>å†…å­˜ä¸­</strong> è¿›è¡Œçš„ï¼Œ å†…å­˜çš„ä½œç”¨æ˜¯ ç”¨äºæš‚æ—¶å­˜æ”¾ CPUçš„è¿ç®—æ•°æ®ï¼Œä»¥åŠä¸ ç¡¬ç›˜ç­‰ å¤–éƒ¨å­˜å‚¨å™¨ äº¤æ¢çš„æ•°æ®ã€‚</p><p>CPUè‡ªäº§ç”Ÿä»¥æ¥ï¼Œåœ¨é€»è¾‘ç»“æ„ã€è¿è¡Œæ•ˆç‡ä»¥åŠåŠŸèƒ½å¤–å»¶ä¸Šå–å¾—äº†å·¨å¤§å‘å±•ã€‚<br>ä½†å—åˆ¶äº åˆ¶é€ å·¥è‰ºä»¥åŠæˆæœ¬ç­‰çš„é™åˆ¶ï¼Œè®¡ç®—æœºçš„å†…å­˜åå€’åœ¨è®¿é—®é€Ÿåº¦ä¸Šå¹¶æ²¡æœ‰å¤šå¤§çš„çªç ´ï¼Œ<br>å› æ­¤CPUçš„å¤„ç†é€Ÿåº¦å’Œå†…å­˜çš„è®¿é—®é€Ÿåº¦ä¹‹é—´çš„å·®è·è¶Šæ‹‰è¶Šå¤§ï¼Œé€šå¸¸è¿™ç§å·®è·å¯ä»¥è¾¾åˆ°ä¸Šåƒå€ï¼Œæç«¯æƒ…å†µä¸‹ç”šè‡³ä¼šåœ¨ä¸Šä¸‡å€ä»¥ä¸Šã€‚<br>è¿™å°±å¯¼è‡´CPUæ¯æ¬¡æ“ä½œå†…å­˜éƒ½è¦è€—è´¹å¾ˆå¤šç­‰å¾…æ—¶é—´ã€‚<br>å†…å­˜çš„è¯»å†™é€Ÿåº¦æˆä¸ºäº†è®¡ç®—æœºè¿è¡Œçš„ç“¶é¢ˆã€‚</p><p>ï¼ˆç¨‹åºéƒ½æ˜¯åœ¨å†…å­˜ä¸­è¿è¡Œçš„ï¼Œå†…å­˜ ä¼šä¿å­˜ ç¨‹åºè¿è¡Œæ—¶çš„æ•°æ®ï¼Œä¾›CPUå¤„ç†ï¼›CPUè¿è¡Œçš„æ—¶å€™ï¼Œæ˜¯éœ€è¦åˆ°å†…å­˜å½“ä¸­è¯»å–æ•°æ®è¿›è¡Œç›¸å…³å¤„ç†çš„ï¼›ï¼‰</p><h3 id="ç¼“å­˜"><a href="#ç¼“å­˜" class="headerlink" title="ç¼“å­˜"></a>ç¼“å­˜</h3><p>ç”±äºCPUå’Œå†…å­˜ä¸¤è¾¹é€Ÿåº¦ ä¸¥é‡çš„ä¸å¯¹ç­‰ï¼Œä¼šå¯¼è‡´CPUèµ„æºå—åˆ°å¤§é‡çš„é™åˆ¶ï¼Œé™ä½CPUæ•´ä½“çš„ååé‡ï¼Œäºæ˜¯å°±æœ‰äº†åœ¨CPUä¸ä¸»å†…å­˜ä¹‹é—´å¢åŠ ç¼“å­˜çš„è®¾è®¡ï¼Œç°åœ¨ç¼“å­˜çš„æ•°é‡éƒ½å¯ä»¥å¢åŠ åˆ°3çº§äº†ï¼Œæœ€é è¿‘CPUçš„ç¼“å­˜ç§°ä¸ºL1ï¼Œç„¶åä¾æ¬¡æ˜¯L2ï¼ŒL3å’Œä¸»å†…å­˜ï¼ŒCPUç¼“å­˜æ¨¡å‹å¦‚å›¾ ä¸‹å›¾æ‰€ç¤ºã€‚  </p><p>CPUè‡ªä»äº§ç”Ÿä»¥æ¥ï¼Œåœ¨è¿è¡Œé€Ÿåº¦è¿è¡Œæ•ˆç‡ä¸Šå¾—åˆ°äº†å·¨å¤§çš„å‘å±•ï¼›<br>ä½†æ˜¯å†…å­˜ç”±äºåˆ¶é€ å·¥è‰ºåˆ¶é€ æˆæœ¬çš„æ§åˆ¶åœ¨è®¿é—®é€Ÿåº¦ä¸Šé¢å¹¶æ²¡æœ‰å¤šå¤§çš„æå‡ã€‚<br>å› æ­¤CPUçš„è¿è¡Œé€Ÿåº¦å’Œå†…å­˜çš„è¯»å†™é€Ÿåº¦å…¶å·®è·å°±å°†å˜å¾—è¶Šæ¥è¶Šå¤§ï¼›<br>è¿™æ ·ä¹Ÿå°±å¯¼è‡´äº†CPUåœ¨è¿ç®—çš„æ—¶å€™è¦èŠ±ä¸Šå¾ˆé•¿çš„æ—¶é—´å»ç­‰å¾…å†…å­˜çš„è¯»å–ï¼›<br>é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´å†…å­˜çš„è¯»å†™é€Ÿåº¦æˆä¸ºäº†è®¡ç®—æœºè¿è¡Œçš„ä¸€ä¸ªç“¶é¢ˆï¼›<br>é‚£ä¹ˆå¦‚ä½•æ¥è§£å†³è¿™ä¸ªä¸¤é¢é€Ÿåº¦ä¸å¯¹ç­‰çš„é—®é¢˜ï¼Ÿ<br>äºæ˜¯äººä»¬å°±åœ¨CPUä¸ä¸»å†…å­˜ä¹‹é—´å¢åŠ äº†ç¼“å­˜çš„è®¾è®¡ï¼›</p><p>æ‰“å¼€ä»»åŠ¡ç®¡ç†å™¨[CTRL + ALT + DEL]ï¼Œç‚¹å¼€[æ€§ èƒ½]èœå•æ ï¼Œå¯ä»¥çœ‹åˆ°ï¼›</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">å†…æ ¸ï¼š      <span class="number">6</span>             # æˆ‘ç”µè„‘åªæœ‰<span class="number">4</span></span><br><span class="line">é€»è¾‘å¤„ç†å™¨: <span class="number">12</span>            # æˆ‘ç”µè„‘åªæœ‰<span class="number">8</span></span><br><span class="line">è™šæ‹ŸåŒ–ï¼š    å·²å¯ç”¨</span><br><span class="line">L1ç¼“å­˜ï¼š    <span class="number">384</span> KB</span><br><span class="line">L2ç¼“å­˜ï¼š    <span class="number">1.5</span> MB</span><br><span class="line">L3ç¼“å­˜ï¼š    <span class="number">12.0</span> MB</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ç¼“å­˜L1ç¼“å­˜æœ€å°ï¼›L2ç¼“å­˜è¾ƒä¹‹L1ç¼“å­˜è¾ƒå¤§ï¼›L3ç¼“å­˜æœ€å¤§ï¼›<br>CPUçš„ç¼“å­˜æ˜¯å†…ç½®åœ¨CPUå½“ä¸­çš„ï¼›<br>é¦–å…ˆç¦»CPUæœ€è¿‘çš„æ˜¯L1ç¼“å­˜ï¼›å…¶ç©ºé—´æ¯”è¾ƒå°ä½†æ˜¯é€Ÿåº¦æ¯”è¾ƒå¿«ï¼›ä»·æ ¼ä¹Ÿæ¯”è¾ƒæ˜‚è´µï¼›<br>L2ç¼“å­˜ç©ºé—´ç¨å¤§ï¼›é€Ÿåº¦ç¨æ…¢äº›ï¼›ä»·æ ¼çš„è¯ä¹Ÿä¼šæ›´åŠ ä¾¿å®œäº›ï¼›<br>L3ç¼“å­˜ç©ºé—´æ›´å¤§ï¼›é€Ÿåº¦è¾ƒä¹‹å‰ä¸¤è€…æ›´æ…¢ï¼Œä»·æ ¼ä¹Ÿæ›´ä¾¿å®œäº›ï¼›</p><p>çœ‹å›¾è¯´è¯ï¼š<br>CPU åœ¨æ“ä½œå†…å­˜çš„æ—¶å€™æœ‰59.4 ns(çº³ç§’)çš„ä¸€ä¸ªå»¶è¿Ÿ(Latency)<br>CPU åœ¨æ“ä½œL1ç¼“å­˜çš„æ—¶å€™å¤§çº¦ 1.2 ns(çº³ç§’)<br>CPU åœ¨æ“ä½œL2ç¼“å­˜çš„æ—¶å€™å¤§çº¦ 5.5 ns(çº³ç§’)<br>CPU åœ¨æ“ä½œL3ç¼“å­˜çš„æ—¶å€™å¤§çº¦ 15.9 ns(çº³ç§’)</p><p>ä»ä¸­å¯ä»¥çœ‹åˆ°çš„æ˜¯å†…å­˜çš„é€Ÿåº¦è¦æ¯”ç¼“å­˜çš„é€Ÿåº¦æ…¢å¾ˆå¤šï¼›<br>å½“CPUæœ‰äº†ç¼“å­˜ä¹‹åï¼Œå…¶æ•°æ®æ˜¯å¦‚ä½•è¿›è¡Œå¤„ç†çš„å‘¢ï¼Ÿ<br>é¦–å…ˆCPUè¿ç®—çš„æ—¶å€™éœ€è¦æ•°æ®ï¼Œé‚£ä¹ˆCPUç›´æ¥å»ä¸€çº§ç¼“å­˜L1Cacheå½“ä¸­æ‰¾è¦æŸ¥æ‰¾çš„æ•°æ®çœ‹æ˜¯å¦èƒ½å¤ŸæŸ¥æ‰¾å¾—åˆ°ï¼›<br>å¦‚æœå‘½ä¸­äº†ä¸€çº§ç¼“å­˜åˆ™ç›´æ¥ä»ä¸€çº§ç¼“å­˜å½“ä¸­è¿›è¡Œè¯»å–æ•°æ®åˆ°CPUï¼Œå¤„ç†å®Œæˆä¹‹åå°±ä¼šå°†CPUå½“ä¸­å¤„ç†åçš„ç»“æœåˆæ¥ç€æ”¾å›åˆ°ç¼“å­˜L1ã€L2ã€L3ä¸­ä»¥åŠå†…å­˜ä¸­ï¼›<br>é‚£ä¹ˆå¦‚æœCPUéœ€è¦æ•°æ®æ—¶ï¼Œä½†æ˜¯æ­¤æ—¶å¹¶æ²¡æœ‰åœ¨ä¸€çº§ç¼“å­˜L1 Cacheå½“ä¸­å‘½ä¸­ç¼“å­˜ï¼›<br>é‚£ä¹ˆè¿™ä¸ªæ—¶å€™CPUå°±ä¼šå»è¿›è¡Œè¯»å–äºŒçº§ç¼“å­˜L2 Cacheå½“ä¸­æ‰€éœ€è¦æŸ¥æ‰¾çš„æ•°æ®ï¼›<br>å¦‚æœäºŒçº§ç¼“å­˜L2 Cacheå½“ä¸­ä¹Ÿæ²¡æœ‰æ‰¾åˆ°æ‰€éœ€è¦æŸ¥æ‰¾å¾—åˆ°çš„æ•°æ®ï¼Œå³æ²¡æœ‰å‘½ä¸­ç¼“å­˜ï¼›<br>é‚£ä¹ˆè¿™ä¸ªæ—¶å€™CPUå°±ä¼šå»è¿›è¡Œè¯»å–ä¸‰çº§ç¼“å­˜L3 Cacheå½“ä¸­æ‰€éœ€è¦æŸ¥æ‰¾çš„æ•°æ®ï¼›<br>å¦‚æœæ­¤æ—¶ä¸‰çº§ç¼“å­˜L3 Cacheå½“ä¸­ä¹Ÿæ²¡æœ‰æ‰¾åˆ°æ‰€éœ€è¦æŸ¥æ‰¾å¾—åˆ°çš„æ•°æ®ï¼Œå³ä¹Ÿæ²¡æœ‰å‘½ä¸­ç¼“å­˜ï¼›<br>é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±ä¼šå»æŸ¥æ‰¾å†…å­˜Memoryï¼›ä»å†…å­˜å½“ä¸­æ‹¿å–åˆ°ç›¸åº”çš„æ‰€éœ€è¦æŸ¥æ‰¾çš„æ•°æ®ä¹‹åï¼Œåœ¨CPUä¸­è¿è¡Œè®¡ç®—ä¹‹åï¼›å¦å¤–ç›¸åº”çš„å…¶å¤„ç†ç»“æœä¹Ÿä¼šä¿å­˜åœ¨ç¼“å­˜å½“ä¸­ï¼›</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">                    å•CPUåŒæ ¸çš„ç¼“å­˜ç»“æ„</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">|<span class="string">--------------------------------------------</span>|</span><br><span class="line">|<span class="string">      -----------          -------------    </span>|</span><br><span class="line">|<span class="string">      </span>|<span class="string">  Core1  </span>|<span class="string">           </span>|<span class="string">  Core 2  </span>|<span class="string">    </span>|</span><br><span class="line">|<span class="string">      -----------          -------------    </span>|</span><br><span class="line">|<span class="string">           â†“                     â†“          </span>|</span><br><span class="line">|<span class="string">      -------------         -------------   </span>|</span><br><span class="line">|<span class="string">      </span>|<span class="string">  L1 Cache </span>|<span class="string">         </span>|<span class="string"> L1 Cache </span>|<span class="string">    </span>|</span><br><span class="line">|<span class="string">      -------------         -------------   </span>|</span><br><span class="line">|<span class="string">           â†“                    â†“           </span>|</span><br><span class="line">|<span class="string">      -------------         -------------   </span>|</span><br><span class="line">|<span class="string">      </span>|<span class="string">  L2 Cache </span>|<span class="string">         </span>|<span class="string"> L2 Cache </span>|<span class="string">    </span>|</span><br><span class="line">|<span class="string">      -------------         -------------   </span>|</span><br><span class="line">|<span class="string">           â†“                    â†“           </span>|</span><br><span class="line">|<span class="string">     ------------------------------------   </span>|</span><br><span class="line">|<span class="string">      </span>|<span class="string">          L3   Cache             </span>|<span class="string">   </span>|</span><br><span class="line">|<span class="string">     ------------------------------------   </span>|</span><br><span class="line">|<span class="string">                       </span>|<span class="string">                    </span>|</span><br><span class="line">|<span class="string">-----------------------</span>|<span class="string">---------------------</span></span><br><span class="line"><span class="string">                        â†“</span></span><br><span class="line"><span class="string">     ------------------------------------</span></span><br><span class="line"><span class="string">     </span>|<span class="string">              Memory              </span>|</span><br><span class="line">     ------------------------------------</span><br></pre></td></tr></table></figure><p><strong>CPU Cache</strong> åˆ†æˆäº†ä¸‰ä¸ªçº§åˆ«ï¼š<strong>L1ã€L2ã€L3ã€‚</strong><br><strong>çº§åˆ«è¶Šå°è¶Šæ¥è¿‘CPU</strong>ï¼Œ<strong>é€Ÿåº¦ä¹Ÿæ›´å¿«</strong>ï¼ŒåŒæ—¶ä¹Ÿä»£è¡¨ç€<strong>å®¹é‡è¶Šå°</strong>ã€‚</p><p><strong>1.</strong> <strong>L1 Cache</strong>æ˜¯<strong>æœ€æ¥è¿‘CPU</strong>çš„ï¼Œå®ƒ<strong>å®¹é‡æœ€å°</strong>ï¼Œä¾‹å¦‚32kï¼Œ<strong>é€Ÿåº¦æœ€å¿«</strong>ï¼Œæ¯ä¸ªæ ¸ä¸Šéƒ½æœ‰ä¸€ä¸ªL1 Cacheã€‚<br><strong>2.</strong> <strong>L2 Cache</strong> <strong>æ›´å¤§</strong>ä¸€äº›ï¼Œä¾‹å¦‚256kï¼Œ<strong>é€Ÿåº¦è¦æ…¢</strong>ä¸€äº›ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ¯ä¸ªæ ¸ä¸Šéƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„L2 Cacheã€‚<br><strong>3.</strong> <strong>L3 Cache</strong>æ˜¯ä¸‰çº§ç¼“å­˜ä¸­<strong>æœ€å¤§</strong>çš„ä¸€çº§ï¼Œä¾‹å¦‚12MBï¼ŒåŒæ—¶ä¹Ÿæ˜¯ç¼“å­˜ä¸­<strong>æœ€æ…¢</strong>çš„ä¸€çº§ï¼Œåœ¨åŒä¸€ä¸ªCPUæ’æ§½ä¹‹é—´çš„æ ¸å…±äº«ä¸€ä¸ªL3 Cacheã€‚</p><p><strong>Cacheçš„å‡ºç°</strong>æ˜¯ä¸ºäº†<strong>è§£å†³ CPUç›´æ¥è®¿é—®å†…å­˜æ•ˆç‡ä½ä¸‹é—®é¢˜çš„</strong>ï¼Œ<br>ç¨‹åºåœ¨è¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼ŒCPUæ¥æ”¶åˆ°æŒ‡ä»¤åï¼Œ<br>å®ƒä¼šæœ€å…ˆå‘CPUä¸­çš„ä¸€çº§ç¼“å­˜ï¼ˆL1 Cacheï¼‰å»å¯»æ‰¾ç›¸å…³çš„æ•°æ®ï¼Œ<br>å¦‚æœå‘½ä¸­ç¼“å­˜ï¼ŒCPUè¿›è¡Œè®¡ç®—æ—¶å°±å¯ä»¥ç›´æ¥å¯¹CPU Cacheä¸­çš„æ•°æ®è¿›è¡Œè¯»å–å’Œå†™å…¥ï¼Œ<br>å½“è¿ç®—ç»“æŸä¹‹åï¼Œå†å°†CPU Cacheä¸­çš„æœ€æ–°æ•°æ®åˆ·æ–°åˆ°ä¸»å†…å­˜å½“ä¸­ï¼Œ<br><strong>CPU</strong> é€šè¿‡<strong>ç›´æ¥è®¿é—®Cache</strong>çš„æ–¹å¼ <strong>ä»£æ›¿</strong> <strong>ç›´æ¥è®¿é—®ä¸»å†…å­˜</strong>çš„æ–¹å¼ æå¤§åœ°<strong>æé«˜</strong>äº† <strong>CPUçš„ååèƒ½åŠ›</strong>ã€‚  </p><p>ä½†æ˜¯ç”±äº <strong>ä¸€çº§ç¼“å­˜ï¼ˆL1 Cacheï¼‰</strong> <strong>å®¹é‡è¾ƒå°</strong>ï¼Œ<br>æ‰€ä»¥ä¸å¯èƒ½æ¯æ¬¡éƒ½å‘½ä¸­ï¼Œ<br>è¿™æ—¶ <strong>CPU</strong> ä¼šç»§ç»­å‘ä¸‹ä¸€çº§çš„<strong>äºŒçº§ç¼“å­˜ï¼ˆL2 Cacheï¼‰</strong> å¯»æ‰¾ï¼Œ<br>åŒæ ·çš„é“ç†ï¼Œå½“æ‰€éœ€è¦çš„æ•°æ®åœ¨äºŒçº§ç¼“å­˜ä¸­ä¹Ÿæ²¡æœ‰çš„è¯ï¼Œ<br>ä¼šç»§ç»­è½¬å‘<strong>L3 Cache</strong>ã€<strong>å†…å­˜ï¼ˆä¸»å­˜ï¼‰</strong>å’Œ<strong>ç¡¬ç›˜</strong>ã€‚  </p><h3 id="å°ç»“-3"><a href="#å°ç»“-3" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>è®¡ç®—æœºçš„ä¸»è¦ç»„æˆ <strong>CPU</strong>ã€<strong>å†…å­˜</strong>ã€<strong>è¾“å…¥è®¾å¤‡</strong>ã€<strong>è¾“å‡ºè®¾å¤‡</strong></p><blockquote><p><strong>CPU</strong>ï¼šè®¡ç®—æœºçš„æ ¸å¿ƒï¼›ç”¨æ¥æ§åˆ¶å’Œå¤„ç†çš„<br><strong>å†…å­˜</strong>ï¼šç”¨æ¥ä¿å­˜æ­£åœ¨è¿è¡Œçš„è¿™äº›ç¨‹åºçš„æ•°æ®ï¼›<br><strong>è¾“å…¥è®¾å¤‡</strong>ï¼š<br><strong>è¾“å‡ºè®¾å¤‡</strong>ï¼š<br><strong>ç¼“å­˜</strong>ï¼š<br>  CPUçš„è¿ç®—é€Ÿåº¦æ¯”å†…å­˜çš„è®¿é—®é€Ÿåº¦å¿«å¾ˆå¤šï¼›<br>  é‚£ä¹ˆå¦‚æœCPUç›´æ¥ä»å†…å­˜å½“ä¸­è¿›è¡Œè¯»å–æ•°æ®è¿›è¡Œç›¸å…³å¤„ç†çš„è¯ï¼›<br>  åˆ™å†…å­˜è¯»å–æ—¶é—´èŠ±è´¹å¼€é”€å¤§å°±ä¼šå¯¼è‡´æ‹–ç´¯CPUçš„è¿ç®—é€Ÿåº¦ï¼›<br>  æ‰€ä»¥åœ¨CPUä¸å†…å­˜ä¹‹é—´å¢åŠ äº†ç¼“å­˜ï¼›<br>  ç¼“å­˜çš„è¯»å†™é€Ÿåº¦è¾ƒä¹‹å†…å­˜çš„è¯»å†™é€Ÿåº¦è¦å¿«å¾ˆå¤šï¼›<br>  å› æ­¤å¯ä»¥è®©CPUçš„æ‰§è¡Œé€Ÿåº¦é«˜ä¸€ç‚¹ï¼›</p></blockquote><p><strong>1.</strong> è¯´å‡ºè®¡ç®—æœºçš„ä¸»è¦ç»„æˆ</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CPU</span><br><span class="line">å†…å­˜</span><br><span class="line">ç¼“å­˜</span><br></pre></td></tr></table></figure><p><strong>2.</strong> ä¸ºä»€ä¹ˆä¼šå‡ºç°ç¼“å­˜ï¼Ÿ</p><p>ç¼“å­˜æ˜¯ä¸ºäº†è§£å†³CPUç›´æ¥è®¿é—®å†…å­˜æ•ˆç‡ä½ä¸‹é—®é¢˜çš„</p><h2 id="javaå†…å­˜æ¨¡å‹"><a href="#javaå†…å­˜æ¨¡å‹" class="headerlink" title="javaå†…å­˜æ¨¡å‹"></a>javaå†…å­˜æ¨¡å‹</h2><h3 id="ç›®æ ‡-4"><a href="#ç›®æ ‡-4" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>å…¨ç§°ï¼š<strong>Java Memory Model</strong>(ç¿»è¯‘æˆä¸­æ–‡åä¸º:<strong>Javaå†…å­˜æ¨¡å‹</strong>ï¼›ä¸€èˆ¬ç®€ç§°ä¸º<strong>JMM</strong>)<br><strong>Java å†…å­˜æ¨¡å‹</strong> <strong>JMM</strong>åƒä¸‡ä¸è¦å’Œ<strong>Javaå†…å­˜ç»“æ„</strong>æ··æ·†ï¼›<br>ä»¥å‰å­¦ä¹ Javaçš„æ—¶å€™çŸ¥é“<strong>JVM</strong>ä¼š<strong>å¯¹å†…å­˜</strong>è¿›è¡Œä¸€ä¸ª<strong>åˆ’åˆ†</strong>ï¼›ä¼šåˆ’åˆ†æˆ<strong>æ ˆ</strong>ã€<strong>å †</strong>ã€<strong>æ–¹æ³•åŒº</strong>ã€etc.é‚£ä¹ˆè¿™ä¸ªæ˜¯æŒ‡çš„æ˜¯<strong>Javaå†…å­˜ç»“æ„</strong>ï¼›<br>é‚£ä¹ˆ<strong>javaå†…å­˜æ¨¡å‹</strong> <strong>JMM</strong>åˆ™<strong>æ˜¯ä¸€å¥—è§„èŒƒ</strong>ï¼›å…³äº<strong>Javaå†…å­˜æ¨¡å‹</strong>çš„æƒå¨è§£é‡Šå¯ä»¥æŸ¥çœ‹ç½‘å€ï¼›ï¼ˆOracleæä¾›çš„çº¯è‹±æ–‡ç‰ˆæœ¬ï¼Œå³Javaå†…å­˜æ¨¡å‹çš„è¯¦ç»†çš„è¯´æ˜æ–‡æ¡£ï¼Œå…¶å®å³ä¸€å¥—è§„èŒƒï¼Œé‚£ä¹ˆè¿™å¥—è§„èŒƒä¸»è¦æè¿°äº†ä¸¤ä¸ªå…³é”®å­—ï¼›ä¸€ä¸ªæ˜¯synchronizedï¼›ä¸€ä¸ªæ˜¯volatileï¼›ï¼‰</p><p>å­¦ä¹ javaå†…å­˜æ¨¡å‹çš„æ¦‚å¿µå’Œä½œç”¨<br>javaå†…å­˜æ¨¡å‹ï¼ˆå³ java Memory Modelï¼Œç®€ç§°JMMï¼‰ã€‚<br>ï¼ˆjavaå†…å­˜æ¨¡å‹ å’Œ ä»¥å‰å­¦ä¹ çš„æ ˆã€å †ã€æ–¹æ³•åŒºã€åŸç©ºé—´è¿™æ ·çš„javaå†…å­˜ç»“æ„æ˜¯ä¸ä¸€æ ·çš„ï¼‰<br>å¾ˆå¤šå°ä¼™ä¼´ å°† â€œjavaå†…å­˜ç»“æ„â€ ä¸ â€œjavaå†…å­˜æ¨¡å‹â€æ··æ·†ã€‚<br>å…³äº â€œjavaå†…å­˜æ¨¡å‹â€çš„æƒå¨è§£é‡Šï¼Œè¯·å‚è€ƒ <code>https://download.oracle.com/otn-pub/jcp/memory_model-1.0-pfd-spec-oth-JSpec/memory_model-1_0-pfd-spec.pdf</code>ã€‚</p><p>ä¸ºä»€ä¹ˆä¼šå‡ºç°Javaå†…å­˜æ¨¡å‹ï¼›<br>Javaæ˜¯ä¸€é—¨è·¨å¹³å°çš„è¯­è¨€ï¼›å¯ä»¥åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸Šè¿è¡Œï¼›<br>é‚£ä¹ˆå…¶åº•å±‚æ˜¯ä¾èµ–JVMè™šæ‹Ÿæœºæ¥è¿›è¡Œå®ç°çš„è·¨å¹³å°è¿™ä¸€ç‰¹æ€§ï¼›<br>æ¯ä¸€ä¸ªå¹³å°éƒ½æœ‰å…¶å¯¹åº”çš„ä¸€ä¸ªè™šæ‹Ÿæœºï¼›<br>é‚£ä¹ˆæ­¤æ—¶Javaç¨‹åºå°±å¯ä»¥è·‘åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸Šï¼›<br>é‚£ä¹ˆjavaå†…å­˜æ¨¡å‹æ˜¯javaè™šæ‹Ÿæœºè§„èŒƒå½“ä¸­çš„ä¸€éƒ¨åˆ†ï¼›<br>å®ƒä¸»è¦æ˜¯ç”¨æ¥å±è”½javaè¿è¡Œåœ¨ä¸åŒæ“ä½œç³»ç»Ÿä¸Šçš„ä¸€äº›ç»†èŠ‚é—®é¢˜ï¼›<br>é‚£ä¹ˆjavaç¨‹åºä»…ä»…åªéœ€è¦å…³æ³¨javaå†…å­˜æ¨¡å‹å³å¯ï¼›</p><p>Java å†…å­˜æ¨¡å‹ï¼Œæ˜¯ Javaè™šæ‹Ÿæœºè§„èŒƒ ä¸­ æ‰€å®šä¹‰çš„ä¸€ç§å†…å­˜æ¨¡å‹ï¼ŒJavaå†…å­˜æ¨¡å‹æ˜¯æ ‡å‡†åŒ–çš„ï¼Œå±è”½æ‰äº†åº•å±‚ä¸åŒè®¡ç®—æœºçš„åŒºåˆ«ã€‚<br>JMMæ˜¯ä¸€å¥—è§„èŒƒï¼Œ æè¿°äº† Javaç¨‹åºä¸­ å„ç§å˜é‡ï¼ˆçº¿ç¨‹å…±äº«å˜é‡ï¼‰çš„è®¿é—®è§„åˆ™ï¼Œä»¥åŠåœ¨ JVMä¸­ å°†å˜é‡ å­˜å‚¨åˆ° å†…å­˜å’Œä»å†…å­˜ä¸­è¯»å–å˜é‡ è¿™æ ·çš„åº•å±‚ç»†èŠ‚ï¼Œå…·ä½“å¦‚ä¸‹ã€‚</p><p>ï¼ˆå­¦ä¹ ä¸»å†…å­˜å’Œå·¥ä½œå†…å­˜ï¼Œä»¥åŠå®ƒä»¬æ˜¯å¦‚ä½•æ“ä½œè¿™äº›å…±äº«å˜é‡çš„ï¼‰<br>Javaå†…å­˜æ¨¡å‹ä¸»è¦åˆ†ä½œä¸¤éƒ¨åˆ†æ¥çœ‹ï¼›<br>ä¸€éƒ¨åˆ†å«åšä¸»å†…å­˜ï¼›<br>å¦ä¸€éƒ¨åˆ†å«åšå·¥ä½œå†…å­˜ï¼›<br>é¦–å…ˆæ¥çœ‹ä¸»å†…å­˜ï¼Œjavaå½“ä¸­çš„å…±äº«å˜é‡ï¼›éƒ½æ”¾åœ¨ä¸»å†…å­˜å½“ä¸­ï¼›<br>æ¯”å¦‚è¯´ç±»çš„æˆå‘˜å˜é‡ä¹Ÿç§°ä¹‹ä¸ºå®ä¾‹å˜é‡ï¼›è¿˜æœ‰é™æ€çš„æˆå‘˜å˜é‡ï¼›æˆ–è€…è¯´å«ç±»å˜é‡ï¼›éƒ½æ˜¯å­˜å‚¨åœ¨ä¸»å†…å­˜å½“ä¸­çš„ï¼›<br>é‚£ä¹ˆæ¯ä¸€ä¸ªçº¿ç¨‹éƒ½å¯ä»¥æ¥è¿›è¡Œè®¿é—®ä¸»å†…å­˜ï¼›<br>æ¥ç€æ¥çœ‹ç¬¬äºŒéƒ¨åˆ†å·¥ä½œå†…å­˜ï¼›æ¯ä¸€ä¸ªçº¿ç¨‹éƒ½æœ‰å…¶è‡ªå·±çš„å·¥ä½œå†…å­˜ï¼›<br>å½“çº¿ç¨‹è¦æ‰§è¡Œä»£ç çš„æ—¶å€™ï¼Œå°±å¿…é¡»åœ¨å·¥ä½œå†…å­˜å½“ä¸­æ¥è¿›è¡Œå¤„ç†å®Œæˆï¼›</p><p>å‡è®¾ç°åœ¨ä¸€ä¸ªçº¿ç¨‹Aè¦è®¿é—®ä¸»å†…å­˜å½“ä¸­çš„ä¸€ä¸ªå…±äº«å˜é‡Xï¼›<br>è¦å¯¹è¯¥å…±äº«å˜é‡Xè¿›è¡Œæ“ä½œï¼›<br>é‚£ä¹ˆçº¿ç¨‹æ˜¯ä¸èƒ½å¤Ÿåœ¨ä¸»å†…å­˜å½“ä¸­æ¥è¿›è¡Œç›´æ¥æ“ä½œå…±äº«å˜é‡Xçš„ï¼›<br>å³è¯¥çº¿ç¨‹åªèƒ½å¤Ÿå°†è¯¥å…±äº«å˜é‡å…ˆè¿›è¡Œå¤åˆ¶ä¸€ä»½æ”¾åˆ°çº¿ç¨‹è‡ªå·±çš„å·¥ä½œå†…å­˜å½“ä¸­ï¼Œ<br>ç„¶åæ‰å»è¿›è¡Œæ•°æ®çš„ç›¸å…³å¤„ç†ï¼›<br>å½“çº¿ç¨‹åœ¨å…¶å·¥ä½œå†…å­˜å¯¹è¯¥å¤åˆ¶è¿‡æ¥çš„å…±äº«å˜é‡ç›¸åº”å¤„ç†å®Œæˆä¹‹åå†å°†å¤„ç†å®Œæˆçš„ç»“æœåŒæ­¥å›ä¸»å†…å­˜å½“ä¸­å»ï¼›</p><p>å‡è®¾çº¿ç¨‹Aæƒ³è¦å¯¹å…±äº«å˜é‡xæ“ä½œï¼›<br>æ­¤æ—¶å…±äº«å˜é‡xçš„å–å€¼åœ¨ä¸»å†…å­˜å½“ä¸­ä¸º int x = 10; è¿™æ ·ä¸€ä¸ªå–å€¼ï¼›<br>é‚£ä¹ˆé¦–å…ˆçº¿ç¨‹Aéœ€è¦å°†è¯¥å…±äº«å˜é‡xçš„å–å€¼ä»ä¸»å†…å­˜å½“ä¸­è¿›è¡Œæ‹·è´ä¸€ä»½æ”¾åˆ°è‡ªå·±çš„å·¥ä½œå†…å­˜å½“ä¸­å»ï¼›<br>ç„¶åè¿›è¡Œç›¸åº”å¤„ç†ï¼Œæ¯”æ–¹è¯´è¿™é‡Œå¤„ç†ä¸ºé‡æ–°èµ‹å€¼ä¸º9ï¼Œ<br>å³int x = 9;é‚£ä¹ˆå‡è®¾å¤„ç†å®Œæˆä¹‹åï¼Œ<br>é‚£ä¹ˆè¿™ä¸ªæ—¶å€™è¯¥çº¿ç¨‹Aå°±éœ€è¦å°†å¯¹è¯¥å…±äº«å˜é‡é‡æ–°èµ‹å€¼çš„ç»“æœå³9éœ€è¦åŒæ­¥å›ä¸»å†…å­˜å½“ä¸­ï¼›<br>é‚£ä¹ˆå…¶ä»–çš„çº¿ç¨‹ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œ<br>ä¹Ÿæ˜¯å…ˆè¦è¿›è¡Œå°†å…±äº«å˜é‡å…ˆè¦ä»ä¸»å†…å­˜å½“ä¸­è¿›è¡Œæ‹·è´ä¸€ä»½æ”¾åˆ°è‡ªå·±çš„å·¥ä½œå†…å­˜å½“ä¸­å»ï¼›<br>ç„¶åå†å»è¿›è¡Œæ“ä½œfor exampleï¼šint x = 8;<br>æœ€åç›¸åº”æ“ä½œï¼ˆèµ‹å€¼ï¼‰å®Œæˆä¹‹åå†ç”±çº¿ç¨‹ä»å·¥ä½œå†…å­˜åŒæ­¥è‡³ä¸»å†…å­˜å½“ä¸­å»ï¼›</p><ul><li><strong>ä¸»å†…å­˜</strong><ul><li><strong>ä¸»å†…å­˜</strong>æ˜¯ æ‰€æœ‰<strong>çº¿ç¨‹</strong>éƒ½<strong>å…±äº«</strong>çš„ï¼Œéƒ½èƒ½è®¿é—®çš„ã€‚æ‰€æœ‰çš„<strong>å…±äº«å˜é‡</strong>éƒ½<strong>å­˜å‚¨äºä¸»å†…å­˜</strong>ã€‚</li><li>å…±äº«å˜é‡ä¸»è¦åŒ…æ‹¬ç±»å½“ä¸­çš„æˆå‘˜å˜é‡ï¼Œä»¥åŠä¸€äº›é™æ€å˜é‡ç­‰ï¼›çº¿ç¨‹çš„å±€éƒ¨å˜é‡æ˜¯ä¸ä¼šå‡ºç°åœ¨ä¸»å†…å­˜å½“ä¸­çš„ï¼›å› ä¸ºçº¿ç¨‹çš„å±€éƒ¨å˜é‡åªèƒ½å¤Ÿè‡ªå·±è¯¥çº¿ç¨‹è¿›è¡Œä½¿ç”¨ï¼›</li></ul></li><li><strong>å·¥ä½œå†…å­˜</strong><ul><li>æ¯ä¸€ä¸ªçº¿ç¨‹æœ‰è‡ªå·±çš„<strong>å·¥ä½œå†…å­˜</strong>ï¼Œå·¥ä½œå†…å­˜åªå­˜å‚¨ è¯¥çº¿ç¨‹ å¯¹<strong>å…±äº«å˜é‡çš„å‰¯æœ¬</strong>ã€‚ çº¿ç¨‹å¯¹å˜é‡çš„æ‰€æœ‰çš„æ“ä½œï¼ˆ<strong>è¯»ã€å–</strong>ï¼‰éƒ½å¿…é¡»åœ¨<strong>å·¥ä½œå†…å­˜</strong>ä¸­å®Œæˆï¼Œè€Œ<strong>ä¸èƒ½ç›´æ¥è¯»å†™ä¸»å†…å­˜ä¸­çš„å˜é‡</strong>ï¼Œä¸åŒçº¿ç¨‹ä¹‹é—´ä¹Ÿ<strong>ä¸èƒ½ç›´æ¥è®¿é—®</strong> <strong>å¯¹æ–¹å·¥ä½œå†…å­˜ä¸­çš„ å˜é‡</strong>ã€‚</li><li>çº¿ç¨‹å¯¹å…±äº«å˜é‡çš„æ“ä½œéƒ½æ˜¯å¯¹å…¶å‰¯æœ¬è¿›è¡Œæ“ä½œï¼Œæ“ä½œå®Œæˆä¹‹åå†åŒæ­¥å›ä¸»å†…å­˜å½“ä¸­å»ï¼›</li></ul></li></ul><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">                    Java Memory Model(Java å†…å­˜æ¨¡å‹)</span><br><span class="line">---------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">    --------------------------          ----------------------------</span><br><span class="line">    |<span class="string">        çº¿ç¨‹1           </span>|<span class="string">           </span>|<span class="string">          çº¿ç¨‹2           </span>|</span><br><span class="line">    |<span class="string">                        </span>|<span class="string">           </span>|<span class="string">                          </span>|</span><br><span class="line">    |<span class="string">  -------------------   </span>|<span class="string">           </span>|<span class="string">  --------------------    </span>|</span><br><span class="line">    |<span class="string">  </span>|<span class="string">  çº¿ç¨‹1å·¥ä½œå†…å­˜    </span>|<span class="string">  </span>|<span class="string">           </span>|<span class="string">  </span>|<span class="string">  çº¿ç¨‹2å·¥ä½œå†…å­˜    </span>|<span class="string">    </span>|</span><br><span class="line">    |<span class="string">  </span>|<span class="string">                  </span>|<span class="string">  </span>|<span class="string">           </span>|<span class="string">  </span>|<span class="string">                   </span>|<span class="string">   </span>|</span><br><span class="line">    |<span class="string">  </span>|<span class="string"> ---------------- </span>|<span class="string">  </span>|<span class="string">           </span>|<span class="string">  </span>|<span class="string"> ----------------  </span>|<span class="string">   </span>|</span><br><span class="line">    |<span class="string">  </span>|<span class="string"> </span>|<span class="string"> å…±äº«å˜é‡xå‰¯æœ¬ </span>|<span class="string"> </span>|<span class="string">  </span>|<span class="string">           </span>|<span class="string">  </span>|<span class="string"> </span>|<span class="string"> å…±äº«å˜é‡xå‰¯æœ¬ </span>|<span class="string">  </span>|<span class="string">   </span>|</span><br><span class="line">    |<span class="string">  </span>|<span class="string"> ---------------- </span>|<span class="string">  </span>|<span class="string">           </span>|<span class="string">  </span>|<span class="string"> ----------------- </span>|<span class="string">   </span>|</span><br><span class="line">    |<span class="string">  </span>|<span class="string">                  </span>|<span class="string">  </span>|<span class="string">           </span>|<span class="string">  </span>|<span class="string">                   </span>|<span class="string">   </span>|</span><br><span class="line">    |<span class="string">  --------------------  </span>|<span class="string">           </span>|<span class="string">  ---------------------   </span>|</span><br><span class="line">                â†‘                                      â†‘</span><br><span class="line">                |<span class="string">                                      </span>|</span><br><span class="line">                |<span class="string">â†---------------JMMæ§åˆ¶--------------â†’</span>|</span><br><span class="line">                |<span class="string">                                      </span>|</span><br><span class="line">                â†“                                      â†“</span><br><span class="line">   --------------------------------------------------------------------</span><br><span class="line">   |<span class="string">                            ä¸»å†…å­˜                                </span>|</span><br><span class="line">   |<span class="string">  ------------------      ------------------     --------------   </span>|</span><br><span class="line">   |<span class="string">  </span>|<span class="string">   å…±äº«å˜é‡x    </span>|<span class="string">       </span>|<span class="string">   å…±äº«å˜é‡ y   </span>|<span class="string">      </span>|<span class="string"> å…±äº«å˜é‡z  </span>|<span class="string">  </span>|</span><br><span class="line">   |<span class="string">  ------------------      -------------------    ---------------  </span>|</span><br><span class="line">   |<span class="string">                                                                  </span>|</span><br><span class="line">   --------------------------------------------------------------------</span><br></pre></td></tr></table></figure><h3 id="Javaå†…å­˜æ¨¡å‹çš„ä½œç”¨"><a href="#Javaå†…å­˜æ¨¡å‹çš„ä½œç”¨" class="headerlink" title="Javaå†…å­˜æ¨¡å‹çš„ä½œç”¨"></a>Javaå†…å­˜æ¨¡å‹çš„ä½œç”¨</h3><p>javaå†…å­˜æ¨¡å‹æ˜¯ä¸€å¥—è§„èŒƒï¼›<br>ä¸»è¦çš„ç›®çš„å°±æ˜¯åœ¨å¤šçº¿ç¨‹å¯¹å…±äº«å˜é‡è¿›è¡Œè¯»å†™æ—¶ï¼Œæ¥ä¿è¯å…±äº«å˜é‡çš„å¯è§æ€§ã€æœ‰åºæ€§ã€åŸå­æ€§ï¼›<br>javaå†…å­˜æ¨¡å‹è¯¥è§„èŒƒå½“ä¸­ä¸»è¦é˜è¿°äº†ä¸¤ä¸ªå…³é”®å­—ï¼›<br>ä¸€ä¸ªæ˜¯synchronizedï¼›ä¸€ä¸ªæ˜¯volatileï¼›<br>é‚£ä¹ˆåœ¨ç¼–ç¨‹å½“ä¸­ä¹Ÿæ˜¯é€šè¿‡è¿™ä¸¤ä¸ªå…³é”®å­—æ¥è¿›è¡Œä¿è¯å…±äº«å˜é‡çš„ä¸‰ä¸ªç‰¹æ€§å³å¯è§æ€§ã€æœ‰åºæ€§ã€åŸå­æ€§ï¼›</p><p>javaå†…å­˜æ¨¡å‹ æ˜¯ä¸€å¥—åœ¨å¤šçº¿ç¨‹è¯»å†™å…±äº«æ•°æ®æ—¶ï¼Œå¯¹å…±äº«æ•°æ®çš„å¯è§æ€§ã€æœ‰åºæ€§ã€åŸå­æ€§çš„è§„åˆ™å’Œä¿éšœã€‚</p><p>javaå†…å­˜æ¨¡å‹ä¸çœŸå®çš„è®¡ç®—æœºç»“æ„æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ</p><h3 id="CPUç¼“å­˜ã€å†…å­˜ä¸Javaå†…å­˜æ¨¡å‹çš„å…³ç³»"><a href="#CPUç¼“å­˜ã€å†…å­˜ä¸Javaå†…å­˜æ¨¡å‹çš„å…³ç³»" class="headerlink" title="CPUç¼“å­˜ã€å†…å­˜ä¸Javaå†…å­˜æ¨¡å‹çš„å…³ç³»"></a>CPUç¼“å­˜ã€å†…å­˜ä¸Javaå†…å­˜æ¨¡å‹çš„å…³ç³»</h3><p>é€šè¿‡å¯¹å‰é¢çš„ <strong>CPUç¡¬ä»¶å†…å­˜æ¶æ„</strong>ã€<strong>Javaå†…å­˜æ¨¡å‹</strong> ä»¥åŠ <strong>Javaå¤šçº¿ç¨‹çš„å®ç°åŸç†</strong> çš„äº†è§£ï¼Œåº”è¯¥å·²ç»æ„è¯†åˆ°ï¼Œ<strong>å¤šçº¿ç¨‹çš„æ‰§è¡Œ</strong> <strong>æœ€ç»ˆ</strong>éƒ½ä¼š<strong>æ˜ å°„</strong>åˆ° <strong>ç¡¬ä»¶å¤„ç†å™¨</strong> ä¸Šè¿›è¡Œ<strong>æ‰§è¡Œ</strong>ã€‚</p><p>ä½† <strong>Javaå†…å­˜æ¨¡å‹</strong> å’Œ <strong>ç¡¬ä»¶å†…å­˜æ¶æ„</strong> å¹¶<strong>ä¸å®Œå…¨ä¸€è‡´</strong>ã€‚<br>å¯¹äº <strong>ç¡¬ä»¶å†…å­˜</strong> æ¥è¯´åªæœ‰ <strong>å¯„å­˜å™¨</strong>ã€<strong>ç¼“å­˜å†…å­˜</strong>ã€<strong>ä¸»å†…å­˜</strong>çš„æ¦‚å¿µï¼Œ<br>å¹¶<strong>æ²¡æœ‰å·¥ä½œå†…å­˜å’Œä¸»å†…å­˜ä¹‹åˆ†</strong>ï¼Œ<br>ä¹Ÿå°±æ˜¯è¯´ <strong>Javaå†…å­˜æ¨¡å‹å¯¹å†…å­˜çš„åˆ’åˆ†</strong> å¯¹ <strong>ç¡¬ä»¶å†…å­˜</strong> å¹¶<strong>æ²¡æœ‰ä»»ä½•é—®é¢˜</strong>ï¼Œ<br>å› ä¸º<strong>JMM</strong>åªæ˜¯ä¸€ç§ <strong>æŠ½è±¡çš„æ¦‚å¿µ</strong>ï¼Œæ˜¯<strong>ä¸€ç»„è§„åˆ™</strong>ï¼Œ<br>ä¸ç®¡æ˜¯ <strong>å·¥ä½œå†…å­˜çš„æ•°æ®</strong> è¿˜æ˜¯ <strong>ä¸»å†…å­˜çš„æ•°æ®</strong>ï¼Œ<br>å¯¹äº <strong>è®¡ç®—æœºç¡¬ä»¶</strong>æ¥è¯´ éƒ½ä¼š <strong>å­˜å‚¨åœ¨è®¡ç®—æœºä¸»å†…å­˜</strong>ä¸­ï¼Œ<br>å½“ç„¶ä¹Ÿæœ‰å¯èƒ½ <strong>å­˜å‚¨åˆ°CPUç¼“å­˜</strong>æˆ–è€…<strong>å¯„å­˜å™¨</strong>ä¸­ï¼Œ<br>å› æ­¤æ€»ä½“ä¸Šæ¥è¯´ï¼Œ<strong>Javaå†…å­˜æ¨¡å‹</strong>å’Œ<strong>è®¡ç®—æœºç¡¬ä»¶å†…å­˜æ¶æ„</strong> æ˜¯ä¸€ä¸ª<strong>ç›¸äº’äº¤å‰</strong>çš„å…³ç³»ï¼Œ<br>æ˜¯ä¸€ç§ <strong>æŠ½è±¡æ¦‚å¿µåˆ’åˆ†</strong> ä¸ <strong>çœŸå®ç‰©ç†ç¡¬ä»¶</strong>çš„<strong>äº¤å‰</strong>ã€‚</p><p>JMMå†…å­˜æ¨¡å‹ä¸CPUç¡¬ä»¶å†…å­˜æ¶æ„çš„å…³ç³»ï¼š</p><p>å›¾çš„å³è¾¹æ˜¯çœŸå®çš„CPUç¡¬ä»¶å†…å­˜æ¶æ„ï¼›æœ‰CPUã€CPUå½“ä¸­å­˜åœ¨æœ‰CPUå¯„å­˜å™¨ã€CPUç¼“å­˜ã€å†…å­˜ï¼ˆRAMï¼‰ï¼›<br>å›¾çš„å·¦è¾¹æ˜¯Javaå†…å­˜æ¨¡å‹ï¼šçº¿ç¨‹ã€çº¿ç¨‹å½“ä¸­å­˜åœ¨æœ‰å·¥ä½œå†…å­˜ã€ä¸»å†…å­˜ï¼›<br>Javaå†…å­˜æ¨¡å‹æ˜¯ä¸€å¥—æŠ½è±¡å‡ºæ¥çš„è§„èŒƒï¼ŒæŠ½è±¡çš„æ¦‚å¿µï¼Œæ˜¯ä¸€ç»„è§„åˆ™ï¼›<br>javaå†…å­˜æ¨¡å‹å½“ä¸­çš„çº¿ç¨‹ä¸­çš„å·¥ä½œå†…å­˜æœ‰å¯èƒ½å¯¹åº”ç€ ç¡¬ä»¶å†…å­˜æ¶æ„å½“ä¸­çš„CPUå¯„å­˜å™¨ä¹Ÿæœ‰å¯èƒ½å¯¹åº”ç€CPUç¼“å­˜ä¹Ÿæœ‰å¯èƒ½å¯¹åº”å†…å­˜ï¼ˆRAMï¼‰ï¼›<br>javaå†…å­˜æ¨¡å‹å½“ä¸­çš„ä¸»å†…å­˜ä¹Ÿæœ‰å¯èƒ½å¯¹åº”ç€ ç¡¬ä»¶å†…å­˜æ¶æ„å½“ä¸­çš„CPUå¯„å­˜å™¨ã€CPUç¼“å­˜ã€å†…å­˜ï¼ˆRAMï¼‰ï¼›</p><h3 id="å°ç»“-4"><a href="#å°ç»“-4" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>javaå†…å­˜æ¨¡å‹æ˜¯ä¸€å¥—è§„èŒƒï¼ˆä¸»è¦æ˜¯è®©javaç¨‹åºæ¥å¯ä»¥å®ç°è·¨å¹³å°è¿™ä¸€ç‰¹æ€§ï¼›åˆä¸éœ€è¦å»å…³æ³¨å¹³å°çš„åº•å±‚ç»†èŠ‚ï¼‰ï¼Œ<br>æè¿°äº† javaç¨‹åºä¸­å„ç§å˜é‡ ï¼ˆçº¿ç¨‹å…±äº«å˜é‡ï¼‰çš„è®¿é—®è§„åˆ™ï¼Œ<br>ä»¥åŠåœ¨ JVMä¸­å°†å˜é‡ å­˜å‚¨åˆ°å†…å­˜å’Œä»å†…å­˜ä¸­è¯»å–å˜é‡è¿™æ ·çš„ åº•å±‚ç»†èŠ‚ï¼Œ<br>javaå†…å­˜æ¨¡å‹æ˜¯å¯¹å…±äº«æ•°æ®çš„å¯è§æ€§ã€æœ‰åºæ€§ã€åŸå­æ€§çš„è§„åˆ™å’Œä¿éšœã€‚</p><h2 id="ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜ä¹‹é—´çš„æ•°æ®äº¤äº’è¿‡ç¨‹"><a href="#ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜ä¹‹é—´çš„æ•°æ®äº¤äº’è¿‡ç¨‹" class="headerlink" title="ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜ä¹‹é—´çš„æ•°æ®äº¤äº’è¿‡ç¨‹"></a>ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜ä¹‹é—´çš„æ•°æ®äº¤äº’è¿‡ç¨‹</h2><p>javaå†…å­˜æ¨¡å‹æœ‰ä¸»å†…å­˜ã€å·¥ä½œå†…å­˜ä¹‹åˆ†ï¼›<br>å½“çº¿ç¨‹Aéœ€è¦è¿›è¡Œæ“ä½œä¸€ä¸ªå…±äº«å˜é‡Xçš„æ—¶å€™ï¼Œ<br>éœ€è¦å°†å­˜åœ¨åœ¨ä¸»å†…å­˜çš„å…±äº«å˜é‡Xå¤åˆ¶æ‹·è´ä¸€ä»½æ”¾åˆ°çº¿ç¨‹Aè‡ªå·±çš„å·¥ä½œå†…å­˜å½“ä¸­ï¼›<br>çº¿ç¨‹Aå³å¯¹è‡ªå·±å·¥ä½œå†…å­˜å½“ä¸­æ‹·è´è¿‡æ¥çš„å…±äº«å˜é‡å‰¯æœ¬è¿›è¡Œæ“ä½œï¼Œ<br>æ“ä½œå¤„ç†å®Œæˆä¹‹åï¼›<br>ç„¶åå†å°†ç»“æœä»å·¥ä½œå†…å­˜åŒæ­¥å›ä¸»å†…å­˜å½“ä¸­å»ï¼›<br>é‚£ä¹ˆè¯¥è¿‡ç¨‹å½“ä¸­å…¶ä¸­è¯¦ç»†çš„ç»†èŠ‚æ˜¯æ€æ ·çš„ï¼Ÿ</p><h3 id="ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜ä¹‹é—´çš„äº¤äº’"><a href="#ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜ä¹‹é—´çš„äº¤äº’" class="headerlink" title="ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜ä¹‹é—´çš„äº¤äº’"></a>ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜ä¹‹é—´çš„äº¤äº’</h3><h3 id="ç›®æ ‡-5"><a href="#ç›®æ ‡-5" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>äº†è§£ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜ä¹‹é—´çš„æ•°æ®äº¤äº’è¿‡ç¨‹</p><p>Javaå†…å­˜æ¨¡å‹ ä¸­å®šä¹‰äº†ä»¥ä¸‹ 8ä¸­æ“ä½œæ¥å®Œæˆï¼ˆä¸ºäº†ä¿è¯ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜ä¹‹é—´çš„æ•°æ®äº¤äº’æ•°æ®æ˜¯æ­£ç¡®çš„ï¼‰ï¼Œ<br>ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜ä¹‹é—´ å…·ä½“çš„äº¤äº’åè®®ï¼Œ<br>å³ä¸€ä¸ªå˜é‡å¦‚ä½•ä»ä¸»å†…å­˜æ‹·è´åˆ°å·¥ä½œå†…å­˜ã€å¦‚ä½•ä»å·¥ä½œå†…å­˜åŒæ­¥å›ä¸»å†…å­˜ä¹‹ç±»çš„å®ç°ç»†èŠ‚ï¼Œ<br>è™šæ‹Ÿæœºå®ç°æ—¶å¿…é¡»ä¿è¯ä¸‹é¢æåŠçš„æ¯ä¸€ç§æ“ä½œéƒ½æ˜¯åŸå­çš„ã€ä¸å¯å†åˆ†çš„ï¼›</p><p>å¯¹åº”çš„æµç¨‹å›¾å¦‚ä¸‹ï¼š<br>è¿™8ä¸ªåŸå­æ“ä½œå…ˆä¸å…³å¿ƒ Lockä¸Unlockæ“ä½œï¼›é™¤æ­¤ä¹‹å¤–è¿˜ä½™å…­ä¸ªæ“ä½œï¼›<br>å‡è®¾ç°åœ¨çº¿ç¨‹1æƒ³è¦æ¥è¿›è¡Œè®¿é—®ä¸»å†…å­˜å½“ä¸­çš„å…±äº«å˜é‡xï¼Œå³å½“å‰ä¸»å†…å­˜å½“ä¸­çš„å…±äº«å˜é‡xçš„å–å€¼ä¸º boolean x = true;</p><p>é‚£ä¹ˆè¯¥çº¿ç¨‹1é¦–å…ˆä¼šåšä¸€ä¸ªåŸå­æ“ä½œå«åšReadï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯è¯»å–ä¸»å†…å­˜å½“ä¸­çš„å…±äº«å˜é‡xçš„å–å€¼å³boolean x = trueçš„è¿™æ ·ä¸€ä¸ªå–å€¼ï¼›<br>é‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯æ‰§è¡Œä¸€ä¸ªæ“ä½œå«åšLoadï¼Œå³å°†è¯¥åœ¨ä¸»å†…å­˜å½“ä¸­è¯»å–åˆ°çš„å…±äº«å˜é‡åŠ è½½åˆ°äº†å·¥ä½œå†…å­˜å½“ä¸­ï¼›<br>é‚£ä¹ˆæ¥ç€ä¼šåšä¸€ä¸ªUseæ“ä½œï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœè¯¥çº¿ç¨‹1éœ€è¦å¯¹è¯¥å…±äº«å˜é‡xè¿›è¡Œæ“ä½œï¼Œå³ä¼šå–åˆ°è¿™ä¸ªä»ä¸»å†…å­˜å½“ä¸­åŠ è½½è¿‡æ¥çš„å…±äº«å˜é‡xçš„å–å€¼å»è¿›è¡Œä¸€äº›æ“ä½œï¼›<br>é‚£ä¹ˆæ“ä½œä¹‹åä¼šæœ‰ä¸€ä¸ªæ–°çš„ç»“æœè¿›è¡Œè¿”å›ï¼›é‚£ä¹ˆå‡è®¾è¿™ä¸ªæ“ä½œçš„æ–°çš„ç»“æœä»¤è¿™ä¸ªå…±äº«å˜é‡çš„å–å€¼å˜ä¸ºäº†falseï¼›é‚£ä¹ˆå³ç»™è¿™ä¸ªå…±äº«å˜é‡xè¿›è¡Œèµ‹å€¼æ“ä½œï¼Œå³å®Œæˆæ“ä½œAssignï¼›é‚£ä¹ˆæ“ä½œå®Œæˆä¹‹åï¼›å°±éœ€è¦åŒæ­¥å›ä¸»å†…å­˜ï¼›<br>åŒæ­¥å›ä¸»å†…å­˜é¦–å…ˆä¼šå®Œæˆä¸€ä¸ª Storeçš„è¿™æ ·ä¸€ä¸ªåŸå­æ“ä½œï¼›è¡¨ç¤ºè¦æ¥ä¿å­˜è¿™ä¸ªå¤„ç†ç»“æœï¼›<br>ç„¶åæ¥ç€æ‰§è¡ŒWriteæ“ä½œï¼Œå³æŠŠåœ¨å·¥ä½œå†…å­˜å½“ä¸­å¤„ç†å®Œæˆä¹‹åæœ€æ–°çš„å–å€¼ï¼Œå³Assignèµ‹å€¼ç»™å…±äº«å˜é‡çš„å€¼åŒæ­¥åˆ°ä¸»å†…å­˜å½“ä¸­ï¼›å³ä¸»å†…å­˜ä¸­å…±äº«å˜é‡å–å€¼xç”±trueæ›´æ”¹ä¸ºfalseï¼›<br>å¦å¤–è¿˜æœ‰ä¸¤ä¸ªæ“ä½œå³Lockä¸Unlockï¼›è¿™ä¸ªæ˜¯ä¸é”ç›¸å…³çš„æ“ä½œï¼›<br>æ¯”å¦‚è¯´åŠ äº†synchronizedï¼Œå³åŠ äº†é”ï¼›æ‰ä¼šäº§ç”Ÿæœ‰lockä¸unlockæ“ä½œï¼›<br>å¦‚æœå…±äº«å˜é‡çš„æ“ä½œæ²¡æœ‰åŠ è¿™ä¸ªsynchronizedå³æ²¡æœ‰åŠ é”ï¼›<br>é‚£ä¹ˆä¹Ÿå°±ä¸ä¼šäº§ç”Ÿæœ‰lockä¸unlockæ“ä½œï¼›</p><p>æ³¨æ„ï¼›<br>ï¼ˆå¯¹äºlockæœ‰ä¸€äº›ç‰¹æ®Šçš„æƒ…å†µï¼›ï¼‰</p><ol><li>å¦‚æœå¯¹ä¸€ä¸ªå˜é‡æ‰§è¡Œ lockæ“ä½œï¼Œå°†ä¼šæ¸…ç©ºå·¥ä½œå†…å­˜ä¸­ æ­¤å˜é‡çš„å€¼ã€‚</li><li>å¯¹ä¸€ä¸ªå˜é‡æ‰§è¡Œunlockæ“ä½œï¼Œå¿…é¡»å…ˆæŠŠæ­¤å˜é‡åŒæ­¥åˆ°ä¸»å†…å­˜ä¸­ã€‚</li></ol><p>å³å¦‚æœçº¿ç¨‹1ä¸­åœ¨Readä¸»å†…å­˜å½“ä¸­çš„å…±äº«å˜é‡ä¹‹å‰ï¼Œçº¿ç¨‹1çš„å·¥ä½œå†…å­˜å½“ä¸­å·²ç»å­˜åœ¨æœ‰è¯¥å…±äº«å˜é‡çš„å‰¯æœ¬ï¼›é‚£ä¹ˆåˆæœ‰lockæ“ä½œçš„è¯åˆ™å°†ä¼šå°†è¯¥çº¿ç¨‹1å½“ä¸­çš„å…±äº«å˜é‡çš„å‰¯æœ¬è¿›è¡Œæ¸…ç©ºæ‰ï¼Œç„¶åå†å»è¿›è¡ŒReadè¯»å–ä¸»å†…å­˜å½“ä¸­å…±äº«å˜é‡å–å€¼çš„æ“ä½œï¼›å³è¯»å–ä¸»å†…å­˜å½“ä¸­æœ‰å…³è¯¥å…±äº«å˜é‡æœ€æ–°çš„å–å€¼ï¼›</p><p>unlockæ“ä½œä¹Ÿéœ€è¦æ³¨æ„ï¼›å‡è®¾çº¿ç¨‹1å½“ä¸­çš„å·¥ä½œå†…å­˜å½“ä¸­å­˜åœ¨æœ‰è¯¥å…±äº«å˜é‡çš„å‰¯æœ¬ï¼›é‚£ä¹ˆåœ¨æ‰§è¡Œunlockä¹‹å‰ä¸€å®šä¼šå…ˆå°†å·¥ä½œå†…å­˜å½“ä¸­è¯¥å…±äº«å˜é‡å‰¯æœ¬çš„å–å€¼åŒæ­¥åˆ°ä¸»å†…å­˜å½“ä¸­å»ï¼›ç„¶åå†è¿›è¡Œunlockæ“ä½œï¼›</p><p>synchronizedå¦‚ä½•ä¿è¯å¯è§æ€§å…¶å®å°±ä¸lockã€unlockè¿™ä¸¤ä¸ªåŸå­æ“ä½œæœ‰å…³ï¼›</p><h3 id="å°ç»“-5"><a href="#å°ç»“-5" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>ä¸»å†…å­˜ ä¸ å·¥ä½œå†…å­˜ ä¹‹é—´çš„ æ•°æ®äº¤äº’è¿‡ç¨‹(å³ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜çš„äº¤äº’è¿‡ç¨‹ä¸­æ˜¯é€šè¿‡è¿™8ä¸ªåŸå­æ“ä½œæ¥è¿›è¡Œä¿è¯æ•°æ®çš„æ­£ç¡®æ€§ï¼›)</p><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">lock</span> --<span class="comment">â†’</span> <span class="comment">read</span> --<span class="comment">â†’</span> <span class="comment">load</span> --<span class="comment">â†’</span> <span class="comment">use</span> --<span class="comment">â†’</span> <span class="comment">assign</span> --<span class="comment">â†’</span> <span class="comment">store</span> --<span class="comment">â†’</span> <span class="comment">write</span> --<span class="comment">â†’</span> <span class="comment">unlock</span></span><br></pre></td></tr></table></figure><h2 id="synchronizedä¿è¯åŸå­æ€§"><a href="#synchronizedä¿è¯åŸå­æ€§" class="headerlink" title="synchronizedä¿è¯åŸå­æ€§"></a>synchronizedä¿è¯åŸå­æ€§</h2><p>ï¼ˆé€šè¿‡synchronizedå…³é”®å­—å’Œå†…å­˜æ¨¡å‹æ¥è¯¦ç»†çš„åˆ†æåŸå­æ€§é—®é¢˜ï¼Œä»¥åŠå¦‚ä½•æ¥è¿›è¡Œè§£å†³åŸå­æ€§é—®é¢˜ï¼Œå¦‚ä½•è§£å†³å¯è§æ€§é—®é¢˜ä»¥åŠæœ‰åºæ€§é—®é¢˜ç­‰ï¼‰</p><p>ç¬¬ä¸‰ç« ï¼šsynchronizedä¿è¯ä¸‰å¤§ç‰¹æ€§ï¼ˆå³synchronizedæ˜¯å¦‚ä½•è¿›è¡Œæ¥ä¿è¯å¯è§æ€§ã€åŸå­æ€§ã€æœ‰åºæ€§ï¼‰</p><h3 id="å›é¡¾synchronizedçš„ä½¿ç”¨"><a href="#å›é¡¾synchronizedçš„ä½¿ç”¨" class="headerlink" title="å›é¡¾synchronizedçš„ä½¿ç”¨"></a>å›é¡¾synchronizedçš„ä½¿ç”¨</h3><p>synchronized èƒ½å¤Ÿä¿è¯åœ¨ åŒä¸€æ—¶åˆ» æœ€å¤šåªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œè¯¥æ®µä»£ç ï¼Œå·²è¾¾åˆ°ä¿è¯å¹¶å‘å®‰å…¨çš„æ•ˆæœã€‚</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆ°æ—¶å€™åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿæ‹¿åˆ°è·å–é”è¿›å…¥åŒæ­¥ä»£ç å—å½“ä¸­æ¥ï¼›å…¶ä»–çš„çº¿ç¨‹æ‹¿ä¸åˆ°è·å–ä¸åˆ°é”ï¼›åªèƒ½å¤Ÿåœ¨åŒæ­¥ä»£ç å—å¤–è¿›è¡Œç­‰å¾…</span></span><br><span class="line"><span class="function"><span class="title">synchronized</span><span class="params">( é”å¯¹è±¡ )</span></span>&#123;</span><br><span class="line">  <span class="comment">// å—ä¿æŠ¤èµ„æº / ä¸´ç•ŒåŒºèµ„æº</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>synchronized ä¸ åŸå­æ€§</p><h3 id="ç›®æ ‡-6"><a href="#ç›®æ ‡-6" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>å­¦ä¹ ä½¿ç”¨ synchronized ä¿è¯åŸå­æ€§çš„åŸç†</p><h3 id="ä½¿ç”¨-synchronized-ä¿è¯åŸå­æ€§"><a href="#ä½¿ç”¨-synchronized-ä¿è¯åŸå­æ€§" class="headerlink" title="ä½¿ç”¨ synchronized ä¿è¯åŸå­æ€§"></a>ä½¿ç”¨ synchronized ä¿è¯åŸå­æ€§</h3><p>æ¡ˆä¾‹æ¼”ç¤ºï¼š5ä¸ªçº¿ç¨‹å„æ‰§è¡Œ1000æ¬¡ i++ï¼›<br>ï¼ˆå›é¡¾ä¹‹å‰åŸå­æ€§é—®é¢˜çš„ä»£ç ï¼Œ<strong>äº§ç”ŸåŸå­æ€§é—®é¢˜çš„åŸå› </strong>ï¼‰</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  æ¡ˆä¾‹æ¼”ç¤ºï¼š</span></span><br><span class="line"><span class="comment">    1. å®šä¹‰ä¸€ä¸ªå…±äº«å˜é‡number</span></span><br><span class="line"><span class="comment">    2. å¯¹numberè¿›è¡Œ1000çš„++æ“ä½œ</span></span><br><span class="line"><span class="comment">    3. ä½¿ç”¨5ä¸ªçº¿ç¨‹æ¥è¿›è¡Œ</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test02Atomicity</span>&#123;</span></span><br><span class="line">  <span class="comment">// 1. å®šä¹‰ä¸€ä¸ªå…±äº«å˜é‡number</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> number = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(<span class="keyword">String</span>[] args)</span>throws InterruptedException</span>&#123;</span><br><span class="line">    <span class="comment">// 2. å¯¹numberè¿›è¡Œ1000çš„++æ“ä½œ</span></span><br><span class="line">    <span class="comment">// Runnableå½“ä¸­æ‰§è¡Œ1000æ¬¡çš„å¾ªç¯ï¼›æ¯æ¬¡å¾ªç¯ä½¿å¾—number++</span></span><br><span class="line">    Runnable increment =  () -&gt;&#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i&lt; <span class="number">1000</span>; i++)&#123;</span><br><span class="line">        number++;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    List&lt;Thread&gt; <span class="built_in">list</span> = <span class="keyword">new</span> ArrayList&lt;Thread&gt;();</span><br><span class="line">    <span class="comment">// 3. ä½¿ç”¨5ä¸ªçº¿ç¨‹æ¥è¿›è¡Œ</span></span><br><span class="line">    <span class="comment">// åˆ›å»º5ä¸ªçº¿ç¨‹éƒ½å»æ‰§è¡ŒRunnableå½“ä¸­çš„run()</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i&lt; <span class="number">5</span> ; i++)&#123;</span><br><span class="line">      Thread t = <span class="keyword">new</span> Thread(increment);</span><br><span class="line">      t.start();</span><br><span class="line">      <span class="built_in">list</span>.add(t);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(Thread t : <span class="built_in">list</span>)&#123;</span><br><span class="line">      t.join();</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.<span class="built_in">println</span>(<span class="string">"number = "</span> + number);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">    ä¹‹å‰å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼›</span></span><br><span class="line"><span class="comment">    å³å¤šæ¬¡è¿è¡Œæµ‹è¯•å‘ç°æ•°æ®å¯èƒ½ä¼šå°äº5000ï¼›</span></span><br><span class="line"><span class="comment">    number = 5000;</span></span><br><span class="line"><span class="comment">    number = 4935;</span></span><br><span class="line"><span class="comment">    å¯¼è‡´è¿™ç§ç»“æœçš„åŸå› æ˜¯å› ä¸ºnumber++æ˜¯ç”±4æ¡å­—èŠ‚ç æŒ‡ä»¤è¿›è¡Œç»„æˆçš„ï¼›</span></span><br><span class="line"><span class="comment">    å¹¶æ²¡æœ‰ä¿è¯è¿™4æ¡å­—èŠ‚ç æŒ‡ä»¤çš„åŸå­æ€§æ“ä½œï¼›</span></span><br><span class="line"><span class="comment">    æ¥ä¸‹æ¥ä½¿ç”¨synchronizedï¼›synchronizedéœ€è¦ä¸€æŠŠé”å¯¹è±¡ï¼›</span></span><br><span class="line"><span class="comment">    åˆ™åˆ›å»ºä¸€æŠŠé”ï¼›Object objå³å¯ï¼›</span></span><br><span class="line"><span class="comment">    é‚£ä¹ˆä½¿ç”¨äº†synchronizedä¹‹åå°±å¯ä»¥ä¿è¯number++æ˜¯ä¸€ä¸ªåŸå­æ“ä½œï¼›</span></span><br><span class="line"><span class="comment">    å†æ¬¡å¤šæ¬¡è¿è¡Œå°±ä¼šå‘ç°numberçš„å–å€¼ä¸ä¼šè¿›è¡Œå˜åŠ¨äº†ï¼›è€Œæ˜¯ç›´æ¥å°±æ˜¯5000ï¼›</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä½¿ç”¨<strong>synchronized</strong>æ¥è¿›è¡Œä¿è¯number++çš„åŸå­æ€§æ“ä½œï¼›å³è¿›è¡ŒåŠ é”</p></blockquote><p>å†æ€ä¹ˆå¤šæ¬¡è¿è¡Œå¾—åˆ°çš„numberçš„ç»“æœä¹Ÿä¼šæ˜¯5000ï¼›å› ä¸ºsynchronizedä¿è¯äº†number++çš„åŸå­æ€§ï¼›é‚£ä¹ˆæ•°æ®å°±ä¸ä¼šé”™ä¹±ï¼›</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xxx.demo02_concurrent_problem;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  æ¡ˆä¾‹æ¼”ç¤ºï¼š5ä¸ªçº¿ç¨‹å„æ‰§è¡Œ1000æ¬¡ i++;</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test01Atomicity</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> number = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException</span>&#123;</span><br><span class="line">      Runnable increment = <span class="keyword">new</span> Runnable()&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">          <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++)&#123;</span><br><span class="line">            <span class="keyword">synchronized</span>(Test01Atomicity<span class="class">.<span class="keyword">class</span>)</span>&#123;</span><br><span class="line">              number++;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      ArrayList&lt;Thread&gt; ts = <span class="keyword">new</span> ArrayList();</span><br><span class="line">      <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>;  i &lt; <span class="number">50</span> ; i++)&#123;</span><br><span class="line">        Thread t = <span class="keyword">new</span> Thread(increment);</span><br><span class="line">        t.start();</span><br><span class="line">        ts.add(t);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span>(Thread t : ts)&#123;</span><br><span class="line">        t.join();</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      System.out.println(<span class="string">"number = "</span> + number);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( <span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++)&#123;</span><br><span class="line">    synchronized( Test01Atomicity.<span class="keyword">class</span> )&#123;</span><br><span class="line">      number++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  æ¡ˆä¾‹æ¼”ç¤º</span></span><br><span class="line"><span class="comment">    1. å®šä¹‰ä¸€ä¸ªå…±äº«å˜é‡number</span></span><br><span class="line"><span class="comment">    2. å¯¹numberè¿›è¡Œ1000æ¬¡çš„++æ“ä½œ</span></span><br><span class="line"><span class="comment">    3. ä½¿ç”¨5ä¸ªçº¿ç¨‹æ¥è¿›è¡Œ</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> Test02Atomicity&#123;</span><br><span class="line">  <span class="comment">// 1. å®šä¹‰ä¸€ä¸ªå…±äº«å˜é‡number</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> number = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  priavte Object obj = <span class="keyword">new</span> Object();<span class="comment">//å¯¹è±¡é”</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String[] args)<span class="keyword">throws</span> InterruptedException&#123;</span><br><span class="line">    <span class="comment">// 2. å¯¹numberè¿›è¡Œ1000æ¬¡çš„++æ“ä½œ</span></span><br><span class="line">    Runnable increment = ()-&gt;&#123;</span><br><span class="line">      <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5000</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">synchronized</span>(obj)&#123;</span><br><span class="line">          number++;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    List&lt;Thread&gt; list = <span class="keyword">new</span> ArrayList&lt;Thread&gt;();</span><br><span class="line">    <span class="comment">// 3. ä½¿ç”¨5ä¸ªçº¿ç¨‹æ¥è¿›è¡Œ</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)&#123;</span><br><span class="line">      Thread t = <span class="keyword">new</span> Thread(increment);</span><br><span class="line">      t.start();</span><br><span class="line">      list.add(t);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(Thread t : list)&#123;</span><br><span class="line">      t.<span class="keyword">join</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.<span class="keyword">println</span>(<span class="string">"number = "</span> + number);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  è¿›è¡Œåˆ†æï¼›ä¸ºä»€ä¹ˆåŠ äº†synchronizedä¹‹åå°±å¯ä»¥ä¿è¯number++æ˜¯ä¸€ä¸ªåŸå­æ“ä½œï¼›</span></span><br><span class="line"><span class="comment">  è¿˜æ˜¯é€šè¿‡javapåæ±‡ç¼–çš„æ–¹å¼æ¥è¿›è¡ŒæŸ¥çœ‹number++è¿™ä¸€å—çš„å­—èŠ‚ç æŒ‡ä»¤çš„å˜åŒ–ï¼›</span></span><br><span class="line"><span class="comment">  é€šè¿‡å‘½ä»¤è¡Œï¼ˆWindows PowerShellã€CMDç­‰ï¼‰æ‰“å¼€æ–‡ä»¶ï¼›</span></span><br><span class="line"><span class="comment">  ç›®å½•ï¼ˆå·¥ç¨‹å/target/classes/com/xxx/demo02_concurrent_probleam/Test02Atomicity.classï¼‰</span></span><br><span class="line"><span class="comment">  é€šè¿‡é”®å…¥å‘½ä»¤javapå¯¹å­—èŠ‚ç æ–‡ä»¶è¿›è¡Œåæ±‡ç¼–ï¼›æŸ¥çœ‹åˆ°å­—èŠ‚ç æŒ‡ä»¤ï¼›</span></span><br><span class="line"><span class="comment">  &gt;PS C:\Users\13666\IdeaProjects\XXX\Synchronized\target\classes\com\xxx\demo02_concurrent_probleam&gt; javap -p -v .\Test02Atomicity.class</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  æ¥ç€ä¾æ—§æ˜¯åˆ†æä¸‹synchronizedä¿è¯åŸå­æ€§æ“ä½œçš„åŸç†ï¼›</span></span><br><span class="line"><span class="comment">  åœ¨ç¬¬ä¸‰æ­¥éª¤æ—¶åˆ›å»ºäº†5ä¸ªçº¿ç¨‹åˆ†åˆ«éƒ½æ¥è¿›è¡Œæ‰§è¡ŒRunnableå½“ä¸­çš„run()æ“ä½œï¼›</span></span><br><span class="line"><span class="comment">  å³è¿›è¡Œå¾ªç¯1000æ¬¡number++æ“ä½œï¼›</span></span><br><span class="line"><span class="comment">  åˆ†æçš„æ—¶å€™å°±ä»¥ä¸¤ä¸ªçº¿ç¨‹ä¸ºä¾‹ï¼›çº¿ç¨‹Aä¸çº¿ç¨‹Bï¼›</span></span><br><span class="line"><span class="comment">  å‡è®¾ç¬¬ä¸€ä¸ªçº¿ç¨‹Aå…ˆè¿›è¡Œæ‰§è¡ŒRunnableå½“ä¸­çš„1000æ¬¡number++çš„å¾ªç¯ï¼›</span></span><br><span class="line"><span class="comment">  å½“çº¿ç¨‹Aè¿›å…¥åˆ°synchronizedçš„æ—¶å€™ï¼Œå¦‚æœå‘ç°å¯¹è±¡é”objæ²¡æœ‰çº¿ç¨‹åœ¨ä½¿ç”¨çš„è¯ï¼Œ</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆçº¿ç¨‹Aå°±ä¼šæ‹¿ç€å¯¹è±¡é”objè¿›å…¥åŒæ­¥ä»£ç å—å½“ä¸­ï¼›</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆè¿›æ¥ä¹‹åå°±å°†æ‰§è¡Œnumber++æ“ä½œï¼›</span></span><br><span class="line"><span class="comment">  è€Œnumber++æ“ä½œæ‰€å¯¹åº”çš„å­—èŠ‚ç æŒ‡ä»¤æœ‰4æ¡å­—èŠ‚ç æŒ‡ä»¤ï¼›</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆé¦–å…ˆæ¥è¿›è¡Œæ‰§è¡Œè¯»å–é™æ€å…±äº«å˜é‡numberçš„å–å€¼æŒ‡ä»¤ï¼Œ</span></span><br><span class="line"><span class="comment">  å³15: getstatic     #18   //Field number:Iè¯¥æŒ‡ä»¤ï¼›</span></span><br><span class="line"><span class="comment">  å½“å‰è¯»å–å¾—åˆ°numberçš„å–å€¼ä¸º0ï¼›é‚£ä¹ˆè¯»å–ä¹‹åå°±ç»§ç»­æ‹¿ç€å¯¹è±¡é”objå¾€ä¸‹è¿›è¡Œæ‰§è¡Œï¼›</span></span><br><span class="line"><span class="comment">  æ‰§è¡ŒæŒ‡ä»¤å‡†å¤‡ä¸€ä¸ªå¸¸é‡1å³æŒ‡ä»¤18: iconst_1</span></span><br><span class="line"><span class="comment">  å‡†å¤‡ä¸€ä¸ªå¸¸é‡1å®Œæˆä¹‹ååˆæ¥ç€å¾€ä¸‹ç»§ç»­æ‰§è¡Œï¼›</span></span><br><span class="line"><span class="comment">  æ¥ç€è¿›è¡Œä¸€ä¸ªç›¸åŠ çš„æ“ä½œå³æŒ‡ä»¤19: iaddçš„æ“ä½œå³æŒ‡ä»¤15: getstaticå½“ä¸­è·å–å¾—åˆ°é™æ€å…±äº«å˜é‡numberçš„å–å€¼0ä¸18: iconst_1æ‰€å‡†å¤‡çš„å¸¸é‡1è¿›è¡Œç›¸åŠ å¾—å‡ºè¿ç®—ç»“æœä¸º0+1=1ï¼›</span></span><br><span class="line"><span class="comment">  å‡è®¾æ‰§è¡Œå®Œè¯¥ç›¸åŠ æ“ä½œä¹‹åï¼Œå³19: iaddæ“ä½œå®Œæˆä¹‹åCPUåˆåˆ‡æ¢åˆ°äº†ç¬¬äºŒä¸ªçº¿ç¨‹ï¼Œå³çº¿ç¨‹Bï¼›</span></span><br><span class="line"><span class="comment">  æ³¨æ„æ­¤æ—¶çº¿ç¨‹æ˜¯åœ¨19: iaddæ‰§è¡Œä¹‹åä½†æ˜¯åœ¨20: putstaticæŒ‡ä»¤æ‰§è¡Œä¹‹å‰è¿›è¡Œäº†CPUçš„åˆ‡æ¢ï¼Œ</span></span><br><span class="line"><span class="comment">  å³å…±äº«å˜é‡å¹¶æœªè¢«é‡æ–°èµ‹å€¼ä¹‹å‰åªæ˜¯å¾—å‡ºäº†è¿ç®—ç»“æœçš„æ—¶å€™è¿›è¡Œäº†CPUåˆ‡æ¢åˆ°çº¿ç¨‹Bä¸Šå»äº†ï¼›</span></span><br><span class="line"><span class="comment">  </span></span><br><span class="line"><span class="comment">  ç¬¬äºŒä¸ªçº¿ç¨‹å³çº¿ç¨‹Bä¹Ÿæ˜¯è¦æ¥è¿›è¡Œæ‰§è¡ŒåŒæ­¥ä»£ç å—synchronized()&#123;&#125;å½“ä¸­çš„ä»£ç ï¼›</span></span><br><span class="line"><span class="comment">  ä½†æ˜¯æ­¤æ—¶çš„è¿™ä¸ªå¯¹è±¡é”objå·²ç»è¢«çº¿ç¨‹Aé”è·å–å¾—åˆ°äº†å³çº¿ç¨‹Aæ­¤æ—¶è¿˜å¹¶æ²¡æœ‰è¿›è¡Œé‡Šæ”¾é”unlockçš„æ“ä½œï¼›æ‰€ä»¥å¯¼è‡´å°½ç®¡CPUåˆ‡æ¢åˆ°äº†çº¿ç¨‹Bä¸Šä½†æ˜¯ç”±äºçº¿ç¨‹Aæ²¡æœ‰é‡Šæ”¾é”ï¼›</span></span><br><span class="line"><span class="comment">  çº¿ç¨‹Bæ²¡æœ‰åŠæ³•è·å–å¾—åˆ°é”ï¼Œ</span></span><br><span class="line"><span class="comment">  å°±åªèƒ½åœ¨synchronizedåŒæ­¥ä»£ç å—çš„å¤–ä¾§è¿›è¡Œç­‰å¾…ï¼›</span></span><br><span class="line"><span class="comment">  </span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆCPUæœ€ç»ˆè¿˜æ˜¯ä¼šåˆ‡æ¢åˆ°ç¬¬ä¸€ä¸ªçº¿ç¨‹å³çº¿ç¨‹Aä¸Šé¢æ¥ç»§ç»­å®Œæˆnumber++æ‰€å¯¹åº”çš„æœªå®Œæˆçš„å­—èŠ‚ç æŒ‡ä»¤çš„ç¬¬å››æ¡æŒ‡ä»¤å³20: putstatic   #18   //Field number:I</span></span><br><span class="line"><span class="comment">  æ‰§è¡Œputstaticé‚£ä¹ˆå°±ä¼šå°†19: iaddæ‰€è¿ç®—å¾—å‡ºçš„å–å€¼ç»“æœ1èµ‹å€¼ç»™é™æ€å…±äº«å˜é‡numberå–å€¼ï¼›</span></span><br><span class="line"><span class="comment">  æœ€åçº¿ç¨‹Aæ‰§è¡Œå¤–å­—èŠ‚ç æŒ‡ä»¤ä¹‹åå°±ä¼šå‡ºåŒæ­¥ä»£ç å—ï¼Œ</span></span><br><span class="line"><span class="comment">  å°±ä¼šå°†å¯¹è±¡é”objç»™è¿˜å›å»ï¼›</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆæ­¤æ—¶CPUåˆåˆ‡æ¢å›ç¬¬äºŒä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹Bå½“ä¸­ä¸Šæ¥äº†ï¼›</span></span><br><span class="line"><span class="comment">  çº¿ç¨‹Båˆæ¥æ‰§è¡ŒåŒæ­¥ä»£ç å—synchronized()&#123;&#125;ï¼›</span></span><br><span class="line"><span class="comment">  è¿™æ¬¡å°±èƒ½å¤Ÿè·å–å¾—åˆ°å¯¹åƒé”äº†ï¼›</span></span><br><span class="line"><span class="comment">  åŸºäºçº¿ç¨‹Aå®Œæˆäº†å…¶åœ¨synchronizedåŒæ­¥ä»£ç å—å½“ä¸­çš„number++æ“ä½œä¹‹åé‡Šæ”¾äº†é”ï¼Œ</span></span><br><span class="line"><span class="comment">  CPUåˆåˆ‡æ¢åˆ°äº†çº¿ç¨‹Bä¸Šï¼Œ</span></span><br><span class="line"><span class="comment">  æ‰€ä»¥æ­¤æ—¶çº¿ç¨‹Bå¯ä»¥æ‹¿åˆ°è·å–å¾—åˆ°å¯¹è±¡é”objï¼›</span></span><br><span class="line"><span class="comment">  </span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆæ­¤æ—¶çº¿ç¨‹Bä¹Ÿæ‹¿ç€å¯¹è±¡é”objè¿›å…¥åŒæ­¥ä»£ç å—synchronizedå½“ä¸­æ‰§è¡Œnumber++æ“ä½œå³æ‰€å¯¹åº”çš„4ä¸ªå­—èŠ‚ç æŒ‡ä»¤(getstaticã€iconst_1ã€iaddã€putstatic)ï¼›</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆçº¿ç¨‹Bå…ˆæ¥è¿›è¡Œæ‰§è¡Œnumber++æ“ä½œçš„ç¬¬ä¸€æ¡å­—èŠ‚ç æŒ‡ä»¤ï¼š15: getstatic    #18     // Field number:I æ“ä½œè·å–å¾—åˆ°æ­¤æ—¶å…±äº«å˜é‡numberçš„å–å€¼ï¼Œ</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆæ­¤æ—¶çº¿ç¨‹Bæ¥è·å–å…±äº«å˜é‡numberçš„å–å€¼æ—¶ï¼Œ</span></span><br><span class="line"><span class="comment">  å…±äº«å˜é‡numberå˜é‡åœ¨ä¹‹å‰çš„çº¿ç¨‹Aå½“ä¸­çš„æ“ä½œå½“ä¸­å·²ç»ç”±0å˜ä¸ºäº†1ï¼Œ</span></span><br><span class="line"><span class="comment">  æ‰€ä»¥æ­¤æ—¶çº¿ç¨‹Bè·å–å¾—åˆ°numberå…±äº«å˜é‡çš„å–å€¼ä¸º1ï¼›</span></span><br><span class="line"><span class="comment">  </span></span><br><span class="line"><span class="comment">  æ¥ç€æ‰§è¡Œnumber++æ“ä½œçš„ç¬¬äºŒä¸ªå­—èŠ‚ç æŒ‡ä»¤å‡†å¤‡ä¸€ä¸ªå¸¸é‡1å³18: iconst_1æ“ä½œï¼›</span></span><br><span class="line"><span class="comment">  åœ¨å¾€ä¸‹ç»§ç»­æ‰§è¡Œnumberæ“ä½œçš„ç¬¬ä¸‰ä¸ªå­—èŠ‚ç æŒ‡ä»¤19: iaddï¼Œå³è·å–å¾—åˆ°é™æ€å…±äº«å˜é‡å–å€¼numberä¸º1 ä¸ æ‰€å‡†å¤‡çš„å¸¸é‡1è¿›è¡Œç›¸åŠ å¾—åˆ°è¿ç®—ç»“æœ 1+1=2ï¼›</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆæœ€åèµ°åˆ°ç¬¬å››æ­¥è¿›è¡Œæ‰§è¡Œ20:putstatic   # 18   // Field number:Iæ“ä½œ</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆå°±ä¼šæŠŠä»ç¬¬ä¸‰æ­¥å­—èŠ‚ç æŒ‡ä»¤æ‰€è¿ç®—å¾—å‡ºçš„ç»“æœ 2 èµ‹å€¼ç»™å…±äº«å˜é‡numberå–å€¼ï¼›</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆæ­¤æ—¶é™æ€å…±äº«å˜é‡çš„å–å€¼å°±ç”±1æ›´æ”¹ä¸º2äº†ï¼›</span></span><br><span class="line"><span class="comment">  è¿™ä¸ªæ—¶å€™å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªçº¿ç¨‹è¿›è¡Œæ‰§è¡Œnumber++æ“ä½œï¼›</span></span><br><span class="line"><span class="comment">  æœ€ç»ˆå¾—åˆ°çš„numberçš„ç»“æœä¸º2ï¼›</span></span><br><span class="line"><span class="comment">  æ•°æ®æ²¡æœ‰å‡ºç°é”™ä¹±ï¼›</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆè¿™é‡Œæœ€æ ¹æœ¬çš„åŸå› å°±æ˜¯æœ‰äº†åŒæ­¥ä»£ç å—ä¹‹åï¼›</span></span><br><span class="line"><span class="comment">  </span></span><br><span class="line"><span class="comment">  å½“ç¬¬ä¸€ä¸ªçº¿ç¨‹è¿›æ¥æ‰§è¡Œnumber++æ‰€å¯¹åº”çš„å…¶å››ä¸ªå­—èŠ‚ç æ“ä½œæŒ‡ä»¤ï¼›</span></span><br><span class="line"><span class="comment">  æ‰§è¡Œåˆ°ä¸€åŠï¼Œå°±ç®—CPUåˆ‡æ¢åˆ°äº†ç¬¬äºŒä¸ªçº¿ç¨‹è¿›è¡Œæ‰§è¡Œç›¸åŒçš„æ“ä½œä¹Ÿä¼šç”±äºæ²¡æœ‰å¯¹è±¡é”è€Œæ— æ³•è¿›å…¥åŒæ­¥ä»£ç å—åªèƒ½å¤Ÿåœ¨åŒæ­¥ä»£ç å—å¤–ä¾§è¿›è¡Œç­‰å¾…ç¬¬ä¸€ä¸ªçº¿ç¨‹é‡Šæ”¾é”ç¬¬äºŒä¸ªçº¿ç¨‹æ‰èƒ½å¤Ÿè·å–é”ä»è€Œè¿›å…¥åŒæ­¥ä»£ç å—ï¼›</span></span><br><span class="line"><span class="comment">  æ‰€ä»¥ä¹Ÿå°±èƒ½å¤Ÿä¿è¯ç¬¬ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œnumber++æ‰€å¯¹åº”çš„å››ä¸ªå­—èŠ‚ç æŒ‡ä»¤æ—¶ï¼Œ</span></span><br><span class="line"><span class="comment">  ä¸ä¼šå—åˆ°å…¶ä»–çº¿ç¨‹çš„å¹²æ‰°ï¼Œ</span></span><br><span class="line"><span class="comment">  ä»è€Œä¹Ÿå°±ä¿è¯äº†æ“ä½œçš„åŸå­æ€§ã€‚</span></span><br><span class="line"><span class="comment">  æ‰€ä»¥æ•°æ®æ‰ä¸ä¼šå‡ºç°é”™ä¹±ã€‚</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>å­—èŠ‚ç æŒ‡ä»¤ï¼š</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">      frame_type = <span class="number">250</span> <span class="comment">/* chop */</span></span><br><span class="line">          offset_delta = <span class="number">27</span></span><br><span class="line">    Exceptions:</span><br><span class="line">      thows java.lang.InterruptedException</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> static <span class="built_in">void</span> lambda$main$<span class="number">0</span>();</span><br><span class="line">    descriptor: ()V</span><br><span class="line">    flags: ACC_PRIVATE, ACC_STATIC, ACC_SYNTHETIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">2</span>, locals=<span class="number">3</span>, args_size=<span class="number">0</span></span><br><span class="line">          <span class="number">0</span>: iconst_0</span><br><span class="line">          <span class="number">1</span>: istore_0</span><br><span class="line">          <span class="number">2</span>: iload_0</span><br><span class="line">          <span class="number">3</span>: sipush          <span class="number">1000</span></span><br><span class="line">          <span class="number">6</span>: if_icmpge       <span class="number">39</span></span><br><span class="line">          <span class="number">9</span>: getstatic       #<span class="number">22</span>             <span class="comment">// Field obj:Ljava/lang/Object;</span></span><br><span class="line">         <span class="number">12</span>: dup</span><br><span class="line">         <span class="number">13</span>: astore_1</span><br><span class="line">         <span class="number">14</span>: monitorenter</span><br><span class="line">         <span class="number">15</span>: getstatic       #<span class="number">18</span>             <span class="comment">// Field number:I</span></span><br><span class="line">         <span class="number">18</span>: iconst_1</span><br><span class="line">         <span class="number">20</span>: putstatic       #<span class="number">18</span>             <span class="comment">// Field number:I</span></span><br><span class="line">         <span class="number">23</span>: aload_1</span><br><span class="line">         <span class="number">24</span>: monitorexit</span><br><span class="line">         <span class="number">25</span>: goto            <span class="number">33</span></span><br><span class="line">         <span class="number">28</span>: astore_2</span><br><span class="line">         <span class="number">29</span>: aload_1</span><br><span class="line">         <span class="number">30</span>: monitorexit</span><br><span class="line">         <span class="number">31</span>: aload_2</span><br><span class="line">         <span class="number">32</span>: athrow</span><br><span class="line">         <span class="number">33</span>: iinc            <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">         <span class="number">36</span>: goto</span><br><span class="line">         <span class="number">39</span>: <span class="keyword">return</span></span><br><span class="line">      Exception table:</span><br><span class="line">          <span class="keyword">from</span>     to     target   type</span><br><span class="line">            <span class="number">15</span>     <span class="number">25</span>         <span class="number">28</span>     any</span><br><span class="line">            <span class="number">28</span>     <span class="number">31</span>         <span class="number">28</span>     any</span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">19</span>: <span class="number">0</span></span><br><span class="line">        line <span class="number">20</span>: <span class="number">9</span></span><br><span class="line">        line <span class="number">21</span>: <span class="number">15</span></span><br><span class="line">        line <span class="number">22</span>: <span class="number">23</span></span><br><span class="line">        line <span class="number">19</span>: <span class="number">33</span></span><br><span class="line">....</span><br></pre></td></tr></table></figure><p>number++æ“ä½œä¾æ—§å¯¹åº”ç€è¿™å››æ¡å­—èŠ‚ç æŒ‡ä»¤</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">15</span>: getstatic         #<span class="number">18</span>       <span class="comment">// Field number:I</span></span><br><span class="line"><span class="number">18</span>: iconst_1</span><br><span class="line"><span class="number">19</span>: iadd</span><br><span class="line"><span class="number">20</span>: putstatic         #<span class="number">18</span>       <span class="comment">// Field number:I</span></span><br></pre></td></tr></table></figure><p>è€Œæ­¤æ—¶åŒ…å«ç€è¿™å››æ¡å­—èŠ‚ç æŒ‡ä»¤çš„è¿˜æœ‰<code>monitorenter</code>ä»¥åŠ<code>monitorexit</code>è¿™ä¸¤æ¡æŒ‡ä»¤ï¼›å³ï¼›</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">14</span>: monitorenter</span><br></pre></td></tr></table></figure><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">15</span>: getstatic        #<span class="number">18</span>        <span class="comment">// Field number:I</span></span><br><span class="line"><span class="number">18</span>: iconst_1</span><br><span class="line"><span class="number">19</span>: iadd</span><br><span class="line"><span class="number">20</span>: putstatic        #<span class="number">18</span>        <span class="comment">// Field number:I</span></span><br></pre></td></tr></table></figure><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">23</span>: aload_1</span><br><span class="line"><span class="number">24</span>: monitorexit</span><br></pre></td></tr></table></figure><h3 id="synchronized-ä¿è¯åŸå­æ€§çš„åŸç†"><a href="#synchronized-ä¿è¯åŸå­æ€§çš„åŸç†" class="headerlink" title="synchronized ä¿è¯åŸå­æ€§çš„åŸç†"></a>synchronized ä¿è¯åŸå­æ€§çš„åŸç†</h3><p>å¯¹ number++ ï¼Œå¢åŠ åŒæ­¥ä»£ç å—åï¼Œä¿è¯åŒä¸€æ—¶é—´ åªæœ‰ ä¸€ä¸ªçº¿ç¨‹æ“ä½œ number++; å°±ä¸ä¼šå‡ºç°å®‰å…¨é—®é¢˜ã€‚</p><h3 id="å°ç»“-6"><a href="#å°ç»“-6" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>synchronizedä¿è¯åŸå­æ€§çš„åŸç†: synchronizedä¿è¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‹¿åˆ°é”ï¼Œèƒ½å¤Ÿè¿›å…¥åŒæ­¥ä»£ç å—ä¸­ï¼Œå½“ç¬¬ä¸€ä¸ªçº¿ç¨‹è¿›å…¥äº†åŒæ­¥ä»£ç å—å½“ä¸­å³ä½¿æ“ä½œåˆ°äº†ä¸€åŠæ²¡æœ‰æ“ä½œå®Œç”±äºCPUåˆ‡æ¢ï¼Œåˆ‡æ¢åˆ°äº†å…¶ä»–çº¿ç¨‹ï¼Œå…¶ä»–çº¿ç¨‹ä¹Ÿä¼šç”±äºæ²¡æœ‰å¯¹è±¡é”çš„ç¼˜æ•…æ— æ³•è¿›å…¥åŒæ­¥ä»£ç å—å½“ä¸­åªèƒ½è¿›è¡Œç­‰å¾…ï¼›å³å…¶ä»–çº¿ç¨‹ä¸ä¼šæ¥å¹²æ‰°ç¬¬ä¸€ä¸ªçº¿ç¨‹çš„æ“ä½œï¼›å°±èƒ½å¤Ÿä¿è¯åŒæ­¥ä»£ç å—å½“ä¸­çš„ä»£ç æ˜¯ä¸€ä¸ªåŸå­æ€§çš„æ“ä½œï¼Œä¸ä¼šå—åˆ°å…¶ä»–çº¿ç¨‹çš„å¹²æ‰°ï¼›</p><p>synchronized ä¿è¯åŸå­æ€§çš„åŸç†</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¯¹ <span class="built_in">number</span>++; å¢åŠ åŒæ­¥ä»£ç å—åï¼Œä¿è¯åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ“ä½œ <span class="built_in">number</span>++;</span><br></pre></td></tr></table></figure><h2 id="synchronizedä¿è¯å¯è§æ€§"><a href="#synchronizedä¿è¯å¯è§æ€§" class="headerlink" title="synchronizedä¿è¯å¯è§æ€§"></a>synchronizedä¿è¯å¯è§æ€§</h2><h3 id="ç›®æ ‡-7"><a href="#ç›®æ ‡-7" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>å­¦ä¹ ä½¿ç”¨ synchronized ä¿è¯å¯è§æ€§çš„åŸç†</p><h3 id="ä½¿ç”¨synchronizedä¿è¯å¯è§æ€§"><a href="#ä½¿ç”¨synchronizedä¿è¯å¯è§æ€§" class="headerlink" title="ä½¿ç”¨synchronizedä¿è¯å¯è§æ€§"></a>ä½¿ç”¨synchronizedä¿è¯å¯è§æ€§</h3><p>æ¡ˆä¾‹æ¼”ç¤ºï¼š ä¸€ä¸ªçº¿ç¨‹æ ¹æ® booleanç±»å‹çš„æ ‡è®°flagï¼Œwhileå¾ªç¯ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹æ”¹å˜è¿™ä¸ªflagå˜é‡çš„å€¼ï¼Œæ ¹æ®boolean ç±»å‹çš„æ ‡è®°flagè¿›è¡Œwhileå¾ªç¯çš„é‚£ä¸ªçº¿ç¨‹ å¹¶ä¸ä¼šåœæ­¢å¾ªç¯ã€‚</p><p>å›é¡¾ä¹‹å‰çš„ä»£ç ï¼ˆ<strong>å¯è§æ€§é—®é¢˜äº§ç”Ÿçš„åŸå› </strong>ï¼‰ï¼š</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  æ¡ˆä¾‹æ¼”ç¤ºï¼š</span></span><br><span class="line"><span class="comment">    1. åˆ›å»ºä¸€ä¸ªå…±äº«å˜é‡</span></span><br><span class="line"><span class="comment">    2. åˆ›å»ºä¸€æ¡çº¿ç¨‹ä¸æ–­è¯»å–å…±äº«å˜é‡</span></span><br><span class="line"><span class="comment">    3. åˆ›å»ºä¸€æ¡çº¿ç¨‹ä¿®æ”¹å…±äº«å˜é‡</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> Test01Visibility&#123;</span><br><span class="line">  <span class="comment">// 1. åˆ›å»ºä¸€ä¸ªå…±äº«å˜é‡ï¼›</span></span><br><span class="line">  <span class="comment">// booleaå¸ƒå°”ç±»å‹flagé»˜è®¤å–å€¼ä¸ºtrue</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> flag = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String[] args) <span class="keyword">throws</span> InterruptedException&#123;</span><br><span class="line">    <span class="comment">// 2. åˆ›å»ºä¸€æ¡çº¿ç¨‹ä¸æ–­è¯»å–å…±äº«å˜é‡ï¼›</span></span><br><span class="line">    <span class="comment">// å¼€å¯ä¸€æ¡çº¿ç¨‹è¿›è¡Œå¾ªç¯ï¼›</span></span><br><span class="line">    <span class="comment">// å¦‚æœflagå˜é‡ä¸€ç›´ä¸ºtrueåˆ™ä¸€ç›´å¾ªç¯å¦åˆ™åœæ­¢å¾ªç¯ï¼›</span></span><br><span class="line">    <span class="keyword">new</span> Thread(()-&gt;&#123;</span><br><span class="line">      <span class="keyword">while</span>(flag)&#123;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;).start();</span><br><span class="line">  </span><br><span class="line">    Thread.sleep(<span class="number">2000</span>);<span class="comment">// ä¸»çº¿ç¨‹æ²‰ç¡ä¸¤ç§’</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. åˆ›å»ºä¸€æ¡çº¿ç¨‹ä¿®æ”¹å…±äº«å˜é‡flagå–å€¼ä¸ºfalse</span></span><br><span class="line">    <span class="keyword">new</span> Thread(()-&gt;&#123;</span><br><span class="line">      flag = <span class="keyword">false</span>;</span><br><span class="line">      System.out.<span class="keyword">println</span>(<span class="string">"çº¿ç¨‹ä¿®æ”¹äº†å˜é‡çš„å€¼ä¸ºfalse"</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">      ä¹‹å‰çš„æ•ˆæœä¸ºï¼›ä¸¤ç§’ä¹‹åè¿›è¡Œæ‰“å°äº†è¯­å¥â€œçº¿ç¨‹ä¿®æ”¹äº†å˜é‡çš„å€¼ä¸ºfalseâ€ï¼›</span></span><br><span class="line"><span class="comment">      ä½†æ˜¯å¦å¤–ä¸€ä¸ªçº¿ç¨‹å¹¶æ²¡æœ‰è·å–å¾—åˆ°æœ€æ–°å€¼ï¼Œ</span></span><br><span class="line"><span class="comment">      ä¹Ÿå°±æ˜¯æ ¹æ®flagå˜é‡è¿›è¡Œwhileå¾ªç¯çš„é‚£ä¸ªçº¿ç¨‹å¹¶æ²¡æœ‰è·å–å¾—åˆ°æœ€æ–°flagå–å€¼ä»è€Œä¹Ÿå°±å¯¼è‡´è¿™ä¸ªçº¿ç¨‹ä¸€ç›´åœ¨while(flag)/while(true)è¿è¡Œä¸­ï¼›</span></span><br><span class="line"><span class="comment">      Runä¸€ç›´ä¸ºçº¢ç¯ã€‚</span></span><br><span class="line"><span class="comment">      æ¥ç€æ¥è¿›è¡Œåˆ†æå…¶åŸå› ä»¥åŠå¦‚ä½•æ¥è¿›è¡Œè§£å†³ã€‚</span></span><br><span class="line"><span class="comment">      ä¸ºä»€ä¹ˆä¼šå‡ºç°å¯è§æ€§é—®é¢˜åˆ†æï¼š</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      é¦–å…ˆTest01Visibilityå½“ä¸­å­˜åœ¨æœ‰ä¸€ä¸ªæˆå‘˜å˜é‡flagå–å€¼ä¸ºtrueï¼›</span></span><br><span class="line"><span class="comment">      é‚£ä¹ˆè¯¥æˆå‘˜å˜é‡æ˜¯ä¸¤ä¸ªçº¿ç¨‹éƒ½ä¼šæ¥è¿›è¡Œæ“ä½œçš„ï¼›</span></span><br><span class="line"><span class="comment">      çº¿ç¨‹Aä¸çº¿ç¨‹Bï¼›</span></span><br><span class="line"><span class="comment">      çº¿ç¨‹Aè´Ÿè´£æ‰§è¡Œæ ¹æ®flagå–å€¼å˜åŒ–ä»è€Œwhileå¾ªç¯çš„çº¿ç¨‹ï¼›</span></span><br><span class="line"><span class="comment">      çº¿ç¨‹Båˆ™æ˜¯è´Ÿè´£ä¿®æ”¹æˆå‘˜å˜é‡flagå–å€¼çš„çº¿ç¨‹ï¼›</span></span><br><span class="line"><span class="comment">      é‚£ä¹ˆè¯¥æˆå‘˜å˜é‡ä½äºä¸»å†…å­˜å½“ä¸­ï¼›å³çº¿ç¨‹Aä¸çº¿ç¨‹Bçš„å…±äº«å˜é‡ï¼›</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      çº¢è‰²çš„ç®­å¤´ä»£è¡¨ä¸»çº¿ç¨‹ï¼Œä¸»çº¿ç¨‹ä»main()å¼€å§‹æ‰§è¡Œï¼›</span></span><br><span class="line"><span class="comment">      æ‰§è¡ŒTest01Visibilityå½“ä¸­mian()ä¸­çš„ä»£ç ï¼Œåˆ›å»ºçº¿ç¨‹Aå¹¶å¯åŠ¨çº¿ç¨‹Aä¸­çš„run();</span></span><br><span class="line"><span class="comment">      æ¥ç€ç”»ä¸€ä¸ªæ–°çº¿ç¨‹ï¼Œè¯¥æ–°çº¿ç¨‹ç”¨ç»¿è‰²ç®­å¤´è¡¨ç¤ºï¼Œè¡¨ç¤ºçš„å³ä¸ºçº¿ç¨‹Aï¼Œ</span></span><br><span class="line"><span class="comment">      é‚£ä¹ˆè¯¥Açº¿ç¨‹å°±ä¼šå»è¿›è¡Œæ‰§è¡Œwhile(flag)&#123;&#125;å¾ªç¯ï¼›</span></span><br><span class="line"><span class="comment">      å½“çº¿ç¨‹Aè¿›è¡Œæ‰§è¡Œçš„æ—¶å€™å°±éœ€è¦ç”¨åˆ°å…±äº«å˜é‡flagçš„å–å€¼ï¼›</span></span><br><span class="line"><span class="comment">      è€Œè¯¥å…±äº«å˜é‡ä½äºä¸»å†…å­˜å½“ä¸­ï¼›</span></span><br><span class="line"><span class="comment">      é‚£ä¹ˆè¿™ä¸ªæ—¶å€™çº¿ç¨‹Aå°±ä¼šä»ä¸»å†…å­˜å½“ä¸­è¿›è¡Œå¤åˆ¶ä¸€ä»½å…±äº«å˜é‡flagçš„å–å€¼boolean flag=trueçš„å‰¯æœ¬æ”¾åˆ°çº¿ç¨‹Aè‡ªå·±çš„å·¥ä½œå†…å­˜å½“ä¸­æ¥ï¼›</span></span><br><span class="line"><span class="comment">      é‚£ä¹ˆå½“å‰è¿›è¡Œå¾ªç¯è¿™ä¸ªflagä¸ºtrueé‚£ä¹ˆä¹Ÿå°±ä¼šå¯¼è‡´ä¸€ç›´åœ¨è¿›è¡Œå¾ªç¯çš„æ“ä½œï¼›</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      ä¸»çº¿ç¨‹ç»§ç»­å¾€ä¸‹è¿›è¡Œæ‰§è¡Œï¼ŒThread.sleep(2000);ä¸»çº¿ç¨‹æ²‰ç¡ä¸¤ç§’é’Ÿï¼›</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      é‚£ä¹ˆå½“ä¸»çº¿ç¨‹æ²‰ç¡å®Œä¸¤ç§’ä¹‹åï¼Œåˆä¼šè¿›è¡Œå¯åŠ¨ä¸€ä¸ªæ–°çš„çº¿ç¨‹å³çº¿ç¨‹Bï¼Œä¹Ÿå°±æ˜¯é‚£ä¸ªä¿®æ”¹å…±äº«å˜é‡flagå–å€¼çš„é‚£ä¸ªçº¿ç¨‹ï¼›</span></span><br><span class="line"><span class="comment">      å†ç”»ä¸€ä¸ªç´«è‰²çš„ç®­å¤´æ¥ä»£è¡¨ä¸€ä¸ªæ–°çš„çº¿ç¨‹å³çº¿ç¨‹Bï¼›</span></span><br><span class="line"><span class="comment">      é‚£ä¹ˆçº¿ç¨‹Båˆ™å¯¹åº”ç€å›¾ä¸­çš„å³è¾¹çš„é‚£å—å·¥ä½œå†…å­˜ï¼›</span></span><br><span class="line"><span class="comment">      é‚£ä¹ˆçº¿ç¨‹Bå¯åŠ¨ä¹‹åä¹Ÿæ˜¯éœ€è¦æ¥è¿›è¡Œæ‰§è¡Œçº¿ç¨‹Bå½“ä¸­çš„run()å½“ä¸­çš„ä»£ç å³ä¿®æ”¹å…±äº«å˜é‡flagçš„å–å€¼ä¸ºfalseå¹¶æ‰“å°è¾“å‡ºæ—¥å¿—ï¼›</span></span><br><span class="line"><span class="comment">      æ‰€ä»¥æ­¤æ—¶çº¿ç¨‹Béœ€è¦åšçš„æ˜¯ä¹Ÿæ˜¯ä»ä¸»å†…å­˜å½“ä¸­å»è¿›è¡Œè¯»å–å¤åˆ¶æ‹·è´è·å–å¾—åˆ°ä¸€ä»½å…±äº«å˜é‡flagçš„å‰¯æœ¬å³boolean flag = true;åˆ°çº¿ç¨‹Bè‡ªå·±çš„å·¥ä½œå†…å­˜å½“ä¸­æ¥ï¼›</span></span><br><span class="line"><span class="comment">      å¦å¤–åœ¨çº¿ç¨‹Bè‡ªå·±çš„å·¥ä½œå†…å­˜å½“ä¸­å¯¹å…¶å…±äº«å˜é‡å‰¯æœ¬è¿›è¡Œç›¸å…³æ“ä½œå³è¿›è¡Œé‡æ–°èµ‹å€¼ä¸ºfalseï¼›</span></span><br><span class="line"><span class="comment">      é‚£ä¹ˆå½“çº¿ç¨‹Bä¿®æ”¹å·¥ä½œå†…å­˜å½“ä¸­å…±äº«å˜é‡flagå‰¯æœ¬å–å€¼ä¹‹åä¼šå°†å·¥ä½œå†…å­˜å½“ä¸­è¯¥å…±äº«å˜é‡å‰¯æœ¬çš„å–å€¼åŒæ­¥å›ä¸»å†…å­˜å½“ä¸­çš„å…±äº«å˜é‡å–å€¼ï¼›</span></span><br><span class="line"><span class="comment">      ä¹Ÿå°±æ˜¯ä¸»å†…å­˜å½“ä¸­è¯¥å…±äº«å˜é‡flagå–å€¼å°±ç”±trueå˜ä¸ºäº†falseï¼›</span></span><br><span class="line"><span class="comment">      é‚£ä¹ˆæ¥ç€çº¿ç¨‹Bå†å»æ‰“å°â€œçº¿ç¨‹ä¿®æ”¹äº†å˜é‡çš„å€¼ä¸ºfalseâ€ä¿¡æ¯ï¼›</span></span><br><span class="line"><span class="comment">      é‚£ä¹ˆè¯¥çº¿ç¨‹Bæ‰§è¡Œè‡³æ­¤å°±ç»“æŸäº†ã€‚</span></span><br><span class="line"><span class="comment">      é‚£ä¹ˆå¯ä»¥çœ‹åˆ°çš„æ˜¯çº¿ç¨‹Bæ‰€è¿›è¡Œä¿®æ”¹çº¿ç¨‹Bè‡ªå·±å·¥ä½œå†…å­˜å½“ä¸­çš„å…±äº«å˜é‡å‰¯æœ¬flagçš„å–å€¼ä¸ºfalseå¹¶ä¸”åŒæ­¥å›åˆ°äº†ä¸»å†…å­˜å½“ä¸­å»äº†ï¼›</span></span><br><span class="line"><span class="comment">      é‚£ä¹ˆæ­¤æ—¶çš„çº¿ç¨‹Aå¹¶ä¸çŸ¥é“ä¸»å†…å­˜å½“ä¸­å…±äº«å˜é‡flagçš„å–å€¼è¢«æ›´æ”¹äº†ï¼Œçº¿ç¨‹Aä¾ç„¶åœ¨è¿›è¡Œå¾ªç¯æ“ä½œï¼›</span></span><br><span class="line"><span class="comment">      å³while(true)çš„å¾ªç¯æ“ä½œï¼›</span></span><br><span class="line"><span class="comment">      çº¿ç¨‹Aä½¿ç”¨åˆ°çš„å…±äº«å˜é‡ä¾ç„¶è¿˜æ˜¯çº¿ç¨‹Aè‡ªå·±å·¥ä½œå†…å­˜å½“ä¸­ä¹‹å‰ä»ä¸»å†…å­˜ä¸­å¤åˆ¶æ‹·è´è¿‡æ¥çš„flagå…±äº«å˜é‡ä¹Ÿå°±æ˜¯é‚£ä¸ªflag=trueé‚£ä¸ªæ—¶å€™çš„å–å€¼ï¼›</span></span><br><span class="line"><span class="comment">      æ‰€ä»¥çº¿ç¨‹Aå°±ä¸€ç›´å¾ªç¯ä¸€ç›´å¾ªç¯æ ¹æœ¬åœä¸ä¸‹æ¥ï¼›</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      é‚£ä¹ˆé€ æˆè¿™ç§ç°è±¡çš„åŸå› å°±æ˜¯å› ä¸ºï¼š</span></span><br><span class="line"><span class="comment">      ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œä¿®æ”¹äº†å…±äº«å˜é‡å‰¯æœ¬çš„å–å€¼å¹¶ä¸”åŒæ­¥å›äº†ä¸»å†…å­˜å½“ä¸­ï¼›</span></span><br><span class="line"><span class="comment">      ç¬¬äºŒä¸ªçº¿ç¨‹å³æ ¹æ®è¯¥å…±äº«å˜é‡å‰¯æœ¬çš„å–å€¼åšwhileå¾ªç¯çš„çº¿ç¨‹å¹¶æ²¡æœ‰æ„ŸçŸ¥åˆ°ä¸»å†…å­˜å½“ä¸­å…±äº«å˜é‡å–å€¼å‘ç”Ÿçš„å˜åŒ–ï¼Œ</span></span><br><span class="line"><span class="comment">      å› ä¸ºç¬¬äºŒä¸ªçº¿ç¨‹å½“ä¸­ä½¿ç”¨çš„å…±äº«å˜é‡å‰¯æœ¬çš„å–å€¼å¹¶æ²¡æœ‰éšç€ä¸€åŒä¸»å†…å­˜å½“ä¸­çš„å…±äº«å˜é‡å–å€¼æ”¹å˜ï¼›</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      é‚£ä¹ˆè§£å†³æ–¹æ¡ˆæœ‰ä¸¤ç§ï¼›å…ˆç®€å•ä»‹ç»ä¸‹ï¼›æœ‰ä¸€ä¸ªå…³é”®å­—å«åšvolatileï¼›</span></span><br><span class="line"><span class="comment">      ç”¨è¯¥å…³é”®å­—volatileæ¥è¿›è¡Œä¿®é¥°å…±äº«å˜é‡å°±å¯ä»¥è§£å†³å¯è§æ€§é—®é¢˜ï¼›</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä½¿ç”¨<strong>volatile</strong>å…³é”®å­—æ¥è¿›è¡Œè§£å†³å¯è§æ€§é—®é¢˜</p></blockquote><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  æ¡ˆä¾‹æ¼”ç¤ºï¼š</span></span><br><span class="line"><span class="comment">    1. åˆ›å»ºä¸€ä¸ªå…±äº«å˜é‡</span></span><br><span class="line"><span class="comment">    2. åˆ›å»ºä¸€æ¡çº¿ç¨‹ä¸æ–­è¯»å–å…±äº«å˜é‡</span></span><br><span class="line"><span class="comment">    3. åˆ›å»ºä¸€æ¡çº¿ç¨‹ä¿®æ”¹å…±äº«å˜é‡</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test01Visibility</span>&#123;</span></span><br><span class="line">  <span class="comment">// 1. åˆ›å»ºä¸€ä¸ªå…±äº«å˜é‡</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> <span class="keyword">boolean</span> flag = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(<span class="keyword">String</span>[] args)</span>throws InterruptedException</span>&#123;</span><br><span class="line">    <span class="comment">// 2. åˆ›å»ºä¸€æ¡çº¿ç¨‹ä¸æ–­è¯»å–å…±äº«å˜é‡</span></span><br><span class="line">    <span class="keyword">new</span> Thread(()-&gt;&#123;</span><br><span class="line">      <span class="keyword">while</span>(flag)&#123;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;).start();</span><br><span class="line"></span><br><span class="line">    Thread.sleep(<span class="number">2000</span>);<span class="comment">//ä¸»çº¿ç¨‹æ²‰ç¡ä¸¤ç§’</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">new</span> Thread(()-&gt;&#123;</span><br><span class="line">      flag =  <span class="literal">false</span>;</span><br><span class="line">      System.out.<span class="built_in">println</span>(<span class="string">"çº¿ç¨‹ä¿®æ”¹äº†å˜é‡çš„å€¼ä¸ºfalse"</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    é‚£ä¹ˆæ­¤æ—¶å°±éœ€è¦è¿›è¡Œåˆ†æ volatileå…³é”®å­—æ˜¯å¦‚ä½•è¿›è¡Œè§£å†³å¯è§æ€§é—®é¢˜çš„?</span></span><br><span class="line"><span class="comment">    ç®€å•ä»‹ç»ä¸‹ï¼›</span></span><br><span class="line"><span class="comment">    å½“å…±äº«å˜é‡flagæ·»åŠ äº† volatileå…³é”®å­—ä¹‹åï¼Œçº¿ç¨‹Bè¿›è¡Œä¿®æ”¹äº†å…±äº«å˜é‡flagå‰¯æœ¬å–å€¼ä¸ºfalseä¹‹ååŒæ­¥å›ä¸»å†…å­˜æ—¶ï¼›ç”±äºvolatileå…³é”®å­—çš„ä¿®é¥°ï¼Œä¼šæœ‰ä¸€ä¸ªç¼“å­˜ä¸€è‡´æ€§åè®®ï¼›ä¼šæŠŠå…¶ä»–çº¿ç¨‹å½“ä¸­çš„å·¥ä½œå†…å­˜ä¸­çš„è¯¥å…±äº«å˜é‡flagçš„å‰¯æœ¬å…¨éƒ¨è¿›è¡Œè®¾ç½®ä¸ºå¤±æ•ˆçŠ¶æ€ï¼›é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å…¶ä»–çº¿ç¨‹ç”±äºçº¿ç¨‹è‡ªå·±å†…éƒ¨å·¥ä½œå†…å­˜ä¸­éœ€è¦ç”¨åˆ°çš„å…±äº«å˜é‡flagæ•°æ®å¤±æ•ˆçš„ç¼˜æ•…å°±ä¼šé‡æ–°åˆ°ä¸»å†…å­˜å½“ä¸­æ¥è¿›è¡Œè¯»å–æœ€æ–°çš„å…±äº«å˜é‡å–å€¼ï¼›è¿™æ˜¯é‡‡ç”¨volatileçš„è§„åˆ™ï¼›</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    é‚£ä¹ˆç°åœ¨ä¸ä½¿ç”¨volatileï¼Œä½¿ç”¨synchronizedä¹Ÿå¯ä»¥è§£å†³è¿™ä¸ªå¯è§æ€§é—®é¢˜ï¼›</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä½¿ç”¨ <strong>synchronized</strong> å…³é”®å­—æ¥è¿›è¡Œè§£å†³å¯è§æ€§é—®é¢˜</p></blockquote><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">package com.xxx.demo02_concurrent_problem;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    æ¡ˆä¾‹æ¼”ç¤ºï¼š</span></span><br><span class="line"><span class="comment">      ä¸€ä¸ªçº¿ç¨‹æ ¹æ® boolean ç±»å‹çš„æ ‡è®°flagï¼Œwhileå¾ªç¯ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹æ”¹å˜è¿™ä¸ªflagå˜é‡çš„å€¼ï¼Œ</span></span><br><span class="line"><span class="comment">      æ ¹æ®boolean ç±»å‹çš„æ ‡è®°flagè¿›è¡Œwhileå¾ªç¯çš„é‚£ä¸ªçº¿ç¨‹ å¹¶ä¸ä¼šåœæ­¢å¾ªç¯ã€‚</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test01Visibility</span> &#123;</span></span><br><span class="line">    <span class="comment">// å¤šä¸ªçº¿ç¨‹éƒ½ä¼šè®¿é—®çš„æ•°æ®ï¼Œæˆ‘ä»¬ç§°ä¸º çº¿ç¨‹çš„å…±äº«å˜é‡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="built_in">run</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(<span class="keyword">String</span>[] args)</span> throws InterruptedException</span>&#123;</span><br><span class="line">      Thread t1 = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">run</span>)&#123;</span><br><span class="line">          <span class="comment">//å¢åŠ å¯¹è±¡å…±äº«æ•°æ®çš„æ‰“å°ï¼Œprintlnæ˜¯åŒæ­¥æ–¹æ³•</span></span><br><span class="line">          System.out.<span class="built_in">println</span>(<span class="string">"run = "</span> + <span class="built_in">run</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      t1.start();</span><br><span class="line"></span><br><span class="line">      Thread.sleep(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">      Thread t2 = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">        <span class="built_in">run</span> = <span class="literal">false</span>;</span><br><span class="line">        System.out.<span class="built_in">println</span>(<span class="string">"æ—¶é—´åˆ°ï¼Œçº¿ç¨‹2è®¾ç½®ä¸º false"</span>);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  æ¡ˆä¾‹æ¼”ç¤ºï¼š</span></span><br><span class="line"><span class="comment">    1. åˆ›å»ºä¸€ä¸ªå…±äº«å˜é‡</span></span><br><span class="line"><span class="comment">    2. åˆ›å»ºä¸€æ¡çº¿ç¨‹ä¸æ–­è¯»å–å…±äº«å˜é‡</span></span><br><span class="line"><span class="comment">    3. åˆ›å»ºä¸€æ¡çº¿ç¨‹ä¿®æ”¹å…±äº«å˜é‡</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Test01Visibility</span>&#123;</span></span><br><span class="line">  <span class="regexp">// 1. åˆ›å»ºä¸€ä¸ªå…±äº«å˜é‡</span></span><br><span class="line"><span class="regexp">  private static boolean flag = true;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  private static Object obj =  new Object();</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  public static void main(String[] args) throws InterruptedException&#123;</span></span><br><span class="line"><span class="regexp">    //</span> <span class="number">2.</span> åˆ›å»ºä¸€æ¡çº¿ç¨‹ä¸æ–­è¯»å–å…±äº«å˜é‡</span><br><span class="line">    <span class="keyword">new</span> Tread<span class="function"><span class="params">(()-&gt;&#123;</span></span></span><br><span class="line"><span class="function"><span class="params">      <span class="keyword">while</span>(flag)&#123;</span></span></span><br><span class="line"><span class="function"><span class="params">        synchronized(obj)&#123;</span></span></span><br><span class="line"><span class="function"><span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">        &#125;</span></span></span><br><span class="line"><span class="function"><span class="params">      &#125;</span></span></span><br><span class="line"><span class="function"><span class="params">    &#125;)</span>.<span class="title">start</span><span class="params">()</span>;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    <span class="title">Thread</span>.<span class="title">sleep</span><span class="params">(<span class="number">2000</span>)</span>;// ä¸»çº¿ç¨‹æ²‰ç¡ä¸¤ç§’</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    // 3. åˆ›å»ºä¸€æ¡çº¿ç¨‹ä¿®æ”¹å…±äº«å˜é‡</span></span><br><span class="line"><span class="function">    <span class="title">new</span> <span class="title">Thread</span><span class="params">(()-&gt;&#123;</span></span></span><br><span class="line"><span class="function"><span class="params">      flag = <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="function"><span class="params">      System.out.println(<span class="string">"çº¿ç¨‹ä¿®æ”¹äº†å˜é‡çš„å€¼ä¸ºfalse"</span>)</span></span></span><br><span class="line"><span class="function"><span class="params">    &#125;)</span>;</span></span><br><span class="line"><span class="function">  </span></span><br><span class="line"><span class="function">  /**</span></span><br><span class="line"><span class="function">  åˆ†æ<span class="title">synchronized</span>æ˜¯å¦‚ä½•è¿›è¡Œè§£å†³çš„å¯è§æ€§é—®é¢˜ï¼Ÿ</span></span><br><span class="line"><span class="function">  é‚£ä¹ˆ<span class="title">synchronized</span>å…³é”®å­—å…¶å®ä¼šå˜æˆ8ä¸ªåŸå­æ“ä½œå½“ä¸­çš„<span class="title">lock</span>ä¸<span class="title">unlock</span>åŸå­æ“ä½œï¼›</span></span><br><span class="line"><span class="function">  å³8ä¸ªåŸå­æ“ä½œ<span class="params">(ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜ä¹‹é—´å…·ä½“çš„äº¤äº’åè®®)</span>ä¸º</span></span><br><span class="line"><span class="function">  <span class="title">lock</span> --â†’<span class="title">read</span> --â†’ <span class="title">load</span>--â†’ <span class="title">use</span>--â†’ <span class="title">assign</span>--â†’ <span class="title">store</span>--â†’ <span class="title">write</span>--â†’ <span class="title">unlock</span>  </span></span><br><span class="line"><span class="function">  é‚£ä¹ˆè¿™ä¸ª<span class="title">lock</span>åŸå­æ“ä½œä¹‹å‰å°±ä¼šè®©çº¿ç¨‹<span class="title">A</span>å½“ä¸­çš„å·¥ä½œå†…å­˜è¿›è¡Œå»åˆ·æ–°ï¼Œ</span></span><br><span class="line"><span class="function">  ä¹Ÿå°±æ˜¯å¦‚æœçº¿ç¨‹<span class="title">A</span>ä¸­å­˜åœ¨æœ‰è¯¥å…±äº«å˜é‡çš„å‰¯æœ¬ä¼šè¢«æ¸…é™¤ï¼Œ</span></span><br><span class="line"><span class="function">  ç„¶åå†å»è·å–æœ€æ–°çš„å…±äº«å˜é‡<span class="title">flag</span>å–å€¼ï¼›</span></span><br><span class="line"><span class="function">  ä¹Ÿå°±å¯ä»¥å¾—åˆ°æœ€æ–°çš„<span class="title">false</span>å–å€¼ï¼›</span></span><br><span class="line"><span class="function">  ç”±çº¿ç¨‹<span class="title">B</span>è¿›è¡Œä¿®æ”¹å…±äº«å˜é‡å‰¯æœ¬å¹¶åŒæ­¥å›ä¸»å†…å­˜åçš„é‚£ä¸ªæœ€æ–°å€¼ï¼›</span></span><br><span class="line"><span class="function">  </span></span><br><span class="line"><span class="function">  æ‰€ä»¥è¿™ä¸ªæ—¶å€™çš„æ•ˆæœå°±æ˜¯çº¿ç¨‹<span class="title">A</span>å½“ä¸­ç”±äºæ¥æ”¶åˆ°äº†ä¸»å†…å­˜å½“ä¸­å…±äº«å˜é‡æœ€æ–°å–å€¼çš„å‰¯æœ¬<span class="title">flag</span>=<span class="title">false</span>;æ‰€ä»¥å°±ä¼šä¸å†æ‰§è¡Œ<span class="title">while</span>å¾ªç¯ï¼›</span></span><br><span class="line"><span class="function">  å¦å¤–å¯ä»¥ä¸ç”¨è¿›è¡Œå†™ <span class="title">synchronized</span><span class="params">(obj)</span>&#123;&#125; ï¼›</span></span><br><span class="line"><span class="function">  å¯ä»¥ç›´æ¥è¿›è¡Œæ‰“å°ä¹Ÿæ˜¯å¯ä»¥åšåˆ°è§£å†³å¯è§æ€§é—®é¢˜çš„ <span class="title">System</span>.<span class="title">out</span>.<span class="title">println</span><span class="params">(flag)</span>;</span></span><br><span class="line"><span class="function">  </span></span><br><span class="line"><span class="function">  è€Œåˆ†æä¸‹ä¸ºä»€ä¹ˆé€šè¿‡æ‰“å°è¯­å¥<span class="title">System</span>.<span class="title">out</span>.<span class="title">println</span><span class="params">(flag)</span>;ä¹Ÿå¯ä»¥ä½¿å¾—<span class="title">while</span>å¾ªç¯åœä¸‹æ¥å‘¢ï¼Ÿ</span></span><br><span class="line"><span class="function">  åŸå› åœ¨äº<span class="title">PrintStream</span>.<span class="title">java</span>ä¸­çš„<span class="title">println</span><span class="params">(boolean x)</span>æ–¹æ³•ä¸­ä¹Ÿä½¿ç”¨åˆ°äº†<span class="title">synchronized</span>ï¼Œ</span></span><br><span class="line"><span class="function">  æ‰€ä»¥ä¹Ÿå°±å¯¼è‡´ä¹Ÿä¼šå»åˆ·æ–°çº¿ç¨‹<span class="title">A</span>å½“ä¸­å·¥ä½œå†…å­˜å½“ä¸­çš„å˜é‡ä»è€Œå»è·å–ä¸»å†…å­˜å½“ä¸­æœ€æ–°çš„å…±äº«å˜é‡çš„å–å€¼ï¼š</span></span><br><span class="line"><span class="function">  -------------------------------------------------------------------</span></span><br><span class="line"><span class="function">  /**</span></span><br><span class="line"><span class="function">    <span class="title">Prints</span> <span class="title">a</span> <span class="title">boolean</span> <span class="title">and</span> <span class="title">then</span> <span class="title">terminate</span> <span class="title">the</span> <span class="title">line</span>.</span></span><br><span class="line"><span class="function">    <span class="title">This</span> <span class="title">method</span> <span class="title">behaves</span> <span class="title">as</span> <span class="title">though</span> <span class="title">it</span> <span class="title">invokes</span></span></span><br><span class="line"><span class="function">    &lt;<span class="title">code</span>&gt;&#123;@<span class="title">link</span> #<span class="title">print</span><span class="params">(boolean)</span>&#125;&lt;/<span class="title">code</span>&gt; <span class="title">and</span> <span class="title">then</span></span></span><br><span class="line"><span class="function">    &lt;<span class="title">code</span>&gt;&#123;@<span class="title">link</span> #<span class="title">println</span><span class="params">()</span>&#125;&lt;/<span class="title">code</span>&gt;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    @<span class="title">param</span> <span class="title">x</span> <span class="title">The</span> &lt;<span class="title">code</span>&gt;<span class="title">boolean</span>&lt;/<span class="title">code</span>&gt; <span class="title">to</span> <span class="title">be</span> <span class="title">printed</span></span></span><br><span class="line"><span class="function">  */</span></span><br><span class="line"><span class="function">  <span class="title">public</span> <span class="title">void</span> <span class="title">println</span><span class="params">(boolean x)</span>&#123;</span></span><br><span class="line"><span class="function">    <span class="title">synchronized</span><span class="params">(<span class="keyword">this</span>)</span>&#123;</span></span><br><span class="line"><span class="function">      <span class="title">print</span><span class="params">(x)</span>;</span></span><br><span class="line"><span class="function">      <span class="title">newLine</span><span class="params">()</span>;</span></span><br><span class="line"><span class="function">    &#125;</span></span><br><span class="line"><span class="function">  &#125;</span></span><br><span class="line"><span class="function">  -------------------------------------------------------------------</span></span><br><span class="line"><span class="function">  */</span></span><br><span class="line"><span class="function">  &#125;</span></span><br><span class="line"><span class="function">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="synchronized-ä¿è¯å¯è§æ€§çš„åŸç†"><a href="#synchronized-ä¿è¯å¯è§æ€§çš„åŸç†" class="headerlink" title="synchronized ä¿è¯å¯è§æ€§çš„åŸç†"></a>synchronized ä¿è¯å¯è§æ€§çš„åŸç†</h3><p>synchronizedåŒæ­¥çš„æ—¶å€™ä¼šå¯¹åº”8ä¸ªåŸå­æ“ä½œå½“ä¸­çš„lockä¸unlockè¿™ä¸¤ä¸ªåŸå­æ“ä½œï¼›<br>é‚£ä¹ˆlockæ“ä½œæ‰§è¡Œæ—¶å›å»åˆ·æ–°è¯¥çº¿ç¨‹å·¥ä½œå†…å­˜å½“ä¸­å…±äº«å˜é‡çš„å–å€¼ï¼›<br>ä»è€Œè¯¥çº¿ç¨‹å°±ä¼šå»ä¸»å†…å­˜ä¸­å»è·å–å¾—åˆ°æœ€æ–°çš„å€¼ï¼›<br>ä¹Ÿå°±æ˜¯è¯´synchronizedä¼šåˆ·æ–°å·¥ä½œå†…å­˜ä¸­çš„å˜é‡å¾—åˆ°ä¸»å†…å­˜ä¸­æœ€æ–°å…±äº«å˜é‡å–å€¼çš„å‰¯æœ¬ï¼›<br>ä»è€Œä¿è¯å¯è§æ€§ï¼›</p><h3 id="å°ç»“-7"><a href="#å°ç»“-7" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>synchronizedä¿è¯å¯è§æ€§çš„åŸç†</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ‰§è¡Œ<span class="keyword">synchronized</span>æ—¶ï¼Œå…¶å¯¹åº”çš„lockåŸå­æ“ä½œä¼šåˆ·æ–°å·¥ä½œå†…å­˜ä¸­å…±äº«å˜é‡çš„å€¼</span><br></pre></td></tr></table></figure><h2 id="synchronizedä¿è¯æœ‰åºæ€§"><a href="#synchronizedä¿è¯æœ‰åºæ€§" class="headerlink" title="synchronizedä¿è¯æœ‰åºæ€§"></a>synchronizedä¿è¯æœ‰åºæ€§</h2><p>synchronized ä¸ æœ‰åºæ€§</p><h3 id="ç›®æ ‡-8"><a href="#ç›®æ ‡-8" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>å­¦ä¹ ä½¿ç”¨ synchronized ä¿è¯æœ‰åºæ€§çš„åŸç†</p><h3 id="ä¸ºä»€ä¹ˆè¦é‡æ’åº"><a href="#ä¸ºä»€ä¹ˆè¦é‡æ’åº" class="headerlink" title="ä¸ºä»€ä¹ˆè¦é‡æ’åº"></a>ä¸ºä»€ä¹ˆè¦é‡æ’åº</h3><p>ä¸ºäº†æé«˜ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ï¼Œæœ‰å¯èƒ½æ‰€å†™çš„ä»£ç å¯¹CPUæ¥è¯´å…¶æ‰§è¡Œæ•ˆç‡å¹¶ä¸é«˜ï¼›<br>å®ƒå¯èƒ½ç»è¿‡é‡æ’åºä¹‹åæ‰§è¡Œçš„æ•ˆç‡æ›´é«˜ä¸€ç‚¹ï¼›æ‰€ä»¥ç¼–è¯‘å™¨å’ŒCPUä¼šå¯¹ç¨‹åºä¸­çš„ä»£ç è¿›è¡Œé‡æ’åºï¼›ï¼ˆç¼–è¯‘å™¨å’ŒCPUä¸ä¼šè¿›è¡Œä¹±æ’ï¼Œä¼šæ»¡è¶³æŸç§è§„åˆ™ï¼›æ‰€ä»¥å°±æœ‰ä¸€ä¸ª<strong>as-if-serialè¯­ä¹‰</strong>ï¼‰</p><p>é‡æ’åº æ˜¯æŒ‡ ç¼–è¯‘å™¨ å’Œ å¤„ç†å™¨ ä¸ºäº†ä¼˜åŒ–ç¨‹åºæ€§èƒ½ è€Œå¯¹ æŒ‡ä»¤åºåˆ— è¿›è¡Œ é‡æ–°æ’åº çš„ä¸€ç§æ‰‹æ®µã€‚  </p><h3 id="as-if-serialè¯­ä¹‰"><a href="#as-if-serialè¯­ä¹‰" class="headerlink" title="as-if-serialè¯­ä¹‰"></a>as-if-serialè¯­ä¹‰</h3><p>as-if-serial è¯­ä¹‰çš„æ„æ€æ˜¯ï¼š</p><p>ï¼ˆä¸ç®¡ç¼–è¯‘å™¨å’ŒCPUå¦‚ä½•é‡æ’åºã€‚å¿…é¡»ä¿è¯åœ¨å•çº¿ç¨‹æƒ…å†µä¸‹ç¨‹åºçš„ç»“æœæ˜¯æ­£ç¡®çš„ï¼›é‚£ä¹ˆåœ¨å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹å°±æœ‰å¯èƒ½æ˜¯æœ‰é—®é¢˜å­˜åœ¨é—®é¢˜çš„ï¼‰<br>ä¸ç®¡æ€ä¹ˆ é‡æ’åºï¼ˆç¼–è¯‘å™¨å’Œå¤„ç†å™¨ ä¸ºäº†æé«˜ å¹¶è¡Œåº¦ï¼‰ï¼Œå•çº¿ç¨‹ç¨‹åºçš„æ‰§è¡Œç»“æœä¸èƒ½è¢«æ”¹å˜ã€‚<br>ç¼–è¯‘å™¨ã€runtimeå’Œå¤„ç†å™¨ éƒ½å¿…é¡»éµå®ˆ as-if-serial è¯­ä¹‰ã€‚</p><p>ä»¥ä¸‹æ•°æ®æœ‰ä¾èµ–å…³ç³»ï¼Œä¸èƒ½ é‡æ’åºã€‚</p><p>å†™åè¯»ï¼š</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">int <span class="keyword">a</span> = <span class="number">1</span>; <span class="comment"># å¯¹ä¸€ä¸ªå˜é‡è¿›è¡Œå†™æ“ä½œ</span></span><br><span class="line">int b = <span class="keyword">a</span>; <span class="comment"># åœ¨å¯¹ä¸€ä¸ªå˜é‡å†™æ“ä½œå®Œæˆä¹‹ååˆå°†è¯¥å˜é‡çš„å–å€¼è¯»å–å‡ºæ¥</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é‚£ä¹ˆåœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯ä¸èƒ½å¤Ÿè¿›è¡Œé‡æ’åºçš„ï¼›</span></span><br><span class="line"><span class="comment"># å³ä¸èƒ½å¤Ÿæ¢æˆ</span></span><br><span class="line"><span class="comment"># int b = a;</span></span><br><span class="line"><span class="comment"># int a = 1;</span></span><br><span class="line"><span class="comment"># é‚£ä¹ˆåœ¨æ‰§è¡Œ int b = a;çš„æ—¶å€™ï¼Œaæ˜¯æ²¡æœ‰å–å€¼çš„ï¼›</span></span><br></pre></td></tr></table></figure><p>å†™åå†™ï¼š</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a = <span class="number">1</span>; # å…ˆç»™å˜é‡aè¿›è¡Œèµ‹å€¼æ“ä½œå³å†™æ“ä½œï¼›</span><br><span class="line"><span class="keyword">int</span> a = <span class="number">2</span>; # å†æ¥ç»™å˜é‡aè¿›è¡Œèµ‹å€¼æ“ä½œå³å†™æ“ä½œï¼›</span><br><span class="line"></span><br><span class="line"><span class="meta"># é‚£ä¹ˆåœ¨è¿™ç§æƒ…å†µä¸‹ä¹Ÿæ˜¯ä¸èƒ½å¤Ÿè¿›è¡Œé‡æ’åºçš„ï¼›</span></span><br><span class="line"><span class="meta"># å³ä¸èƒ½å¤Ÿæ¢æˆ</span></span><br><span class="line"><span class="meta"># int a = 2;</span></span><br><span class="line"><span class="meta"># int a = 1;</span></span><br><span class="line"><span class="meta"># çš„è¿™æ ·ä¸€ç§æƒ…å†µï¼Œ</span></span><br><span class="line"><span class="meta"># å› ä¸ºåœ¨æ‰§è¡ŒåŸæ¥æ²¡æœ‰é‡æ’åºçš„ä»£ç æ—¶æœ€ç»ˆè·å–å¾—åˆ°aå˜é‡çš„ç»“æœä¸º2ï¼›</span></span><br><span class="line"><span class="meta"># è€Œç»è¿‡é‡æ’åºä¹‹åaå˜é‡çš„å–å€¼è¢«é‡æ–°èµ‹å€¼ä¸ºäº†1ï¼›</span></span><br><span class="line"><span class="meta"># å¯¼è‡´æ•°æ®æœ€ç»ˆç»“æœçš„ä¸æ­£ç¡®æ€§ï¼›</span></span><br><span class="line"><span class="meta"># æ‰€ä»¥åœ¨è¿™ç§æƒ…å†µä¸‹ä¹Ÿæ˜¯ä¸èƒ½å¤Ÿè¿›è¡Œé‡æ’åºï¼›</span></span><br></pre></td></tr></table></figure><p>è¯»åå†™ï¼š</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a = <span class="number">1</span>; # ç»™å˜é‡aè¿›è¡Œèµ‹å€¼å†™æ“ä½œ</span><br><span class="line"><span class="keyword">int</span> b = a; # å°†å˜é‡açš„å–å€¼è¿›è¡Œè¯»å–å‡ºæ¥</span><br><span class="line"><span class="keyword">int</span> a = <span class="number">2</span>; # å†å°†å˜é‡açš„å–å€¼è¿›è¡Œé‡æ–°èµ‹å€¼</span><br><span class="line"></span><br><span class="line"><span class="meta"># è¿™ç§æƒ…å†µä¸‹ä¹Ÿæ˜¯ä¸èƒ½å¤Ÿè¿›è¡Œé‡æ’åºçš„ï¼›</span></span><br><span class="line"><span class="meta"># å³ä¸èƒ½å¤Ÿæ¢æˆ</span></span><br><span class="line"><span class="meta"># int a = 1;</span></span><br><span class="line"><span class="meta"># int a = 2;</span></span><br><span class="line"><span class="meta"># int b = a;</span></span><br><span class="line"><span class="meta"># è¿™æ ·ä¸€ç§é¡ºåºï¼›</span></span><br><span class="line"><span class="meta"># å¦‚æœæ˜¯è¿™æ ·æ’åºçš„è¯ï¼›å°†ä¼šå¯¼è‡´å˜é‡bå–å€¼çš„å˜åŒ–ï¼›</span></span><br><span class="line"><span class="meta"># åœ¨åŸæ¥æ²¡æœ‰è¿›è¡Œé‡æ’åºçš„æ—¶å€™å˜é‡båŸæœ¬æ­£ç¡®èµ‹æœ‰çš„å€¼åº”è¯¥æ˜¯1ï¼›</span></span><br><span class="line"><span class="meta"># è€Œå½“é‡æ–°æ’åºä¹‹åå˜é‡bçš„å–å€¼å‘ç”Ÿäº†æ”¹å˜ï¼Œå³å˜æˆäº†2ï¼›</span></span><br><span class="line"><span class="meta"># åŒæ ·æ˜¯å¯¼è‡´äº†æ•°æ®çš„æœ€ç»ˆä¸æ­£ç¡®æ€§ï¼›</span></span><br><span class="line"><span class="meta"># æ‰€ä»¥åœ¨è¿™ç§æƒ…å†µä¸‹ä¹Ÿæ˜¯ä¸èƒ½å¤Ÿè¿›è¡Œé‡æ’åºçš„ï¼›</span></span><br></pre></td></tr></table></figure><p>ç¼–è¯‘å™¨ å’Œ å¤„ç†å™¨ä¸ä¼šå¯¹ å­˜åœ¨æ•°æ®ä¾èµ–å…³ç³»çš„ æ“ä½œ åšé‡æ’åºï¼Œ<br>å› ä¸ºè¿™ç§ é‡æ’åº ä¼šæ”¹å˜æ‰§è¡Œç»“æœã€‚</p><p>ä½†æ˜¯ï¼Œå¦‚æœæ“ä½œä¹‹é—´ ä¸å­˜åœ¨æ•°æ®ä¾èµ–å…³ç³»ï¼Œè¿™äº›æ“ä½œå°±å¯èƒ½è¢« ç¼–è¯‘å™¨å’Œå¤„ç†å™¨ é‡æ’åºã€‚</p><p>ï¼ˆåœ¨æœ‰äº›æ—¶å€™æ˜¯å¯ä»¥è¿›è¡Œé‡æ’åºçš„ï¼›åªè¦æ²¡æœ‰å½±å“åˆ°å•çº¿ç¨‹æ‰§è¡Œè¿è¡Œç»“æœçš„æ­£ç¡®æ€§ï¼›æ¯”å¦‚è¯´ä¸‹é¢è¿™ç§æƒ…å†µå°±æ˜¯å¯ä»¥è¿›è¡Œé‡æ’åºçš„ï¼›å³int a =1;int b=2;è¿™ä¸¤å¥ä»£ç æ˜¯å¯ä»¥è¿›è¡Œäº’æ¢ä½ç½®çš„ï¼›å½¼æ­¤äº’ä¸å½±å“ï¼›å³int b = 2; int a=1;ä½†æ˜¯int c =a +b;ä¸€å®šè¦å¤„äºæœ€ä¸‹é¢ï¼›å¦åˆ™ä¸èƒ½å¾—åˆ°å˜é‡aä¸å˜é‡bçš„å–å€¼ï¼›ï¼‰</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">int a</span> = 1;</span><br><span class="line"><span class="attribute">int b</span> = 2;</span><br><span class="line"><span class="attribute">int c</span> = a + b;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢3ä¸ªæ“ä½œçš„æ•°æ®ä¾èµ–å…³ç³»å¦‚å›¾æ‰€ç¤ºï¼š</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">-------------------------------------------</span><br><span class="line">                                  ---------</span><br><span class="line">-------                            |<span class="string">     </span>|</span><br><span class="line">|<span class="string">  a  </span>|<span class="string">---------------------------â†’</span>|<span class="string">     </span>|</span><br><span class="line">-------                            |<span class="string">     </span>|</span><br><span class="line">                                   |<span class="string">  c  </span>|</span><br><span class="line">-------                            |<span class="string">     </span>|</span><br><span class="line">|<span class="string">  b  </span>|<span class="string">---------------------------â†’</span>|<span class="string">     </span>|</span><br><span class="line">-------                            |<span class="string">     </span>|</span><br><span class="line">                                  ---------</span><br><span class="line">-------------------------------------------</span><br><span class="line">/<span class="symbol">*</span><span class="symbol">*</span></span><br><span class="line">å³ å˜é‡c ä¾èµ– å˜é‡aä¸å˜é‡b çš„å–å€¼ï¼›</span><br><span class="line">ä½†æ˜¯ å˜é‡a ä¸ å˜é‡b å¹¶æ²¡æœ‰ç›´æ¥çš„ä¾èµ–å…³ç³»ï¼›</span><br><span class="line">æ‰€ä»¥è¿™ç§æƒ…å†µä¸‹æ˜¯å¯ä»¥è¿›è¡Œé‡æ’åºçš„ï¼›</span><br><span class="line"><span class="symbol">*</span>/</span><br></pre></td></tr></table></figure><p>å¦‚ä¸Šå›¾æ‰€ç¤º aå’Œc ä¹‹é—´å­˜åœ¨æ•°æ®ä¾èµ–å…³ç³»ï¼Œ<br>åŒæ—¶ bå’Œc ä¹‹é—´ä¹Ÿå­˜åœ¨æ•°æ®ä¾èµ–å…³ç³»ã€‚<br>å› æ­¤åœ¨æœ€ç»ˆæ‰§è¡Œçš„æŒ‡ä»¤åºåˆ—ä¸­ï¼Œ<br>c ä¸èƒ½è¢«é‡æ’åºåˆ° aå’Œb çš„å‰é¢ã€‚<br>ä½† aå’Œb ä¹‹é—´æ²¡æœ‰æ•°æ®ä¾èµ–å…³ç³»ï¼Œ<br>ç¼–è¯‘å™¨å’Œå¤„ç†å™¨ å¯ä»¥é‡æ’åº aå’Œb ä¹‹é—´çš„æ‰§è¡Œé¡ºåºã€‚<br>ä¸‹å›¾æ˜¯è¯¥ç¨‹åºçš„ä¸¤ç§æ‰§è¡Œé¡ºåºã€‚</p><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">--<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span></span><br><span class="line">--<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>         --<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>         --<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span></span><br><span class="line"><span class="comment">|</span>  <span class="comment">a</span>  <span class="comment">|</span>--<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">â†’|</span>  <span class="comment">b</span>  <span class="comment">|</span>--<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">â†’|</span>  <span class="comment">c</span>  <span class="comment">|</span></span><br><span class="line"><span class="comment"></span>--<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>         --<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>         --<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span></span><br><span class="line"></span><br><span class="line">--<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>         --<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>         --<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span></span><br><span class="line"><span class="comment">|</span>  <span class="comment">b</span>  <span class="comment">|</span>--<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">â†’|</span>  <span class="comment">a</span>  <span class="comment">|</span>--<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="comment">â†’|</span>  <span class="comment">c</span>  <span class="comment">|</span></span><br><span class="line"><span class="comment"></span>--<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>         --<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span>         --<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span></span><br><span class="line">--<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span></span><br><span class="line"></span><br><span class="line"><span class="comment">å¯ä»¥è¿™æ ·ï¼š</span></span><br><span class="line"><span class="comment">int</span> <span class="comment">a</span> <span class="comment">=</span> <span class="comment">1;</span></span><br><span class="line"><span class="comment">int</span> <span class="comment">b</span> <span class="comment">=</span> <span class="comment">2;</span></span><br><span class="line"><span class="comment">int</span> <span class="comment">c</span> <span class="comment">=</span> <span class="comment">a</span> <span class="literal">+</span> <span class="comment">b;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">ä¹Ÿå¯å¯ä»¥é‡æ’åºè¿™æ ·ï¼š</span></span><br><span class="line"><span class="comment">int</span> <span class="comment">b</span> <span class="comment">=</span> <span class="comment">2;</span></span><br><span class="line"><span class="comment">int</span> <span class="comment">a</span> <span class="comment">=</span> <span class="comment">1;</span></span><br><span class="line"><span class="comment">int</span> <span class="comment">c</span> <span class="comment">=</span> <span class="comment">a</span> <span class="literal">+</span> <span class="comment">b;</span></span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨synchronizedä¿è¯æœ‰åºæ€§"><a href="#ä½¿ç”¨synchronizedä¿è¯æœ‰åºæ€§" class="headerlink" title="ä½¿ç”¨synchronizedä¿è¯æœ‰åºæ€§"></a>ä½¿ç”¨synchronizedä¿è¯æœ‰åºæ€§</h3><p>Test03Ordering.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xxx.concurrent_problem;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.openjdk.jcstress.annotations.*;</span><br><span class="line"><span class="keyword">import</span> org.openjdk.jcstress.results.I_Result;</span><br><span class="line"></span><br><span class="line"><span class="meta">@JCStressTest</span></span><br><span class="line"><span class="meta">@Outcome</span>(id = &#123;<span class="string">"1"</span>, <span class="string">"4"</span>&#125;, expect = Expect.ACCEPTABLE, desc = <span class="string">"ok"</span>)</span><br><span class="line"><span class="meta">@OUtcome</span>(id = <span class="string">"0"</span>, expect =  Expect.ACCEPTABLE_INTERESTING, desc = <span class="string">"danger"</span>)</span><br><span class="line"><span class="meta">@State</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test03Ordering</span></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">boolean</span> ready = <span class="keyword">false</span>;</span><br><span class="line">  <span class="comment">// çº¿ç¨‹ä¸€ æ‰§è¡Œçš„ä»£ç </span></span><br><span class="line">  <span class="meta">@Actor</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actor1</span><span class="params">(I_Result r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(ready)&#123;</span><br><span class="line">      r.r1 = num + num;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      r.r1 = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// çº¿ç¨‹äºŒ æ‰§è¡Œçš„ä»£ç </span></span><br><span class="line">  <span class="meta">@Actor</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actor2</span><span class="params">(I_Result r)</span></span>&#123;</span><br><span class="line">    num = <span class="number">2</span>;</span><br><span class="line">    ready = <span class="keyword">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å›é¡¾ä»£ç åˆ†ææœ‰åºæ€§é—®é¢˜äº§ç”Ÿçš„åŸå› </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@JCStressTest</span></span><br><span class="line"><span class="meta">@Outcome</span>( id = &#123;<span class="string">"1"</span>, <span class="string">"4"</span>&#125;, expect =  Expect.ACCEPTABLE, desc=<span class="string">"ok"</span>)</span><br><span class="line"><span class="meta">@Outcome</span>( id = <span class="string">"0"</span>, expect =  Expect.ACCEPTABLE_INTERESTING, desc=<span class="string">"danger"</span>)</span><br><span class="line"><span class="meta">@State</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test03Ordering</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">boolean</span> ready = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// çº¿ç¨‹ä¸€ æ‰§è¡Œçš„ä»£ç </span></span><br><span class="line">  <span class="meta">@Actor</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actor1</span><span class="params">(I_Result r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(ready)&#123;</span><br><span class="line">      r.r1 = num + num;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      r.r1 = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//çº¿ç¨‹äºŒ æ‰§è¡Œçš„ä»£ç </span></span><br><span class="line">  <span class="meta">@Actor</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actor2</span><span class="params">(I_Result r)</span></span>&#123;</span><br><span class="line">    num = <span class="number">2</span>;</span><br><span class="line">    ready = <span class="keyword">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">  ä»¥å‰ä¼šè§‚å¯Ÿå¾—åˆ°4ç§å¯èƒ½æ€§ï¼›3ç§ç»“æœä¸º0,1,4</span></span><br><span class="line"><span class="comment">  åˆ†æå›é¡¾ä¸‹ï¼š</span></span><br><span class="line"><span class="comment">  å‡è®¾æœ‰ä¸¤ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œï¼›åˆ†åˆ«æ˜¯çº¿ç¨‹Aä¸çº¿ç¨‹Bï¼›</span></span><br><span class="line"><span class="comment">  çº¿ç¨‹Aæ‰§è¡Œactor1(I_Result r)ï¼›çº¿ç¨‹Bæ‰§è¡Œactor2(I_Result r)ï¼›</span></span><br><span class="line"><span class="comment">  å½“åˆå‡ºç°0çš„ç»“æœæ˜¯è¿™æ ·æ¥çš„ï¼š</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  æ˜¯actor2(I_Result r)å½“ä¸­çš„ä»£ç </span></span><br><span class="line"><span class="comment">  num = 2;</span></span><br><span class="line"><span class="comment">  ready = true;</span></span><br><span class="line"><span class="comment">  ç»è¿‡äº†é‡æ’åºå˜æˆäº†</span></span><br><span class="line"><span class="comment">  ready = true;</span></span><br><span class="line"><span class="comment">  num = 2;</span></span><br><span class="line"><span class="comment">  çš„ä¸€ä¸ªé¡ºåºï¼›</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  å‡è®¾ä¸‹é¢çš„è¿™ä¸ªçº¿ç¨‹ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œactor2(I_Result r)çš„çº¿ç¨‹Bå…ˆèµ°ï¼›</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆèµ°äº†ç¬¬ä¸€å¥ä¹Ÿå°±æ˜¯æ‰§è¡Œäº†ç¬¬ä¸€å¥ready=trueè¯¥å¥è¯ï¼›</span></span><br><span class="line"><span class="comment">  ä½†æ˜¯æ³¨æ„å¹¶æ²¡æœ‰æ‰§è¡Œnum=2;</span></span><br><span class="line"><span class="comment">  æ‰€ä»¥æ­¤æ—¶å…±äº«å˜é‡å½“ä¸­çš„numä»ç„¶ä¸º0ï¼›è€Œreadyä¸ºtrue;</span></span><br><span class="line"><span class="comment">  ç„¶åæ­¤æ—¶CPUåˆ‡æ¢çº¿ç¨‹åˆ°äº†ç¬¬äºŒä¸ªçº¿ç¨‹å½“ä¸­æ¥äº†ï¼›</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆè¿™ä¸ªæ—¶å€™çº¿ç¨‹Aè¿›è¡Œæ‰§è¡Œactor1(I_Result r)æ–¹æ³•ï¼›</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆè¿™ä¸ªæ—¶å€™çº¿ç¨‹Aå°±ä¼šè¿›å…¥åˆ°åˆ¤æ–­if(ready)&#123;&#125;ä»£ç å—ä¸­ï¼›</span></span><br><span class="line"><span class="comment">  å› ä¸ºæ­¤æ—¶è·å–å¾—åˆ°çš„readyå˜é‡å·²ç»ç”±çº¿ç¨‹Båœ¨actor2(I_Result r)ä¸­è¿›è¡Œäº†ä¿®æ”¹å–å€¼ï¼›</span></span><br><span class="line"><span class="comment">  æ‰€ä»¥ä¹Ÿå°±ä¼šå¾—åˆ° r.r1 = num + num;</span></span><br><span class="line"><span class="comment">  è€Œæ­¤æ—¶çš„numå¹¶æœªè¢«é‡æ–°èµ‹å€¼ä¹Ÿå°±æ˜¯è¯´æ­¤æ—¶çš„numä¾æ—§æ˜¯å–å€¼ä¸º0ï¼›</span></span><br><span class="line"><span class="comment">  æ‰€ä»¥å¾—åˆ°ç»“æœè®°å½• r.r1 ä¸º0ï¼›</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆè¿™æ˜¯ä¹‹å‰å‡ºç°çš„æœ‰åºæ€§é—®é¢˜åˆ†æï¼›</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆç°åœ¨æ¥è¿›è¡Œæ·»åŠ synchronizedæ¥è§£å†³æœ‰åºæ€§é—®é¢˜ï¼›</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>synchronizedå…³é”®å­—è§£å†³æœ‰åºæ€§é—®é¢˜</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@JCStressTest</span></span><br><span class="line"><span class="meta">@Outcome</span>(id = &#123;<span class="string">"1"</span> , <span class="string">"4"</span>&#125;, expect = Expect.ACCEPTABLE, desc = <span class="string">"ok"</span>)</span><br><span class="line"><span class="meta">@Outcome</span>(id = <span class="string">"0"</span>, expect = Expect.ACCEPTABLE_INTERESTING, desc = <span class="string">"danger"</span>)</span><br><span class="line"><span class="meta">@State</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test03Ordering</span></span>&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// å…ˆæä¸€ä¸ªå¯¹è±¡ä½œä¸ºå¯¹è±¡é”</span></span><br><span class="line">  <span class="keyword">private</span> Object obj = <span class="keyword">new</span> Object();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">boolean</span> ready = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// çº¿ç¨‹ä¸€ æ‰§è¡Œçš„ä»£ç </span></span><br><span class="line">  <span class="comment">// æµ‹è¯•æ–¹æ³•actor1(I_Result r)è¿›è¡Œæ·»åŠ synchronized</span></span><br><span class="line">  <span class="meta">@Actor</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actor1</span><span class="params">(I_Result r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">synchronized</span>(obj)&#123;</span><br><span class="line">       <span class="keyword">if</span>(ready)&#123;</span><br><span class="line">         r.r1 = num + num;</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">         r.r1 = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// çº¿ç¨‹äºŒ æ‰§è¡Œçš„ä»£ç </span></span><br><span class="line">  <span class="comment">// ä¸‹é¢çš„æµ‹è¯•æ–¹æ³•actor2(I_Result r)åŒæ ·è¿›è¡Œæ·»åŠ synchronized</span></span><br><span class="line">  <span class="meta">@Actor</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actor2</span><span class="params">(I_Result r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">synchronized</span>(obj)&#123;</span><br><span class="line">     num = <span class="number">2</span>;</span><br><span class="line">     ready = <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å‹åŠ›æµ‹è¯•æŒ‡ä»¤ä»¥åŠç»“æœæŸ¥çœ‹</p></blockquote><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line">Terminalæ‰§è¡ŒæŒ‡ä»¤(è¿›è¡Œå¤šè½®å‹åŠ›æµ‹è¯•)ï¼š</span><br><span class="line"></span><br><span class="line">C:\Users\<span class="number">13666</span>\IdeaProjects\XXX\Synchronized&gt; mvn clean install</span><br><span class="line">C:\Users\<span class="number">13666</span>\IdeaProjects\XXX\Synchronized&gt; java -jar target/jcstress.jar</span><br><span class="line"></span><br><span class="line">æµ‹è¯•ç»“æœæ‰“å°ï¼š</span><br><span class="line">------------------------------------------------------------------</span><br><span class="line">    [OK] com.xxx.demo02_concurrent_problem.Test03Ordering</span><br><span class="line">(ETA:  <span class="number">00</span>:<span class="number">00</span>:<span class="number">01</span>) (Rate: <span class="number">4.15E+07</span> samples/sec) (Tests: <span class="number">1</span> of <span class="number">1</span>) (Forks: <span class="number">4</span> of <span class="number">4</span>) (Iterations: <span class="number">15</span> of <span class="number">24</span>; <span class="number">15</span> passed, <span class="number">0</span> failed, <span class="number">0</span> soft errs, <span class="number">0</span> hard....)</span><br><span class="line"></span><br><span class="line">    [OK] com.xxx.demo02_concurrent_problem.Test03Ordering</span><br><span class="line">(ETA:  <span class="number">00</span>:<span class="number">00</span>:<span class="number">01</span>) (Rate: <span class="number">3.97E+07</span> samples/sec) (Tests: <span class="number">1</span> of <span class="number">1</span>) (Forks: <span class="number">4</span> of <span class="number">4</span>) (Iterations: <span class="number">15</span> of <span class="number">24</span>; <span class="number">15</span> passed, <span class="number">0</span> failed, <span class="number">0</span> soft errs, <span class="number">0</span> hard....)</span><br><span class="line"></span><br><span class="line">    [OK] com.xxx.demo02_concurrent_problem.Test03Ordering</span><br><span class="line">(ETA:  <span class="number">00</span>:<span class="number">00</span>:<span class="number">01</span>) (Rate: <span class="number">3.53E+07</span> samples/sec) (Tests: <span class="number">1</span> of <span class="number">1</span>) (Forks: <span class="number">4</span> of <span class="number">4</span>) (Iterations: <span class="number">15</span> of <span class="number">24</span>; <span class="number">15</span> passed, <span class="number">0</span> failed, <span class="number">0</span> soft errs, <span class="number">0</span> hard....)</span><br><span class="line"></span><br><span class="line">    [OK] com.xxx.demo02_concurrent_problem.Test03Ordering</span><br><span class="line">(ETA:  <span class="number">00</span>:<span class="number">00</span>:<span class="number">01</span>) (Rate: <span class="number">3.83E+07</span> samples/sec) (Tests: <span class="number">1</span> of <span class="number">1</span>) (Forks: <span class="number">4</span> of <span class="number">4</span>) (Iterations: <span class="number">15</span> of <span class="number">24</span>; <span class="number">15</span> passed, <span class="number">0</span> failed, <span class="number">0</span> soft errs, <span class="number">0</span> hard....)</span><br><span class="line"></span><br><span class="line">.....</span><br><span class="line">------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">ç»“æœåˆ†æï¼š</span><br><span class="line">  å‘ç°å¹¶æ²¡æœ‰å‡ºç°é‚£å‡ ç§ç»“æœå‡ºç°çš„æ¬¡æ•°ï¼›</span><br><span class="line">  è¯´æ˜è¿™ä¸ªä»£ç å°±æ²¡æœ‰é—®é¢˜ï¼›å³æ²¡æœ‰å‡ºç°è¿™ç§<span class="number">0</span>çš„æƒ…å†µï¼›</span><br><span class="line">  å¦‚æœçœŸçš„æƒ³çœ‹çš„è¯ï¼›å¯ä»¥è¿™ä¹ˆåšï¼›</span><br><span class="line">  å‡è®¾å°†å–å€¼ä¸º<span class="number">4</span>ä¹Ÿå˜ä¸ºæ„Ÿå…´è¶£çš„åˆ™é‡æ–°æ¥è¿›è¡Œå‹åŠ›æµ‹è¯•</span><br><span class="line"></span><br><span class="line">@JCStressTest</span><br><span class="line">@Outcome(id = <span class="string">"1"</span>, expect = Expect.ACCEPTABLE, desc = <span class="string">"ok"</span>)</span><br><span class="line">@Outcome(id = <span class="string">"4"</span>, expect = Expect.ACCEPTABLE_INTERESTING, desc = <span class="string">"danger2"</span>)</span><br><span class="line">@Outcome(id = <span class="string">"0"</span>, expect = Expect.ACCEPTABLE_INTERESTING, desc = <span class="string">"danger"</span>)</span><br><span class="line">@State</span><br><span class="line">.....</span><br><span class="line"></span><br><span class="line">Terminalæ‰§è¡ŒæŒ‡ä»¤(è¿›è¡Œå¤šè½®å‹åŠ›æµ‹è¯•)ï¼š</span><br><span class="line"></span><br><span class="line">C:\Users\<span class="number">13666</span>\IdeaProjects\XXX\Synchronized&gt; mvn clean install</span><br><span class="line">C:\Users\<span class="number">13666</span>\IdeaProjects\XXX\Synchronized&gt; java -jar target/jcstress.jar</span><br><span class="line"></span><br><span class="line">æµ‹è¯•ç»“æœæ‰“å°ï¼š</span><br><span class="line">      [OK] com.xxx.demo02_concurrent_problem.Test03Ordering</span><br><span class="line">    (JVM args: [-XX:TieredStopAtLevel=<span class="number">1</span>])</span><br><span class="line">Observed state Occurrences         Expectation     Interpretation</span><br><span class="line">             <span class="number">0</span>       <span class="number">0</span>      ACCEPTABLE_INTERESTING  danger</span><br><span class="line">             <span class="number">1</span>   <span class="number">5</span>,<span class="number">427</span>,<span class="number">079</span>          ACCEPTABLE      ok</span><br><span class="line">             <span class="number">4</span>   <span class="number">5</span>,<span class="number">672</span>,<span class="number">602</span>  ACCEPTABLE_INTERESTING  danger2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    [OK] com.xxx.demo02_concurrent_probleam.Test03Ordering</span><br><span class="line">  ï¼ˆJVM args: []ï¼‰</span><br><span class="line">Observed state Occurrences         Expectation     Interpretation</span><br><span class="line">             <span class="number">0</span>       <span class="number">0</span>      ACCEPTABLE_INTERESTING  danger</span><br><span class="line">             <span class="number">1</span>  <span class="number">42</span>,<span class="number">176</span>,<span class="number">771</span>          ACCEPTABLE      ok</span><br><span class="line">             <span class="number">4</span>  <span class="number">26</span>,<span class="number">991</span>,<span class="number">710</span>  ACCEPTABLE_INTERESTING  danger2</span><br><span class="line">....</span><br><span class="line">------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">ç»“æœåˆ†æï¼š</span><br><span class="line">  æ­¤æ—¶å¯ä»¥çœ‹åˆ°çš„æ˜¯å‡ºç°<span class="number">0</span>çš„æ­¤æ—¶å·²ç»ä¸º<span class="number">0</span>äº†ï¼›</span><br><span class="line">  å³éƒ½ä¸ä¼šå†å‡ºç°<span class="number">0</span>äº†ä¹Ÿå°±è¡¨ç¤ºæœ‰åºæ€§é—®é¢˜å¾—åˆ°äº†è§£å†³ï¼›</span><br><span class="line"></span><br><span class="line">åˆ†æsynchronizedæ˜¯å¦‚ä½•è¿›è¡Œè§£å†³æœ‰åºæ€§é—®é¢˜çš„ï¼Ÿ</span><br><span class="line">å½“å‰å‡è®¾actor2(I_Result r)å½“ä¸­çš„ä»£ç å·²ç»å‡ºç°äº†é‡æ’åºï¼Œ</span><br><span class="line">å³</span><br><span class="line">num = <span class="number">2</span>;</span><br><span class="line">ready = <span class="literal">true</span>;</span><br><span class="line">å˜ä¸ºäº†</span><br><span class="line">ready = <span class="literal">true</span>;</span><br><span class="line">num = <span class="number">2</span>;</span><br><span class="line">è¿™æ ·ä¸€ä¸ªé¡ºåºï¼›</span><br><span class="line"></span><br><span class="line">å…¶å®ä¼šäº§ç”Ÿå¾ˆå¤šçš„çº¿ç¨‹æ¥æ‰§è¡Œactor1(I_Result r)ä¸actor2(I_Result r)æ–¹æ³•ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ä¸¾ä¾‹å„æœ‰ä¸€ä¸ªçº¿ç¨‹Aã€Bæ¥åˆ†åˆ«è¿›è¡Œæ‰§è¡Œactor1(I_Result r)ä¸actor2(I_Result r)ï¼›</span><br><span class="line">é‚£ä¹ˆè¿˜æ˜¯ä¸€æ ·å‡è®¾ä¸‹é¢çš„çº¿ç¨‹å…ˆèµ°ï¼Œå³çº¿ç¨‹Bå…ˆæ¥æ‰§è¡Œä»£ç å—actor2(I_Result r)å½“ä¸­çš„åŒæ­¥ä»£ç å—ï¼›</span><br><span class="line">é‚£ä¹ˆçº¿ç¨‹Bå°±ä¼šæ‹¿ç€å¯¹è±¡é”Object objè¿›å…¥actor2(I_Result r)çš„åŒæ­¥ä»£ç å—å½“ä¸­æ‰§è¡Œå·²ç»é‡æ’åºè¿‡äº†çš„ä»£ç å³ï¼›</span><br><span class="line">ready = <span class="literal">true</span>;</span><br><span class="line">num = <span class="number">2</span>;</span><br><span class="line">é‚£ä¹ˆæ‹¿ç€å¯¹è±¡é”objçš„çº¿ç¨‹Bå°±å…ˆä¼šå»æ‰§è¡Œready=<span class="literal">true</span>è¯¥å¥ä»£ç ï¼›</span><br><span class="line">é‚£ä¹ˆå‡è®¾æ­¤æ—¶CPUåˆåˆ‡æ¢åˆ°å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä¸Šé¢å»äº†ï¼Œ</span><br><span class="line">æ³¨æ„æ˜¯åœ¨çº¿ç¨‹Bæ‰§è¡Œready=<span class="literal">true</span>;ä¹‹åä½†æ˜¯å¹¶æ²¡æœ‰æ‰§è¡Œnum=<span class="number">2</span>è¯¥å¥ä»£ç ä¹‹å‰è¿›è¡Œäº†CPUåˆ‡æ¢ï¼›</span><br><span class="line">ä¹Ÿå°±æ˜¯è¯´å½“å‰çš„å…±äº«å˜é‡å½“ä¸­numå–å€¼ä»ç„¶ä¸º<span class="number">0</span>ï¼›ä½†æ˜¯readyçš„å–å€¼å·²ç»å˜ä¸ºäº†<span class="literal">true</span>ï¼›</span><br><span class="line">å³åˆ‡æ¢åˆ°çº¿ç¨‹Aä¸Šå»æ‰§è¡Œactor1(I_Result r)æ–¹æ³•å½“ä¸­çš„åŒæ­¥ä»£ç å—äº†ï¼›</span><br><span class="line">é‚£ä¹ˆåˆ°actor1(I_Result r)å½“ä¸­æ¥çœ‹ï¼Œ</span><br><span class="line">çº¿ç¨‹Aå¦‚æœæƒ³è¦è¿›å…¥åŒæ­¥ä»£ç å—åˆ™é¦–å…ˆéœ€è¦å»è·å–æ‹¿åˆ°å¯¹è±¡é”Object objï¼›</span><br><span class="line">ä½†æ˜¯è¯¥å¯¹è±¡é”Object objç°åœ¨ä»ç„¶åœ¨çº¿ç¨‹Bå½“ä¸­ï¼Œ</span><br><span class="line">å³çº¿ç¨‹Bè·å–æ‹¿åˆ°å¯¹è±¡é”objä¹‹åè¿˜æ²¡æœ‰é‡Šæ”¾é”æ²¡æœ‰æ‰§è¡Œå®Œæˆï¼Œ</span><br><span class="line">CPUå°±åˆ‡æ¢åˆ°äº†çº¿ç¨‹Aä¸Šäº†ï¼Œ</span><br><span class="line">å¯¼è‡´çº¿ç¨‹Aæ²¡æœ‰åŠæ³•æ‹¿åˆ°è·å–å¯¹è±¡é”Object objï¼Œ</span><br><span class="line">ä»è€Œåªèƒ½å¤Ÿåœ¨åŒæ­¥ä»£ç å—å¤–ä¾§è¿›è¡Œç­‰å¾…ï¼›</span><br><span class="line"></span><br><span class="line">ç­‰å¾…CPUåˆåˆ‡æ¢åˆ°çº¿ç¨‹Bä¸Šï¼Œè®©çº¿ç¨‹Bæ‰§è¡Œå®Œæµç¨‹åé‡Šæ”¾é”ï¼›</span><br><span class="line">è¿™ä¸ªæ—¶å€™CPUå†åˆ‡æ¢åˆ°çº¿ç¨‹Bä¸Šæ—¶ï¼Œæ²¡æœ‰å…¶å®ƒçº¿ç¨‹ç«äº‰çš„è¯ï¼Œ</span><br><span class="line">é‚£ä¹ˆè¿™ä¸ªæ—¶å€™çº¿ç¨‹Bå°±èƒ½å¤Ÿè·å–å¾—åˆ°å¯¹è±¡é”ä»è€Œè¿›å…¥åŒæ­¥ä»£ç å—å½“ä¸­ï¼›</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥æ¥çœ‹ï¼Œå³ä½¿actor2(I_Result r)å½“ä¸­çš„ä»£ç å‘ç”Ÿäº†é‡æ’åºï¼Œä¹Ÿæ²¡æœ‰é—®é¢˜äº†ï¼›</span><br><span class="line">æ¥ç€CPUåˆåˆ‡æ¢åˆ°çº¿ç¨‹Bä¸Šæ¥æ‰§è¡Œactor2(I_Result r)æ²¡æœ‰æ‰§è¡Œå®Œæˆçš„å†…å®¹ï¼›</span><br><span class="line">å³æ‰§è¡Œnum = <span class="number">2</span>; é‚£ä¹ˆè¿™ä¸ªæ—¶å€™æ­¤æ—¶çš„å…±äº«å˜é‡ numè¢«æ›´æ–°èµ‹å€¼ä¸º<span class="number">2</span>ï¼Œä»¥åŠreadyå–å€¼ä¸º<span class="literal">true</span>ï¼›</span><br><span class="line">æœ€åçº¿ç¨‹Bå‡ºåŒæ­¥ä»£ç å—ï¼Œå‡ºäº†åŒæ­¥ä»£ç å—ä¹‹åçº¿ç¨‹Bæ‰ä¼šå°†å¯¹è±¡é”Object objè¿˜å›å»ã€‚</span><br><span class="line"></span><br><span class="line">å‡è®¾çº¿ç¨‹Bå½“å‰å·²ç»æ‰§è¡Œå®Œæˆå‡ºäº†åŒæ­¥ä»£ç å—ä¹Ÿå·²ç»é‡Šæ”¾äº†é”ï¼Œ</span><br><span class="line">æ­¤æ—¶CPUå†æ¬¡åˆ‡æ¢åˆ°çº¿ç¨‹Aä¸Šï¼Œ</span><br><span class="line">é‚£ä¹ˆè¿™ä¸ªæ—¶å€™çº¿ç¨‹Aå°±å¯ä»¥èƒ½å¤Ÿè·å–å¾—åˆ°å¯¹è±¡é”Object objäº†ï¼›</span><br><span class="line">é‚£ä¹ˆå¾—åˆ°å¯¹è±¡é”ä¹‹åå°±å¯ä»¥è¿›å…¥åˆ°åŒæ­¥ä»£ç å—ä¸­äº†ï¼›</span><br><span class="line">é€šè¿‡åˆ¤æ–­readyå–å€¼è¿›å…¥<span class="keyword">if</span>/<span class="keyword">else</span>å—ï¼›</span><br><span class="line">ç”±äºå…±äº«å˜é‡readyä»¥åŠnumåœ¨çº¿ç¨‹Bçš„actor2(I_Result r)ä¸­è¢«è¿›è¡Œäº†ä¿®æ”¹ï¼›</span><br><span class="line">å½“å‰çº¿ç¨‹Aè¯»å–åˆ°å˜é‡readyå–å€¼ä¸º<span class="literal">true</span>ï¼›numå–å€¼ä¸º<span class="number">2</span>ï¼›</span><br><span class="line">æ‰€ä»¥æ­¤æ—¶çº¿ç¨‹Aå°±å°†ä¼šæ‹¿ç€å¯¹è±¡é”Object obj è¿›å…¥åˆ°<span class="keyword">if</span>(ready)å—å½“ä¸­å»ï¼›</span><br><span class="line">I_Result r.r1å°†ä¼šè¢«é‡æ–°èµ‹å€¼ä¸º <span class="number">2</span>+<span class="number">2</span>=<span class="number">4</span>ï¼›</span><br><span class="line">æ‰€ä»¥æ­¤æ—¶çš„ä¸€ä¸ªè®°å½•ç»“æœä¸º<span class="number">4</span>ï¼›</span><br><span class="line">ç°åœ¨å¯ä»¥è§‚å¯Ÿåˆ°çš„æ˜¯ï¼š</span><br><span class="line">å°½ç®¡åŠ äº†åŒæ­¥ä»£ç å—synchronizedï¼Œ</span><br><span class="line">ä½†æ˜¯actor2(I_Result r)å½“ä¸­ä¾ç„¶ä¼šå‘ç”Ÿé‡æ’åºï¼›</span><br><span class="line">ä½†æ˜¯å‘ç”Ÿäº†é‡æ’åºä¹Ÿæ²¡æœ‰é—®é¢˜ï¼›</span><br><span class="line">å› ä¸ºactor1(I_Result r)ä¸actor2(I_Result r)éƒ½æ·»åŠ äº†åŒæ­¥ä»£ç å—synchronizedï¼Œ</span><br><span class="line">ä¿è¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ¥è¿›è¡Œæ‰§è¡Œï¼›</span><br><span class="line">å°±ç®—actor2(I_Result r)ä¸­çº¿ç¨‹Bæ‰§è¡Œåˆ°ready=<span class="literal">true</span>ä¹‹åCPUåˆåˆ‡æ¢åˆ°çº¿ç¨‹Aä¸Šé¢å»äº†ï¼›é‚£ä¹ˆçº¿ç¨‹Aå°†ç”±äºæ— æ³•è·å–å¾—åˆ°å¯¹è±¡é”Object objä¹Ÿæ— æ³•è¿›å…¥åŒæ­¥ä»£ç å—å½“ä¸­å»ï¼›ç”±äºçº¿ç¨‹Bæ²¡æœ‰æ‰§è¡Œå®Œæˆï¼Œå³æ²¡æœ‰é‡Šæ”¾é”ï¼›æ‰€ä»¥çº¿ç¨‹Aåªèƒ½å¤Ÿè¿›è¡Œç­‰å¾…ï¼›</span><br><span class="line">é‚£ä¹ˆä¹Ÿå°±ç›¸å½“äºæ˜¯å•çº¿ç¨‹åœ¨æ‰§è¡Œè¿™äº›ä»£ç ï¼›</span><br><span class="line">é‚£ä¹ˆé‡æ’åºæ˜¯èƒ½å¤Ÿä¿è¯å•çº¿ç¨‹çš„æ‰§è¡Œæ•ˆæœæ²¡æœ‰é—®é¢˜ï¼›</span><br></pre></td></tr></table></figure><h3 id="synchronized-ä¿è¯æœ‰åºæ€§çš„åŸç†"><a href="#synchronized-ä¿è¯æœ‰åºæ€§çš„åŸç†" class="headerlink" title="synchronized ä¿è¯æœ‰åºæ€§çš„åŸç†"></a>synchronized ä¿è¯æœ‰åºæ€§çš„åŸç†</h3><p>synchronizedåï¼Œè™½ç„¶è¿›è¡Œäº†é‡æ’åºï¼Œä¿è¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹ä¼šè¿›å…¥åŒæ­¥ä»£ç å—ï¼Œä¹Ÿèƒ½ä¿è¯æœ‰åºæ€§ã€‚</p><h3 id="å°ç»“-8"><a href="#å°ç»“-8" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>synchronizedä¿è¯æœ‰åºæ€§çš„åŸç†ï¼šåŠ synchronizedï¼Œä¾ç„¶ä¼šå‘ç”Ÿé‡æ’åºï¼Œåªä¸è¿‡ï¼Œå­˜åœ¨æœ‰åŒæ­¥ä»£ç å—ï¼Œå¯ä»¥ä¿è¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç å—å½“ä¸­çš„ä»£ç ã€‚<br>ä¹Ÿå°±èƒ½ä¿è¯æœ‰åºæ€§ã€‚</p><p>æœ‰åºæ€§é™¤äº†å¯ä»¥ä½¿ç”¨synchronizedæ¥è¿›è¡Œè§£å†³ï¼Œè¿˜èƒ½å¤Ÿè¿›è¡Œç»™ å…±äº«å˜é‡numä»¥åŠreadyå˜é‡è¿›è¡Œæ·»åŠ volatileå…³é”®å­—æ¥è¿›è¡Œè§£å†³æœ‰åºæ€§é—®é¢˜ã€‚</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  æ·»åŠ äº†volatileå…³é”®å­—ä¹‹åï¼Œ</span></span><br><span class="line"><span class="comment">  å¯ä»¥ä¿è¯å…±äº«å˜é‡numä»¥åŠreadyå˜é‡ä¸ä¼šå‘ç”Ÿé‡æ’åºï¼›</span></span><br><span class="line"><span class="comment">  ä¹Ÿå°±ä¸ä¼šå‘ç”Ÿæœ‰åºæ€§é—®é¢˜äº†ï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test03Ordering</span>&#123;</span></span><br><span class="line">  <span class="keyword">private</span> Object obj =  <span class="keyword">new</span> Object();<span class="comment">//å¯¹è±¡é”</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">volatile</span> <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">volatile</span> <span class="keyword">boolean</span> <span class="built_in">ready</span> = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// çº¿ç¨‹ä¸€ æ‰§è¡Œçš„ä»£ç </span></span><br><span class="line">  @Actor</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actor1</span><span class="params">(I_Result r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">ready</span>)&#123;</span><br><span class="line">      r.r1 = num + num;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      r.r1 = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">// çº¿ç¨‹äºŒ æ‰§è¡Œçš„ä»£ç </span></span><br><span class="line">  @Actor</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actor2</span><span class="params">(I_Result r)</span></span>&#123;</span><br><span class="line">    num = <span class="number">2</span>;</span><br><span class="line">    <span class="built_in">ready</span> = <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="synchronizedçš„å¯é‡å…¥ç‰¹æ€§"><a href="#synchronizedçš„å¯é‡å…¥ç‰¹æ€§" class="headerlink" title="synchronizedçš„å¯é‡å…¥ç‰¹æ€§"></a>synchronizedçš„å¯é‡å…¥ç‰¹æ€§</h2><p>ç¬¬å››ç« ï¼šsynchronizedçš„ç‰¹æ€§</p><blockquote><p>synchronizedå±äºåŒæ­¥é”æœºåˆ¶ï¼Œ<br>ç¬¬å››ç« ä»‹ç»synchronizedä½œä¸ºé”çš„ä¸¤ä¸ªç‰¹æ€§ï¼š<br>1ã€ å¯é‡å…¥æ€§ï¼ˆå½“ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œåˆ°åŒæ­¥ä»£ç å—ï¼Œè·å–äº†æŸä¸€ä¸ªé”ä¹‹åï¼Œè¿˜èƒ½å¤Ÿå†æ¬¡è¿›å…¥åŒæ­¥ä»£ç å—å½“ä¸­ï¼Œè·å–åŒæ ·çš„ä¸€æŠŠé”ï¼Œè¿™ä¸ªæ˜¯å¯ä»¥çš„ï¼Œå¯ä»¥é‡æ–°å†æ¬¡è¿›å…¥ï¼Œå°†åˆ†æå…¶åŸç†ä»¥åŠå…¶å¯é‡å…¥æ€§çš„å¥½å¤„ï¼‰ï¼›<br>2ã€ä¸å¯ä¸­æ–­æ€§ï¼ˆsynchronizedæ˜¯ä¸å¯ä¸­æ–­çš„ï¼šå½“ä¸€ä¸ªçº¿ç¨‹è¿›å…¥äº†åŒæ­¥ä»£ç å—ï¼Œé‚£ä¹ˆå¦å¤–ä¸€ä¸ªçº¿ç¨‹åªèƒ½å¤Ÿåœ¨å¤–é¢è¿›è¡Œç­‰å¾…ï¼Œè¿™ä¸ªå¤„äºç­‰å¾…çš„çº¿ç¨‹ä¼šä¸€ç›´å¤„äºç­‰å¾…çŠ¶æ€ï¼Œä¸ä¼šä¸­æ–­ï¼Œæ‰€ä»¥ä¹Ÿå°±å«åšä¸å¯ä¸­æ–­ï¼›<br>å¦å¤–è¿˜ä¼šé€šè¿‡ReentrantLockçš„ä»£ç æ¥è¿›è¡Œæ¼”ç¤ºReentrantLockæ˜¯å¯ä»¥è¿›è¡Œä¸­æ–­çš„ï¼‰</p></blockquote><p>å¯é‡å…¥ç‰¹æ€§</p><p>synchronizedä½œä¸ºé”ï¼Œå…·æœ‰ä¸¤ä¸ªç‰¹æ€§ï¼›<br>ä¸€ä¸ªæ˜¯ å¯é‡å…¥æ€§ï¼›ä¸€ä¸ªæ˜¯ä¸å¯ä¸­æ–­æ€§ï¼›</p><h3 id="ç›®æ ‡-9"><a href="#ç›®æ ‡-9" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>äº†è§£ä»€ä¹ˆæ˜¯å¯é‡å…¥<br>äº†è§£å¯é‡å…¥çš„åŸç†</p><h3 id="ä»€ä¹ˆæ˜¯å¯é‡å…¥"><a href="#ä»€ä¹ˆæ˜¯å¯é‡å…¥" class="headerlink" title="ä»€ä¹ˆæ˜¯å¯é‡å…¥"></a>ä»€ä¹ˆæ˜¯å¯é‡å…¥</h3><p>æŒ‡çš„æ˜¯ åŒä¸€ä¸ªçº¿ç¨‹çš„ å¯ä»¥å¤šæ¬¡è·å¾— åŒä¸€æŠŠé”ã€‚<br>ï¼ˆä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¤šæ¬¡æ‰§è¡Œsynchronizedï¼Œé‡å¤è·å–åŒä¸€æŠŠé”ï¼›ï¼‰</p><p>(å½“ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œåˆ°åŒæ­¥ä»£ç å—è·å–åˆ°æŸä¸€ä¸ªé”ä¹‹åï¼Œè¿˜èƒ½å†æ¬¡è¿›å…¥åŒæ­¥ä»£ç å—ï¼Œè·å–åŒæ ·çš„ä¸€æŠŠé”ï¼Œè¿™æ˜¯å¯ä»¥çš„ï¼Œå¯ä»¥é‡æ–°å†è¿›å…¥)</p><h3 id="æ¼”ç¤ºå¯é‡å…¥ç‰¹æ€§"><a href="#æ¼”ç¤ºå¯é‡å…¥ç‰¹æ€§" class="headerlink" title="æ¼”ç¤ºå¯é‡å…¥ç‰¹æ€§"></a>æ¼”ç¤ºå¯é‡å…¥ç‰¹æ€§</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xxx.demo03_synchronized_nature;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  å¯é‡å…¥ç‰¹æ€§</span></span><br><span class="line"><span class="comment">    æŒ‡çš„æ˜¯ åŒä¸€ä¸ªçº¿ç¨‹è·å¾—é”ä¹‹åï¼Œå¯ä»¥ç›´æ¥å†æ¬¡è·å–è¯¥é”ã€‚</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">  <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo01</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">      Runnable sellTicket =  <span class="keyword">new</span> Runnable()&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">          <span class="keyword">synchronized</span>(Demo01<span class="class">.<span class="keyword">class</span>)</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">"æˆ‘æ˜¯run"</span>);</span><br><span class="line">            test01();</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span></span>&#123;</span><br><span class="line">          <span class="keyword">synchronized</span>(Demo01<span class="class">.<span class="keyword">class</span>)</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">"æˆ‘æ˜¯test01"</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">new</span> Thread(sellTicket).start();</span><br><span class="line">      <span class="keyword">new</span> Thread(sellTicket).start();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ¼”ç¤º</p></blockquote><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xxx.demo03_synchronized_nature;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  ç›®æ ‡ï¼šæ¼”ç¤ºsynchronizedå¯é‡å…¥</span></span><br><span class="line"><span class="comment">    1. è‡ªå®šä¹‰ä¸€ä¸ªçº¿ç¨‹ç±»</span></span><br><span class="line"><span class="comment">    2. åœ¨çº¿ç¨‹ç±»çš„runæ–¹æ³•ä¸­ä½¿ç”¨ åµŒå¥—çš„ä»£ç åŒæ­¥å—</span></span><br><span class="line"><span class="comment">    3. ä½¿ç”¨ä¸¤ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œ</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Demo01</span></span>&#123;</span><br><span class="line">    public static void main(<span class="type">String</span>[] args)&#123;</span><br><span class="line">      <span class="keyword">new</span> <span class="type">MyThread</span>().start();</span><br><span class="line">      <span class="keyword">new</span> <span class="type">MyThread</span>().start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. è‡ªå®šä¹‰ä¸€ä¸ªçº¿ç¨‹ç±»</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  å¦‚æœä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿè·å–å¾—åˆ°MyThread.classè¿™æŠŠé”ä»è€Œè¿›å…¥åŒæ­¥ä»£ç å—1å¹¶æ‰“å°ï¼›</span></span><br><span class="line"><span class="comment">  è¿˜ä¾ç„¶èƒ½å¤Ÿæ‹¿ç€ç›¸åŒçš„ä¸€æŠŠé”å†æ¬¡è¿›å…¥åŒæ­¥ä»£ç å—2ï¼Œ</span></span><br><span class="line"><span class="comment">  è¿™å°±è¯´æ˜synchronizedæ˜¯å¯é‡å…¥çš„ï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  public void run()&#123;</span><br><span class="line">    synchronized(<span class="type">MyThread</span><span class="class">.<span class="keyword">class</span>)</span>&#123;</span><br><span class="line">      <span class="type">System</span>.out.println(getName() + <span class="string">"è¿›å…¥äº†åŒæ­¥ä»£ç å—1"</span>);</span><br><span class="line"></span><br><span class="line">      synchronized(<span class="type">MyThread</span><span class="class">.<span class="keyword">class</span>)</span>&#123;</span><br><span class="line">         <span class="type">System</span>.out.println(getName() + <span class="string">"è¿›å…¥äº†åŒæ­¥ä»£ç å—2"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ç»“æœå¹¶åˆ†æsynchronizedå¯é‡å…¥æ€§æ‰§è¡Œæµç¨‹</p></blockquote><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">ç»“æœ:</span><br><span class="line">Thread-<span class="number">0</span>è¿›å…¥äº†åŒæ­¥ä»£ç å—<span class="number">1</span></span><br><span class="line">Thread-<span class="number">0</span>è¿›å…¥äº†åŒæ­¥ä»£ç å—<span class="number">2</span></span><br><span class="line">Thread-<span class="number">1</span>è¿›å…¥äº†åŒæ­¥ä»£ç å—<span class="number">1</span></span><br><span class="line">Thread-<span class="number">1</span>è¿›å…¥äº†åŒæ­¥ä»£ç å—<span class="number">2</span></span><br><span class="line">-------------------------</span><br><span class="line"></span><br><span class="line">å…ˆç”»ä¸€ä¸ªçº¢è‰²çš„ç®­å¤´ä»£è¡¨ä¸»çº¿ç¨‹ï¼›</span><br><span class="line">ä¸»çº¿ç¨‹ä»main<span class="literal">()</span>æ–¹æ³•å¼€å§‹æ‰§è¡Œï¼›</span><br><span class="line">é‚£ä¹ˆå°±ä¼šå¯åŠ¨ä¸¤ä¸ªçº¿ç¨‹å³<span class="keyword">new</span> <span class="constructor">MyThread()</span>.start<span class="literal">()</span><span class="operator"> * </span><span class="number">2</span>ï¼›</span><br><span class="line">é‚£ä¹ˆç”»ä¸¤ä¸ªç®­å¤´ï¼Œä¸€ä¸ªç»¿è‰²çš„ç®­å¤´ä¸€ä¸ªç´«è‰²çš„ç®­å¤´å³åˆ†åˆ«ä»£è¡¨Açº¿ç¨‹ä¸Bçº¿ç¨‹ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™ä¸¤ä¸ªçº¿ç¨‹Aã€Bä¼šæ¥è¿›è¡Œæ‰§è¡ŒMyThreadå½“ä¸­å®ç°çš„run<span class="literal">()</span>æ–¹æ³•ï¼›</span><br><span class="line">å‡è®¾çº¿ç¨‹Aå…ˆæ‰§è¡Œï¼›</span><br><span class="line">é‚£ä¹ˆçº¿ç¨‹Aä¼šè·å–å¾—åˆ°é”<span class="module-access"><span class="module"><span class="identifier">MyThread</span>.</span></span><span class="keyword">class</span>ä»è€Œèƒ½å¤Ÿè¿›å…¥ä»£ç å—å½“ä¸­ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™ä¸ªé”å¯¹è±¡<span class="module-access"><span class="module"><span class="identifier">MyThread</span>.</span></span><span class="keyword">class</span>å½“ä¸­å­˜åœ¨ä¸€ä¸ªè®¡æ•°å™¨ï¼Œ</span><br><span class="line">è¯¥é”å¯¹è±¡<span class="module-access"><span class="module"><span class="identifier">MyThread</span>.</span></span><span class="keyword">class</span>å½“ä¸­çš„è®¡æ•°å™¨ä¼šè®°å½•è‡ªå·±è¢«è·å–äº†å‡ æ¬¡ï¼Œ</span><br><span class="line">é‚£ä¹ˆå½“å‰æ˜¯çº¿ç¨‹Aç¬¬ä¸€æ¬¡è·å–å¾—åˆ°è¯¥é”<span class="module-access"><span class="module"><span class="identifier">MyThread</span>.</span></span><span class="keyword">class</span>ï¼›å³è®¡æ•°å™¨å–å€¼åŠ <span class="number">1</span>ï¼›</span><br><span class="line">é‚£ä¹ˆçº¿ç¨‹Aè¿›å…¥åˆ°åŒæ­¥ä»£ç å—<span class="number">1</span>å½“ä¸­å³ä¼šè¿›è¡Œæ‰“å° çº¿ç¨‹å+<span class="string">"è¿›å…¥äº†åŒæ­¥ä»£ç å—1"</span>ä¿¡æ¯ï¼›</span><br><span class="line">æ¥ç€è¯¥çº¿ç¨‹Aç»§ç»­å¾€ä¸‹è¿›è¡Œæ‰§è¡Œå‘ç°åˆæ˜¯ä¸€ä¸ªåŒæ­¥ä»£ç å—ï¼Œä¸”è¿˜æ˜¯è·å–çš„ä¸€ä¸ªç›¸åŒçš„é”ï¼›é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ï¼›ä¼šå°†é”å¯¹è±¡<span class="module-access"><span class="module"><span class="identifier">MyThread</span>.</span></span><span class="keyword">class</span>å½“ä¸­è®¡æ•°å™¨çš„å–å€¼å†æ¬¡++ï¼Œè®¾ç½®ä¸º<span class="number">2</span>ï¼›</span><br><span class="line">å‡è®¾CPUæ­¤æ—¶ä¾ç„¶åœ¨è¯¥çº¿ç¨‹Aä¸Šï¼Œè€Œçº¿ç¨‹Aç»§ç»­å¾€ä¸‹è¿›è¡Œæ‰§è¡Œï¼Œé‚£ä¹ˆæ­¤æ—¶å°±ä¼šè¿›è¡Œæ‰“å° çº¿ç¨‹å++<span class="string">"è¿›å…¥äº†åŒæ­¥ä»£ç å—2"</span>ä¿¡æ¯ï¼›</span><br><span class="line">é‚£ä¹ˆä¹Ÿå°±å¯ä»¥è§‚å¯Ÿå¾—åˆ°åŒä¸€ä¸ªçº¿ç¨‹å¤šæ¬¡æ‰§è¡Œsynchronizedæ‹¿åˆ°åŒä¸€æŠŠé”ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™ä¸ªé”å½“ä¸­å­˜åœ¨æœ‰ä¸€ä¸ªè®¡æ•°å™¨ï¼Œè¿™ä¸ªè®¡æ•°å™¨å½“ä¸­ä¼šè¿›è¡Œè®°å½•è‡ªå·±è¢«æ‹¿åˆ°äº†å‡ æ¬¡ã€‚</span><br><span class="line"></span><br><span class="line">é‚£ä¹ˆå‡è®¾æ­¤æ—¶CPUåˆåˆ‡æ¢åˆ°äº†å¦å¤–ä¸€ä¸ªçº¿ç¨‹ï¼›å³çº¿ç¨‹Bï¼›</span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶çº¿ç¨‹Bä¹Ÿä¼šæ¥è¿›è¡Œæ‰§è¡ŒMyThreadå½“ä¸­å®ç°çš„run<span class="literal">()</span>æ–¹æ³•ï¼›</span><br><span class="line">ä½†æ˜¯ä¼šå‘ç°<span class="module-access"><span class="module"><span class="identifier">MyThread</span>.</span></span><span class="keyword">class</span>è¯¥å¯¹è±¡é”ä¾ç„¶åœ¨çº¿ç¨‹Aé‚£é‡Œï¼Œå³çº¿ç¨‹Aè¿˜å¹¶æ²¡æœ‰è¿›è¡Œé‡Šæ”¾é”CPUå°±åˆ‡æ¢åˆ°äº†çº¿ç¨‹Bä¸Šï¼›</span><br><span class="line">æ‰€ä»¥ä¹Ÿå°±å¯¼è‡´äº†çº¿ç¨‹Bæ— æ³•è·å–å¾—åˆ°é”ä»è€Œä¹Ÿå°±æ— æ³•è¿›å…¥åŒæ­¥ä»£ç å—<span class="number">1</span>ä¸­ï¼Œåªèƒ½å¤Ÿåœ¨åŒæ­¥ä»£ç å—<span class="number">1</span>çš„å¤–ä¾§è¿›è¡Œç­‰å¾…ï¼›</span><br><span class="line"></span><br><span class="line">é‚£ä¹ˆè¿™ä¸ªæ—¶å€™CPUåˆåˆ‡æ¢å›æ¥åˆ°äº†çº¿ç¨‹Aä¸Šï¼›</span><br><span class="line">é‚£ä¹ˆçº¿ç¨‹Aç»§ç»­æ¥ç€CPUåˆ‡æ¢ä¹‹å‰çš„çš„é‚£ä¸ªåœ°æ–¹å¾€ä¸‹è¿›è¡Œæ‰§è¡Œï¼›</span><br><span class="line">å³å½“æ—¶å·²ç»æ‰“å°å®Œæˆ çº¿ç¨‹åç§°+â€œè¿›å…¥äº†åŒæ­¥ä»£ç å—<span class="number">2</span>â€ä¿¡æ¯äº†ï¼›</span><br><span class="line">å³çº¿ç¨‹Aèµ°åˆ°äº†åŒæ­¥ä»£ç å—<span class="number">2</span>çš„å¤§æ‹¬å·å¤„è¯´æ˜åŒæ­¥ä»£ç å—<span class="number">2</span>è¦ç»“æŸäº†ï¼›</span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶åŒæ­¥ä»£ç å—<span class="number">2</span>ç»“æŸçš„æ—¶å€™å°±ä¼šå°†è¯¥åŒæ­¥ä»£ç å—<span class="number">2</span>çš„é”ç»™é‡Šæ”¾æ‰ï¼›</span><br><span class="line">ä¹Ÿå°±æ„å‘³ç€å¯¹è±¡é”<span class="module-access"><span class="module"><span class="identifier">MyThread</span>.</span></span><span class="keyword">class</span>å½“ä¸­çš„è®¡æ•°å™¨ä¼šè¿›è¡Œå‡<span class="number">1</span>æ“ä½œï¼›</span><br><span class="line">å³æ­¤æ—¶è®¡æ•°å™¨å–å€¼ç”±<span class="number">2</span>å˜æˆäº†<span class="number">1</span>ï¼›</span><br><span class="line">é‚£ä¹ˆæ¥ç€ç»§ç»­å¾€ä¸‹èµ°ï¼›é‚£ä¹ˆçº¿ç¨‹Aå°±åˆèµ°åˆ°äº†åŒæ­¥ä»£ç å—<span class="number">1</span>çš„ç»“æŸå¤§æ‹¬å·ä¸Šï¼Œä¹Ÿå°±æ„å‘³ç€æ­¤æ—¶çº¿ç¨‹Aè¦å‡ºåŒæ­¥ä»£ç å—<span class="number">1</span>ï¼Œå³åˆé‡Šæ”¾ä¸€æ¬¡ï¼Œå³é”å¯¹è±¡<span class="module-access"><span class="module"><span class="identifier">MyThread</span>.</span></span><span class="keyword">class</span>å½“ä¸­çš„è®¡æ•°å™¨åˆä¼šå‘ç”Ÿä¸€æ¬¡å‡<span class="number">1</span>æ“ä½œï¼›å³æ­¤æ—¶è®¡æ•°å™¨çš„å–å€¼ç”±<span class="number">1</span>å˜ä¸º<span class="number">0</span>ï¼›</span><br><span class="line">è®¡æ•°å™¨å–å€¼ä¸º<span class="number">0</span>ä¹Ÿå°±æ„å‘³ç€å½“å‰æ²¡æœ‰çº¿ç¨‹æ¥è¿›è¡Œè·å–è¿™æŠŠé”äº†ï¼›</span><br><span class="line">ä¹Ÿå°±æ˜¯ç›¸å½“äºçº¿ç¨‹Aå°†é”è¿˜å›å»äº†ï¼›</span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶å…¶ä»–çº¿ç¨‹å°±å¯ä»¥å»è¿›è¡Œç«äº‰è·å–å¾—åˆ°è¯¥é”è¿›å…¥åŒæ­¥ä»£ç å—å½“ä¸­æ¥ï¼›</span><br></pre></td></tr></table></figure><blockquote><p>å…¶å®ä¹Ÿå¯ä»¥ä¸ç”¨ä¸¤ä¸ªsynchronizedåŒæ­¥ä»£ç å—åµŒå¥—ï¼›<br>å¯ä»¥æ”¾åˆ°ä¸¤ä¸ªä¸åŒçš„æ–¹æ³•ä¹Ÿå¯ä»¥å®Œæˆï¼›</p></blockquote><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="symbol">MyThread</span> <span class="symbol">extends</span> <span class="symbol">Thread</span>&#123;</span><br><span class="line">  @Override</span><br><span class="line">  <span class="keyword">public</span> <span class="built_in">void</span> run()&#123;</span><br><span class="line">    synchronized(MyThread.<span class="keyword">class</span>)&#123;</span><br><span class="line">      System.<span class="keyword">out</span>.println(getName() + <span class="string">"è¿›å…¥äº†åŒæ­¥ä»£ç å—1"</span>);</span><br><span class="line"></span><br><span class="line">      test01();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="built_in">void</span> test01()&#123;</span><br><span class="line">    synchronized(MyThread.<span class="keyword">class</span>)&#123;</span><br><span class="line">         System.<span class="keyword">out</span>.println(getName() + <span class="string">"è¿›å…¥äº†åŒæ­¥ä»£ç å—2"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">-----------------------------------------</span><br><span class="line"><span class="comment">// å†æ¬¡è¿è¡Œï¼Œçº¿ç¨‹ä¾æ—§å¯ä»¥é‡å…¥æ‹¿åˆ°é”ä¸¤æ¬¡ï¼›</span></span><br><span class="line">ç»“æœ:</span><br><span class="line">Thread<span class="number">-0</span>è¿›å…¥äº†åŒæ­¥ä»£ç å—<span class="number">1</span></span><br><span class="line">Thread<span class="number">-0</span>è¿›å…¥äº†åŒæ­¥ä»£ç å—<span class="number">2</span></span><br><span class="line">Thread<span class="number">-1</span>è¿›å…¥äº†åŒæ­¥ä»£ç å—<span class="number">1</span></span><br><span class="line">Thread<span class="number">-1</span>è¿›å…¥äº†åŒæ­¥ä»£ç å—<span class="number">2</span></span><br><span class="line">-----------------------------------------</span><br></pre></td></tr></table></figure><blockquote><p>å¦å¤–ä¸ä»…æ˜¯æ”¾åˆ°åŒä¸€ä¸ªç±»çš„æ–¹æ³•å¯ä»¥å®ç°ï¼Œæ”¾åˆ°ä¸åŒç±»çš„æ–¹æ³•ä¹Ÿå¯ä»¥å®ç°ï¼›</p></blockquote><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">package com.xxx.demo03_synchronized_nature;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  ç›®æ ‡ï¼šæ¼”ç¤ºsynchronizedå¯é‡å…¥</span></span><br><span class="line"><span class="comment">    1. è‡ªå®šä¹‰ä¸€ä¸ªçº¿ç¨‹ç±»</span></span><br><span class="line"><span class="comment">    2. åœ¨çº¿ç¨‹ç±»çš„runæ–¹æ³•ä¸­ä½¿ç”¨ åµŒå¥—çš„ä»£ç åŒæ­¥å—</span></span><br><span class="line"><span class="comment">    3. ä½¿ç”¨ä¸¤ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œ</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="symbol">Demo01</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> static <span class="built_in">void</span> main(String[] args)&#123;</span><br><span class="line">      new MyThread().start();</span><br><span class="line">      new MyThread().start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> static <span class="built_in">void</span> test01()&#123;</span><br><span class="line">      synchronized(MyThread.<span class="keyword">class</span>)&#123;</span><br><span class="line">          String name = Thread.currentThread.getName();</span><br><span class="line">          System.<span class="keyword">out</span>.println(name + <span class="string">"è¿›å…¥äº†åŒæ­¥ä»£ç å—2"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. è‡ªå®šä¹‰ä¸€ä¸ªçº¿ç¨‹ç±»</span></span><br><span class="line"><span class="keyword">class</span> <span class="symbol">MyThread</span> <span class="symbol">extends</span> <span class="symbol">Thread</span>&#123;</span><br><span class="line">  @Override</span><br><span class="line">  <span class="keyword">public</span> <span class="built_in">void</span> run()&#123;</span><br><span class="line">    synchronized(MyThread.<span class="keyword">class</span>)&#123;</span><br><span class="line">      System.<span class="keyword">out</span>.println(getName() + <span class="string">"è¿›å…¥äº†åŒæ­¥ä»£ç å—1"</span>);</span><br><span class="line"></span><br><span class="line">      Demo01.test01();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">-----------------------------------------</span><br><span class="line"><span class="comment">// å†æ¬¡è¿è¡Œï¼Œçº¿ç¨‹ä¾æ—§å¯ä»¥é‡å…¥æ‹¿åˆ°é”ä¸¤æ¬¡ï¼›</span></span><br><span class="line">ç»“æœ:</span><br><span class="line">Thread<span class="number">-0</span>è¿›å…¥äº†åŒæ­¥ä»£ç å—<span class="number">1</span></span><br><span class="line">Thread<span class="number">-0</span>è¿›å…¥äº†åŒæ­¥ä»£ç å—<span class="number">2</span></span><br><span class="line">Thread<span class="number">-1</span>è¿›å…¥äº†åŒæ­¥ä»£ç å—<span class="number">1</span></span><br><span class="line">Thread<span class="number">-1</span>è¿›å…¥äº†åŒæ­¥ä»£ç å—<span class="number">2</span></span><br><span class="line">-----------------------------------------</span><br></pre></td></tr></table></figure><p>ç”±æ­¤è¯´æ˜äº†synchronizedçš„å¯é‡å…¥ç‰¹æ€§ä¸è°ƒç”¨å“ªä¸€ä¸ªå¯¹è±¡çš„å“ªä¸€ä¸ªæ–¹æ³•æ— å…³ï¼›<br>ä¸»è¦æ˜¯çœ‹çº¿ç¨‹ï¼Œçœ‹é”ï¼›</p><h3 id="å¯é‡å…¥åŸç†"><a href="#å¯é‡å…¥åŸç†" class="headerlink" title="å¯é‡å…¥åŸç†"></a>å¯é‡å…¥åŸç†</h3><p>synchronizedçš„é”å¯¹è±¡ä¸­æœ‰ä¸€ä¸ªè®¡æ•°å™¨ï¼ˆrecursionså˜é‡ï¼‰ä¼šè®°å½•çº¿ç¨‹è·å¾—å‡ æ¬¡é”ï¼›<br>åŠ é”æ¬¡æ•° è®¡æ•°å™¨ï¼ˆrecursions å˜é‡ï¼‰</p><h3 id="å¯é‡å…¥çš„å¥½å¤„"><a href="#å¯é‡å…¥çš„å¥½å¤„" class="headerlink" title="å¯é‡å…¥çš„å¥½å¤„"></a>å¯é‡å…¥çš„å¥½å¤„</h3><ol><li>å¯ä»¥é¿å…æ­»é”</li><li>æ›´å¥½çš„å°è£…ä»£ç </li></ol><p>ä¾ç„¶æ˜¯ä¸Šè¿°å­˜åœ¨æœ‰ä¸¤ä¸ªåŒæ­¥ä»£ç å—åµŒå¥—çš„ä»£ç ï¼›<br>å³å¦‚æœä¸€ä¸ªçº¿ç¨‹Aè¿›å…¥äº†ä¸€ä¸ªåŒæ­¥ä»£ç å—å½“ä¸­å»äº†ï¼›<br>é‚£ä¹ˆå‡è®¾synchronizedæ²¡æœ‰å¯é‡å…¥ç‰¹æ€§ï¼›<br>é‚£ä¹ˆå°±ä¼šå¯¼è‡´æ— æ³•å†æ¬¡è¿›å…¥åŒæ­¥ä»£ç å—å½“ä¸­ï¼›<br>é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±ä¼šå¡åœ¨ä¸€ä¸ªåœ°æ–¹ï¼›<br>è¿™ä¸ªåœ°æ–¹å³ä¸ºè¿›å…¥åˆ°synchronizedåŒæ­¥ä»£ç å—1ä¹‹åï¼Œ<br>æ‰“å°æ‰§è¡Œå®Œæˆ çº¿ç¨‹å+â€œè¿›å…¥äº†åŒæ­¥ä»£ç å—1â€ä¹‹åï¼›<br>æ²¡æœ‰åŠæ³•è¿›å…¥ä¸‹ä¸€å¥ä»£ç ï¼Œå³ä¸‹ä¸€ä¸ªåŒæ­¥ä»£ç å—2synchronizedä¸­ï¼›<br>ä»è€Œæ— æ³•ç»“æŸè¯¥æµç¨‹ä¹Ÿæ²¡æœ‰åŠæ³•é‡Šæ”¾é”ï¼›<br>è€Œå…¶ä»–çº¿ç¨‹ä¹Ÿç”±äºæ— æ³•è·å–å¾—åˆ°é”ä»è€Œæ— æ³•è¿›å…¥åŒæ­¥ä»£ç å—1åªèƒ½å¤Ÿåœ¨åŒæ­¥ä»£ç å—1å¤–å±‚è¿›è¡Œç­‰å¾…ï¼›<br>ä¹Ÿå°±é€ æˆäº†æ­»é”çš„çŠ¶æ€ï¼›å°±ç›¸å½“äºæ˜¯çº¿ç¨‹Aè¢«å›°åœ¨åŒæ­¥ä»£ç å—1å½“ä¸­äº†ï¼›<br>é‚£ä¹ˆæœ‰äº†synchronizedçš„å¯é‡å…¥ç‰¹æ€§å°±å¯ä»¥é¿å…æ­»é”ï¼›</p><p>å› ä¸ºå¯ä»¥åœ¨åŒæ­¥ä»£ç å—1å½“ä¸­è°ƒç”¨å…¶ä»–æ–¹æ³•ï¼Œå³æ¯”å¦‚è¯´ä¸Šè¿°ä»£ç ä¸­çš„Demo01.test01();è€ŒDemo01.test01()ä¸­ä¹Ÿå­˜åœ¨æœ‰åŒæ­¥ä»£ç å—ï¼Œé‚£ä¹ˆä¹Ÿå°±æ–¹ä¾¿äº†ä½¿ç”¨æ–¹æ³•æ¥è¿›è¡Œå°è£…ä»£ç ï¼›</p><h3 id="å°ç»“-9"><a href="#å°ç»“-9" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>synchronizedæ˜¯å¯é‡å…¥é”ï¼›å†…éƒ¨é”å¯¹è±¡ä¸­ä¼šæœ‰ä¸€ä¸ªè®¡æ•°å™¨è®°å½•çº¿ç¨‹è·å–äº†å‡ æ¬¡é”äº†ï¼›åœ¨æ‰§è¡Œå®ŒåŒæ­¥ä»£ç å—æ—¶ï¼Œè®¡æ•°å™¨çš„æ•°é‡ä¼š-1ï¼Œç›´åˆ°è®¡æ•°å™¨çš„æ•°é‡ä¸º0ï¼Œå°±é‡Šæ”¾è¿™ä¸ªé”ã€‚</p><p>ä»€ä¹ˆæ˜¯å¯é‡å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æŒ‡çš„æ˜¯ åŒä¸€ä¸ªçº¿ç¨‹çš„ å¯ä»¥ å¤šæ¬¡ è·å¾— åŒä¸€æŠŠé”</span><br></pre></td></tr></table></figure><p>å¯é‡å…¥çš„åŸç†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åŠ é”æ¬¡æ•°è®¡æ•°å™¨ã€‚ï¼ˆrecursionså˜é‡ï¼‰</span><br></pre></td></tr></table></figure><h2 id="synchronizedçš„ä¸å¯ä¸­æ–­æ€§"><a href="#synchronizedçš„ä¸å¯ä¸­æ–­æ€§" class="headerlink" title="synchronizedçš„ä¸å¯ä¸­æ–­æ€§"></a>synchronizedçš„ä¸å¯ä¸­æ–­æ€§</h2><h3 id="ç›®æ ‡-10"><a href="#ç›®æ ‡-10" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>äº†è§£ä»€ä¹ˆæ˜¯ä¸å¯ä¸­æ–­<br>å­¦ä¹ <strong>synchronized</strong>çš„<strong>ä¸å¯ä¸­æ–­ç‰¹æ€§</strong>ï¼›<br>å­¦ä¹ <strong>Lock</strong>çš„<strong>å¯ä¸­æ–­ç‰¹æ€§</strong>ï¼›</p><h3 id="ä»€ä¹ˆæ˜¯ä¸å¯ä¸­æ–­"><a href="#ä»€ä¹ˆæ˜¯ä¸å¯ä¸­æ–­" class="headerlink" title="ä»€ä¹ˆæ˜¯ä¸å¯ä¸­æ–­"></a>ä»€ä¹ˆæ˜¯ä¸å¯ä¸­æ–­</h3><p>ä¸€æ—¦è¿™ä¸ªé” è¢«åˆ«äºº è·å¾—äº†ï¼Œå¦‚æœé‡Œå¦ä¸€ä¸ªé”æƒ³è·å¾—é”ï¼Œåªèƒ½ç­‰å¾…æˆ–è€…é˜»å¡ï¼Œç›´åˆ°åˆ«çš„çº¿ç¨‹é‡Šæ”¾è¿™ä¸ªé”ï¼Œå¦‚æœåˆ«äººæ°¸è¿œä¸é‡Šæ”¾é”ï¼Œè¿™ä¸ªçº¿ç¨‹åªèƒ½æ°¸è¿œç­‰ä¸‹å»ï¼Œå¾ˆæ‰§ç€ï¼<br>ï¼ˆä¸€ä¸ªçº¿ç¨‹è·å¾—é”åï¼Œå¦ä¸€ä¸ªçº¿ç¨‹æƒ³è¦é”ï¼Œå¿…é¡»å¤„äºé˜»å¡æˆ–ç­‰å¾…çŠ¶æ€ï¼›å¦‚æœç¬¬ä¸€ä¸ªçº¿ç¨‹ä¸é‡Šæ”¾é”ï¼Œç¬¬äºŒä¸ªçº¿ç¨‹ä¼šä¸€ç›´å¤„äºé˜»å¡æˆ–ç­‰å¾…çŠ¶æ€ï¼Œåœ¨é˜»å¡æˆ–è€…ç­‰å¾…è¿‡ç¨‹ä¸­ï¼Œä¸å¯è¢«ä¸­æ–­ï¼Œå°†ä¸€ç›´ç­‰å¾…æˆ–é˜»å¡ï¼›ï¼‰</p><h3 id="synchronized-ä¸å¯ä¸­æ–­æ¼”ç¤º"><a href="#synchronized-ä¸å¯ä¸­æ–­æ¼”ç¤º" class="headerlink" title="synchronized ä¸å¯ä¸­æ–­æ¼”ç¤º"></a>synchronized ä¸å¯ä¸­æ–­æ¼”ç¤º</h3><p>synchronized æ˜¯ä¸å¯ä¸­æ–­ï¼Œå¤„äºé˜»å¡çŠ¶æ€çš„çº¿ç¨‹ä¼šä¸€ç›´ç­‰å¾…é”ã€‚</p><p>(å½“ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ä¸€ä¸ªåŒæ­¥ä»£ç å—ï¼Œé‚£ä¹ˆå¦å¤–ä¸€ä¸ªçº¿ç¨‹åªèƒ½åœ¨å¤–é¢ç­‰å¾…ï¼Œè¿™ä¸ªå¤„äºç­‰å¾…çš„çº¿ç¨‹å°†ä¼šä¸€ç›´ç­‰å¾…ï¼Œä¸ä¼šä¸­æ–­ï¼Œæ‰€ä»¥å°±å«åšä¸å¯ä¸­æ–­)</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> class Demo02_Uninterruptible&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">Object</span> o1 = <span class="keyword">new</span> <span class="keyword">Object</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="keyword">String</span>[] args) <span class="keyword">throws</span> InterruptedException&#123;</span><br><span class="line">    Runnable runnable =  () - &#123;</span><br><span class="line">      <span class="keyword">synchronized</span>( <span class="number">01</span> )&#123;</span><br><span class="line">        <span class="keyword">String</span> name = Thread.currentThread().getName();</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            System.out.<span class="built_in">println</span>(name + <span class="string">"start"</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(InterruptedException e)&#123;</span><br><span class="line">            System.out.<span class="built_in">println</span>(name + <span class="string">"interrupted"</span>);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    Thread t1 = <span class="keyword">new</span> Thread(runnable);</span><br><span class="line">    Thread t2 = <span class="keyword">new</span> Thread(runnable);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ¼”ç¤ºsynchronizedçš„ä¸å¯ä¸­æ–­ç‰¹æ€§</p></blockquote><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">--------------------------------------------------</span><br><span class="line">package com.xxx.demo03_synchronized_nature;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  ç›®æ ‡ï¼šæ¼”ç¤ºsynchronizedä¸å¯ä¸­æ–­</span></span><br><span class="line"><span class="comment">    1. å®šä¹‰ä¸€ä¸ªRunnable</span></span><br><span class="line"><span class="comment">    2. åœ¨Runnableå®šä¹‰åŒæ­¥ä»£ç å—</span></span><br><span class="line"><span class="comment">    3. å…ˆå¼€å¯ä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡ŒåŒæ­¥ä»£ç å—ï¼Œä¿è¯ä¸é€€å‡ºåŒæ­¥ä»£ç å—</span></span><br><span class="line"><span class="comment">    4. åå¼€å¯ä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡ŒåŒæ­¥ä»£ç å—ï¼ˆé˜»å¡çŠ¶æ€ï¼‰</span></span><br><span class="line"><span class="comment">    5. åœæ­¢ç¬¬äºŒä¸ªçº¿ç¨‹</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">public <span class="keyword">class</span> Demo02_Uninterruptible&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> static Object obj = <span class="keyword">new</span> <span class="constructor">Object()</span>;<span class="comment">//å®šä¹‰é”å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">  public static void main(String<span class="literal">[]</span> args)&#123;</span><br><span class="line">      <span class="comment">// 1. å®šä¹‰ä¸€ä¸ªRunnable</span></span><br><span class="line">      Runnable run = <span class="literal">()</span>-&gt;&#123;</span><br><span class="line">        <span class="comment">// 2. åœ¨Runnableå®šä¹‰åŒæ­¥ä»£ç å—ï¼›</span></span><br><span class="line">        <span class="comment">// åŒæ­¥ä»£ç å—éœ€è¦ä¸€ä¸ªé”å¯¹è±¡ï¼›</span></span><br><span class="line">        synchronized(obj)&#123;</span><br><span class="line"></span><br><span class="line">          <span class="comment">// è¿›è¡Œæ‰“å°æ˜¯å“ªä¸€ä¸ªçº¿ç¨‹è¿›å…¥çš„åŒæ­¥ä»£ç å—</span></span><br><span class="line">          String name = <span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>current<span class="constructor">Thread()</span>.get<span class="constructor">Name()</span>;</span><br><span class="line">          <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(name + <span class="string">"è¿›å…¥åŒæ­¥ä»£ç å—"</span>);</span><br><span class="line"></span><br><span class="line">          <span class="comment">// éœ€è¦è¿›è¡Œä¿è¯ä¸è¿›è¡Œé€€å‡ºåŒæ­¥ä»£ç å—ï¼›</span></span><br><span class="line">          <span class="comment">// æ‰€ä»¥è®©æ­¤çº¿ç¨‹è¿›è¡Œæ²‰ç¡sleep</span></span><br><span class="line">          <span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>sleep(<span class="number">888888</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      <span class="comment">// 3. å…ˆå¼€å¯ä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡ŒåŒæ­¥ä»£ç å—</span></span><br><span class="line">      Thread t1 = <span class="keyword">new</span> <span class="constructor">Thread(<span class="params">run</span>)</span>;</span><br><span class="line">      t1.start<span class="literal">()</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// æ²‰ç¡ä¸€ç§’é’Ÿï¼›</span></span><br><span class="line">      <span class="comment">// ä¿è¯ç¬¬ä¸€ä¸ªçº¿ç¨‹å…ˆå»æ‰§è¡ŒåŒæ­¥ä»£ç å—ä¹‹åå†æ¥åˆ›å»ºç¬¬äºŒä¸ªçº¿ç¨‹ï¼›</span></span><br><span class="line">      <span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>sleep(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">      4. åå¼€å¯ä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡ŒåŒæ­¥ä»£ç å—ï¼ˆé˜»å¡çŠ¶æ€ï¼‰</span></span><br><span class="line"><span class="comment">      åˆ°æ—¶å€™ç¬¬äºŒä¸ªçº¿ç¨‹å»æ‰§è¡ŒåŒæ­¥ä»£ç å—çš„æ—¶å€™ï¼Œ</span></span><br><span class="line"><span class="comment">      é”å·²ç»è¢«t1çº¿ç¨‹é”è·å–å¾—åˆ°äº†ï¼›</span></span><br><span class="line"><span class="comment">      æ‰€ä»¥çº¿ç¨‹t2æ˜¯æ— æ³•è·å–å¾—åˆ°Object objå¯¹è±¡é”çš„ï¼›</span></span><br><span class="line"><span class="comment">      é‚£ä¹ˆä¹Ÿå°±å°†ä¼šåœ¨åŒæ­¥ä»£ç å—å¤–å¤„äºé˜»å¡çŠ¶æ€ã€‚</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">      Thread t2 = <span class="keyword">new</span> <span class="constructor">Thread(<span class="params">run</span>)</span>;</span><br><span class="line">      t2.start<span class="literal">()</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      <span class="comment">/** 5. åœæ­¢ç¬¬äºŒä¸ªçº¿ç¨‹ï¼›</span></span><br><span class="line"><span class="comment">      è§‚å¯Ÿæ­¤çº¿ç¨‹t2èƒ½å¤Ÿè¢«ä¸­æ–­ï¼›</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">      <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"åœæ­¢çº¿ç¨‹å‰"</span>);</span><br><span class="line">      t2.interrupt<span class="literal">()</span>;</span><br><span class="line">      <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"åœæ­¢çº¿ç¨‹å"</span>);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// æœ€åå¾—åˆ°ä¸¤ä¸ªçº¿ç¨‹çš„æ‰§è¡ŒçŠ¶æ€</span></span><br><span class="line">      <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(t1.get<span class="constructor">State()</span>);</span><br><span class="line">      <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(t2.get<span class="constructor">State()</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------</span><br><span class="line">è¿è¡Œæ•ˆæœï¼š</span><br><span class="line">(Runæ˜¾ç¤ºçº¢ç¯å³æ²¡æœ‰åœæ­¢è¿è¡Œä¾ç„¶åœ¨ç»§ç»­)</span><br><span class="line">Thread-<span class="number">0</span>è¿›å…¥åŒæ­¥ä»£ç å—</span><br><span class="line">åœæ­¢çº¿ç¨‹å‰</span><br><span class="line">åœæ­¢çº¿ç¨‹å</span><br><span class="line">TIMED_WAITING</span><br><span class="line">BLOCKED</span><br><span class="line">--------------------------------------------------</span><br><span class="line"></span><br><span class="line">é€šè¿‡interrupt<span class="literal">()</span>æ–¹æ³•ç»™t2çº¿ç¨‹è¿›è¡Œå¼ºè¡Œä¸­æ–­ï¼›</span><br><span class="line">æœ€åè¿›è¡Œæ‰“å°t2çš„çŠ¶æ€åŠStateå‘ç°çŠ¶æ€ä¾ç„¶ä¸ºBLOCKEDï¼›</span><br><span class="line">å³çº¿ç¨‹ä¸å¯ä¸­æ–­ï¼›</span><br><span class="line"></span><br><span class="line">--------------------------------------------------</span><br><span class="line"></span><br><span class="line">synchronizedçš„ä¸å¯ä¸­æ–­æ€§å…·ä½“åˆ†ææµç¨‹</span><br><span class="line">çº¢è‰²çš„ç®­å¤´è¡¨ç¤ºä¸»çº¿ç¨‹ï¼›ä¸»çº¿ç¨‹ä»main<span class="literal">()</span>æ–¹æ³•å¼€å§‹æ‰§è¡Œï¼›</span><br><span class="line">ç„¶åæ‰§è¡Œåˆ°æ­¥éª¤<span class="number">3</span>ï¼ˆ<span class="number">3.</span> å…ˆå¼€å¯ä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡ŒåŒæ­¥ä»£ç å—ï¼‰å¯åŠ¨ç¬¬ä¸€ä¸ªçº¿ç¨‹t1ï¼›</span><br><span class="line">é‚£ä¹ˆå†ç”»ä¸€ä¸ªç®­å¤´ä»£è¡¨å¯åŠ¨çš„è¿™ç¬¬ä¸€ä¸ªçº¿ç¨‹t1ï¼Œç”¨çº¿ç¨‹Aè¡¨ç¤ºï¼›</span><br><span class="line">é‚£ä¹ˆçº¿ç¨‹Aå¯åŠ¨ä¹‹åå°±ä¼šå»æ‰§è¡ŒRunnable runä¸­çš„æ‰€é‡å†™çš„runæ–¹æ³•ï¼›</span><br><span class="line">é‚£ä¹ˆçº¿ç¨‹Aç¬¬ä¸€æ¬¡æ‰§è¡ŒåŒæ­¥ä»£ç å—ï¼›è·å–å¾—åˆ°å¯¹è±¡é”Object objï¼›</span><br><span class="line">ç„¶åè¿›å…¥åŒæ­¥ä»£ç å—ä¸­æ‰“å° çº¿ç¨‹åç§°+â€œè¿›å…¥åŒæ­¥ä»£ç å—â€ï¼›</span><br><span class="line">ç»§ç»­å¾€ä¸‹è¿›è¡Œæ‰§è¡Œå°±ä¼šä½¿å¾—çº¿ç¨‹Aè¿›è¡Œå…¥æ²‰ç¡çŠ¶æ€ï¼›</span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶CPUå†åˆ‡æ¢åˆ°å¦å¤–ä¸€ä¸ªçº¿ç¨‹ï¼›å³ä¸»çº¿ç¨‹ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼›</span><br><span class="line">å½“ä¸»çº¿ç¨‹æ²‰ç¡ä¸€ç§’ä¹‹åï¼Œæ¥ä¸‹æ¥åˆä¼šå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹å³t2ï¼Œç”¨çº¿ç¨‹Bè¡¨ç¤ºï¼›</span><br><span class="line">çº¿ç¨‹Bå¯åŠ¨ä¹‹åä¹Ÿä¼šæ¥è¿›è¡Œæ‰§è¡ŒRunnableå½“ä¸­é‡å†™çš„run<span class="literal">()</span>æ–¹æ³•ï¼›</span><br><span class="line">ä½†æ˜¯ç”±äºåœ¨CPUåˆ‡æ¢ä¹‹å‰çº¿ç¨‹Aå¹¶æ²¡æœ‰é‡Šæ”¾é”ï¼›</span><br><span class="line">å³ç¬¬ä¸€ä¸ªçº¿ç¨‹ï¼Œå³çº¿ç¨‹Aç”±äºæ²‰ç¡æ—¶é—´è¿‡é•¿ï¼›æ²¡æœ‰åŠæ³•é‡Šæ”¾é”ï¼›</span><br><span class="line">æ‰€ä»¥å¯¼è‡´çº¿ç¨‹Bæ— æ³•è·å–å¾—åˆ°é”ï¼›</span><br><span class="line">ä»è€Œåªèƒ½åœ¨åŒæ­¥ä»£ç å—å¤–ä¾§è¿›è¡Œç­‰å¾…é”ï¼Œå¤„äºé˜»å¡çŠ¶æ€ï¼›</span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶CPUå†æ¬¡åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹ï¼Œä¸»çº¿ç¨‹ç»§ç»­å¾€ä¸‹è¿›è¡Œæ‰§è¡Œï¼›</span><br><span class="line">è¿›è¡Œæ‰“å°è¾“å‡ºâ€œåœæ­¢çº¿ç¨‹å‰â€ï¼›åç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼›</span><br><span class="line">å‡†å¤‡å¼ºè¡Œå°†ç­‰å¾…é”å¯¹è±¡çš„çº¿ç¨‹Bè¿›è¡Œåœæ­¢æ‰ï¼Œå³ä½¿ç”¨äº†interrupt<span class="literal">()</span>æ–¹æ³•ï¼ˆä½†æ˜¯åœä¸æ‰ï¼›å°±æ˜¯å› ä¸ºsynchronizedæ˜¯ä¸å¯ä¸­æ–­çš„ï¼›è¿™ä¸ªå¤„äºé˜»å¡ç­‰å¾…çš„çº¿ç¨‹æ˜¯æ— æ³•è¢«ä¸­æ–­çš„ï¼›è¿™ä¸ªçº¿ç¨‹ä¼šä¸€ç›´å¤„äºç­‰å¾…é”çŠ¶æ€å³ä¸å¯è¢«ä¸­æ–­ï¼‰ï¼›</span><br><span class="line">ä¸»çº¿ç¨‹ç»§ç»­å¾€ä¸‹æ‰§è¡Œè¾“å‡ºæ‰“å°â€œåœæ­¢çº¿ç¨‹åâ€ï¼›</span><br><span class="line">æœ€åæ‰“å°çº¿ç¨‹Aä¸çº¿ç¨‹Bè¿™ä¸¤ä¸ªçº¿ç¨‹çš„çŠ¶æ€ï¼›</span><br><span class="line">çº¿ç¨‹Aç”±äºæ‰§è¡Œäº†<span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>sleep(<span class="number">888888</span>);æ‰€ä»¥å¯¼è‡´çº¿ç¨‹Açš„çŠ¶æ€å¤„äºTIMED_WAITINGï¼›</span><br><span class="line">çº¿ç¨‹Bç”±äºsynchronizedçš„ä¸å¯ä¸­æ–­æ€§æ‰€ä»¥ä¸€ç›´åœ¨åŒæ­¥ä»£ç å—å¤–ä¾§è¿›è¡Œç­‰å¾…è·å–é”å¤„äºç­‰å¾…é˜»å¡çŠ¶æ€ï¼Œæ‰€ä»¥å…¶çŠ¶æ€ä¸ºBLOCKEDï¼›ä¸å¯è¢«ä¸­æ–­ï¼›</span><br><span class="line"></span><br><span class="line">è‡³æ­¤ï¼Œå¯ä»¥è§‚å¯Ÿåˆ°çš„æ˜¯synchronizedæ˜¯ä¸å¯è¢«ä¸­æ–­çš„ï¼›</span><br><span class="line">å®ƒä¼šå¯¼è‡´æ²¡æœ‰è·å–å¾—åˆ°é”çš„çº¿ç¨‹ä¸€ç›´åœ¨åŒæ­¥ä»£ç å—å¤–ä¾§ä¸€ç›´å¤„äºä¸€ä¸ªç­‰å¾…é˜»å¡è·å–é”çš„ä¸€ä¸ªçŠ¶æ€ï¼›</span><br></pre></td></tr></table></figure><h3 id="ReentrantLockå¯ä¸­æ–­æ¼”ç¤º"><a href="#ReentrantLockå¯ä¸­æ–­æ¼”ç¤º" class="headerlink" title="ReentrantLockå¯ä¸­æ–­æ¼”ç¤º"></a>ReentrantLockå¯ä¸­æ–­æ¼”ç¤º</h3><p>ReentrantLockå¯ä¸­æ–­</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">package com.xxx.demo03_synchronized_nature;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.<span class="keyword">Lock</span>;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.ReentrantLock;</span><br><span class="line"></span><br><span class="line"><span class="built_in">public</span> <span class="keyword">class</span> Demo03_INterruptible&#123;</span><br><span class="line">    private static final <span class="keyword">Lock</span> o1 = <span class="built_in">new</span> ReentrantLock();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">public</span> static <span class="type">void</span> main(String[] args) throws InterruptedException&#123;</span><br><span class="line">      Runnable runnable = () -&gt; &#123;</span><br><span class="line">        String <span class="type">name</span> =  Thread.currentThread().getName();</span><br><span class="line">        <span class="type">boolean</span> isLock = <span class="keyword">false</span>;</span><br><span class="line">        try&#123;</span><br><span class="line">            isLock = o1.tryLock( <span class="number">3</span>, TimeUnit.SECONDS);</span><br><span class="line">            <span class="keyword">if</span>(isLock)&#123;</span><br><span class="line">              <span class="keyword">System</span>.<span class="keyword">out</span>.println(<span class="type">name</span> + "lock");</span><br><span class="line">              Thread.sleep(<span class="number">1000000</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;catch(InterruptedException e)&#123;</span><br><span class="line">          <span class="keyword">System</span>.<span class="keyword">out</span>.println(<span class="type">name</span> + "interrupted");</span><br><span class="line">        &#125;finally&#123;</span><br><span class="line">            <span class="keyword">if</span>(isLock)&#123;</span><br><span class="line">              o1.unlock();</span><br><span class="line">              <span class="keyword">System</span>.<span class="keyword">out</span>.println(<span class="type">name</span> + "unlock");</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">              <span class="keyword">System</span>.<span class="keyword">out</span>.println(<span class="type">name</span> + "æŒ‡å®šæ—¶é—´å†…æ²¡æœ‰å¾—åˆ°é”ï¼Œä¸­æ–­ï¼Œä¸ç­‰äº†ï¼Œå¯ä»¥æ¥ç€åšå…¶ä»–äº‹æƒ…ã€‚");</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ¼”ç¤º ReentrantLock çš„ä¸å¯ä¸­æ–­ç‰¹æ€§</p></blockquote><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line">package com.xxx.demo03_synchronized_nature;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  ç›®æ ‡ï¼š</span></span><br><span class="line"><span class="comment">    æ¼”ç¤º Lockä¸å¯ä¸­æ–­ç‰¹æ€§</span></span><br><span class="line"><span class="comment">    Lockå…·æœ‰ä¸¤ç§ç‰¹æ€§ï¼ˆä¸€ç§æ˜¯å¯ä¸­æ–­ï¼›å¦å¤–ä¸€ç§æ˜¯ä¸å¯ä¸­æ–­ï¼›ï¼‰</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">public <span class="keyword">class</span> Demo03_Interruptible&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åœ¨ç±»çš„æˆå‘˜å˜é‡ä½ç½®æ¥è¿›è¡Œåˆ›å»ºä¸€ä¸ªLockå¯¹è±¡</span></span><br><span class="line">  <span class="keyword">private</span> static Lock lock = <span class="keyword">new</span> <span class="constructor">ReentrantLock()</span>;</span><br><span class="line"></span><br><span class="line">  public static void main(String<span class="literal">[]</span> args)throws InterruptedException&#123;</span><br><span class="line">    test01<span class="literal">()</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ¼”ç¤º Lock ä¸å¯ä¸­æ–­</span></span><br><span class="line">  public static void test01<span class="literal">()</span>&#123;</span><br><span class="line">    Runnable run = <span class="literal">()</span>-&gt;&#123;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">        è¿™ç§æ–¹å¼æ˜¯å±äºä¸å¯ä¸­æ–­çš„ï¼›</span></span><br><span class="line"><span class="comment">        å¯ä»¥çœ‹åˆ°çš„æ˜¯:lock() void</span></span><br><span class="line"><span class="comment">        å³è¯¥æ–¹æ³•æ˜¯æ²¡æœ‰è¿”å›å€¼çš„ï¼›</span></span><br><span class="line"><span class="comment">        é‚£ä¹ˆè¿™ç§æƒ…å†µå°±å±äºä¸å¯ä¸­æ–­ï¼›</span></span><br><span class="line"><span class="comment">        å®ƒä¹Ÿä¼šä¸€ç›´ç­‰å¾…é”ï¼›</span></span><br><span class="line"><span class="comment">        å¦å¤–è·å–é”ä¹‹åä¸€å®šè¦è®°å¾—unlock()ï¼›</span></span><br><span class="line"><span class="comment">        é‚£ä¹ˆå°†unlock()æ“ä½œæ”¾å…¥åˆ°finallyå—å½“ä¸­è¿›è¡Œæ‰§è¡Œï¼›</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">      String name =<span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>current<span class="constructor">Thread()</span>.get<span class="constructor">Name()</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">try</span>&#123;</span><br><span class="line">        lock.lock<span class="literal">()</span>;</span><br><span class="line">        <span class="comment">//è·å–çº¿ç¨‹çš„åå­—</span></span><br><span class="line">        <span class="comment">//æ‰“å°å½“å‰è¿›å…¥run()ä¸­çš„çº¿ç¨‹åç§°</span></span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(name + <span class="string">"è·å¾—é”ï¼Œè¿›å…¥é”æ‰§è¡Œ"</span>);</span><br><span class="line">        <span class="comment">//åŠ ä¸€ä¸ªç¡çœ ä¿è¯è¯¥çº¿ç¨‹ä¸€ç›´åœ¨é‡Œé¢è¿›è¡Œæ‰§è¡Œä¸é€€å‡º</span></span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>sleep(<span class="number">888888</span>);</span><br><span class="line"></span><br><span class="line">      &#125;catch(InterruptedException e)&#123;</span><br><span class="line">          e.print<span class="constructor">StackTrace()</span>;</span><br><span class="line">      &#125;finally&#123;</span><br><span class="line">        <span class="comment">//åŒæ ·unlockä¹Ÿæ˜¯æ²¡æœ‰è¿”å›å€¼çš„ï¼›void</span></span><br><span class="line">        lock.unlock<span class="literal">()</span>;</span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(name + <span class="string">"é‡Šæ”¾é”"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    Thread t1 = <span class="keyword">new</span> <span class="constructor">Thread(<span class="params">run</span>)</span>;</span><br><span class="line">    t1.start<span class="literal">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®©ä¸»çº¿ç¨‹æ²‰ç¡ä¸€ç§’ï¼›</span></span><br><span class="line">    <span class="comment">//è®©ç¬¬ä¸€ä¸ªçº¿ç¨‹t1å¯åŠ¨ä¹‹åå»è¿›è¡Œæ‰§è¡ŒRunnableå½“ä¸­çš„æ‰€å®ç°çš„run()</span></span><br><span class="line">    <span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>sleep(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç»§ç»­åˆ›å»ºç¬¬äºŒä¸ªçº¿ç¨‹</span></span><br><span class="line">    Thread t2 = <span class="keyword">new</span> <span class="constructor">Thread(<span class="params">run</span>)</span>;</span><br><span class="line">    t2.start<span class="literal">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç»ˆæ­¢ä¸€ä¸‹t2çº¿ç¨‹çœ‹æ˜¯å¦èƒ½å¤Ÿè¿›è¡Œç»ˆæ­¢ï¼›</span></span><br><span class="line">    <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"ç»ˆæ­¢t2çº¿ç¨‹å‰"</span>);</span><br><span class="line">    t2.interrupt<span class="literal">()</span>;</span><br><span class="line">    <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"ç»ˆæ­¢t2çº¿ç¨‹å"</span>);</span><br><span class="line">  </span><br><span class="line">    <span class="comment">//è®©ä¸»çº¿ç¨‹æ²‰ç¡ä¸€ç§’</span></span><br><span class="line">    <span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>sleep(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è·å–ä¸¤ä¸ªçº¿ç¨‹çš„çŠ¶æ€</span></span><br><span class="line">    <span class="comment">//ç¬¬äºŒä¸ªçº¿ç¨‹t2æ˜¯åæ¥çš„å³åœ¨ç¬¬ä¸€ä¸ªçº¿ç¨‹t1åˆ›å»ºå¹¶å¯åŠ¨ä¹‹åä»¥åŠä¸»çº¿ç¨‹æ²‰ç¡äº†1ç§’ä¹‹åæ‰åˆ›å»ºçš„ç¬¬äºŒä¸ªçº¿ç¨‹t2ï¼›</span></span><br><span class="line">    <span class="comment">//å³ç¬¬ä¸€ä¸ªçº¿ç¨‹t1å·²ç»è·å–å¾—åˆ°é”äº†ï¼›</span></span><br><span class="line">    <span class="comment">//ç”±äºç¬¬ä¸€ä¸ªçº¿ç¨‹t1åœ¨Runnableæ‰€å®ç°çš„run()æ–¹æ³•å½“ä¸­è¿›è¡Œäº†é•¿æ—¶é—´çš„æ²‰ç¡åˆæ²¡æœ‰åŠæ³•é‡Šæ”¾é”ï¼›</span></span><br><span class="line">    <span class="comment">//æ‰€å¯¼è‡´ç¬¬äºŒä¸ªçº¿ç¨‹ï¼Œå³çº¿ç¨‹t2åªèƒ½å¤Ÿåœ¨åŒæ­¥ä»£ç å—å¤–è¿›è¡Œé˜»å¡ç­‰å¾…è·å–é”ï¼›</span></span><br><span class="line">    <span class="comment">//çœ‹ç¬¬äºŒä¸ªçº¿ç¨‹t2æ˜¯å¦èƒ½å¤Ÿè¢«ä¸­æ–­ä»¥åŠè§‚å¯Ÿè¿™ä¸¤ä¸ªçº¿ç¨‹çš„çŠ¶æ€ï¼›</span></span><br><span class="line">    <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(t1.get<span class="constructor">State()</span>);</span><br><span class="line">    <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(t2.get<span class="constructor">State()</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------</span><br><span class="line">è¿è¡Œæ•ˆæœï¼š</span><br><span class="line">(Runæ˜¾ç¤ºçº¢ç¯å³æ²¡æœ‰åœæ­¢è¿è¡Œä¾ç„¶åœ¨ç»§ç»­)</span><br><span class="line">Thread-<span class="number">0</span>è¿›å…¥åŒæ­¥ä»£ç å—</span><br><span class="line">åœæ­¢t2çº¿ç¨‹å‰</span><br><span class="line">åœæ­¢t2çº¿ç¨‹å</span><br><span class="line">TIMED_WAITING</span><br><span class="line">WAITING</span><br><span class="line">--------------------------------------------------</span><br><span class="line">é‚£ä¹ˆé€šè¿‡è¿è¡Œç»“æœå¯ä»¥çœ‹å‡ºt2.interrupt<span class="literal">()</span>æ˜¯æ²¡æœ‰æ‰§è¡ŒæˆåŠŸçš„ï¼›</span><br><span class="line">å› ä¸ºt2è¿›è¡Œæ‰“å°å…¶çº¿ç¨‹çŠ¶æ€å‘ç°ä¾æ—§å¤„äºç­‰å¾…çŠ¶æ€å³WAITINGï¼›</span><br><span class="line">ä¹Ÿå°±æ˜¯è¯´t2çº¿ç¨‹æ²¡æœ‰æŠ¢åˆ°é”æ‰€ä»¥å¯¼è‡´ä¸€ç›´å¤„äºç­‰å¾…çŠ¶æ€ï¼›</span><br><span class="line"></span><br><span class="line">åˆ†æï¼š</span><br><span class="line">ä¸»çº¿ç¨‹ä»main<span class="literal">()</span>æ–¹æ³•å¼€å§‹è¿›è¡Œæ‰§è¡Œï¼›</span><br><span class="line">å³æ‰§è¡Œtest01<span class="literal">()</span>æ–¹æ³•ï¼›</span><br><span class="line">åˆ›å»ºä¸€ä¸ªRunnableï¼ŒRunnableå½“ä¸­å®ç°run<span class="literal">()</span>æ–¹æ³•ï¼›</span><br><span class="line">åˆ›å»ºå¹¶å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹t1ï¼›å»è¿›è¡Œæ‰§è¡ŒRunnable runå½“ä¸­çš„run<span class="literal">()</span>æ–¹æ³•ï¼›</span><br><span class="line">å³çº¿ç¨‹t1æ‰§è¡Œrun<span class="literal">()</span>å½“ä¸­çš„å†…å®¹ï¼›</span><br><span class="line">æ­¤æ—¶è¿˜æ²¡æœ‰å…¶ä»–çº¿ç¨‹è·å–å¾—åˆ°lock.lock<span class="literal">()</span>å½“ä¸­çš„é”ï¼›</span><br><span class="line">æ‰€ä»¥çº¿ç¨‹t1æ­¤æ—¶å¯ä»¥è·å–å¾—åˆ°é”ï¼›</span><br><span class="line">å³è¿›å…¥åŒæ­¥ä»£ç å—ä¸­è¿›è¡Œæ‰“å° <span class="string">"Thread-0è·å¾—é”ï¼Œè¿›å…¥é”æ‰§è¡Œ"</span>åè¿›å…¥çº¿ç¨‹t1é•¿æ—¶é—´ç¡çœ ä¸”å¹¶æœªé‡Šæ”¾é”ï¼›</span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶CPUåˆ‡æ¢åˆ°ä¸»çº¿ç¨‹ï¼Œä¸»çº¿ç¨‹ç»§ç»­å‘ä¸‹æ‰§è¡Œï¼›</span><br><span class="line">ä¸»çº¿ç¨‹æ²‰ç¡ä¸€ç§’ä¹‹åï¼›åˆè¿›è¡Œåˆ›å»ºå¹¶å¯åŠ¨ç¬¬äºŒä¸ªçº¿ç¨‹t2ï¼›</span><br><span class="line">é‚£ä¹ˆç¬¬äºŒä¸ªçº¿ç¨‹t2ä¹Ÿä¼šå»è¿›è¡Œæ‰§è¡ŒRunnable runå½“ä¸­çš„run<span class="literal">()</span>æ–¹æ³•ï¼›</span><br><span class="line">ä½†æ˜¯æ­¤æ—¶ç¬¬äºŒä¸ªçº¿ç¨‹t2æ˜¯æ— æ³•å¾—åˆ°é”çš„ï¼›</span><br><span class="line">ç”±äºçº¿ç¨‹t1å¹¶æœªé‡Šæ”¾é”è€Œæ˜¯å‡ºäºé•¿æ—¶é—´çš„ç¡çœ çŠ¶æ€ï¼›</span><br><span class="line">æ‰€ä»¥å¯¼è‡´çº¿ç¨‹t2æ— æ³•è·å–å¾—åˆ°é”ä»è€Œå¯¼è‡´åœ¨åŒæ­¥ä»£ç å—å¤–ä¾§è¿›è¡Œç­‰å¾…è·å–é”ï¼›</span><br><span class="line">æ‰€ä»¥çº¿ç¨‹t2ä¼šå¤„äºä¸€ç§å«åšWAITINGçš„çŠ¶æ€ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™ä¸ªæ—¶å€™CPUåˆåˆ‡æ¢åˆ°ä¸»çº¿ç¨‹å½“ä¸­æ¥ï¼›</span><br><span class="line">åˆ™ä¸»çº¿ç¨‹ç»§ç»­å¾€ä¸‹è¿›è¡Œæ‰§è¡Œå‡†å¤‡å»å¼ºè¡Œåœæ­¢çº¿ç¨‹t2ä½†æ˜¯åœä¸æ‰</span><br><span class="line">ï¼ˆlock.lock<span class="literal">()</span>ä¹Ÿæ˜¯å±äºä¸å¯ä¸­æ–­çš„ï¼›ï¼‰ï¼›</span><br><span class="line">æ‰“å°â€œåœæ­¢t2çº¿ç¨‹å‰â€ä»¥åŠç»§ç»­å¾€ä¸‹æ‰§è¡Œå¯¹çº¿ç¨‹t2è¿›è¡Œä¸­æ–­ä»¥åŠæ‰“å°â€œåœæ­¢t2çº¿ç¨‹åâ€ï¼›</span><br><span class="line"></span><br><span class="line">ç»§ç»­å‘ä¸‹æ‰§è¡Œä¸»çº¿ç¨‹åˆä¸€æ¬¡è¿›è¡Œæ²‰ç¡ä¸€ç§’åï¼›</span><br><span class="line">æ‰“å°çº¿ç¨‹t1ä¸çº¿ç¨‹t2çš„çŠ¶æ€ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±ä¼šå‘ç°çº¿ç¨‹t2å¤„äºä¸€ç§WAITINGçš„çŠ¶æ€ï¼›</span><br><span class="line">å³ä¹Ÿè¯´æ˜äº†<span class="module-access"><span class="module"><span class="identifier">ReentrantLock</span>.</span></span>lock<span class="literal">()</span>æ˜¯ä¸å¯è¢«ä¸­æ–­çš„ï¼›</span><br><span class="line">å³lock.lock<span class="literal">()</span>æ–¹æ³•åˆ™å¯¼è‡´åœ¨åŒæ­¥ä»£ç å—å¤–ä¾§çš„çº¿ç¨‹çŠ¶æ€æ˜¯ä¸å¯ä¸­æ–­çš„ï¼›</span><br><span class="line">ä½†æ˜¯ReentrantLockè¿˜æœ‰ä¸€ä¸ªæ–¹æ³•å«åš<span class="keyword">try</span><span class="constructor">Lock()</span>;</span><br></pre></td></tr></table></figure><blockquote><p>æ¼”ç¤º ReentrantLockçš„å¯ä¸­æ–­ç‰¹æ€§</p></blockquote><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">package com.xxx.demo03_synchronized_nature;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.ReentrantLock;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  ç›®æ ‡ï¼šæ¼”ç¤ºLockçš„å¯ä¸­æ–­ç‰¹æ€§</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo03_Interruptible</span>&#123;</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> Lock lock = <span class="keyword">new</span> ReentrantLock();</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(<span class="keyword">String</span>[] args)</span>throws InterruptedException</span>&#123;</span><br><span class="line">    test02();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ¼”ç¤º Lock å¯ä¸­æ–­</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">test02</span><span class="params">()</span> throws InterruptedException</span>&#123;</span><br><span class="line">    Runnable <span class="built_in">run</span> = ()-&gt;&#123;</span><br><span class="line">      <span class="keyword">String</span> name = Thread.currentThread().getName();</span><br><span class="line">      <span class="keyword">boolean</span> b = <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">        tryLock(long time, TimeUnit unit) è¿”å›booleanç±»å‹</span></span><br><span class="line"><span class="comment">        tryLockä¼šè¿›è¡Œå°è¯•è·å–é”ï¼Œ</span></span><br><span class="line"><span class="comment">        å¦‚æœèƒ½å¤Ÿè·å¾—é”åˆ™è¿”å›trueï¼›</span></span><br><span class="line"><span class="comment">        åä¹‹ä¸èƒ½è·å¾—é”åˆ™è¿”å›falseï¼›</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        åˆ°æ—¶å€™å¦‚æœæ˜¯ç¬¬äºŒä¸ªçº¿ç¨‹è¦æ¥è¿›è¡Œè·å–é”æ¥è¿›è¡ŒæŠ¢é”ï¼›</span></span><br><span class="line"><span class="comment">        é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å¦‚æœä¸‰ç§’å†…æ²¡æœ‰è·å–å¾—åˆ°é”ï¼›</span></span><br><span class="line"><span class="comment">        é‚£ä¹ˆå°±ä¼šè¿›è¡Œä¸­æ–­ï¼›ä»è€Œè¿›å…¥elseå—ä¸­åšå…¶ä»–æ“ä½œï¼›</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="comment">//å°è¯•3ç§’ï¼Œæ—¶é—´å•ä½ä¸ºç§’ï¼›</span></span><br><span class="line">        <span class="comment">//ç”±äºå•ä½æ˜¯ç§’æ‰€ä»¥ç›´æ¥è¾“å…¥3å³å¯è€Œä¸æ˜¯3000</span></span><br><span class="line">        <span class="comment">//b = lock.tryLock(3000, TimeUnit.SECONDS);</span></span><br><span class="line">        b = lock.tryLock(<span class="number">3</span>, TimeUnit.SECONDS);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¯´æ˜å°è¯•è·å–å¾—åˆ°äº†é”ï¼›åˆ™è¿›å…¥ifå—å½“ä¸­</span></span><br><span class="line">        <span class="keyword">if</span>(b)&#123;</span><br><span class="line">          System.out.<span class="built_in">println</span>(name + <span class="string">"è·å¾—é”ï¼Œè¿›å…¥é”æ‰§è¡Œ"</span>);</span><br><span class="line">          Thread.sleep(<span class="number">888888</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          <span class="comment">//é‚£ä¹ˆelseåˆ™è¯´æ˜æ²¡æœ‰è·å–å¾—åˆ°é”ï¼›</span></span><br><span class="line">          <span class="comment">//åˆ™å¯ä»¥è®©å…¶åšå…¶ä»–æ“ä½œä»è€Œä¹Ÿå°±è¯æ˜äº†Lock.tryLock()æ˜¯å¯ä¸­æ–­çš„ï¼›</span></span><br><span class="line">          System.out.<span class="built_in">println</span>(name + <span class="string">"åœ¨æŒ‡å®šæ—¶é—´å†…æ²¡æœ‰è·å–å¾—åˆ°é”åˆ™åšå…¶ä»–æ“ä½œ"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;<span class="keyword">catch</span>(InterruptedException e)&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">      &#125;finally&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">        æ­¤æ—¶çš„unlock()éœ€è¦è¿›è¡Œæ³¨æ„ï¼›</span></span><br><span class="line"><span class="comment">        å¦‚æœè¯´CPUå½“å‰åˆ‡æ¢åˆ°çš„å½“å‰çº¿ç¨‹æ²¡æœ‰è·å–å¾—åˆ°é”åˆ™å¹¶ä¸éœ€è¦è¿›è¡Œunlock()æ“ä½œï¼›</span></span><br><span class="line"><span class="comment">        å¦‚æœCPUå½“å‰åˆ‡æ¢åˆ°çš„å½“å‰çº¿ç¨‹è·å–å¾—åˆ°äº†é”å¹¶æ‰§è¡Œå®ŒæˆåŒæ­¥ä»£ç å—å½“ä¸­çš„å†…å®¹æ‰€ä»¥æ­¤æ—¶finallyå½“ä¸­æ˜¯éœ€è¦è¿›è¡Œæ‰§è¡Œunlock()æ“ä½œçš„ï¼›</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">if</span>(b)&#123;<span class="comment">//å¾—åˆ°äº†é”æ‰è¿›è¡Œé‡Šæ”¾é”æ“ä½œ</span></span><br><span class="line">            lock.unlock();</span><br><span class="line">            System.out.<span class="built_in">println</span>(name + <span class="string">"é‡Šæ”¾é”"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åœ¨åç»­çš„ä»£ç ä¸­è®©ä¸¤ä¸ªçº¿ç¨‹è¿›è¡Œå¯åŠ¨èµ·æ¥å³å¯å…¶ä½™ä»£ç å¯ä»¥ä¸è¦ï¼›</span></span><br><span class="line">    Thread t1 = <span class="keyword">new</span> Thread(<span class="built_in">run</span>);</span><br><span class="line">    t1.start();</span><br><span class="line">    Thread t2 = <span class="keyword">new</span> Thread(<span class="built_in">run</span>);</span><br><span class="line">    t2.start();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    System.out.println("åœæ­¢t2çº¿ç¨‹å‰");</span></span><br><span class="line"><span class="comment">    t2.interrupt();</span></span><br><span class="line"><span class="comment">    System.out.println("åœæ­¢t2çº¿ç¨‹å");</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Thread.sleep(1000);</span></span><br><span class="line"><span class="comment">    System.out.println(t1.getState());</span></span><br><span class="line"><span class="comment">    System.out.println(t2.getState());</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------------</span><br><span class="line">ä»£ç æ‰§è¡Œæ•ˆæœï¼š</span><br><span class="line">Thread<span class="number">-0</span>è·å¾—é”ï¼Œè¿›å…¥é”æ‰§è¡Œ</span><br><span class="line">Thread<span class="number">-1</span>åœ¨æŒ‡å®šæ—¶é—´æ²¡æœ‰å¾—åˆ°é”åšå…¶ä»–æ“ä½œ</span><br><span class="line">--------------------------------------------------------</span><br><span class="line">è¯¦ç»†åˆ†æä¸€ä¸‹ReentrantLockå¯ä¸­æ–­æ€§æµç¨‹ï¼š</span><br><span class="line">å…ˆç”»ä¸€ä¸ªçº¢è‰²çš„ç®­å¤´æ¥è¡¨ç¤ºä¸»çº¿ç¨‹ï¼›ç„¶åæ¥åˆ†ææ•´ä¸ªæµç¨‹ï¼›</span><br><span class="line">ç¨‹åºç”±main()æ–¹æ³•å¼€å§‹è¿›è¡Œæ‰§è¡Œï¼›ç„¶åæ‰§è¡Œtest02()æ–¹æ³•ï¼›</span><br><span class="line">åˆ›å»ºä¸€ä¸ªRunnableå¹¶å®ç°å…¶<span class="built_in">run</span>()æ–¹æ³•ï¼›</span><br><span class="line">åˆ›å»ºRunnableå®Œæˆä¹‹åï¼›åˆ›å»ºç¬¬ä¸€ä¸ªçº¿ç¨‹t1å¹¶å¯åŠ¨å»æ‰§è¡ŒRunnableå½“ä¸­çš„<span class="built_in">run</span>()æ–¹æ³•å³æ‰§è¡Œ<span class="built_in">run</span>()æ–¹æ³•å†…éƒ¨çš„å†…å®¹ï¼›</span><br><span class="line">è€Œç¬¬ä¸€ä¸ªçº¿ç¨‹t1æ˜¯å¯ä»¥è¿›è¡Œè·å–å¾—åˆ°é”çš„ï¼›å³lock.tryLock(<span class="number">3</span>,TimeUnit.SECONDS)æ—¶ï¼›åˆ™è¿›å…¥ä»£ç å—<span class="keyword">if</span>(b)å½“ä¸­å¹¶æ‰“å°ç¬¬ä¸€å¥è¯â€œThread<span class="number">-0</span>è·å¾—é”ï¼Œè¿›å…¥é”æ‰§è¡Œâ€ï¼›é‚£ä¹ˆæ¥ç€çº¿ç¨‹t1å°±ä¸€ç›´ç¡çœ äº†Thread.sleep(<span class="number">888888</span>);</span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶CPUåˆåˆ‡æ¢ä¼šä¸»çº¿ç¨‹ï¼›æ¥ç€å¾€ä¸‹èµ°æ²‰ç¡ä¸€ç§’ä¹‹åè¿›è¡Œåˆ›å»ºt2çº¿ç¨‹å¹¶å¯åŠ¨t2çº¿ç¨‹ï¼›</span><br><span class="line">é‚£ä¹ˆçº¿ç¨‹t2æ­¤æ—¶ä¹Ÿä¼šæ¥è¿›è¡Œæ‰§è¡ŒRunnableå½“ä¸­çš„<span class="built_in">run</span>()æ–¹æ³•ï¼›</span><br><span class="line">é‚£ä¹ˆç¬¬äºŒä¸ªçº¿ç¨‹t2è¿›æ¥æ—¶æ‰§è¡Œlock.tryLockæ—¶ä¼šå‘ç°é”å·²ç»è¢«t1çº¿ç¨‹è·å–å¾—åˆ°äº†ï¼›ä¸”t1çº¿ç¨‹å¹¶æ²¡æœ‰é‡Šæ”¾é”è€Œä¸”å¤„äºé•¿æ—¶é—´çš„ç¡çœ çŠ¶æ€ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™ä¸ªæ—¶å€™t2çº¿ç¨‹ä¼šè¿›è¡Œå°è¯•è·å–é”<span class="number">3</span>ç§’ï¼›</span><br><span class="line"><span class="number">3</span>ç§’è¿‡åå¦‚æœä¾æ—§æ— æ³•è·å–å¾—åˆ°é”ï¼ˆå³çº¿ç¨‹t1ä¸‰ç§’åä¾æ—§æ²¡æœ‰è¿›è¡Œé‡Šæ”¾é”ï¼‰é‚£ä¹ˆçº¿ç¨‹t2åˆ™å°†ä¸­æ–­ä¸”ä¸ä¼šç»§ç»­ç­‰å¾…è·å–é”ï¼Œ</span><br><span class="line">å³tryLockåˆ™è¿”å›<span class="literal">false</span>ï¼›</span><br><span class="line">è¿”å›<span class="literal">false</span>åˆ™å°†ä¼šæ‰§è¡Œ<span class="keyword">else</span>å—å½“ä¸­çš„ä»£ç å³æ‰“å°è¾“å‡ºâ€œThread<span class="number">-1</span>åœ¨æŒ‡å®šæ—¶é—´æ²¡æœ‰å¾—åˆ°é”åšå…¶ä»–æ“ä½œâ€åšå…¶ä»–æ“ä½œå»äº†ï¼›</span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶å¯ä»¥çœ‹åˆ°çš„æ˜¯ tryLockçš„è¯åˆ™ä¼šç­‰å¾…æŒ‡å®šçš„æ—¶é—´ï¼Œ</span><br><span class="line">åœ¨æŒ‡å®šçš„æ—¶é—´å†…å»å°è¯•è·å–é”ï¼›</span><br><span class="line">ä¹Ÿå°±æ˜¯è¯´åœ¨æŒ‡å®šçš„æ—¶é—´å†…ç­‰å¾…ä¸Šä¸€ä¸ªè·å–é”çš„çº¿ç¨‹è¿›è¡Œé‡Šæ”¾é”ï¼›</span><br><span class="line">å¦‚æœè¯´åœ¨æŒ‡å®šçš„æ—¶é—´å†…ä¸Šä¸€ä¸ªè·å–å¾—åˆ°é”çš„çº¿ç¨‹æ‰§è¡Œå®Œæˆå¹¶é‡Šæ”¾äº†é”é‚£ä¹ˆåˆ™å½“å‰è¯¥çº¿ç¨‹å°±åœ¨æŒ‡å®šçš„æ—¶é—´ç»“æŸåä¼šè¿”å›<span class="literal">true</span>è¡¨ç¤ºè·å–å¾—åˆ°é”ï¼›</span><br><span class="line">å¦‚æœä¸Šä¸€ä¸ªè·å–å¾—åˆ°é”çš„çº¿ç¨‹åœ¨æŒ‡å®šçš„æ—¶é—´å†…å¹¶æ²¡æœ‰é‡Šæ”¾é”é‚£ä¹ˆåˆ™å½“å‰ç­‰å¾…çš„çº¿ç¨‹åœ¨æŒ‡å®šç­‰å¾…çš„æ—¶é—´ç»“æŸåï¼›åˆ™è¿›è¡Œä¸­æ–­ä¸ä¼šå†å»ç­‰å¾…è·å–é”ï¼›</span><br><span class="line">ç›´æ¥è¿”å›<span class="literal">false</span>è¡¨ç¤ºæ²¡æœ‰è·å–å¾—åˆ°é”ï¼Œè¯¥ä¸ºå»åšå…¶ä»–çš„æ“ä½œï¼›</span><br></pre></td></tr></table></figure><h3 id="å°ç»“-10"><a href="#å°ç»“-10" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>ä¸å¯ä¸­æ–­æ˜¯æŒ‡ï¼šå½“ä¸€ä¸ªçº¿ç¨‹è·å¾—é”ä¹‹åï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸€è‡´å¤„äºé˜»å¡æˆ–ç­‰å¾…çŠ¶æ€ï¼Œå‰ä¸€ä¸ªçº¿ç¨‹ä¸é‡Šæ”¾é”ï¼Œåä¸€ä¸ªçº¿ç¨‹ä¼šä¸€ç›´é˜»å¡æˆ–è€…ç­‰å¾…ï¼Œå¹¶ä¸”åœ¨é˜»å¡æˆ–ç­‰å¾…çš„è¿‡ç¨‹ä¸­å®ƒæ˜¯ä¸å¯è¢«ä¸­æ–­çš„ï¼Œå®ƒä¼šä¸€ç›´ç­‰å¾…æˆ–è€…è¢«é˜»å¡ï¼›  </p><p><strong>synchronized</strong>æ˜¯å±äº<strong>ä¸å¯è¢«ä¸­æ–­</strong>çš„ï¼›<br><strong>Lockï¼ˆReentrantLockï¼‰</strong>çš„<strong>lock</strong>æ–¹æ³•æ˜¯<strong>ä¸å¯è¢«ä¸­æ–­</strong>çš„ï¼›<br><strong>Lockï¼ˆReentrantLockï¼‰</strong>çš„<strong>tryLock</strong>æ–¹æ³•æ˜¯<strong>å¯ä¸­æ–­</strong>çš„ï¼›</p><h2 id="javapåæ±‡ç¼–å­¦ä¹ synchronizedçš„åŸç†"><a href="#javapåæ±‡ç¼–å­¦ä¹ synchronizedçš„åŸç†" class="headerlink" title="javapåæ±‡ç¼–å­¦ä¹ synchronizedçš„åŸç†"></a>javapåæ±‡ç¼–å­¦ä¹ synchronizedçš„åŸç†</h2><p>ç¬¬äº”ç« ï¼šsynchronizedåŸç†</p><p>ï¼ˆè¾ƒéš¾çš„ä¸€å—ï¼Œç”±æµ…å…¥æ·±ï¼Œæ¶‰åŠ<strong>synchronizedçš„åŸç†</strong>è®²è§£ï¼›ï¼‰</p><blockquote><ul><li>é¦–å…ˆä¼šé€šè¿‡<strong>javapåæ±‡ç¼–</strong>çš„æ–¹å¼ï¼Œ</li><li><em>synchronized*</em>å…¶å®è¢«è½¬æ¢æˆäº†<strong>ä¸¤æ¡å­—èŠ‚ç æŒ‡ä»¤</strong>ï¼Œ<br>åˆ†åˆ«æ˜¯<strong>monitorenter</strong>ä»¥åŠ<strong>monitorexit</strong>ï¼›<br>ç„¶åä¼šé€šè¿‡Oracleçš„å®˜æ–¹æ–‡æ¡£å³<strong>JVMè§„èŒƒ</strong>æ¥å¯¹<strong>å­—èŠ‚ç æŒ‡ä»¤</strong> <strong>monitorenter</strong>ä»¥åŠ<strong>monitorexit</strong>çš„ä¸€ä¸ªç®€å•çš„ä»‹ç»ï¼Œ<br>ä»‹ç»è¿™<strong>ä¸¤ä¸ªæŒ‡ä»¤</strong>æ—¶å¦‚ä½•æ¥è¿›è¡Œ<strong>åŠ é”å’Œè§£é”</strong>çš„ï¼Œ<br>é€šè¿‡<strong>å­—èŠ‚ç æŒ‡ä»¤</strong>æ¥ä»‹ç»<strong>synchronized</strong>å±äºæ¯”è¾ƒæ·±å…¥ï¼Œ<br>ä½†æ˜¯æœ‰å¹¶ä¸æ˜¯ç‰¹åˆ«çš„æ·±å…¥ï¼Œ<br>é‚£ä¹ˆä¸ºäº†æ›´åŠ æ·±å±‚æ¬¡çš„ç†è§£<strong>synchronizedçš„åº•å±‚æœºåˆ¶</strong>ï¼Œ<br>å°†ä¼šæ·±å…¥<strong>JVMçš„æºç </strong>æ¥è¿›è¡Œæºç åˆ†æã€‚</li><li><strong>JVMåº•å±‚</strong>æ˜¯ä½¿ç”¨<strong>cã€c++</strong>æ‰€ç¼–å†™çš„ï¼›</li><li><em>synchronized*</em>æ˜¯ä¸€ä¸ª<strong>å…³é”®å­—</strong>ï¼Œ</li><li><em>åº•å±‚*</em>ç”±<strong>cã€c++</strong>æ¥ç¼–å†™ã€‚<br>ä¼šè¿›è¡Œåˆ†æè¿™ä¸€å—çš„ä»£ç ï¼›<br>åˆ°æ—¶å€™å°±å¯ä»¥æ¸…æ™°çš„çŸ¥é“<strong>synchronized</strong>çš„ä¸€ä¸ªæ¸…æ™°çš„<strong>åº•å±‚ç»“æ„</strong>ä»¥åŠå¦‚ä½•<strong>è·å¾—é”</strong>ã€<strong>ç­‰å¾…é”</strong>ä»¥åŠå¦‚ä½•<strong>é‡Šæ”¾é”</strong>çš„ï¼›</li><li>å¦å¤–è¿˜ä¼šå»ä»‹ç»<strong>synchronized</strong>ä¸ºä»€ä¹ˆæ˜¯ä¸€ä¸ª<strong>é‡é‡çº§çš„é”</strong>ï¼Œ<br>ä»¥åŠ<strong>synchronized</strong>ä¸ºä»€ä¹ˆä¼š<strong>å¼€é”€æ¯”è¾ƒå¤§</strong>ï¼›<br>å› ä¸º<strong>synchronized</strong>æ˜¯ä¸€ä¸ª<strong>é‡é‡çº§çš„é”</strong>ï¼Œ<br>æ‰€ä»¥å…¶<strong>æ•ˆç‡ä¸é«˜</strong>ï¼Œ<br>é‚£ä¹ˆåœ¨ç¬¬å…­ç« å°±ä¼šæ¥è¿›è¡Œä»‹ç»<strong>JDK6</strong>å½“ä¸­å¯¹<strong>synchronized</strong>çš„ä¸€ä¸ª<strong>ä¼˜åŒ–æªæ–½</strong>ï¼Œ<strong>synchronized</strong>çš„æ¶‰åŠåˆ°ä¸€ä¸ªå«åš<strong>CASæ“ä½œ</strong>ï¼Œ<br>é‚£ä¹ˆå°±ä¼šå…ˆå»è¿›è¡Œä»‹ç»<strong>CAS</strong>çš„ä¸€ä¸ª<strong>åŸç†</strong>ï¼Œ<br>é‚£ä¹ˆå…¶å®<strong>CAS</strong>ä¹Ÿå±äºä¸€ä¸ª<strong>åŸå­æ“ä½œ</strong>ï¼Œ<br>å¯ä»¥å°†<strong>CASæ“ä½œ</strong>çœ‹åšæ˜¯ä¸€ä¸ª<strong>è½»é‡çº§çš„synchronized</strong>ï¼Œ<br>å®ƒèƒ½å¤Ÿ<strong>ä¿è¯å˜é‡ä¿®æ”¹</strong>çš„è¿™æ ·ä¸€ä¸ª<strong>åŸå­æ“ä½œ</strong>ï¼›<br>ä»‹ç»äº†<strong>CAS</strong>ä¹‹åå°±å°†ä¼šä»‹ç»<strong>é”å‡çº§</strong>çš„ä¸€ä¸ª<strong>è¿‡ç¨‹</strong>ï¼Œ</li><li><em>é”å‡çº§*</em>æ˜¯ç”± <strong>æ— é”-â†’åå‘é”-â†’è½»é‡çº§é”-â†’é‡é‡çº§é”</strong> ï¼›</li><li>ç”±æµ…å…¥æ·±çš„æ¥è¿›è¡Œå­¦ä¹ ï¼Œé‚£ä¹ˆå­˜åœ¨è¿™ä¹ˆå¤šé”å°±ä¼šå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼›<br>å¦‚ä½•æ¥å¾—çŸ¥æ˜¯<strong>å±äºå“ªä¸€ç§é”</strong>ï¼Œ<br>é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ä¼šå…ˆè¿›è¡Œäº†è§£<strong>JAVAå¯¹è±¡çš„å¸ƒå±€</strong>ï¼›<br>ä»¥å‰å¯¹javaå¯¹è±¡çš„ç†è§£æ˜¯è¿™æ ·çš„-â†’javaå¯¹è±¡æ˜¯å­˜åœ¨åœ¨å †ä¸­ï¼Œç„¶åæœ‰ä¸€å—ç©ºé—´å¯ä»¥æ¥è¿›è¡Œå­˜æ”¾å…¶å¯¹è±¡å½“ä¸­çš„æˆå‘˜å˜é‡ï¼›<br>é‚£ä¹ˆä»‹ç»çš„<strong>javaå¯¹è±¡å¸ƒå±€</strong>ï¼Œå…¶å½“ä¸­ä¸ä»…ä¼šæœ‰<strong>javaå¯¹è±¡çš„å®ä¾‹æ•°æ®</strong>è¿˜ä¼šæœ‰<strong>å¯¹è±¡å¤´</strong>ä»¥åŠä¸€äº›<strong>å¯¹é½æ•°æ®</strong>ï¼›<br>é‚£ä¹ˆ<strong>é”å‡çº§è¿‡ç¨‹</strong>ä¸­çš„è¿™äº›<strong>é”</strong>æ˜¯<strong>å­˜åœ¨äºå¯¹è±¡å¤´å½“ä¸­çš„Mark Word</strong>å½“ä¸­çš„ï¼Œ<br>åˆ°æ—¶å€™é€šè¿‡c++çš„æºç æ¥è¿›è¡Œè¯¦ç»†åˆ†æï¼›</li><li>å¦å¤–<strong>JDK6</strong>è¿˜å¯¹<strong>synchronized</strong>åšäº†ä¸€äº›<strong>é”æ¶ˆé™¤å’Œé”ç²—åŒ–çš„ä¼˜åŒ–</strong>æ“ä½œï¼Œ<br>ç»è¿‡å¯¹<strong>synchronizedçš„åŸç†</strong>çš„å­¦ä¹ ä¹‹åå°±å¯ä»¥æ€»ç»“å‡ºå†™ä»£ç åº”è¯¥å¦‚ä½•å¯¹<strong>synchronizedä¼˜åŒ–</strong>ï¼Œå†™å‡ºæ›´<strong>é«˜æ•ˆ</strong>æ›´<strong>å¥½</strong>çš„ä»£ç ï¼›<br>é‚£ä¹ˆä¼šä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢è¿›è¡Œæ¥ä»‹ç»ï¼›<br>ç¬¬ä¸€ä¸ªï¼š<strong>å‡å°‘synchronizedçš„èŒƒå›´</strong>ï¼›<br>ç¬¬äºŒä¸ªï¼š<strong>é™ä½synchronizedé”çš„ç²’åº¦</strong><br>ï¼ˆè¿™å½“ä¸­æœ‰ä¸€ä¸ªç»å…¸çš„ä¾‹å­å°±æ˜¯<strong>HashTable</strong>ï¼Œ<strong>HashTable</strong>ä¼š<strong>é”</strong>ä½æ‰€æœ‰çš„<strong>æ•°æ®</strong>ï¼›è€Œååˆæ¨å‡ºäº†ä¸€ä¸ªå«åš<strong>ConcurrentHashMap</strong>ï¼Œé‚£ä¹ˆ<strong>ConcurrentHashMap</strong> <strong>åª</strong>ä¼š<strong>é”</strong>ä½<strong>ä¸€ä¸ªæ¡¶</strong>å½“ä¸­çš„<strong>æ•°æ®</strong>ï¼‰ï¼›<br>ç¬¬ä¸‰ä¸ªï¼šé€šè¿‡<strong>è¯»å†™åˆ†ç¦»</strong>çš„æ–¹å¼æ¥è¿›è¡Œ<strong>æé«˜æ•ˆç‡</strong>ï¼›<br>ä»¥ä¸Šå°±æ˜¯<strong>synchronized</strong>è¯¾ç¨‹çš„ä¸»è¦å†…å®¹ï¼›</li></ul></blockquote><p>javap åæ±‡ç¼–</p><p>synchronizedåŸç†çš„å­¦ä¹ ï¼›<br>é¦–å…ˆé€šè¿‡javapåæ±‡ç¼–çš„æ–¹å¼æ¥è¿›è¡Œå­¦ä¹ synchronizedåŸç†ï¼›<br>æ¥ç€å†é€šè¿‡JVMæºç å†æ¥æ·±å…¥çš„å­¦ä¹ synchronizedåŸç†ï¼›</p><h3 id="ç›®æ ‡-11"><a href="#ç›®æ ‡-11" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>é€šè¿‡ <strong>javap åæ±‡ç¼–</strong> å­¦ä¹  synchronizedçš„åŸç†</p><p>ç¼–å†™ä¸€ä¸ªç®€å•çš„synchronizedä»£ç ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xxx.demo04_synchronized_monitor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo01</span></span>&#123;</span><br><span class="line">  <span class="comment">//ä¾èµ–çš„é”å¯¹è±¡</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> Object obj = <span class="keyword">new</span> Object();</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++)&#123;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//synchronizedåŒæ­¥ä»£ç å—ï¼›ä¸”åœ¨ä»£ç å—å½“ä¸­åšäº†ç®€å•çš„æ‰“å°æ“ä½œï¼›</span></span><br><span class="line">      <span class="comment">//é‡ç‚¹æ˜¯çœ‹synchronizedåœ¨åæ±‡ç¼–ä¹‹åå½¢æˆçš„å­—èŠ‚ç æŒ‡ä»¤</span></span><br><span class="line">      <span class="keyword">synchronized</span>( obj )&#123;</span><br><span class="line">        System.out.println(<span class="string">"1"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//ç¼–å†™äº†ä¸€ä¸ªsynchronizedä¿®é¥°çš„æ–¹æ³•</span></span><br><span class="line">  <span class="comment">//synchronizedä¿®é¥°ä»£ç å—ä¸synchronizedä¿®é¥°æ–¹æ³•åæ±‡ç¼–ä¹‹åçš„ç»“æœæ˜¯ä¸å¤ªä¸€æ ·çš„ï¼›</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"a"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">  <span class="comment">//ä»£ç å†™å¥½ä¹‹åè®©ideaè¿›è¡Œä¸€ä¸ªç¼–è¯‘å¾—åˆ°å­—èŠ‚ç æ–‡ä»¶ï¼›</span></span><br><span class="line">  <span class="comment">//ç¼–è¯‘å¥½çš„å­—èŠ‚ç æ–‡ä»¶ç›®å½•ï¼šå·¥ç¨‹å/target/classes/xxx/demo04_synchronized_monitor/Demo01.class</span></span><br></pre></td></tr></table></figure><p>è¦çœ‹ synchronizedçš„åŸç†ï¼Œä½†æ˜¯ synchronizedæ˜¯ä¸€ä¸ªå…³é”®å­—ï¼Œçœ‹ä¸åˆ°æºç ã€‚<br>å¯ä»¥å°†classæ–‡ä»¶è¿›è¡Œåæ±‡ç¼–ã€‚<br>JDKè‡ªå¸¦çš„ä¸€ä¸ªå·¥å…·: javapï¼Œå¯¹å­—èŠ‚ç è¿›è¡Œåæ±‡ç¼–ï¼ŒæŸ¥çœ‹å­—èŠ‚ç æŒ‡ä»¤ã€‚<br>åœ¨DOSå‘½ä»¤è¡Œæˆ–è€…æ˜¯Windows PowerShellç­‰å…¶ä»–å‘½ä»¤è¡Œè¾“å…¥(å¯¹å­—èŠ‚ç æ–‡ä»¶è¿›è¡Œåæ±‡ç¼–)ï¼š</p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PS C:<span class="symbol">\U</span>sers<span class="symbol">\1</span>3666<span class="symbol">\I</span>deaProjects<span class="symbol">\X</span>xx<span class="symbol">\S</span>ynchronized<span class="symbol">\t</span>arget<span class="symbol">\c</span>lasses<span class="symbol">\c</span>om<span class="symbol">\x</span>xx<span class="symbol">\d</span>emo04_synchronized_monitor<span class="symbol">\j</span>avap -p -v Demo01.class</span><br><span class="line"># -p æ˜¯æ˜¾ç¤ºåŒ…æ‹¬æ‰€æœ‰çš„ç§æœ‰çš„</span><br><span class="line"># -v å°±æ˜¯è¯¦ç»†çš„æ¥è¿›è¡Œæ˜¾ç¤º</span><br></pre></td></tr></table></figure><blockquote><p>åæ±‡ç¼–ä¹‹åå¾—åˆ°çš„å­—èŠ‚ç æŒ‡ä»¤å¦‚ä¸‹æ‰€ç¤ºï¼š</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">      <span class="attr">LineNumberTable:</span></span><br><span class="line">          <span class="attr">line 3:</span> <span class="number">0</span></span><br><span class="line">      <span class="attr">LocalVariableTable:</span></span><br><span class="line">          <span class="string">Start</span>     <span class="string">Length</span>      <span class="string">Slot</span>     <span class="string">Name</span>     <span class="string">Signature</span></span><br><span class="line">              <span class="number">0</span>          <span class="number">5</span>         <span class="number">0</span>     <span class="string">this</span>      <span class="string">Lcom/xxx/demo04_synchronized_monitor/Demo01;</span></span><br><span class="line">  </span><br><span class="line">  <span class="string">public</span> <span class="string">static</span> <span class="string">void</span> <span class="string">main(java.lang.String[]);</span></span><br><span class="line">    <span class="attr">descriptor:</span> <span class="string">([Ljava/lang/String;)V</span></span><br><span class="line">    <span class="attr">flags:</span> <span class="string">ACC_PUBLIC,</span> <span class="string">ACC_STATIC</span></span><br><span class="line">    <span class="attr">Code:</span></span><br><span class="line">      <span class="string">stack=2,</span>  <span class="string">locals=3;</span>   <span class="string">args_size=1</span></span><br><span class="line">          <span class="attr">0:</span> <span class="string">getstatic</span>           <span class="comment">#2        // Field obj:Ljava/lang/Object;</span></span><br><span class="line">          <span class="attr">3:</span> <span class="string">dup</span></span><br><span class="line">          <span class="attr">4:</span> <span class="string">astore_1</span></span><br><span class="line">          <span class="attr">5:</span> <span class="string">monitorenter</span></span><br><span class="line">          <span class="attr">6:</span> <span class="string">getstatic</span>           <span class="comment">#3        // Field java/lang/System.out:Ljava/io/PrintStream;</span></span><br><span class="line">          <span class="attr">9:</span> <span class="string">1dc</span>                 <span class="comment">#4        // String 1</span></span><br><span class="line">         <span class="attr">11:</span> <span class="string">invokevirtual</span>       <span class="comment">#5        // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span></span><br><span class="line">         <span class="attr">14:</span> <span class="string">aload_1</span></span><br><span class="line">         <span class="attr">15:</span> <span class="string">monitorexit</span></span><br><span class="line">         <span class="attr">16:</span> <span class="string">goto</span>                <span class="number">24</span></span><br><span class="line">         <span class="attr">19:</span> <span class="string">astore_2</span></span><br><span class="line">         <span class="attr">20:</span> <span class="string">aload_1</span></span><br><span class="line">         <span class="attr">21:</span> <span class="string">monitorexit</span></span><br><span class="line">         <span class="attr">22:</span> <span class="string">aload_2</span></span><br><span class="line">         <span class="attr">23:</span> <span class="string">athrow</span></span><br><span class="line">         <span class="attr">24:</span> <span class="string">return</span></span><br><span class="line">      <span class="attr">Exception table:</span></span><br><span class="line">          <span class="string">from</span>     <span class="string">to</span>    <span class="string">target</span>   <span class="string">type</span></span><br><span class="line">             <span class="number">6</span>      <span class="number">16</span>       <span class="number">19</span>    <span class="string">any</span></span><br><span class="line">            <span class="number">19</span>      <span class="number">22</span>       <span class="number">19</span>    <span class="string">any</span></span><br><span class="line">      <span class="attr">LineNumberTable:</span></span><br><span class="line">        <span class="attr">line 7:</span> <span class="number">0</span></span><br><span class="line">        <span class="attr">line 8:</span> <span class="number">6</span></span><br><span class="line">        <span class="attr">line 9:</span> <span class="number">14</span></span><br><span class="line">        <span class="attr">line 10:</span> <span class="number">24</span></span><br><span class="line">      <span class="attr">LocalVariableTable:</span></span><br><span class="line">        <span class="string">Start</span>      <span class="string">Length</span>     <span class="string">Slot</span>   <span class="string">Name</span>    <span class="string">Signature</span></span><br><span class="line">            <span class="number">0</span>          <span class="number">25</span>        <span class="number">0</span>   <span class="string">args</span>    <span class="string">[Ljava/lang/String;</span></span><br><span class="line">      <span class="attr">StackMapTable:</span> <span class="string">number_of_entries</span> <span class="string">=</span> <span class="number">2</span></span><br><span class="line">        <span class="string">frame_type</span> <span class="string">=</span> <span class="number">255</span> <span class="string">/*</span> <span class="string">full_frame</span> <span class="string">*/</span></span><br><span class="line">          <span class="string">offset_delta</span> <span class="string">=</span> <span class="number">19</span></span><br><span class="line">          <span class="string">locals</span> <span class="string">=</span> <span class="string">[</span> <span class="string">class</span> <span class="string">"[Ljava/lang/String;"</span><span class="string">,</span> <span class="string">class</span> <span class="string">java/lang/Object</span> <span class="string">]</span></span><br><span class="line">          <span class="string">stack</span> <span class="string">=</span> <span class="string">[</span> <span class="string">class</span> <span class="string">java/lang/Throwable</span> <span class="string">]</span></span><br><span class="line"><span class="string">......</span></span><br></pre></td></tr></table></figure><p>åæ±‡ç¼–åçš„æ•ˆæœå¦‚ä¸‹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">class</span> <span class="string">com.xxx.demo04_synchronized_monitor.Increment</span> <span class="string">implements</span> <span class="string">java.lang.Runnable&#123;</span></span><br><span class="line">  <span class="string">public</span> <span class="string">static</span> <span class="string">int</span> <span class="string">number;</span></span><br><span class="line"></span><br><span class="line">  <span class="string">private</span> <span class="string">static</span> <span class="string">java.lang.Object</span> <span class="string">obj;</span></span><br><span class="line"></span><br><span class="line">  <span class="string">com.xxx.demo04_synchronized_monitor.Increment();</span></span><br><span class="line">    <span class="attr">Code:</span></span><br><span class="line">      <span class="attr">0 :</span> <span class="string">aload_0</span></span><br><span class="line">      <span class="attr">1 :</span> <span class="string">invokespecial</span>   <span class="comment">#1       // Method java/lang/Object."&lt;init&gt;":()v</span></span><br><span class="line">      <span class="attr">4 :</span> <span class="string">return</span></span><br><span class="line"></span><br><span class="line">  <span class="string">public</span> <span class="string">void</span> <span class="string">run();</span></span><br><span class="line">    <span class="attr">Code:</span></span><br><span class="line">      <span class="attr">0 :</span> <span class="string">iconst_0</span></span><br><span class="line">      <span class="attr">1 :</span> <span class="string">istore_1</span></span><br><span class="line">      <span class="attr">2 :</span> <span class="string">iload_1</span></span><br><span class="line">      <span class="attr">3 :</span> <span class="string">sipush</span>    <span class="number">1000</span></span><br><span class="line">      <span class="attr">6 :</span> <span class="string">if_icmpge</span> <span class="number">39</span></span><br><span class="line">      <span class="attr">9 :</span> <span class="string">getstatic</span> <span class="comment">#2           // Field obj:Ljava/lang/Object</span></span><br><span class="line">      <span class="attr">12:</span> <span class="string">dup</span></span><br><span class="line">      <span class="attr">13:</span> <span class="string">astore_2</span></span><br><span class="line">      <span class="attr">14:</span> <span class="string">monitorenter</span></span><br><span class="line">      <span class="attr">15:</span> <span class="string">getstatic</span> <span class="comment">#3           // Field number:I</span></span><br><span class="line">      <span class="attr">18:</span> <span class="string">iconst_1</span></span><br><span class="line">      <span class="attr">19:</span> <span class="string">iadd</span></span><br><span class="line">      <span class="attr">20:</span> <span class="string">putstatic</span> <span class="comment">#3           // Field number:I</span></span><br><span class="line">      <span class="attr">23:</span> <span class="string">aload_2</span></span><br><span class="line">      <span class="attr">24:</span> <span class="string">monitorexit</span></span><br><span class="line">      <span class="attr">25:</span> <span class="string">goto</span>      <span class="number">33</span></span><br><span class="line">      <span class="attr">28:</span> <span class="string">astore_3</span></span><br><span class="line">      <span class="attr">29:</span> <span class="string">aload_2</span></span><br><span class="line">      <span class="attr">30:</span> <span class="string">monitorexit</span></span><br><span class="line">      <span class="attr">31:</span> <span class="string">aload_3</span></span><br><span class="line">      <span class="attr">32:</span> <span class="string">athrow</span></span><br><span class="line">      <span class="attr">33:</span> <span class="string">iinc</span>      <span class="number">1</span><span class="string">,</span>  <span class="number">1</span></span><br><span class="line">      <span class="attr">36:</span> <span class="string">goto</span>      <span class="number">2</span></span><br><span class="line">      <span class="attr">39:</span> <span class="string">return</span></span><br><span class="line">   <span class="attr">Exception table:</span></span><br><span class="line">        <span class="string">from</span>   <span class="string">to</span>  <span class="string">target</span> <span class="string">type</span></span><br><span class="line">          <span class="number">15</span>   <span class="number">25</span>    <span class="number">29</span>    <span class="string">any</span></span><br><span class="line">          <span class="number">28</span>   <span class="number">31</span>    <span class="number">28</span>    <span class="string">any</span></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  <span class="string">public</span> <span class="string">synchronized</span> <span class="string">void</span> <span class="string">test();</span></span><br><span class="line">    <span class="attr">descriptor:</span> <span class="string">()V</span></span><br><span class="line">    <span class="attr">flags:</span> <span class="string">ACC_PUBLIC,</span> <span class="string">ACC_SYNCHRONIZED</span></span><br><span class="line">    <span class="attr">Code:</span></span><br><span class="line">        <span class="string">stack=2,</span>  <span class="string">locals=1,</span>  <span class="string">args_size=1</span></span><br><span class="line">            <span class="attr">0:</span> <span class="string">getstatic</span>     <span class="comment">#4              // Field</span></span><br><span class="line"><span class="attr">java/lang/System.out:Ljava/io/PrintStream:</span></span><br><span class="line">            <span class="attr">3:</span> <span class="string">ldc</span>           <span class="comment">#5              // String a</span></span><br><span class="line">            <span class="attr">5:</span> <span class="string">invokevirtual</span> <span class="comment">#6              // Method java/io/PrintStream.println:(Ljava/lang.String;)V</span></span><br><span class="line">            <span class="attr">8:</span> <span class="string">return</span></span><br><span class="line">        <span class="attr">LineNumberTable:</span></span><br><span class="line">          <span class="attr">line 16:</span> <span class="number">0</span></span><br><span class="line">          <span class="attr">line 17:</span> <span class="number">8</span></span><br><span class="line">        <span class="attr">LocalVariableTable:</span></span><br><span class="line">          <span class="string">Start</span>     <span class="string">Length</span>    <span class="string">Slot</span>  <span class="string">Name</span>  <span class="string">Signature</span></span><br><span class="line">            <span class="number">0</span>          <span class="number">9</span>       <span class="number">0</span>     <span class="string">this</span>   <span class="string">Lcom/xxx/demo04_synchronized_monitor/Increment;</span></span><br><span class="line"></span><br><span class="line">  <span class="string">static</span> <span class="string">&#123;&#125;;</span></span><br><span class="line">    <span class="attr">Code:</span></span><br><span class="line">       <span class="attr">0:</span> <span class="string">iconst_0</span></span><br><span class="line">       <span class="attr">1:</span> <span class="string">putstatic</span>       <span class="comment">#3       // Field number:I</span></span><br><span class="line">       <span class="attr">4:</span> <span class="string">new</span>             <span class="comment">#4       // class java/lang/Object</span></span><br><span class="line">       <span class="attr">7:</span> <span class="string">dup</span></span><br><span class="line">       <span class="attr">8:</span> <span class="string">invokespecial</span>   <span class="comment">#1       // Method java/lang/Object."&lt;init&gt;":()V</span></span><br><span class="line">      <span class="attr">11:</span> <span class="string">putstatic</span>       <span class="comment">#2       // Field obj:Ljava/lang/Object</span></span><br><span class="line">      <span class="attr">14:</span> <span class="string">return</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure><p>ä¸»è¦æ˜¯çœ‹è§‚çœ‹è¿™ä¸€å—çš„å­—èŠ‚ç æŒ‡ä»¤ä¸Demo01.javaå½“ä¸­çš„ä»£ç åšå¯¹æ¯”åˆ†æ:</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">-----------------------------------------------------------------</span><br><span class="line">  <span class="keyword">public</span> static <span class="built_in">void</span> main(java.lang.String[]);</span><br><span class="line">    descriptor: ([Ljava/lang/String;)V</span><br><span class="line">    flags: ACC_PUBLIC, ACC_STATIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">2</span>,  locals=<span class="number">3</span>;   args_size=<span class="number">1</span></span><br><span class="line">          <span class="number">0</span>: getstatic           #<span class="number">2</span>        <span class="comment">// Field obj:Ljava/lang/Object;</span></span><br><span class="line">          <span class="number">3</span>: dup</span><br><span class="line">          <span class="number">4</span>: astore_1</span><br><span class="line">          <span class="number">5</span>: monitorenter</span><br><span class="line">          <span class="number">6</span>: getstatic           #<span class="number">3</span>        <span class="comment">// Field java/lang/System.out:Ljava/io/PrintStream;</span></span><br><span class="line">          <span class="number">9</span>: <span class="number">1</span>dc                 #<span class="number">4</span>        <span class="comment">// String 1</span></span><br><span class="line">         <span class="number">11</span>: invokevirtual       #<span class="number">5</span>        <span class="comment">// Method java/io/PrintStream.println:(Ljava/lang/String;)V</span></span><br><span class="line">         <span class="number">14</span>: aload_1</span><br><span class="line">         <span class="number">15</span>: monitorexit</span><br><span class="line">         <span class="number">16</span>: goto                <span class="number">24</span></span><br><span class="line">         <span class="number">19</span>: astore_2</span><br><span class="line">         <span class="number">20</span>: aload_1</span><br><span class="line">         <span class="number">21</span>: monitorexit</span><br><span class="line">         <span class="number">22</span>: aload_2</span><br><span class="line">         <span class="number">23</span>: athrow</span><br><span class="line">         <span class="number">24</span>: <span class="keyword">return</span></span><br><span class="line">      Exception table:</span><br><span class="line">          <span class="keyword">from</span>     to    target   type</span><br><span class="line">             <span class="number">6</span>      <span class="number">16</span>       <span class="number">19</span>    any</span><br><span class="line">            <span class="number">19</span>      <span class="number">22</span>       <span class="number">19</span>    any</span><br><span class="line">-----------------------------------------------------------------</span><br><span class="line">é¦–å…ˆ<span class="number">0</span>: getstatic ä»£è¡¨çš„æ˜¯è·å–å¾—åˆ°é™æ€çš„æˆå‘˜å˜é‡Object objçš„å€¼ï¼›</span><br><span class="line">å³<span class="keyword">private</span> static Object obj = new Object();</span><br><span class="line"></span><br><span class="line">åŒæ­¥ä»£ç å—å¼€å§‹çš„åœ°æ–¹å³synchronized(obj)&#123; å¯¹åº”äºå­—èŠ‚ç æŒ‡ä»¤å½“ä¸­çš„<span class="number">5</span>: monitorenteræŒ‡ä»¤ï¼›</span><br><span class="line">é‚£ä¹ˆæ¥ç€å¾€ä¸‹å­—èŠ‚ç æŒ‡ä»¤å½“ä¸­çš„<span class="number">6</span>: getstatic å…¶å®å¯¹åº”ç€javaä»£ç å±‚ä¸­çš„System.<span class="keyword">out</span>.println(<span class="string">"1"</span>);è¯¥å¥ä¸­çš„<span class="keyword">out</span>å˜é‡ï¼›åˆ°æ—¶å€™è¿›è¡Œæ‰§è¡Œå…¶å®æ˜¯è¿›è¡Œæ‰§è¡Œçš„println()æ–¹æ³•ï¼›</span><br><span class="line">é‚£ä¹ˆç»“æŸçš„æ—¶å€™å°±éœ€è¦æ³¨æ„äº†ï¼ŒåŒæ­¥ä»£ç å—synchronizedç»“æŸçš„åœ°æ–¹ä¹Ÿå°±æ˜¯synchronized(obj)&#123; çš„è¿”å›èŠ±æ‹¬å·&#125;å¤„ï¼Œå³å¯¹åº”ç€å­—èŠ‚ç æŒ‡ä»¤å½“ä¸­çš„<span class="number">15</span>: monitorexit</span><br><span class="line">é‚£ä¹ˆå­—èŠ‚ç æŒ‡ä»¤monitorenterä¸monitorexitè¿™ä¸¤ä¸ªå­—èŠ‚ç æŒ‡ä»¤åˆ†åˆ«æœ‰ä»€ä¹ˆå«ä¹‰å‘¢ï¼Ÿ</span><br></pre></td></tr></table></figure><h3 id="monitorenter"><a href="#monitorenter" class="headerlink" title="monitorenter"></a>monitorenter</h3><p>é¦–å…ˆæ¥çœ‹ä¸€ä¸‹JVMè§„èŒƒä¸­å¯¹äº monitorenter å’Œ monitorexit çš„æè¿°ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//</span>docs.oracle.com<span class="regexp">/javase/</span>specs<span class="regexp">/jvms/</span>se8<span class="regexp">/html/</span>jvms-<span class="number">6</span>.html<span class="comment">#jvms-6.5.monitorenter</span></span><br><span class="line"></span><br><span class="line">https:<span class="regexp">//</span>docs.oracle.com<span class="regexp">/javase/</span>specs<span class="regexp">/jvms/</span>se8<span class="regexp">/html/i</span>ndex.html</span><br></pre></td></tr></table></figure><p>ï¼ˆOracleå®˜æ–¹ javaè™šæ‹Ÿæœºè§„èŒƒæ–‡æ¡£ï¼›Javaè™šæ‹Ÿæœºæœ‰å¥½å¤šç§Oracleå…¬å¸æœ‰ï¼ŒIBMå…¬å¸ä¹Ÿæœ‰ï¼Œæ·˜å®ä¹Ÿæœ‰ï¼›javaè™šæ‹Ÿæœºæ˜¯ä¸€å¥—è§„èŒƒï¼›è¯¥æ–‡æ¡£æŒ‡çš„å°±æ˜¯javaè™šæ‹Ÿæœºçš„è§„èŒƒï¼‰  </p><blockquote><p>Each object is associlated with a monitor.<br>A monitor is locked if and only if it has an owner.<br>The thread that executes monitorenter attempts to gain ownership of the monitor associated with objectref, as follows:</p></blockquote><ul><li>If the entry count of the monitor associated with objectref is zero,<br>the thread enters the monitor and sets its entry count to one.<br>The thread is then the owner of the monitor.</li><li>If the thread already owns the monitor associated with objectref,<br>it reenters the monitor, incrementing its entry count.</li><li>If another thread already owns the monitor associated with objectref,<br>the thread blocks until the monitorâ€™s entry count is zero,<br>then tries again to gain ownership.</li></ul><p>ç¿»è¯‘è¿‡æ¥ï¼š<br>  æ¯ä¸€ä¸ªå¯¹è±¡ éƒ½ä¼šå’Œ ä¸€ä¸ªç›‘è§†å™¨monitorå…³è”ã€‚<br>  ç›‘è§†å™¨è¢«å ç”¨æ—¶ä¼šè¢«é”ä½ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•æ¥è·å–è¯¥monitorã€‚<br>  ï¼ˆå…¶å®å¯ä»¥ç†è§£ä¸ºè¿™ä¸ªmonitoræ‰æ˜¯çœŸæ­£çš„é”ï¼‰<br>  å½“JVMæ‰§è¡ŒæŸä¸ªçº¿ç¨‹çš„æŸä¸ªæ–¹æ³•å†…éƒ¨çš„monitorenteræ—¶ï¼Œå®ƒä¼šå°è¯•å»è·å–å½“å‰å¯¹è±¡å¯¹åº”çš„monitorçš„æ‰€æœ‰æƒã€‚<br>  ï¼ˆå³å°è¯•å»è·å–è¿™æŠŠé”ï¼›æœ‰å¯èƒ½è·å–å¾—åˆ°æœ‰å¯èƒ½è·å–ä¸åˆ°ï¼‰<br>  å…¶è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ol><li>è‹¥monitorçš„è¿›å…¥æ•°ä¸º0ï¼Œçº¿ç¨‹å¯ä»¥è¿›å…¥ monitorï¼Œå¹¶å°† monitorçš„è¿›å…¥æ•° ç½®ä¸º1ã€‚ å½“å‰çº¿ç¨‹æˆä¸º monitorçš„ ownerï¼ˆæ‰€æœ‰è€…ï¼‰ã€‚</li><li>è‹¥çº¿ç¨‹å·²æ‹¥æœ‰ monitorçš„æ‰€æœ‰æƒï¼Œå…è®¸å®ƒ é‡å…¥ monitorï¼Œåˆ™è¿›å…¥monitorçš„è¿›å…¥æ•°åŠ 1ã€‚</li><li>è‹¥å…¶ä»–çº¿ç¨‹å·²ç»å æœ‰monitorçš„æ‰€æœ‰æƒï¼Œé‚£ä¹ˆå½“å‰å°è¯•è·å–monitorçš„æ‰€æœ‰æƒçš„çº¿ç¨‹ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°monitorçš„è¿›å…¥æ•°å˜ä¸º0ï¼Œæ‰èƒ½é‡æ–°å°è¯•è·å–monitorçš„æ‰€æœ‰æƒã€‚</li></ol><p>monitorenterçº¿ç¨‹è·å–é”ï¼Œå®è¿›å…¥åŒæ­¥ä»£ç å—ã€‚<br>åŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è·å–é”ã€‚<br>monitorenter æ’å…¥åœ¨åŒæ­¥ä»£ç å—çš„å¼€å§‹ä½ç½®ï¼Œå½“åº•ä»£ç æ‰§è¡Œåˆ°è¯¥æŒ‡ä»¤æ—¶ï¼Œå°†ä¼šå°è¯•è·å–è¯¥å¯¹è±¡monitorçš„æ‰€æœ‰æƒï¼Œå³å°è¯•è·å¾—è¯¥å¯¹è±¡çš„é”ã€‚</p><blockquote><p>monitorenteræµç¨‹åˆ†æ</p></blockquote><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">åˆ†æ<span class="keyword">monitor</span>æµç¨‹ç”»å›¾è¯´æ˜ï¼š</span><br><span class="line">é€šè¿‡åˆšæ‰çš„æè¿°å¯ä»¥çŸ¥é“synchronizedæ˜¯éœ€è¦ä¼ ä¸€ä¸ªå¯¹è±¡è¿›æ¥ä¹Ÿå°±æ˜¯å¯¹è±¡é”ï¼›</span><br><span class="line">å³synchronized(obj)&#123;ï¼›</span><br><span class="line">è€ŒçœŸæ­£çš„é”å¹¶éæ˜¯è¿™ä¸ªä¼ å…¥è¿›æ¥çš„è¯¥å¯¹è±¡objï¼›</span><br><span class="line">è€Œæ˜¯è¯¥å¯¹è±¡objä¼šå»å…³è”ä¸€ä¸ªå«åš<span class="keyword">monitor</span>çš„ä¸œè¥¿ï¼Œè€Œè¿™ä¸ªå«åš<span class="keyword">monitor</span>çš„ä¸œè¥¿æ‰æ˜¯çœŸæ­£çš„é”ï¼›</span><br><span class="line">è€Œè¿™ä¸ªå¯¹è±¡<span class="keyword">monitor</span>å¹¶éæ˜¯æ‰‹åŠ¨å¼ä½¿ç”¨ä»£ç è¿›è¡Œåˆ›å»ºçš„ï¼›</span><br><span class="line">å½“æ‹¿åˆ°ä¸€ä¸ªå¯¹è±¡æ”¾åˆ°åŒæ­¥ä»£ç å—çš„å‚æ•°å½“ä¸­æ¥ï¼›</span><br><span class="line">å³synchronized(obj)&#123;ä¸­æ¥çš„æ—¶å€™ï¼ŒJVMä¼šå»è¿›è¡Œæ£€æŸ¥è¯¥å¯¹è±¡objæ˜¯å¦æœ‰è¿›è¡Œå…³è”<span class="keyword">monitor</span>å¯¹è±¡ï¼›</span><br><span class="line">å¦‚æœJVMè¿›è¡Œæ£€æµ‹å¾—åˆ°è¯¥å¯¹è±¡objæ²¡æœ‰è¿›è¡Œå…³è”<span class="keyword">monitor</span>å¯¹è±¡çš„è¯é‚£ä¹ˆå°±ä¼šå»åˆ›å»ºä¸€ä¸ªä¸ä¹‹å…³è”çš„<span class="keyword">monitor</span>å¯¹è±¡ï¼›</span><br><span class="line">è€Œä¸”è¯¥<span class="keyword">monitor</span>å¯¹è±¡è¿˜éœ€è¦è¿›è¡Œæ³¨æ„çš„æ˜¯<span class="keyword">monitor</span>å¹¶ä¸æ˜¯ä¸€ä¸ªjavaå¯¹è±¡ï¼›</span><br><span class="line"><span class="keyword">monitor</span>è€Œæ˜¯ä¸€ä¸ªC++å¯¹è±¡ï¼›</span><br><span class="line">åœ¨<span class="keyword">monitor</span>å¯¹è±¡å½“ä¸­åˆè¿™ä¹ˆå‡ ä¸ªå†…å®¹æ˜¯éœ€è¦æ³¨æ„çš„ï¼›</span><br><span class="line"><span class="keyword">monitor</span>å½“ä¸­æœ‰ä¸¤ä¸ªæ¯”è¾ƒé‡è¦çš„æˆå‘˜å˜é‡ï¼›</span><br><span class="line">ä¸€ä¸ªæ˜¯ownerï¼šæŒ‡çš„æ˜¯ç”¨æœ‰é”çš„çº¿ç¨‹ï¼›</span><br><span class="line">å¦ä¸€ä¸ªæ˜¯recursions:æŒ‡çš„æ˜¯è®°å½•è·å–é”çš„æ¬¡æ•°ï¼›</span><br><span class="line">å½“JVMæ‰§è¡Œåˆ°monitorenterçš„æ—¶å€™ï¼›é‚£ä¹ˆä¼šæ‰¾åˆ°è¯¥å¯¹è±¡Object objä¸Šçš„<span class="keyword">monitor</span>å¯¹è±¡çœ‹è¿™ä¸ªObject objæ‰€å…³è”çš„<span class="keyword">monitor</span>é”å¯¹è±¡æ˜¯å¦è¢«åˆ«çš„çº¿ç¨‹æ‰€æ‹¿èµ°äº†ï¼›å¦‚æœåˆ«çš„çº¿ç¨‹æ²¡æœ‰æ‹¿èµ°å³æ²¡æœ‰ç«äº‰èµ°ï¼›é‚£ä¹ˆå½“å‰è¯¥çº¿ç¨‹å°±æ¥è·å–è¯¥<span class="keyword">monitor</span>é”å¯¹è±¡ï¼›</span><br><span class="line">é¦–å…ˆå…ˆä¼šå°†<span class="keyword">monitor</span>é”å¯¹è±¡ä¸­çš„æˆå‘˜å˜é‡ownerå˜æˆå½“å‰çº¿ç¨‹ï¼›</span><br><span class="line">ç°åœ¨å‡è®¾t1çº¿ç¨‹æ¥æ‰§è¡Œåˆ°åŒæ­¥ä»£ç å—synchronized(obj)&#123;ï¼›</span><br><span class="line">é‚£ä¹ˆå½“t1çº¿ç¨‹æ¥æ‰§è¡ŒåŒæ­¥ä»£ç å—çš„æ—¶å€™å°±ä¼šæ‰¾åˆ°è¯¥Object objå¯¹è±¡æ‰€å…³è”çš„<span class="keyword">monitor</span>å¯¹è±¡ï¼›çœ‹è¿™ä¸ªæ‰€å…³è”çš„<span class="keyword">monitor</span>æœ‰æ²¡æœ‰è¢«å…¶ä»–çš„é”ç»™è·å–å¾—åˆ°ï¼›</span><br><span class="line">å¦‚ä½•æŸ¥çœ‹è¯¥<span class="keyword">monitor</span>æ˜¯å¦æœ‰è¢«å…¶ä»–çº¿ç¨‹è·å–å¾—åˆ°ï¼Ÿ</span><br><span class="line">å¦‚æœåˆ«çš„çº¿ç¨‹æ²¡æœ‰ç«äº‰å¾—åˆ°è¯¥<span class="keyword">monitor</span>é”å¯¹è±¡ï¼Œé‚£ä¹ˆè¯¥é”å¯¹è±¡<span class="keyword">monitor</span>çš„owneræˆå‘˜å˜é‡å±æ€§å°±ä¼šå˜æˆå½“å‰çº¿ç¨‹t1ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™ä¹Ÿæ˜¯t1çº¿ç¨‹ç¬¬ä¸€æ¬¡è¿›å…¥åŒæ­¥ä»£ç å—å½“ä¸­æ¥ï¼›</span><br><span class="line">æ‰€ä»¥<span class="keyword">monitor</span>å…¶æˆå‘˜å˜é‡recursionsï¼ˆè®°å½•è·å–é”çš„æ¬¡æ•°ï¼Œè®¡æ•°å™¨ï¼‰ä¹Ÿä¼šè¿›è¡Œæ”¹å˜å–å€¼è¿›è¡Œ++æ“ä½œï¼›å³å½“å‰ç”±<span class="number">0</span>å˜ä¸º<span class="number">1</span>ï¼›</span><br><span class="line">æ¥ç€t1çº¿ç¨‹å°±æ‹¥æœ‰äº†è¿™æŠŠé”ï¼Œå³Object objæ‰€å…³è”çš„é”å¯¹è±¡<span class="keyword">monitor</span>ä»è€Œè¿›å…¥äº†åŒæ­¥ä»£ç å—synchronized(obj)&#123;&#125;å½“ä¸­ï¼›</span><br><span class="line">åœ¨t1è¿›å…¥åˆ°åŒæ­¥ä»£ç å—ä¸­æ—¶å¦‚æœåŒæ­¥ä»£ç å—å½“ä¸­ä¾ç„¶å­˜åœ¨æœ‰åŒæ­¥ä»£ç å—ï¼Œå³åµŒå¥—çš„åŒæ­¥ä»£ç å—æ—¶å¹¶ä¸”é”å¯¹è±¡ä¾ç„¶è¿˜æ˜¯Object objçš„è¯åˆ™ï¼›synchronizedå…·æœ‰å¯é‡å…¥ç‰¹æ€§ï¼›é‚£ä¹ˆè¿™ä¸ªæ—¶å€™t1çº¿ç¨‹å°±ä¼šé‡å…¥åˆ°åµŒå¥—åŒæ­¥ä»£ç å—ä¸­å»ï¼›é‡å…¥çš„è¯å°±ä¼šå°†Object objæ‰€å…³è”çš„<span class="keyword">monitor</span>é”å¯¹è±¡çš„æˆå‘˜å˜é‡å±æ€§å–å€¼recursionsè®¡æ•°å™¨çš„å–å€¼è¿›è¡Œ++æ“ä½œï¼›å³ç”±æ¬¡æ•°<span class="number">1</span>å˜ä¸ºæ¬¡æ•°<span class="number">2</span>ï¼›é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´å‡ºä¸€æ¬¡åŒæ­¥ä»£ç å—è®¡æ•°å™¨recursionsè¿›è¡Œ--æ“ä½œå³æ¬¡æ•°å‡ä¸€æ“ä½œï¼Œç”±<span class="number">2</span>å˜ä¸º<span class="number">1</span>ï¼›è¿™ç§ç±»ä¼¼ï¼›</span><br><span class="line">å¦å¤–å½“t1çº¿ç¨‹è¿›å…¥åŒæ­¥ä»£ç å—æ—¶ï¼Œå¹¶æ‰§è¡Œåˆ°è¾“å‡ºæ‰“å°è¯­å¥â€œ<span class="number">1</span>â€æ—¶ï¼›</span><br><span class="line">æ­¤æ—¶<span class="meta">CPU</span>åˆ‡æ¢åˆ°äº†t2çº¿ç¨‹ä¸Šï¼›é‚£ä¹ˆt2çº¿ç¨‹åŒæ—¶ä¼šæ¥è¿›è¡Œæ‰§è¡ŒRunnableå½“ä¸­æ‰€å®ç°çš„run()æ–¹æ³•å†…å®¹ï¼›</span><br><span class="line">é‚£ä¹ˆt2çº¿ç¨‹ä¹Ÿä¼šæ¥è¿›è¡Œç«äº‰è·å–å¾—åˆ°è¿™æŠŠé”ï¼›å³Object objæ‰€å…³è”çš„é”å¯¹è±¡<span class="keyword">monitor</span>ï¼›</span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶ç”±äºçº¿ç¨‹t1å¹¶æ²¡æœ‰è¿›è¡Œé‡Šæ”¾é”æ“ä½œï¼Œ<span class="meta">CPU</span>å°±å¼€å§‹è¿›è¡Œåˆ‡æ¢åˆ°äº†çº¿ç¨‹t2ä¸Šæ¥äº†ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™ä¸ªæ—¶å€™t2çº¿ç¨‹å°±ä¼šå‘ç°Object objæ‰€å…³è”çš„<span class="keyword">monitor</span>é”å¯¹è±¡å½“ä¸­çš„æˆå‘˜å˜é‡å±æ€§å–å€¼ä¸ºå¹¶ä¸æ˜¯å½“å‰çº¿ç¨‹t2è€Œæ˜¯çº¿ç¨‹t1ï¼›</span><br><span class="line">é‚£ä¹ˆé€šè¿‡è¿™ä¸ªè§‚å¯Ÿä¹Ÿå°±çŸ¥é“å½“å‰è·å–é”çš„çº¿ç¨‹æ˜¯å“ªä¸€ä¸ªçº¿ç¨‹äº†ï¼›</span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶t2çº¿ç¨‹å°±ä¼šè¿›å…¥é˜»å¡çŠ¶æ€ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™ä¸ªå°±æ˜¯monitorenterçš„åŸç†ï¼›</span><br></pre></td></tr></table></figure><h4 id="monitorenterå°ç»“"><a href="#monitorenterå°ç»“" class="headerlink" title="monitorenterå°ç»“"></a>monitorenterå°ç»“</h4><p>synchronizedçš„é”å¯¹è±¡ä¼šå…³è”ä¸€ä¸ªmonitorï¼Œ<br>è¿™ä¸ªmonitorä¸æ˜¯ä¸»åŠ¨è¿›è¡Œåˆ›å»ºçš„ï¼Œ<br>è€Œæ˜¯JVMçš„çº¿ç¨‹æ‰§è¡Œåˆ°è¿™ä¸ªåŒæ­¥ä»£ç å—æ—¶ï¼Œ<br>ä¼šæ£€æŸ¥å‘ç°åˆ°å¯¹è±¡æ²¡æœ‰monitorï¼Œé‚£ä¹ˆæ­¤æ—¶å°±ä¼šåˆ›å»ºmonitorï¼›<br>monitorå†…éƒ¨æœ‰ä¸¤ä¸ªé‡è¦çš„æˆå‘˜å˜é‡ï¼›<br>owner: æ‹¥æœ‰è¿™æŠŠé”çš„çº¿ç¨‹ï¼›<br>recursions: ä¼šè®°å½•çº¿ç¨‹æ‹¥æœ‰é”çš„æ¬¡æ•°ï¼›<br>å½“ä¸€ä¸ªçº¿ç¨‹æ‹¥æœ‰monitorä¹‹åå…¶ä»–çš„çº¿ç¨‹åªèƒ½å¤Ÿè¿›è¡Œç­‰å¾…ï¼›</p><h3 id="monitorexit"><a href="#monitorexit" class="headerlink" title="monitorexit"></a>monitorexit</h3><p>é¦–å…ˆæ¥çœ‹ä¸€ä¸‹ JVMè§„èŒƒ ä¸­å¯¹äº monitorenterå’Œmonitorexitçš„æè¿°ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//</span>docs.oracle.com<span class="regexp">/javase/</span>specs<span class="regexp">/jvms/</span>se8<span class="regexp">/html/</span>jvms-<span class="number">6</span>.html<span class="comment">#jvms-6.5.monitorexit</span></span><br></pre></td></tr></table></figure><blockquote><p>The thread that executes monitorexit must be the owner of the monitor associated with the instance referenced ny objectref.<br>  The thread decrements the entry count of the monitor associated with objectref.<br>  iIf as a result the value of the entry count is zero , the thread exits the monitor and is no longer its owner.<br>  Other threads that are blocking to enter the monitor are allowed to attempt to do so.</p></blockquote><p>ç¿»è¯‘è¿‡æ¥ï¼š</p><ol><li>èƒ½æ‰§è¡Œ monitorexit æŒ‡ä»¤çš„çº¿ç¨‹ ä¸€å®šæ˜¯ æ‹¥æœ‰å½“å‰å¯¹è±¡çš„ monitorçš„æ‰€æœ‰æƒçš„çº¿ç¨‹ã€‚</li><li>æ‰§è¡Œ monitorexitæ—¶ ä¼šå°† monitorçš„è¿›å…¥æ•°å‡1ã€‚ å½“monitorçš„è¿›å…¥æ•°å‡ä¸º0æ—¶ï¼Œå½“å‰çº¿ç¨‹é€€å‡ºmonitorï¼Œä¸å†æ‹¥æœ‰monitorçš„æ‰€æœ‰æƒï¼Œæ­¤æ—¶å…¶ä»–è¢«è¿™ä¸ªmonitoré˜»å¡çš„çº¿ç¨‹å¯ä»¥å°è¯•å»è·å–è¿™ä¸ªmonitorçš„æ‰€æœ‰æƒã€‚</li></ol><p>monitorexitï¼šé‡Šæ”¾é”ï¼›<br>monitorexitæ’å…¥åœ¨æ–¹æ³•ç»“æŸå¤„å’Œå¼‚å¸¸å¤„ï¼›<br>JVMä¿è¯æ¯ä¸ª monitorenterå¿…é¡»æœ‰å¯¹åº”çš„monitorexitï¼›</p><blockquote><p>monitorexitæµç¨‹åˆ†æ</p></blockquote><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">å‡è®¾çº¿ç¨‹t1è·å–æ‹¿åˆ°Object objæ‰€å…³è”çš„å¯¹è±¡é”monitorä¹‹åä»è€Œè¿›å…¥åˆ°åŒæ­¥ä»£ç å—å½“ä¸­èµ°åˆ°è¦ç»“æŸåŒæ­¥ä»£ç å—çš„ä½ç½®ï¼Œå³synchronized(obj)&#123;æ‰€å¯¹åº”è¿”å›&#125;èŠ±æ‹¬å·çš„ä½ç½®å¤„ï¼Œå³å°†è¦é‡Šæ”¾é”çš„ä½ç½®ï¼›</span><br><span class="line">t1çº¿ç¨‹æ‰§è¡Œå®ŒåŒæ­¥ä»£ç å—ä¹‹åå°±ä¼šæ‰§è¡Œå­—èŠ‚ç æŒ‡ä»¤15: monitorexit æŒ‡ä»¤ï¼›</span><br><span class="line">é‡åˆ°è¿™ä¸ªæŒ‡ä»¤ä¹‹åï¼Œå°±ä¼šå»æ‰¾åˆ°è¿™ä¸ªé”å¯¹è±¡Object objçœŸæ­£çš„é”å¯¹è±¡monitorï¼›</span><br><span class="line">æ‰¾åˆ°ä¹‹åä¼šè¿›è¡Œå¯¹monitorçš„æˆå‘˜å˜é‡çš„å±æ€§å–å€¼ownerä»¥åŠrecursionsè¿›è¡Œæ›´æ”¹èµ‹å€¼ï¼›</span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶çº¿ç¨‹t1ä»ç„¶åœ¨æ‹¥æœ‰ç€è¿™æŠŠé”ï¼›æ‰€ä»¥æ­¤æ—¶monitorçš„ownerä¾ç„¶æ˜¯å½“å‰çº¿ç¨‹t1ï¼Œä¸éœ€è¦æ”¹å˜ï¼›</span><br><span class="line">è€Œçº¿ç¨‹t2å³å°†è¦å‡ºåŒæ­¥ä»£ç å—ï¼Œåˆ™recursionsè®¡æ•°å™¨å°±éœ€è¦è¿›è¡Œå‡ä¸€æ“ä½œï¼›å³èµ‹å€¼ä¸º0ï¼Œç”±1å˜ä¸º0ï¼›</span><br><span class="line">å½“monitoré”å¯¹è±¡çš„æˆå‘˜å˜é‡recursionsè®¡æ•°å™¨å–å€¼å˜ä¸º0æ—¶ä¹Ÿå°±ä»£è¡¨ç€å½“å‰çº¿ç¨‹t1é‡Šæ”¾äº†å½“å‰å…¶æ‰€æ‹¥æœ‰çš„è¿™ä¸€æŠŠé”ï¼›</span><br><span class="line">é‚£ä¹ˆåŒæ—¶monitoré”å¯¹è±¡çš„æˆå‘˜å˜é‡ownerå±æ€§å–å€¼å³é”çš„æ‹¥æœ‰è€…ä¹Ÿä¸å­˜åœ¨äº†ï¼›</span><br><span class="line"></span><br><span class="line">å¦å¤–è¿˜éœ€è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼›</span><br><span class="line">è¿›å…¥åŒæ­¥ä»£ç å—æ—¶ï¼šsynchronized(obj)&#123; ------â†’ å­—èŠ‚ç æŒ‡ä»¤5: monitorenter</span><br><span class="line">å‡ºåŒæ­¥ä»£ç å—æ—¶ï¼š&#125;  ------â†’ å­—èŠ‚ç æŒ‡ä»¤15: monitorexit</span><br><span class="line">é™¤äº†è¿™ä¸¤å¤„åœ°æ–¹å­˜åœ¨æœ‰monitorç›¸å…³çš„æŒ‡ä»¤ä¹‹å¤–å…¶ä½™çš„åœ°æ–¹ä¹Ÿå­˜åœ¨æœ‰monitorç›¸å…³å­—èŠ‚ç æŒ‡ä»¤æ“ä½œï¼›</span><br><span class="line">å³ 21: monitorexitï¼ˆä¸ºä»€ä¹ˆæ­¤å¤„ä¹Ÿå­˜åœ¨æœ‰monitorç›¸å…³å­—èŠ‚ç æŒ‡ä»¤æ“ä½œå‘¢ï¼Ÿï¼‰</span><br><span class="line"></span><br><span class="line">å­—èŠ‚ç æŒ‡ä»¤æœ€ä¸‹é¢çš„Exception tableç§°ä½œä¸ºå¼‚å¸¸è¡¨ï¼›å³ï¼š</span><br><span class="line">-----------------------------------------------------------</span><br><span class="line"><span class="code">      Exception table:</span></span><br><span class="line"><span class="code">          from     to    target   type</span></span><br><span class="line"><span class="code">             6      16       19    any</span></span><br><span class="line"><span class="code">            19      22       19    any</span></span><br><span class="line">-----------------------------------------------------------</span><br><span class="line">from ... to : æŒ‡çš„æ˜¯ä»å“ªä¸€è¡Œåˆ°å“ªä¸€è¡Œï¼›å³æŒ‡çš„æ˜¯6~16è¡Œæˆ–è€…19~22è¡Œä¹‹é—´çš„å­—èŠ‚ç æŒ‡ä»¤ï¼›</span><br><span class="line">-----------------------------------------------------------</span><br><span class="line"><span class="code">          6: getstatic           #3        // Field java/lang/System.out:Ljava/io/PrintStream;</span></span><br><span class="line"><span class="code">          9: 1dc                 #4        // String 1</span></span><br><span class="line"><span class="code">         11: invokevirtual       #5        // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span></span><br><span class="line"><span class="code">         14: aload_1</span></span><br><span class="line"><span class="code">         15: monitorexit</span></span><br><span class="line"><span class="code">         16: goto                24</span></span><br><span class="line">-----------------------------------------------------------</span><br><span class="line">ä¹Ÿå°±æ˜¯æ‰€å¯¹åº”åœ¨javaä»£ç å½“ä¸­çš„ï¼š</span><br><span class="line">-----------------------------------------------------------</span><br><span class="line">synchronized(obj)&#123;</span><br><span class="line"><span class="code">  System.out.println("1");</span></span><br><span class="line">&#125;</span><br><span class="line">-----------------------------------------------------------</span><br><span class="line">ä¹Ÿå°±æ„å‘³ç€å¦‚æœåŒæ­¥ä»£ç å—å½“ä¸­çš„ä»£ç å½“ä¸­å‡ºç°äº†å¼‚å¸¸ï¼›</span><br><span class="line">é‚£ä¹ˆä¹Ÿå°±æ˜¯æŒ‡çš„å­—èŠ‚ç æŒ‡ä»¤6~16è¡Œå‡ºç°äº†å¼‚å¸¸åˆ™targetä¸º19ï¼›</span><br><span class="line">é‚£ä¹ˆä¹Ÿå°±ä¼šèµ°å­—èŠ‚ç æŒ‡ä»¤ç¼–å·ä¸º19çš„å­—èŠ‚ç æŒ‡ä»¤ä»£ç ï¼šå³19: astore<span class="emphasis">_2</span></span><br><span class="line"><span class="emphasis">é‚£ä¹ˆæ‰§è¡Œå®Œå­—èŠ‚ç æŒ‡ä»¤19ä¹‹åç»§ç»­å‘ä¸‹æ‰§è¡Œå­—èŠ‚ç æŒ‡ä»¤20: aload_</span>1ã€21: monitorexitï¼›</span><br><span class="line">ä¹Ÿå°±è¯´æ˜äº†å…¶æœ€ç»ˆä¹Ÿä¼šå»è¿›è¡Œé‡Šæ”¾é”ï¼›</span><br><span class="line">è¿™ä¹Ÿå°±æ˜¯åœ¨å‘ŠçŸ¥ï¼šå¦‚æœåœ¨åŒæ­¥ä»£ç å—å½“ä¸­å‡ºç°äº†å¼‚å¸¸ï¼›monitorä¼šè‡ªåŠ¨å¸®åŠ©é‡Šæ”¾é”å³monitorexitå­—èŠ‚ç æŒ‡ä»¤ï¼›</span><br></pre></td></tr></table></figure><p><strong>é¢è¯•é¢˜</strong>ï¼šsynchronizedå‡ºç°å¼‚å¸¸ä¼šé‡Šæ”¾é”å—ï¼Ÿ</p><p>ç­”ï¼šä¼šé‡Šæ”¾é”ï¼›</p><h3 id="åŒæ­¥æ–¹æ³•"><a href="#åŒæ­¥æ–¹æ³•" class="headerlink" title="åŒæ­¥æ–¹æ³•"></a>åŒæ­¥æ–¹æ³•</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//</span>docs.oracle.com<span class="regexp">/javase/</span>specs<span class="regexp">/jvms/</span>se8<span class="regexp">/html/</span>jvms-<span class="number">2</span>.html<span class="comment">#jvms-2.11.10</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° åŒæ­¥æ–¹æ³• åœ¨åæ±‡ç¼–ä¹‹åï¼Œ<br>ä¼šå¢åŠ <code>ACC_SYNCHRONIZED</code>ä¿®é¥°ã€‚<br>ä¼šéšå¼åœ°è°ƒç”¨ monitorenterå’Œmonitorexitã€‚<br>åœ¨æ‰§è¡Œ åŒæ­¥æ–¹æ³• ä¹‹å‰ä¼šè°ƒç”¨monitorenterï¼Œåœ¨æ‰§è¡Œå®ŒåŒæ­¥æ–¹æ³•åä¼šè°ƒç”¨monitorexitï¼›</p><blockquote><p>æŸ¥çœ‹åæ±‡ç¼–ä¹‹åçš„å­—èŠ‚ç æŒ‡ä»¤-åŒæ­¥æ–¹æ³•</p></blockquote><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">----------------------------------------------------------------------</span><br><span class="line"><span class="keyword">public</span> synchronized <span class="built_in">void</span> test();</span><br><span class="line">  descriptor: ()V</span><br><span class="line">  flags: ACC_PUBLIC, ACC_SYNCHRONIZED</span><br><span class="line">  Code:</span><br><span class="line">    stack=<span class="number">2</span>,    locals=<span class="number">1</span>,     args_size=<span class="number">1</span></span><br><span class="line">        <span class="number">0</span>: getstatic         #<span class="number">3</span>        <span class="comment">// Field java/lang/System.out:Ljava/io/PrintStream;</span></span><br><span class="line">        <span class="number">3</span>: <span class="number">1</span>dc               #<span class="number">6</span>        <span class="comment">// String a</span></span><br><span class="line">        <span class="number">5</span>: invokevirtual     #<span class="number">5</span>        <span class="comment">// Method java/io/PrintStream.println(Ljava/lang/String;)V</span></span><br><span class="line">    LineNUmberTable:</span><br><span class="line">      line <span class="number">13</span>: <span class="number">0</span></span><br><span class="line">      line <span class="number">14</span>: <span class="number">0</span></span><br><span class="line">    LocalVariableTalbe:</span><br><span class="line">      Start       Length       Slot     Name     Signature</span><br><span class="line">          <span class="number">0</span>            <span class="number">9</span>          <span class="number">0</span>     <span class="keyword">this</span>     Lcom/xxx/demo04_synchronized_monitor/Demo01;</span><br><span class="line">......</span><br><span class="line">----------------------------------------------------------------------</span><br><span class="line">å¯¹åº”çš„ä»£ç ï¼š</span><br><span class="line"><span class="keyword">public</span> synchronized <span class="built_in">void</span> test()&#123;</span><br><span class="line">  System.<span class="keyword">out</span>.println(<span class="string">"a"</span>);</span><br><span class="line">&#125;</span><br><span class="line">----------------------------------------------------------------------</span><br><span class="line">åŒæ­¥æ–¹æ³•test()å†…éƒ¨å¹¶æ²¡æœ‰å½¢æˆmonitorenterä»¥åŠmonitorexitï¼›</span><br><span class="line">åªæ˜¯å¯¹è¯¥æ–¹æ³•åšäº†ä¸€ä¸ªæ ‡è¯†ï¼›å³è§‚å¯Ÿflags:æ ‡è¯†ï¼›</span><br><span class="line">ACC_SYNCHRONIZEDï¼šé‚£ä¹ˆè¯¥æ ‡è¯†çš„ä½œç”¨å³åœ¨äºï¼ˆåœ¨JVMè§„èŒƒå½“ä¸­ä¹Ÿæœ‰ç›¸å…³è¯´æ˜ï¼‰åŒæ­¥æ–¹æ³•ä¼šè¢«JVMéšå¼åœ°è°ƒç”¨monitorenterå’Œmonitorexitï¼›</span><br><span class="line">ä¹Ÿå°±æ˜¯è¯´javaè™šæ‹Ÿæœºçš„çº¿ç¨‹æ‰§è¡Œåˆ°åŒæ­¥æ–¹æ³•çš„æ—¶å€™å®ƒä¼šè‡ªåŠ¨çš„å»è°ƒç”¨å­—èŠ‚ç æŒ‡ä»¤monitorenterï¼›</span><br><span class="line">å½“æ‰§è¡Œå®ŒåŒæ­¥æ–¹æ³•ä¹‹åä¹Ÿä¼šè‡ªåŠ¨çš„å»è°ƒç”¨å­—èŠ‚ç æŒ‡ä»¤monitorexitï¼›</span><br><span class="line">å³æ‰€è°“éšå¼è°ƒç”¨ï¼›</span><br></pre></td></tr></table></figure><h3 id="å°ç»“-11"><a href="#å°ç»“-11" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>é€šè¿‡ javapåæ±‡ç¼–ï¼Œçœ‹åˆ°synchronizedä½¿ç”¨å˜æˆäº†monitorenterå’Œmonitorexitä¸¤ä¸ªå­—èŠ‚ç æŒ‡ä»¤ï¼›çœŸæ­£çš„é”æ˜¯monitorï¼›æ¯ä¸ªé”å¯¹è±¡éƒ½ä¼šå…³è”ä¸€ä¸ªmonitor(ç›‘è§†å™¨,monitoræ‰æ˜¯çœŸæ­£çš„é”å¯¹è±¡)ï¼Œmonitorå†…éƒ¨æœ‰ä¸¤ä¸ªé‡è¦çš„æˆå‘˜å˜é‡ownerï¼ˆownerï¼šä¼šä¿å­˜è·å¾—é”çš„çº¿ç¨‹ï¼‰å’Œrecursionsï¼ˆä¼šä¿å­˜çº¿ç¨‹è·å¾—é”çš„æ¬¡æ•°ï¼‰ï¼›<br>æ‰§è¡Œmonitorenteré‚£ä¹ˆçº¿ç¨‹å°±ä¼šæ¥è¿›è¡Œç«äº‰monitorè¿™æŠŠé”ï¼›<br>æŠ¢åˆ°monitorè¿™æŠŠé”ä¹‹åï¼›<br>å°±ä¼šå°†monitorå½“ä¸­çš„æˆå‘˜å˜é‡ownerçš„å–å€¼æ”¹ä¸ºå½“å‰æŠ¢åˆ°é”çš„è¯¥çº¿ç¨‹ï¼›<br>ä»¥åŠæ‹¥æœ‰é”çš„æ¬¡æ•°recursionså˜ä¸º1ï¼›<br>å¦‚æœå†æ¬¡è¿›å…¥åŒæ­¥ä»£ç å—å³åµŒå¥—åŒæ­¥ä»£ç å—ä¹Ÿæ˜¯åŒæ ·çš„è¿™ä¸€æŠŠé”ï¼›<br>é‚£ä¹ˆï¼ˆå¯é‡å…¥ç‰¹æ€§ï¼‰é‡å…¥å³monitorçš„æˆå‘˜å˜é‡recursionsçš„å–å€¼å°±ä¼šè¿›è¡ŒåŠ ä¸€æ“ä½œï¼›<br>å½“æ‰§è¡Œåˆ°monitorexitæ—¶ï¼Œé‚£ä¹ˆmonitorçš„æˆå‘˜å˜é‡recursionsè®¡æ•°å™¨å°±ä¼šè¿›è¡Œå‡ä¸€æ“ä½œï¼›<br>å½“monitorçš„è®¡æ•°å™¨recursionså‡åˆ°0æ—¶ï¼Œé‚£ä¹ˆå½“å‰æ‹¥æœ‰è¯¥é”monitorçš„ç°åœºç§°å°±ä¼šå»è¿›è¡Œé‡Šæ”¾é”ï¼›</p><h2 id="é¢è¯•é¢˜ï¼šsynchronizedä¸Lockçš„åŒºåˆ«"><a href="#é¢è¯•é¢˜ï¼šsynchronizedä¸Lockçš„åŒºåˆ«" class="headerlink" title="é¢è¯•é¢˜ï¼šsynchronizedä¸Lockçš„åŒºåˆ«"></a>é¢è¯•é¢˜ï¼šsynchronizedä¸Lockçš„åŒºåˆ«</h2><p><strong>1ã€</strong> synchronizedæ˜¯å…³é”®å­—ï¼Œè€ŒLockæ˜¯ä¸€ä¸ªæ¥å£ï¼ˆReentrantLockä¸ºå…¶å®ç°ç±»ï¼‰ã€‚  </p><p>synchronizedæ˜¯JDKæä¾›çš„ä¸€ä¸ªå…³é”®å­—ï¼›æ— æ³•æŸ¥çœ‹å¾—åˆ°å…¶æºç ï¼›<br>synchronizedç”±JVMç›´æ¥æ¥æ”¯æŒçš„ï¼›<br>è€Œå‰é¢æ‰€ä½¿ç”¨åˆ°çš„Lockå®é™…ä¸Šæ˜¯ä¸€ä¸ªæ¥å£ï¼›</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  <span class="doctag">@since</span> 1.5            //ä»jdk1.5ä¹‹åæœ‰çš„</span></span><br><span class="line"><span class="comment">  <span class="doctag">@author</span> Doug Lea</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Lock</span></span>&#123;  </span><br><span class="line"></span><br><span class="line"><span class="comment">/*å¹¶ä¸”è¯¥æ¥å£Lockå­˜åœ¨ç›¸åº”çš„å®ç°ç±»ï¼›</span></span><br><span class="line"><span class="comment">  ReadLockView in StampedLock (java.util.concurrent.....)</span></span><br><span class="line"><span class="comment">  WriteLock in ReetrantReadWriteLock (java.....)</span></span><br><span class="line"><span class="comment">  ReentrantLock (java.util.concurrent.locks)</span></span><br><span class="line"><span class="comment">  WriteLockView in StampedLock (java.util.concurrent....)</span></span><br><span class="line"><span class="comment">  ReadLock in ReentrantReadWriteLock (java....)</span></span><br><span class="line"><span class="comment">  è¿™äº›å®ç°ç±»å½“ä¸­å¤§éƒ¨åˆ†éƒ½åœ¨(WriteLock in )ReetrantReadWriteLockç±»å½“ä¸­</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">......</span><br></pre></td></tr></table></figure><p><strong>2ã€</strong> synchronizedä¼šè‡ªåŠ¨é‡Šæ”¾é”ï¼Œè€ŒLockå¿…é¡»æ‰‹åŠ¨é‡Šæ”¾é”ã€‚  </p><p>é€šè¿‡javap åæ±‡ç¼–çš„å½¢å¼å°±å¯ä»¥è¿›è¡ŒæŸ¥çœ‹å¾—åˆ°ï¼›<br>synchronizedå¹¶æ²¡æœ‰æ‰‹åŠ¨çš„å»è·å–é”ä»¥åŠé‡Šæ”¾é”ï¼›<br>å®ƒåœ¨åæ±‡ç¼–ä¹‹åä¼šå½¢æˆç›¸åº”çš„å­—èŠ‚ç æŒ‡ä»¤ï¼›<br>å½“æ‰§è¡Œåˆ°synchronized(obj){ çš„æ—¶å€™ä¼šæ‰§è¡Œåˆ°5: monitorenterå­—èŠ‚ç æŒ‡ä»¤ï¼›<br>å½“æ‰§è¡Œåˆ°synchronized(obj){æ‰€å¯¹åº”çš„å›æ‹¬å·}ï¼ˆåŒæ­¥ä»£ç å—æ‰§è¡Œå®Œæ—¶ï¼‰æ—¶ä¼šæ‰§è¡Œåˆ°15: monitorexitå­—èŠ‚ç æŒ‡ä»¤ï¼›<br>å¹¶ä¸”å°±ç®—åŒæ­¥ä»£ç å—å½“ä¸­å‡ºç°äº†å¼‚å¸¸ï¼›synchronizedä¹Ÿä¼šå°†é”ç»™é‡Šæ”¾æ‰ï¼›<br>å³Exception tableä¸­fromâ€¦toçš„6~16è¡Œå­—èŠ‚ç æŒ‡ä»¤å¦‚æœå‡ºç°å¼‚å¸¸åˆ™targetè·³è½¬è‡³å­—èŠ‚ç æŒ‡ä»¤19è¡Œæ‰§è¡Œ 19: astore_2ä»¥åŠæ¥ç€19è¡Œå­—èŠ‚ç æŒ‡ä»¤ç»§ç»­å¾€ä¸‹è¿›è¡Œæ‰§è¡Œï¼›20: aload_1ã€21: monitorexitå³é‡Šæ”¾é”ï¼›  </p><p>è€ŒLockå°±éœ€è¦æ‰‹åŠ¨çš„æ¥è¿›è¡Œé‡Šæ”¾é”ï¼›<br>å½“å»å°è¯•è·å–é”ä¹‹åè·å–è¿”å›å¾—åˆ°booleanç±»å‹å˜é‡ï¼›<br>æ ¹æ®è¯¥å¸ƒå°”ç±»å‹å˜é‡åˆ¤æ–­æ˜¯å¦è·å–å¾—åˆ°äº†é”ï¼›<br>å¹¶ä¸”åœ¨finallyå—å½“ä¸­éœ€è¦è¿›è¡Œä¿è¯é”çš„é‡Šæ”¾<br>ï¼ˆå‰ææ˜¯å¦‚æœtryLockè¿”å›ä¸ºtrueåˆ™éœ€è¦è¿›è¡Œæ‰§è¡Œunlock()æ“ä½œï¼›å¦‚æœtryLockè¿”å›ä¸ºtrueä½†æ˜¯æ²¡æœ‰æ‰§è¡Œunlockæ“ä½œé‚£ä¹ˆå°±å°†ä¼šå¯¼è‡´é”ä¸€ç›´ä¸é‡Šæ”¾ï¼›ï¼‰</p><p><strong>3ã€</strong> synchronizedæ˜¯ä¸å¯ä¸­æ–­çš„ï¼Œè€ŒLockå¯ä»¥æ˜¯ä¸å¯ä¸­æ–­çš„ä¹Ÿå¯ä»¥æ˜¯å¯ä¸­æ–­çš„ã€‚  </p><p>synchronizedï¼šå½“æœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œåˆ°synchronizedåŒæ­¥ä»£ç å—å½“ä¸­æ‰§è¡Œä»£ç çš„æ—¶å€™ï¼›å¦å¤–ä¸€ä¸ªçº¿ç¨‹ç”±äºæ²¡æœ‰é”åªèƒ½å¤Ÿåœ¨åŒæ­¥ä»£ç å—å¤–ä¾§è¿›è¡Œç­‰å¾…æ“ä½œï¼›<br>è¿™ä¸ªç­‰å¾…çš„çº¿ç¨‹æ˜¯ä¸èƒ½å¤Ÿè¢«ä¸­æ–­çš„ï¼Œå®ƒä¼šä¸€ç›´ç­‰å¾…è·å–é”ï¼›  </p><p>è€ŒLockæœ‰ä¸¤ç§å¤„ç†æ–¹å¼ï¼šå¯ä»¥ä¸­æ–­ä¹Ÿå¯ä»¥ä¸ä¸­æ–­ï¼›<br>ä¸€ç§æ˜¯å¯ä¸­æ–­å¼çš„é‡‡ç”¨tryLock()çš„æ–¹å¼ï¼›<br>ï¼ˆå°è¯•å»è·å–é”ï¼Œå¹¶ä¸”å¯ä»¥å®šä¹‰ç­‰å¾…è·å–é”çš„æ—¶é—´ä»¥åŠæ—¶é—´å•ä½ï¼›æŒ‡å®šç­‰å¾…è·å–é”çš„æ—¶é—´åˆ°äº†å¦‚æœä»ç„¶æ²¡æœ‰è·å–å¾—åˆ°é”çš„è¯é‚£ä¹ˆè¿™ä¸ªæ—¶å€™æ˜¯å¯ä»¥ä¸­æ–­çš„ï¼Œå³ä¸€ç›´å¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ä¸å¿…å†è¿›è¡Œç­‰å¾…è·å–é”è€Œæ˜¯å¯ä»¥å»æ‰§è¡Œå…¶ä»–çš„ä»»åŠ¡ï¼‰<br>å¦å¤–ä¸€ç§æ˜¯lock()æ–¹å¼çš„è€Œè¿™ç§æ–¹å¼æ˜¯ä¸å¯ä¸­æ–­çš„ï¼›</p><p><strong>4ã€</strong> é€šè¿‡Lockå¯ä»¥çŸ¥é“çº¿ç¨‹æœ‰æ²¡æœ‰æ‹¿åˆ°é”ï¼ˆtryLock()ï¼‰ï¼Œè€Œsynchronizedä¸èƒ½ã€‚  </p><p>æ¯”å¦‚è¯´Lockå®šä¹‰ä½¿ç”¨äº†å…¶tryLock(3, TimeUnit.SECONDS);æ–¹æ³•ï¼›<br>åˆ™å°†è¿”å›æœ‰å¸ƒå°”ç±»å‹çš„å–å€¼ï¼›<br>å¦‚æœå…¶è¿”å›å€¼ä¸ºtrueåˆ™è¯´æ˜å½“å‰è¯¥ç­‰å¾…çš„çº¿ç¨‹æ‹¿åˆ°äº†é”ï¼›<br>å¦‚æœå…¶è¿”å›å€¼ä¸ºfalseåˆ™è¯´æ˜å½“å‰ç­‰å¾…çš„è¯¥çº¿ç¨‹å¹¶æ²¡æœ‰æ‹¿åˆ°é”ï¼›åˆ™è¿›è¡Œä¸­æ–­å®Œæˆå…¶ä»–çš„æ“ä½œï¼›<br>è€Œsynchronizedæ˜¯ä¸èƒ½å¤Ÿå»è¿›è¡Œåˆ¤æ–­æœ‰æ²¡æœ‰æ‹¿åˆ°é”çš„ï¼›synchronizedå°±æ˜¯ä¸€ä¸ªä»£ç å—ï¼›<br>æ¯”å¦‚è¯´è¿™æ®µä»£ç å½“ä¸­æ‹¿åˆ°é”åˆ™è‡ªåŠ¨è¿›å…¥åŒæ­¥ä»£ç å—å½“ä¸­æ‰§è¡Œç›¸åº”çš„æ‰“å°æ“ä½œï¼›æ²¡æœ‰æ‹¿åˆ°é”åˆ™åªèƒ½å¤Ÿåœ¨åŒæ­¥ä»£ç å—å¤–ä¾§è¿›è¡Œç­‰å¾…æ‹¿åˆ°é”çš„çº¿ç¨‹è¿›è¡Œé‡Šæ”¾é”ï¼›å¦‚æœæ²¡æœ‰é‡Šæ”¾åˆ™å°†ä¸€ç›´ç­‰å¾…ï¼›</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">synchronized</span>(obj)&#123;</span><br><span class="line">  System.<span class="keyword">out</span>.println(<span class="string">"1"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>5ã€</strong> synchronizedèƒ½é”ä½æ–¹æ³•å’Œä»£ç å—ï¼Œè€ŒLockåªèƒ½é”ä½ä»£ç å—ã€‚  </p><p>é€šè¿‡è¯­æ³•å±‚é¢å¯ä»¥çœ‹åˆ°synchronizedå¯ä»¥ç”¨æ¥é”ä½æ–¹æ³•ä»¥åŠä»£ç å—ï¼›<br>è€ŒLockåªèƒ½å¤Ÿé”ä½ä»£ç å—è€Œä¸èƒ½é”ä½æ–¹æ³•ï¼›<br>ä¹Ÿå°±æ˜¯è¯¥Lockåªèƒ½å¤Ÿåœ¨æ–¹æ³•å†…éƒ¨è¿›è¡Œè°ƒç”¨ï¼›<br>è€Œä¸èƒ½å°†Lockæ”¾åˆ°æ–¹æ³•ä¸Šè¿›è¡Œä¿®é¥°æ–¹æ³•ï¼›</p><p><strong>6ã€</strong> Lockå¯ä»¥ä½¿ç”¨è¯»é”æé«˜å¤šçº¿ç¨‹æ•ˆç‡ã€‚  </p><p>Lockå½“ä¸­æœ‰ä¸€ä¸ªå®ç°ç±»å«åšReentrantReadWriteLockï¼›<br>è¿™ç§é”å¯ä»¥è¿›è¡Œæé«˜è¯»çš„æ•ˆç‡çš„ï¼›</p><p>ReentrantReadWriteLock.java<br>è¿™ä¸ªé”çš„æœºåˆ¶æ˜¯è¿™æ ·çš„ï¼›<br>å¦‚æœåœ¨è¯»çš„æ—¶å€™å®ƒå…è®¸å¤šä¸ªçº¿ç¨‹æ¥è¿›è¡Œè¯»æ“ä½œï¼›<br>é‚£ä¹ˆå¦‚æœå†™çš„æ—¶å€™é‚£å°±åªèƒ½ä¸€ä¸ªçº¿ç¨‹æ¥è¿›è¡Œå†™ä¹Ÿä¸èƒ½è¿›è¡Œè¯»å–æ“ä½œï¼›<br>æ‰€ä»¥å®ƒæ˜¯å¯ä»¥æé«˜å¤šä¸ªçº¿ç¨‹æ¥è¿›è¡Œè¯»çš„æ•ˆç‡ã€‚</p><p><strong>7ã€</strong> synchronizedæ˜¯éå…¬å¹³é”ï¼ŒReentrantLockå¯ä»¥æ§åˆ¶æ˜¯å¦æ˜¯å…¬å¹³é”ã€‚  </p><p>synchronizedæ˜¯éå…¬å¹³é”ï¼›<br>å³å…¶è¿›è¡Œå”¤é†’çš„æ—¶å€™å¹¶ä¸æ˜¯å…¬å¹³çš„å…ˆæ¥ååˆ°çš„æ–¹å¼æ¥è¿›è¡Œå”¤é†’ï¼›<br>ä¸¾ä¸ªä¾‹å­ï¼š</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">pubilc <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(<span class="keyword">String</span>[] args)</span></span>&#123;</span><br><span class="line">  synchronized(obj)&#123;</span><br><span class="line">    System.out.<span class="built_in">println</span>(<span class="string">"1"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‡è®¾ä¸€ä¸ªçº¿ç¨‹Aå…ˆè¿›è¡Œè·å–å¾—åˆ°é”ä»è€Œè¿›å…¥åŒæ­¥ä»£ç å—å½“ä¸­è¿›è¡Œæ‰§è¡Œç›¸å…³å†…å®¹å¦‚æ‰“å°â€œ1â€ï¼›<br>é‚£ä¹ˆåé¢è¿˜æœ‰å…¶ä»–çš„çº¿ç¨‹Bã€Cã€Dã€Eã€Fâ€¦â€¦è¿›æ¥ï¼›é‚£ä¹ˆåé¢çš„çº¿ç¨‹Bã€Cã€Dã€Eã€Fâ€¦â€¦åœ¨æŠ¢ä¸åˆ°é”ï¼Œå³ç¬¬ä¸€ä¸ªçº¿ç¨‹Aæ²¡æœ‰é‡Šæ”¾é”çš„æƒ…å†µä¸‹ï¼Œåªèƒ½åœ¨åŒæ­¥å—å¤–ä¾§è¿›è¡Œç­‰å¾…ï¼›<br>é‚£ä¹ˆæ­¤æ—¶å‡è®¾çº¿ç¨‹Aæ‰§è¡Œå®ŒåŒæ­¥ä»£ç å—ä¹‹åï¼›é‚£ä¹ˆè‚¯å®šå°±éœ€è¦å»å”¤é†’ç­‰å¾…åœ¨åŒæ­¥ä»£ç å—å¤–ä¾§çš„çº¿ç¨‹Bã€Cã€Dã€Eã€Fâ€¦â€¦ä¸­çš„æŸä¸€ä¸ªæ¥è·å–é”è¿›å…¥åŒæ­¥ä»£ç å—ä¸­ï¼›<br>é‚£ä¹ˆå”¤é†’çš„æ—¶å€™åˆ™ä¸æ˜¯æŒ‰ç…§å…ˆæ¥ååˆ°çš„æ–¹å¼è¿›è¡Œå”¤é†’ï¼›<br>è€Œæ˜¯å±äºéšæœºçš„å”¤é†’ä¸€ä¸ªçº¿ç¨‹ï¼›<br>æ‰€ä»¥ï¼›synchronizedæ˜¯éå…¬å¹³çš„ï¼›<br>è€ŒReentrantLockæ˜¯å¯ä»¥å»è¿›è¡Œæ§åˆ¶å®ƒæ˜¯å¦ä¸ºå…¬å¹³é”çš„ï¼›</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">// æ­¤æ—¶ä½¿ç”¨çš„æ˜¯ReentrantLockå½“ä¸­çš„æ— å‚æ„é€ å™¨ï¼›</span><br><span class="line">//è€Œæ— å‚æ„é€ å™¨é»˜è®¤æ˜¯éå…¬å¹³çš„ï¼›</span><br><span class="line">private<span class="keyword"> static</span> Lock lock =<span class="built_in"> new </span>ReentrantLock();</span><br><span class="line"></span><br><span class="line">------------------------------------------------------</span><br><span class="line"></span><br><span class="line">ReentrantLock.java</span><br><span class="line">/**</span><br><span class="line">  Creates an<span class="built_in"> instance </span>of &#123;@code ReentantLock&#125;</span><br><span class="line">  This is equivalent to using &#123;@Code ReentrantLock(false)&#125;</span><br><span class="line">  æ— å‚æ„é€ å™¨</span><br><span class="line">*/</span><br><span class="line">public ReentrantLock()&#123;</span><br><span class="line">  sync =<span class="built_in"> new </span>NonfairSync();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line">  Creates an<span class="built_in"> instance </span>of &#123;@code ReentrantLock&#125; with the</span><br><span class="line">  given fairness policy.</span><br><span class="line">  æœ‰å‚æ„é€ å™¨ï¼›booleanç±»å‹æ“ä½œæ¥æŒ‡å®šReentrantLockæ˜¯å¦å…¬å¹³ï¼›</span><br><span class="line">  ä¹Ÿå°±æ˜¯å”¤é†’ç­‰å¾…çº¿ç¨‹çš„æ—¶å€™æ˜¯å¦é‡‡ç”¨å…ˆæ¥ååˆ°çš„æ–¹å¼è¿›è¡Œå”¤é†’ï¼›</span><br><span class="line">  å¦‚æœæ˜¯å…ˆæ¥ååˆ°çš„æ–¹å¼é‚£ä¹ˆå°±æ˜¯é‡‡ç”¨çš„æ˜¯å…¬å¹³é”ï¼›</span><br><span class="line">  å¦‚æœä¸æ˜¯å…ˆæ¥ååˆ°çš„æ–¹å¼é‚£ä¹ˆå°±æ˜¯éå…¬å¹³é”ï¼›</span><br><span class="line"></span><br><span class="line">  @param fair&#123;@code true&#125;<span class="built_in"> if </span>this lock should use a fair ordering policy.</span><br><span class="line">*/</span><br><span class="line">public ReentrantLock(boolean fair)&#123;</span><br><span class="line">  sync = fair ?<span class="built_in"> new </span>FairSync()<span class="keyword"> :</span><span class="built_in"> new </span>NonfairSync();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ·±å…¥JVMæºç -monitorç›‘è§†å™¨é”"><a href="#æ·±å…¥JVMæºç -monitorç›‘è§†å™¨é”" class="headerlink" title="æ·±å…¥JVMæºç -monitorç›‘è§†å™¨é”"></a>æ·±å…¥JVMæºç -monitorç›‘è§†å™¨é”</h2><p>synchronizedæ˜¯javaå½“ä¸­çš„ä¸€ä¸ªå…³é”®å­—ï¼›<br>é€šè¿‡javaæ˜¯çœ‹ä¸åˆ°synchronizedå…³é”®å­—æºç çš„ï¼›<br>synchronizedæ˜¯ç”±JVMç›´æ¥æ¥è¿›è¡Œæ”¯æŒçš„ï¼›<br>ç°åœ¨é€šè¿‡JVMæºç çš„æ–¹å¼æ¥è¿›è¡Œåˆ†æsynchronizedåŸç†ï¼›<br>JVMçš„æºä»£ç æ˜¯ä½¿ç”¨C++ç¼–å†™çš„ï¼›é‚£ä¹ˆä»‹ç»IDEå·¥å…·æ¥æ–¹ä¾¿æŸ¥çœ‹JVMçš„æºä»£ç ï¼›<br>synchronizedæœ¬è´¨æ˜¯é€šè¿‡monitorç„¶åæ¥è¿›è¡ŒåŒæ­¥æ“ä½œçš„ï¼›<br>é‚£ä¹ˆä¼šè¯¦ç»†ä»‹ç»monitorçš„ç»“æ„ï¼›<br>å¦å¤–å½“å­˜åœ¨æœ‰å¤šä¸ªçº¿ç¨‹æ¥æ‰§è¡Œsynchronizedçš„æ—¶å€™ï¼Œåªå­˜åœ¨æœ‰ä¸€ä¸ªçº¿ç¨‹ç«äº‰å¾—åˆ°é”ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±ä¼šæ¥è¿›è¡Œä»‹ç»monitorçš„ç«äº‰ï¼›<br>ä»¥åŠçº¿ç¨‹æ²¡æœ‰ç«äº‰å¾—åˆ°é”æ˜¯å¦‚ä½•å¤„ç†çš„ä¹Ÿå°±æ˜¯monitorç­‰å¾…ï¼›<br>ä»¥åŠsynchronizedæ‰§è¡Œå®Œæˆä¹‹åçº¿ç¨‹è¦é‡Šæ”¾é”ï¼›é‚£ä¹ˆçº¿ç¨‹æ˜¯å¦‚ä½•æ¥è¿›è¡Œé‡Šæ”¾çš„å‘¢ï¼Ÿ<br>è¿™é‡Œå°±ç‰µæ‰¯åˆ°äº†monitoré‡Šæ”¾ï¼›<br>æœ€åè¿˜ä¼šä»‹ç»åˆ°monitoræ˜¯ä¸€ä¸ªé‡é‡çº§é”ï¼Œmonitorå…¶æ€§èƒ½å¼€é”€æ¯”è¾ƒå¤§ï¼›</p><p>å­¦ä¹ éƒ¨åˆ†åˆ†ä¸ºï¼š</p><ul><li>æ·±å…¥JVMæºç <ul><li>ç›®æ ‡</li><li>JVMæºç ä¸‹è½½</li><li>IDE(Clion)ä¸‹è½½</li><li>monitorç›‘è§†å™¨é”</li><li>monitorç«äº‰</li><li>monitorç­‰å¾…</li><li>monitoré‡Šæ”¾</li><li>monitoræ˜¯é‡é‡çº§é”</li></ul></li></ul><h3 id="ç›®æ ‡-12"><a href="#ç›®æ ‡-12" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>é€šè¿‡JVMæºç  åˆ†æ synchronizedçš„åŸç†</p><h3 id="JVMæºç ä¸‹è½½"><a href="#JVMæºç ä¸‹è½½" class="headerlink" title="JVMæºç ä¸‹è½½"></a>JVMæºç ä¸‹è½½</h3><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//openjdk.java.net/</span></span><br><span class="line">é€‰ä¸­å·¦è¾¹èœå•æ ä¸­[Source Code]ä¸‹çš„å­èœå•æ [Mercurial]</span><br><span class="line">ç‚¹å‡»å®Œä¹‹åå¾—åˆ°çš„å°±æ˜¯jdkæ‰€æœ‰æºä»£ç çš„ä¸€ä¸ªæ‰˜ç®¡ç»“æ„ï¼›</span><br><span class="line">é‚£ä¹ˆåœ¨è¿™å½“ä¸­æ‰¾åˆ°jdk8ï¼›</span><br><span class="line">æ‰¾åˆ°çš„é¡µé¢ï¼šhttp:<span class="comment">//hg.openjdk.java.net/jdk8</span></span><br><span class="line">é¡µé¢ä¸­å°±æ˜¯jdk8çš„æºç ï¼›</span><br><span class="line">é€‰æ‹©hotspotè¿›è¡Œä¸‹è½½ï¼ŒHotspotæ˜¯jdkè‡ªå¸¦çš„è™šæ‹Ÿæœºï¼›</span><br><span class="line">è¿›è¡Œè·³è½¬é¡µé¢ï¼šhttp:<span class="comment">//hg.openjdk.java.net/jdk8/hotspot</span></span><br><span class="line">çœ‹åˆ°å·¦ä¾§èœå•æ é€‰æ‹©zipæ ¼å¼è¿›è¡Œä¸‹è½½æºä»£ç ï¼›</span><br><span class="line">S<span class="function"><span class="title">ource</span> Code ---&gt;</span> M<span class="function"><span class="title">ercurial</span> ---&gt;</span> <span class="function"><span class="title">jdk8</span> ---&gt;</span> <span class="function"><span class="title">hotspot</span> ---&gt;</span> zip</span><br></pre></td></tr></table></figure><p>java æ˜¯å¼€æºçš„ï¼›<br>é‚£ä¹ˆjavaå¼€æºéƒ¨åˆ†çš„ä»£ç å°±å±äºåœ¨openjdkè¿™ä¸ªé¡¹ç›®å½“ä¸­ï¼›<br>é‚£ä¹ˆåœ¨è¯¥ç½‘ç«™å½“ä¸­å°±èƒ½å¤Ÿä¸‹è½½å¾—åˆ°å…¶æºä»£ç ï¼›</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">jvmæ‰€æœ‰çš„æºç éƒ½åœ¨å…¶srcç›®å½•ä¸‹ï¼›</span><br><span class="line"><span class="title">.ideea</span></span><br><span class="line"><span class="title">.jcheck</span></span><br><span class="line">agent</span><br><span class="line">cmake-build-debug</span><br><span class="line">make</span><br><span class="line">src</span><br><span class="line"><span class="title">.hg_archival.txt</span></span><br><span class="line"><span class="title">.hgignore</span></span><br><span class="line"><span class="title">.hgtags</span></span><br><span class="line">ASSEMBLY<span class="emphasis">_EXCEPTION</span></span><br><span class="line"><span class="emphasis">CMakeLists.txt</span></span><br><span class="line"><span class="emphasis">LICENSE</span></span><br><span class="line"><span class="emphasis">README</span></span><br><span class="line"><span class="emphasis">THIRD_</span>PARTY<span class="emphasis">_README</span></span><br><span class="line"><span class="emphasis">--------------------------------------</span></span><br><span class="line"><span class="emphasis">srcä¸‹çš„ç›®å½•åˆåˆ†æˆå‡ ä¸ªéƒ¨åˆ†ï¼š</span></span><br><span class="line"><span class="emphasis">cpu</span></span><br><span class="line"><span class="emphasis">os</span></span><br><span class="line"><span class="emphasis">os_</span>cpu</span><br><span class="line">share</span><br><span class="line"></span><br><span class="line">----------------------------------------</span><br><span class="line">----------------------------------------</span><br><span class="line"></span><br><span class="line">ç¬¬ä¸€éƒ¨åˆ†cpuï¼›cpuè·Ÿè™šæ‹Ÿæœºç›¸å…³çš„ä¸€äº›ä»£ç ï¼›</span><br><span class="line">å…¶ä¸‹ç›®å½•æœ‰</span><br><span class="line">sparc</span><br><span class="line">x86</span><br><span class="line">zero</span><br><span class="line">----------------------------------------</span><br><span class="line">ç¬¬äºŒéƒ¨åˆ†os: æ“ä½œç³»ç»Ÿï¼ˆä¹Ÿå°±æ˜¯è™šæ‹Ÿæœºåœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿå½“ä¸­å­˜åœ¨æœ‰ä¸€äº›ç‰¹åˆ«çš„ä»£ç ï¼‰</span><br><span class="line">å…¶ä¸‹ç›®å½•æœ‰</span><br><span class="line">bsd</span><br><span class="line">linux</span><br><span class="line">posix</span><br><span class="line">solaris</span><br><span class="line">windows</span><br><span class="line">-------------------------------------------</span><br><span class="line">ç¬¬ä¸‰éƒ¨åˆ†os<span class="emphasis">_cpu: ä¸cpuç›¸å…³ä¹Ÿä¸æ“ä½œç³»ç»Ÿç›¸å…³çš„ä¸€äº›ç‰¹æ®Šä»£ç </span></span><br><span class="line"><span class="emphasis">å…¶ä¸‹ç›®å½•æœ‰</span></span><br><span class="line"><span class="emphasis">bsd_</span>x86</span><br><span class="line">bxd<span class="emphasis">_zero</span></span><br><span class="line"><span class="emphasis">linux_</span>sparc</span><br><span class="line">linux<span class="emphasis">_x86</span></span><br><span class="line"><span class="emphasis">linux_</span>zero</span><br><span class="line">solaris<span class="emphasis">_sparc</span></span><br><span class="line"><span class="emphasis">solaris_</span>x86</span><br><span class="line">windows<span class="emphasis">_x86</span></span><br><span class="line"><span class="emphasis">-------------------------------------------------------</span></span><br><span class="line"><span class="emphasis">ç¬¬å››éƒ¨åˆ†share: å³å…¬å…±çš„JVMæºç </span></span><br><span class="line"><span class="emphasis">å…¶ä¸‹ç›®å½•æœ‰</span></span><br><span class="line"><span class="emphasis">tools //å·¥å…·ç±»</span></span><br><span class="line"><span class="emphasis">vm    //æ‰€æœ‰JVMå…¬å…±çš„æºç éƒ½åœ¨vmå½“ä¸­</span></span><br><span class="line"><span class="emphasis">-------------------------------------------------------</span></span><br><span class="line"><span class="emphasis">-------------------------------------------------------</span></span><br><span class="line"><span class="emphasis">vmç›®å½•ä¸‹åˆåˆ†æœ‰ä¸€äº›å­ç›®å½•ï¼š</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">adlc</span></span><br><span class="line"><span class="emphasis">asm</span></span><br><span class="line"><span class="emphasis">c1</span></span><br><span class="line"><span class="emphasis">ci</span></span><br><span class="line"><span class="emphasis">classfile</span></span><br><span class="line"><span class="emphasis">code</span></span><br><span class="line"><span class="emphasis">compiler</span></span><br><span class="line"><span class="emphasis">gc_</span>implementation</span><br><span class="line">gc<span class="emphasis">_interface</span></span><br><span class="line"><span class="emphasis">interpreter</span></span><br><span class="line"><span class="emphasis">libadt</span></span><br><span class="line"><span class="emphasis">memory</span></span><br><span class="line"><span class="emphasis">oops</span></span><br><span class="line"><span class="emphasis">opto</span></span><br><span class="line"><span class="emphasis">precompiled</span></span><br><span class="line"><span class="emphasis">prims</span></span><br><span class="line"><span class="emphasis">runtime</span></span><br><span class="line"><span class="emphasis">Xusage.txt</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">-----------------------------------------------------</span></span><br><span class="line"><span class="emphasis">-----------------------------------------------------</span></span><br><span class="line"><span class="emphasis">ä¸»è¦å…³æ³¨vmæ–‡ä»¶å¤¹ä¸‹çš„</span></span><br><span class="line"><span class="emphasis">oopsï¼šå³é¢å‘å¯¹è±¡å³ä¸€äº›ç±»çš„æè¿°ç±»çš„ç»“æ„éƒ½å­˜å‚¨æ”¾åœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹ï¼›</span></span><br><span class="line"><span class="emphasis">runtimeæ–‡ä»¶å¤¹ï¼šä¸»è¦æ˜¯ä¸€äº›çº¿ç¨‹è¿˜æœ‰ä¸€äº›monitoré”éƒ½åœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹ã€‚</span></span><br><span class="line"><span class="emphasis">---------------------------------------------------------</span></span><br></pre></td></tr></table></figure><h3 id="IDE-Clion-ä¸‹è½½"><a href="#IDE-Clion-ä¸‹è½½" class="headerlink" title="IDE(Clion)ä¸‹è½½"></a>IDE(Clion)ä¸‹è½½</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">-----------------------------------</span><br><span class="line">ä¸‹è½½c++çš„ide:</span><br><span class="line">https://www.jetbrains.com/</span><br><span class="line"><span class="code">          |</span></span><br><span class="line"><span class="code">          â†“</span></span><br><span class="line">https://jetbrains.com/clion/</span><br><span class="line">-----------------------------------</span><br><span class="line"></span><br><span class="line">å¯¼å…¥javaè™šæ‹Ÿæœºçš„æºç ï¼š</span><br><span class="line">File--&gt;new Projectï¼›</span><br><span class="line">å¯¼å…¥æ–‡ä»¶å¤¹å½“ä¸­çš„æºç ï¼›</span><br><span class="line">è¯¥æ–‡ä»¶å¤¹å³ä¸ºå½“å‰è¯¥ç›®å½•çš„æ–‡ä»¶å¤¹ï¼›</span><br><span class="line"><span class="title">.ideea</span></span><br><span class="line"><span class="title">.jcheck</span></span><br><span class="line">agent</span><br><span class="line">cmake-build-debug</span><br><span class="line">make</span><br><span class="line">src</span><br><span class="line"><span class="title">.hg_archival.txt</span></span><br><span class="line"><span class="title">.hgignore</span></span><br><span class="line"><span class="title">.hgtags</span></span><br><span class="line">ASSEMBLY<span class="emphasis">_EXCEPTION</span></span><br><span class="line"><span class="emphasis">CMakeLists.txt</span></span><br><span class="line"><span class="emphasis">LICENSE</span></span><br><span class="line"><span class="emphasis">README</span></span><br><span class="line"><span class="emphasis">THIRD_</span>PARTY<span class="emphasis">_README</span></span><br></pre></td></tr></table></figure><h3 id="monitorç›‘è§†å™¨é”"><a href="#monitorç›‘è§†å™¨é”" class="headerlink" title="monitorç›‘è§†å™¨é”"></a>monitorç›‘è§†å™¨é”</h3><p>(JVMåº•å±‚ç”±C++å®ç°)</p><p>å¯ä»¥çœ‹å‡º æ— è®ºæ˜¯ synchronizedä»£ç å— è¿˜æ˜¯ synchronizedæ–¹æ³•ï¼Œ<br>ï¼ˆæœ€ç»ˆéœ€è¦ä¸€ä¸ªjavaå¯¹è±¡ï¼›è€Œjavaå¯¹è±¡åˆä¼šå…³è”åˆ°ä¸€ä¸ªmonitorç›‘è§†å™¨é”çš„ä¸œè¥¿ï¼›çœŸæ­£çš„åŒæ­¥æ˜¯é monitorç›‘è§†å™¨é”æ¥å®ç°çš„ï¼›é‚£ä¹ˆmonitorç›‘è§†å™¨é”çš„ç»“æœæ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿï¼‰<br>å…¶çº¿ç¨‹å®‰å…¨çš„è¯­ä¹‰å®ç° æœ€ç»ˆä¾èµ–ä¸€ä¸ªå« monitorçš„ä¸œè¥¿ï¼Œé‚£ä¹ˆè¿™ä¸ªç¥ç§˜çš„ä¸œè¥¿æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ<br>ä¸‹é¢æ¥è¯¦ç»†ä»‹ç»ä¸€ä¸‹ã€‚</p><p>åœ¨HotSpotè™šæ‹Ÿæœºä¸­ï¼Œmonitoræ˜¯ç”±ObjectMonitorå®ç°çš„ã€‚<br>å…¶æºç æ˜¯ç”¨cã€c++æ¥å®ç°çš„ï¼Œä½äºHotSpotè™šæ‹Ÿæœºæºç  ObjectMonitor.hppæ–‡ä»¶ä¸­ï¼ˆsrc/share/vm/runtime/objectMonitor.hppï¼‰ã€‚<br>ObjectMonitorä¸»è¦æ•°æ®ç»“æ„å¦‚ä¸‹ï¼š</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">-------------------------------------------------------------------</span><br><span class="line"><span class="comment"># æ„é€ å™¨ï¼Œç»™å¾ˆå¤šçš„æˆå‘˜å˜é‡èµ‹å€¼ï¼ˆè®©å…¶ä¸javaæºä»£ç ç»„åˆèµ·æ¥è¿›è¡Œåˆ†ææ¯”è¾ƒæ–¹ä¾¿ï¼‰</span></span><br><span class="line">ObjectMonitor() &#123;</span><br><span class="line">  _header              = NULL;</span><br><span class="line">  _<span class="built_in">count</span>               = <span class="number">0</span>;</span><br><span class="line">  _waiters             = <span class="number">0</span>;</span><br><span class="line">  _recursions          = <span class="number">0</span><span class="comment">; // çº¿ç¨‹çš„é‡å…¥æ¬¡æ•°</span></span><br><span class="line">  _object              = NULL<span class="comment">; //å­˜å‚¨è¯¥monitorçš„å¯¹è±¡</span></span><br><span class="line">  _owner               = NULL<span class="comment">; //æ ‡è¯†æ‹¥æœ‰è¯¥monitorçš„çº¿ç¨‹</span></span><br><span class="line">  _WaitSet             = NULL<span class="comment">; //å¤„äºwaitçŠ¶æ€çš„çº¿ç¨‹ï¼Œä¼šè¢«åŠ å…¥åˆ°_WaitSet</span></span><br><span class="line">  _WaitSetLock         = <span class="number">0</span>;</span><br><span class="line">  _Responsible         = NULL;</span><br><span class="line">  _succ                = NULL;</span><br><span class="line">  _cxq                 = NULL<span class="comment">; // å¤šçº¿ç¨‹ç«äº‰é”æ—¶çš„å•é¡¹åˆ—è¡¨</span></span><br><span class="line">  FreeNext             = NULL;</span><br><span class="line">  _EntryList           = NUll<span class="comment">; //å¤„äºç­‰å¾…é”blockçŠ¶æ€çš„çº¿ç¨‹ï¼Œä¼šè¢«åŠ å…¥åˆ°è¯¥åˆ—è¡¨</span></span><br><span class="line">  _SpinFreq            = <span class="number">0</span>;</span><br><span class="line">  _SpinClock           = <span class="number">0</span>;</span><br><span class="line">  OwnerIsThread        = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">----------------------------------------------------------------------</span><br><span class="line">public static void main(String[] args)&#123;</span><br><span class="line">  <span class="keyword">synchronized(obj)&#123;</span></span><br><span class="line"><span class="keyword"> </span>   System.out.println(<span class="string">"1"</span>);</span><br><span class="line"></span><br><span class="line">    obj.<span class="keyword">wait();</span></span><br><span class="line"><span class="keyword"> </span> &#125;</span><br><span class="line">&#125;</span><br><span class="line">----------------------------------------------------------------------</span><br><span class="line">åˆ†æï¼š</span><br><span class="line"><span class="keyword">Javaä»£ç ï¼šsynchronized(obj)&#123; </span>åŒæ­¥ä»£ç å—éœ€è¦ä¸€ä¸ª<span class="keyword">javaå¯¹è±¡ï¼Œç±»å¯¹è±¡éƒ½å¯ä»¥ï¼›</span></span><br><span class="line"><span class="keyword">é‚£ä¹ˆè¿™ä¸ªjavaå¯¹è±¡newå‡ºæ¥æ˜¯è‚¯å®šå­˜æ”¾åœ¨javaå†…å­˜ç»“æ„å½“ä¸­çš„å †ä¸­çš„ï¼›</span></span><br><span class="line"><span class="keyword">é‚£ä¹ˆå¯¹è±¡å½“ä¸­å­˜åœ¨ä¸€äº›ä»€ä¹ˆå‘¢ï¼Ÿ</span></span><br><span class="line"><span class="keyword">ä»¥å‰çŸ¥é“å¯¹è±¡å½“ä¸­å­˜åœ¨æœ‰æˆå‘˜å˜é‡ï¼›</span></span><br><span class="line"><span class="keyword">å †ä¸­ä¼šå­˜æ”¾å¯¹è±¡ä¸­çš„æˆå‘˜å˜é‡ï¼›ä¹Ÿå«ç¤ºä¾‹æ•°æ®ï¼›</span></span><br><span class="line"><span class="keyword">é‚£ä¹ˆå…¶å®ï¼›é™¤äº†ç¤ºä¾‹æ•°æ®ä»¥å¤–è¿˜ä¼šæœ‰ä¸€ä¸ªå«åšå¯¹è±¡å¤´çš„å†…å®¹ï¼›</span></span><br><span class="line"><span class="keyword">é‚£ä¹ˆè¿™ä¸ªå¯¹è±¡å¤´çš„ä½œç”¨å°±åœ¨äºä¿å­˜å¯¹åº”çš„monitorå¯¹è±¡ï¼›</span></span><br><span class="line"><span class="keyword">è¿™ä¸ªå¯¹è±¡ä¼šå…³è”ä¸€ä¸ªmonitorå¯¹è±¡ï¼›é‚£ä¹ˆè¿™ä¸ªmonitorå¯¹è±¡å¦‚ä½•æ¥çš„å‘¢ï¼Ÿ</span></span><br><span class="line"><span class="keyword">monitoræ—¶å€™ç”±C++çš„ç±»ObjectMonitor.hppæ‰€é€ çš„è¿™æ ·ä¸€ä¸ªå¯¹è±¡ï¼›</span></span><br><span class="line"><span class="keyword">é¦–å…ˆåœ¨ObjectMonitor.hppå½“ä¸­è¿›è¡ŒæŸ¥çœ‹ä¸€äº›æ¯”è¾ƒé‡è¦çš„æˆå‘˜å˜é‡ï¼›</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">_recursionsï¼›_recursionsè®°å½•çº¿ç¨‹æ‹¿äº†å‡ æ¬¡é”äº†ï¼›å³çº¿ç¨‹é”é‡å…¥çš„æ¬¡æ•°ï¼›</span></span><br><span class="line"><span class="keyword">ä¸¾ä¸ªä¾‹å­:</span></span><br><span class="line"><span class="keyword">å‡è®¾çº¿ç¨‹ç¬¬ä¸€æ¬¡è¿›å…¥åŒæ­¥ä»£ç å—ä¸­ï¼›è·å–å¾—åˆ°é”å¯¹è±¡ï¼›å³synchronized(obj)&#123;ï¼›</span></span><br><span class="line"><span class="keyword">é‚£ä¹ˆæ­¤æ—¶é”å¯¹è±¡æ‰€å…³è”çš„monitorå¯¹è±¡å½“ä¸­çš„æˆå‘˜å±æ€§ä¸­çš„_recursionså°±ä¼šè®°å½•æ‹¿äº†ä¸€æ¬¡ï¼›</span></span><br><span class="line"><span class="keyword">é‚£ä¹ˆå‡è®¾è¯¥åŒæ­¥ä»£ç å—å½“ä¸­è¿˜å­˜åœ¨äº†ä¸€ä¸ªåŒæ­¥ä»£ç å—å³åµŒå¥—åŒæ­¥ä»£ç å—ä»¥åŠåŒæ ·çš„ä¸€æŠŠé”ï¼›</span></span><br><span class="line"><span class="keyword">é‚£ä¹ˆè¿™ä¸ª_recursionsè®¡æ•°å™¨å°±ä¼šæ‰§è¡ŒåŠ 1æ“ä½œï¼›</span></span><br><span class="line"><span class="keyword">å‡è®¾è¯¥åµŒå¥—åŒæ­¥ä»£ç å—å½“ä¸­è¿˜å­˜åœ¨æœ‰ä¸€ä¸ªåŒæ­¥ä»£ç å—ä¸”ä¾æ—§æ˜¯åŒæ ·çš„ä¸€æŠŠé”ï¼Œ</span></span><br><span class="line"><span class="keyword">é‚£ä¹ˆè¿™ä¸ª_recursionsè®¡æ•°å™¨å°±åˆä¼šæ‰§è¡ŒåŠ 1æ“ä½œï¼›</span></span><br><span class="line"><span class="keyword">æ¥ç€å¦‚æœå½“å‰çº¿ç¨‹å‡ºä¸€ä¸ªåŒæ­¥ä»£ç å—é‚£ä¹ˆè®¡æ•°å™¨_recursionså°±ä¼šå‡1ï¼›</span></span><br><span class="line"><span class="keyword">å†å‡ºä¸€ä¸ªåŒæ­¥ä»£ç å—_recursionså‡1ï¼›</span></span><br><span class="line"><span class="keyword">ç›´åˆ°_recursionså‡åˆ°0ä¸ºæ­¢å°±è¯´æ˜è¯¥çº¿ç¨‹å°±æŠŠè¯¥é”ç»™é‡Šæ”¾æ‰äº†ï¼›</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">_object: </span>å­˜å‚¨è¯¥monitorçš„å¯¹è±¡ï¼›</span><br><span class="line">å³è¯¥_objectä¼šè¿›è¡Œå­˜å‚¨<span class="keyword">javaå¯¹è±¡å³ </span><span class="keyword">synchronized(obj)&#123;&#125;ä¸­çš„objå¯¹è±¡ï¼›</span></span><br><span class="line"><span class="keyword">ä¹Ÿå°±æ˜¯è¯´æ˜¯ç›¸äº’å¼•ç”¨çš„ï¼›</span></span><br><span class="line"><span class="keyword">å³javaå¯¹è±¡å½“ä¸­çš„objä¼šå¼•ç”¨monitorå¯¹è±¡ï¼›è€Œmonitorå¯¹è±¡ä¸­çš„æˆå‘˜å˜é‡å±æ€§_objectå–å€¼ä¹Ÿä¼šå¼•ç”¨ç€javaå¯¹è±¡ï¼›</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">_owner: </span>æŒ‡çš„æ˜¯æ ‡è¯†æ‹¥æœ‰è¯¥monitorçš„çº¿ç¨‹ï¼ˆå³æŒ‡çš„å°±æ˜¯çº¿ç¨‹çš„æ‹¥æœ‰è€…ï¼‰</span><br><span class="line">å‡è®¾çº¿ç¨‹AæŠ¢åˆ°é”è¿›å…¥åˆ°äº†åŒæ­¥ä»£ç å—å½“ä¸­æ¥äº†ï¼›</span><br><span class="line">é‚£ä¹ˆåˆ°æ—¶å€™ObjectMonitorå½“ä¸­çš„_owneræ‰€æŒ‡çš„å°±æ˜¯å½“å‰è¯¥çº¿ç¨‹Aï¼›</span><br><span class="line"></span><br><span class="line"><span class="symbol">_WaitSet:</span> å¤„äº<span class="keyword">waitçŠ¶æ€çš„çº¿ç¨‹ï¼Œä¼šè¢«åŠ å…¥åˆ°_WaitSet</span></span><br><span class="line"><span class="keyword">Waitæ˜¯ç­‰å¾…çš„æ„æ€ï¼›Setä»£è¡¨é›†åˆï¼›</span></span><br><span class="line"><span class="keyword">WaitSetæ˜¯ç”¨æ¥å­˜æ”¾å¤„äºwaitçŠ¶æ€çš„çº¿ç¨‹çš„é›†åˆ</span></span><br><span class="line"><span class="keyword">æ¯”å¦‚è¯´ï¼Œå½“å‰çº¿ç¨‹Aè·å–å¾—åˆ°é”ä¹‹åä»è€Œè¿›å…¥åŒæ­¥ä»£ç å—æ‰§è¡ŒåŒæ­¥ä»£ç å—ä¸­çš„ä»£ç ï¼›</span></span><br><span class="line"><span class="keyword">æ‰§è¡Œobj.wait()æ–¹æ³•ï¼›é‚£ä¹ˆå½“å‰è¯¥é”ä½å°±å°†è¿›å…¥æ— é™çš„ç­‰å¾…ä¸­ï¼›</span></span><br><span class="line"><span class="keyword">é‚£ä¹ˆæ— é™ç­‰å¾…çš„çº¿ç¨‹å°±ä¼šè¢«æ”¾ç½®åœ¨_WaitSeté›†åˆå½“ä¸­å»ï¼›</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">_cxq: </span>å¤šä¸ªçº¿ç¨‹åœ¨ç«äº‰é”æ—¶çš„å•å‘åˆ—è¡¨ï¼›</span><br><span class="line">å‡è®¾å½“å‰æœ‰ä¸€ä¸ª<span class="built_in">t1</span>çº¿ç¨‹è¿›å…¥åˆ°åŒæ­¥ä»£ç å—å½“ä¸­ï¼›</span><br><span class="line">ç”±äº<span class="built_in">t1</span>çº¿ç¨‹æ˜¯ç¬¬ä¸€æ¬¡å…ˆè¿›å…¥åŒæ­¥ä»£ç å—å½“ä¸­æ¥çš„ï¼›</span><br><span class="line">æ‰€ä»¥æŠ¢å¾—åˆ°é”ä»è€Œè¿›å…¥åŒæ­¥ä»£ç å—ï¼›</span><br><span class="line">å‡è®¾åˆæ¥äº†å¦å¤–ä¸€ä¸ªçº¿ç¨‹å³<span class="built_in">t2</span>çº¿ç¨‹ï¼›</span><br><span class="line">é‚£ä¹ˆ<span class="built_in">t2</span>çº¿ç¨‹æ˜¯æ²¡æœ‰æŠ¢åˆ°é”çš„ï¼›</span><br><span class="line">é‚£ä¹ˆæ²¡æœ‰æŠ¢åˆ°é”çš„çº¿ç¨‹ä¾æ—§è¦ç­‰å¾…ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™äº›æ²¡æœ‰æŠ¢åˆ°é”çš„çº¿ç¨‹å»å“ªé‡Œè¿›è¡Œç­‰å¾…ï¼›</span><br><span class="line">æˆ–è€…è¯´ç”¨ä»€ä¹ˆæ¥è¿›è¡Œä¿å­˜è¿™äº›æ­£åœ¨ç­‰å¾…çš„çº¿ç¨‹å‘¢ï¼Ÿ</span><br><span class="line">å‡†å¤‡è¦ç­‰å¾…çš„çº¿ç¨‹ä¼šè¿›å…¥åˆ°_cxqè¯¥å˜é‡å½“ä¸­å»ï¼Œ_cxqæ˜¯ä¸€ä¸ªå•å‘åˆ—è¡¨ï¼›</span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶å‡å¦‚è¿˜æœ‰ä¸€ä¸ªçº¿ç¨‹è¿›æ¥å«åš<span class="built_in">t3</span>çº¿ç¨‹ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™ä¸ª<span class="built_in">t3</span>çº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç å—ä¹ŸæŠ¢ä¸åˆ°é”ï¼Œä¹Ÿä¼šå…ˆè¿›è¡Œè¿›å…¥è¿™ä¸ª_cxqå•å‘åˆ—è¡¨å½“ä¸­ï¼›</span><br><span class="line">å‡è®¾çº¿ç¨‹<span class="built_in">t1</span>å¾€ä¸‹ç»§ç»­è¿›è¡Œæ‰§è¡Œï¼›æ‰§è¡Œå®ŒåŒæ­¥ä»£ç å—é‚£ä¹ˆå°±ä¼šå°†é”è¿›è¡Œç»™é‡Šæ”¾æ‰äº†ï¼›</span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶å°±æœ‰å¯èƒ½æ˜¯ç”±çº¿ç¨‹<span class="built_in">t1</span>ã€<span class="built_in">t2</span>ã€<span class="built_in">t3</span>éƒ½æœ‰å¯èƒ½è·å–æŠ¢åˆ°é”ï¼›</span><br><span class="line">é‚£ä¹ˆè¿˜æ˜¯å‡è®¾çº¿ç¨‹<span class="built_in">t1</span>è¿›è¡ŒæŠ¢åˆ°äº†é”ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™å°±æ˜¯çº¿ç¨‹<span class="built_in">t1</span>ç¬¬äºŒæ¬¡æŠ¢åˆ°äº†é”ï¼›ä¹Ÿå°±æ˜¯<span class="built_in">t1</span>çº¿ç¨‹ç¬¬äºŒæ¬¡è¿›å…¥åŒæ­¥ä»£ç å—äº†ï¼›é‚£ä¹ˆè¿™ä¸ªæ—¶å€™<span class="built_in">t1</span>çº¿ç¨‹æ‹¿ç€é”è¿›å…¥åŒæ­¥ä»£ç å—å½“ä¸­ï¼›</span><br><span class="line">é‚£ä¹ˆä¸Šä¸€æ¬¡æ”¾åœ¨åœ¨ç­‰å¾…ä¸­çš„_cxqå•å‘åˆ—è¡¨ä¸­çš„ç­‰å¾…ä¸­çš„çº¿ç¨‹<span class="built_in">t2</span>ã€<span class="built_in">t3</span>æ­¤æ—¶å°±ä¼šè¿›å…¥åˆ°_EntryListå˜é‡å½“ä¸­å»ï¼›</span><br><span class="line"></span><br><span class="line"><span class="symbol">_EntryList:</span> å¤„äºç­‰å¾…é”<span class="keyword">blockçŠ¶æ€çš„çº¿ç¨‹ï¼Œä¼šè¢«åŠ å…¥åˆ°è¯¥åˆ—è¡¨</span></span><br><span class="line"><span class="keyword">å³å°±å¤„äºBLOCKçŠ¶æ€çš„çº¿ç¨‹å°±ä¼šè¢«æ·»åŠ å…¥åˆ°_EntryListå˜é‡å½“ä¸­æ¥ï¼›</span></span><br><span class="line"><span class="keyword">å‡è®¾t1åœ¨æ‰§è¡Œçš„æ—¶å€™ï¼Œè¿™ä¸ªæ—¶å€™åˆæ¥äº†ä¸€ä¸ªçº¿ç¨‹å«åšt4;</span></span><br><span class="line"><span class="keyword">é‚£ä¹ˆt4çº¿ç¨‹è¿›å…¥åŒæ­¥ä»£ç å—ç”±äºæ²¡æœ‰æŠ¢åˆ°é”ä¼šå…ˆè¿›å…¥_cxqå•å‘åˆ—è¡¨å½“ä¸­å»ï¼›</span></span><br><span class="line"><span class="keyword">å‡è®¾å†æ¥äº†ä¸€ä¸ªçº¿ç¨‹å«åšt5ï¼›é‚£ä¹ˆt5ä¹Ÿè¦æ‰§è¡ŒåŒæ­¥ä»£ç å—ä¹Ÿæ²¡æœ‰è·å–å¾—åˆ°é”ä»è€Œä¹Ÿä¼šè¢«æ”¾ç½®åˆ°_cxqå•å‘åˆ—è¡¨ä¸­å»ï¼›</span></span><br><span class="line"><span class="keyword">å‡è®¾t1çº¿ç¨‹æ‰§è¡Œå®Œæˆå‡ºäº†åŒæ­¥ä»£ç å—äº†ï¼›å‡è®¾t1åˆå†æ¬¡äº‰æŠ¢è·å–å¾—åˆ°é”è¿›å…¥äº†åŒæ­¥ä»£ç å—å½“ä¸­ï¼›é‚£ä¹ˆä¸Šä¸€æ¬¡åœ¨_cxqå•å‘åˆ—è¡¨ä¸­è¿›è¡Œç­‰å¾…çš„ä¸¤ä¸ªçº¿ç¨‹t4ã€t5å°±ä¼šè¿›å…¥åˆ°_EntryListå½“ä¸­å»ï¼›å³å˜ä¸ºBLOCKçŠ¶æ€ï¼›</span></span><br><span class="line"><span class="keyword">-----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">åˆ†æMonitorç»“æ„å›¾</span></span><br><span class="line"><span class="keyword">Monitorä¸»è¦ç”±ä¸‰ä¸ªç»„ä»¶è¿›è¡Œæ„æˆ: </span>_ownerã€_EntryListã€_WaitSet</span><br><span class="line">ç­‰å¾…ä¸€è½®ä¹‹åä¾æ—§æ²¡æœ‰æŠ¢åˆ°é”çš„çº¿ç¨‹è¢«æ”¾ç½®åˆ°_EntryListå½“ä¸­æ¥äº†ï¼›</span><br><span class="line">é‚£ä¹ˆè¿˜æœ‰å°±æ˜¯æ‰§è¡Œobj.<span class="keyword">wait()æ–¹æ³•çš„è¢«æ”¾ç½®æ”¾åˆ°_WaitSetå•é¡¹åˆ—è¡¨ä¸­å»ï¼›</span></span><br><span class="line"><span class="keyword">å½“çº¿ç¨‹æ‹¥æœ‰è€…åœ¨æ‰§è¡Œé‚£ä¹ˆæ‰§è¡Œå®Œå°±ä¼šå‡ºåŒæ­¥ä»£ç å—ï¼›</span></span><br><span class="line"><span class="keyword">é‚£ä¹ˆå½“çº¿ç¨‹æ‹¥æœ‰è€…åœ¨æ‰§è¡Œå®Œæˆå‡ºåŒæ­¥ä»£ç å—çš„æ—¶å€™</span></span><br><span class="line"><span class="keyword">æœ‰å¯èƒ½ä¼šæ˜¯_EntryListå½“ä¸­æ­£åœ¨é˜»å¡çš„çº¿ç¨‹ç«äº‰è·å–æ‹¿åˆ°é”å˜æˆmonitorå½“ä¸­çš„_ownerï¼›</span></span><br><span class="line"><span class="keyword">ä¹Ÿæœ‰å¯èƒ½ä¼šæ˜¯_WaitSetå½“ä¸­å¤„äºWaitçš„çº¿ç¨‹è¢«åˆ«çš„æ“ä½œæ‰€å”¤é†’äº†ï¼›</span></span><br><span class="line"><span class="keyword">é‚£ä¹ˆå®ƒä¹Ÿæœ‰å¯èƒ½ä¼šè·å¾—é”å˜æˆçº¿ç¨‹çš„userå³monitorç»“æ„ä¸­çš„_ownerï¼›</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">ç«äº‰åˆ°é”çš„çº¿ç¨‹ã€å¤„äºé˜»å¡çŠ¶æ€çš„çº¿ç¨‹ã€å¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼›</span></span><br></pre></td></tr></table></figure><ol><li>_owner: åˆå§‹åŒ–ä¸ºNUllï¼Œå½“æœ‰çº¿ç¨‹å æœ‰è¯¥monitoræ—¶ï¼Œowneræ ‡è®°ä¸ºè¯¥çº¿ç¨‹çš„å”¯ä¸€è¡¨ç¤ºã€‚å½“çº¿ç¨‹é‡Šæ”¾monitoræ—¶ï¼Œowneråˆæ¢å¤åˆ°NULLã€‚owneræ˜¯ä¸€ä¸ªä¸´ç•Œèµ„æºï¼ŒJVMæ˜¯é€šè¿‡CASæ“ä½œæ¥ä¿è¯å…¶çº¿ç¨‹å®‰å…¨çš„ã€‚</li><li>_cxq: ç«äº‰é˜Ÿåˆ—ï¼Œæ‰€æœ‰è¯·æ±‚é”çš„çº¿ç¨‹é¦–å…ˆä¼šè¢«æ”¾åœ¨è¿™ä¸ªé˜Ÿåˆ—ä¸­ï¼ˆå•å‘é“¾æ¥ï¼‰ã€‚_cxqæ˜¯ä¸€ä¸ªä¸´ç•Œèµ„æºï¼ŒJVMé€šè¿‡CASåŸå­æŒ‡ä»¤æ¥ä¿®æ”¹_cxqé˜Ÿåˆ—ã€‚ ä¿®æ”¹å‰ _cxqçš„æ—§å€¼ å¡«å…¥äº† nodeçš„nextå­—æ®µï¼Œ _cxqæŒ‡å‘æ–°å€¼ï¼ˆæ–°çº¿ç¨‹ï¼‰ã€‚å› æ­¤ _cxqæ˜¯ä¸€ä¸ªåè¿›å…ˆå‡ºçš„stack(æ ˆ)ã€‚</li><li>_EntryList: _cxqé˜Ÿåˆ—ä¸­ æœ‰èµ„æ ¼æˆä¸º å€™é€‰èµ„æºçš„ çº¿ç¨‹ ä¼šè¢«ç§»åŠ¨åˆ°è¯¥é˜Ÿåˆ—ä¸­ã€‚</li><li>_WaitSet: å› ä¸ºè°ƒç”¨waitæ–¹æ³•è€Œè¢«é˜»å¡çš„ çº¿ç¨‹ä¼šè¢«æ”¾åœ¨è¯¥é˜Ÿåˆ—ä¸­ã€‚</li></ol><p>æ¯ä¸€ä¸ªjavaå¯¹è±¡éƒ½å¯ä»¥ä¸ä¸€ä¸ªç›‘è§†å™¨ monitorå…³è”ï¼Œ<br>å¯ä»¥æŠŠå®ƒç†è§£æˆä¸ºä¸€æŠŠé”ï¼Œ<br>å½“ä¸€ä¸ªçº¿ç¨‹æƒ³è¦æ‰§è¡Œä¸€æ®µè¢«synchronizedåœˆèµ·æ¥çš„åŒæ­¥æ–¹æ³•æˆ–è€…ä»£ç å—æ—¶ï¼Œ<br>è¯¥çº¿ç¨‹å¾— å…ˆè·å–åˆ° synchronizedä¿®é¥°çš„å¯¹è±¡ å¯¹åº”çš„monitorã€‚</p><p>javaä»£ç é‡Œä¸ä¼š æ˜¾å¼åœ°å»åˆ›é€ è¿™ä¹ˆä¸€ä¸ª monitorå¯¹è±¡ï¼Œ<br>ä¹Ÿæ— éœ€åˆ›å»ºï¼Œ<br>äº‹å®ä¸Šå¯ä»¥è¿™ä¹ˆç†è§£ï¼š<br>monitorå¹¶ä¸æ˜¯éšç€å¯¹è±¡åˆ›å»ºè€Œåˆ›å»ºçš„ã€‚<br>æ˜¯é€šè¿‡ synchronized ä¿®é¥°ç¬¦ å‘Šè¯‰ JVM éœ€è¦ä¸º æŸä¸ªå¯¹è±¡åˆ›å»ºå…³è”çš„ monitorå¯¹è±¡ã€‚<br>æ¯ä¸ªçº¿ç¨‹éƒ½å­˜åœ¨ä¸¤ä¸ªObjectMonitorå¯¹è±¡åˆ—è¡¨ï¼Œåˆ†åˆ«ä¸º freeå’Œ usedåˆ—è¡¨ã€‚<br>åŒæ—¶JVMä¸­ä¹Ÿç»´æŠ¤ç€ global locklistã€‚<br>å½“çº¿ç¨‹éœ€è¦ ObjectMonitorå¯¹è±¡æ—¶ï¼Œé¦–å…ˆä»çº¿ç¨‹è‡ªèº«çš„freeè¡¨ä¸­ç”³è¯·ï¼Œè‹¥å­˜åœ¨åˆ™ä½¿ç”¨ï¼Œè‹¥ä¸å­˜åœ¨åˆ™ä» globallist ä¸­ç”³è¯·ã€‚</p><p>ObjectMonitor çš„æ•°æ®ç»“æ„åŒ…å«ä¸‰ç§é˜Ÿåˆ—ï¼š _cxqã€_WaitSetå’Œ _EntryListï¼Œä»–ä»¬ä¹‹é—´çš„å…³ç³»è½¬æ¢å¯ä»¥ç”¨ä¸‹å›¾è¡¨ç¤ºï¼š</p><h2 id="æ·±å…¥JVMæºç -monitorç«äº‰"><a href="#æ·±å…¥JVMæºç -monitorç«äº‰" class="headerlink" title="æ·±å…¥JVMæºç -monitorç«äº‰"></a>æ·±å…¥JVMæºç -monitorç«äº‰</h2><p>monitorç«äº‰<br>monitorå¯¹è±¡ç›‘è§†å™¨é”ç«äº‰çš„è¿‡ç¨‹ï¼›</p><p>synchronizedä¸ºä»€ä¹ˆæ˜¯é‡é‡çº§é”ï¼Œä¸ºä»€ä¹ˆå¼€é”€æ¯”è¾ƒå¤§ï¼Ÿ<br>synchronizedæ˜¯é‡é‡çº§çš„é”ï¼Œæ•ˆç‡ä¸é«˜ã€‚<br>synchronizedçš„ä¼˜åŒ–æ¶‰åŠåˆ°ä¸€ä¸ªå«åšCASçš„æ“ä½œã€‚<br>CASä¹Ÿå±äºä¸€ä¸ªåŸå­æ“ä½œï¼Œå¯ä»¥å°†å…¶çœ‹åšæ˜¯ä¸€ä¸ªè½»é‡çº§çš„synchronizedã€‚</p><h3 id="ç›®æ ‡-13"><a href="#ç›®æ ‡-13" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>åˆ†ä¸¤æ­¥<br>ç¬¬ä¸€æ­¥ï¼›äº†è§£ä½•æ—¶ä¼šå‡ºç°monitorç«äº‰ï¼Ÿ<br>ç¬¬äºŒæ­¥ï¼šmonitoræ˜¯å¦‚ä½•ç«äº‰çš„ï¼Ÿ</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">javaä»£ç ä¸¾ä¾‹ï¼š</span><br><span class="line">----------------------------------------</span><br><span class="line">public static void main(String[] args)&#123;</span><br><span class="line"><span class="code">  synchronized(obj)&#123;</span></span><br><span class="line"><span class="code">    System.out.println("1");</span></span><br><span class="line"><span class="code">  &#125;</span></span><br><span class="line">&#125;</span><br><span class="line">----------------------------------------</span><br><span class="line">å‡è®¾æœ‰ä¸€ä¸ªt1çº¿ç¨‹ï¼›å†æ¥ä¸€ä¸ªt2çº¿ç¨‹ï¼›</span><br><span class="line">å¯èƒ½è¿™ä¸¤ä¸ªçº¿ç¨‹t1ã€t2éƒ½ä¼šæ¥è¿›è¡Œæ‰§è¡ŒåŒæ­¥ä»£ç å—synchronized(obj)&#123;ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±ä¼šå¤„äºmonitorç«äº‰çŠ¶æ€ï¼›</span><br><span class="line">çº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç å—å°±ä¼šå‡ºç°ç«äº‰çš„ç°è±¡ï¼›</span><br><span class="line">ä¹‹å‰åæ±‡ç¼–javapçœ‹åˆ°synchronizedä¼šå˜æˆä¸¤æ¡å­—èŠ‚ç æŒ‡ä»¤monitorenterä»¥åŠmonitorexitï¼›</span><br><span class="line">å½“çº¿ç¨‹è¿›å…¥åŒæ­¥ä»£ç å—synchronizedæ—¶ä¼šæ‰§è¡Œmonitorenterå­—èŠ‚ç æŒ‡ä»¤ï¼›</span><br><span class="line">å½“çº¿ç¨‹æ‰§è¡Œå®ŒåŒæ­¥ä»£ç å—ä¸­çš„å†…å®¹å³é€€å‡ºåŒæ­¥ä»£ç å—æ—¶ä¼šæ‰§è¡Œmonitorexitå­—èŠ‚ç æŒ‡ä»¤ï¼›</span><br><span class="line">è¿™ä¸ªmonitorenterå­—èŠ‚ç æŒ‡ä»¤æœ€ç»ˆä¼šè°ƒç”¨åˆ°InterpreterRuntime.cppä»£ç ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼›</span><br></pre></td></tr></table></figure><ol><li>æ‰§è¡Œ monitorenteræ—¶ï¼Œä¼šè°ƒç”¨ InterpreterRuntime.cpp<br>ï¼ˆä½äºï¼šsrc/share/vm/interpreterRuntime.cppï¼‰çš„InterpreterRuntime::monitorenter å‡½æ•°ã€‚</li></ol><p>å…·ä½“ä»£ç å¯å‚è§ HotSpotæºç ã€‚</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"># æˆªå–çš„éƒ¨åˆ†ä»£ç </span><br><span class="line"><span class="constructor">IRT_ENTRY_NO_ASYNC(<span class="params">void</span>, InterpreterRuntime:<span class="params">monitorenter</span>(JavaThread<span class="operator">*</span>  <span class="params">thread</span>, BasicObjectLock<span class="operator">*</span> <span class="params">elem</span>)</span>)</span><br><span class="line">#ifdef ASSERT</span><br><span class="line">  thread-&gt;last<span class="constructor">_frame()</span>.interpreter<span class="constructor">_frame_verify_monitor(<span class="params">elem</span>)</span>;</span><br><span class="line">#endif</span><br><span class="line">  <span class="keyword">if</span>(PrintBiasedLockingStatistics)&#123;</span><br><span class="line">    Atomic::inc(BiasedLocking::slow<span class="constructor">_path_entry_count_addr()</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  Handle h<span class="constructor">_obj(<span class="params">thread</span>, <span class="params">elem</span>-&gt;<span class="params">obj</span>()</span>);</span><br><span class="line">  <span class="keyword">assert</span>(Universe::heap<span class="literal">()</span>-&gt;is<span class="constructor">_in_reserved_or_null(<span class="params">h_obj</span>()</span>),</span><br><span class="line">          <span class="string">"must be NULL or an object"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">  é‡ç‚¹ä»£ç if()&#123;&#125;else&#123;&#125;å—</span></span><br><span class="line"><span class="comment">  UseBiasedLockingæ˜¯ä¸æ˜¯ä½¿ç”¨äº†åå‘é”ï¼›</span></span><br><span class="line"><span class="comment">  è¿™ä¸ªUseBiasedLockingæ¡ä»¶å…¶å®æ˜¯JVMå¯ä»¥è¿›è¡Œè®¾ç½®çš„ä¸€ä¸ªå¯åŠ¨å‚æ•°ï¼›</span></span><br><span class="line"><span class="comment">  å¦‚æœè¿›è¡Œè®¾ç½®äº†å¯ç”¨åå‘é”é‚£ä¹ˆå°±ä¼šèµ°if()&#123;&#125;å—å½“ä¸­çš„ä»£ç ï¼›</span></span><br><span class="line"><span class="comment">  å¦‚æœæ²¡æœ‰è®¾ç½®å¯ç”¨åå‘é”é‚£ä¹ˆåˆ™ä¼šèµ°else&#123;&#125;å—ä¸­çš„ä»£ç ï¼›</span></span><br><span class="line"><span class="comment">  ä¹Ÿå°±æ˜¯æ‰€è¦åˆ†æçš„monitoré‡é‡çº§é”çš„è¿‡ç¨‹å«åšslow_enteræ…¢è¿›å…¥ï¼›</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">if</span>(UseBiasedLocking)&#123;</span><br><span class="line">    <span class="comment">//Retry fast entry if bias is revoked to avoid unnecessary inflation</span></span><br><span class="line">    ObjectSynchronizer::fast<span class="constructor">_entry(<span class="params">h_obj</span>, <span class="params">elem</span>-&gt;<span class="params">lock</span>()</span>, <span class="literal">true</span>, CHECK);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    ObjectSynchronizer::slow<span class="constructor">_enter(<span class="params">h_obj</span>, <span class="params">elem</span>-&gt;<span class="params">lock</span>()</span>, CHECK);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">assert</span>(Universe::heap<span class="literal">()</span>-&gt;is<span class="constructor">_in_reserved_or_null(<span class="params">elem</span>-&gt;<span class="params">obj</span>)</span>),</span><br><span class="line">          <span class="string">"must be NULL or an object"</span>);</span><br></pre></td></tr></table></figure><ol start="2"><li>å¯¹äºé‡é‡çº§é”ï¼Œmonitorenterçš„å‡½æ•°ä¸­(slow_enteræœ€ç»ˆ)ä¼šè°ƒç”¨ObjectSynchronizer::slow_enter</li><li>æœ€ç»ˆè°ƒç”¨ ObjectMonitor::enterï¼ˆå¯¹è±¡ç›‘è§†å™¨é”monitorçš„enteræ–¹æ³•ï¼Œè¯´æ˜è¿˜æ˜¯è¦å›åˆ°ObjectMonitor.cppï¼‰<br>(ä½äºï¼šsrc/share/vm/runtime/objectMonitor.cpp)ï¼Œæºç å¦‚ä¸‹ï¼š</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">void ATTR ObjectMonitor::enter(TRAPS)&#123;</span><br><span class="line">  <span class="comment">// The following code is ordered to check the most common cases first</span></span><br><span class="line">  <span class="comment">// and to reduce RTS-&gt;RTO cache line upgrades on SPARC and IA32 processors.</span></span><br><span class="line">  Thread * <span class="keyword">const</span> <span class="keyword">Self</span> = THREAD;</span><br><span class="line">  void * cur ;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">  é€šè¿‡ CAS æ“ä½œå°è¯•æŠŠ monitor çš„ _owner å­—æ®µè®¾ç½®ä¸ºå½“å‰çº¿ç¨‹</span></span><br><span class="line"><span class="comment">  åœ¨ObjectMonitor::enterè¿›å…¥çš„æ—¶å€™ä¼šè°ƒç”¨Actomicå½“ä¸­çš„cmpxchg_ptrï¼›</span></span><br><span class="line"><span class="comment">  Atomic::cmpxchg_ptr(Self, &amp;_owner, NULL)</span></span><br><span class="line"><span class="comment">  è¯¥å‡½æ•°å±äºlinuxç³»ç»Ÿå†…å­˜å½“ä¸­çš„ä¸€ä¸ªå‡½æ•°æœ€ç»ˆä¼šä¾èµ–CPUå»åšåŸå­èµ‹å€¼æ“ä½œï¼›</span></span><br><span class="line"><span class="comment">  CASæ˜¯ä¸€ä¸ªåŸå­çš„èµ‹å€¼æ“ä½œï¼›</span></span><br><span class="line"><span class="comment">  ä½œç”¨å°±æ˜¯å°†monitorå¯¹è±¡å½“ä¸­çš„_ownerè®¾ç½®æˆè¿™ä¸ªå½“å‰çº¿ç¨‹Selfï¼›</span></span><br><span class="line"><span class="comment">  çœ‹å…¶æ˜¯å¦èƒ½å¤Ÿè®¾ç½®æˆåŠŸ</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  cur = Atomic::cmpxchg_ptr(<span class="keyword">Self</span>, &amp;_owner, <span class="keyword">NULL</span>);</span><br><span class="line">  <span class="keyword">if</span>(cur == <span class="keyword">NULL</span>)&#123;</span><br><span class="line">    <span class="comment">// Either ASSERT _recursions == 0 or explicitly Set _recursions = 0.</span></span><br><span class="line">    assert (_recursions == <span class="number">0</span> ,   <span class="string">"invariant"</span>) ;</span><br><span class="line">    assert (_owner      == <span class="keyword">Self</span>, <span class="string">"invariant"</span>) ;</span><br><span class="line">    <span class="comment">// CONSIDER: set or assert OwnerIsThread == 1</span></span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">//çº¿ç¨‹é‡å…¥ï¼›recursions++</span></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">    å¦‚æœä¸Šä¸€æ­¥éª¤å½“ä¸­è®¾ç½®monitorå¯¹è±¡ä¸­çš„_ownerè®¾ç½®æˆå½“å‰è¿™ä¸ªçº¿ç¨‹SelfæˆåŠŸï¼›</span></span><br><span class="line"><span class="comment">    å¹¶ä¸”å½“å‰çº¿ç¨‹Selfçš„çº¿ç¨‹åå­—ï¼Œå³ä¹‹å‰çš„_ownerä¿å­˜çš„çº¿ç¨‹å°±æ˜¯å½“å‰çº¿ç¨‹Selfçš„çº¿ç¨‹çš„åå­—ï¼Œå³åç§°ä¸€è‡´çš„è¯ï¼›</span></span><br><span class="line"><span class="comment">    é‚£ä¹ˆè¿™æ ·å°±æ„å‘³ç€é”é‡å…¥ï¼›å³é‡æ–°åˆè¿›å…¥äº†ä¸€ä¸ªä»£ç å—æœ‰è·å–å¾—åˆ°äº†åŒä¸€æŠŠé”ï¼›</span></span><br><span class="line"><span class="comment">    é‚£ä¹ˆè¿™ä¸ªæ—¶å€™è¿›è¡Œmonitorå¯¹è±¡å½“ä¸­çš„_recursionså˜é‡è¿›è¡Œ++æ“ä½œï¼Œå³è¯¥çº¿ç¨‹çš„é‡å…¥æ¬¡æ•°ï¼›å¹¶ä¸”return;</span></span><br><span class="line"><span class="comment">    è¯´æ˜å½“å‰çº¿ç¨‹ç«äº‰åˆ°è¯¥é”ï¼›</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">if</span>(cur == <span class="keyword">Self</span>)&#123;</span><br><span class="line">    <span class="comment">// TODO-<span class="doctag">FIXME:</span> : check for integer overflow! BUGID 6557169</span></span><br><span class="line">    _recursions ++;</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">å¦‚æœå½“å‰çº¿ç¨‹ç¬¬ä¸€æ¬¡æ¥æŠ¢monitorè¯¥é”ï¼›</span></span><br><span class="line"><span class="comment">å¦‚æœå½“å‰çº¿ç¨‹æ˜¯ç¬¬ä¸€æ¬¡è¿›å…¥è¯¥monitorï¼Œå¦‚æœæŠ¢åˆ°é”äº†ï¼›</span></span><br><span class="line"><span class="comment">è®¾ç½®_recursionsä¸º1ï¼Œå¹¶ä¸”å°†_ownerè®¾ç½®ä¸ºå½“å‰çº¿ç¨‹ï¼›</span></span><br><span class="line"><span class="comment">æœ€åè¿”å›å³è¡¨ç¤ºå½“å‰çº¿ç¨‹ç«äº‰åˆ°è¯¥é”ï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">Self</span> -&gt; is_lock_owned((address)cur))&#123;</span><br><span class="line">  assert (_recursions == <span class="number">0</span>, <span class="string">"internal state error"</span>);</span><br><span class="line">  _recursions = <span class="number">1</span>;</span><br><span class="line">  <span class="comment">// Commute error from a thread-specific on-stack BasicLockObject address to</span></span><br><span class="line">  <span class="comment">// a full-fledged "Thread *".</span></span><br><span class="line">  _owner = <span class="keyword">Self</span>;</span><br><span class="line">  OwnerIsThread = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// çœç•¥ä¸€äº›ä»£ç </span></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆå¦‚æœç»è¿‡ä»¥ä¸Šæ“ä½œå½“å‰çº¿ç¨‹éƒ½æ²¡æœ‰æŠ¢åˆ°é”çš„è¯ï¼›</span></span><br><span class="line"><span class="comment">  åˆ™å°±å°†è¿›å…¥åˆ°è¯¥forå¾ªç¯å½“ä¸­ï¼›</span></span><br><span class="line"><span class="comment">  å‡è®¾ç¬¬ä¸€ä¸ªçº¿ç¨‹t1æŠ¢åˆ°é”è¿›å…¥åˆ°äº†åŒæ­¥ä»£ç å—å½“ä¸­ï¼›</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆç¬¬äºŒä¸ªçº¿ç¨‹t2å°±ç”±äºt1çº¿ç¨‹å·²ç»æŠ¢åˆ°é”ä¸”å½“å‰æ—¶é—´å†…æ²¡æœ‰è¿›è¡Œé‡Šæ”¾é”çš„ç¼˜æ•…ç¬¬äºŒä¸ªçº¿ç¨‹æ²¡æœ‰æŠ¢åˆ°é”ï¼›</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆæŠ¢ä¸åˆ°é”çš„ç¬¬äºŒä¸ªçº¿ç¨‹t2å°±ä¼šæ‰§è¡Œæ–¹æ³•EnterI(THREAD)ï¼›</span></span><br><span class="line"><span class="comment">  æœ€ç»ˆè¿›å…¥åˆ°monitorå¯¹è±¡çš„æˆå‘˜å˜é‡_cxqå•å‘åˆ—è¡¨å½“ä¸­è¿›è¡Œç­‰å¾…è·å–é”ï¼›</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">for</span> (;;)&#123;</span><br><span class="line">    jt-&gt;set_suspend_equivalent();</span><br><span class="line">    <span class="comment">// cleared by handle_special_suspend_equivalent_condition()</span></span><br><span class="line">    <span class="comment">// or java_suspend_self()</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœè·å–é”å¤±è´¥ï¼Œåˆ™ç­‰å¾…é”çš„é‡Šæ”¾</span></span><br><span class="line">    EnterI(THREAD);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!ExitSuspendEquivalent(jt)) <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// we have acquired the contended monitor, but while we were</span></span><br><span class="line">    <span class="comment">// waiting another thread suspended us. We don't want to enter</span></span><br><span class="line">    <span class="comment">// the monitor while suspend because that would surprise the</span></span><br><span class="line">    <span class="comment">// thread that suspended us.</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">      _recursions = <span class="number">0</span>;</span><br><span class="line">    _succ = <span class="keyword">NULL</span>;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="keyword">false</span>, <span class="keyword">Self</span>);</span><br><span class="line"></span><br><span class="line">    jt-&gt;java_suspend_self();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">Self</span>-&gt;set_current_pending_monitor(<span class="keyword">NULL</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤å¤„çœç•¥<strong>é”çš„è‡ªæ—‹ä¼˜åŒ–</strong>ç­‰æ“ä½œï¼Œç»Ÿä¸€æ”¾åœ¨åé¢<strong>synchronizedä¼˜åŒ–</strong>ä¸­è¯´ã€‚<br>ä»¥ä¸Šä»£ç çš„å…·ä½“æµç¨‹æ¦‚æ‹¬å¦‚ä¸‹ï¼š</p><p><strong>1ã€</strong> é€šè¿‡ CAS å°è¯•æŠŠmonitorçš„ _ownerå­—æ®µè®¾ç½®ä¸ºå½“å‰çº¿ç¨‹ï¼ˆå³æŠŠmonitorçš„_owneræˆå‘˜å˜é‡çš„å±æ€§å–å€¼è®¾ç½®ä¸ºç«äº‰çš„è¯¥çº¿ç¨‹ï¼›å¦‚æœè®¾ç½®æˆåŠŸåˆ™è¯´æ˜è¯¥çº¿ç¨‹ç«äº‰åˆ°äº†é”ï¼‰<br><strong>2ã€</strong> å¦‚æœè®¾ç½®ä¹‹å‰çš„_owneræŒ‡å‘å½“å‰çº¿ç¨‹ï¼Œè¯´æ˜å½“å‰çº¿ç¨‹å†æ¬¡è¿›å…¥monitorï¼Œå³é‡å…¥é”ï¼Œæ‰§è¡Œrecursions++ï¼Œè®°å½•é‡å…¥çš„æ¬¡æ•°ï¼›ï¼ˆå¦‚æœåœ¨è¿™ä¹‹å‰çš„ä¸Šä¸€æ¬¡ç«äº‰å½“å‰çº¿ç¨‹è·å–å¾—åˆ°äº†è¯¥é”ï¼Œé‚£ä¹ˆç°åœ¨å½“æ¬¡ç«äº‰å½“å‰çº¿ç¨‹åˆç«äº‰åˆ°äº†è¯¥é”ï¼›ä¸¤æŠŠé”ä¸€æ ·ï¼›é‚£ä¹ˆè¯´æ˜æ˜¯é”é‡å…¥ï¼›ï¼‰<br><strong>3ã€</strong> å¦‚æœå½“å‰çº¿ç¨‹æ˜¯ç¬¬ä¸€æ¬¡è¿›å…¥è¯¥monitorï¼Œè®¾ç½®recursionsä¸º1ï¼Œ_ownerä¸ºå½“å‰çº¿ç¨‹ï¼Œè¯¥çº¿ç¨‹æˆåŠŸè·å¾—é”å¹¶è¿”å›ã€‚<br><strong>4ã€</strong> å¦‚æœè·å–é”å¤±è´¥ï¼Œåˆ™ç­‰å¾…é”çš„é‡Šæ”¾(è¿›å…¥é˜»å¡ç­‰å¾…çŠ¶æ€ï¼Œå³è¿›å…¥åˆ°monitorå¯¹è±¡çš„æˆå‘˜å˜é‡_cxqå•å‘åˆ—è¡¨é˜Ÿåˆ—)ï¼›</p><h2 id="æ·±å…¥JVMæºç -monitorç­‰å¾…"><a href="#æ·±å…¥JVMæºç -monitorç­‰å¾…" class="headerlink" title="æ·±å…¥JVMæºç -monitorç­‰å¾…"></a>æ·±å…¥JVMæºç -monitorç­‰å¾…</h2><h3 id="å›é¡¾å¹¶å¼•å…¥"><a href="#å›é¡¾å¹¶å¼•å…¥" class="headerlink" title="å›é¡¾å¹¶å¼•å…¥"></a>å›é¡¾å¹¶å¼•å…¥</h3><p>å½“å‰åœ¨ç«äº‰monitorå¯¹è±¡é”çš„æ—¶å€™ä¼šå‘ç°ï¼›<br>æœ‰ä¸€ä¸ªçº¿ç¨‹ä¼šç«äº‰åˆ°monitorå¹¶ä¸”è®©çº¿ç¨‹æ¥ç€å¾€ä¸‹æ‰§è¡Œï¼›<br>ä½†æ˜¯æœ‰ä¸€äº›çº¿ç¨‹ç«äº‰ä¸åˆ°monitoré‚£ä¹ˆè¿™ä¸ªæ—¶å€™å®ƒä¼šæ‰§è¡ŒEnterI(THREAD)è¿™ä¸ªå‡½æ•°ï¼›<br>ä¹Ÿå°±æ˜¯è¯´æ²¡æœ‰æŠ¢åˆ°é”çš„çº¿ç¨‹ä¼šè¿›å…¥ç­‰å¾…å¤„äºé˜»å¡çŠ¶æ€ï¼›<br>é‚£ä¹ˆæ¥ä¸‹æ¥ä¹Ÿå°±æ˜¯å­¦ä¹ monitorç­‰å¾…è¿‡ç¨‹ï¼›ä¹Ÿå°±æ˜¯EnterI(THREAD)æ–¹æ³•ï¼›</p><p>monitorç­‰å¾…</p><p>ç«äº‰å¤±è´¥ç­‰å¾…è°ƒç”¨çš„æ˜¯ ObjectMonitorå¯¹è±¡çš„EnterI(THREAD)æ–¹æ³•<br>ï¼ˆä½äºï¼š/src/share/vm/runtime/ObjectMonitor.cppï¼‰ï¼Œ<br>æºç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æˆªå–éƒ¨åˆ†ä»£ç åˆ†æ</span></span><br><span class="line">void ATTR ObjectMonitor::EnterI(THREAD)&#123;</span><br><span class="line">  Thread * <span class="keyword">Self</span> = THREAD;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Try the lock - TATAS</span></span><br><span class="line">  <span class="keyword">if</span>(TryLock (<span class="keyword">Self</span>) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">    assert (_succ        != <span class="keyword">Self</span>              , <span class="string">"invariant"</span>);</span><br><span class="line">    assert (_owner       == <span class="keyword">Self</span>              , <span class="string">"invariant"</span>);</span><br><span class="line">    assert (_Responsible != <span class="keyword">Self</span>              , <span class="string">"invariant"</span>);</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(TrySpin (<span class="keyword">Self</span>) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">    assert (_succ        == <span class="keyword">Self</span>              , <span class="string">"invariant"</span>);</span><br><span class="line">    assert (_owner       != <span class="keyword">Self</span>              , <span class="string">"invariant"</span>);</span><br><span class="line">    assert (_Responsible != <span class="keyword">Self</span>              , <span class="string">"invariant"</span>);</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// çœç•¥éƒ¨åˆ†ä»£ç </span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// å½“å‰çº¿ç¨‹è¢«å°è£…æˆObjectWaiterå¯¹è±¡nodeï¼ŒçŠ¶æ€è®¾ç½®æˆObjectWaiter::TS_CXQ</span></span><br><span class="line">  ObjectWaiter node(<span class="keyword">Self</span>);</span><br><span class="line">  <span class="keyword">Self</span>-&gt;ParkEvent-&gt;reset();</span><br><span class="line">  node._prev  = (ObjectWaiter *) <span class="number">0xBAD</span>;</span><br><span class="line">  node.TState = ObjectWaiter::TS_CXQ;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// é€šè¿‡CASæŠŠnodeèŠ‚ç‚¹pushåˆ°_cxqåˆ—è¡¨ä¸­</span></span><br><span class="line">  ObjectWaiter * nxt;</span><br><span class="line">  <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">    node._next = next = _cxq;</span><br><span class="line">    <span class="keyword">if</span>(Atomic::cmpxchg_ptr(&amp;node, &amp;_cxq, nxt) == nxt) <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Interference - the CAS failed because _cxq changed. Just retry.</span></span><br><span class="line">    <span class="comment">// As an optional optimization we retry the lock.</span></span><br><span class="line">    <span class="keyword">if</span>(TryLock(<span class="keyword">Self</span>) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(TryLock (<span class="keyword">Self</span>) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">          assert (_succ        != <span class="keyword">Self</span>              , <span class="string">"invariant"</span>);</span><br><span class="line">          assert (_owner       == <span class="keyword">Self</span>              , <span class="string">"invariant"</span>);</span><br><span class="line">          assert (_Responsible != <span class="keyword">Self</span>              , <span class="string">"invariant"</span>);</span><br><span class="line">          <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// çœç•¥éƒ¨åˆ†ä»£ç </span></span><br><span class="line">      <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">        <span class="comment">// çº¿ç¨‹åœ¨æŒ‚èµ·å‰åšä¸€ä¸‹æŒ£æ‰ï¼Œçœ‹èƒ½ä¸èƒ½è·å–åˆ°é”</span></span><br><span class="line">        <span class="keyword">if</span>(TryLock (<span class="keyword">Self</span>) &gt; <span class="number">0</span>)<span class="keyword">break</span>;</span><br><span class="line">        assert (_owner != <span class="keyword">Self</span>, <span class="string">"inveriant"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>((SyncFlags &amp; <span class="number">2</span>) &amp;&amp; _Reponsible == <span class="keyword">NULL</span>)&#123;</span><br><span class="line">          Atomic::cmpxchg_ptr (<span class="keyword">Self</span>, &amp;_Reponsible, <span class="keyword">NULL</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// park self</span></span><br><span class="line">        <span class="keyword">if</span>(_Responsible == <span class="keyword">Self</span> || (SynchFlags &amp; <span class="number">1</span>))&#123;</span><br><span class="line">          TEVENT (Inflated enter - park TIMED);</span><br><span class="line">          <span class="keyword">Self</span>-&gt;_ParkEvent-&gt;park((jlong)RecheckInterval);</span><br><span class="line">          <span class="comment">// Increase the RecheckInterval, but clamp the value.</span></span><br><span class="line">          RecheckInterval *= <span class="number">8</span>ï¼›</span><br><span class="line">          <span class="keyword">if</span>(RecheckInterval &gt; <span class="number">1000</span>) RecheckInterval = <span class="number">1000</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          TEVENT (Inflated enter - park UNTIMED);</span><br><span class="line">          <span class="comment">// é€šè¿‡parkå°†å½“å‰çº¿ç¨‹æŒ‚èµ·ï¼Œç­‰å¾…è¢«å”¤é†’</span></span><br><span class="line">          <span class="keyword">Self</span>-&gt;_ParkEvent-&gt;park();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(TryLock(<span class="keyword">Self</span>) &gt; <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        <span class="comment">// çœç•¥éƒ¨åˆ†ä»£ç </span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// çœç•¥éƒ¨åˆ†ä»£ç </span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">---------------------------------------------------------------</span><br><span class="line">javaä»£ç ï¼š</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> void main(String[] args)&#123;</span><br><span class="line">  synchronized(obj)&#123;</span><br><span class="line">    System.out.println(<span class="string">"1"</span>);</span><br><span class="line">    obj.wait();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">---------------------------------------------------------------</span><br><span class="line">çœ‹å›¾è¯´è¯ï¼š</span><br><span class="line"></span><br><span class="line">å‡è®¾t1çº¿ç¨‹æ²¡æœ‰ç«äº‰å¾—åˆ°é”ï¼›åˆ™t1çº¿ç¨‹å°±å°†è¦å»å¤„äºç­‰å¾…çŠ¶æ€ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™ä¸ªå¤„äºç­‰å¾…è¿™ä¸ªåŠ¨ä½œæ˜¯å¦‚ä½•åšçš„å‘¢ï¼Ÿ</span><br><span class="line"></span><br><span class="line">é¦–å…ˆè¿™ä¸ªt1çº¿ç¨‹ä¼šè¿›å…¥EnterI(THREAD)æ–¹æ³•å½“ä¸­ï¼›</span><br><span class="line">è¿›å…¥EnterI(THREAD)æ–¹æ³•ä¹‹åï¼›</span><br><span class="line">é‚£ä¹ˆä¼šå…ˆå»è¿›è¡Œæ‰§è¡ŒTryLock(<span class="keyword">Self</span>)å°è¯•è·å–é”æ“ä½œï¼›</span><br><span class="line">å³t1çº¿ç¨‹è™½ç„¶æ²¡æœ‰æŠ¢åˆ°é”ä½†æ˜¯å®ƒè¿˜ä¼šç»§ç»­TryLock(THREAD)è¿›è¡Œå°è¯•ä¸€ä¸‹ï¼Œæœ€ååšä¸€ä¸‹æŒ£æ‰ï¼›</span><br><span class="line">å¦‚æœåœ¨è¿™ä¸ªæŒ£æ‰è¿‡ç¨‹ä¸­æŠ¢åˆ°äº†é”åˆ™åé¢æ¥ç€æ‰§è¡Œï¼›</span><br><span class="line">å¦‚æœåœ¨è¿™ä¸ªæŒ£æ‰è¿‡ç¨‹ä¸­æ²¡æœ‰æŠ¢åˆ°é”é‚£ä¹ˆå°±ä¼šç»§ç»­å¾€ä¸‹èµ°ä¼šæ‰§è¡Œå‡½æ•°TrySpin(<span class="keyword">Self</span>)å‡½æ•°ï¼›</span><br><span class="line">é‚£ä¹ˆå‡½æ•°TrySpin(<span class="keyword">Self</span>)å‡½æ•°çš„ä½œç”¨å°±åœ¨äºè‡ªæ—‹ï¼›</span><br><span class="line">è‡ªæ—‹å³æ„å‘³ç€è¿›å…¥ä¸€ä¸ªå¾ªç¯å½“ä¸­å¤šæ¬¡è¿›è¡ŒæŠ¢ä¸€æŠ¢é”çœ‹èƒ½ä¸èƒ½å¤ŸæŠ¢åˆ°è¯¥é”ï¼›</span><br><span class="line">å³å†æ¬¡æŒ£æ‰ä¸€ä¸‹çœ‹èƒ½ä¸èƒ½å†æ¬¡æŠ¢æ•‘ä¸€ä¸‹ï¼›</span><br><span class="line">å¦‚æœç»è¿‡TryLockå°è¯•è·å–é”ä»¥åŠTrySpinè‡ªæ—‹ä¹‹åè¿˜æ˜¯æ²¡æœ‰åŠæ³•è·å–å¾—åˆ°é”ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±ä¼šèµ°åˆ°ä¸‹é¢æ¥ï¼›</span><br><span class="line">å°±ä¼šå°†å½“å‰è¿™ä¸ªæ²¡æœ‰æŠ¢åˆ°é”ä¸”ç»è¿‡TryLockä»¥åŠTrySpinåä¾ç„¶æ²¡æœ‰æŠ¢åˆ°é”çš„t1çº¿ç¨‹æ”¾åˆ°ObjectWaiterä¸­æ¥å¹¶è¿›è¡Œå°è£…èµ·æ¥ï¼›</span><br><span class="line">ObjectWaiterå³ä¸€ä¸ªç­‰å¾…çš„çº¿ç¨‹ï¼›</span><br><span class="line">å¹¶ä¸”ä¼šå°†å½“å‰è¿™ä¸ªæ²¡æœ‰æŠ¢åˆ°é”çš„çº¿ç¨‹çŠ¶æ€è®¾ç½®ä¸ºObjectWaiterå½“ä¸­çš„TS_CXQçŠ¶æ€å–å€¼ï¼›</span><br><span class="line">æ¥ç€é€šè¿‡CASæŠŠå³å°†è¦ç­‰å¾…çš„çº¿ç¨‹t1çº¿ç¨‹pushåˆ°_cxqå•å‘åˆ—è¡¨å½“ä¸­å»ï¼›</span><br><span class="line">ä½†æ˜¯å¯èƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æŠ¢åˆ°ä¹Ÿæœ‰å…¶ä»–å¾ˆå¤šçº¿ç¨‹æ²¡æœ‰æŠ¢åˆ°é”ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™äº›å¾ˆå¤šæ²¡æœ‰æŠ¢åˆ°é”çš„çº¿ç¨‹éƒ½è¦è¢«pushåˆ°è¿™ä¸ª_cxqèŠ‚ç‚¹ä¸Šé¢æ¥ï¼›</span><br><span class="line">é‚£ä¹ˆå› æ­¤è¿™ä¸ªæ²¡æœ‰æŠ¢åˆ°é”çš„çº¿ç¨‹è¦è¢«pushåˆ°_cxqç»“ç‚¹ä¸Šå»çš„è¿™ä¸€æ“ä½œä¹Ÿå¯èƒ½ä¼šæˆåŠŸä¹Ÿæœ‰å¯èƒ½ä¼šå¤±è´¥ï¼›</span><br><span class="line">æ‰€ä»¥è¿™ä¸€æ“ä½œå³æ²¡æœ‰æŠ¢åˆ°é”çš„çº¿ç¨‹éƒ½è¦è¢«pushåˆ°_cxqç»“ç‚¹ä¸Šå»ä¹Ÿæ˜¯ä½¿ç”¨åˆ°äº†ä¸€ä¸ª<span class="keyword">for</span>å¾ªç¯åŠ ä¸ŠAtomic::cmpxchg_ptrè¯¥å†…æ ¸å‡½æ•°ï¼›å³CASä¸€æ¬¡ä¸è¡Œå°±å†é‡è¯•å†é‡è¯•ï¼›ç›´åˆ°å‡ ä¸ªæ²¡æœ‰æˆåŠŸè·å–å¾—åˆ°é”çš„çº¿ç¨‹éƒ½è¢«æŒ‚åœ¨ç»“ç‚¹_cxqå•å‘åˆ—è¡¨ä¸Šï¼›</span><br><span class="line">å¦å¤–åœ¨æ¯æ¬¡é‡è¯•çš„æ—¶å€™ï¼Œéƒ½ä¼šå†å»è¿›è¡Œé‡è¯•æŒ£æ‰ä¸€ä¸‹å³TryLockçœ‹èƒ½ä¸èƒ½æŠ¢åˆ°é”ï¼›</span><br><span class="line">é‚£ä¹ˆç»è¿‡<span class="keyword">for</span>(;;)å¾ªç¯ä¹‹åè¿™å‡ ä¸ªæ²¡æœ‰è·å–å¾—åˆ°é”çš„çº¿ç¨‹éƒ½ä¼šè¢«æŒ‚åœ¨_cxqç»“ç‚¹å•å‘åˆ—è¡¨ä¸Šï¼›</span><br><span class="line">å½“æ²¡æœ‰è·å–å¾—åˆ°é”çš„çº¿ç¨‹æ”¾åˆ°ç»“ç‚¹_cxqå•å‘åˆ—è¡¨å½“ä¸­ä¹‹åï¼›é‚£ä¹ˆè¿˜è¦å°†è¯¥çº¿ç¨‹è¿›è¡ŒæŒ‚èµ·æ“ä½œï¼›å³ä¸‹é¢çš„ä»£ç ï¼›</span><br><span class="line">åœ¨æŒ‚èµ·çš„æ—¶å€™é¦–å…ˆå®ƒä¹Ÿè¿˜æ˜¯ä¼šå»è¿›è¡ŒTryLockå°è¯•æŒ£æ‰æŠ¢æ•‘ä¸€ä¸‹å»è·å–é”ï¼Œçœ‹èƒ½ä¸èƒ½è·å–å¾—åˆ°é”ï¼›å¾—ä¸åˆ°é”åˆ™ç»§ç»­å¾€ä¸‹èµ°ï¼›ç»§ç»­å¾€ä¸‹èµ°å­˜åœ¨<span class="keyword">if</span>()&#123;&#125;<span class="keyword">else</span>&#123;&#125;å—ä½†æ˜¯æ— è®ºèµ°å“ªä¸€å—æœ€ç»ˆéƒ½ä¼šå¯¼è‡´å½“å‰çº¿ç¨‹æ‰§è¡Œpark()ï¼Œparkå°±æ˜¯æŠŠå½“å‰çº¿ç¨‹è¿›è¡ŒæŒ‚èµ·ï¼›</span><br><span class="line">é‚£ä¹ˆåœ¨å½“å‰è¯¥çº¿ç¨‹è¢«æŒ‚èµ·ä¹‹åé‚£ä¹ˆè¯¥çº¿ç¨‹å°±ä¸ä¼šå†è¿›è¡Œæ‰§è¡Œäº†ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±åªæœ‰ç­‰å¾…åˆ«çš„çº¿ç¨‹æ¥è¿›è¡Œå”¤é†’çš„æ—¶å€™æ‰ä¼šè¿›è¡Œç»§ç»­æ‰§è¡Œï¼›</span><br><span class="line">é‚£ä¹ˆä¸ç®¡æ˜¯ä»<span class="keyword">if</span>()&#123;&#125;æˆ–è€…æ˜¯<span class="keyword">else</span>&#123;&#125;å—å½“ä¸­çš„ç‚¹å¼€å§‹è¿›è¡Œè¢«å”¤é†’ï¼Œå½“è¯¥çº¿ç¨‹è¢«å”¤é†’ä¹‹åéƒ½ä¼šå»è¿›è¡Œå°è¯•æŠ¢é”å³TryLock(<span class="keyword">Self</span>)ï¼›çœ‹æ˜¯å¦èƒ½å¤Ÿè·å–å¾—åˆ°é”ï¼›</span><br></pre></td></tr></table></figure><p>å½“è¯¥çº¿ç¨‹è¢«å”¤é†’æ—¶ï¼Œä¼šä»æŒ‚èµ·çš„ç‚¹ç»§ç»­æ‰§è¡Œï¼Œé€šè¿‡<code>ObjectMonitor::TryLock</code>å°è¯•è·å–é”,TryLockæ–¹æ³•å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight zephir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æˆªå–éƒ¨åˆ†ä»£ç </span></span><br><span class="line"><span class="keyword">int</span> ObjectMonitor::TryLock(Thread * <span class="keyword">Self</span>)&#123;</span><br><span class="line">  <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">    void * own = _owner;</span><br><span class="line">    <span class="keyword">if</span>(own != <span class="keyword">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(Atomic::cmpxchg_ptr (<span class="keyword">Self</span>, &amp;_owner, <span class="keyword">NULL</span>) == <span class="keyword">NULL</span>)&#123;</span><br><span class="line">      <span class="comment">// Either guarantee _recursions == 0 or set _recursions = 0.</span></span><br><span class="line">      assert (_recursions == <span class="number">0</span>,    <span class="string">"invariant"</span>);</span><br><span class="line">      assert (_owner      == <span class="keyword">Self</span>, <span class="string">"invariant"</span>);</span><br><span class="line">      <span class="comment">// CONSIDER: set or assert that OwnerIsThread == 1</span></span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// The lock had been freen momentarily, but we lost the race to the lock.</span></span><br><span class="line">    <span class="comment">// Interference -- the CAS faild.</span></span><br><span class="line">    <span class="comment">// we can either return -1 or retry.</span></span><br><span class="line">    <span class="comment">// Retry doesn't make as much sense because the lock was just acquired.</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">true</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">-----------------------------------------------------------------</span><br><span class="line">å°è¯•é”ä¹Ÿæ˜¯ä½¿ç”¨çš„CASæ“ä½œå»è¿›è¡Œåšä¸€ä¸ªåˆ¤æ–­ï¼›</span><br><span class="line">å¦‚æœå°è¯•è·å–å¾—åˆ°é”é‚£ä¹ˆå°±ä¼šè¿”å›<span class="number">1</span>ï¼›</span><br><span class="line">å¦‚æœå°è¯•æ²¡æœ‰è·å–å¾—åˆ°é”é‚£ä¹ˆå°±ä¼šè¿”å›<span class="number">-1</span>ï¼›</span><br></pre></td></tr></table></figure><h3 id="å°ç»“-12"><a href="#å°ç»“-12" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>é¦–å…ˆç¬¬ä¸€ä¸ªï¼›å½“çº¿ç¨‹æ²¡æœ‰æŠ¢åˆ°é”é‚£ä¹ˆå°±å°†ä¼šè¢«æ”¾åˆ°_cxqå•å‘åˆ—è¡¨å½“ä¸­å»ï¼›<br>é‚£ä¹ˆè¯¥æµç¨‹çš„ç¬¬ä¸€æ­¥éª¤ï¼š<br>ä»¥ä¸Šä»£ç çš„å…·ä½“æµç¨‹å¦‚ä¸‹ï¼š</p><p><strong>1ã€</strong> å½“å‰çº¿ç¨‹è¢«å°è£…æˆObjectWaiterå¯¹è±¡nodeï¼ŒçŠ¶æ€è®¾ç½®æˆObjectWaiter::TS_CXQã€‚<br><strong>2ã€</strong> åœ¨forå¾ªç¯ä¸­ï¼ˆç”¨CASå°è¯•æŠŠå½“å‰è¯¥çº¿ç¨‹æ”¾åˆ°_cxqçš„ä¸€ä¸ªèŠ‚ç‚¹ä¸Šå»ï¼›å› ä¸ºåŒæ—¶æœ‰å¤šä¸ªçº¿ç¨‹å¾€å•å‘åˆ—è¡¨_cxqå½“ä¸­æ”¾ï¼Œæ‰€ä»¥ä½¿ç”¨äº†forå¾ªç¯ï¼ŒCASå¤šæ¬¡å°è¯•ï¼‰ï¼Œé€šè¿‡CASæŠŠnodeèŠ‚ç‚¹pushåˆ°_cxqåˆ—è¡¨ä¸­ï¼ŒåŒä¸€æ—¶åˆ»å¯èƒ½æœ‰å¤šä¸ªçº¿ç¨‹æŠŠè‡ªå·±çš„nodeèŠ‚ç‚¹pushåˆ°_cxqåˆ—è¡¨ä¸­ã€‚<br><strong>3ã€</strong> ï¼ˆæ²¡æœ‰æŠ¢åˆ°é”çš„çº¿ç¨‹åœ¨æ”¾åˆ°_cxqèŠ‚ç‚¹ä¸Šä¹‹å‰ï¼‰nodeç»“ç‚¹pushåˆ°_cxqåˆ—è¡¨ä¹‹åï¼Œé€šè¿‡è‡ªæ—‹å°è¯•è·å–é”ï¼Œå¦‚æœè¿˜æ˜¯æ²¡æœ‰è·å–å¾—åˆ°é”ï¼Œåˆ™é€šè¿‡parkå°†å½“å‰çº¿ç¨‹æŒ‚èµ·ï¼ˆparkå†…æ ¸å‡½æ•°ï¼Œè®©å½“å‰çº¿ç¨‹è¿›è¡ŒæŒ‚èµ·é‚£ä¹ˆå…¶å®ä¹Ÿå°±ç›¸å½“äºé˜»å¡çŠ¶æ€éœ€è¦åˆ«çš„çº¿ç¨‹è¿›è¡Œå”¤é†’æ‰èƒ½å¤Ÿç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼‰ï¼Œç­‰å¾…è¢«å”¤é†’ã€‚<br><strong>4ã€</strong> å½“è¯¥çº¿ç¨‹è¢«å”¤é†’æ—¶ï¼Œä¼šä»æŒ‚èµ·çš„ç‚¹ç»§ç»­æ‰§è¡Œï¼Œé€šè¿‡<code>ObjectWaiter::TryLock</code>å°è¯•è·å–é”ã€‚</p><h2 id="æ·±å…¥JVMæºç -monitoré‡Šæ”¾"><a href="#æ·±å…¥JVMæºç -monitoré‡Šæ”¾" class="headerlink" title="æ·±å…¥JVMæºç -monitoré‡Šæ”¾"></a>æ·±å…¥JVMæºç -monitoré‡Šæ”¾</h2><h3 id="ç›®æ ‡-14"><a href="#ç›®æ ‡-14" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†æ¥è¿›è¡Œå­¦ä¹ ï¼›<br>é¦–å…ˆè¿›è¡Œä»‹ç»ä»€ä¹ˆæ—¶å€™monitorä¼šè¿›è¡Œé‡Šæ”¾ï¼›<br>æ¥ç€è¿›è¡Œä»‹ç»monitorçš„é‡Šæ”¾è¿‡ç¨‹æ˜¯ä»€ä¹ˆæ ·çš„ï¼›</p><h3 id="monitoré‡Šæ”¾åˆ†æ"><a href="#monitoré‡Šæ”¾åˆ†æ" class="headerlink" title="monitoré‡Šæ”¾åˆ†æ"></a>monitoré‡Šæ”¾åˆ†æ</h3><p>å½“æŸä¸ªæŒæœ‰é”çš„çº¿ç¨‹æ‰§è¡Œå®ŒåŒæ­¥ä»£ç å—æ—¶ï¼Œä¼šè¿›è¡Œé”çš„é‡Šæ”¾ï¼Œç»™å…¶ä»–çº¿ç¨‹æœºä¼šæ‰§è¡ŒåŒæ­¥ä»£ç å—ã€‚<br>åœ¨HotSpotä¸­ï¼Œé€šè¿‡æ¨å‡ºmonitorçš„æ–¹å¼å®ç°é”çš„é‡Šæ”¾ï¼Œå¹¶é€šçŸ¥è¢«é˜»å¡çš„çº¿ç¨‹ï¼Œå…·ä½“å®ç°ä½äºObjectMonitorçš„exitæ–¹æ³•ä¸­ã€‚<br>ï¼ˆä½äºï¼š/src/share/vm/runtime/ObjectMonitor.cppï¼‰ï¼Œæºç å¦‚ä¸‹æ‰€ç¤º:</p><figure class="highlight zephir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br></pre></td><td class="code"><pre><span class="line">-------------------------------------------------------------------</span><br><span class="line"><span class="comment"># æˆªå–éƒ¨åˆ†ä»£ç </span></span><br><span class="line">void ATTR ObjectMonitor::exit(<span class="keyword">bool</span> not_suspended, TRAPS)&#123;</span><br><span class="line">  Thread * <span class="keyword">Self</span> = THREAD;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// çœç•¥éƒ¨åˆ†ä»£ç </span></span><br><span class="line">  <span class="keyword">if</span>(_recursions != <span class="number">0</span>)&#123;</span><br><span class="line">    _recursions--;    <span class="comment">// this is simple recursive enter</span></span><br><span class="line">    TEVENT (Inflated <span class="keyword">exit</span> - recursive);</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// çœç•¥éƒ¨åˆ†ä»£ç </span></span><br><span class="line"></span><br><span class="line">  ObjectWaiter * w = <span class="keyword">NULL</span>;</span><br><span class="line">  <span class="keyword">int</span> QMode = Knob_QMode;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// qmode = 2ï¼šç›´æ¥ç»•è¿‡EntryListé˜Ÿåˆ—ï¼Œä»_cxqé˜Ÿåˆ—ä¸­è·å–çº¿ç¨‹ç”¨äºç«äº‰é”</span></span><br><span class="line">  <span class="keyword">if</span>(QMode == <span class="number">2</span> &amp;&amp; _cxq != <span class="keyword">NULL</span>)&#123;</span><br><span class="line">    w = _cxq;</span><br><span class="line">  assert ( w != <span class="keyword">NULL</span>, <span class="string">"invariant"</span>);</span><br><span class="line">  assert ( w-&gt;TState == ObjectWaiter::TS_CXQ, <span class="string">"invariant"</span>);</span><br><span class="line">  ExitEpilog(<span class="keyword">Self</span>, w);</span><br><span class="line">  <span class="keyword">return</span> ;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// qmode=3ï¼šcxqé˜Ÿåˆ—æ’å…¥EntryListå°¾éƒ¨ï¼›</span></span><br><span class="line">  <span class="keyword">if</span>(QMode == <span class="number">3</span> &amp;&amp; _cxq != <span class="keyword">NULL</span>)&#123;</span><br><span class="line">    w = _cxq;</span><br><span class="line">    <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">      assert (w != <span class="keyword">NULL</span>, <span class="string">"Invariant"</span>);</span><br><span class="line">      ObjectWaiter * u = (ObjectWaiter *)Atomic::cmpxchg_ptr (<span class="keyword">NULL</span>, &amp;_cxq, w);</span><br><span class="line">      <span class="keyword">if</span>( u == w ) <span class="keyword">break</span>;</span><br><span class="line">      w = u;</span><br><span class="line">    &#125;</span><br><span class="line">    assert( w != <span class="keyword">NULL</span> , <span class="string">"invariant"</span>);</span><br><span class="line"></span><br><span class="line">    ObjectWaiter * q = <span class="keyword">NULL</span>;</span><br><span class="line">    ObjectWaiter * p;</span><br><span class="line">    <span class="keyword">for</span>( p = w ;  p != <span class="keyword">NULL</span> ; p = p-&gt;_next)&#123;</span><br><span class="line">      guarantee (p-&gt;TState == ObjectWaiter::TS_CXQ, <span class="string">"Invariant"</span>);</span><br><span class="line">      p-&gt;TState = ObjectWaiter::TS_ENTER;</span><br><span class="line">      p-&gt;prev = q;</span><br><span class="line">      q = p;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ObjectWaiter * Tail;</span><br><span class="line">    <span class="keyword">for</span> ( Tail = _EntryList; Tail != <span class="keyword">NULL</span> &amp;&amp; Tail-&gt;_next != <span class="keyword">NULL</span>; Tail = Tail-&gt;_next);</span><br><span class="line">    <span class="keyword">if</span>(Tail == <span class="keyword">NULL</span>)&#123;</span><br><span class="line">      _EntryList = w;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      Tail-&gt;_next = w;</span><br><span class="line">      w-&gt;_prev = Tail;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">// qmode=4: cxqé˜Ÿåˆ—æ’å…¥åˆ°_EntryListå¤´éƒ¨</span></span><br><span class="line">  <span class="keyword">if</span>(QMode == <span class="number">4</span> &amp;&amp; _cxq != <span class="keyword">NULL</span>)&#123;</span><br><span class="line">    w = _cxq;</span><br><span class="line">    <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">      assert (w != <span class="keyword">NULL</span>, <span class="string">"Invariant"</span>);</span><br><span class="line">      ObjectWaiter * u = (ObjectWaiter *)Atomic::cmpxchg_ptr(<span class="keyword">NULL</span>, &amp;_cxq, w);</span><br><span class="line">      <span class="keyword">if</span>(u == w) <span class="keyword">break</span>;</span><br><span class="line">      w = u;</span><br><span class="line">    &#125;</span><br><span class="line">    assert (w != <span class="keyword">NULL</span> , <span class="string">"invariant"</span>);</span><br><span class="line"></span><br><span class="line">    ObjectWaiter * q = <span class="keyword">NULL</span>;</span><br><span class="line">    ObjectWaiter * p;</span><br><span class="line">    <span class="keyword">for</span>( p = w; p != <span class="keyword">NULL</span> ; p -&gt;_next)&#123;</span><br><span class="line">      guarantee(p-&gt;TState == ObjectWaiter::TS_CXQ, <span class="string">"Invariant"</span>);</span><br><span class="line">      p-&gt;TState = ObjectWaiter::TS_ENTER;</span><br><span class="line">      p-&gt;_prev = q;</span><br><span class="line">      q = p;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(_EntryList != <span class="keyword">NULL</span>)&#123;</span><br><span class="line">      q-&gt;_next = _EntryList;</span><br><span class="line">      _EntryList-&gt;_prev = q;</span><br><span class="line">    &#125;</span><br><span class="line">    _EntryList = w;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  w = _EntryList;</span><br><span class="line">  <span class="keyword">if</span>(w != <span class="keyword">NULL</span>)&#123;</span><br><span class="line">    assert (w-&gt;TState == ObjectWaiter::TS_ENTER, <span class="string">"invariant"</span>);</span><br><span class="line">    ExitEpilog(<span class="keyword">Self</span>, w);</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  w = _cxq;</span><br><span class="line">  <span class="keyword">if</span>(w == <span class="keyword">NULL</span>) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">    assert (w != <span class="keyword">NULL</span>, <span class="string">"Invariant"</span>);</span><br><span class="line">    ObjectWaiter * u = (ObjectWaiter *)Atomic::cmpxchg_ptr(<span class="keyword">NULL</span>, &amp;_cxq, w);</span><br><span class="line">    <span class="keyword">if</span>(u == w) <span class="keyword">break</span>;</span><br><span class="line">    w = u;</span><br><span class="line">  &#125;</span><br><span class="line">  TEVENT(Inflated <span class="keyword">exit</span> - drain cxq into EntryList);</span><br><span class="line"></span><br><span class="line">  assert( w          != <span class="keyword">NULL</span> , <span class="string">"invariant"</span>);</span><br><span class="line">  assert( _EntryList != <span class="keyword">NULL</span> , <span class="string">"invariant"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(QMode == <span class="number">1</span>)&#123;</span><br><span class="line">    <span class="comment">// QMode == 1: drain cxq to EntryList,reversing order</span></span><br><span class="line">    <span class="comment">// we also reverse the order of the list</span></span><br><span class="line">    ObjectWaiter * s = <span class="keyword">NULL</span>;</span><br><span class="line">    ObjectWaiter * t = w;</span><br><span class="line">    ObjectWaiter * u = <span class="keyword">NULL</span>;</span><br><span class="line">    <span class="keyword">while</span>(t != <span class="keyword">NULL</span>)&#123;</span><br><span class="line">      guarantee(t-&gt;TState == ObjectWaiter::TS_CXQ, <span class="string">"invariant"</span>);</span><br><span class="line">      t-&gt;TState = ObjectWaiter::TS_ENTER;</span><br><span class="line">      u = t-&gt;_next;</span><br><span class="line">      t-&gt;_prev = u;</span><br><span class="line">      t-&gt;_next = s;</span><br><span class="line">      s = t;</span><br><span class="line">      t = u;</span><br><span class="line">    &#125;</span><br><span class="line">    _EntryList = s;</span><br><span class="line">    assert(s != <span class="keyword">NULL</span>, <span class="string">"invariant"</span>);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">// QMode ==0 or QMode == 2</span></span><br><span class="line">    _EntryList = w;</span><br><span class="line">    ObjectWaiter * q = <span class="keyword">NULL</span>;</span><br><span class="line">    ObjectWaiter * p;</span><br><span class="line">    <span class="keyword">for</span>(p = w; p != <span class="keyword">NULL</span>; p = p-&gt;_next)&#123;</span><br><span class="line">      guarantee(p-&gt;TState == ObjectWaiter::TS_CXQ, <span class="string">"Invariant"</span>);</span><br><span class="line">      p-&gt;TState = ObjectWaiter::TS_ENTER;</span><br><span class="line">      p-&gt;_prev = q;</span><br><span class="line">      q = p;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (_succ != <span class="keyword">NULL</span>) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">  w = _EntryList;</span><br><span class="line">  <span class="keyword">if</span>(w != <span class="keyword">NULL</span>)&#123;</span><br><span class="line">    guarantee(w -&gt; TState == ObjectWater::TS_ENTER, <span class="string">"invariant"</span>);</span><br><span class="line">    ExitEpilog(<span class="keyword">Self</span>, w);</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line">javaä»£ç ï¼š</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> void main(String[] args)&#123;</span><br><span class="line">  synchronized(obj)&#123;</span><br><span class="line">    System.out.println(<span class="string">"1"</span>);</span><br><span class="line">    obj.wait();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">------------------------------------------------------------------</span><br><span class="line">ç¬¬ä¸€éƒ¨åˆ†ï¼šä»€ä¹ˆæ—¶å€™é‡Šæ”¾monitoråˆ†æï¼š</span><br><span class="line">è·å¾—é”çš„çº¿ç¨‹t1æ‰§è¡Œå®ŒåŒæ­¥ä»£ç å—å½“ä¸­çš„ä»£ç ä¹‹åï¼Œ</span><br><span class="line">é‚£ä¹ˆå°±éœ€è¦å‡ºåŒæ­¥ä»£ç å—ï¼›</span><br><span class="line">åœ¨å‡ºåŒæ­¥ä»£ç å—çš„æ—¶å€™å°±ä¼šè¿›è¡Œmonitorçš„é‡Šæ”¾æ“ä½œï¼›</span><br><span class="line">-----------------------------------------------------------------</span><br><span class="line">ç¬¬äºŒéƒ¨åˆ†ï¼šmonitoré‡Šæ”¾çš„è¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„åˆ†æï¼š</span><br><span class="line">åœ¨<span class="keyword">exit</span>çš„é‡Šæ”¾è¿‡ç¨‹å½“ä¸­ï¼›</span><br><span class="line">å¦‚æœ_recursionsè®¡æ•°å™¨ä¸ç­‰äº<span class="number">0</span>ï¼›</span><br><span class="line">é‚£ä¹ˆ_recursionså°±ä¼šå»åšä¸€ä¸ª--å³å‡ä¸€æ“ä½œï¼›å†å»<span class="keyword">return</span>ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™ä¸ªå…¶å®å¯¹åº”ç€çš„æ˜¯é‡å…¥é”ï¼›</span><br><span class="line">_recursionså½“ä¸ä¸º<span class="number">0</span>çš„æƒ…å†µä¸‹ä¼šè¿›è¡Œ--å³å‡ä¸€æ“ä½œï¼›</span><br><span class="line">å¦‚æœ_recursionsç­‰äº<span class="number">0</span>çš„æƒ…å†µä¸‹é‚£ä¹ˆå°±è¡¨ç¤ºçº¿ç¨‹å®Œå…¨å‡ºäº†åŒæ­¥ä»£ç å—ï¼Œ</span><br><span class="line">ä¸”æŠŠé”é‡Šæ”¾è¿”å›äº†ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™ä¸ªæ—¶å€™é™¤äº†é‡Šæ”¾é”ä¹‹å¤–è¿˜éœ€è¦åšä¸€ä¸ªæ“ä½œï¼›</span><br><span class="line">å³å»å”¤é†’ä¹‹å‰æ­£åœ¨ç­‰å¾…é˜»å¡ä¸­çš„çº¿ç¨‹ï¼›é‚£ä¹ˆéœ€è¦å”¤é†’å“ªä¸€ä¸ªçº¿ç¨‹å‘¢ï¼Ÿ</span><br><span class="line">è¿™ä¸ªæ—¶å€™å°±éœ€è¦æ³¨æ„äº†ï¼›æœ‰ä¸¤ä¸ªé“¾è¡¨å½“ä¸­éƒ½å­˜æ”¾æœ‰éœ€è¦è¢«å”¤é†’çš„çº¿ç¨‹ï¼›</span><br><span class="line">å³ä¸€ä¸ªæ˜¯_cxqï¼›å¦å¤–ä¸€ä¸ªæ˜¯EntryListï¼›</span><br><span class="line">é‚£ä¹ˆæ˜¯éšæœºå”¤é†’æŸä¸€ä¸ªçº¿ç¨‹å³æœ‰å¯èƒ½åˆé€‚å”¤é†’_cxqåˆ—è¡¨å½“ä¸­çš„çº¿ç¨‹ä¹Ÿæœ‰å¯èƒ½æ˜¯å”¤é†’_EntryListå½“ä¸­çš„çº¿ç¨‹ï¼›</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥ç»§ç»­å¾€ä¸‹çœ‹ï¼›</span><br><span class="line">ObjectWaiteræ˜¯ä¹‹å‰è¢«é˜»å¡è¿›è¡Œç­‰å¾…çš„ä¸€ä¸ªçº¿ç¨‹çš„ä¸€ä¸ªå°è£…ï¼›</span><br><span class="line">éœ€è¦è®°ä½çš„æ˜¯wï¼Œæ‰¾åˆ°äº†wå³æ‰¾åˆ°äº†éœ€è¦è¢«å”¤é†’çš„çº¿ç¨‹ï¼›</span><br><span class="line"></span><br><span class="line">åœ¨<span class="keyword">exit</span>å½“ä¸­æä¾›å¾ˆå¤šç§æ¨¡å¼ï¼›</span><br><span class="line">æ¨¡å¼ä¸€ï¼š</span><br><span class="line">å¦‚æœQModeç­‰äº<span class="number">2</span>ï¼›é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ä¼šè®©wç­‰äº_cxqçš„é¦–èŠ‚ç‚¹å³é“¾è¡¨å¤´ï¼›</span><br><span class="line">é‚£ä¹ˆä¹Ÿå°±å–åˆ°äº†è¿™ä¸ªè¦è¢«å”¤é†’çš„çº¿ç¨‹ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™ä¸€ç§æ–¹æ³•ç»•è¿‡äº†_EntryListå½“ä¸­è¢«é˜»å¡çš„çº¿ç¨‹ç›´æ¥å–_cxqåˆ—è¡¨å½“ä¸­çš„çº¿ç¨‹ä½œä¸ºè¦è¢«å”¤é†’çš„çº¿ç¨‹å¯¹è±¡ï¼›</span><br><span class="line">å¦å¤–æ–¹æ³•ExitEpilog(<span class="keyword">Self</span>,w)æ–¹æ³•å°±æ˜¯å»ä½œä¸ºå”¤é†’çº¿ç¨‹çš„æ–¹æ³•ï¼›</span><br><span class="line">æ¨¡å¼äºŒï¼š</span><br><span class="line">å¦‚æœQModeç­‰äº<span class="number">3</span>ï¼›é¦–å…ˆè¦è¢«å”¤é†’çš„çº¿ç¨‹wä¹Ÿæ˜¯ç­‰äº_cxqçš„é¦–èŠ‚ç‚¹ï¼›</span><br><span class="line">å¹¶ä¸”ä¼šå°†_cxqçš„è¿™äº›èŠ‚ç‚¹æ”¾åˆ°_EntryListçš„å°¾éƒ¨å»ï¼›</span><br><span class="line">æ¨¡å¼ä¸‰ï¼š</span><br><span class="line">å¦‚æœQModeç­‰äº<span class="number">4</span>ï¼›åˆ™é‚£ä¹ˆé¦–å…ˆè¿™ä¸ªè¦è¢«å”¤é†’çš„çº¿ç¨‹ä¹Ÿæ˜¯ç­‰äº_cxqçš„é¦–èŠ‚ç‚¹ï¼›</span><br><span class="line">å¹¶ä¸”ä¼šå°†_cxqåˆ—è¡¨å½“ä¸­çš„å…ƒç´ æ’å…¥åˆ°_EntryListåˆ—è¡¨çš„å¤´éƒ¨ï¼›</span><br><span class="line">etc...</span><br><span class="line"></span><br><span class="line">é‚£ä¹ˆæœ€åå°±æ‰¾åˆ°äº†wï¼Œå³éœ€è¦è¢«å”¤é†’çš„çº¿ç¨‹ï¼›</span><br><span class="line">é‚£ä¹ˆä¹Ÿä¼šå»è°ƒç”¨åˆ°æ–¹æ³•ExitEpilog(<span class="keyword">Self</span>, w);</span><br><span class="line">å³å”¤é†’wçº¿ç¨‹ï¼›</span><br><span class="line">ExitEpilogå³ä¸ºå…·ä½“å”¤é†’çš„è¿‡ç¨‹ï¼›</span><br></pre></td></tr></table></figure><p><strong>1ã€</strong> é€€å‡ºåŒæ­¥ä»£ç å—æ—¶ ä¼šè®©_recursionså‡1ï¼Œå½“_recursionsçš„å€¼å‡ä¸º0æ—¶ï¼Œè¯´æ˜ï¼ˆçº¿ç¨‹å®Œå…¨é€€å‡ºäº†åŒæ­¥ä»£ç å—ä¸­ï¼‰çº¿ç¨‹é‡Šæ”¾äº†é”ï¼›<br><strong>2ã€</strong> ï¼ˆé‡Šæ”¾å®Œé”ä¹‹åéœ€è¦å”¤é†’çº¿ç¨‹ï¼‰æ ¹æ®ä¸åœçš„ç­–ç•¥ï¼ˆç­–ç•¥ä¸åŒå”¤é†’ä¸åŒçš„çº¿ç¨‹ï¼‰ï¼ˆç”±QModeæŒ‡å®šï¼‰ï¼Œä»_cxqæˆ–_EntryListä¸­è·å–å¤´èŠ‚ç‚¹ï¼Œé€šè¿‡<code>ObjectMonitor::ExitEpilog</code>æ–¹æ³•å”¤é†’è¯¥èŠ‚ç‚¹å°è£…çš„çº¿ç¨‹ï¼Œå”¤é†’æ“ä½œæœ€ç»ˆç”±unpackå®Œæˆï¼ˆå°†ä¹‹å‰parkçš„çº¿ç¨‹è¿›è¡Œå”¤é†’ï¼‰ï¼Œå®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">-----------------------------------------------------------------</span><br><span class="line"><span class="comment"># æˆªå–éƒ¨åˆ†ä»£ç </span></span><br><span class="line">void ObjectMonitor::ExitEpilog(Thread * <span class="keyword">Self</span>, ObjectWaiter * wakee)&#123;</span><br><span class="line">  assert( _owner == <span class="keyword">Self</span>, <span class="string">"invariant"</span>);</span><br><span class="line"></span><br><span class="line">  _succ = Knob_SuccEnabled ? wakee-&gt;_thread : <span class="keyword">NULL</span>;</span><br><span class="line">  ParkEvent * Trigger = wakee-&gt;_event;</span><br><span class="line"></span><br><span class="line">  wakee = <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Drop the lock</span></span><br><span class="line">  OrderAccess::release_store_ptr(&amp;_owner, <span class="keyword">NULL</span>);</span><br><span class="line">  OrderAccess::fence();           <span class="comment">// ST _owner vs LD in unpark()</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(SafepointSynchronize::do_call_back())&#123;</span><br><span class="line">    TEVENT(unpack before SAFEPOINT);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  DTRACE_MONITOR_PROBE(contended__exit, this, object(), <span class="keyword">Self</span>);</span><br><span class="line">  Trigger-&gt;unpark();  <span class="comment">// å”¤é†’ä¹‹å‰è¢«park()æŒ‚èµ·çš„çº¿ç¨‹</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// Maintain stats and report events to JVMTI</span></span><br><span class="line">  <span class="keyword">if</span> (ObjectMonitor::_synch_Parks != <span class="keyword">NULL</span>)&#123;</span><br><span class="line">    ObjectMonitor::_sync_Parks-&gt;inc();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">-----------------------------------------------------------------</span><br><span class="line">åˆ†æï¼š</span><br><span class="line">æœ€é‡è¦çš„ä»£ç åœ¨äºTrigger-unpark();</span><br><span class="line">unparkçš„å«ä¹‰å³ä»£è¡¨ï¼š</span><br><span class="line">å‡è®¾æ‰¾åˆ°çº¿ç¨‹t1è¦è¢«å”¤é†’ï¼›</span><br><span class="line">é‚£ä¹ˆæ‰¾åˆ°è¿™ä¸ªçº¿ç¨‹t1ä¹‹åï¼›è°ƒç”¨unpark()æ–¹æ³•å°±ä¼šå°†çº¿ç¨‹t1è¿›è¡Œå”¤é†’ï¼›</span><br><span class="line">é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªt1çº¿ç¨‹å°±åˆèƒ½å¤Ÿæœ‰æœ‰æœºä¼šå»è·å–ç«äº‰å¾—åˆ°é”ä»è€Œè¿›å…¥åˆ°åŒæ­¥ä»£ç å—å½“ä¸­å»ï¼›</span><br><span class="line">æ‰§è¡Œå®Œunparkä¹‹åå°±ä¼šå°†éœ€è¦å”¤é†’çš„çº¿ç¨‹è¿›è¡Œå”¤é†’ï¼›</span><br><span class="line">å”¤é†’å®Œæˆä¹‹åå°±ä¼šè¿›å…¥åˆ°ä¹‹å‰park()è®©è¯¥çº¿ç¨‹æŒ‚èµ·çš„ä»£ç è¡Œä¸­ï¼›</span><br><span class="line">é‚£ä¹ˆåé¢å½“unpark()å°†è¯¥éœ€è¦å”¤é†’çš„çº¿ç¨‹å”¤é†’ä¹‹åï¼Œå°±åˆä¼šå»è¿›è¡Œæ‰§è¡ŒTryLockå°è¯•è·å–é”çš„ä»£ç ï¼›æŠ¢åˆ°é”åˆ™è¿›å…¥åˆ°åŒæ­¥ä»£ç å—å½“ä¸­å»ï¼›</span><br></pre></td></tr></table></figure><p>è¢«å”¤é†’çš„çº¿ç¨‹ï¼Œä¼šå›åˆ°void ATTR ObjectMonitor::EnterI(TRAPS)çš„ç¬¬600è¡Œï¼Œç»§ç»­æ‰§è¡Œmonitorçš„ç«äº‰ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æˆªå–éƒ¨åˆ†ä»£ç </span></span><br><span class="line"><span class="comment">// park self</span></span><br><span class="line"><span class="keyword">if</span>(_REsponsible == <span class="keyword">Self</span> || (SynchFlags &amp; <span class="number">1</span>))&#123;</span><br><span class="line">  TEVENT (Inflated enter - park TIMED);</span><br><span class="line">  <span class="keyword">Self</span>-&gt;_ParkEvent-&gt;park((jlong) RecheckInterval);</span><br><span class="line">  <span class="comment">// Increase the RecheckInterval , but clamp the value.</span></span><br><span class="line">  RecheckInterval *= <span class="number">8</span>;</span><br><span class="line">  <span class="keyword">if</span>(RecheckInterval &gt; <span class="number">1000</span>) RecheckInterval = <span class="number">1000</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  TEVENT (Infalted enter - park UNTIMED);</span><br><span class="line">  <span class="keyword">Self</span>-&gt;_ParkEvent-&gt;park();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(TryLock(<span class="keyword">Self</span>) &gt; <span class="number">0</span>) <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure><h2 id="æ·±å…¥JVMæºç -monitoræ˜¯é‡é‡çº§é”"><a href="#æ·±å…¥JVMæºç -monitoræ˜¯é‡é‡çº§é”" class="headerlink" title="æ·±å…¥JVMæºç -monitoræ˜¯é‡é‡çº§é”"></a>æ·±å…¥JVMæºç -monitoræ˜¯é‡é‡çº§é”</h2><p>synchronizedä»£ç å—åœ¨ä»£ç æ‰§è¡Œçš„æ—¶å€™æ•ˆç‡æ¯”è¾ƒä½ï¼›<br>å› ä¸ºsynchronizedæ‰€å…³è”çš„é”å¯¹è±¡monitoræ˜¯ä¸€ä¸ªé‡é‡çº§é”ï¼›</p><h3 id="ç›®æ ‡-15"><a href="#ç›®æ ‡-15" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>monitorä¸ºä»€ä¹ˆå±äºä¸€ä¸ªé‡é‡çº§é”ï¼Ÿ<br>monitorä¸ºä»€ä¹ˆæ•ˆç‡æ¯”è¾ƒä½ï¼Ÿ</p><p>å¯ä»¥çœ‹åˆ° ObjectMonitor çš„å‡½æ•°è°ƒç”¨ä¸­ ä¼šæ¶‰åŠåˆ° Atomic::cmpxchg_ptrï¼ŒAtomic::inc_ptrç­‰å†…æ ¸å‡½æ•°ï¼Œæ‰§è¡ŒåŒæ­¥ä»£ç å—ï¼Œæ²¡æœ‰ç«äº‰åˆ°é”çš„å¯¹è±¡ä¼šæ‰§è¡Œè°ƒç”¨park()è¢«æŒ‚èµ·ï¼Œç«äº‰åˆ°é”çš„çº¿ç¨‹æ‰§è¡Œå®Œæˆé€€å‡ºåŒæ­¥ä»£ç å—æ—¶ï¼ˆå³å½“å…¶ä»–çº¿ç¨‹é€€å‡ºåŒæ­¥ä»£ç å—æ—¶ï¼‰ä¼šè°ƒç”¨unpark()å”¤é†’ä¸Šæ¬¡é‚£äº›æ²¡æœ‰ç«äº‰åˆ°é”ä»è€Œè¢«park()æŒ‚èµ·çš„çº¿ç¨‹ï¼›<br>ï¼ˆè¿™ä¸ªparkå’Œunparkä¹Ÿå±äºå†…æ ¸å‡½æ•°ï¼›å³ä¹Ÿå°±æ˜¯è¯´synchronizedåœ¨æ‰§è¡Œçš„æ—¶å€™ä¼šæ¶‰åŠåˆ°å¤§é‡çš„å†…æ ¸å‡½æ•°çš„æ‰§è¡Œï¼Œè€Œå†…æ ¸å‡½æ•°çš„æ‰§è¡Œå°±ä¼šæ¶‰åŠåˆ°æ“ä½œç³»ç»Ÿä¸­ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„ä¸€ä¸ªåˆ‡æ¢ï¼›ï¼‰<br>è¿™ä¸ªæ—¶å€™å°±ä¼šå­˜åœ¨æ“ä½œç³»ç»Ÿ ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„è½¬æ¢ï¼Œè¿™ç§è½¬æ¢ä¼šæ¶ˆè€—å¤§é‡çš„ç³»ç»Ÿèµ„æºã€‚<br>æ‰€ä»¥synchronizedæ˜¯javaè¯­è¨€ä¸­çš„ä¸€ä¸ªé‡é‡çº§ï¼ˆHeavyweightï¼‰çš„æ“ä½œã€‚<br>ç”¨æˆ·æ€å’Œå†…æ ¸æ€æ˜¯ä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿ<br>è¦æƒ³äº†è§£ç”¨æˆ·æ€å’Œå†…æ ¸æ€è¿˜éœ€è¦å…ˆäº†è§£ä¸€ä¸‹Linuxç³»ç»Ÿçš„ä½“ç³»æ¶æ„ï¼š</p><p>linuxç³»ç»Ÿçš„ä½“ç³»æ¶æ„ç”±<br>å†…æ ¸ï¼ˆæ“ä½œç³»ç»Ÿçš„å†…æ ¸ï¼Œè€Œå†…æ ¸æœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ç§åº”ç”¨ç¨‹åºï¼›ä½œç”¨æ˜¯æ¥æ§åˆ¶è®¡ç®—æœºçš„ç¡¬ä»¶èµ„æºçš„ï¼Œæ¯”å¦‚è¯´æ§åˆ¶ç¡¬ç›˜ã€é‚£ä¹ˆè¿˜æœ‰å¯èƒ½æ§åˆ¶å†…å­˜ç­‰æ§åˆ¶ç½‘ç»œç­‰ç›¸å…³çš„ä¸€äº›ç¡¬ä»¶è®¾å¤‡æ¯”å¦‚è¯´ç½‘å¡ã€å£°å¡ã€é”®ç›˜ã€é¼ æ ‡ç­‰ï¼‰ï¼›<br>ç³»ç»Ÿè°ƒç”¨ã€shellã€å…¬ç”¨å‡½æ•°åº“ï¼›<br>åº”ç”¨ç¨‹åºï¼ˆç”¨æˆ·ç©ºé—´ï¼‰<br>ï¼ˆè‡ªå·±å†™çš„ç¨‹åºè¢«ç§°ä¸ºæ™®é€šçš„åº”ç”¨ç¨‹åºï¼›ç”¨æˆ·ç©ºé—´å…¶å®æŒ‡çš„æ˜¯è‡ªå·±æ‰€ç¼–å†™çš„åº”ç”¨ç¨‹åºæ‰€è¿è¡Œçš„é‚£ä¸€å—å†…å­˜ç©ºé—´å°±æˆä¸ºç”¨æˆ·ç©ºé—´ï¼›è€Œåº”ç”¨ç¨‹åºåœ¨ç”¨æˆ·ç©ºé—´è¿›è¡Œè¿è¡Œçš„æ—¶å€™å°±æœ‰å¯èƒ½ä¼šæ¶‰åŠåˆ°ä¸€äº›ç¡¬ä»¶èµ„æºçš„è°ƒç”¨ï¼›é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±éœ€è¦é å†…æ ¸æ¥è¿›è¡Œå»æ“ä½œç¡¬ä»¶èµ„æºï¼›é‚£ä¹ˆç”¨æˆ·ç©ºé—´å»è°ƒç”¨å†…æ ¸çš„æ—¶å€™ï¼Œå°±éœ€è¦é€šè¿‡ç³»ç»Ÿè°ƒç”¨æ‰èƒ½å¤Ÿè¿›è¡Œï¼›é‚£ä¹ˆç³»ç»Ÿè°ƒç”¨çš„ä½œç”¨å³åœ¨äºè®©åœ¨ç”¨æˆ·ç©ºé—´çš„åº”ç”¨ç¨‹åºèƒ½å¤Ÿå»è°ƒç”¨å†…æ ¸çš„ä¸€äº›å†…æ ¸å‡½æ•°ï¼›é‚£ä¹ˆç³»ç»Ÿè°ƒç”¨å¯ä»¥çœ‹åšæ˜¯æä¾›å†…æ ¸çš„æ¥å£ä¾›å¤–å±‚çš„åº”ç”¨ç¨‹åºæ¥è¿›è¡Œè°ƒç”¨ï¼›ï¼‰<br>è¿™å‡ ä¸ªéƒ¨åˆ†æ¥è¿›è¡Œç»„æˆï¼›</p><p>ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œlinuxæ“ä½œç³»ç»Ÿçš„ä½“ç³»æ¶æ„åˆ†ä¸ºï¼šç”¨æˆ·ç©ºé—´ï¼ˆåº”ç”¨ç¨‹åºçš„æ´»åŠ¨ç©ºé—´ï¼‰å’Œå†…æ ¸ã€‚<br>å†…æ ¸ï¼šæœ¬è´¨ä¸Šå¯ä»¥ç†è§£ä¸ºä¸€ç§è½¯ä»¶ï¼Œæ§åˆ¶è®¡ç®—æœºçš„ç¡¬ä»¶èµ„æºï¼Œå¹¶æä¾›ä¸Šå±‚åº”ç”¨ç¨‹åºè¿è¡Œçš„ç¯å¢ƒã€‚<br>ç”¨æˆ·ç©ºé—´ï¼šä¸Šå±‚åº”ç”¨ç¨‹åºæ´»åŠ¨çš„ç©ºé—´ã€‚åº”ç”¨ç¨‹åºçš„æ‰§è¡Œå¿…é¡»ä¾æ‰˜äºå†…æ ¸æä¾›çš„èµ„æºï¼ŒåŒ…æ‹¬CPUèµ„æºã€å­˜å‚¨èµ„æºã€I/Oèµ„æºç­‰ã€‚<br>ç³»ç»Ÿè°ƒç”¨ï¼šä¸ºäº†ä½¿ä¸Šå±‚åº”ç”¨èƒ½å¤Ÿè®¿é—®åˆ°è¿™äº›èµ„æºï¼Œå†…æ ¸å¿…é¡»ä¸ºä¸Šå±‚åº”ç”¨æä¾›è®¿é—®çš„æ¥å£ï¼šå³ç³»ç»Ÿè°ƒç”¨ï¼›<br>æ‰€æœ‰è¿›ç¨‹åˆå§‹éƒ½è¿è¡Œäºç”¨æˆ·ç©ºé—´ï¼Œæ­¤æ—¶å³ä¸ºç”¨æˆ·è¿è¡ŒçŠ¶æ€ï¼ˆç®€ç§°ï¼šç”¨æˆ·æ€ï¼‰ï¼›<br>ï¼ˆå½“åº”ç”¨ç¨‹åºéœ€è¦ç”¨åˆ°é”®ç›˜ã€éœ€è¦å»è¯»å–æ–‡ä»¶ã€éœ€è¦é€šè¿‡ç½‘ç»œå»å‘é€ä¸€äº›èµ„æºçš„æ—¶å€™é‚£ä¹ˆè¯´ç™½äº†ä¹Ÿå°±æ˜¯éœ€è¦ç”¨åˆ°è®¡ç®—æœºçš„ä¸€äº›ç¡¬ä»¶èµ„æºçš„æ—¶å€™ï¼›é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±éœ€è¦é€šè¿‡ç³»ç»Ÿè°ƒç”¨åˆ°å†…æ ¸æ¥å¸®åŠ©æ‰§è¡Œï¼›æ™®é€šçš„åº”ç”¨ç¨‹åºåœ¨ç”¨æˆ·ç©ºé—´å½“ä¸­è¿è¡Œé‚£ä¹ˆå°±ç§°ä¹‹ä¸ºç”¨æˆ·æ€ï¼›å½“åº”ç”¨ç¨‹åºå¦‚æœéœ€è¦è°ƒç”¨å†…æ ¸çš„ä¸€äº›åŠŸèƒ½ï¼Œå³é€šè¿‡ç³»ç»Ÿè°ƒç”¨æ¥è¿›è¡Œè°ƒç”¨å†…æ ¸å½“ä¸­çš„ä¸€äº›åŠŸèƒ½ï¼›é‚£ä¹ˆè¿™ä¸ªæ—¶å€™åº”ç”¨ç¨‹åºå°±ä¼šè¿›å…¥å†…æ ¸æ€ï¼›é‚£ä¹ˆç”¨æˆ·æ€ä¸å†…æ ¸æ€çš„åˆ‡æ¢æ˜¯éœ€è¦ç³»ç»Ÿè°ƒç”¨æ¥è¿›è¡Œçš„ï¼›ï¼‰<br>ä½†æ˜¯å½“å®ƒè°ƒç”¨ç³»ç»Ÿè°ƒç”¨æ‰§è¡ŒæŸäº›æ“ä½œæ—¶ï¼Œä¾‹å¦‚I/Oè°ƒç”¨ï¼Œæ­¤æ—¶éœ€è¦é™·å…¥å†…æ ¸ä¸­è¿è¡Œï¼Œå°±ç§°ä¹‹ä¸º è¿›ç¨‹å¤„äºå†…æ ¸è¿è¡Œæ€ï¼ˆæˆ–ç®€ç§°ä¸º å†…æ ¸æ€ï¼‰ã€‚</p><p>ç³»ç»Ÿè°ƒç”¨çš„è¿‡ç¨‹å¯ä»¥ç®€å•ç†è§£ä¸ºï¼š</p><p><strong>1ã€</strong> ç”¨æˆ·æ€ç¨‹åºå°†ä¸€äº›æ•°æ®å€¼æ”¾åœ¨å¯„å­˜å™¨ä¸­ï¼Œæˆ–è€…ä½¿ç”¨å‚æ•°åˆ›å»ºä¸€ä¸ªå †æ ˆï¼Œä»¥æ­¤è¡¨æ˜éœ€è¦æ“ä½œç³»ç»Ÿæä¾›çš„æœåŠ¡ã€‚<br><strong>2ã€</strong> ç”¨æˆ·æ€ç¨‹åºæ‰§è¡Œç³»ç»Ÿè°ƒç”¨ã€‚<br><strong>3ã€</strong> CPUåˆ‡æ¢åˆ°å†…æ ¸æ€ï¼Œå¹¶è·³åˆ° ä½äºå†…å­˜æŒ‡å®šä½ç½® çš„æŒ‡ä»¤ã€‚<br><strong>4ã€</strong> ç³»ç»Ÿè°ƒç”¨å¤„ç†å™¨ï¼ˆsystem call handlerï¼‰ä¼šè¯»å–ç¨‹åºæ”¾å…¥å†…å­˜çš„æ•°æ®å‚æ•°ï¼Œå¹¶æ‰§è¡Œç¨‹åºè¯·æ±‚çš„æœåŠ¡ã€‚<br><strong>5ã€</strong> ç³»ç»Ÿè°ƒç”¨å®Œæˆåï¼Œæ“ä½œç³»ç»Ÿä¼šé‡ç½®CPUä¸ºç”¨æˆ·æ€å¹¶è¿”å›ç³»ç»Ÿè°ƒç”¨çš„ç»“æœã€‚</p><p>é¦–å…ˆåº”ç”¨ç¨‹åºå±äºç”¨æˆ·æ€ï¼›å³å°†è°ƒç”¨å†…æ ¸å‡½æ•°çš„æ—¶å€™ï¼Œé‚£ä¹ˆåº”ç”¨ç¨‹åºä¼šæŠŠç°åœ¨ç¨‹åºçš„ä¸€ä¸ªè¿è¡ŒçŠ¶æ€ä¸»è¦æ˜¯ç¨‹åºè¿è¡Œçš„ä¸€äº›è¿è¡Œæ•°å€¼è¿›è¡Œä¿å­˜å¯èƒ½ä¼šä¿å­˜åœ¨å¯„å­˜å™¨å½“ä¸­ä¹Ÿæœ‰å¯èƒ½ä½¿ç”¨å‚æ•°åˆ›å»ºä¸€ä¸ªå †æ ˆæ¥ä¿å­˜ç°åœ¨åº”ç”¨ç¨‹åºçš„ä¸€äº›è¿è¡Œä¿¡æ¯è¿è¡Œå‚æ•°ï¼›<br>é‚£ä¹ˆæ¥ç€ç”¨æˆ·æ€çš„åº”ç”¨ç¨‹åºå°±ä¼šæ¥è¿›è¡Œæ‰§è¡Œç³»ç»Ÿè°ƒç”¨ï¼›<br>é‚£ä¹ˆç»è¿‡ç³»ç»Ÿè°ƒç”¨ä¹‹åï¼ŒCPUå°±ä¼šåˆ‡æ¢åˆ°å†…æ ¸æ€ï¼›ç„¶ååˆ°å†…å­˜å½“ä¸­æŒ‡å®šçš„ä½ç½®å»æ‰§è¡Œç›¸å…³æŒ‡ä»¤ï¼›<br>æ¥ä¸‹æ¥ç³»ç»Ÿè°ƒç”¨å¤„ç†å™¨å®ƒä¼šè¿›è¡Œç”¨æˆ·æ€å½“ä¸­åº”ç”¨ç¨‹åºä¿å­˜åœ¨å †æ ˆæˆ–è€…æ˜¯ä¿å­˜åœ¨å¯„å­˜å™¨å½“ä¸­çš„ä¸€äº›è¿è¡Œä¿¡æ¯è¿è¡Œæ•°æ®ï¼Œç„¶åå¹¶ä¸”ä¼šæ‰§è¡Œç›¸åº”çš„å†…æ ¸å‡½æ•°ä»¥åŠè¯·æ±‚ä¸€äº›å†…æ ¸çš„æœåŠ¡ï¼›<br>é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ç³»ç»Ÿå°±ç”±ç”¨æˆ·æ€åˆ‡æ¢åˆ°äº†å†…æ ¸æ€ï¼›<br>é‚£ä¹ˆæ¥ç€å†…æ ¸å‡½æ•°çš„è°ƒç”¨åœ¨ç³»ç»Ÿè°ƒç”¨ä¸­è°ƒç”¨å®Œæ¯•ä¹‹åï¼›<br>æ“ä½œç³»ç»Ÿä¼šè¿›è¡Œé‡ç½®CPUåˆåˆ‡æ¢ä¸ºç”¨æˆ·æ€ï¼›å¹¶ä¸”å°†å†…æ ¸æ€å½“ä¸­è°ƒç”¨çš„ç»“æœè¿›è¡Œè¿”å›ï¼›é‚£ä¹ˆåº”ç”¨ç¨‹åºå°±åˆå›åˆ°äº†ç”¨æˆ·ç©ºé—´ï¼›å¾—åˆ°äº†å†…æ ¸å‡½æ•°ç³»ç»Ÿè°ƒç”¨è¿”å›çš„ç»“æœæ•°æ®ï¼›</p><p>ç”±æ­¤å¯è§ï¼Œç”¨æˆ·æ€åˆ‡æ¢è‡³å†…æ ¸æ€ éœ€è¦ä¼ é€’è®¸å¤šå˜é‡ï¼ŒåŒæ—¶å†…æ ¸è¿˜éœ€è¦ä¿æŠ¤å¥½ç”¨æˆ·æ€åœ¨åˆ‡æ¢æ—¶çš„ä¸€äº›å¯„å­˜å™¨å€¼ã€å˜é‡ç­‰ï¼Œä»¥å¤‡å†…æ ¸æ€åˆ‡æ¢å›ç”¨æˆ·æ€ã€‚<br>è¿™ç§åˆ‡æ¢å°±å¸¦æ¥äº†å¤§é‡çš„ç³»ç»Ÿèµ„æºæ¶ˆè€—ï¼Œè¿™å°±æ˜¯synchronizedæœªä¼˜åŒ–ä¹‹å‰ï¼Œæ•ˆç‡ä½çš„åŸå› ï¼ˆå±äºé‡é‡çº§é”ï¼‰ã€‚</p><h3 id="monitoræ˜¯é‡é‡çº§é”"><a href="#monitoræ˜¯é‡é‡çº§é”" class="headerlink" title="monitoræ˜¯é‡é‡çº§é”"></a>monitoræ˜¯é‡é‡çº§é”</h3><p>åœ¨è™šæ‹Ÿæœºè§„èŒƒå¯¹ monitorenter å’Œ monitorexit çš„è¡Œä¸ºæè¿°ä¸­ï¼Œ<br>æœ‰ä¸¤ç‚¹æ˜¯éœ€è¦ç‰¹åˆ«æ³¨æ„çš„ã€‚  </p><p>é¦–å…ˆï¼ŒsynchronizedåŒæ­¥å— å¯¹ åŒä¸€æ¡çº¿ç¨‹æ¥è¯´æ˜¯å¯é‡å…¥çš„ï¼Œä¸ä¼šå‡ºç°è‡ªå·±æŠŠè‡ªå·±é”æ­»çš„é—®é¢˜ã€‚</p><p>å…¶æ¬¡ï¼ŒåŒæ­¥å—åœ¨å·²è¿›å…¥çš„çº¿ç¨‹æ‰§è¡Œå®Œä¹‹å‰ï¼Œä¼šé˜»å¡åé¢å…¶ä»–çº¿ç¨‹çš„è¿›å…¥ã€‚  </p><p>ç¬¬12ç« è®²è¿‡ï¼Œjavaçš„çº¿ç¨‹ æ˜¯ æ˜ å°„åˆ° æ“ä½œç³»ç»Ÿçš„ åŸç”Ÿçº¿ç¨‹ ä¹‹ä¸Šçš„ï¼Œ<br>å¦‚æœè¦ é˜»å¡æˆ–å”¤é†’ ä¸€ä¸ªçº¿ç¨‹ï¼Œéƒ½éœ€è¦æ“ä½œç³»ç»Ÿæ¥å¸®å¿™å®Œæˆï¼Œ è¿™å°±éœ€è¦ä»ç”¨æˆ·æ€è½¬æ¢åˆ°æ ¸å¿ƒæ€ä¸­ï¼Œå› æ­¤ çŠ¶æ€è½¬æ¢éœ€è¦è€—è´¹å¾ˆå¤šçš„å¤„ç†å™¨æ—¶é—´ã€‚</p><p>å¯¹äºä»£ç ç®€å•çš„åŒæ­¥å—ï¼ˆå¦‚è¢«synchronizedä¿®é¥°çš„ getter()æˆ–setter()æ–¹æ³•ï¼‰ï¼Œ<br>çŠ¶æ€è½¬æ¢æ¶ˆè€—çš„æ—¶é—´ æœ‰å¯èƒ½æ¯” ç”¨æˆ·ä»£ç æ‰§è¡Œçš„æ—¶é—´è¿˜è¦é•¿ã€‚</p><p>æ‰€ä»¥ synchronized æ˜¯javaè¯­è¨€ä¸­ä¸€ä¸ªé‡é‡çº§ï¼ˆHeavyweightï¼‰çš„æ“ä½œï¼Œæœ‰ç»éªŒçš„ç¨‹åºå‘˜éƒ½ä¼šåœ¨ç¡®å®å¿…è¦çš„æƒ…å†µä¸‹æ‰ä½¿ç”¨è¿™ç§æ“ä½œã€‚  </p><p>è€Œè™šæ‹Ÿæœºæœ¬èº«ä¹Ÿä¼šè¿›è¡Œä¸€äº›ä¼˜åŒ–ï¼Œè­¬å¦‚åœ¨é€šçŸ¥æ“ä½œç³»ç»Ÿé˜»å¡çº¿ç¨‹ä¹‹å‰åŠ å…¥ä¸€æ®µè‡ªæ—‹ç­‰å¾…è¿‡ç¨‹ï¼Œé¿å…é¢‘ç¹åœ°åˆ‡å…¥åˆ°æ ¸å¿ƒæ€ä¹‹ä¸­ã€‚  </p><p>å¯ä»¥çœ‹åˆ°ObjectMonitorçš„å‡½æ•°è°ƒç”¨ä¸­ä¼šæ¶‰åŠåˆ° Atomic::cmpxchg_ptrï¼ŒAtomic::inc_prtç­‰å†…æ ¸å‡½æ•°ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šå­˜åœ¨æ“ä½œç³»ç»Ÿç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„è½¬æ¢ï¼Œè¿™ç§åˆ‡æ¢ä¼šæ¶ˆè€—å¤§é‡çš„ç³»ç»Ÿèµ„æºã€‚</p><p>ç”¨æˆ·æ€å’Œå†…æ ¸æ€æ˜¯ä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿ<br>è¦æƒ³äº†è§£ç”¨æˆ·æ€å’Œå†…æ ¸æ€è¿˜éœ€è¦å…ˆäº†è§£ä¸€ä¸‹Linuxç³»ç»Ÿçš„ä½“ç³»æ¶æ„ï¼š</p><h2 id="synchronizedä¼˜åŒ–-CAS-AtomicIntegerä½¿ç”¨"><a href="#synchronizedä¼˜åŒ–-CAS-AtomicIntegerä½¿ç”¨" class="headerlink" title="synchronizedä¼˜åŒ–_CAS_AtomicIntegerä½¿ç”¨"></a>synchronizedä¼˜åŒ–_CAS_AtomicIntegerä½¿ç”¨</h2><blockquote><p>ç¬¬å…­ç« ï¼šJDK6 synchronizedä¼˜åŒ–</p></blockquote><ul><li>CAS<ul><li>JDK6å½“ä¸­å¯¹synchronizedæ‰€åšçš„ä¼˜åŒ–å¤„ç†ï¼›</li><li>åœ¨JDK6å½“ä¸­å¯¹synchronizedåšäº†å¤§é‡çš„ä¼˜åŒ–å¤„ç†ï¼›</li><li>ä»¥åŠè¿™äº›ä¼˜åŒ–å¤„ç†å¾ˆå¤šéƒ½æ¶‰åŠåˆ°äº†CASæ“ä½œï¼›</li></ul></li><li>é”å‡çº§è¿‡ç¨‹<ul><li>é”å‡çº§ä¾èµ–javaå¯¹è±¡å¤´ï¼›</li></ul></li><li>Javaå¯¹è±¡çš„å¸ƒå±€</li><li>åå‘é”</li><li>è½»é‡çº§é”</li><li>é‡é‡çº§é”</li><li>é”æ¶ˆé™¤</li><li>é”ä¼˜åŒ–</li><li>å¹³æ—¶å†™ä»£ç å¦‚ä½•å¯¹synchronizedä¼˜åŒ–</li></ul><h3 id="ç›®æ ‡-16"><a href="#ç›®æ ‡-16" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>å­¦ä¹ CASçš„ä½œç”¨<br>å­¦ä¹ CASçš„åŸç†</p><h3 id="CASæ¦‚è¿°å’Œä½œç”¨"><a href="#CASæ¦‚è¿°å’Œä½œç”¨" class="headerlink" title="CASæ¦‚è¿°å’Œä½œç”¨"></a>CASæ¦‚è¿°å’Œä½œç”¨</h3><p>CASçš„å…¨ç§°æ˜¯ Compare And Swapï¼ˆæ¯”è¾ƒå†äº¤æ¢ï¼‰ã€‚<br>ï¼ˆç¡®åˆ‡ä¸€ç‚¹ç§°ä¹‹ä¸ºï¼šæ¯”è¾ƒå¹¶ä¸”ç›¸åŒå†åšäº¤æ¢ï¼‰<br>æ˜¯ç°ä»£CPUå¹¿æ³›æ”¯æŒçš„ä¸€ç§å¯¹å†…å­˜ä¸­çš„å…±äº«æ•°æ®è¿›è¡Œæ“ä½œçš„ä¸€ç§ç‰¹æ®ŠæŒ‡ä»¤ã€‚</p><p>CASçš„ä½œç”¨æ˜¯ï¼šCASå¯ä»¥å°†æ¯”è¾ƒå’Œäº¤æ¢è½¬æ¢ä¸ºåŸå­æ“ä½œï¼Œè¿™ä¸ªåŸå­æ“ä½œç›´æ¥ç”±å¤„ç†å™¨CPUä¿è¯ã€‚<br>CASå¯ä»¥ä¿è¯å…±äº«å˜é‡èµ‹å€¼æ—¶çš„åŸå­æ“ä½œï¼›<br>CASåœ¨æ“ä½œæ—¶ä¾èµ–ä¸‰ä¸ªå€¼ï¼›å†…å­˜ä¸­çš„å€¼Vã€æ—§çš„é¢„ä¼°å€¼Xã€è¦ä¿®æ”¹çš„æ–°å€¼Bï¼Œ<br>å¦‚æœæ—§çš„é¢„ä¼°å€¼Xç­‰äºå†…å­˜ä¸­çš„å€¼Vï¼Œå°±å°†æ–°çš„å€¼Bä¿å­˜åˆ°å†…å­˜ä¸­ï¼›æ›¿æ¢è¿™ä¸ªå†…å­˜ä¸­çš„å€¼Vï¼›</p><p>(å¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªè½»é‡çº§çš„synchronizedï¼Œå®ƒèƒ½ä¿è¯å˜é‡ä¿®æ”¹çš„åŸå­æ“ä½œ)</p><h4 id="CASå’Œvolatileå®ç°æ— é”å¹¶å‘"><a href="#CASå’Œvolatileå®ç°æ— é”å¹¶å‘" class="headerlink" title="CASå’Œvolatileå®ç°æ— é”å¹¶å‘"></a>CASå’Œvolatileå®ç°æ— é”å¹¶å‘</h4><p>javaå½“ä¸­å·²ç»æä¾›å¥½äº†ä¸€ä¸ªç±»å«åšAtomicIntegerï¼›<br>è¿™ä¸ªç±»å…¶åº•å±‚å³ä½¿ç”¨çš„å°±æ˜¯CASï¼›</p><blockquote><p>å›é¡¾ä»£ç </p></blockquote><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xxx.demo05_cas;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.atomic.AtomicInteger;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> class Demo01&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="keyword">String</span>[] args)<span class="keyword">throws</span> InterruptedException&#123;</span><br><span class="line">    AtomicInteger atomicInteger = <span class="keyword">new</span> AtomicInteger();</span><br><span class="line">    Runnable mr = ()-&gt;&#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++)&#123;</span><br><span class="line">        atomicInteger.incrementAndGet();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    ArrayList&lt;Thread&gt; ts = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span>( <span class="built_in">int</span> i=<span class="number">0</span>; i &lt; <span class="number">5</span> ; i++)&#123;</span><br><span class="line">      Thread t = <span class="keyword">new</span> Thread(mr);</span><br><span class="line">      t.start();</span><br><span class="line">      ts.<span class="built_in">add</span>(t);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(Thread t:ts)&#123;</span><br><span class="line">        t.<span class="built_in">join</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    System.out.<span class="built_in">println</span>(<span class="string">"number = "</span> + atomicInteger.<span class="built_in">get</span>());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">-------------------------------------------------------------</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  ç›®æ ‡ï¼šæ¼”ç¤ºåŸå­æ€§é—®é¢˜</span></span><br><span class="line"><span class="comment">    1. å®šä¹‰ä¸€ä¸ªå…±äº«å˜é‡</span></span><br><span class="line"><span class="comment">    2. å¯¹numberè¿›è¡Œ1000æ¬¡çš„++æ“ä½œ</span></span><br><span class="line"><span class="comment">    3. ä½¿ç”¨5ä¸ªçº¿ç¨‹æ¥è¿›è¡Œ</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo01</span>&#123;</span></span><br><span class="line">  <span class="comment">// 1. å®šä¹‰ä¸€ä¸ªå…±äº«å˜é‡</span></span><br><span class="line">  <span class="comment">//private static int number = 0;</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> AtomicInteger atomicInteger = <span class="keyword">new</span> AtomicInteger();</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(<span class="keyword">String</span>[] args)</span>throws InterruptedException</span>&#123;</span><br><span class="line">    <span class="comment">// 2. å¯¹numberè¿›è¡Œ1000çš„++æ“ä½œ</span></span><br><span class="line">    Runnable increment = ()-&gt;&#123;</span><br><span class="line">      <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">1000</span>; i++)&#123;</span><br><span class="line">        <span class="comment">//number++;</span></span><br><span class="line">        atomicInteger.incrementAndGet();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    List&lt;Thread&gt; <span class="built_in">list</span> = <span class="keyword">new</span> ArrayList&lt;Thread&gt;();</span><br><span class="line">    <span class="comment">// 3. ä½¿ç”¨5ä¸ªçº¿ç¨‹æ¥è¿›è¡Œ</span></span><br><span class="line">    <span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; <span class="number">5</span>; i++)&#123;</span><br><span class="line">      Thread t = <span class="keyword">new</span> Thread(increment);</span><br><span class="line">      t.start();</span><br><span class="line">      <span class="built_in">list</span>.add(t);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(Thread t: <span class="built_in">list</span>)&#123;</span><br><span class="line">      t.join();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//System.out.println("number = " + number);</span></span><br><span class="line">    System.out.<span class="built_in">println</span>(<span class="string">"atomicInteger = "</span> + atomicInteger.<span class="built_in">get</span>());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">ç”±äºnumber++å¹¶ä¸æ˜¯åŸå­æ“ä½œï¼›</span></span><br><span class="line"><span class="comment">æ‰€ä»¥å°±ä¼šå¯¼è‡´åŸå­æ€§é—®é¢˜çš„äº§ç”Ÿï¼›</span></span><br><span class="line"><span class="comment">å³æœ€åä¼šå¯¼è‡´numberè¾“å‡ºæ—¶numberçš„å€¼æ˜¯å°äº5000çš„ï¼›</span></span><br><span class="line"><span class="comment">  private static int number = 0;</span></span><br><span class="line"><span class="comment">é‚£ä¹ˆæ­¤æ—¶å°±ä¸ä½¿ç”¨intç±»å‹çš„å…±äº«å˜é‡numberäº†ï¼›</span></span><br><span class="line"><span class="comment">è€Œæ˜¯ç»™å…±äº«å˜é‡numberæ¢ä¸€ç§ç±»å‹å«åšAtomicIntegerç±»å‹ï¼›</span></span><br><span class="line"><span class="comment">  private static AtomicInteger atomicInteger = new AtomicInteger();</span></span><br><span class="line"><span class="comment">å˜é‡ånumberæ¢ä¸ºatomicIntegerï¼›</span></span><br><span class="line"><span class="comment">å¹¶ä¸”number++æ“ä½œä¹Ÿè¦æ¢æˆatomicInteger.incrementAndGet();</span></span><br><span class="line"><span class="comment">é‚£ä¹ˆatomicInteger.incrementAndGet()ä¹Ÿä¼šå»åšä¸€ä¸ªè‡ªå¢æ“ä½œï¼›</span></span><br><span class="line"><span class="comment">å…¶è¯¥è‡ªå¢æ“ä½œæ˜¯ä¸€ä¸ªåŸå­æ€§çš„æ“ä½œï¼›</span></span><br><span class="line"><span class="comment">æœ€åæ‰“å°atomicIntegerçš„æœ€æ–°å€¼ï¼›é€šè¿‡atomicInteger.get()æ¥è¿›è¡Œè·å–atomicIntegerçš„æœ€æ–°å€¼ï¼›</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">æœ€åå†æ€ä¹ˆè¿è¡Œå‘ç°è¿è¡Œç»“æœéƒ½æ˜¯5000ï¼›</span></span><br><span class="line"><span class="comment">ä¹Ÿå°±æ„å‘³ç€ AtomicIntegerçš„incrementAndGet()æ–¹æ³•å¯ä»¥è¿›è¡Œä¿è¯å…±äº«å˜é‡èµ‹å€¼çš„åŸå­æ€§ï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">-------------------------------------------------------------</span><br><span class="line">å¤šæ¬¡è¿è¡Œåçš„è¿è¡Œæ‰“å°ï¼š</span><br><span class="line">atomicInteger = <span class="number">5000</span></span><br><span class="line">atomicInteger = <span class="number">5000</span></span><br><span class="line">atomicInteger = <span class="number">5000</span></span><br><span class="line">.....</span><br><span class="line">-------------------------------------------------------------</span><br></pre></td></tr></table></figure><h2 id="synchronizedä¼˜åŒ–-CASåŸç†"><a href="#synchronizedä¼˜åŒ–-CASåŸç†" class="headerlink" title="synchronizedä¼˜åŒ–_CASåŸç†"></a>synchronizedä¼˜åŒ–_CASåŸç†</h2><p>CAS åŸç†</p><p>é€šè¿‡åˆšæ‰ AtomicInteger çš„æºç å¯ä»¥çœ‹åˆ°ï¼Œ Unsafeç±»æä¾›äº†åŸå­æ“ä½œã€‚<br>AtomicIntegerç±»å½“ä¸­å…¶å†…éƒ¨ä¼šåŒ…å«ä¸€ä¸ªå«åšUnSafeçš„ç±»ï¼›<br>UnSafeè¯¥ç±»å¯ä»¥è¿›è¡Œä¿è¯å˜é‡åœ¨èµ‹å€¼æ—¶çš„åŸå­æ“ä½œï¼›<br>ä¹Ÿå°±æ˜¯UnSafeç±»å½“ä¸­æä¾›äº†CASæ“ä½œï¼›</p><h3 id="Unsafeç±»ä»‹ç»"><a href="#Unsafeç±»ä»‹ç»" class="headerlink" title="Unsafeç±»ä»‹ç»"></a>Unsafeç±»ä»‹ç»</h3><p>javaæ˜¯æ— æ³•å»æ“ä½œå†…å­˜åœ°å€çš„ï¼ˆå³ä¹Ÿå°±æ˜¯æ²¡æœ‰æŒ‡é’ˆï¼‰ï¼›</p><p>Unsafeç±»ä½¿javaæ‹¥æœ‰äº†åƒCè¯­è¨€çš„æŒ‡é’ˆä¸€æ ·æ“ä½œå†…å­˜ç©ºé—´çš„èƒ½åŠ›ï¼ˆæ“ä½œå¯¹è±¡çš„å†…å­˜ç©ºé—´å³èƒ½å¤Ÿæ“ä½œå¯¹è±¡é‡Œé¢çš„å†…å®¹ï¼›ä½†æ˜¯è¿™ä¸ªUnSafeç±»ä¸å¤ªå®‰å…¨ï¼›å¦‚æœä½¿ç”¨ä¸å½“ä¼šå‡ºç°ä¸€äº›æ¯”è¾ƒå±é™©çš„äº‹æƒ…ï¼›æ‰€ä»¥javaå®˜æ–¹å¹¶ä¸æ¨èä½¿ç”¨ï¼›å¹¶ä¸”åœ¨jdkå½“ä¸­ä¹Ÿæ— æ³•æ‰¾åˆ°æ­¤ç±»ï¼›åªèƒ½å¤Ÿé€šè¿‡åå°„çš„æ–¹å¼æ‰èƒ½å¤Ÿæ‰¾åˆ°è¯¥ç±»ï¼‰ï¼ŒåŒæ—¶ä¹Ÿå¸¦æ¥äº†æŒ‡é’ˆçš„é—®é¢˜ã€‚<br>è¿‡æ¸¡çš„ä½¿ç”¨Unsafeç±»ä¼šä½¿å¾—å‡ºé”™çš„å‡ ç‡å˜å¤§ï¼Œå› æ­¤Javaå®˜æ–¹å¹¶ä¸å»ºè®®ä½¿ç”¨çš„ï¼Œå®˜æ–¹æ–‡æ¡£ä¹Ÿå‡ ä¹æ²¡æœ‰ã€‚<br>Unsafeå¯¹è±¡ä¸èƒ½ç›´æ¥è°ƒç”¨ï¼Œåªèƒ½é€šè¿‡åå°„è·å¾—ã€‚  </p><h3 id="Unsafeå®ç°CAS"><a href="#Unsafeå®ç°CAS" class="headerlink" title="Unsafeå®ç°CAS"></a>Unsafeå®ç°CAS</h3><blockquote><p>AtomicInteger.javaæºç </p></blockquote><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line">publlic <span class="class"><span class="keyword">class</span> <span class="title">AtomicInteger</span> <span class="title">extends</span> <span class="title">Number</span> <span class="title">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> static <span class="keyword">final</span> long serialVersionUID = <span class="number">6214790243416807050L</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// setup to use Unsafe.compareAndSwapInt for updates</span></span><br><span class="line">  <span class="keyword">private</span> static <span class="keyword">final</span> Unsafe unsafe = Unsafe.getUnsafe();</span><br><span class="line">  <span class="keyword">private</span> static <span class="keyword">final</span> long valueOffset;</span><br><span class="line">  static &#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">      valueOffset = unsafe.objectFieldOffset(</span><br><span class="line">        AtomicInteger<span class="class">.<span class="keyword">class</span>.<span class="title">getDeclareField</span></span>(<span class="string">"value"</span>)</span><br><span class="line">      );</span><br><span class="line">    &#125;<span class="keyword">catch</span>(Exception ex)&#123; <span class="keyword">throw</span> new Error(ex);&#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">volatile</span> int value;</span><br><span class="line">  ......</span><br><span class="line">&#125;</span><br><span class="line">-------------------------------------------------------</span><br><span class="line">AtomicIntegerå†…éƒ¨å…·æœ‰ä¸€ä¸ªæˆå‘˜å˜é‡unsafeï¼Œé€šè¿‡Unsafe.getUnsafe()å¾—åˆ°ï¼›</span><br><span class="line">å¦å¤–éœ€è¦æ³¨æ„çš„è¿˜æ˜¯AtomicIntegeræ˜¯ç”¨æ¥è¿›è¡Œä¿å­˜æ•°å­—çš„ï¼›</span><br><span class="line">è¯¥AtomicIntegeræ•°å€¼ä¿å­˜åœ¨AtomicIntegerç±»æˆå‘˜å˜é‡valueå½“ä¸­ï¼›</span><br><span class="line">è€Œä¸”è¯¥valueæˆå‘˜å˜é‡ä½¿ç”¨äº†<span class="keyword">volatile</span>å…³é”®å­—è¿›è¡Œä¿®é¥°ï¼›</span><br><span class="line"><span class="keyword">volatile</span>å³ä¿è¯äº†å¤šçº¿ç¨‹æ“ä½œæ—¶çš„å¯è§æ€§ï¼›</span><br><span class="line">å¦å¤–AtomicIntegerç±»ä¸­è¿˜æœ‰ä¸€ä¸ªæˆå‘˜å˜é‡valueOffsetï¼›</span><br><span class="line">é‚£ä¹ˆvalueOffsetçš„ä½œç”¨å³ç”¨æ¥æ‰¾åˆ°<span class="keyword">volatile</span>å…³é”®å­—ä¿®é¥°çš„valueå˜é‡çš„å†…å­˜åœ°å€ï¼›</span><br><span class="line">åˆ°æ—¶å€™æ ¹æ®AtomicIntegerç±»æ‰€ç”Ÿæˆçš„å¯¹è±¡atomicIntegerçš„å†…å­˜åœ°å€å†åŠ ä¸Šåç§»é‡valueOffsetå°±å¯ä»¥æ‰¾åˆ°valueæ‰€åœ¨çš„å†…å­˜åœ°å€äº†ï¼›</span><br><span class="line">ä¹Ÿå°±å¯ä»¥æ‰¾åˆ°valueçš„å–å€¼ï¼›ä¹Ÿå°±å¯ä»¥å¯¹valueè¿›è¡Œä¿®æ”¹ç­‰æ“ä½œï¼›</span><br><span class="line">-------------------------------------------------------------</span><br><span class="line"># javaæµ‹è¯•ç”¨ä¾‹ä»£ç </span><br><span class="line">Demo01.java</span><br><span class="line">    <span class="keyword">private</span> static AtomicInteger atomicInteger =  new AtomicInteger();</span><br><span class="line"></span><br><span class="line">    Runnable increment = ()-&gt;&#123;</span><br><span class="line">      <span class="keyword">for</span>( int i = <span class="number">0</span> ; i &lt; <span class="number">1000</span>; i++)&#123;</span><br><span class="line">        atomicInteger.incrementAndGet();  <span class="comment">// å˜é‡èµ‹å€¼çš„åŸå­æ€§</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">-------------------------------------------------------------</span><br><span class="line"># AtomicInteger.incrementAndGet()æ–¹æ³•ä¸­å…·ä½“æ‰§è¡Œæµç¨‹ï¼›åˆ†ææºç ï¼›</span><br><span class="line">-------------------</span><br><span class="line">AtomicInteger.java</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> int value;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> int incrementAndGet()&#123;</span><br><span class="line">      <span class="keyword">return</span> unsafe.getAndAddInt(<span class="keyword">this</span>, valueOffset, <span class="number">1</span>)+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">------------------</span><br><span class="line">        â†“</span><br><span class="line">------------------</span><br><span class="line">Unsafe<span class="class">.<span class="keyword">class</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> int getAndAddInt(Object var1, long var2, int var4)&#123;</span><br><span class="line">      int var5;</span><br><span class="line">      <span class="keyword">do</span>&#123;</span><br><span class="line">        var5 = <span class="keyword">this</span>.getIntVolatile(var1 , var2);</span><br><span class="line">      &#125;<span class="keyword">while</span>(!<span class="keyword">this</span>.compareAndSwapInt(var1, var2, var5, var5+var4));</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> var5;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//compareAndSwapInt CASæ“ä½œ</span></span><br><span class="line">------------------</span><br><span class="line">åˆ†ææ‰§è¡Œæµç¨‹ï¼š</span><br><span class="line">å½“åˆšè¿›è¡Œåˆ›å»ºAtomicIntegerå¯¹è±¡ï¼ˆAtomicInteger atomicInteger=new AtomicInteger();ï¼‰æ—¶å…¶AtomicInteger.javaå½“ä¸­é€šè¿‡<span class="keyword">volatile</span>ä¿®é¥°çš„valueå˜é‡å–å€¼ä¸º<span class="number">0</span>ï¼›</span><br><span class="line">å‡è®¾AtomicIntegerå½“ä¸­çš„æˆå‘˜å˜é‡valueå–å€¼ä¸º<span class="number">0</span>ä¹‹åï¼›</span><br><span class="line">é‚£ä¹ˆå½“å‰æ¥è¿›è¡Œ<span class="keyword">for</span>å¾ªç¯atomicIntegerè¿›è¡Œæ‰§è¡ŒincrementAndGet()æ–¹æ³•ï¼›</span><br><span class="line">å³ä¹Ÿå°±æ„å‘³ç€ä¼šæ‰§è¡Œåˆ°AtomicInteger.javaç±»å½“ä¸­çš„incrementAndGet()æ–¹æ³•ï¼›</span><br><span class="line">é‚£ä¹ˆAtomicInteger.javaç±»å½“ä¸­çš„incrementAndGetæ–¹æ³•ä¸­åˆä¼šå»é€šè¿‡unsafeæˆå‘˜å˜é‡å»æ‰§è¡Œæ–¹æ³•getAndAddInt(<span class="keyword">this</span> , valueOffset, <span class="number">1</span>)+<span class="number">1</span>;</span><br><span class="line">å³å°±ç›¸å½“äºè°ƒç”¨åˆ°äº†Unsafe<span class="class">.<span class="keyword">class</span>å½“ä¸­çš„<span class="title">getAndAddInt</span></span>(Object var1, long var2, int var4)æ–¹æ³•ï¼›</span><br><span class="line">æœ€åUnsafe<span class="class">.<span class="keyword">class</span>å°±åœ¨<span class="title">getAndAddInt</span></span>(Object var1, long var2, int var4)å½“ä¸­è¿›è¡ŒCASçš„æ“ä½œå³<span class="keyword">this</span>.compareAndSwapInt(var1, var2, var5, var5+var4);</span><br><span class="line"></span><br><span class="line">å½“å‰å‡è®¾æœ‰ä¸¤ä¸ªçº¿ç¨‹ï¼Œåˆ†åˆ«æ˜¯çº¿ç¨‹t1å’Œçº¿ç¨‹t2ï¼›</span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶è¿™ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶æ¥è¿›è¡Œæ‰§è¡ŒRunnableå½“ä¸­æ‰€å®ç°çš„run()æ–¹æ³•å³å»æ‰§è¡Œå¾ªç¯ï¼Œå¾ªç¯ä¸­æ‰§è¡ŒatomicInteger.incrementAndGet()æ–¹æ³•ï¼›</span><br><span class="line">å‡è®¾t2çº¿ç¨‹å…ˆèµ°ï¼Œé‚£ä¹ˆt2çº¿ç¨‹å°±ä¼šèµ°è¿‡</span><br><span class="line">Demo01.javaå½“ä¸­çš„atomicInteger.incrementAndGet()</span><br><span class="line">                   â†“</span><br><span class="line">AtomicInteger.javaå½“ä¸­çš„incrementAndgetæ–¹æ³•ä¸­çš„unsafe.getAndAddInt(<span class="keyword">this</span>, valueOffset, <span class="number">1</span>)+<span class="number">1</span></span><br><span class="line">                   â†“</span><br><span class="line">UnSafe<span class="class">.<span class="keyword">class</span>å½“ä¸­çš„<span class="title">getAndAddInt</span></span>(Object var1, long var2, int var4)å½“ä¸­çš„ä»£ç </span><br><span class="line">---------------------</span><br><span class="line">åœ¨Unsafe<span class="class">.<span class="keyword">class</span>å½“ä¸­çš„<span class="title">getAndAddInt</span></span>(Object var1, long var2, int var4)å½“ä¸­çš„var5çš„å«ä¹‰ä»£è¡¨çš„æ˜¯ï¼šï¼ˆå¯ä»¥ç†è§£ä¸ºæ˜¯ï¼‰æ—§çš„é¢„ä¼°å€¼ï¼›</span><br><span class="line">æ­¤æ—¶t2çº¿ç¨‹å³å‡†å¤‡è¿›å…¥åˆ°ä»£ç å±‚ä¸­çš„<span class="keyword">do</span>-<span class="keyword">while</span>å¾ªç¯ï¼›</span><br><span class="line">é‚£ä¹ˆå…ˆæ‰§è¡Œ<span class="keyword">do</span>&#123;&#125;å—å½“ä¸­çš„å†…å®¹è¿›è¡Œè·å–var5çš„å–å€¼ï¼Œå³è·å–æ—§çš„é¢„ä¼°å€¼å–å€¼ï¼›</span><br><span class="line">è·å–var5å–å€¼æ˜¯é€šè¿‡ <span class="keyword">this</span>.getIntVolatile(var1, var2)æ–¹æ³•è¿›è¡Œè·å–å¾—åˆ°çš„ï¼›</span><br><span class="line">é€šè¿‡ä¸¤ä¸ªå‚æ•°var1ä»¥åŠvar2å°±èƒ½å¤Ÿè·å–å¾—åˆ°ä¸€ä¸ªintç±»å‹çš„å–å€¼å³var5ï¼›</span><br><span class="line">è¿™ä¸¤ä¸ªå‚æ•°å½“ä¸­çš„var1å³Object var1ï¼Œ</span><br><span class="line">è¯¥var1å³AtomicInteger.javaçš„incrementAndGet()æ–¹æ³•å½“ä¸­çš„<span class="keyword">this</span>ï¼Œ</span><br><span class="line">ä¹Ÿå°±æ˜¯åœ¨Demo01.javaå½“ä¸­newå¥½çš„atomicIntegerå¯¹è±¡ï¼ˆAtomicInteger atomicInteger = new AtomicInteger();ï¼‰ï¼›</span><br><span class="line">é‚£ä¹ˆvar2å³ä¸ºAtomicInteger.javaçš„incrementAndGet()æ–¹æ³•å½“ä¸­çš„valueOffsetï¼Œæ˜¯ä¸€ä¸ªå†…å­˜åç§»å€¼ï¼›</span><br><span class="line">é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ var1+var2 â†’ <span class="keyword">this</span>+valueOffset å…¶ç›®çš„ä¹Ÿå°±æ˜¯æ‰¾åˆ°<span class="keyword">private</span> <span class="keyword">volatile</span> valueçš„å–å€¼ï¼›æ‰¾åˆ°AtomicInteger.javaå½“ä¸­çš„æˆå‘˜å˜é‡valueçš„å–å€¼ï¼›</span><br><span class="line">ï¼ˆå³å½“å‰AtomicIntegerè¦æ‰§è¡Œç±»ä¼¼number++çš„æ“ä½œï¼›è€ŒAtomicIntegeræ‰€å­˜çš„è‡ªå¢æ•°å€¼è¢«å­˜æ”¾åœ¨å…¶AtomicIntegeræˆå‘˜å˜é‡valueå½“ä¸­ï¼›åœ¨è¿›è¡Œè‡ªå¢æ“ä½œæ—¶é¦–å…ˆå°±éœ€è¦å»è·å–åŸå…ˆè¯¥AtomicIntegerå½“ä¸­valueçš„å–å€¼ä¸ºå¤šå°‘æˆ–è€…æ˜¯æ‰¾åˆ°valueçš„å†…å­˜åœ°å€ç­‰ä¿¡æ¯ç„¶åå¯¹è¯¥valueè¿›è¡Œä¸€ä¸ªé‡æ–°èµ‹å€¼çš„ä¸€ä¸ªæ“ä½œï¼Œä¿®æ”¹æ“ä½œï¼›ï¼‰</span><br><span class="line">æ‰¾åˆ°AtomicIntegerå½“ä¸­valueçš„å–å€¼æ¥ä½œä¸ºä¸€ä¸ªæ—§çš„é¢„ä¼°å€¼ï¼›</span><br><span class="line">é‚£ä¹ˆå½“å‰åœ¨åˆ›å»ºAtomicInteger atomicIntegerå¯¹è±¡çš„æ—¶å€™ï¼ŒAtomicIntegerå½“ä¸­çš„æˆå‘˜å˜é‡å±æ€§valueå–å€¼ä¸º<span class="number">0</span>ï¼›</span><br><span class="line">å³ç°åœ¨é€šè¿‡var1+var2 â†’ <span class="keyword">this</span>+valueOffsetå‚æ•°è°ƒç”¨<span class="keyword">this</span>.getIntVolatileæ–¹æ³•è·å–å¾—åˆ°çš„å–å€¼ä¸º<span class="number">0</span>å³èµ‹å€¼ç»™var5ï¼›</span><br><span class="line">å‡è®¾ä¸€ç§æç«¯çš„æƒ…å†µï¼›å³t2çº¿ç¨‹æ‰¾åˆ°æ—§çš„é¢„ä¼°å€¼ä¹‹åå³var5å˜é‡è¢«èµ‹å€¼ï¼›</span><br><span class="line">æ­¤æ—¶CPUåˆ‡æ¢åˆ°äº†å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä¸Šé¢å»äº†ï¼›</span><br><span class="line">åˆ‡æ¢åˆ°t1çº¿ç¨‹ä¸Šæ¥äº†ï¼›</span><br><span class="line">é‚£ä¹ˆt1çº¿ç¨‹ä¹Ÿä¼šæ¥è¿›è¡Œæ‰§è¡ŒAtomicIntegerç±»å½“ä¸­çš„incrementAndGetæ–¹æ³•ï¼›</span><br><span class="line">å³t1çº¿ç¨‹ä¹Ÿä¼šè¿›å…¥åˆ°Unsafe<span class="class">.<span class="keyword">class</span>å½“ä¸­çš„<span class="title">getAndAddInt</span>æ–¹æ³•ä¸­æ¥ï¼›</span></span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶t1ä¹Ÿä¼šæ¥è¿›è¡Œå¯»æ‰¾ä¸€ä¸ªæ—§çš„é¢„ä¼°å€¼å³ä¹Ÿä¼šè¿›å…¥<span class="keyword">do</span>&#123;&#125;å—å½“ä¸­è¿›è¡Œè°ƒç”¨<span class="keyword">this</span>.getIntVolatileæ¥è¿›è¡Œç»™var5è¿›è¡Œèµ‹å€¼ï¼›ä¹Ÿæ˜¯é€šè¿‡<span class="keyword">this</span>å’ŒvalueOffsetæ¥è¿›è¡Œæ‰¾åˆ°valueçš„å–å€¼ï¼›</span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶å°±ä¼šå­˜åœ¨æœ‰ä¸¤ä¸ªçº¿ç¨‹t1ã€t2æ¥ç«äº‰å‡†å¤‡ç»™var5è¿›è¡Œèµ‹å€¼æ“ä½œï¼›(æç«¯æƒ…å†µ)</span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶å‡è®¾ä»ç„¶è¿˜æ˜¯t1çº¿ç¨‹å…ˆè¿›è¡Œæ‰§è¡Œï¼›</span><br><span class="line">é‚£ä¹ˆè¿™ä¸ªæ—¶å€™t1çº¿ç¨‹å°±ä¼šè¿›å…¥<span class="keyword">while</span>å½“ä¸­æ‰§è¡Œ<span class="keyword">this</span>.compareAndSwapInt(var1, var2, var5, var5+var4)æ–¹æ³•ï¼ˆå³æ¯”è¾ƒå¦‚æœç›¸åŒçš„è¯åˆ™å¹¶ä¸”äº¤æ¢ä¸€ä¸ªintç±»å‹çš„å–å€¼ï¼‰ï¼›</span><br><span class="line">åˆ†æcompareAndSwapIntå½“ä¸­çš„å‚æ•°var1ã€var2ã€var5ã€var4ï¼›</span><br><span class="line">var1: å…¶å®è¿˜æ˜¯è¿™ä¸ª<span class="keyword">this</span>ï¼Œå³AtomicInteger atomicIntegerå¯¹è±¡ï¼›</span><br><span class="line">var2: å³å…¶å®è¿˜æ˜¯valueOffsetï¼Œå³å†…å­˜åç§»é‡ï¼›var1ä¸var2çš„ç›®çš„è¿˜æ˜¯ç”¨äºæ¥è¿›è¡Œæ‰¾åˆ°å†…å­˜ä¸­valueçš„æœ€æ–°å–å€¼ï¼›æ­¤æ—¶æ‰¾åˆ°çš„æ˜¯valueå€¼å–å€¼ä¸º<span class="number">0</span>ï¼›ç”±äºAtomicIntegerå¯¹è±¡åˆ›å»ºvalueå˜é‡ä¾¿ä¼šèµ‹å€¼ä¸º<span class="number">0</span>ï¼›</span><br><span class="line">var5: å³æ—§çš„é¢„ä¼°å€¼ï¼›</span><br><span class="line">      å³valueæ—§çš„é¢„ä¼°å€¼å–å€¼ï¼Œå³ä¹Ÿæ˜¯<span class="number">0</span>ï¼›å³var1+var2æ‰€åœ¨å†…å­˜ä¸­æŸ¥æ‰¾åˆ°çš„valueæœ€æ–°å€¼ä¸å½“å‰var5æ—§çš„é¢„ä¼°å€¼æ˜¯ç›¸ç­‰çš„æ­¤æ—¶ï¼›</span><br><span class="line">      å¦‚æœvar1+var2åœ¨å†…å­˜å½“ä¸­æŸ¥æ‰¾å¾—åˆ°çš„valueæœ€æ–°å€¼ ä¸ å½“å‰var5æ—§çš„é¢„ä¼°å€¼çš„å–å€¼ä¸€è‡´ï¼Œå³ç›¸ç­‰ï¼›</span><br><span class="line">      é‚£ä¹ˆvar5+var4æ‰€åŠ è·å¾—çš„å€¼å°±ä¼šè¢«èµ‹å€¼åˆ°å†…å­˜å½“ä¸­çš„valueå–å€¼ä¸Šæ¥ï¼Œæˆä¸ºå†…å­˜å½“ä¸­valueçš„æœ€æ–°å€¼ï¼›</span><br><span class="line">      å³è¿™ä¸ªå†…å­˜å½“ä¸­valueçš„æœ€æ–°å€¼å°±ä¼šå˜æˆvar5+var4çš„å’Œå€¼ï¼›</span><br><span class="line">      å½“å‰var5æ—§çš„é¢„ä¼°å€¼ä¸º<span class="number">0</span>ï¼›</span><br><span class="line">      var4å³ä¸ºAtomicInteger.javaç±»å½“ä¸­çš„æ–¹æ³•incrementAndGetæ–¹æ³•ä¸­æ‰€ä¼ å…¥çš„å€¼<span class="number">1</span>ï¼›</span><br><span class="line">      æ‰€ä»¥å³ä¹Ÿå°±æ˜¯è‡ªå¢ä¸€çš„æ“ä½œï¼›</span><br><span class="line">      å½“var5ä¸var4ä¸€åŠ æ³•è¿ç®—å®Œæˆä¹‹åé‚£ä¹ˆå¾—åˆ°æ–°å€¼<span class="number">1</span>ï¼›</span><br><span class="line">      é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯¥æ–°çš„å€¼<span class="number">1</span>ä¹Ÿå°±ä¼šèµ‹å€¼ç»™å†…å­˜å½“ä¸­valueå˜é‡çš„å–å€¼ï¼›</span><br><span class="line">      å› ä¸ºå½“å‰æ˜¯æ¯”è¾ƒcompareæˆåŠŸå³var1+var2æ‰€æŸ¥è¯¢è·å–å¾—åˆ°çš„å†…å­˜æœ€æ–°å€¼<span class="number">0</span>ä¸æ—§çš„é¢„ä¼°å€¼var5 <span class="number">0</span>å¤„äºä¸¤è€…ç›¸ç­‰çš„æƒ…å†µæ‰€ä»¥åŒ¹é…æˆåŠŸäº†ï¼ˆæ¯”è¾ƒæˆåŠŸä¹‹åè¿›è¡Œäº†æ›¿æ¢å†…å­˜ä¸­valueå–å€¼çš„ä¸€ä¸ªæ“ä½œï¼Œæ›¿æ¢çš„å€¼ä¸ºvar5+var4ï¼›å³CASéœ€è¦çš„ä¸‰ä¸ªå–å€¼ï¼šå†…å­˜ä¸­çš„å€¼Vã€æ—§çš„é¢„ä¼°å€¼Xã€è¦ä¿®æ”¹çš„æ–°å€¼Bï¼›è¿™ä¸ªæ—¶å€™å°±å±äºæ—§çš„é¢„ä¼°å€¼+var4=è¦ä¿®æ”¹çš„æ–°å€¼Bå¹¶æ›¿æ¢æ‰äº†å†…å­˜ä¸­çš„å€¼Vï¼‰ï¼›</span><br><span class="line">      é‚£ä¹ˆè¿™ä¸ªæ—¶å€™<span class="keyword">this</span>.compareAndSwapIntï¼ˆvar1, var2, var5, var5+var4ï¼‰å°±ä¼šè¿”å›<span class="literal">true</span>ï¼›</span><br><span class="line">      ç”±äºè¿”å›çš„æ˜¯<span class="literal">true</span>ï¼Œè€Œ<span class="keyword">while</span>(! <span class="keyword">this</span>.compareAndSwapInt(var1, var2, var5, var5+var4))å½“ä¸­çš„<span class="keyword">this</span>.compareAndSwapInt(var1, var2, var5, var5+var4)åŠ äº†! è¡¨ç¤ºå¦å®šï¼›</span><br><span class="line">      å³<span class="keyword">while</span>(<span class="literal">false</span>)åˆ™è¡¨ç¤º<span class="keyword">do</span>&#123;&#125;whille()ç»“æŸå¾ªç¯ï¼›</span><br><span class="line">      å³t1çº¿ç¨‹ä¸€æ¬¡æ€§è®¾ç½®è‡ªå¢<span class="number">1</span>æˆåŠŸï¼›</span><br><span class="line">      é‚£ä¹ˆæ­¤æ—¶t1çº¿ç¨‹å°±å®Œæˆäº†è‡ªå¢<span class="number">1</span>çš„æ“ä½œï¼Œç»“æŸä»»åŠ¡ï¼›</span><br><span class="line">var4: å¸¸é‡<span class="number">1</span>ï¼›åœ¨AtomicInteger.javaçš„incrementAndGetæ–¹æ³•å½“ä¸­æ‰€èµ‹å€¼<span class="number">1</span>ï¼›</span><br><span class="line"></span><br><span class="line">å‡è®¾ç°åœ¨åˆ‡æ¢åˆ°t2çº¿ç¨‹å½“ä¸­æ¥äº†ï¼›</span><br><span class="line">è€Œä¹‹å‰æ˜¯å½“t2çº¿ç¨‹æ‹¿åˆ°æ—§çš„é¢„ä¼°å€¼ï¼Œ</span><br><span class="line">ä¹Ÿå°±æ˜¯<span class="keyword">this</span>.getIntVolatile(var1, var2)æ‹¿åˆ°å–å€¼ä¹‹åå¹¶ä¸”èµ‹å€¼ç»™äº†t2çº¿ç¨‹å½“ä¸­çš„å·¥ä½œå†…å­˜ä¸­çš„var5æ—§çš„é¢„ä¼°å€¼å˜é‡ä¹‹åæ‰è¿›è¡ŒCPUçš„åˆ‡æ¢çš„ï¼Œ</span><br><span class="line">å³CPUå½“æ—¶åˆ‡æ¢åˆ°äº†t1çº¿ç¨‹ï¼›</span><br><span class="line">éœ€è¦æ³¨æ„çš„æ˜¯åœ¨CPUåˆ‡æ¢åˆ°t1çº¿ç¨‹ä¹‹å‰t2çº¿ç¨‹ä¸­è·å–å¾—åˆ°var5æ—§çš„é¢„ä¼°å€¼ä¸º<span class="number">0</span>ï¼›</span><br><span class="line">ä¸”å½“CPUåˆ‡æ¢åˆ°t1çº¿ç¨‹ä¹‹åå®Œæˆäº†è‡ªå¢<span class="number">1</span>çš„æ“ä½œå³æ¯”è¾ƒå†…å­˜valueå–å€¼ä¸t1çº¿ç¨‹ä¸­çš„å·¥ä½œå†…å­˜ä¸­çš„var5æ—§çš„é¢„ä¼°å€¼å–å€¼ç›¸åŒçš„æ—¶å€™å®Œæˆäº†äº¤æ¢SwapIntçš„æ“ä½œå³var5+var4æ›¿æ¢æ‰æˆ–è€…è¯´é‡æ–°èµ‹å€¼ç»™äº†å†…å­˜å½“ä¸­valueçš„å–å€¼äº†ï¼Œå³<span class="number">1</span>ï¼›</span><br><span class="line">é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´æ­¤æ—¶CPUåˆ‡æ¢å›æ¥çº¿ç¨‹t2ï¼Œ</span><br><span class="line">è€Œt2çº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­var5çš„å–å€¼ä¸º<span class="number">0</span>ï¼›</span><br><span class="line">è€Œæ­¤æ—¶å†…å­˜å½“ä¸­çš„valueå–å€¼ä¸º<span class="number">1</span>ï¼›</span><br><span class="line">ä¹Ÿå°±æ˜¯ä¸¤è€…å–å€¼ä¸ç›¸åŒï¼›</span><br><span class="line">å°±æ— æ³•è¿›è¡ŒcompareAndSwapIntäº¤æ¢çš„æ“ä½œå³æ— æ³•å®Œæˆvalueè‡ªå¢çš„æ“ä½œï¼›</span><br><span class="line"></span><br><span class="line">t2çº¿ç¨‹ä¹‹å‰çš„var5å–å€¼ä¸º<span class="number">0</span>ï¼›é‚£ä¹ˆt2çº¿ç¨‹ä¹Ÿä¼šæ¥è¿›è¡Œæ‰§è¡Œ<span class="keyword">while</span>(!<span class="keyword">this</span>.compareAndSwapInt(var1, var2. var5, var5+var4));å½“ä¸­çš„compareAndSwapInt(var1, var2. var5, var5+var4)æ–¹æ³•ï¼›</span><br><span class="line">æ­¤æ—¶åˆ†æåœ¨t2çº¿ç¨‹ä¸­æ‰§è¡Œçš„æ—¶å€™compareAndSwapInt(var1, var2. var5, var5+var4)æ–¹æ³•å½“ä¸­çš„å››ä¸ªå‚æ•°ï¼›</span><br><span class="line">var1 ä¸ var2: å³<span class="keyword">this</span>+valueOffsetå³æ‰¾åˆ°å†…å­˜å½“ä¸­æœ€æ–°çš„é¢„ä¼°å€¼valueï¼Œå³æ­¤æ—¶å†…å­˜å½“ä¸­valueå–å€¼ä¸º<span class="number">1</span>ï¼›</span><br><span class="line">è€Œæ—§çš„é¢„ä¼°å€¼å³var5ï¼›t2çº¿ç¨‹è·å–å¾—åˆ°çš„å…¶å–å€¼ä¸º<span class="number">0</span>ï¼›</span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶å°±å‘ç° å†…å­˜valueçš„æœ€æ–°å€¼<span class="number">1</span>ä¸æ—§çš„é¢„ä¼°å€¼var5çš„å–å€¼ä¸ä¸€æ ·ï¼›</span><br><span class="line">ä¸ä¸€æ ·åˆ™æ­¤æ—¶å°±ä¸ä¼šè¿›è¡Œå¯¹å†…å­˜å½“ä¸­çš„valueè¿›è¡Œæ›´æ–°å–å€¼ï¼›å¹¶ä¸”è¿”å›ä¸€ä¸ª<span class="literal">false</span>ï¼›</span><br><span class="line">å³å¯¹äºcompareAndSwapInt(var1, var2. var5, var5+var4)æ“ä½œè¿”å›çš„<span class="literal">false</span>ï¼›</span><br><span class="line">è€Œ<span class="keyword">while</span>(!compareAndSwapInt(var1, var2. var5, var5+var4))ä¸­è¯¥æ–¹æ³•å‰æ˜¯!ï¼Œå³è¡¨ç¤º<span class="keyword">while</span>(!<span class="literal">false</span>) ---&gt; <span class="keyword">while</span>(<span class="literal">true</span>) å³ç»§ç»­æ‰§è¡Œ<span class="keyword">do</span>-<span class="keyword">while</span>å¾ªç¯ï¼›</span><br><span class="line">è¿™æ¬¡è™½ç„¶å†…å­˜å½“ä¸­valueçš„æœ€æ–°å€¼ä¸t2çº¿ç¨‹ä¸­var5æ—§çš„é¢„ä¼°å€¼çš„å–å€¼ä¸ä¸€æ ·ï¼›</span><br><span class="line">ä½†æ˜¯<span class="literal">false</span>å‰é¢åŠ äº†ä¸€ä¸ªéå³!ï¼›é‚£ä¹ˆå°±ä¼šå˜æˆ<span class="literal">true</span>ï¼›ä¹Ÿå°±æ˜¯è¯´<span class="keyword">while</span>(<span class="literal">true</span>)åˆ™å°†ç»§ç»­è¿›è¡Œ<span class="keyword">do</span>-<span class="keyword">while</span>å¾ªç¯ï¼›</span><br><span class="line">åˆ™æ­¤æ—¶t2å¾ªç¯ä¼šæ¥ç€è¿™ä¸ª<span class="keyword">do</span>-<span class="keyword">while</span>å¾ªç¯åˆè¿›å…¥åˆ°<span class="keyword">do</span>&#123;&#125;å—å½“ä¸­ï¼›è¿›è¡Œæ‰§è¡Œé€šè¿‡var1ä¸var2å³<span class="keyword">this</span>+valueOffsetè°ƒç”¨æ–¹æ³•<span class="keyword">this</span>.getIntVolatile()æ–¹æ³•è·å–æ‰¾åˆ°å¾—åˆ°å†…å­˜å½“ä¸­valueçš„æœ€æ–°å€¼<span class="number">1</span>å¹¶èµ‹å€¼ç»™t2çº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­var5å˜é‡ï¼›å³æ­¤æ—¶t2çº¿ç¨‹var5å˜é‡ä¸º<span class="number">1</span>ï¼›ç»§ç»­æ‰§è¡Œä»£ç <span class="keyword">while</span>(!compareAndSwapInt(var1, var2. var5, var5+var4))ä¸­çš„compareAndSwapInt(var1, var2. var5, var5+var4)ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™æ¬¡éœ€è¦æ³¨æ„çš„æ˜¯æ­¤æ—¶å†…å­˜å½“ä¸­valueçš„æœ€æ–°å€¼ä¸º<span class="number">1</span>ï¼›</span><br><span class="line">è€Œt2çº¿ç¨‹åˆšåˆšæ‰€æ‰¾çš„æ—§çš„é¢„ä¼°å€¼var5ä¹Ÿæ˜¯<span class="number">1</span>ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™ä¸€æ¬¡çš„æ—¶å€™t2çº¿ç¨‹å½“ä¸­çš„æ—§çš„é¢„ä¼°å€¼var5ä¸å†…å­˜å½“ä¸­valueçš„æœ€æ–°å€¼ç›¸åŒéƒ½ä¸º<span class="number">1</span>ï¼›</span><br><span class="line">å³å†…å­˜æœ€æ–°å€¼ä¸æ—§çš„é¢„ä¼°å€¼ç›¸åŒé‚£ä¹ˆå°±éœ€è¦å®Œæˆäº¤æ¢æ“ä½œï¼Œ</span><br><span class="line">å³å¯¹å†…å­˜ä¸­çš„valueå–å€¼è¿›è¡Œé‡æ–°èµ‹å€¼ä¸ºvar5+var4ï¼Œ</span><br><span class="line">å¯¹å†…å­˜å½“ä¸­valueå–å€¼èµ‹å€¼ä¸€ä¸ªæœ€æ–°å€¼ï¼Œ</span><br><span class="line">é‚£ä¹ˆè¿™ä¸ªæœ€æ–°å€¼å°±æ˜¯var5+var4ï¼ˆvar5å³æ—§çš„é¢„ä¼°å€¼<span class="number">1</span>ï¼›var4ä¸ºå¸¸é‡<span class="number">1</span>ï¼‰ï¼›</span><br><span class="line">å¾—åˆ°è¿ç®—ç»“æœä¸º<span class="number">2</span>å¹¶èµ‹å€¼ç»™å½“å‰å†…å­˜å½“ä¸­çš„valueå–å€¼</span><br><span class="line">ï¼ˆä¹Ÿå°±æ˜¯è¯´éœ€è¦è¿›è¡Œä¿®æ”¹çš„æœ€æ–°å€¼ä¸º<span class="number">2</span>ï¼‰ï¼›</span><br><span class="line">é‚£ä¹ˆç”±äºå†…å­˜æœ€æ–°å€¼ä¸æ—§çš„é¢„ä¼°å€¼ä¸€æ ·é‚£ä¹ˆå°±ä¼šå°†var5+var4ï¼Œå³<span class="number">2</span> æœ€æ–°å–å€¼èµ‹å€¼ç»™å½“å‰å†…å­˜valueå˜é‡å–å€¼ï¼›</span><br><span class="line">å³å½“å‰å†…å­˜å½“ä¸­valueçš„å–å€¼ä¸º<span class="number">2</span>ï¼›å®Œæˆä¸€æ¬¡è‡ªå¢æ•ˆæœï¼›</span><br><span class="line">å½“èµ‹å€¼æˆåŠŸä¹‹åï¼›</span><br><span class="line">å¹¶ä¸”compareAndSwapInt(var1, var2. var5, var5+var4)æ–¹æ³•ä¼šè¿”å›<span class="literal">true</span>ï¼›</span><br><span class="line">é‚£ä¹ˆä¸€æ—¦compareAndSwapInt(var1, var2. var5, var5+var4)è¿”å›<span class="literal">true</span>ï¼Œè€Œ<span class="keyword">while</span>(!compareAndSwapInt(var1, var2. var5, var5+var4))ä¸­å­˜åœ¨æœ‰ä¸€ä¸ªé!çš„æ“ä½œï¼›é‚£ä¹ˆä¹Ÿå°±æ˜¯<span class="keyword">while</span>(<span class="literal">false</span>)è‡³æ­¤ç›¸å¯¹äºt2çº¿ç¨‹æ¥è¯´æ•´ä¸ª<span class="keyword">do</span>-<span class="keyword">while</span>å¾ªç¯å°±ç»“æŸäº†ï¼Œå®Œæˆä¸€æ¬¡è‡ªå¢æ“ä½œï¼›</span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶å°±æ˜ç™½äº†CASçš„åŸç†ï¼›</span><br><span class="line">CASä¸»è¦æ˜¯é ä¸‰ä¸ªå˜é‡çš„å–å€¼ï¼›</span><br><span class="line">ä¸€ä¸ªæ˜¯å†…å­˜å½“ä¸­çš„æœ€æ–°å€¼ï¼›ä¸€ä¸ªæ˜¯æ—§çš„é¢„ä¼°å€¼ï¼›è¿˜æœ‰ä¸€ä¸ªå³æ–°çš„è¦ä¿®æ”¹çš„å€¼ï¼›</span><br><span class="line">å¦‚æœå½“å‰å†…å­˜å½“ä¸­çš„æœ€æ–°å€¼ä¸æ—§çš„é¢„ä¼°å€¼å–å€¼ä¸€æ ·é‚£ä¹ˆå°±æŠŠæ–°çš„è¦ä¿®æ”¹çš„å€¼èµ‹å€¼ç»™å†…å­˜å½“ä¸­çš„è¯¥æœ€æ–°å€¼ï¼›å¹¶ä¸”è¿”å›tueï¼›ä»¥è‡³äº<span class="keyword">while</span>(!<span class="literal">true</span>)ï¼Œå³<span class="keyword">while</span>(<span class="literal">false</span>)å¯¼è‡´è¯¥<span class="keyword">do</span>-<span class="keyword">while</span>å¾ªç¯ä¸å†ç»§ç»­ï¼›</span><br><span class="line">å¦‚æœå½“å‰å†…å­˜å½“ä¸­çš„å€¼ä¸æ—§çš„é¢„ä¼°å€¼ä¸ä¸€æ ·ï¼›é‚£ä¹ˆå°±ä¼šè¿”å›<span class="literal">false</span>ï¼Œä»¥è‡³äº<span class="keyword">while</span>(!<span class="literal">false</span>)ï¼Œå³<span class="keyword">while</span>(<span class="literal">true</span>)ç»§ç»­æ‰§è¡Œ<span class="keyword">do</span>-<span class="keyword">while</span>å¾ªç¯ï¼›é‡æ–°å†ä¸€æ¬¡æ‹¿åˆ°æ—§çš„é¢„ä¼°å€¼var5ï¼›å¹¶ä¸”å†ä¸€æ¬¡è¿›è¡ŒcompareAndSwapIntæ“ä½œï¼Œæ‹¿åˆ°æœ€æ–°çš„å†…å­˜å–å€¼å»è¿›è¡Œæ¯”è¾ƒä»¥åŠæ˜¯å¦äº¤æ¢å†…å­˜å–å€¼ï¼Œå¦‚æœæˆåŠŸå°±ä¸å†è¿›è¡Œå¾ªç¯å¦‚æœä¸æˆåŠŸå°±ç»§ç»­è¿›è¡Œ<span class="keyword">do</span>-<span class="keyword">while</span>å¾ªç¯å†æ¬¡æ‹¿åˆ°å†…å­˜æœ€æ–°å€¼ä¸æ—§çš„é¢„ä¼°å€¼è¿›è¡Œæ¯”è¾ƒ...............ï¼›</span><br><span class="line">é‚£ä¹ˆä»¥ä¸Šå³ä¸ºCASçš„åŸç†ï¼›</span><br></pre></td></tr></table></figure><h3 id="ä¹è§‚é”å’Œæ‚²è§‚é”"><a href="#ä¹è§‚é”å’Œæ‚²è§‚é”" class="headerlink" title="ä¹è§‚é”å’Œæ‚²è§‚é”"></a>ä¹è§‚é”å’Œæ‚²è§‚é”</h3><p>ä»æ€æƒ³è§’åº¦è¿›è¡ŒåŒºåˆ†ï¼›</p><p><strong>æ‚²è§‚é”</strong> ä»æ‚²è§‚çš„è§’åº¦å‡ºå‘ï¼š</p><p>æ€»æ˜¯å‡è®¾æœ€åçš„æƒ…å†µï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œï¼ˆè¿™æ ·çš„è¯å°±åªæœ‰ä¸€ä¸ªçº¿ç¨‹è¿›æ¥åˆ«çš„çº¿ç¨‹æ²¡æœ‰é”æ— æ³•è¿›å…¥ï¼Œå³åˆ«çš„çº¿ç¨‹ä¼šé˜»å¡ï¼Œé‚£ä¹ˆä¹Ÿå°±ä¿è¯æ•°æ®æ“ä½œæ²¡æœ‰é—®é¢˜ï¼‰è¿™æ ·åˆ«äººæƒ³æ‹¿è¿™ä¸ªæ•°æ®å°±ä¼šé˜»å¡ã€‚<br>å› æ­¤synchronizedä¹Ÿå°†å…¶ç§°ä¹‹ä¸º<strong>æ‚²è§‚é”</strong>ã€‚<br>JDKä¸­çš„ReentrantLockä¹Ÿæ˜¯ä¸€ç§<strong>æ‚²è§‚é”</strong>ã€‚<br>æ€§èƒ½è¾ƒå·®ï¼<br>ï¼ˆæ€»æœ‰åˆæ°‘æƒ³å®³æœ•ï¼‰</p><p><strong>ä¹è§‚é”</strong> ä»ä¹è§‚çš„è§’åº¦å‡ºå‘ï¼š<br>æ€»æ˜¯å‡è®¾æœ€å¥½çš„æƒ…å†µï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„ä¼šåéƒ½è®¤ä¸ºåˆ«äººä¸ä¼šä¿®æ”¹ï¼Œå°±ç®—æ”¹äº†ä¹Ÿæ²¡å…³ç³»ï¼Œå†é‡è¯•å³å¯ã€‚<br>æ‰€ä»¥ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯åœ¨æ›´æ–°çš„æ—¶å€™ä¼šåˆ¤æ–­ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæœ‰æ²¡æœ‰å»ä¿®æ”¹è¿™ä¸ªæ•°æ®ï¼Œå¦‚æœæ²¡æœ‰äººä¿®æ”¹åˆ™æ›´æ–°ï¼Œå¦‚æœæœ‰äººä¿®æ”¹åˆ™é‡è¯•ã€‚</p><p>ï¼ˆä¹è§‚é”åœ¨å¯¹æ•°æ®è¿›è¡Œæ“ä½œçš„æ—¶å€™æ€»æ˜¯å¾ˆä¹è§‚çš„è®¤ä¸ºï¼šå½“å‰çº¿ç¨‹è¿›è¡Œæ“ä½œçš„æ—¶å€™æ²¡æœ‰å…¶ä»–çš„çº¿ç¨‹æ¥è¿›è¡Œä¿®æ”¹å³å¹²æ‰°åˆ°å½“å‰çº¿ç¨‹çš„æ“ä½œï¼›å› æ­¤ä¹è§‚é”çš„æ“ä½œæ˜¯ä¸ä¸Šé”ï¼›ä½†æ˜¯ä¹Ÿä¸èƒ½ä»€ä¹ˆä¹Ÿä¸ç®¡ï¼Œä»¥é˜²ä¸‡ä¸€ï¼›é‚£ä¹ˆä¹è§‚é”è™½ç„¶åœ¨è®¾ç½®å–å€¼çš„æ—¶å€™ä¸åŠ é”ä½†æ˜¯ä¼šè¿›è¡Œä¸€ä¸ªåˆ¤æ–­ï¼Œå³æ—§å€¼ä¸æ–°å€¼çš„åˆ¤æ–­ï¼› å³åœ¨è®¾ç½®å‰ç¨å¾®åšä¸€ä¸ªåˆ¤æ–­å³æ—§çš„é¢„ä¼°å€¼ä¸å†…å­˜å½“ä¸­çš„æœ€æ–°å–å€¼æ˜¯å¦ä¸€è‡´ï¼›å¦‚æœä¸€è‡´åˆ™ç›´æ¥è®¾ç½®å¦‚æœä¸ä¸€è‡´åˆ™è¯´æ˜æœ‰åˆ«çš„çº¿ç¨‹å·²ç»ä¿®æ”¹è¿‡ï¼Œé‚£ä¹ˆæ²¡æœ‰å…³ç³»ï¼Œå½“å‰çº¿ç¨‹è¿›è¡Œé‡æ–°å¾ªç¯ï¼Œé‡æ–°å»è·å–å†…å­˜ä¸­çš„æœ€æ–°å€¼ï¼›é‡æ–°æ¥è¿›è¡Œè®¾ç½®ä¸€æ¬¡æˆ–è€…å¤šæ¬¡å³å¯ï¼Œå³ä¹Ÿå°±æ˜¯é‡æ–°å°è¯•é‡æ–°å°è¯•é‡æ–°å°è¯•â€¦.ï¼‰</p><p><strong>CAS</strong>è¿™ç§æœºåˆ¶ä¹Ÿå¯ä»¥å°†å…¶ç§°ä¹‹ä¸º<strong>ä¹è§‚é”</strong>ï¼Œç»¼åˆ<strong>æ€§èƒ½è¾ƒå¥½</strong>ï¼<br>ï¼ˆåœ¨ä¿®æ”¹çš„æ—¶å€™ä¸ä¸Šé”ï¼›åªæ˜¯åšä¸€ä¸ªåˆ¤æ–­ï¼Œä¸è¡Œåˆ™å†æ¬¡åˆ¤æ–­ä¸€æ¬¡å³å¯ï¼‰</p><p>CASå¯ä»¥ä¿è¯å˜é‡åœ¨è®¾ç½®å–å€¼çš„æ—¶å€™å¯ä»¥ä¿è¯å…¶æ“ä½œçš„ä¸€ä¸ªåŸå­æ€§ï¼›<br>ä¸ºäº†ä½¿å¾—åœ¨çº¿ç¨‹é—´å˜é‡å–å€¼çŠ¶æ€å˜åŒ–å¯è§ï¼Œ<br>é‚£ä¹ˆéœ€è¦ç»™è¯¥å˜é‡æ·»åŠ volatileå…³é”®å­—è¿›è¡Œä¿®é¥°ï¼›<br>volatileå¯ä»¥ç»“åˆCASæœºåˆ¶å®ç°æ— é”å¹¶å‘ï¼›<br>ä¿è¯å˜é‡åœ¨ä¿®æ”¹æ—¶çš„åŸå­æ€§ï¼›<br>éœ€è¦æ³¨æ„çš„æ˜¯CASåªé€‚åˆåœ¨ç«äº‰å¹¶ä¸å¤ªæ¿€çƒˆã€å¤šæ ¸CPUçš„æƒ…å†µåœºæ™¯ä¸‹è¿›è¡Œä½¿ç”¨ï¼›<br>CASä¹‹æ‰€ä»¥æ•ˆç‡é«˜æ˜¯å› ä¸ºåœ¨å…¶å†…éƒ¨æ²¡æœ‰ä½¿ç”¨synchronizedå…³é”®å­—ï¼›<br>é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´CASä¸ä¼šè®©çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼›<br>é‚£ä¹ˆä¹Ÿå°±é¿å…äº†synchronizedå½“ä¸­ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„åˆ‡æ¢æ‰€å¸¦æ¥çš„çš„æ€§èƒ½æ¶ˆè€—é—®é¢˜ä¹Ÿé¿å…äº†çº¿ç¨‹æŒ‚èµ·ç­‰èµ„æºçš„æ¶ˆè€—é—®é¢˜ï¼›<br>å¦‚æœç«äº‰éå¸¸æ¿€çƒˆï¼Œé‚£ä¹ˆCASå°±ä¼šå‡ºç°çº¿ç¨‹å¤§é‡é‡è¯•ï¼Œå› ä¸ºå¤šçº¿ç¨‹æ¥è¿›è¡Œç«äº‰ï¼Œé‚£ä¹ˆä¹Ÿå°±å¯¼è‡´æœ‰å¯èƒ½å¾ˆå¤šçš„çº¿ç¨‹è®¾ç½®å–å€¼å¤±è´¥ï¼Œé‚£ä¹ˆåˆè¦è¿›è¡Œwhileå¾ªç¯é‡è¯•ï¼›å³å¤§é‡çš„çº¿ç¨‹è¿›è¡Œé‡è¯•æ“ä½œï¼›æˆåŠŸå­˜çš„çº¿ç¨‹åè€Œä¸å¤šï¼›é‚£ä¹ˆè¿™æ ·çš„è¯åè€Œä¼šä¼šæµªè´¹æ€§èƒ½ï¼Œå³æ€§èƒ½å˜ä½ï¼›<br>æ‰€ä»¥å¦‚æœç«äº‰å¤ªæ¿€çƒˆè¿˜ä½¿ç”¨çš„æ˜¯CASæœºåˆ¶é‚£ä¹ˆå°±ä¼šå¯¼è‡´å…¶æ€§èƒ½æ¯”synchronizedè¿˜ä¼šä½ï¼›</p><blockquote><p>CASè·å–å…±äº«å˜é‡æ—¶ï¼Œä¸ºäº†ä¿è¯è¯¥å˜é‡çš„å¯è§æ€§ï¼Œéœ€è¦ä½¿ç”¨volatileä¿®é¥°ï¼Œç»“åˆCASå’Œvolatileå¯ä»¥å®ç°æ— é”å¹¶å‘ï¼Œé€‚ç”¨äºç«äº‰ä¸æ¿€çƒˆï¼Œå¤šæ ¸CPUçš„åœºæ™¯ä¸‹ã€‚</p><ol><li>å› ä¸ºæ²¡æœ‰ä½¿ç”¨synchronizedï¼Œæ‰€ä»¥çº¿ç¨‹ä¸ä¼šé™·å…¥é˜»å¡ï¼Œè¿™æ˜¯æ•ˆç‡æå‡çš„å› ç´ ä¹‹ä¸€ã€‚</li><li>ä½†å¦‚æœç«äº‰æ¿€çƒˆï¼Œå¯ä»¥æƒ³åˆ°é‡è¯•å¿…ç„¶é¢‘ç¹å‘ç”Ÿï¼Œåè€Œæ•ˆç‡ä¼šå—å½±å“ã€‚</li></ol></blockquote><h3 id="å°ç»“-13"><a href="#å°ç»“-13" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>CASæŒ‡çš„æ˜¯Compare And Swapï¼›ä¼šæ‹¿æ—§çš„é¢„ä¼°å€¼ä¸å†…å­˜å½“ä¸­çš„æœ€æ–°å€¼è¿›è¡Œæ¯”è¾ƒï¼›å¦‚æœç›¸åŒå°±è¿›è¡Œäº¤æ¢å¹¶ä¸”æŠŠæœ€æ–°çš„å€¼èµ‹å€¼åˆ°å†…å­˜å½“ä¸­çš„è¿™ä¸ªå˜é‡ï¼›<br>CASçš„ä½œç”¨ï¼ŸCompare And Swapï¼ŒCASå¯ä»¥å°†æ¯”è¾ƒå’Œäº¤æ¢è½¬æ¢ä¸ºåŸå­æ“ä½œï¼Œè¿™ä¸ªåŸå­æ“ä½œç›´æ¥ç”±å¤„ç†å™¨ä¿è¯ï¼ˆç”±CPUæ”¯æŒï¼‰ã€‚<br>CASçš„åŸç†ï¼ŸCASéœ€è¦ä¸‰ä¸ªå€¼ï¼šå†…å­˜åœ°å€Vã€æ—§çš„é¢„æœŸå€¼Aã€è¦ä¿®æ”¹çš„æ–°å€¼Bï¼Œå¦‚æœå†…å­˜åœ°å€Vå’Œæ—§çš„é¢„æœŸå€¼Aç›¸ç­‰å°±ä¿®æ”¹å†…å­˜åœ°å€çš„å€¼ä¸ºBï¼ˆå³æ–°çš„å€¼Bèµ‹å€¼åˆ°å†…å­˜å½“ä¸­å»ï¼‰ï¼›</p><p>CASçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">CAS</span>å¯ä»¥å°†æ¯”è¾ƒå’Œäº¤æ¢è½¬æ¢ä¸ºåŸå­æ“ä½œï¼Œè¿™ä¸ªåŸå­æ“ä½œç›´æ¥ç”±å¤„ç†å™¨ä¿è¯ã€‚</span><br></pre></td></tr></table></figure><p>CASçš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CASéœ€è¦<span class="number">3</span>ä¸ªå€¼ï¼šå†…å­˜åœ°å€Vï¼Œæ—§çš„é¢„æœŸå€¼<span class="keyword">A</span>ï¼Œè¦ä¿®æ”¹çš„æ–°å€¼B</span><br><span class="line">å¦‚æœå†…å­˜åœ°å€Vå’Œæ—§çš„é¢„æœŸå€¼<span class="keyword">A</span>ç›¸ç­‰å°±ä¿®æ”¹å†…å­˜åœ°å€å€¼ä¸ºB</span><br></pre></td></tr></table></figure><h2 id="synchronizedä¼˜åŒ–é”å‡çº§è¿‡ç¨‹"><a href="#synchronizedä¼˜åŒ–é”å‡çº§è¿‡ç¨‹" class="headerlink" title="synchronizedä¼˜åŒ–é”å‡çº§è¿‡ç¨‹"></a>synchronizedä¼˜åŒ–é”å‡çº§è¿‡ç¨‹</h2><p>åœ¨JDK1.5ä¹‹å‰synchronizedåªåŒ…å«æœ‰ä¸€ç§é”å³monitoré‡é‡çº§é”ï¼›<br>æ‰€ä»¥åœ¨JDK1.5ä¹‹å‰å…¶æ•ˆç‡æ˜¯æ¯”è¾ƒä½çš„ï¼›<br>å¦å¤–åœ¨JDKçš„æºç å½“ä¸­å¤§é‡çš„ä½¿ç”¨åˆ°äº†synchronizedï¼›<br>åŒ…æ‹¬javaå¼€å‘çš„æ—¶å€™ä¹Ÿä¼šç»å¸¸ä½¿ç”¨åˆ°synchronizedï¼›<br>è™šæ‹Ÿæœºå¼€å‘å›¢é˜Ÿå°±æ„è¯†åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼›<br>å› æ­¤åœ¨JDK1.6è¿™ä¸ªç‰ˆæœ¬å½“ä¸­å¯¹synchronizedåšäº†é‡è¦æ”¹è¿›ï¼›<br>åœ¨JDK1.6å½“ä¸­synchronizedå°±ä¸ä»…ä»…åªæœ‰monitorè¿™ä¸€ç§é‡é‡çº§çš„é”äº†ï¼›<br>åŒ…æ‹¬åå‘é”ã€è½»é‡çº§é”ã€é€‚åº”æ€§è‡ªæ—‹ã€é”æ¶ˆé™¤ã€é”ä¼˜åŒ–ç­‰æœºåˆ¶ï¼›<br>å¦å¤–åˆ°è½¬å˜æˆé‡é‡çº§é”ä¹‹å‰ä¼šæœ‰ä¸€ä¸ªé€‚åº”æ€§è‡ªæ—‹çš„è¿‡ç¨‹è¿›è¡ŒæŠ¢æ•‘ä¸€ä¸‹ï¼›<br>è¿™äº›æœºåˆ¶çš„ç›®çš„å°±æ˜¯ä¸ºäº†èƒ½å¤Ÿè®©synchronizedçš„æ•ˆç‡å¾—åˆ°æå‡ï¼›</p><p>é«˜æ•ˆå¹¶å‘æ˜¯ä»JDK1.5åˆ°JDK1.6çš„ä¸€ä¸ªé‡è¦æ”¹è¿›ã€‚<br>HotSpotè™šæ‹Ÿæœºå¼€å‘å›¢é˜Ÿåœ¨è¿™ä¸ªç‰ˆæœ¬ä¸ŠèŠ±è´¹äº†å¤§é‡çš„ç²¾åŠ›å»å®ç°å„ç§é”ä¼˜åŒ–æŠ€æœ¯ï¼Œ<br>åŒ…æ‹¬å¦‚åå‘é”ï¼ˆBiased Lockingï¼‰ã€è½»é‡çº§é”ï¼ˆLightweight Lockingï¼‰å’Œé€‚åº”æ€§è‡ªæ—‹ï¼ˆAdaptive Spinningï¼‰ã€é”æ¶ˆé™¤ï¼ˆLock Eliminationï¼‰ã€é”ç²—åŒ–ï¼ˆLockã€Coarseningï¼‰ç­‰ï¼Œ<br>è¿™äº›æŠ€æœ¯éƒ½æ˜¯ä¸ºäº†åœ¨çº¿ç¨‹ä¹‹é—´æ›´é«˜æ•ˆåœ°å…±äº«æ•°æ®ï¼Œ<br>ä»¥åŠè§£å†³ç«äº‰é—®é¢˜ï¼Œä»è€Œæé«˜ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ã€‚</p><p>æ— é” â€”â†’ åå‘é” â€”â†’ è½»é‡çº§é” â€”â†’ é‡é‡çº§é”<br>åœ¨JDK1.6ä¹‹åä¸æ˜¯è¯´ç›´æ¥å°±ä¼šå˜æˆé‡é‡çº§é”äº†ï¼›<br>è€Œæ˜¯ä¼šæœ‰ä¸€ä¸ªè¿‡ç¨‹ï¼›<br>é¦–å…ˆå¯¹è±¡æ˜¯æ— é”çŠ¶æ€ï¼›ç„¶åå¦‚æœéœ€è¦è¿›è¡ŒåŠ é”é‚£ä¹ˆå°±ä¼šè¿›è¡Œæ·»åŠ ä¸€ä¸ªåå‘é”ï¼›<br>å¦‚æœåå‘é”æ— æ³•æ»¡è¶³ä¸è¡Œçš„è¯å°±ä¼šæ¢æˆè½»é‡çº§é”ï¼›<br>å¦‚æœè½»é‡çº§é”ä¸è¡Œçš„è¯å°±æœ‰å¯èƒ½ä¼šè¿›å…¥é€‚åº”æ€§è‡ªæ—‹çš„è¿‡ç¨‹ï¼›<br>å¦‚æœé€šè¿‡é€‚åº”æ€§è‡ªæ—‹ä¾ç„¶æ²¡æœ‰æŠ¢åˆ°é”åˆ™æ¢æˆé‡é‡çº§é”ï¼›<br>å³ä¼šæœ‰è¿™æ ·ä¸€ä¸ªé”å‡çº§çš„è¿‡ç¨‹ï¼›<br>è¿˜éœ€è¦æ³¨æ„çš„æ˜¯JDK1.6å½“ä¸­æ—¢ç„¶å­˜åœ¨æœ‰è¿™äº›ä¸åŒçš„é”ï¼›<br>é‚£ä¹ˆå¿…ç„¶æ˜¯è¿™äº›é”æœ‰å…¶å­˜åœ¨çš„ä¸åŒåœºæ™¯ä¸‹æ‰é€‚ç”¨ï¼›<br>å¹¶ä¸æ˜¯è¯´è¿™ä¸ªé”æ˜¯ä¸‡èƒ½çš„ï¼›</p><h2 id="synchronizedä¼˜åŒ–-å¯¹è±¡çš„å¸ƒå±€"><a href="#synchronizedä¼˜åŒ–-å¯¹è±¡çš„å¸ƒå±€" class="headerlink" title="synchronizedä¼˜åŒ–-å¯¹è±¡çš„å¸ƒå±€"></a>synchronizedä¼˜åŒ–-å¯¹è±¡çš„å¸ƒå±€</h2><h3 id="å›é¡¾å¹¶å¼•å…¥-1"><a href="#å›é¡¾å¹¶å¼•å…¥-1" class="headerlink" title="å›é¡¾å¹¶å¼•å…¥"></a>å›é¡¾å¹¶å¼•å…¥</h3><p>JDK1.6æ—¶å¯¹synchronizedåšäº†å¾ˆå¤šçš„ä¼˜åŒ–ï¼›<br>é”å‡çº§è¿‡ç¨‹ä¸º æ— é” â€”â†’ åå‘é” â€”â†’ è½»é‡çº§é” â€”â†’ é‡é‡çº§é”<br>é‚£ä¹ˆè¿™ä¸ªé”å‡çº§çš„è¿‡ç¨‹å½“ä¸­å°±ä¼šé‡åˆ°é”å­˜åœ¨æœ‰å¾ˆå¤šçš„çŠ¶æ€ï¼›<br>é‚£ä¹ˆè¿™äº›é”çš„çŠ¶æ€å­˜åœ¨åœ¨å“ªé‡Œå‘¢ï¼Ÿ<br>é‚£ä¹ˆè¿™äº›é”çš„çŠ¶æ€ä¹Ÿå°±å­˜åœ¨åœ¨javaå¯¹è±¡çš„å¸ƒå±€å½“ä¸­ï¼›<br>ä»¥å‰è®¤ä¸ºjavaå½“ä¸­å­˜åœ¨æˆå‘˜å˜é‡ï¼Œä¹Ÿç§°ä¹‹ä¸ºå®ä¾‹æ•°æ®ï¼›<br>é‚£ä¹ˆå…¶å®åœ¨JVMå½“ä¸­å¯¹è±¡ä¸ä»…ä»…ä¼šå­˜æ”¾å®ä¾‹æ•°æ®ï¼›<br>å¯¹è±¡æ€»å…±ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼šå¯¹è±¡å¤´ã€å®ä¾‹æ•°æ®ï¼ˆæˆå‘˜å˜é‡ç­‰ï¼‰å’Œå¯¹é½æ•°æ®ï¼›</p><p>Javaå¯¹è±¡çš„å¸ƒå±€</p><h3 id="ç›®æ ‡-17"><a href="#ç›®æ ‡-17" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>å­¦ä¹ javaå¯¹è±¡çš„å¸ƒå±€</p><p>æœ¯è¯­å‚è€ƒï¼š<code>http://openjdk.java.net/groups/hotspot/docs/HotSpotGlossary.html</code></p><p>åœ¨JVMä¸­ï¼Œå¯¹è±¡åœ¨å†…å­˜ä¸­çš„å¸ƒå±€åˆ†ä¸ºä¸‰å—åŒºåŸŸï¼šå¯¹è±¡å¤´ã€å®ä¾‹æ•°æ®å’Œå¯¹é½å¡«å……ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><h3 id="å¯¹è±¡å¤´"><a href="#å¯¹è±¡å¤´" class="headerlink" title="å¯¹è±¡å¤´"></a>å¯¹è±¡å¤´</h3><p>å¯¹è±¡å¤´ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼›<br>synchronizedé”å¯èƒ½æœ‰å¾ˆå¤šçš„çŠ¶æ€ï¼Œé‚£ä¹ˆè¿™äº›çŠ¶æ€éƒ½æ˜¯é å¯¹è±¡å¤´æ¥è¿›è¡Œå­˜å‚¨çš„ï¼›</p><p>å½“ä¸€ä¸ªçº¿ç¨‹å°è¯•è®¿é—® synchronizedä¿®é¥°çš„ä»£ç å—æ—¶ï¼Œå®ƒé¦–å…ˆè¦è·å¾—é”ï¼Œé‚£ä¹ˆè¿™ä¸ªé”åˆ°åº•å­˜åœ¨å“ªé‡Œå‘¢ï¼Ÿæ˜¯å­˜åœ¨åœ¨é”å¯¹è±¡çš„å¯¹è±¡å¤´ä¸­çš„ã€‚</p><p>åœ¨Hotspotè™šæ‹Ÿæœºå½“ä¸­å¯¹è±¡å¤´åˆåˆ†ä¸ºä¸¤ç§ï¼›<br>ä¸€ç§æ˜¯æ™®é€šå¯¹è±¡çš„å¯¹è±¡å¤´å³instanceOopDescï¼›<br>å¦å¤–ä¸€ç§æ˜¯æè¿°æ•°ç»„çš„å¯¹è±¡å¤´å³arrayOopDescï¼›<br>é‚£ä¹ˆå½“å‰ä»…å…³å¿ƒæ™®é€šå¯¹è±¡çš„å¯¹è±¡å¤´å³instanceOopDescï¼›</p><p>Hotspoté‡‡ç”¨ instanceOopDescå’ŒarrayOopDescæ¥æè¿°å¯¹è±¡å¤´ï¼›<br>arrayOopDescå¯¹è±¡ç”¨æ¥æè¿°æ•°ç»„ç±»å‹ã€‚<br>instanceOopDescçš„å®šä¹‰çš„åœ¨Hotspotæºç çš„ instanceOop.hpp æ–‡ä»¶ä¸­ï¼Œ<br>å¦å¤–ï¼Œ arrayOopDescçš„å®šä¹‰å¯¹åº” arrayOop.hppã€‚</p><p>instanceOop.hppè®°å½•äº†å¯¹è±¡å¤´çš„ä¿¡æ¯ï¼›<br>instanceOopDescå½“ä¸­æ²¡æœ‰å¾ˆå¤šä»£ç ï¼›<br>ä½†æ˜¯å¯ä»¥å‘ç°instanceOopç»§æ‰¿äº†çˆ¶ç±»oopDescï¼›<br>é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å¯ä»¥å»çœ‹ä¸‹å…¶çˆ¶ç±»oopDescä¸­çš„ä»£ç ï¼›</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># æˆªå–éƒ¨åˆ†ä»£ç </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">instanceOopDesc</span> :</span> <span class="keyword">public</span> oopDesc&#123;</span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// aligned header size.</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">header_size</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="keyword">sizeof</span>(instanceOopDesc)/HeapWordSize; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If compressed. the offset of the fields of the instance may not be aligned.</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">base_offset_in_bytes</span><span class="params">()</span></span>&#123;</span><br><span class="line">      <span class="comment">/* offset computation code breaks if useCompressedClassPointers</span></span><br><span class="line"><span class="comment">         only is true</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">      <span class="keyword">return</span> (UseCompressedOops &amp;&amp; UseCompressedClassPointers) ? klass_gap_offset_in_bytes() : <span class="keyword">sizeof</span>(instanceOopDesc);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">contains_field_offset</span><span class="params">(<span class="keyword">int</span> offset, <span class="keyword">int</span> nonstatic_field_size)</span></span>&#123;</span><br><span class="line">      <span class="keyword">int</span> base_in_bytes = base_offset_in_bytes();</span><br><span class="line">      <span class="keyword">return</span> (offset &gt;= base_in_bytes &amp;&amp; (offset-base_in_bytes) &lt; nonstatic_field_size = heapOopSize);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä»instanceOopDescä»£ç ä¸­å¯ä»¥çœ‹åˆ° instanceOopDescç»§æ‰¿è‡ªoopDescï¼Œ<br>oopDescçš„å®šä¹‰åœ¨Hotspotæºç ä¸­çš„ oop.hppæ–‡ä»¶ä¸­ï¼›</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">oopDesc</span>&#123;</span></span><br><span class="line">    friend <span class="class"><span class="keyword">class</span> <span class="title">VMStructs</span>;</span></span><br><span class="line">  <span class="keyword">private</span> :</span><br><span class="line">    volatile markOop _mark;</span><br><span class="line">    <span class="class"><span class="keyword">union</span> <span class="title">_metadata</span>&#123;</span></span><br><span class="line">      Klass*       _klass; <span class="comment"># æ²¡æœ‰å¼€å¯æŒ‡é’ˆå‹ç¼©æ—¶çš„ç±»å‹æŒ‡é’ˆ</span></span><br><span class="line">      narrowKlass  _compressed_klass; <span class="comment"># å¼€å¯äº†æŒ‡é’ˆå‹ç¼©</span></span><br><span class="line">    &#125; _metadata;</span><br><span class="line"></span><br><span class="line">    /<span class="regexp">/ Fast access to barrier set. Must be initialized.</span></span><br><span class="line"><span class="regexp">    static BarrierSet* _bs;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/ çœç•¥å…¶ä»–ä»£ç </span></span><br><span class="line"><span class="regexp">&#125;;</span></span><br></pre></td></tr></table></figure><p>åœ¨openjdkå½“ä¸­Klass*ä¸narrowKlassæœ‰ç›¸å…³çš„ä»‹ç»ï¼›</p><blockquote><p><strong>klass pointer</strong><br>The second word of every object header.<br>Points to another object(a metaobject) which<br>describes the layout and behavior of the original object.<br>For java objects, the â€œKlassâ€ contains a C++ style â€œvtableâ€.</p></blockquote><blockquote><p><strong>mark word</strong><br>The first word of every object header.<br>Ususlly a set of bitfields including synchronization state<br>and identity hash code.<br>May also be a poiter(with characteristic low bit encoding)<br>to synchronization related infomation.<br>During GC,may contain GC state bits.</p></blockquote><blockquote><p><strong>object header</strong><br>Common structure at the beginning of every GC-managed heap object.<br>(Every oop points to an object header.)<br>Includes fundamental information about the heap objectâ€™s layout, type , GC state, synchronization state, and identity hash code.<br>Consists of two words.<br>In arrays it is immediately followed by a length field.<br>Note that both java objects and VM-internal objects have a common object header format.</p></blockquote><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">-----------------------------------------------------------------</span><br><span class="line">|<span class="string">                          Xxx å¯¹è±¡                               </span>|</span><br><span class="line">|<span class="string">                          -------------------                    </span>|</span><br><span class="line">|<span class="string">                       ---</span>|<span class="string">  Mark     Word  </span>|<span class="string">  markOop   _mark   </span>|</span><br><span class="line">|<span class="string">-------------------   </span>|<span class="string">   -------------------                    </span>|</span><br><span class="line">||<span class="string"> instanceOopDesc </span>|<span class="string">-------</span>|<span class="string">  Klass pointer  </span>|<span class="string">  Klass*    _klass  </span>|</span><br><span class="line">||<span class="string"> å¯¹è±¡å¤´          </span>|<span class="string">       --------------------                   </span>|</span><br><span class="line">|<span class="string">-------------------       </span>|<span class="string">  å®ä¾‹      æ•°æ®  </span>|<span class="string">                   </span>|</span><br><span class="line">|<span class="string">                          --------------------                   </span>|</span><br><span class="line">|<span class="string">                          </span>|<span class="string">  å¯¹é½      æ•°æ®  </span>|<span class="string">                   </span>|</span><br><span class="line">|<span class="string">                          --------------------                   </span>|</span><br><span class="line">-----------------------------------------------------------------</span><br></pre></td></tr></table></figure><p>åœ¨ æ™®é€šç¤ºä¾‹å¯¹è±¡ ä¸­ï¼ŒoopDescçš„å®šä¹‰åŒ…å«ä¸¤ä¸ªæˆå‘˜ï¼Œåˆ†åˆ«æ˜¯<code>_mark</code>å’Œ<code>_metadata</code>ã€‚</p><p>_markè¡¨ç¤ºå¯¹è±¡æ ‡è®°ã€å±äºmarkOopç±»å‹ï¼Œä¹Ÿå°±æ˜¯æ¥ä¸‹æ¥è¦è®²è§£çš„Mark Wordï¼Œå®ƒè®°å½•äº†å¯¹è±¡å’Œé”æœ‰å…³çš„ä¿¡æ¯ï¼›<br>_metadataè¡¨ç¤ºç±»å…ƒä¿¡æ¯ï¼Œç±»å…ƒä¿¡æ¯å­˜å‚¨çš„æ˜¯å¯¹è±¡æŒ‡å‘å®ƒçš„ç±»å…ƒæ•°æ®ï¼ˆKlassï¼‰çš„é¦–åœ°å€ï¼Œå…¶ä¸­Klassè¡¨ç¤ºæ™®é€šæŒ‡é’ˆï¼›<br>_compressed_klassè¡¨ç¤ºå‹ç¼©ç±»æŒ‡é’ˆã€‚</p><p>å¯¹è±¡å¤´ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼›<br>ä¸€éƒ¨åˆ†ç”¨äºå­˜å‚¨è‡ªèº«çš„è¿è¡Œæ—¶æ•°æ®ï¼Œç§°ä¹‹ä¸ºMark Wordï¼›<br>å¦ä¸€éƒ¨åˆ†æ˜¯ç±»å‹æŒ‡é’ˆï¼Œå³å¯¹è±¡æŒ‡å‘å®ƒçš„ç±»å…ƒæ•°æ®çš„æŒ‡é’ˆã€‚</p><h3 id="Mark-Word"><a href="#Mark-Word" class="headerlink" title="Mark Word"></a>Mark Word</h3><p>Mark Wordç”¨äºå­˜å‚¨å¯¹è±¡è‡ªèº«çš„è¿è¡Œæ—¶æ•°æ®ï¼Œå¦‚å“ˆå¸Œç ï¼ˆHashCodeï¼‰ã€GCåˆ†ä»£å¹´é¾„ã€é”çŠ¶æ€æ ‡å¿—ã€çº¿ç¨‹æŒæœ‰çš„é”ã€åå‘çº¿ç¨‹IDã€åå‘æ—¶é—´æˆ³ç­‰ç­‰ï¼Œå ç”¨å†…å­˜å¤§å°ä¸è™šæ‹Ÿæœºä½é•¿ä¸€è‡´ã€‚</p><p>Mark Wordå¯¹åº”çš„ç±»å‹æ˜¯markOopã€‚<br>æºç ä½äº <code>markOop.hpp</code>ä¸­ã€‚</p><blockquote><p>åœ¨32ä½çŠ¶æ€ä¸‹ä»¥åŠ64ä½çŠ¶æ€ä¸‹æ¯ä¸€ä½åˆ†åˆ«ä»£è¡¨ä»€ä¹ˆï¼›</p></blockquote><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">--------------------------------------------------------------------</span><br><span class="line">// Bit-format of an object header (most significant first , big endian layout below):</span><br><span class="line">//</span><br><span class="line">// 32 bits:</span><br><span class="line">// ---------</span><br><span class="line">//           hash:25 --------------&gt;|<span class="string"> age:4   biased_lock:1 lock:2 (normal object)</span></span><br><span class="line"><span class="string">//           JavaThread*:23 epoch:2   age:4   biased_lock:1 lock:2 (biased object)</span></span><br><span class="line"><span class="string">//           sizeï¼›32 -------------------------------------------&gt;</span>|<span class="string"> (CMS free block)</span></span><br><span class="line"><span class="string">//           PromotedObject*:29 ------------&gt; promo_bits:3 ------&gt;</span>|<span class="string"> (CMS promoted object)</span></span><br><span class="line"><span class="string">//</span></span><br><span class="line"><span class="string">// 64 bits:</span></span><br><span class="line"><span class="string">// ----------</span></span><br><span class="line"><span class="string">// unused:25 hash:31 --&gt;</span>|<span class="string"> unused:1    age:4   biased_lock:1 lock:2 (normal object)</span></span><br><span class="line"><span class="string">// JavaThread*:54 epoch:2 unused:1    age:4   biased_lock:1 lock:2 (biased object)</span></span><br><span class="line"><span class="string">// PromotedObject*:61 ---------------------&gt;</span>|<span class="string"> promo_bits:3-----&gt;</span>|<span class="string"> (CMS promoted object)</span></span><br><span class="line"><span class="string">// size:64 ----------------------------------------------------&gt;</span>|<span class="string"> (CMS free block)</span></span><br><span class="line"></span><br><span class="line"><span class="string"># åå‘é”çš„æ—¶å€™å…¶ç¬¬ä¸‰ä½æ˜¯1ï¼›ï¼ˆ0ã€1ã€2ã€3çš„é¡ºåºï¼‰</span></span><br><span class="line"><span class="string">//   [JavaThread* </span>|<span class="string"> epoch </span>|<span class="string"> age </span>|<span class="string"> 1 </span>|<span class="string"> 01]   lock is biased toward given thread</span></span><br><span class="line"><span class="string">//   [0           </span>|<span class="string"> epoch </span>|<span class="string"> age </span>|<span class="string"> 1 </span>|<span class="string"> 01]   lock is anonymously biased</span></span><br><span class="line"><span class="string">//</span></span><br><span class="line"><span class="string">// - the two lock bits are used to describe three states: locked/unlocked and monitor.</span></span><br><span class="line"><span class="string">//</span></span><br><span class="line"><span class="string"># å½“ç¬¬ä¸‰ä½ä¸º0çš„æ—¶å€™åˆ™è¡¨ç¤ºä¸æ˜¯åå‘é”ï¼›é‚£ä¹ˆå°±çœ‹å…¶åä¸¤ä½ï¼›00è¡¨ç¤ºè½»é‡çº§é”ï¼›01è¡¨ç¤ºæ— é”ï¼›10å³monitorè¡¨ç¤ºé‡é‡çº§é”ï¼›</span></span><br><span class="line"><span class="string">//   [ptr             </span>|<span class="string"> 00]  locked         ptr points to real header on stack           # è½»é‡çº§é”</span></span><br><span class="line"><span class="string">//   [header      </span>|<span class="string"> 0 </span>|<span class="string"> 01]  unlocked       regular object header                        # æ— é”</span></span><br><span class="line"><span class="string">//   [ptr             </span>|<span class="string"> 10]  monitor        inflated lock (header is wapped out)         # é‡é‡çº§é”</span></span><br><span class="line"><span class="string">//   [ptr             </span>|<span class="string"> 11]  marked         used by markSweep to mark an object</span></span><br><span class="line"><span class="string">//                                          not valid at any other time</span></span><br><span class="line"><span class="string">--------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">|<span class="string">---------------------------------------------------------------------------------</span>|<span class="string">--------------------</span>|</span><br><span class="line">|<span class="string">                              Mark Word(64 bits)                                 </span>|<span class="string">        State       </span>|</span><br><span class="line">|<span class="string">---------------------------------------------------------------------------------</span>|<span class="string">--------------------</span>|</span><br><span class="line">|<span class="string"> unused:25 </span>|<span class="string"> identity_hashcoder:31 </span>|<span class="string"> unused:1 </span>|<span class="string"> age:4 </span>|<span class="string"> biased_lock:1 </span>|<span class="string"> lock:2   </span>|<span class="string">        Normal      </span>|</span><br><span class="line">|<span class="string">---------------------------------------------------------------------------------</span>|<span class="string">--------------------</span>|</span><br><span class="line">|<span class="string"> thread:54 </span>|<span class="string">        epoch:2        </span>|<span class="string"> unused:1 </span>|<span class="string"> age:4 </span>|<span class="string"> biased_lock:1 </span>|<span class="string"> lock:2   </span>|<span class="string">        Biased      </span>|</span><br><span class="line">|<span class="string">---------------------------------------------------------------------------------</span>|<span class="string">--------------------</span>|</span><br><span class="line">|<span class="string">                   ptr_to_lock__record:62                             </span>|<span class="string"> lock:2   </span>|<span class="string"> Lightweight Locked </span>|</span><br><span class="line">|<span class="string">---------------------------------------------------------------------------------</span>|<span class="string">--------------------</span>|</span><br><span class="line">|<span class="string">               ptr_to_heavyweight_monitor:62                          </span>|<span class="string"> lock:2   </span>|<span class="string"> Heavyweight Locked </span>|</span><br><span class="line">|<span class="string">---------------------------------------------------------------------------------</span>|<span class="string">--------------------</span>|</span><br><span class="line">|<span class="string">                                                                      </span>|<span class="string"> lock:2   </span>|<span class="string"> Marked  for  GC    </span>|</span><br><span class="line">|<span class="string">---------------------------------------------------------------------------------</span>|<span class="string">--------------------</span>|</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨<strong>64ä½è™šæ‹Ÿæœº</strong>ä¸‹ï¼Œ<strong>Mark Word</strong>æ˜¯<strong>64bit</strong>å¤§å°çš„ï¼Œå…¶å­˜å‚¨ç»“æ„å¦‚ä¸‹ï¼š</p></blockquote><p>ï¼ˆåœ¨ä¸åŒçš„é”æƒ…å†µä¸‹æ¯ä¸€ä½çš„ä½œç”¨ä¸ä¸€æ ·ï¼‰  </p><table>  <tr>    <td rowspan="2">é”çŠ¶æ€</td>    <td>25bit</td>    <td>31bit</td>    <td>1bit</td>    <td>4bit</td>    <td>1bit</td>    <td>2bit</td>  </tr>  <tr>    <td> </td>    <td> </td>    <td>cms_free</td>    <td>åˆ†ä»£å¹´é¾„</td>    <td>åå‘é”</td>    <td>é”æ ‡å¿—ä½</td>  </tr>  <tr>    <td>æ— é”</td>    <td>unusedï¼ˆæ²¡æœ‰ä½¿ç”¨ï¼‰</td>    <td>hashCode</td>    <td></td>    <td></td>    <td>0ï¼ˆæ˜¯å¦æ˜¯åå‘é”ï¼›0è¡¨ç¤ºéåå‘é”ï¼›1è¡¨ç¤ºæ˜¯åå‘é”ï¼‰</td>    <td>01ï¼ˆé”çš„æ ‡å¿—ä½ï¼›01ä»£è¡¨æ— é”ï¼›00ä»£è¡¨è½»é‡çº§é”ï¼›10ä»£è¡¨é‡é‡çº§é”ï¼‰</td>  </tr>    <tr>    <td>åå‘é”</td>    <td colspan="2">ThreadId(54bit)Epoch(2bit)</td>    <td></td>    <td></td>    <td>1</td>    <td>01</td>  </tr>  <tr>    <td>è½»é‡çº§é”</td>    <td colspan="5">æŒ‡å‘æ ˆä¸­é”è®°å½•çš„æŒ‡é’ˆ</td>    <td>00</td>  </tr>  <tr>    <td>é‡é‡çº§é”</td>    <td colspan="5">æŒ‡å‘äº’æ–¥é‡ï¼ˆé‡é‡çº§é”ï¼‰çš„æŒ‡é’ˆ</td>    <td>10</td>  </tr></table><blockquote><p>åœ¨32ä½è™šæ‹Ÿæœºä¸‹ï¼ŒMark Wordæ˜¯32bitå¤§å°çš„ï¼Œå…¶å­˜å‚¨ç»“æ„å¦‚ä¸‹ï¼š</p></blockquote><table>  <tr>    <td rowspan="2">é”çŠ¶æ€</td>    <td colspan="2">25bit</td>    <td rowspan="2">4bit</td>    <td>1bit</td>    <td>2bit</td>  </tr>  <tr>    <td>23bit</td>    <td>2bit</td>    <td>æ˜¯å¦æ˜¯åå‘é”</td>    <td>é”æ ‡å¿—ä½</td>  </tr>    <td>è½»é‡çº§é”</td>    <td colspan="4">æŒ‡å‘æ ˆä¸­é”è®°å½•çš„æŒ‡é’ˆ</td>    <td>00</td>    <tr>    <td>é‡é‡çº§é”</td>    <td colspan="4">æŒ‡å‘äº’æ–¥é‡ï¼ˆé‡é‡çº§é”ï¼‰çš„æŒ‡é’ˆ</td>    <td>10</td>  </tr></table><p>ä¸€èˆ¬ç½‘ç»œä¸Šæ˜¯32ä½å±…å¤šï¼›<br>ç°åœ¨çš„è™šæ‹Ÿæœºç»å¤§å¤šæ•°ä½¿ç”¨çš„æ˜¯64ä½è™šæ‹Ÿæœºï¼›<br>æ‰€ä»¥ç°ä¸‹å…³æ³¨çš„æ˜¯64ä½è™šæ‹ŸæœºMarkWordçš„å­˜å‚¨ç»“æ„ï¼›<br>å…³äºä¸Šè¿°32or64ä½è™šæ‹Ÿæœºçš„mark wordæ˜¯å¤šå°‘bitçš„å­˜å‚¨ç»“æ„ç­‰ä¿¡æ¯åœ¨markOop.hppå½“ä¸­æœ‰è¯¦ç»†ä»‹ç»ï¼›</p><p>Klass pointer ç±»å‹æŒ‡é’ˆï¼›</p><h3 id="Klass-pointer"><a href="#Klass-pointer" class="headerlink" title="Klass pointer"></a>Klass pointer</h3><p>javaå½“ä¸­çš„å¯¹è±¡è‚¯å®šæ˜¯ç”±æŸä¸ªç±»æ‰€äº§ç”Ÿçš„ï¼›<br>é‚£ä¹ˆKlass pointerå°±æ˜¯ç”¨æ¥è¡¨ç¤ºè¯¥å¯¹è±¡æ˜¯å“ªä¸€ä¸ªç±»æ‰€äº§ç”Ÿçš„ï¼›<br>Klass pointerä¼šä¿å­˜è¿™ä¸ªç±»çš„å…ƒä¿¡æ¯ï¼›<br>Klass pointeræ ¹æ®è™šæ‹Ÿæœºå¤§å°å…¶è‡ªèº«å¤§å°ä¹Ÿä¸ä¸€æ ·ï¼›<br>å¦‚æœæ˜¯32ä½è™šæ‹Ÿæœºåˆ™å…¶Klass pointerçš„å¤§å°ä¸º32ä½ï¼›<br>å¦‚æœæ˜¯64ä½è™šæ‹Ÿæœºåˆ™å…¶Klass pointerçš„å¤§å°ä¸º64ä½ï¼›<br>ä¸€èˆ¬æ¥è¯´è™šæ‹Ÿæœºéƒ½ä¼šå¼€å¯æŒ‡é’ˆå‹ç¼©ï¼›<br>å³ä¹Ÿå°±æ˜¯è¯´åœ¨64ä½è™šæ‹Ÿæœºæƒ…å†µä¸‹å…¶Klass pointerä¹Ÿä¼šè¢«å‹ç¼©æˆ32ä½ï¼›</p><p>è¿™ä¸€éƒ¨åˆ†ç”¨äº å­˜å‚¨å¯¹è±¡çš„ç±»å‹æŒ‡é’ˆï¼Œ<br>è¯¥æŒ‡é’ˆ æŒ‡å‘å®ƒçš„ç±»å…ƒæ•°æ®ï¼Œ<br>JVMé€šè¿‡è¿™ä¸ªæŒ‡é’ˆç¡®å®šå¯¹è±¡æ˜¯å“ªä¸ªç±»çš„å®ä¾‹ã€‚<br>è¯¥æŒ‡é’ˆçš„ä½é•¿åº¦ä¸ºJVMçš„ä¸€ä¸ªå­—å¤§å°ï¼Œå³32ä½çš„JVMä¸º32ä½ï¼Œ64ä½çš„JVMä¸º64ä½ï¼›</p><p>å¦‚æœåº”ç”¨çš„å¯¹è±¡è¿‡å¤šï¼Œä½¿ç”¨64ä½çš„æŒ‡é’ˆå°†å¤§é‡æµªè´¹å†…å­˜ï¼Œ<br>ç»Ÿè®¡è€Œè¨€ï¼Œ64ä½çš„JVMå°†ä¼šæ¯”32ä½çš„JVMå¤šè€—è´¹50%çš„å†…å­˜ã€‚<br>ä¸ºäº†èŠ‚çº¦å†…å­˜å¯ä»¥ä½¿ç”¨é€‰é¡¹<code>-XX:+UseCompressedOops</code>å¼€å¯æŒ‡é’ˆå‹ç¼©ï¼›<br>å…¶ä¸­ï¼Œoopå³ordinary object pointeræ™®é€šå¯¹è±¡æŒ‡é’ˆã€‚<br>å¼€å¯è¯¥é€‰é¡¹åï¼Œä¸‹åˆ—æŒ‡é’ˆå°†å‹ç¼©è‡³32ä½ï¼š</p><ol><li>æ¯ä¸ªClassçš„å±æ€§æŒ‡é’ˆï¼ˆå³é™æ€å˜é‡ï¼‰</li><li>æ¯ä¸ªå¯¹è±¡çš„å±æ€§æŒ‡é’ˆï¼ˆå³å¯¹è±¡å˜é‡ï¼‰</li><li>æ™®é€šå¯¹è±¡æ•°ç»„çš„æ¯ä¸ªå…ƒç´ æŒ‡é’ˆ</li></ol><p>å½“ç„¶ï¼Œä¹Ÿä¸æ˜¯æ‰€æœ‰çš„æŒ‡é’ˆéƒ½ä¼šå‹ç¼©ï¼›<br>ä¸€äº›ç‰¹æ®Šç±»å‹çš„æŒ‡é’ˆJVMä¸ä¼šä¼˜åŒ–ï¼Œ<br>æ¯”å¦‚æ‰§è¡ŒPermGençš„Classå¯¹è±¡æŒ‡é’ˆï¼ˆJDK8ä¸­æŒ‡å‘å…ƒç©ºé—´çš„Classå¯¹è±¡æŒ‡é’ˆï¼‰ã€æœ¬åœ°å˜é‡ã€å †æ ˆå…ƒç´ ã€å…¥å‚ã€è¿”å›å€¼å’ŒNULLæŒ‡é’ˆç­‰ã€‚</p><p>å¯¹è±¡å¤´ = Mark Word + ç±»å‹æŒ‡é’ˆï¼ˆæœªå¼€å¯æŒ‡é’ˆå‹ç¼©çš„æƒ…å†µä¸‹ï¼‰<br>åœ¨32ä½ç³»ç»Ÿä¸­ï¼ŒMark Word = 4 bytesï¼Œ ç±»å‹æŒ‡é’ˆ = 4bytesï¼Œ å¯¹è±¡å¤´ = 8bytes = 64 bitsï¼›<br>åœ¨64ä½ç³»ç»Ÿä¸­ï¼ŒMark Word = 8 bytesï¼Œ ç±»å‹æŒ‡é’ˆ = 8bytesï¼Œ å¯¹è±¡å¤´ = 16bytes = 128 bitsï¼›</p><h3 id="å®ä¾‹æ•°æ®"><a href="#å®ä¾‹æ•°æ®" class="headerlink" title="å®ä¾‹æ•°æ®"></a>å®ä¾‹æ•°æ®</h3><p>å°±æ˜¯ç±»ä¸­å®šä¹‰çš„æˆå‘˜å˜é‡ã€‚</p><h3 id="å¯¹é½å¡«å……"><a href="#å¯¹é½å¡«å……" class="headerlink" title="å¯¹é½å¡«å……"></a>å¯¹é½å¡«å……</h3><p>ï¼ˆå¯èƒ½æœ‰å¯èƒ½æ²¡æœ‰ï¼›å¦‚æœjavaå¯¹è±¡æ•´ä½“å¤§å°ä¸º8å­—èŠ‚çš„æ•´æ•°å€é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±ä¸éœ€è¦å¯¹é½å¡«å……ï¼›å¦‚æœjavaå¯¹è±¡æ•´ä½“å¤§å°ä¸ä¸º8å­—èŠ‚çš„æ•´æ•°å€é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±éœ€è¦å¯¹é½å¡«å……çš„ä¸€äº›å¡«å……æ•°æ®ä½¿ä¹‹å¯¹é½ä»è€Œå˜æˆ8å­—èŠ‚çš„æ•´æ•°å€ï¼›é‚£ä¹ˆè¿™æ ·æ˜¯æ–¹ä¾¿æ“ä½œç³»ç»Ÿæ¥è¿›è¡Œå¯»å€çš„ï¼‰ï¼›<br>å¯¹é½å¡«å……å¹¶ä¸æ˜¯å¿…ç„¶å­˜åœ¨çš„ï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„æ„ä¹‰ï¼Œå®ƒä»…ä»…èµ·ç€å ä½ç¬¦çš„ä½œç”¨ã€‚<br>ç”±äºHotSpot VMçš„è‡ªåŠ¨å†…å­˜ç®¡ç†ç³»ç»Ÿ è¦æ±‚ å¯¹è±¡èµ·å§‹åœ°å€å¿…é¡»æ˜¯8å­—èŠ‚çš„æ•´æ•°å€ã€‚<br>æ¢å¥è¯è¯´ï¼Œå°±æ˜¯å¯¹è±¡çš„å¤§å°å¿…é¡»æ˜¯8å­—èŠ‚çš„æ•´æ•°å€ã€‚<br>è€Œå¯¹è±¡å¤´æ­£å¥½æ˜¯8å­—èŠ‚çš„æ•´æ•°å€ï¼Œ<br>å› æ­¤ï¼Œå½“å¯¹è±¡å®ä¾‹æ•°æ®æ²¡æœ‰å¯¹é½æ—¶ï¼Œå°±éœ€è¦é€šè¿‡å¯¹é½å¡«å……æ¥è¡¥å…¨ã€‚</p><h3 id="æŸ¥çœ‹javaå¯¹è±¡å¸ƒå±€"><a href="#æŸ¥çœ‹javaå¯¹è±¡å¸ƒå±€" class="headerlink" title="æŸ¥çœ‹javaå¯¹è±¡å¸ƒå±€"></a>æŸ¥çœ‹javaå¯¹è±¡å¸ƒå±€</h3><p>ä¹‹å‰æ˜¯é€šè¿‡è§‚å¯ŸJVMæºç çš„æ–¹å¼æ¥è¿›è¡ŒæŸ¥çœ‹çš„æ¥ç€æ¥è¿›è¡ŒéªŒè¯ä¸€ä¸‹ï¼›<br>å·¥å…·ç±»ï¼›openjdkæä¾›å«åšjolï¼›<br>javaå¯¹è±¡å¸ƒå±€çš„å·¥å…·ï¼›å¯ä»¥æ¥æŸ¥çœ‹javaå¯¹è±¡å¸ƒå±€ï¼›</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.openjdk.jol<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">aratifactId</span>&gt;</span>jol-core<span class="tag">&lt;/<span class="name">aratifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br></pre></td><td class="code"><pre><span class="line">--------------------------------------------------</span><br><span class="line">package com.xxx.demo06_object_layout;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="symbol">LockObj</span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="built_in">int</span> x;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------</span><br><span class="line">package com.xxx.demo06_object_layout;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.openjdk.jol.info.ClassLayout;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="symbol">Demo01</span>&#123;</span><br><span class="line">  <span class="keyword">public</span> static <span class="built_in">void</span> main(String[] args)&#123;</span><br><span class="line">    LockObj obj = new LockObj();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//parseInstance è§£æå®ä¾‹å¯¹è±¡ï¼›</span></span><br><span class="line">    <span class="comment">//toPrintableè¿›è¡Œæ‰“å°å…¶è§£æçš„å®ä¾‹å¯¹è±¡ä¿¡æ¯</span></span><br><span class="line">    ClassLayout.parseInstance(obj).toPrintable().;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">----------------------------------------------------</span><br><span class="line">æ‰“å°å¯¹è±¡å¸ƒå±€ï¼š</span><br><span class="line">com.xxx.demo06_object_layout.LockObj object <span class="built_in">int</span>ernals:</span><br><span class="line"> OFFSET   SIZE   TYPE  DESCRIPTION         VALUE</span><br><span class="line">      <span class="number">0</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     <span class="number">01</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> (<span class="number">00000001</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span>) (<span class="number">1</span>)</span><br><span class="line">      <span class="number">4</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> (<span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span>) (<span class="number">0</span>)</span><br><span class="line">      <span class="number">8</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     <span class="number">43</span> c1 <span class="number">00</span> f8 (<span class="number">01000011</span> <span class="number">11000001</span> <span class="number">00000000</span> <span class="number">11111000</span>) (<span class="number">-134168253</span>)</span><br><span class="line">     <span class="number">12</span>      <span class="number">4</span>    <span class="built_in">int</span>   LockObj.x           <span class="number">0</span></span><br><span class="line"> Instance size: <span class="number">16</span> bytes</span><br><span class="line"> Space losses: <span class="number">0</span> bytes <span class="built_in">int</span>ernal + <span class="number">0</span> bytes <span class="keyword">external</span> = <span class="number">0</span> bytes total</span><br><span class="line">-----------------------------------------------------</span><br><span class="line">åˆ†æï¼š</span><br><span class="line">ä»æ•´ä¸ªå¯¹è±¡å¼€å§‹ï¼›</span><br><span class="line">OFFSETåç§»<span class="number">0</span>ï¼›SIZEä¸º<span class="number">4</span>è¡¨ç¤ºç”¨äº†<span class="number">4</span>ä¸ªå­—èŠ‚å»è¿›è¡Œæè¿°DESCRIPTIONå¯¹è±¡å¤´object headerä¿¡æ¯ï¼›</span><br><span class="line">OFFSETåç§»<span class="number">4</span>ï¼›SIZEä¸º<span class="number">4</span>è¡¨ç¤ºç”¨äº†<span class="number">4</span>ä¸ªå­—èŠ‚ä¹Ÿæ˜¯å»è¿›è¡Œæè¿°DESCRIPTIONä¸å¯¹è±¡å¤´object headerç›¸å…³çš„å†…å®¹ï¼›</span><br><span class="line">OFFSETåç§»<span class="number">8</span>ï¼›SIZEä¸º<span class="number">4</span>è¡¨ç¤ºç”¨äº†<span class="number">4</span>ä¸ªå­—èŠ‚ä¹Ÿæ˜¯å»è¿›è¡Œæè¿°DESCRIPTIONä¸å¯¹è±¡å¤´object headerç›¸å…³çš„å†…å®¹ï¼›</span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶æ¥çœ‹å¯¹è±¡å¤´object headeræ‰€å äº†<span class="number">3</span> * <span class="number">4</span> = <span class="number">12</span>ä¸ªå­—èŠ‚æ¥è¿›è¡Œæè¿°ä¸å¯¹è±¡å¤´object headerç›¸å…³ä¿¡æ¯ï¼›</span><br><span class="line">ä¸ä¹‹å‰æ‰€è¯´ï¼šåœ¨<span class="number">64</span>ä½ç³»ç»Ÿä¸­ï¼ŒMark Word = <span class="number">8</span> bytesï¼Œç±»å‹æŒ‡é’ˆ = <span class="number">8</span>bytesï¼Œå¯¹è±¡å¤´ = <span class="number">16</span> bytes = <span class="number">128</span> bitsï¼›æ­¤å¤„å­˜åœ¨åå·®ï¼›</span><br><span class="line">ç”±äºä¹Ÿæ˜¯<span class="number">64</span>ä½æ“ä½œç³»ç»Ÿä½†æ˜¯æ‰“å°å¾—åˆ°å…¶å¯¹è±¡å¸ƒå±€ä¿¡æ¯å¾—åˆ°çš„å¯¹è±¡å¤´æ‰€å å­—èŠ‚ä¿¡æ¯ä¸ä¸€è‡´ï¼›</span><br><span class="line">å®é™…ä¸Šæ‰“å°å‡ºæ¥å¯¹è±¡å¤´object headeræ‰€å å­—èŠ‚æ•°å¹¶ä¸æ˜¯<span class="number">16</span>ä¸ªå­—èŠ‚è€Œæ˜¯<span class="number">12</span>ä¸ªå­—èŠ‚ï¼›</span><br><span class="line">é‚£ä¹ˆä¸ºä»€ä¹ˆæ‰“å°å‡ºæ¥çš„å¯¹è±¡å¸ƒå±€ä¿¡æ¯ä¸­çš„object headerå¯¹è±¡å¤´ä¿¡æ¯æ‰€å å­—èŠ‚ä¸æ˜¯<span class="number">16</span>ä¸ªå­—èŠ‚è€Œæ˜¯<span class="number">12</span>ä¸ªå­—èŠ‚å‘¢?</span><br><span class="line">é‚£ä¹ˆè¿™æ˜¯å› ä¸ºJVMé»˜è®¤è‡ªåŠ¨å¼€å¯äº†æŒ‡é’ˆå‹ç¼©çš„é€‰é¡¹å‚æ•°ï¼›</span><br><span class="line">ä»è€Œä¹Ÿå°±å¯¼è‡´äº†JVMåœ¨é»˜è®¤æƒ…å†µä¸‹å»è¿›è¡Œæ‰“å°å¯¹è±¡å¸ƒå±€å½“ä¸­çš„å¯¹è±¡å¤´ä¿¡æ¯æ‰€å å­—èŠ‚ä¸º<span class="number">12</span>ä¸ªå­—èŠ‚è€Œä¸æ˜¯<span class="number">16</span>ä¸ªå­—èŠ‚ï¼›</span><br><span class="line">æ‰€ä»¥æ­¤æ—¶å¯ä»¥å°è¯•è¿›è¡Œå…³é—­æŒ‡é’ˆå‹ç¼©è¿›è¡Œå°è¯•ï¼›</span><br><span class="line">é€‰é¡¹-XX:+UseCompressedOopsæ˜¯ç”¨æ¥è¿›è¡Œå¼€å¯æŒ‡é’ˆå‹ç¼©ï¼›</span><br><span class="line">æ‰€ä»¥æ­¤æ—¶å¯ä»¥ç”¨-XX:+UseCompressedOopsæ‹¿è¿‡æ¥æ¥ä½œä¸ºJVMçš„ä¸€ä¸ªå‚æ•°ï¼›</span><br><span class="line">å³æ‰“å¼€ideaçš„Run/Debug Configurationsä¸­å¡«å…¥åˆ°VM optionså½“ä¸­å³å¯ï¼›</span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶è¦æ³¨æ„çš„æ˜¯-XX:+UseCompressedOopsæ˜¯ç”¨æ¥å¼€å¯æŒ‡é’ˆå‹ç¼©çš„ï¼›</span><br><span class="line">è€ŒJVMé»˜è®¤å°±æ˜¯å¼€å¯æŒ‡é’ˆå‹ç¼©çš„ï¼›è€Œæ­¤æ—¶è¦åšçš„æ˜¯è®©JVMå…³é—­æŒ‡é’ˆå‹ç¼©ï¼›</span><br><span class="line">æ‰€ä»¥æ­¤æ—¶VM optionså½“ä¸­å¡«å…¥çš„å³ä¸ºï¼š-XX:-UseCompressedOopsï¼›</span><br><span class="line">-XX:-UseCompressedOopså³ - ä¸ºå…³é—­æŒ‡é’ˆå‹ç¼©äº†ï¼›</span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line">å†æ¬¡æ‰“å°å¯¹è±¡å¸ƒå±€:</span><br><span class="line">com.xxx.demo06_object_layout.LockObj object <span class="built_in">int</span>ernals:</span><br><span class="line"> OFFSET   SIZE   TYPE  DESCRIPTION         VALUE</span><br><span class="line">      <span class="number">0</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     <span class="number">01</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> (<span class="number">00000001</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span>) (<span class="number">1</span>)</span><br><span class="line">      <span class="number">4</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> (<span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span>) (<span class="number">0</span>)</span><br><span class="line">      <span class="number">8</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     d8 <span class="number">34</span> <span class="number">5</span>a <span class="number">25</span> (<span class="number">11011000</span> <span class="number">00110100</span> <span class="number">01011010</span> <span class="number">00100101</span>) (<span class="number">626668760</span>)</span><br><span class="line">     <span class="number">12</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> (<span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span>) (<span class="number">0</span>)</span><br><span class="line">     <span class="number">16</span>      <span class="number">4</span>    <span class="built_in">int</span>   LockObj.x           <span class="number">0</span></span><br><span class="line">     <span class="number">20</span>      <span class="number">4</span>        ï¼ˆloss due to the next object alignmentï¼‰</span><br><span class="line"> Instance size: <span class="number">24</span> bytes</span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line"> æ­¤æ—¶å°±å¯ä»¥åˆ†æçœ‹åˆ°å¯¹è±¡å¸ƒå±€å½“ä¸­object headerå¯¹è±¡å¤´æ‰€å å­—èŠ‚ä¸º<span class="number">16</span>ä¸ªå­—èŠ‚ï¼›</span><br><span class="line"> å…¶ä¸­ï¼›åé¢<span class="number">8</span>ä¸ªå­—èŠ‚å³ç¬¬ä¸‰æ’å’Œç¬¬å››æ’çš„object headeræ˜¯ç”¨æ¥è¡¨ç¤ºKlass pointerï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªå¯¹è±¡æ‰€å¯¹åº”çš„è¿™ä¸ªç±»çš„å…ƒä¿¡æ¯ï¼›</span><br><span class="line"> LockObj.xåœ¨åç§»OFFSETä¸º<span class="number">16</span>çš„æ—¶å€™æ‰€å å­—èŠ‚ä¸º<span class="number">4</span>ä¸ªå­—èŠ‚ï¼›</span><br><span class="line"> é‚£ä¹ˆæ­¤æ—¶æ‰€ç´¯åŠ å­—èŠ‚æ•°ä¸º <span class="number">16</span>ä¸ªå¯¹è±¡å¤´ä¿¡æ¯æ‰€å å­—èŠ‚æ•° + LockObject.x <span class="built_in">int</span>ç±»å‹å˜é‡æ‰€å å­—èŠ‚æ•°ä¸º<span class="number">4</span>ä¸ªå­—èŠ‚ = ç´¯è®¡å½“å‰å­—èŠ‚æ•°ä¸º <span class="number">20</span> ä¸ªå­—èŠ‚ï¼›</span><br><span class="line"> ï¼ˆé‚£ä¹ˆå½“å‰æ­¤æ—¶æ˜¯ä¸æ»¡è¶³å¯¹è±¡å¤´ä¿¡æ¯æ€»å å­—èŠ‚æ•°éœ€è¦ä¸º<span class="number">8</span>ä¸ªå­—èŠ‚çš„æ•´æ•°å€è¿™ä¸€é™åˆ¶æ¡ä»¶çš„ï¼›ï¼‰</span><br><span class="line">è€Œ<span class="number">20</span>ä¸ªå­—èŠ‚å¹¶ä¸æ˜¯<span class="number">8</span>å­—èŠ‚çš„æ•´æ•°å€ï¼›</span><br><span class="line">æ‰€ä»¥æ­¤æ—¶å°±æœ‰äº†å¡«å……æ•°æ®ï¼›å³æœ€åä¸€æ’çš„<span class="number">4</span>ä¸ªå­—èŠ‚ï¼ŒåŠ äº†<span class="number">4</span>ä¸ªå­—èŠ‚çš„å¡«å……æ•°æ®ï¼›å³:</span><br><span class="line"> <span class="number">20</span>      <span class="number">4</span>        ï¼ˆloss due to the next object alignmentï¼‰</span><br><span class="line">é‚£ä¹ˆå°†å…³é—­æŒ‡é’ˆå‹ç¼©å‚æ•°è¿›è¡Œå»æ‰å†æ¬¡åˆ†æåŸæ¥çš„æ‰“å°ç»“æœï¼š</span><br><span class="line">VM options: -XX:+UseCompressedOops</span><br><span class="line">------------------------------------------------------------------</span><br><span class="line">å†æ¬¡æ‰“å°å¯¹è±¡å¸ƒå±€ï¼š</span><br><span class="line">com.xxx.demo06_object_layout.LockObj object <span class="built_in">int</span>ernals:</span><br><span class="line"> OFFSET   SIZE   TYPE  DESCRIPTION         VALUE</span><br><span class="line">      <span class="number">0</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     <span class="number">01</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> (<span class="number">00000001</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span>) (<span class="number">1</span>)</span><br><span class="line">      <span class="number">4</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> (<span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span>) (<span class="number">0</span>)</span><br><span class="line">      <span class="number">8</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     <span class="number">43</span> c1 <span class="number">00</span> f8 (<span class="number">01000011</span> <span class="number">11000001</span> <span class="number">00000000</span> <span class="number">11111000</span>) (<span class="number">-134168253</span>)</span><br><span class="line">     <span class="number">12</span>      <span class="number">4</span>    <span class="built_in">int</span>   LockObj.x           <span class="number">0</span></span><br><span class="line"> Instance size: <span class="number">16</span> bytes</span><br><span class="line"> Space losses: <span class="number">0</span> bytes <span class="built_in">int</span>ernal + <span class="number">0</span> bytes <span class="keyword">external</span> = <span class="number">0</span> bytes total</span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line">ä»ä¸Šé¢çš„åˆ†æå¯å¾—æ­¤æ—¶Klass pointerçš„æŒ‡é’ˆåªå äº†<span class="number">4</span>ä¸ªå­—èŠ‚ï¼›å³ï¼š</span><br><span class="line"><span class="number">8</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     <span class="number">43</span> c1 <span class="number">00</span> f8 (<span class="number">01000011</span> <span class="number">11000001</span> <span class="number">00000000</span> <span class="number">11111000</span>) (<span class="number">-134168253</span>)</span><br><span class="line">æ•´ä¸ªå¯¹è±¡å¸ƒå±€å½“ä¸­å¯¹è±¡å¤´ä¿¡æ¯æ‰€å å­—èŠ‚æ•°ä¸º<span class="number">12</span>ä¸ªå­—èŠ‚ï¼›</span><br><span class="line">å†åŠ ä¸ŠLockObjå½“ä¸­çš„<span class="built_in">int</span>ç±»å‹å˜é‡å æœ‰<span class="number">4</span>ä¸ªå­—èŠ‚ï¼›</span><br><span class="line">æ‰€ä»¥æ­¤æ—¶ç´¯è®¡æ€»å…±å æœ‰å­—èŠ‚æ•°ä¸º<span class="number">16</span>ä¸ªå­—èŠ‚ï¼›ä¸º<span class="number">8</span>å­—èŠ‚çš„æ•´æ•°å€ï¼›</span><br><span class="line">æ‰€ä»¥æ­¤æ—¶å¹¶æ²¡æœ‰å¡«å……æ•°æ®ï¼›</span><br><span class="line">é‚£ä¹ˆå†åšæµ‹è¯•åœ¨LockObjç±»å½“ä¸­å†å†™ä¸€ä¸ªå˜é‡<span class="keyword">private</span> <span class="built_in">bool</span>ean bï¼›</span><br><span class="line">é‚£ä¹ˆå¸ƒå°”ç±»å‹çš„å˜é‡åœ¨javaå½“ä¸­æ‰€å å­—èŠ‚æ˜¯ä¸º<span class="number">1</span>ä¸ªå­—èŠ‚ï¼›</span><br><span class="line">---------------------------------------------------------</span><br><span class="line">package com.xxx.demo06_object_layout;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="symbol">LockObj</span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="built_in">int</span> x;</span><br><span class="line">  <span class="keyword">private</span> <span class="built_in">bool</span>ean b;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------------</span><br><span class="line">å†æ¬¡æ‰“å°å¯¹è±¡å¸ƒå±€ï¼š</span><br><span class="line">com.xxx.demo06_object_layout.LockObj object <span class="built_in">int</span>ernals:</span><br><span class="line"> OFFSET   SIZE   TYPE  DESCRIPTION         VALUE</span><br><span class="line">      <span class="number">0</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     <span class="number">01</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> (<span class="number">00000001</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span>) (<span class="number">1</span>)</span><br><span class="line">      <span class="number">4</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> (<span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span>) (<span class="number">0</span>)</span><br><span class="line">      <span class="number">8</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     <span class="number">43</span> c1 <span class="number">00</span> f8 (<span class="number">01000011</span> <span class="number">11000001</span> <span class="number">00000000</span> <span class="number">11111000</span>) (<span class="number">-134168253</span>)</span><br><span class="line">     <span class="number">12</span>      <span class="number">4</span>    <span class="built_in">int</span>   LockObj.x           <span class="number">0</span></span><br><span class="line">     <span class="number">16</span>      <span class="number">1</span>  <span class="built_in">bool</span>ean LockObj.b           <span class="literal">false</span></span><br><span class="line">     <span class="number">17</span>      <span class="number">7</span>    <span class="built_in">int</span> ï¼ˆloss due to the next object alignmentï¼‰</span><br><span class="line"> Instance size: <span class="number">24</span> bytes</span><br><span class="line">--------------------------------------------------------</span><br><span class="line">æ­¤æ—¶åˆ†æåˆ°ï¼š<span class="built_in">bool</span>eanå¸ƒå°”ç±»å‹åœ¨å…¶ä¸­å ç”¨åˆ°äº†<span class="number">1</span>ä¸ªå­—èŠ‚æ•°ï¼›</span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶ç´¯åŠ åˆ°å­—èŠ‚æ•°å³ä¸ºï¼š<span class="number">12</span>ä¸ªå¯¹è±¡å¤´ä¿¡æ¯æ‰€å å­—èŠ‚æ•° + LockObjå½“ä¸­<span class="built_in">int</span>ç±»å‹å˜é‡æ‰€å å­—èŠ‚æ•°<span class="number">4</span>ä¸ªå­—èŠ‚ + LockObjå½“ä¸­<span class="built_in">bool</span>eanç±»å‹æ‰€å å­—èŠ‚æ•°ä¸º<span class="number">1</span>ä¸ªå­—èŠ‚ = æ€»è®¡å­—èŠ‚æ•°ä¸º<span class="number">17</span>ä¸ªå­—èŠ‚ï¼›</span><br><span class="line">è€Œ<span class="number">17</span>ä¸ªå­—èŠ‚æ•°æ˜¾ç„¶æ˜¯ä¸æ»¡è¶³<span class="number">8</span>å­—èŠ‚çš„æ•´æ•°å€è¿™ä¸€è¯´æ³•ï¼›</span><br><span class="line">æ‰€ä»¥å°±å­˜åœ¨æœ‰æœ€åä¸€æ’çš„å¯¹é½å¡«å……æ•°æ®å æœ‰<span class="number">7</span>ä¸ªå­—èŠ‚è¿›è¡Œå¹³è¡¡ï¼›å³ï¼š</span><br><span class="line"><span class="number">17</span>      <span class="number">7</span>    <span class="built_in">int</span> ï¼ˆloss due to the next object alignmentï¼‰</span><br><span class="line">å¡«å……äº†<span class="number">7</span>ä¸ªå­—èŠ‚ä¹‹åå¯¼è‡´æ•°æ®å®ä¾‹å¤§å°ä¸º<span class="number">24</span>ä¸ªå­—èŠ‚æ»¡è¶³<span class="number">8</span>å­—èŠ‚çš„æ•´æ•°å€è¿™ä¸€è¯´æ³•ï¼›</span><br><span class="line">å¦å¤–è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨<span class="number">64</span>ä½è™šæ‹Ÿæœºä¸‹ï¼ŒMark Wordæ˜¯<span class="number">64</span>bitå¤§å°çš„ï¼›</span><br><span class="line">å…¶ä¸­æ˜¯å­˜åœ¨æœ‰<span class="number">31</span>ä½å¯¼è‡´hashCodeçš„ï¼›ä½†æ˜¯æ ¹æ®ä¸Šè¿°çš„æ‰“å°ç»“æœæ¥çœ‹å¥½åƒæ˜¯å¹¶æ²¡æœ‰çœ‹åˆ°ä»€ä¹ˆæœ‰å…³hashCodeç›¸å…³çš„å†…å®¹ï¼›</span><br><span class="line"><span class="number">8</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     <span class="number">43</span> c1 <span class="number">00</span> f8 (<span class="number">01000011</span> <span class="number">11000001</span> <span class="number">00000000</span> <span class="number">11111000</span>) (<span class="number">-134168253</span>)</span><br><span class="line">é™¤äº†åœ°å€ä¹‹å¤–æ²¡æœ‰çœ‹åˆ°æœ‰å…³hashCodeç›¸å…³çš„å†…å®¹ï¼›</span><br><span class="line"></span><br><span class="line">hashCodeçš„å–å€¼ä¸æ˜¯ä¸€æ¥å°±æœ‰çš„ï¼›</span><br><span class="line">è€Œæ˜¯å…ˆéœ€è¦åœ¨ä»£ç å±‚å½“ä¸­ä½¿ç”¨åˆ°äº†è¿™ä¸ªhashCodeé‚£ä¹ˆå®ƒæ‰ä¼šå»è¿›è¡Œä¿å­˜è¿™ä¸ªhashCodeå–å€¼ï¼›</span><br><span class="line">ä¹Ÿå°±æ˜¯è¯´ç”ŸæˆLockObj objå¯¹è±¡ä¹‹åï¼Œéœ€è¦å»ä»£ç å±‚å½“ä¸­è°ƒç”¨è¯¥objå¯¹è±¡çš„.hashCode()æ–¹æ³•ï¼›é‚£ä¹ˆåœ¨æ‰“å°ç»“æœå½“ä¸­æ‰èƒ½å¤Ÿçœ‹åˆ°æœ‰å…³hashCodeçš„ä¿¡æ¯ï¼›</span><br><span class="line">-------------------------------------------------------------</span><br><span class="line">package com.xxx.demo06_object_layout;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.openjdk.jol.info.ClassLayout;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="symbol">Demo01</span>&#123;</span><br><span class="line">  <span class="keyword">public</span> static <span class="built_in">void</span> main(String[] args)&#123;</span><br><span class="line">    LockObj obj = new LockObj();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è°ƒç”¨objå¯¹è±¡çš„hashCode()æ–¹æ³•</span></span><br><span class="line">    obj.hashCode();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//parseInstance è§£æå®ä¾‹å¯¹è±¡ï¼›</span></span><br><span class="line">    <span class="comment">//toPrintableè¿›è¡Œæ‰“å°å…¶è§£æçš„å®ä¾‹å¯¹è±¡ä¿¡æ¯</span></span><br><span class="line">    ClassLayout.parseInstance(obj).toPrintable().;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">-----------------------------------------------------------</span><br><span class="line">å†æ¬¡æ‰“å°å¯¹è±¡å¸ƒå±€ï¼š</span><br><span class="line">com.xxx.demo06_object_layout.LockObj object <span class="built_in">int</span>ernals:</span><br><span class="line"> OFFSET   SIZE   TYPE  DESCRIPTION         VALUE</span><br><span class="line">      <span class="number">0</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     <span class="number">01</span> <span class="number">28</span> <span class="number">6</span>e <span class="number">6f</span> (<span class="number">00000001</span> <span class="number">00101000</span> <span class="number">01101110</span> <span class="number">01101111</span>) (<span class="number">1869490177</span>)</span><br><span class="line">      <span class="number">4</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     <span class="number">6</span>d <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> (<span class="number">01101101</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span>) (<span class="number">109</span>)</span><br><span class="line">      <span class="number">8</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     <span class="number">43</span> c1 <span class="number">00</span> f8 (<span class="number">01000011</span> <span class="number">11000001</span> <span class="number">00000000</span> <span class="number">11111000</span>) (<span class="number">-134168253</span>)</span><br><span class="line">     <span class="number">12</span>      <span class="number">4</span>    <span class="built_in">int</span>   LockObj.x           <span class="number">0</span></span><br><span class="line">     <span class="number">16</span>      <span class="number">1</span>  <span class="built_in">bool</span>ean LockObj.b           <span class="literal">false</span></span><br><span class="line">     <span class="number">17</span>      <span class="number">7</span>    <span class="built_in">int</span> ï¼ˆloss due to the next object alignmentï¼‰</span><br><span class="line"> Instance size: <span class="number">24</span> bytes</span><br><span class="line">-----------------------------------------------------------</span><br><span class="line">å†æ¬¡åˆ†æå¯¹è±¡å¸ƒå±€çš„æ‰“å°ä¿¡æ¯å½“ä¸­æ­¤æ—¶å­˜åœ¨VALUEå½“ä¸­çš„ä¸€äº›æ•°æ®ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™äº›æ•°æ®å°±ä»£è¡¨ç€hashCodeï¼›</span><br><span class="line">å³ï¼š</span><br><span class="line"><span class="number">01</span> <span class="number">28</span> <span class="number">6</span>e <span class="number">6f</span> (<span class="number">00000001</span> <span class="number">00101000</span> <span class="number">01101110</span> <span class="number">01101111</span>) (<span class="number">1869490177</span>)</span><br><span class="line"><span class="number">6</span>d <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> (<span class="number">01101101</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span>) (<span class="number">109</span>)</span><br><span class="line">é‚£ä¹ˆå¦‚ä½•åˆ¤æ–­ä¸Šè¿°æ˜¯å¦çœŸçš„ä¸ºhashCodeå‘¢ï¼Ÿé‚£ä¹ˆæ¥è¿›è¡Œä¸€ä¸‹éªŒè¯ï¼›</span><br><span class="line">-----------------------------------------------------------</span><br><span class="line">package com.xxx.demo06_object_layout;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.openjdk.jol.info.ClassLayout;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="symbol">Demo01</span>&#123;</span><br><span class="line">  <span class="keyword">public</span> static <span class="built_in">void</span> main(String[] args)&#123;</span><br><span class="line">    LockObj obj = new LockObj();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è°ƒç”¨objå¯¹è±¡çš„hashCode()æ–¹æ³•</span></span><br><span class="line">    obj.hashCode();</span><br><span class="line">    <span class="comment">//è¯¥æ‰“å°çš„ä¸ºåè¿›åˆ¶çš„hashCode</span></span><br><span class="line">    System.<span class="keyword">out</span>.println(obj.hashCode());</span><br><span class="line">    <span class="comment">//æ¢ä¸€ç§æ‰“å°æ–¹å¼ï¼›ä½¿ç”¨Integer.toHexString()å°†åè¿›åˆ¶hashCodeè½¬æ¢æˆåå…­è¿›åˆ¶çš„hashCode</span></span><br><span class="line">    System.<span class="keyword">out</span>.println(Integer.toHexString(obj.hashCode()));</span><br><span class="line"></span><br><span class="line">    <span class="comment">//parseInstance è§£æå®ä¾‹å¯¹è±¡ï¼›</span></span><br><span class="line">    <span class="comment">//toPrintableè¿›è¡Œæ‰“å°å…¶è§£æçš„å®ä¾‹å¯¹è±¡ä¿¡æ¯</span></span><br><span class="line">    ClassLayout.parseInstance(obj).toPrintable().;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">-----------------------------------------------------------</span><br><span class="line">å†æ¬¡è¾“å‡ºç»“æœå¹¶æ‰“å°å¯¹è±¡å¸ƒå±€ï¼š</span><br><span class="line"><span class="number">1836019240</span>    # <span class="number">10</span>è¿›åˆ¶hashCode</span><br><span class="line"><span class="number">6</span>d6f6e28      # <span class="number">16</span>è¿›åˆ¶hashCode</span><br><span class="line">com.xxx.demo06_object_layout.LockObj object <span class="built_in">int</span>ernals:</span><br><span class="line"> OFFSET   SIZE   TYPE  DESCRIPTION         VALUE</span><br><span class="line">      <span class="number">0</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     <span class="number">01</span> <span class="number">28</span> <span class="number">6</span>e <span class="number">6f</span> (<span class="number">00000001</span> <span class="number">00101000</span> <span class="number">01101110</span> <span class="number">01101111</span>) (<span class="number">1869490177</span>)</span><br><span class="line">      <span class="number">4</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     <span class="number">6</span>d <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> (<span class="number">01101101</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span>) (<span class="number">109</span>)</span><br><span class="line">      <span class="number">8</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     <span class="number">43</span> c1 <span class="number">00</span> f8 (<span class="number">01000011</span> <span class="number">11000001</span> <span class="number">00000000</span> <span class="number">11111000</span>) (<span class="number">-134168253</span>)</span><br><span class="line">     <span class="number">12</span>      <span class="number">4</span>    <span class="built_in">int</span>   LockObj.x           <span class="number">0</span></span><br><span class="line">     <span class="number">16</span>      <span class="number">1</span>  <span class="built_in">bool</span>ean LockObj.b           <span class="literal">false</span></span><br><span class="line">     <span class="number">17</span>      <span class="number">7</span>    <span class="built_in">int</span> ï¼ˆloss due to the next object alignmentï¼‰</span><br><span class="line"> Instance size: <span class="number">24</span> bytes</span><br><span class="line"> -----------------------------------------------------------</span><br><span class="line"> åˆ†ææ­¤æ—¶å‘ç°åå…­è¿›åˆ¶ä½çš„hashCodeï¼š<span class="number">6</span>d6f6e28ä¸</span><br><span class="line"> <span class="number">01</span> <span class="number">28</span> <span class="number">6</span>e <span class="number">6f</span> (<span class="number">00000001</span> <span class="number">00101000</span> <span class="number">01101110</span> <span class="number">01101111</span>) (<span class="number">1869490177</span>)</span><br><span class="line"> <span class="number">6</span>d <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> (<span class="number">01101101</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span>) (<span class="number">109</span>)</span><br><span class="line"> å¯¹æ¯”èµ·æ¥æœ‰äº›èŒ«ç„¶ï¼›é¡ºåºä¸ä¸€è‡´ï¼ˆå°½ç®¡å¯¹è±¡å¸ƒå±€çš„å¯¹è±¡å¤´ä¿¡æ¯æ‰“å°ä¸­å‡ºç°äº†è¿™äº›å­—ç¬¦ä¸²ï¼‰ï¼›</span><br><span class="line">è¿™é‡Œéœ€è¦ç¨å¾®æ³¨æ„ä¸€ä¸‹ï¼›æœ‰ä¸€ä¸ªå¤§ç«¯å’Œå°ç«¯çš„é—®é¢˜ï¼›</span><br><span class="line">æ¯”å¦‚è¯´å½“å‰å­˜åœ¨æœ‰<span class="number">64</span>ä½ï¼›</span><br><span class="line"><span class="number">64</span>ä½æœ‰å¤§ç«¯å’Œå°ç«¯çš„åŒºåˆ«ï¼›</span><br><span class="line">ç¬¬ä¸€ç§æƒ…å†µ</span><br><span class="line">    <span class="number">1</span>       <span class="number">2</span>        <span class="number">3</span>        <span class="number">4</span>        <span class="number">5</span>         <span class="number">6</span>        <span class="number">7</span>       <span class="number">8</span></span><br><span class="line"><span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span></span><br><span class="line">ç¬¬äºŒç§æƒ…å†µ</span><br><span class="line">    <span class="number">8</span>       <span class="number">7</span>        <span class="number">6</span>        <span class="number">5</span>        <span class="number">4</span>         <span class="number">3</span>        <span class="number">2</span>       <span class="number">1</span></span><br><span class="line"><span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span></span><br><span class="line">é‚£ä¹ˆåˆšæ‰åœ¨<span class="number">64</span>ä½JVMå½“ä¸­çœ‹åˆ°çš„æ˜¯å±äºå“ªä¸€ç§å‘¢ï¼Ÿ</span><br><span class="line">å³ä¸ºä¸‹é¢ç¬¬äºŒç§æƒ…å†µå½“ä¸­çš„ï¼›ä¹Ÿå°±æ˜¯è¯´<span class="number">64</span>ä½çš„Mark Word</span><br><span class="line">    <span class="number">8</span>       <span class="number">7</span>        <span class="number">6</span>        <span class="number">5</span>        <span class="number">4</span>         <span class="number">3</span>        <span class="number">2</span>       <span class="number">1</span></span><br><span class="line"><span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span></span><br><span class="line">å‰é¢<span class="number">25</span>ä½æ˜¯æ²¡æœ‰è¿›è¡Œä½¿ç”¨çš„ï¼›ä¸­é—´çš„è¯å­˜åœ¨<span class="number">31</span>ä½æ˜¯è¢«ç”¨æ¥è¡¨ç¤ºhashCodeçš„ï¼›</span><br><span class="line">åé¢å€’æ•°ç¬¬ä¸‰ä½è¡¨ç¤ºåå‘é”ï¼›æœ€åä¸¤ä½è¡¨ç¤ºå…¶ä»–é”çš„æ ‡å¿—ä½ï¼›</span><br><span class="line">ä½†æ˜¯javaå½“ä¸­é€šè¿‡jolå·¥å…·è¿›è¡Œæ‰“å°å‡ºæ¥çš„å¯¹è±¡å¸ƒå±€å½“ä¸­çš„hashCodeä¿¡æ¯æ˜¯åè¿‡æ¥çš„ï¼›</span><br><span class="line">å³æ‰€ä»¥éœ€è¦åè¿‡æ¥è¿›è¡ŒæŸ¥çœ‹ï¼›å³</span><br><span class="line"> <span class="number">01</span> <span class="number">28</span> <span class="number">6</span>e <span class="number">6f</span> (<span class="number">00000001</span> <span class="number">00101000</span> <span class="number">01101110</span> <span class="number">01101111</span>) (<span class="number">1869490177</span>)</span><br><span class="line"> <span class="number">6</span>d <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> (<span class="number">01101101</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span>) (<span class="number">109</span>)</span><br><span class="line"> éœ€è¦åè¿‡æ¥çœ‹å³</span><br><span class="line"> ï¼ˆå¿½ç•¥å‰é¢çš„<span class="number">00</span> <span class="number">00</span> <span class="number">00</span>å‰é¢çš„è¿™<span class="number">25</span>ä½ï¼›ä¸­é—´çš„<span class="number">6</span>d <span class="number">6f</span> <span class="number">6</span>e <span class="number">28</span>è¿™<span class="number">31</span>ä½æ‰æ˜¯ç”¨æ¥è¡¨ç¤ºhashCodeçš„ï¼›ï¼‰ï¼š</span><br><span class="line"> <span class="number">01</span> <span class="number">28</span> <span class="number">6</span>e <span class="number">6f</span> (<span class="number">00000001</span> <span class="number">00101000</span> <span class="number">01101110</span> <span class="number">01101111</span>) (<span class="number">1869490177</span>)</span><br><span class="line"> <span class="number">6</span>d <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> (<span class="number">01101101</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span>) (<span class="number">109</span>)</span><br><span class="line">å³hashCodeä¸º<span class="number">6</span>d <span class="number">6f</span> <span class="number">6</span>e <span class="number">28</span>(<span class="number">01101101</span> <span class="number">01101111</span> <span class="number">01101110</span> <span class="number">00101000</span>)</span><br><span class="line">è‡³æ­¤ä¹Ÿæ˜¯ä½¿ç”¨äº†javaå·¥å…·æ¥è¿›è¡ŒéªŒè¯äº†å¯¹è±¡çš„å¸ƒå±€ï¼›</span><br></pre></td></tr></table></figure><table>  <tr>    <td rowspan="2">é”çŠ¶æ€</td>    <td>25bit</td>    <td>31bit</td>    <td>1bit</td>    <td>4bit</td>    <td>1bit</td>    <td>2bit</td>  </tr>  <tr>    <td> </td>    <td> </td>    <td>cms_free</td>    <td>åˆ†ä»£å¹´é¾„</td>    <td>åå‘é”</td>    <td>é”æ ‡å¿—ä½</td>  </tr>  <tr>    <td>æ— é”</td>    <td>unusedï¼ˆæ²¡æœ‰ä½¿ç”¨ï¼‰</td>    <td>hashCode</td>    <td></td>    <td></td>    <td>0ï¼ˆæ˜¯å¦æ˜¯åå‘é”ï¼›0è¡¨ç¤ºéåå‘é”ï¼›1è¡¨ç¤ºæ˜¯åå‘é”ï¼‰</td>    <td>01ï¼ˆé”çš„æ ‡å¿—ä½ï¼›01ä»£è¡¨æ— é”ï¼›00ä»£è¡¨è½»é‡çº§é”ï¼›10ä»£è¡¨é‡é‡çº§é”ï¼‰</td>  </tr>    <tr>    <td>åå‘é”</td>    <td colspan="2">ThreadId(54bit)Epoch(2bit)</td>    <td></td>    <td></td>    <td>1</td>    <td>01</td>  </tr>  <tr>    <td>è½»é‡çº§é”</td>    <td colspan="5">æŒ‡å‘æ ˆä¸­é”è®°å½•çš„æŒ‡é’ˆ</td>    <td>00</td>  </tr>  <tr>    <td>é‡é‡çº§é”</td>    <td colspan="5">æŒ‡å‘äº’æ–¥é‡ï¼ˆé‡é‡çº§é”ï¼‰çš„æŒ‡é’ˆ</td>    <td>10</td>  </tr></table><h3 id="å°ç»“-14"><a href="#å°ç»“-14" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>javaå¯¹è±¡ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼šå¯¹è±¡å¤´ã€å®ä¾‹æ•°æ®ã€å¯¹é½æ•°æ®ï¼›<br>å¯¹è±¡å¤´åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šMark Word + Klass pointerï¼›</p><h2 id="synchronizedä¼˜åŒ–-åå‘é”"><a href="#synchronizedä¼˜åŒ–-åå‘é”" class="headerlink" title="synchronizedä¼˜åŒ–-åå‘é”"></a>synchronizedä¼˜åŒ–-åå‘é”</h2><h3 id="é”å‡çº§è¿‡ç¨‹"><a href="#é”å‡çº§è¿‡ç¨‹" class="headerlink" title="é”å‡çº§è¿‡ç¨‹"></a>é”å‡çº§è¿‡ç¨‹</h3><p>é«˜æ•ˆå¹¶å‘æ˜¯ä»JDK1.5åˆ°JDK1.6çš„ä¸€ä¸ªé‡è¦æ”¹è¿›ã€‚<br>HotSpotè™šæ‹Ÿæœºå¼€å‘å›¢é˜Ÿåœ¨è¿™ä¸ªç‰ˆæœ¬ä¸ŠèŠ±è´¹äº†å¤§é‡çš„ç²¾åŠ›è¶‹å®ç°å„ç§é”ä¼˜åŒ–æŠ€æœ¯ï¼Œ<br>å¦‚é€‚åº”æ€§è‡ªæ—‹ï¼ˆAdaptive Spinningï¼‰ã€é”æ¶ˆé™¤ï¼ˆLock Eliminationï¼‰ã€é”ç²—åŒ–ï¼ˆLock Coarseningï¼‰ã€è½»é‡çº§é”ï¼ˆLightweight Lockingï¼‰å’Œåå‘é”ï¼ˆBiased Lockingï¼‰ç­‰ï¼Œ<br>è¿™äº›æŠ€æœ¯éƒ½æ˜¯ä¸ºäº† åœ¨çº¿ç¨‹ä¹‹é—´æ›´é«˜æ•ˆåœ°å…±äº«æ•°æ®ï¼Œä»¥åŠè§£å†³ç«äº‰é—®é¢˜ï¼Œä»è€Œæé«˜ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ã€‚</p><p>æ— é”â€“â†’åå‘é”â€“â†’è½»é‡çº§é”â€“â†’é‡é‡çº§é”</p><p>æ— é”å¹¶ä¸ä¼šç›´æ¥è¿›å…¥åˆ°é‡é‡çº§é”å½“ä¸­å»ï¼›è€Œæ˜¯å…ˆè¿›å…¥åå‘é”ï¼›</p><p>åå‘é”</p><h3 id="ç›®æ ‡-18"><a href="#ç›®æ ‡-18" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>å­¦ä¹ åå‘é”çš„åŸç†å’Œå¥½å¤„</p><h3 id="ä»€ä¹ˆæ˜¯åå‘é”"><a href="#ä»€ä¹ˆæ˜¯åå‘é”" class="headerlink" title="ä»€ä¹ˆæ˜¯åå‘é”"></a>ä»€ä¹ˆæ˜¯åå‘é”</h3><p>åå‘é”æ˜¯JDK6ä¸­çš„é‡è¦å¼•è¿›ï¼Œå› ä¸ºHotSpotä½œè€…ç»è¿‡ç ”ç©¶å®è·µå‘ç°ï¼Œ<br>ï¼ˆä»£ç ï¼‰åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œé”ä¸ä»…ä¸å­˜åœ¨å¤šçº¿ç¨‹ç«äº‰è€Œä¸”æ€»æ˜¯ç”±åŒä¸€çº¿ç¨‹å¤šæ¬¡è·å¾—ï¼ˆå³ç”±åŒä¸€ä¸ªçº¿ç¨‹åå¤çš„å¾—åˆ°é”é‡Šæ”¾é”å¾—åˆ°é”é‡Šæ”¾é”ï¼›å¦‚æœä¸€ä¸Šæ¥å°±æ˜¯é‡é‡çº§é”çš„è¯é‚£ä¹ˆå¾—åˆ°é”å°±éœ€è¦èŠ±è´¹æ€§èƒ½é‡Šæ”¾é”ä¹Ÿéœ€è¦èŠ±è´¹æ€§èƒ½ï¼‰ï¼Œä¸ºäº†è®©çº¿ç¨‹è·å¾—é”çš„ä»£ä»·æ›´ä½ï¼Œå¼•è¿›äº†åå‘é”ã€‚<br>å‡å°‘ä¸å¿…è¦çš„CASæ“ä½œã€‚</p><p>åå‘é”çš„â€œåâ€ï¼Œå°±æ˜¯åå¿ƒçš„â€œåâ€ã€åè¢’çš„â€œåâ€ï¼Œå®ƒçš„æ„æ€æ˜¯è¿™ä¸ªé”ä¼šåå‘äºç¬¬ä¸€ä¸ªè·å¾—å®ƒçš„çº¿ç¨‹ï¼Œä¼šåœ¨å¯¹è±¡å¤´å­˜å‚¨é”åå‘çš„çº¿ç¨‹IDï¼Œä»¥åè¯¥çº¿ç¨‹è¿›å…¥å’Œé€€å‡ºåŒæ­¥å—æ—¶åªéœ€è¦æ£€æŸ¥æ˜¯å¦ä¸ºåå‘é”ã€é”æ ‡å¿—ä½ä»¥åŠThreadIDå³å¯ã€‚</p><p>ä¸è¿‡ä¸€æ—¦å‡ºç°å¤šä¸ªçº¿ç¨‹ç«äº‰æ—¶ï¼Œå¿…é¡»æ’¤é”€åå‘é”ï¼Œ<br>æ‰€ä»¥æ’¤é”€åå‘é”æ¶ˆè€—çš„æ€§èƒ½å¿…é¡»å°äºä¹‹å‰èŠ‚çœä¸‹æ¥çš„CASåŸå­æ“ä½œçš„æ€§èƒ½æ¶ˆè€—ï¼Œ<br>ä¸ç„¶å°±å¾—ä¸å¿å¤±äº†ã€‚</p><p>å¦‚æœæ˜¯åå‘é”åˆ™å€’æ•°ç¬¬ä¸‰ä¸ªå­—èŠ‚ä¼šå˜æˆ1ï¼›å¦å¤–ç”±å‰é¢56ä¸ªå­—èŠ‚å½“ä¸­çš„å‰54ä¸ªå­—èŠ‚ä¼šæ¥ä¿å­˜åå‘é”çš„idï¼›å¦å¤–56ä¸ªå­—èŠ‚å½“ä¸­å…¶ä½™ä¸¤ä¸ªå­—èŠ‚ç”¨æ¥ä¿è¯Epochå³æ—¶é—´ï¼›</p><table>  <tr>    <td rowspan="2">é”çŠ¶æ€</td>    <td>25bit</td>    <td>31bit</td>    <td>1bit</td>    <td>4bit</td>    <td>1bit</td>    <td>2bit</td>  </tr>  <tr>    <td> </td>    <td> </td>    <td>cms_free</td>    <td>åˆ†ä»£å¹´é¾„</td>    <td>åå‘é”</td>    <td>é”æ ‡å¿—ä½</td>  </tr>  <tr>    <td>æ— é”</td>    <td>unusedï¼ˆæ²¡æœ‰ä½¿ç”¨ï¼‰</td>    <td>hashCode</td>    <td></td>    <td></td>    <td>0ï¼ˆæ˜¯å¦æ˜¯åå‘é”ï¼›0è¡¨ç¤ºéåå‘é”ï¼›1è¡¨ç¤ºæ˜¯åå‘é”ï¼‰</td>    <td>01ï¼ˆé”çš„æ ‡å¿—ä½ï¼›01ä»£è¡¨æ— é”ï¼›00ä»£è¡¨è½»é‡çº§é”ï¼›10ä»£è¡¨é‡é‡çº§é”ï¼‰</td>  </tr>    <tr>    <td>åå‘é”</td>    <td colspan="2">ThreadId(54bit)Epoch(2bit)</td>    <td></td>    <td></td>    <td>1</td>    <td>01</td>  </tr>  <tr>    <td>è½»é‡çº§é”</td>    <td colspan="5">æŒ‡å‘æ ˆä¸­é”è®°å½•çš„æŒ‡é’ˆ</td>    <td>00</td>  </tr>  <tr>    <td>é‡é‡çº§é”</td>    <td colspan="5">æŒ‡å‘äº’æ–¥é‡ï¼ˆé‡é‡çº§é”ï¼‰çš„æŒ‡é’ˆ</td>    <td>10</td>  </tr></table><p>ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯è¿™ä¸ªåå‘é”ä»…é™ç”¨äºæ²¡æœ‰ç«äº‰çš„çŠ¶æ€ï¼›<br>ä¹Ÿå°±æ˜¯è¯´åå¤æ˜¯åŒä¸€ä¸ªçº¿ç¨‹è·å¾—é”é‡Šæ”¾é”ï¼›</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xxx.demo07_biased_lock;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.openjdk.jol.info.ClassLayout;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo01</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    MyThread mt = <span class="keyword">new</span> MyThread();</span><br><span class="line">    mt.start();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">  <span class="keyword">static</span> Object obj = <span class="keyword">new</span> Object();</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)&#123;</span><br><span class="line">      <span class="keyword">synchronized</span>(obj)&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        System.out.println(ClassLayout.parseInstance(obj).toPrintable());</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å¾ªç¯5æ¬¡å¹¶ä¸”è¿›å‡ºåŒæ­¥ä»£ç å—å°±åªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼›</span></span><br><span class="line"><span class="comment">// é‚£ä¹ˆè¿™ç§æƒ…å†µå°±é€‚åˆä½¿ç”¨åå‘é”ï¼›</span></span><br><span class="line"><span class="comment">// å³åå¤æ˜¯åŒä¸€ä¸ªçº¿ç¨‹è¿›å…¥åŒæ­¥ä»£ç å—çš„æƒ…å†µï¼›</span></span><br><span class="line"><span class="comment">// ä½†æ˜¯å¦‚æœé‡åˆ°æœ‰çº¿ç¨‹æ¥è¿›è¡Œç«äº‰é‚£ä¹ˆå³ç«‹å³è¦æ’¤é”€æ‰åå‘é”ä»è€Œå‡çº§åˆ°è½»é‡çº§é”ï¼›</span></span><br></pre></td></tr></table></figure><h3 id="åå‘é”åŸç†"><a href="#åå‘é”åŸç†" class="headerlink" title="åå‘é”åŸç†"></a>åå‘é”åŸç†</h3><p>å½“çº¿ç¨‹ç¬¬ä¸€æ¬¡è®¿é—®åŒæ­¥ä»£ç å—å¹¶è·å–é”æ—¶ï¼Œåå‘é”å¤„ç†æµç¨‹å¦‚ä¸‹ï¼š</p><blockquote><ol><li>æ£€æµ‹Mark Wordæ˜¯å¦ä¸º å¯åå‘çŠ¶æ€ï¼Œå³æ˜¯å¦ä¸ºåå‘é”1ï¼Œé”æ ‡è¯†ä¸ºä¸º01ã€‚</li><li>è‹¥ä¸º å¯åå‘çŠ¶æ€ï¼Œåˆ™æµ‹è¯•çº¿ç¨‹IDæ˜¯å¦ä¸ºå½“å‰çº¿ç¨‹IDï¼Œå¦‚æœæ˜¯ï¼Œæ‰§è¡ŒåŒæ­¥ä»£ç å—ï¼Œå¦åˆ™æ‰§è¡Œæ­¥éª¤ï¼ˆ3ï¼‰</li><li>å¦‚æœæµ‹è¯•çº¿ç¨‹IDä¸ä¸ºå½“å‰çº¿ç¨‹IDï¼Œåˆ™é€šè¿‡CASæ“ä½œå°†Mark Wordçš„çº¿ç¨‹IDæ›¿æ¢ä¸ºå½“å‰çº¿ç¨‹ï¼Œæ‰§è¡ŒåŒæ­¥ä»£ç å—</li></ol></blockquote><blockquote><ol><li>è™šæ‹Ÿæœºå°†ä¼šæŠŠå¯¹è±¡å¤´ä¸­çš„æ ‡å¿—ä½è®¾ä¸ºâ€œ01â€ï¼Œå³åå‘æ¨¡å¼</li><li>åŒæ—¶ä½¿ç”¨ CASæ“ä½œ æŠŠè·å–åˆ°è¿™ä¸ªé”çš„çº¿ç¨‹çš„IDè®°å½•åœ¨å¯¹è±¡çš„Mark Wordä¹‹ä¸­ï¼Œå¦‚æœCASæ“ä½œæˆåŠŸï¼ŒæŒæœ‰åå‘é”çš„çº¿ç¨‹ä»¥åæ¯æ¬¡è¿›å…¥è¿™ä¸ªé”ç›¸å…³çš„åŒæ­¥ä»£ç å—æ—¶ï¼Œè™šæ‹Ÿæœºéƒ½å¯ä»¥ä¸å†è¿›è¡Œä»»ä½•åŒæ­¥æ“ä½œï¼Œåå‘é”çš„æ•ˆç‡é«˜ã€‚</li></ol></blockquote><p>é¦–å…ˆè™šæ‹Ÿæœºä¼šè¿›è¡Œæ£€æŸ¥è¿™ä¸ªåå‘é”çš„çŠ¶æ€å³å€’æ•°ç¬¬ä¸‰ä½å–å€¼æ˜¯å¦ä¸º0ï¼›<br>æ˜¯0çš„è¯é‚£ä¹ˆä¹Ÿå°±ä»£è¡¨ç€å¯ä»¥è¿›è¡Œåå‘ï¼Œå°†å€’æ•°ç¬¬ä¸‰ä½ä¿®æ”¹æˆ1è¡¨ç¤ºåå‘é”ï¼›é‚£ä¹ˆè™šæ‹Ÿæœºä¹Ÿå°±ä¼šå°†å…¶å€’æ•°ä¸¤ä½æ•°æ”¹æˆ01ï¼›å³å˜æˆåå‘é”ï¼›<br>é‚£ä¹ˆè¿˜ä¼šé€šè¿‡CASæ“ä½œå°†å¯¹è±¡çš„Mark Wordå½“ä¸­çš„å‰54ä½ä¿®æ”¹ä¸ºå½“å‰è·å–å¾—åˆ°åå‘é”çš„çº¿ç¨‹çš„Thread IDï¼›é‚£ä¹ˆåˆ°æ­¤æ—¶è¿™ä¸ªåå‘é”å°±è®¾ç½®æˆåŠŸäº†ï¼›<br>é‚£ä¹ˆä»¥åçš„è¯çº¿ç¨‹é€€å‡ºåŒæ­¥ä»£ç å—çš„æ—¶å€™å¹¶ä¸éœ€è¦åšä»»ä½•æ“ä½œè€Œä¸‹ä¸€æ¬¡å¾ªç¯å½“ä¸­é‡æ–°è¿›å…¥åŒæ­¥ä»£ç å—æ—¶ï¼Œåªéœ€è¦è¿›è¡Œåˆ¤å®šä¸€ä¸‹THREAD IDå³Mark Wordå½“ä¸­çš„å‰54ä½å½“ä¸­çš„å–å€¼å³THREAD IDä¸å½“å‰è¯¥è¦è·å–é”çš„çº¿ç¨‹çš„THREAD IDæ˜¯å¦ç›¸åŒï¼›<br>å¦‚æœæ˜¯ä¸€æ ·çš„è¯é‚£ä¹ˆåˆ™è¿›å…¥åŒæ­¥ä»£ç å—å½“ä¸­ï¼›æ— éœ€å…¶ä»–æ“ä½œï¼›<br>æ‰€ä»¥åå‘é”å®ƒåœ¨ä¸€ä¸ªçº¿ç¨‹çš„æƒ…å†µä¸‹å…¶æ•ˆç‡è¿˜æ˜¯å¾ˆé«˜çš„ï¼›</p><table>  <tr>    <td rowspan="2">é”çŠ¶æ€</td>    <td>25bit</td>    <td>31bit</td>    <td>1bit</td>    <td>4bit</td>    <td>1bit</td>    <td>2bit</td>  </tr>  <tr>    <td> </td>    <td> </td>    <td>cms_free</td>    <td>åˆ†ä»£å¹´é¾„</td>    <td>åå‘é”</td>    <td>é”æ ‡å¿—ä½</td>  </tr>  <tr>    <td>æ— é”</td>    <td>unusedï¼ˆæ²¡æœ‰ä½¿ç”¨ï¼‰</td>    <td>hashCode</td>    <td></td>    <td></td>    <td>0ï¼ˆæ˜¯å¦æ˜¯åå‘é”ï¼›0è¡¨ç¤ºéåå‘é”ï¼›1è¡¨ç¤ºæ˜¯åå‘é”ï¼‰</td>    <td>01ï¼ˆé”çš„æ ‡å¿—ä½ï¼›01ä»£è¡¨æ— é”ï¼›00ä»£è¡¨è½»é‡çº§é”ï¼›10ä»£è¡¨é‡é‡çº§é”ï¼‰</td>  </tr>    <tr>    <td>åå‘é”</td>    <td colspan="2">ThreadId(54bit)Epoch(2bit)</td>    <td></td>    <td></td>    <td>1</td>    <td>01</td>  </tr>  <tr>    <td>è½»é‡çº§é”</td>    <td colspan="5">æŒ‡å‘æ ˆä¸­é”è®°å½•çš„æŒ‡é’ˆ</td>    <td>00</td>  </tr>  <tr>    <td>é‡é‡çº§é”</td>    <td colspan="5">æŒ‡å‘äº’æ–¥é‡ï¼ˆé‡é‡çº§é”ï¼‰çš„æŒ‡é’ˆ</td>    <td>10</td>  </tr></table><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">package com.xxx.demo07_biased_lock;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.openjdk.jol.info.ClassLayout;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="symbol">Demo01</span>&#123;</span><br><span class="line">  <span class="keyword">public</span> static <span class="built_in">void</span> main(String[] args)&#123;</span><br><span class="line">    MyThread mt = new MyThread();</span><br><span class="line">    mt.start();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="symbol">MyThread</span> <span class="symbol">extends</span> <span class="symbol">Thread</span>&#123;</span><br><span class="line">  static Object obj = new Object();</span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line">  <span class="keyword">public</span> <span class="built_in">void</span> run()&#123;</span><br><span class="line">    <span class="keyword">for</span>( <span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)&#123;</span><br><span class="line">      synchronized(obj)&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        System.<span class="keyword">out</span>.println(ClassLayout.parseInstance(obj).toPrintable());</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">çº¿ç¨‹è¿›è¿‡5æ¬¡å¾ªç¯æ¯ä¸€æ¬¡å¾ªç¯éƒ½è¿›å…¥åˆ°åŒæ­¥ä»£ç å—å½“ä¸­ï¼›</span></span><br><span class="line"><span class="comment">å¯¹è±¡é”ä¸ºobjï¼›æ­¤æ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹æŒ‰é“ç†åº”è¯¥æ˜¯ä½¿ç”¨çš„åå‘é”ï¼›</span></span><br><span class="line"><span class="comment">å¦å¤–åœ¨åŒæ­¥ä»£ç å—å½“ä¸­è¿›è¡Œæ‰“å°çš„å¯¹è±¡çš„å¯¹è±¡å¸ƒå±€ä¿¡æ¯ï¼›ä»¥æ­¤ç”¨æ¥æ£€æŸ¥æ˜¯å¦å­˜åœ¨åå‘é”çš„æ ‡è®°ï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">------------------------------------------------------------</span><br><span class="line">æ‰“å°ç»“æœï¼š</span><br><span class="line">com.lang.Object object <span class="built_in">int</span>ernals:</span><br><span class="line"> OFFSET   SIZE   TYPE  DESCRIPTION         VALUE</span><br><span class="line">      <span class="number">0</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     d8 ed <span class="number">44</span> <span class="number">29</span> (<span class="number">11011000</span> <span class="number">11101101</span> <span class="number">01000100</span> <span class="number">00101001</span>) (<span class="number">692383192</span>)</span><br><span class="line">      <span class="number">4</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> (<span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span>) (<span class="number">0</span>)</span><br><span class="line">      <span class="number">8</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     e5 <span class="number">01</span> <span class="number">00</span> f8 (<span class="number">11100101</span> <span class="number">00000001</span> <span class="number">00000000</span> <span class="number">11111000</span>) (<span class="number">-134217243</span>)</span><br><span class="line">     <span class="number">12</span>      <span class="number">4</span>    <span class="built_in">int</span>   LockObj.x           <span class="number">0</span></span><br><span class="line"> Instance size: <span class="number">16</span> bytes</span><br><span class="line"> Space losses: <span class="number">0</span> bytes <span class="built_in">int</span>ernal + <span class="number">4</span> bytes <span class="keyword">external</span> = <span class="number">4</span> bytes total</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">åˆ†æï¼š</span><br><span class="line"><span class="number">0</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     d8 ed <span class="number">44</span> <span class="number">29</span> (<span class="number">11011000</span> <span class="number">11101101</span> <span class="number">01000100</span> <span class="number">00101001</span>) (<span class="number">692383192</span>)</span><br><span class="line">å½“ä¸­çš„</span><br><span class="line">d8 ed <span class="number">44</span> <span class="number">29</span> (<span class="number">11011000</span> <span class="number">11101101</span> <span class="number">01000100</span> <span class="number">00101001</span>) (<span class="number">692383192</span>)</span><br><span class="line">å½“ä¸­çš„</span><br><span class="line">d8 <span class="number">11011000</span> å³æœ€ç»ˆçš„ç¬¬<span class="number">8</span>ä¸ªå­—èŠ‚å³</span><br><span class="line">    <span class="number">8</span>       <span class="number">7</span>        <span class="number">6</span>        <span class="number">5</span>        <span class="number">4</span>         <span class="number">3</span>        <span class="number">2</span>       <span class="number">1</span></span><br><span class="line"><span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span></span><br><span class="line">å…¶å®å°±æ˜¯</span><br><span class="line">    <span class="number">1</span></span><br><span class="line"><span class="number">00000000</span></span><br><span class="line">æ˜¾ç¤ºåˆ°å‰é¢å»äº†å³</span><br><span class="line">    <span class="number">1</span>       <span class="number">2</span>        <span class="number">3</span>        <span class="number">4</span>        <span class="number">5</span>         <span class="number">6</span>        <span class="number">7</span>       <span class="number">8</span></span><br><span class="line"><span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span></span><br><span class="line">è¿™ä¸ªæ ·å­ï¼›</span><br><span class="line">å³d8 <span class="number">11011000</span>ä»£è¡¨çš„å°±æ˜¯æ˜¯å¦æ˜¯åå‘é”ï¼Œå³é”çš„æ ‡å¿—ä½ï¼›</span><br><span class="line">é‚£ä¹ˆd8å…¶<span class="number">8</span>ä½å½“ä¸­çš„æœ€åä¸‰ä½å³<span class="number">000</span>ï¼›é‚£ä¹ˆ<span class="number">000</span>æ˜¯å±äºåå‘é”å—ï¼›ä¸æ˜¯ï¼›</span><br><span class="line">é‚£ä¹ˆä¸ºä»€ä¹ˆä¸æ˜¯åå‘é”å‘¢ï¼ŸåŸå› åœ¨äºï¼šåå‘é”è™½ç„¶åœ¨jdk1<span class="number">.6</span>çš„æ—¶å€™åå‘é”æ˜¯å¼€å¯çš„ï¼›</span><br><span class="line">ä½†æ˜¯è¿™ä¸ªé»˜è®¤å¼€å¯çš„åå‘é”å¹¶ä¸æ˜¯ç«‹é©¬å¯ä»¥è¿›è¡Œä½¿ç”¨çš„ï¼›</span><br><span class="line">æ‰€ä»¥è¿™ä¸ªæ—¶å€™åˆéœ€è¦æ·»åŠ ä¸€ä¸ªJVMå‚æ•°å³åœ¨VM optionså¤„å¡«å…¥å‚æ•°ï¼š-XX:BiasedLockingStartupDelay=<span class="number">0</span>ï¼›</span><br><span class="line">è®©å…¶åŸå§‹å€¼ä¸º<span class="number">0</span>å³ç¨‹åºä¸€å¯åŠ¨é‚£ä¹ˆåå‘é”å°±ç”Ÿæ•ˆï¼›</span><br><span class="line">é‚£ä¹ˆå†æ¬¡è¿è¡Œå°è¯•ï¼š</span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line">å†æ¬¡è¿è¡Œæ‰“å°ç»“æœï¼š</span><br><span class="line">com.lang.Object object <span class="built_in">int</span>ernals:</span><br><span class="line"> OFFSET   SIZE   TYPE  DESCRIPTION         VALUE</span><br><span class="line">      <span class="number">0</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     <span class="number">05</span> <span class="number">90</span> <span class="number">61</span> <span class="number">27</span> (<span class="number">00000101</span> <span class="number">10010000</span> <span class="number">01100001</span> <span class="number">00100111</span>) (<span class="number">660705285</span>)</span><br><span class="line">      <span class="number">4</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> (<span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span>) (<span class="number">0</span>)</span><br><span class="line">      <span class="number">8</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     e5 <span class="number">01</span> <span class="number">00</span> f8 (<span class="number">11100101</span> <span class="number">00000001</span> <span class="number">00000000</span> <span class="number">11111000</span>) (<span class="number">-134217243</span>)</span><br><span class="line">     <span class="number">12</span>      <span class="number">4</span>    <span class="built_in">int</span>   LockObj.x           <span class="number">0</span></span><br><span class="line"> Instance size: <span class="number">16</span> bytes</span><br><span class="line"> Space losses: <span class="number">0</span> bytes <span class="built_in">int</span>ernal + <span class="number">4</span> bytes <span class="keyword">external</span> = <span class="number">4</span> bytes total</span><br><span class="line">-----------------------------------------------------------------</span><br><span class="line">åˆ†æï¼š</span><br><span class="line">ç¨‹åºé¦–å…ˆç”±ä¸»çº¿ç¨‹ä»mainæ–¹æ³•å¼€å§‹è¿›è¡Œæ‰§è¡Œå¹¶åœ¨mainæ–¹æ³•å½“ä¸­åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹å«åšmtå¹¶å¯åŠ¨å®ƒï¼›ç”¨t1è¡¨ç¤ºæ–°çº¿ç¨‹mtï¼›</span><br><span class="line">é‚£ä¹ˆæ–°çº¿ç¨‹t1å°±ä¼šæ‰§è¡Œåˆ°runæ–¹æ³•å½“ä¸­å»è¿›è¡Œ<span class="number">5</span>æ¬¡å¾ªç¯å¹¶åœ¨æ¯æ¬¡å¾ªç¯å½“ä¸­è¿›å…¥åŒæ­¥ä»£ç å—ä¸”æ‰“å°å…¶å¯¹è±¡å¸ƒå±€ä¸­å¯¹è±¡å¤´ç­‰å¯¹è±¡å¸ƒå±€ä¿¡æ¯ï¼›</span><br><span class="line">æ­¤æ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ²¡æœ‰å…¶ä»–çº¿ç¨‹æ¥è¿›è¡Œç«äº‰æ“ä½œï¼›</span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶t1ç¬¬ä¸€æ¬¡æ¥è¿›è¡Œæ‰§è¡ŒåŒæ­¥ä»£ç å—synchronizedçš„æ—¶å€™å°±ä¼šå»çœ‹è¿™ä¸ªå¯¹è±¡å¤´objå½“ä¸­å®ƒçš„é”æ ‡è®°æ˜¯ä»€ä¹ˆï¼›</span><br><span class="line">é‚£ä¹ˆä¸€å¼€å§‹çš„æ—¶å€™è¯¥å¯¹è±¡å¤´æ˜¯å±äºæ— é”çŠ¶æ€å³å€’æ•°ç¬¬äºŒä½ä¸º<span class="number">0</span>ï¼ˆè¡¨ç¤ºä¸ä¸ºåå‘é”çŠ¶æ€ï¼›å³æ— é”çŠ¶æ€ï¼‰ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ç”±äºè¦å°†æ— é”çŠ¶æ€æ”¹ä¸ºåå‘é”çŠ¶æ€é‚£ä¹ˆæ­¤æ—¶å°±ä¼šå°†å€’æ•°ç¬¬ä¸‰ä½æ”¹æˆ<span class="number">1</span>ï¼ˆå³åå‘é”çŠ¶æ€ï¼›è¡¨ç¤ºè½¬æˆåå‘é”çŠ¶æ€ï¼‰ï¼›</span><br><span class="line">å¦å¤–å‰<span class="number">56</span>ä½å½“ä¸­çš„å‰<span class="number">54</span>ä½ä¼šè¢«ç”¨æ¥ä¿å­˜è¿™ä¸ªåå‘é”çš„idï¼›ä»¥åŠå‰<span class="number">56</span>ä½å½“ä¸­çš„åä¸¤ä½ç”¨æ¥è¿›è¡Œä¿å­˜Epochå³ç›¸å…³æ—¶é—´ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±è®©t1çº¿ç¨‹è¿›å…¥äº†åŒæ­¥ä»£ç å—å½“ä¸­ï¼ˆå…¶å®ä¹Ÿå°±è¡¨ç¤ºè®¾ç½®å¥½äº†åå‘é”ï¼Œè¦è¿›å…¥åŒæ­¥ä»£ç å—å½“ä¸­è¿›è¡Œæ‰§è¡Œï¼›ç„¶åè¿›è¡Œæ‰“å°å¯¹è±¡å¸ƒå±€ä¿¡æ¯ä¸­å³<span class="number">101</span>ï¼›</span><br><span class="line">ä¹Ÿå°±æ˜¯<span class="number">0</span>      <span class="number">4</span>        ï¼ˆobject headerï¼‰     <span class="number">05</span> <span class="number">90</span> <span class="number">61</span> <span class="number">27</span> (<span class="number">00000101</span> <span class="number">10010000</span> <span class="number">01100001</span> <span class="number">00100111</span>) (<span class="number">660705285</span>)ä¸­çš„<span class="number">05</span> <span class="number">00000101</span>å…¶<span class="number">8</span>ä½çš„å€’æ•°ä¸‰ä½<span class="number">101</span>ï¼›ä¹Ÿå°±è¡¨ç¤ºè½¬å˜æˆäº†åå‘é”çŠ¶æ€ï¼‰ï¼›</span><br><span class="line">å½“æ‰§è¡Œå®Œæˆæ‰“å°å¯¹è±¡å¸ƒå±€ä¿¡æ¯å³ä¹Ÿå°±æ˜¯å®ŒæˆåŒæ­¥ä»£ç å—ä¸­çš„ä»»åŠ¡è¦å‡ºåŒæ­¥ä»£ç å—æ—¶ï¼Œé€€å‡ºåŒæ­¥ä»£ç å—æ—¶è¿™ä¸ªåå‘é”å°±å¹¶ä¸ç”¨åšä»€ä¹ˆäº‹æƒ…ï¼›</span><br><span class="line">é‚£ä¹ˆå½“ä¸‹ä¸€æ¬¡å¾ªç¯æ—¶ï¼ˆæ€»å…±æœ‰<span class="number">5</span>æ¬¡å¾ªç¯ï¼‰ï¼Œè¯¥çº¿ç¨‹t1åˆè¦ä»åŒæ­¥ä»£ç å—å½“ä¸­æ¥è¿›è¡Œè·å–é”ï¼›</span><br><span class="line">å®ƒå°±ä¼šå‘ç°å¯¹è±¡é”objå½“ä¸­å³ä¸ºä¸€ä¸ªåå‘é”çš„çŠ¶æ€ï¼›</span><br><span class="line">å¹¶ä¸”åªè¦å»è¿›è¡Œå¯¹æ¯”ä¸€ä¸‹è¿™ä¸ªçº¿ç¨‹Idå³å‰<span class="number">56</span>ä½å½“ä¸­çš„<span class="number">54</span>ä½çš„å€¼æ˜¯å¦å–å€¼ç›¸ç­‰å³THREAD idæ˜¯å¦ä¸å½“å‰è¿™ä¸ªè¦è·å–é”çš„çº¿ç¨‹çš„THREAD idç›¸åŒï¼›</span><br><span class="line">å¦‚æœæ˜¯ï¼Œé‚£ä¹ˆå°±ç›´æ¥è¿›å…¥åˆ°åŒæ­¥ä»£ç å—å½“ä¸­ï¼›</span><br><span class="line">å³æœ‰äº†åå‘é”ä¹‹åï¼Œé‚£ä¹ˆåé¢çš„å¾ªç¯ä¸­å½“å‰è¯¥çº¿ç¨‹å†æ¬¡å»è·å–é”å°±å˜å¾—å¾ˆç®€å•äº†åªéœ€è¦ï¼ˆå¯¹æ¯”ä¸€ä¸‹THREAD IDæ˜¯å¦ä¸€è‡´å³å¯ï¼‰ä¸¤ä¸ªåŠ¨ä½œ</span><br><span class="line">ï¼ˆ<span class="number">1</span>: æ£€æŸ¥å€’æ•°ç¬¬ä¸‰ä½æ˜¯å¦æ˜¯åå‘é”æ ‡å¿—ï¼Œå¦‚æœæ˜¯åˆ™æ‰§è¡Œç¬¬äºŒä¸ªåŠ¨ä½œï¼›å¦‚æœä¸æ˜¯åˆ™å°†å€’æ•°ç¬¬ä¸‰ä½çš„æ•°å€¼æ”¹ä¸º<span class="number">1</span>å³è¡¨ç¤ºåå‘é”ï¼›<span class="number">2</span>: é¦–å…ˆæ£€æŸ¥å‰<span class="number">56</span>ä½å½“ä¸­çš„å‰<span class="number">54</span>ä½çš„THREAD IDæ˜¯å¦æœ‰å–å€¼ï¼›å¦‚æœæ²¡æœ‰å–å€¼åˆ™è®¾ç½®ä¸ºå½“å‰çš„è¯¥çº¿ç¨‹IDï¼›å¦‚æœå­˜åœ¨å–å€¼THREAD IDåˆ™å°†å½“å‰è¦è·å–é”çš„çº¿ç¨‹è¿›è¡Œä¸å‰<span class="number">54</span>ä½ä¸­çš„THREAD IDè¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç›¸åŒåˆ™ç›´æ¥å¯ä»¥è¿›å…¥åˆ°åŒæ­¥ä»£ç å—å½“ä¸­ï¼‰ï¼›</span><br><span class="line">é€€å‡ºå¾ªç¯ä¹‹åæ¯æ¬¡å†æ¬¡è¿›è¡Œå¾ªç¯éœ€è¦è¿›å…¥åŒæ­¥ä»£ç å—æ—¶ä¹‹å‰å¯¹æ¯”ä¸€ä¸‹THREAD IDæ˜¯å¦ä¸€è‡´å³å¯ï¼›</span><br><span class="line">æ‰€ä»¥åå‘é”å¯ä»¥çœ‹åˆ°åœ¨ä¸€ä¸ªçº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç å—çš„æƒ…å†µä¸‹å…¶æ•ˆç‡æ˜¯éå¸¸é«˜çš„ï¼ˆè¾ƒä¹‹é‡é‡çº§é”è¦é«˜å¾ˆå¤šï¼‰ï¼›</span><br></pre></td></tr></table></figure><h3 id="åå‘é”çš„æ’¤é”€"><a href="#åå‘é”çš„æ’¤é”€" class="headerlink" title="åå‘é”çš„æ’¤é”€"></a>åå‘é”çš„æ’¤é”€</h3><h4 id="ä»€ä¹ˆæ—¶å€™æ’¤é”€åå‘é”"><a href="#ä»€ä¹ˆæ—¶å€™æ’¤é”€åå‘é”" class="headerlink" title="ä»€ä¹ˆæ—¶å€™æ’¤é”€åå‘é”"></a>ä»€ä¹ˆæ—¶å€™æ’¤é”€åå‘é”</h4><p>ä¸€æ—¦å­˜åœ¨æœ‰ä¸¤ä¸ªçº¿ç¨‹æ¥è¿›è¡Œé”çš„æ—¶å€™é‚£ä¹ˆå°±ä¼šæ’¤é”€åå‘é”ï¼›</p><h6 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xxx.demo07_biased_lock;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.openjdk.jol.info.ClassLayout;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo01</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    MyThread mt = <span class="keyword">new</span> MyThread();</span><br><span class="line">    mt.start();</span><br><span class="line"></span><br><span class="line">    MyThread mt2 = <span class="keyword">new</span> MyThread();</span><br><span class="line">    mt2.start();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">  <span class="keyword">static</span> Object obj = <span class="keyword">new</span> Object();</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)&#123;</span><br><span class="line">      <span class="keyword">synchronized</span>(obj)&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        System.out.println(ClassLayout.parseInstance(obj).toPrintable());</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">å‡è®¾åœ¨è¿™å½“ä¸­å­˜åœ¨æœ‰ä¸¤ä¸ªçº¿ç¨‹ï¼›</span></span><br><span class="line"><span class="comment">ä¹Ÿå°±æ„å‘³ç€æœ‰ä¸¤ä¸ªçº¿ç¨‹ä¼šå»è¿›è¡Œrun()å½“ä¸­çš„synchronizedï¼›</span></span><br><span class="line"><span class="comment">é‚£ä¹ˆä¸¤ä¸ªçº¿ç¨‹æ¥è¿›è¡Œæ‰§è¡Œçš„æ—¶å€™å°±éœ€è¦å°†è¯¥åå‘é”ç»™è¿›è¡Œæ’¤é”€ï¼›</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h3 id="åå‘é”æ’¤é”€è¿‡ç¨‹"><a href="#åå‘é”æ’¤é”€è¿‡ç¨‹" class="headerlink" title="åå‘é”æ’¤é”€è¿‡ç¨‹"></a>åå‘é”æ’¤é”€è¿‡ç¨‹</h3><ol><li>åå‘é”çš„æ’¤é”€åŠ¨ä½œå¿…é¡»ç­‰å¾…<strong>å…¨å±€å®‰å…¨ç‚¹</strong></li><li>æš‚åœæ‹¥æœ‰åå‘é”çš„çº¿ç¨‹ï¼Œåˆ¤æ–­é”å¯¹è±¡æ˜¯å¦å¤„äºè¢«é”å®šçŠ¶æ€</li><li>æ’¤é”€åå‘é”ï¼Œæ¢å¤åˆ°æ— é”ï¼ˆæ ‡å¿—ä½ä¸º01ï¼‰æˆ–è½»é‡çº§é”ï¼ˆæ ‡å¿—ä½ä¸º00ï¼‰çš„çŠ¶æ€ï¼›</li></ol><blockquote><p>TIPS: å…¨å±€å®‰å…¨ç‚¹<br>å‡è®¾å½“å‰éœ€è¦è¿›è¡Œç»Ÿè®¡è¶…å¸‚åœ¨9ç‚¹çš„æ—¶å€™è¶…å¸‚å½“ä¸­æœ‰å¤šå°‘äººï¼›<br>é‚£ä¹ˆåº”è¯¥å¦‚ä½•ç»Ÿè®¡ï¼Ÿ<br>å³åœ¨9ç‚¹çš„æ—¶å€™ï¼Œè®©åœ¨è¶…å¸‚å½“ä¸­çš„æ‰€æœ‰äººéƒ½åœä¸‹æ¥ï¼›ä¸è¦æœ‰äººè¿›å…¥è¶…å¸‚ä¹Ÿä¸è¦æœ‰äººå‡ºè¶…å¸‚ï¼›é‚£ä¹ˆè¿™ä¸ªæ—¶å€™æ‰æ¥è¿›è¡Œç»Ÿè®¡ï¼›<br>é‚£ä¹ˆè¿™ä¸ªçº¿ç¨‹å®‰å…¨ç‚¹æŒ‡çš„å°±æ˜¯åœ¨è¿™ä¸ªç‚¹çš„æ—¶å€™æ‰€æœ‰çš„çº¿ç¨‹éƒ½ä¼šè¿›è¡Œåœä¸‹æ¥ï¼›é‚£ä¹ˆä¹Ÿå°±å«åšå…¨å±€å®‰å…¨ç‚¹ï¼›é‚£ä¹ˆåªæœ‰åˆ°äº†å…¨å±€å®‰å…¨ç‚¹çš„æ—¶å€™æ‰èƒ½æ¥è¿›è¡Œæ’¤é”€åå‘é”ï¼›</p></blockquote><p>åå‘é” åœ¨ java1.6 ä¹‹åæ˜¯é»˜è®¤å¯ç”¨çš„ï¼›<br>ä½†æ˜¯åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨å‡ ç§’é’Ÿæ‰æ¿€æ´»ï¼Œå¯ä»¥ä½¿ç”¨<code>-XX:BiasedLockingStartupDelay=0</code>å‚æ•°å…³é—­å»¶è¿Ÿï¼Œ<br>å¦‚æœç¡®å®šåº”ç”¨ç¨‹åºæ‰€æœ‰é”é€šå¸¸æƒ…å†µä¸‹å¤„äºç«äº‰çŠ¶æ€ï¼Œ<br>å¯ä»¥é€šè¿‡<code>-XX:-UseBiasedLocking=false</code>å‚æ•°å…³é—­åå‘é”</p><h3 id="åå‘é”å¥½å¤„"><a href="#åå‘é”å¥½å¤„" class="headerlink" title="åå‘é”å¥½å¤„"></a>åå‘é”å¥½å¤„</h3><p>åå‘é”é€‚åˆä½¿ç”¨åœ¨åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ¥è·å–é”çš„æ—¶å€™è¿›è¡Œä½¿ç”¨ï¼›<br>å³æ²¡æœ‰ç«äº‰æƒ…å†µï¼›é‚£ä¹ˆåœ¨è¿™ç§æƒ…å†µä¸‹ä¸€ä¸ªçº¿ç¨‹åå¤è¿›å…¥åŒæ­¥ä»£ç å—é€€å‡ºåŒæ­¥ä»£ç å—çš„æ•ˆç‡æ˜¯å¾ˆé«˜çš„ï¼›åªè¦è¿›è¡Œåˆ¤æ–­å¯¹è±¡å¤´å½“ä¸­çš„çº¿ç¨‹idå³THREAD IDè·Ÿç°åœ¨è¦è·å–é”çš„çº¿ç¨‹çš„THREAD IDæ˜¯å¦ç›¸åŒå³å¯ï¼›å¦‚æœç›¸åŒåˆ™è¿›å…¥åŒæ­¥ä»£ç å—ï¼›é€€å‡ºåŒæ­¥ä»£ç å—æ—¶ä¹Ÿä¸éœ€è¦åšä»€ä¹ˆäº‹æƒ…ï¼›æ‰€ä»¥æ€§èƒ½é«˜ï¼›<br>ä½†æ˜¯è¿™ä¸ªåå‘é”ä¸ä¸€å®šæ€»æ˜¯å¥½çš„ï¼›<br>å¦‚æœå­˜åœ¨æœ‰å¾ˆå¤šçš„çº¿ç¨‹æ¥ç«äº‰é”ï¼›é‚£ä¹ˆè¿™ä¸ªæ—¶å€™åå‘é”å°±èµ·ä¸åˆ°ä»€ä¹ˆä½œç”¨äº†åè€Œä¼šå½±å“æ•ˆç‡ï¼›å› ä¸ºæ¯æ¬¡æ’¤é”€ä¸€æ¬¡åå‘é”éƒ½å¿…é¡»è¦ç­‰å¾…å…¨å±€å®‰å…¨ç‚¹æ‰€æœ‰çº¿ç¨‹éƒ½ä¼šåœä¸‹æ¥æ‰èƒ½å¤Ÿè¿›è¡Œæ’¤é”€åå‘é”ï¼Œæ‰€ä»¥åè€Œè¿˜ä¼šå½±å“æ€§èƒ½ï¼›<br>æ¯”å¦‚è¯´ä½¿ç”¨çº¿ç¨‹æ± æ¥æ‰§è¡Œä»£ç çš„æ—¶å€™ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™çŸ¥é“çº¿ç¨‹æ± å½“ä¸­è‚¯å®šæœ‰å¤šä¸ªçº¿ç¨‹åå¤å»æ‰§è¡ŒåŒæ ·çš„ä»»åŠ¡ï¼ŒåŒæ ·çš„ä»£ç å³åå¤çš„å»ç«äº‰åŒä¸€æŠŠé”ï¼›é‚£ä¹ˆåœ¨è¿™ä¸ªæ—¶å€™åå‘é”å°±æ˜¯å¤šä½™çš„äº†ï¼›<br>æ³¨æ„åœ¨JDK1.5çš„æ—¶å€™åå‘é”æ˜¯é»˜è®¤å…³é—­çš„ï¼›è€Œåœ¨JDK1.6çš„æ—¶å€™åå‘é”æ˜¯é»˜è®¤å¼€å¯çš„ï¼›å¦‚æœä¸éœ€è¦åå‘é”å¯ä»¥é€šè¿‡å¯åŠ¨å‚æ•°<code>-XX:-UseBiasedLocking=false</code>æ¥è¿›è¡Œå…³é—­åå‘é”ï¼›è®©å…¶ç›´æ¥è¿›å…¥é‡é‡çº§é”ï¼›</p><p>åå‘é”æ˜¯åœ¨ åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡ŒåŒæ­¥å—æ—¶ è¿›ä¸€æ­¥æé«˜æ€§èƒ½ï¼Œé€‚ç”¨äºä¸€ä¸ªçº¿ç¨‹åå¤è·å¾—åŒä¸€æŠŠé”çš„æƒ…å†µã€‚<br>åå‘é”å¯ä»¥æé«˜å¸¦æœ‰åŒæ­¥ä½†æ— ç«äº‰çš„ç¨‹åºæ€§èƒ½ã€‚</p><p>å®ƒåŒæ ·æ˜¯ä¸€ä¸ªå¸¦æœ‰æ•ˆç›Šæƒè¡¡æ€§è´¨çš„ä¼˜åŒ–ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒå¹¶ä¸ä¸€å®šæ€»æ˜¯å¯¹ç¨‹åºè¿è¡Œæœ‰åˆ©ã€‚<br>å¦‚æœç¨‹åºä¸­å¤§å¤šæ•°çš„é”æ€»æ˜¯è¢«å¤šä¸ªä¸åŒçš„çº¿ç¨‹è®¿é—®æ¯”å¦‚çº¿ç¨‹æ± ï¼Œé‚£åå‘æ¨¡å¼å°±æ˜¯å¤šä½™çš„ã€‚  </p><p>åœ¨JDK1.5ä¸­åå‘é”é»˜è®¤æ˜¯å…³é—­çš„ï¼Œè€Œåˆ°äº†JDK6ä¸­åå‘é”å·²ç»é»˜è®¤å¼€å¯ã€‚<br>ä½†åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨å‡ ç§’é’Ÿä¹‹åæ‰æ¿€æ´»ï¼Œå¯ä»¥ä½¿ç”¨<code>-XX:BiasedLockingStartupDelay=0</code>å‚æ•°å…³é—­å»¶è¿Ÿï¼Œ<br>å¦‚æœç¡®å®šåº”ç”¨ä¸­æ‰€æœ‰é”é€šå¸¸æƒ…å†µä¸‹å¤„äºç«äº‰çŠ¶æ€ï¼Œå¯ä»¥é€šè¿‡<code>-XX:-UseBiasedLocking=false</code>å‚æ•°å…³é—­åå‘é”ï¼›</p><h3 id="å°ç»“-15"><a href="#å°ç»“-15" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><blockquote><p>åå‘é”çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</p></blockquote><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å½“é”å¯¹è±¡ç¬¬ä¸€æ¬¡è¢«çº¿ç¨‹è·å–çš„æ—¶å€™ï¼Œ</span><br><span class="line">è™šæ‹Ÿæœºå°†ä¼šæŠŠå¯¹è±¡å¤´ä¸­çš„é”æ ‡å¿—ä½è®¾ç½®ä¸ºâ€œ<span class="number">01</span>â€ï¼Œå³åå‘æ¨¡å¼ã€‚</span><br><span class="line">åŒæ—¶ä½¿ç”¨<span class="built_in">CAS</span>æ“ä½œæŠŠè·å–å¾—åˆ°çš„è¿™ä¸ªé”çš„çº¿ç¨‹çš„IDè®°å½•åœ¨å¯¹è±¡çš„Mark Wordä¹‹ä¸­ï¼Œ</span><br><span class="line">å¦‚æœ<span class="built_in">CAS</span>æ“ä½œæˆåŠŸï¼ŒæŒæœ‰åå‘é”çš„çº¿ç¨‹ä»¥åæ¯æ¬¡è¿›å…¥è¿™ä¸ªé”ç›¸å…³çš„åŒæ­¥å—æ—¶ï¼Œè™šæ‹Ÿæœºéƒ½å¯ä»¥ä¸å†è¿›è¡Œä»»ä½•åŒæ­¥æ“ä½œï¼Œåå‘é”çš„æ•ˆç‡é«˜ã€‚</span><br></pre></td></tr></table></figure><table>  <tr>    <td rowspan="2">é”çŠ¶æ€</td>    <td>25bit</td>    <td>31bit</td>    <td>1bit</td>    <td>4bit</td>    <td>1bit</td>    <td>2bit</td>  </tr>  <tr>    <td> </td>    <td> </td>    <td>cms_free</td>    <td>åˆ†ä»£å¹´é¾„</td>    <td>åå‘é”</td>    <td>é”æ ‡å¿—ä½</td>  </tr>  <tr>    <td>æ— é”</td>    <td>unusedï¼ˆæ²¡æœ‰ä½¿ç”¨ï¼‰</td>    <td>hashCode</td>    <td></td>    <td></td>    <td>0ï¼ˆæ˜¯å¦æ˜¯åå‘é”ï¼›0è¡¨ç¤ºéåå‘é”ï¼›1è¡¨ç¤ºæ˜¯åå‘é”ï¼‰</td>    <td>01ï¼ˆé”çš„æ ‡å¿—ä½ï¼›01ä»£è¡¨æ— é”ï¼›00ä»£è¡¨è½»é‡çº§é”ï¼›10ä»£è¡¨é‡é‡çº§é”ï¼‰</td>  </tr>    <tr>    <td>åå‘é”</td>    <td colspan="2">ThreadId(54bit)Epoch(2bit)</td>    <td></td>    <td></td>    <td>1</td>    <td>01</td>  </tr>  <tr>    <td>è½»é‡çº§é”</td>    <td colspan="5">æŒ‡å‘æ ˆä¸­é”è®°å½•çš„æŒ‡é’ˆ</td>    <td>00</td>  </tr>  <tr>    <td>é‡é‡çº§é”</td>    <td colspan="5">æŒ‡å‘äº’æ–¥é‡ï¼ˆé‡é‡çº§é”ï¼‰çš„æŒ‡é’ˆ</td>    <td>10</td>  </tr></table><p>å½“çº¿ç¨‹ç¬¬ä¸€æ¬¡æ¥è·å–é”çš„æ—¶å€™ï¼Œ<br>é‚£ä¹ˆè™šæ‹Ÿæœºå°±ä¼šæŠŠå¯¹è±¡å¤´è®¾ç½®ä¸º01ï¼Œä¸”åå‘é”è®¾ç½®ä¸º1ï¼›<br>é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±è®°å½•äº†åå‘æ¨¡å¼ï¼›åŒæ—¶é€šè¿‡CASæ“ä½œå°†å‰é¢çš„54ä½è®¾ç½®ä¸ºè·å–äº†åå‘é”çš„çº¿ç¨‹çš„THREAD IDï¼›é‚£ä¹ˆå¦‚æœè®¾ç½®æˆåŠŸåˆ™è¯´æ˜è¯¥çº¿ç¨‹è·å–å¾—åˆ°äº†è¯¥åå‘é”ï¼›<br>é‚£ä¹ˆåç»­çš„è¿›å…¥åŒæ­¥ä»£ç å—æ—¶æ•ˆç‡å°±ä¼šå˜é«˜äº†ï¼›</p><blockquote><p>åå‘é”çš„å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿ</p></blockquote><p>åå‘é”é€‚ç”¨äºä¸€ä¸ªçº¿ç¨‹åå¤è¿›å…¥åŒæ­¥ä»£ç å—çš„æƒ…å†µï¼›<br>å³æ²¡æœ‰é”ç«äº‰çš„æƒ…å†µä¸‹ï¼›é‚£ä¹ˆè¿™ä¸ªæ—¶å€™æ˜¯å¯ä»¥æé«˜ä¸€ä¸ªçº¿ç¨‹è¿›å…¥åŒæ­¥ä»£ç å—æ—¶çš„æ•ˆç‡çš„ï¼›ä½†æ˜¯å¦‚æœå­˜åœ¨ç«äº‰é‚£å°±ä¸è¡Œäº†ï¼›</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">åå‘é”æ˜¯åœ¨ åªæœ‰ä¸€ä¸ªçº¿ç¨‹ æ‰§è¡ŒåŒæ­¥ä»£ç å—æ—¶ è¿›ä¸€æ­¥æé«˜æ€§èƒ½ï¼Œ</span><br><span class="line">é€‚ç”¨äº ä¸€ä¸ªçº¿ç¨‹åå¤è·å¾—åŒä¸€ä¸ªé”çš„æƒ…å†µã€‚</span><br><span class="line">åå‘é”å¯ä»¥æé«˜å¸¦æœ‰åŒæ­¥ä½†æ˜¯æ— ç«äº‰çš„ç¨‹åºæ€§èƒ½ã€‚</span><br></pre></td></tr></table></figure><h2 id="synchronizedä¼˜åŒ–-è½»é‡çº§é”"><a href="#synchronizedä¼˜åŒ–-è½»é‡çº§é”" class="headerlink" title="synchronizedä¼˜åŒ–-è½»é‡çº§é”"></a>synchronizedä¼˜åŒ–-è½»é‡çº§é”</h2><h3 id="ç›®æ ‡-19"><a href="#ç›®æ ‡-19" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>å­¦ä¹ è½»é‡çº§é”çš„åŸç†å’Œå¥½å¤„</p><h3 id="ä»€ä¹ˆæ˜¯è½»é‡çº§é”"><a href="#ä»€ä¹ˆæ˜¯è½»é‡çº§é”" class="headerlink" title="ä»€ä¹ˆæ˜¯è½»é‡çº§é”"></a>ä»€ä¹ˆæ˜¯è½»é‡çº§é”</h3><p>å½“åå‘é”å‡ºç°ç«äº‰çš„æ—¶å€™ï¼Œä¼šæ’¤ä¸‹åå‘é”ä»è€Œå‡çº§åˆ°è½»é‡çº§é”ï¼›<br>è½»é‡çº§é”æ˜¯JDK1.6å½“ä¸­ä¸ºäº†ä¼˜åŒ–synchronizedè€Œå¼•å…¥çš„ä¸€ç§æ–°å‹é”æœºåˆ¶ï¼›<br>éœ€è¦æ³¨æ„çš„æ˜¯è½»é‡çº§é”ä¸æ˜¯ä»»ä½•æƒ…å†µä¸‹å…¶å¼€é”€æ¯”è¾ƒçš„å°è€Œæ˜¯åœ¨ç‰¹å®šçš„æƒ…å†µä¸‹æ‰å¼€é”€æ¯”è¾ƒå°ï¼›æ‰€ä»¥è½»é‡çº§é”å¹¶ä¸èƒ½å¤Ÿç”¨æ¥ä»£æ›¿é‡é‡çº§é”ï¼›è½»é‡çº§é”åªæ˜¯åœ¨ä¸€å®šçš„æƒ…å†µä¸‹æ¥è¿›è¡Œå‡å°‘æ¶ˆè€—ï¼›</p><p>è½»é‡çº§é”æ˜¯ JDK1.6ä¹‹ä¸­åŠ å…¥çš„ æ–°å‹é”æœºåˆ¶ï¼Œ<br>å®ƒåå­—ä¸­çš„â€œè½»é‡çº§â€æ˜¯ç›¸å¯¹äºä½¿ç”¨monitorçš„ä¼ ç»Ÿé”è€Œè¨€çš„ï¼Œ<br>å› æ­¤ä¼ ç»Ÿçš„é”æœºåˆ¶å°±ç§°ä¸ºâ€œé‡é‡çº§â€é”ã€‚<br>é¦–å…ˆéœ€è¦å¼ºè°ƒçš„ä¸€ç‚¹æ˜¯ï¼Œè½»é‡çº§é”å¹¶ä¸æ˜¯ç”¨æ¥ä»£æ›¿é‡é‡çº§é”çš„ï¼›</p><p>å¼•å…¥è½»é‡çº§é”çš„ç›®çš„ï¼š åœ¨å¤šçº¿ç¨‹äº¤æ›¿æ‰§è¡ŒåŒæ­¥å—çš„æƒ…å†µä¸‹ï¼Œï¼ˆå¼•å…¥è½»é‡çº§é”ï¼‰å°½é‡é¿å…é‡é‡çº§é”å¼•èµ·çš„æ€§èƒ½æ¶ˆè€—ï¼Œä½†æ˜¯å¦‚æœå¤šä¸ªçº¿ç¨‹åœ¨åŒä¸€æ—¶åˆ»è¿›å…¥ä¸´ç•ŒåŒºï¼Œä¼šå¯¼è‡´è½»é‡çº§é”è†¨èƒ€å‡çº§é‡é‡çº§é”ï¼Œæ‰€ä»¥è½»é‡çº§é”çš„å‡ºç°å¹¶éæ˜¯è¦ä»£æ›¿é‡é‡çº§é”ã€‚</p><p>ï¼ˆä¹Ÿå°±æ˜¯è¯´åœ¨å¤šçº¿ç¨‹äº¤æ›¿æ‰§è¡ŒåŒæ­¥å—çš„æ—¶å€™è½»é‡çº§çš„æ€§èƒ½æ‰æ˜¯æ¯”è¾ƒå¥½çš„ï¼‰<br>å‡è®¾åœ¨é¤å…å½“ä¸­ï¼Œæœ‰å¤šä¸ªæ¡Œæ¤…ä»¥ä¾¿äºç”¨æ¥ç”¨æˆ·ç”¨é¤ï¼›<br>å‡è®¾ç°åœ¨æœ‰ç¬¬ä¸€ä¸ªäººæ¥è¿›è¡Œåˆ°ä¸€å·åº§å½“ä¸­ç”¨é¤ï¼Œç”¨é¤å®Œæ¯•ä¹‹åç¦»å¼€ä¸€å·åº§ï¼›<br>é‚£ä¹ˆå½“ä¸€å·åº§çš„ç”¨æˆ·ç¦»å¼€ä¹‹åç°åœ¨åˆæ¥äº†ç¬¬äºŒä¸ªç”¨æˆ·åˆååˆ°äº†ä¸€å·åº§å½“ä¸­è¿›è¡Œç”¨é¤ï¼ŒåŒæ ·ç”¨é¤å®Œæ¯•ä¹‹åç¦»å¼€ä¸€å·åº§ï¼›ç´§æ¥ç€ç¬¬äºŒä¸ªç”¨æˆ·ç¦»å¼€ä¹‹åç¬¬ä¸‰ä¸ªç”¨æˆ·åˆæ¥äº†ä¸”ä¹Ÿæ˜¯ååœ¨ä¸€å·åº§çš„ä½ç½®ä¸Šè¿›è¡Œç”¨é¤ï¼›å¯ä»¥çœ‹åˆ°çš„æ˜¯è¿™ä¸‰ä¸ªç”¨æˆ·æ˜¯åˆ†åˆ«ä¸åŒæ—¶åˆ»æ¥è¿›è¡Œç”¨é¤çš„ï¼›å³ä¹Ÿå°±æ˜¯äº¤æ›¿è¿›è¡Œçš„æ²¡æœ‰ç«äº‰çš„çŠ¶å†µï¼›é‚£ä¹ˆå¦‚æœè¯´ä¸€å·åº§çš„é£æ™¯æ¯”è¾ƒå¥½åˆå¤„äºä¸‹ç­ç”¨é¤çš„é«˜å³°æœŸï¼ŒåŒä¸€æ—¶åˆ»ä¸‰ä¸ªç”¨æˆ·åŒæ—¶æ¥è¿›è¡Œç«äº‰ä¸€å·åº§çš„ç”¨é¤ï¼›é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±å‡ºç°äº†ç«äº‰ï¼›ä¹Ÿå°±ä¸é€‚åˆä½¿ç”¨è½»é‡çº§é”äº†ï¼›</p><h3 id="è½»é‡çº§é”åŸç†"><a href="#è½»é‡çº§é”åŸç†" class="headerlink" title="è½»é‡çº§é”åŸç†"></a>è½»é‡çº§é”åŸç†</h3><p>å½“å…³é—­åå‘é”åŠŸèƒ½ æˆ–è€… å¤šä¸ªçº¿ç¨‹ç«äº‰åå‘é”å¯¼è‡´åå‘é”å‡çº§ä¸ºè½»é‡çº§é”ï¼Œ<br>åˆ™ä¼šå°è¯•è·å–è½»é‡çº§é”ï¼Œå…¶è·å–é”æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p>åˆ¤æ–­å½“å‰å¯¹è±¡ æ˜¯å¦å¤„äºæ— é”çŠ¶æ€ï¼ˆhashcodeã€0ã€01ï¼‰ï¼›<br>å¦‚æœæ˜¯ï¼Œåˆ™JVMé¦–å…ˆå°†åœ¨å½“å‰çº¿ç¨‹çš„æ ˆå¸§ä¸­å»ºç«‹ä¸€ä¸ªæ‰€è®°å½•ï¼ˆLock Recordï¼‰çš„ç©ºé—´ï¼Œç”¨äºå­˜å‚¨é”å¯¹è±¡ç›®å‰çš„Mark Wordçš„æ‹·è´ï¼ˆå®˜æ–¹æŠŠè¿™ä»½æ‹·è´åŠ äº†ä¸€ä¸ªDisplacedå‰ç¼€ï¼Œå³Displaced Mark Wordï¼‰ï¼Œå°†å¯¹è±¡çš„Mark Wordèµ‹å€¼åˆ°æ ˆå¸§ä¸­çš„Lock Recordä¸­ï¼Œå°†Lock Recordçš„owneræŒ‡å‘å½“å‰å¯¹è±¡ã€‚</p></li><li><p>JVMåˆ©ç”¨CASæ“ä½œå°è¯•å°†å¯¹è±¡çš„Mark Wordæ›´æ–°ä¸ºæŒ‡å‘Lock Recordçš„æŒ‡é’ˆï¼›å¦‚æœæˆåŠŸè¡¨ç¤ºç«äº‰åˆ°é”ï¼Œåˆ™å°†é”æ ‡å¿—ä½å˜æˆ00ï¼Œæ‰§è¡ŒåŒæ­¥æ“ä½œã€‚</p></li><li><p>å¦‚æœå¤±è´¥åˆ™åˆ¤æ–­å½“å‰å¯¹è±¡çš„Mark Wordæ˜¯å¦æŒ‡å‘å½“å‰çº¿ç¨‹çš„æ ˆå¸§ï¼Œå¦‚æœæ˜¯åˆ™è¡¨ç¤ºå½“å‰çº¿ç¨‹å·²ç»æŒæœ‰å½“å‰å¯¹è±¡</p></li></ol><h4 id="æ ˆå¸§"><a href="#æ ˆå¸§" class="headerlink" title="æ ˆå¸§"></a>æ ˆå¸§</h4><p>å†™ä¸€ä¸ªæ–¹æ³•æ—¶é‚£ä¹ˆåˆ°æ—¶å€™è¿™ä¸ªæ–¹æ³•è¿è¡Œæ—¶å°±å°†ä¼šè¿›å…¥åˆ°æ ˆå½“ä¸­æ¥è¿›è¡Œæ‰§è¡Œï¼›<br>é‚£ä¹ˆè¯¥æ–¹æ³•è¿›å…¥åˆ°æ ˆä¸­çš„è¯¥æ–¹æ³•å°±ç§°ä½œæ˜¯æ ˆå¸§ï¼›<br>æ ˆå¸§ï¼šä¸€ä¸ªè¿›å…¥æ ˆä¸­çš„æ–¹æ³•å°±æ˜¯ä¸€ä¸ªæ ˆå¸§ï¼›<br>é‚£ä¹ˆè¿™ä¸ªæ ˆå¸§æ˜¯ç”¨æ¥æ‰§è¡Œæ–¹æ³•çš„æ‰€ä»¥è¿™ä¸ªæ ˆå¸§ä¹Ÿå…·æœ‰ç©ºé—´ï¼Œä¹Ÿèƒ½å¤Ÿå­˜å‚¨ä¸€äº›å˜é‡ï¼›</p><table>  <tr>    <td rowspan="2">é”çŠ¶æ€</td>    <td>25bit</td>    <td>31bit</td>    <td>1bit</td>    <td>4bit</td>    <td>1bit</td>    <td>2bit</td>  </tr>  <tr>    <td> </td>    <td> </td>    <td>cms_free</td>    <td>åˆ†ä»£å¹´é¾„</td>    <td>åå‘é”</td>    <td>é”æ ‡å¿—ä½</td>  </tr>  <tr>    <td>æ— é”</td>    <td>unusedï¼ˆæ²¡æœ‰ä½¿ç”¨ï¼‰</td>    <td>hashCode</td>    <td></td>    <td></td>    <td>0ï¼ˆæ˜¯å¦æ˜¯åå‘é”ï¼›0è¡¨ç¤ºéåå‘é”ï¼›1è¡¨ç¤ºæ˜¯åå‘é”ï¼‰</td>    <td>01ï¼ˆé”çš„æ ‡å¿—ä½ï¼›01ä»£è¡¨æ— é”ï¼›00ä»£è¡¨è½»é‡çº§é”ï¼›10ä»£è¡¨é‡é‡çº§é”ï¼‰</td>  </tr>    <tr>    <td>åå‘é”</td>    <td colspan="2">ThreadId(54bit)Epoch(2bit)</td>    <td></td>    <td></td>    <td>1</td>    <td>01</td>  </tr>  <tr>    <td>è½»é‡çº§é”</td>    <td colspan="5">æŒ‡å‘æ ˆä¸­é”è®°å½•çš„æŒ‡é’ˆ</td>    <td>00</td>  </tr>  <tr>    <td>é‡é‡çº§é”</td>    <td colspan="5">æŒ‡å‘äº’æ–¥é‡ï¼ˆé‡é‡çº§é”ï¼‰çš„æŒ‡é’ˆ</td>    <td>10</td>  </tr></table><p>è½»é‡çº§é”åˆ†æ</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">javaä»£ç ï¼š</span><br><span class="line"><span class="keyword">class</span> <span class="symbol">MyThread</span> <span class="symbol">extends</span> <span class="symbol">Thread</span>&#123;</span><br><span class="line">  static Object obj = new Object();</span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line">  <span class="keyword">public</span> <span class="built_in">void</span> run()&#123;</span><br><span class="line">    <span class="keyword">for</span>( <span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)&#123;</span><br><span class="line">      synchronized(obj)&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        System.<span class="keyword">out</span>.println(ClassLayout.parseInstance(obj).toPrintable());</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">-----------------------------------------------------------</span><br><span class="line">åˆ†æï¼š</span><br><span class="line">synchronizedå½“ä¸­çš„objå³ä¸ºé”å¯¹è±¡ï¼ˆå¯¹è±¡é”ï¼‰</span><br><span class="line">å½“å‰å…·æœ‰ä¸¤ä¸ªçº¿ç¨‹ï¼Œåˆ†åˆ«æ˜¯Açº¿ç¨‹ä»¥åŠBçº¿ç¨‹</span><br><span class="line">ï¼ˆåˆ›å»ºè¿™ä¸¤ä¸ªçº¿ç¨‹å¹¶å¯åŠ¨ä»–ä»¬ï¼Œé‚£ä¹ˆä»–ä»¬éƒ½ä¼šå°†å»æ‰§è¡Œrun()æ–¹æ³•å½“ä¸­çš„ä»£ç ï¼‰ï¼›</span><br><span class="line">å¯ä»¥çœ‹åˆ°çš„æ˜¯è¿›å…¥synchronizedåŒæ­¥ä»£ç å—ä¹‹å‰éœ€è¦ä¸€ä¸ªobjå¯¹è±¡é”ï¼›</span><br><span class="line">å‡è®¾çº¿ç¨‹Aæ¥å…ˆè¿›è¡Œæ‰§è¡Œrun()æ–¹æ³•ï¼›</span><br><span class="line">å³ï¼Œå³å°†æ‰§è¡Œçš„run()æ–¹æ³•è¿è¡Œå°±ä¼šè¿›å…¥åˆ°æ ˆä¸­å»ï¼Œé‚£ä¹ˆè¿›å…¥åˆ°æ ˆä¸­æ‰§è¡Œçš„æ–¹æ³•å³ä¸€ä¸ªæ ˆå¸§ï¼Œå³æ­¤æ—¶è¿è¡Œçš„run()æ–¹æ³•å³ä¸ºä¸€ä¸ªæ ˆå¸§ï¼›</span><br><span class="line">å‡è®¾æ­¤æ—¶çº¿ç¨‹Aè¦è¿›å…¥åˆ°åŒæ­¥ä»£ç å—ä¹‹ä¸­ï¼›é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±è¦å‡çº§ä¸ºè½»é‡çº§é”ï¼›å› ä¸ºå­˜åœ¨æœ‰å¤šä¸ªé”ç«äº‰ï¼›æ‰€ä»¥æœªä½¿ç”¨åå‘é”ï¼›</span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶å¦‚ä½•è¿›è¡Œå‡çº§ä¸ºè½»é‡çº§é”?</span><br><span class="line">é¦–å…ˆåœ¨æ ˆä¸­è¿è¡Œæ‰§è¡Œrun()æ–¹æ³•çš„è¯¥æ ˆå¸§å½“ä¸­ä¼šåˆ›å»ºä¸€ä¸ªå«åšLock Recordçš„é”è®°å½•ç©ºé—´ï¼ˆè¿™å—ç©ºé—´å†…å­˜æ”¾displaced hdrä»¥åŠownerï¼‰ï¼›</span><br><span class="line">é‚£ä¹ˆæ¥ç€å°±ä¼šå°†é”å¯¹è±¡å³objå‡çº§ä¸ºè½»é‡çº§é”ï¼›</span><br><span class="line">é‚£ä¹ˆå…¶å½“å‰objé”å¯¹è±¡çš„çŠ¶æ€ä¸ºæ— é”çŠ¶æ€ï¼›</span><br><span class="line">å³ä¼šå°†å¯¹è±¡å½“ä¸­çš„æ— é”çŠ¶æ€å½“ä¸­çš„hashCodeã€åˆ†ä»£å¹´é¾„ä»¥åŠé”æ ‡è®°èµ‹å€¼åˆ°æ ˆå¸§å½“ä¸­Lock recordä¸­åˆ›å»ºçš„displaced hdrå½“ä¸­ï¼›</span><br><span class="line">å¦å¤–è¿˜ä¼šå°†æ ˆå¸§å½“ä¸­çš„Lock recordå½“ä¸­è¿˜ä¼šè¿›è¡Œåˆ›å»ºçš„owneræŒ‡å‘objï¼Œå³ä¹Ÿå°±æ˜¯synchronizedçš„é”å¯¹è±¡ï¼ˆå¯¹è±¡é”ï¼‰ï¼›</span><br><span class="line">å¦å¤–è¿˜éœ€è¦åšçš„äº‹æƒ…æœ‰å‡çº§ä¸ºè½»é‡çº§é”çš„æ—¶å€™ä¼šå°†é”æ ‡å¿—ä½çš„æ•°å€¼ä¿®æ”¹æˆâ€œ<span class="number">00</span>â€ï¼›</span><br><span class="line">å¹¶ä¸”å­˜åœ¨å‰<span class="number">25</span>bit+<span class="number">31</span>bit+<span class="number">1</span>bit+<span class="number">4</span>bit+<span class="number">1</span>bitæ¥è¿›è¡Œä¿å­˜æ ˆå¸§ä¸­Lock Recordçš„åœ°å€ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™äº›æ“ä½œéƒ½æ˜¯é€šè¿‡CASæ¥è¿›è¡Œæ“ä½œçš„ï¼›</span><br><span class="line">è¿™å°±æ˜¯è½»é‡çº§é”çš„åŸç†ï¼›</span><br><span class="line">ç¬”è®°å°ç»“-è½»é‡çº§é”çš„åŸç†ï¼š</span><br><span class="line">å½“å…³é—­äº†åå‘é”æˆ–è€…è¯´åå‘é”å‡ºç°äº†ç«äº‰çš„æƒ…å†µé‚£ä¹ˆéƒ½ä¼šå¯¼è‡´åå‘é”å‡çº§ä¸ºè½»é‡çº§é”ï¼›</span><br><span class="line">è½»é‡çº§é”æ­¥éª¤å¦‚ä¸‹ï¼š</span><br><span class="line">é¦–å…ˆåˆ¤æ–­å¯¹è±¡å¤´å½“ä¸­çš„å€’æ•°ä¸¤ä½å³æ ‡å¿—ä½æ˜¯å¦ä¸º<span class="number">01</span>,<span class="number">01</span>å³ä»£è¡¨æ— é”çŠ¶æ€ï¼›</span><br><span class="line">å¦‚æœç¡®å®æ— é”ï¼›é‚£ä¹ˆJVMå°±ä¼šåœ¨å½“å‰çš„æ ˆå¸§å½“ä¸­å»ºç«‹ä¸€ä¸ªLock Recordè¿™æ ·ä¸€ä¸ªç©ºé—´ï¼›</span><br><span class="line">è¿™å—ç©ºé—´ç”¨æ¥å­˜å‚¨å¯¹è±¡å¤´ï¼›å³ç”¨æ¥å­˜å‚¨displaced hdr(displaced hdrå³Displaced Mark Word)ä»¥åŠownerï¼›</span><br><span class="line">displaced hdrä¹Ÿå°±æ˜¯æŒ‡çš„Displaced Mark Wordï¼ˆä¼šå°†åˆ†ä»£å¹´é¾„ã€é”æ ‡å¿—ã€é”æ ‡å¿—ç­‰æ”¾åˆ°displaced hdrå½“ä¸­å»ï¼‰ï¼›</span><br><span class="line">å¹¶ä¸”ownerä¼šæ‰§è¡Œå½“å‰çš„å¯¹è±¡å³synchronizedå½“ä¸­çš„objï¼›</span><br><span class="line">æ¥ç€è¿˜ä¼šä½¿ç”¨CASæ“ä½œæŠŠå¯¹è±¡å¤´å½“ä¸­çš„Mark Wordè¿›è¡Œä¿å­˜æ ˆå¸§ä¸­åˆ›å»ºçš„Lock recordçš„åœ°å€ï¼›</span><br><span class="line">æœ€åä¼šå°†å¯¹è±¡å¤´å½“ä¸­çš„æ ‡å¿—ä½æ”¹æˆ<span class="number">00</span>å³ä»£è¡¨çš„æ˜¯è½»é‡çº§é”ï¼›</span><br><span class="line">å¦‚æœåœ¨è¿™ä¸ªå½“ä¸­å‡çº§è½»é‡çº§é”å¤±è´¥é‚£ä¹ˆå°±ä¼šè†¨èƒ€ä¸ºé‡é‡çº§é”ï¼›</span><br></pre></td></tr></table></figure><h3 id="è½»é‡çº§é”çš„é‡Šæ”¾"><a href="#è½»é‡çº§é”çš„é‡Šæ”¾" class="headerlink" title="è½»é‡çº§é”çš„é‡Šæ”¾"></a>è½»é‡çº§é”çš„é‡Šæ”¾</h3><p>è½»é‡çº§é”çš„é‡Šæ”¾ä¹Ÿæ˜¯é€šè¿‡CASæ“ä½œæ¥è¿›è¡Œçš„ï¼Œä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li>å–å‡ºåœ¨è·å–è½»é‡çº§é” ä¿å­˜åœ¨Displaced Mark Wordä¸­çš„æ•°æ®ï¼›</li><li>ç”¨CASæ“ä½œ å°†å–å‡ºçš„æ•°æ® æ›¿æ¢å½“å‰å¯¹è±¡çš„Mark Wordä¸­ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™è¯´æ˜é‡Šæ”¾é”æˆåŠŸï¼›</li><li>å¦‚æœCASæ“ä½œæ›¿æ¢å¤±è´¥ï¼Œè¯´æ˜æœ‰å…¶ä»–çº¿ç¨‹å°è¯•è·å–è¯¥é”ï¼Œåˆ™éœ€è¦å°†è½»é‡çº§é”éœ€è¦è†¨èƒ€å‡çº§ä¸ºé‡é‡çº§é”ã€‚</li></ol><p>å¯¹äºè½»é‡çº§é”ï¼Œå…¶æ€§èƒ½æå‡çš„ä¾æ®æ˜¯â€œå¯¹äºç»å¤§éƒ¨åˆ†çš„é”ï¼Œåœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…éƒ½æ˜¯ä¸ä¼šå­˜åœ¨ç«äº‰çš„â€ï¼Œ<br>å¦‚æœæ‰“ç ´è¿™ä¸ªä¾æ®åˆ™é™¤äº†äº’æ–¥çš„å¼€é”€å¤–ï¼Œè¿˜æœ‰é¢å¤–çš„CASæ“ä½œï¼Œå› æ­¤åœ¨æœ‰å¤šçº¿ç¨‹ç«äº‰çš„æƒ…å†µä¸‹ï¼Œè½»é‡çº§é”æ¯”é‡é‡çº§é”æ›´æ…¢ã€‚</p><p>è½»é‡çº§é”çš„é‡Šæ”¾å³å°†æ ˆå¸§å½“ä¸­çš„Lock Recordå½“ä¸­çš„displaced hdrå½“ä¸­çš„hashCodeé‡æ–°æ”¾å›åˆ°å¯¹è±¡å¤´åŸæœ‰çš„ä½ç½®ä¸Šå³æ— é”çŠ¶æ€ä¸Š31bitå¤„ï¼›ä»¥åŠdisplaced hdrå½“ä¸­çš„åˆ†ä»£å¹´é¾„ä»¥åŠé”æ ‡å¿—ä½ç­‰éƒ½æ”¾å›åŸä½ï¼›<br>æ’¤é”€è½»é‡çº§é”ä¹Ÿæ˜¯ä¸€ä¸ªCASæ“ä½œï¼›å³å¦‚æœå°†hashCodeã€åˆ†ä»£å¹´é¾„ä»¥åŠé”æ ‡å¿—ä½éƒ½è¿˜åŸå½’ä½äº†é‚£ä¹ˆä¹Ÿå°±è¯´æ˜è½»é‡çº§é”å·²ç»è¢«æ’¤é”€äº†ï¼›</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¯¹äºè½»é‡çº§é”è€Œè¨€ï¼šè½»é‡çº§é”çš„æ€§èƒ½ä¹‹æ‰€ä»¥é«˜ï¼Œæ˜¯å› ä¸ºåœ¨ç»å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œè¿™ä¸ªåŒæ­¥ä»£ç å—ä¸å­˜åœ¨æœ‰ç«äº‰çš„çŠ¶å†µï¼›çº¿ç¨‹ä¹‹é—´äº¤æ›¿æ‰§è¡Œï¼›<br>å¦‚æœæ˜¯å¤šçº¿ç¨‹åŒæ—¶æ¥è¿›è¡Œç«äº‰è¿™ä¸ªé”çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªè½»é‡çº§é”çš„å¼€é”€ä¹Ÿå°±ä¼šæ›´å¤§ï¼›</p><h3 id="è½»é‡çº§é”å¥½å¤„"><a href="#è½»é‡çº§é”å¥½å¤„" class="headerlink" title="è½»é‡çº§é”å¥½å¤„"></a>è½»é‡çº§é”å¥½å¤„</h3><p>åœ¨å¤šçº¿ç¨‹äº¤æ›¿æ‰§è¡ŒåŒæ­¥å—çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é¿å…é‡é‡çº§é”å¼•èµ·çš„æ€§èƒ½æ¶ˆè€—ã€‚</p><h3 id="å°ç»“-16"><a href="#å°ç»“-16" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>è½»é‡çº§é”çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>è½»é‡çº§é”å³ä¼šåœ¨æ ˆå¸§ä¸­åˆ›å»ºä¸€ä¸ªå«åšLock recordé”è®°å½•çš„ç©ºé—´ï¼›<br>é‚£ä¹ˆåœ¨Lock Recordé”è®°å½•ç©ºé—´å†…çš„displaced hdrä¼šå»è¿›è¡Œä¿å­˜å¯¹è±¡å¤´å½“ä¸­çš„hashCodeã€åˆ†ä»£å¹´é¾„ä»¥åŠé”æ ‡å¿—ç­‰ï¼›å¦å¤–Lock recordé”è®°å½•ç©ºé—´å½“ä¸­çš„ownerå³æŒ‡å‘çš„æ˜¯è¿™ä¸ªé”å¯¹è±¡ï¼›å¹¶ä¸”åœ¨å¯¹è±¡å¤´å½“ä¸­ä¼šæ¥è¿›è¡Œä¿å­˜Lock Recordé”è®°å½•çš„ç©ºé—´åœ°å€ï¼›ç„¶åå°†å¯¹è±¡å¤´å½“ä¸­çš„é”æ ‡å¿—æ”¹æˆ00ä»¥è¡¨ç¤ºè½»é‡çº§é”ï¼›</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å°†å¯¹è±¡çš„Mark <span class="keyword">Word</span>èµ‹å€¼åˆ°æ ˆå¸§ä¸­çš„Lock <span class="keyword">Record</span>ä¸­ï¼ŒMark <span class="keyword">Word</span>æ›´æ–°ä¸ºæŒ‡å‘Lock <span class="keyword">Record</span>çš„æŒ‡é’ˆã€‚</span><br></pre></td></tr></table></figure><p>è½»é‡çº§é”çš„å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åœ¨å¤šçº¿ç¨‹äº¤æ›¿æ‰§è¡ŒåŒæ­¥å—çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é¿å…é‡é‡çº§é”å¼•èµ·çš„æ€§èƒ½æ¶ˆè€—ã€‚</span><br></pre></td></tr></table></figure><h2 id="synchronizedä¼˜åŒ–-è‡ªæ—‹é”"><a href="#synchronizedä¼˜åŒ–-è‡ªæ—‹é”" class="headerlink" title="synchronizedä¼˜åŒ–-è‡ªæ—‹é”"></a>synchronizedä¼˜åŒ–-è‡ªæ—‹é”</h2><h3 id="å›é¡¾å¹¶å¼•å…¥-2"><a href="#å›é¡¾å¹¶å¼•å…¥-2" class="headerlink" title="å›é¡¾å¹¶å¼•å…¥"></a>å›é¡¾å¹¶å¼•å…¥</h3><p>å½“è½»é‡çº§é”å‘ç”Ÿç«äº‰çš„æ—¶å€™ä¼šè†¨èƒ€å‡çº§ä¸ºé‡é‡çº§é”ï¼›<br>ä½†æ˜¯é‡é‡çº§é”ç›¸å¯¹äºæ€§èƒ½å¼€é”€çš„æ¶ˆè€—æ˜¯æ¯”è¾ƒå¤§çš„ï¼›<br>å› æ­¤åº”è¯¥å°½é‡é¿å…å‡çº§ä¸ºé‡é‡çº§é”ï¼›<br>æ‰€ä»¥JVMåœ¨è½»é‡çº§é”åœ¨å‡çº§ä¸ºé‡é‡çº§é”çš„æ—¶å€™çš„è¿™ä¸ªè¿‡ç¨‹å½“ä¸­è¿˜ä¼šå†æŒ£æ‰ä¸€ä¸‹ï¼›<br>å°½é‡é¿å…å‡çº§ä¸ºé‡é‡çº§é”ï¼›<br>è¿™ä¸ªæŒ£æ‰çš„è¿‡ç¨‹å°±æ˜¯è‡ªæ—‹é”ï¼›</p><p>é‡é‡çº§é”å›é¡¾ï¼šé‡é‡çº§é”æ˜¯ç”±monitoræ¥è¿›è¡Œå®ç°çš„ï¼›å½“ä¸€ä¸ªçº¿ç¨‹æ¥è¿›è¡Œç«äº‰monitoré”å¦‚æœæ²¡æœ‰ç«äº‰åˆ°é‚£ä¹ˆçº¿ç¨‹å°±ä¼šè¿›å…¥é˜»å¡çŠ¶æ€ï¼›å½“å…¶ä»–çº¿ç¨‹å°†é”é‡Šæ”¾çš„æ—¶å€™ä¼šæ¥è¿›è¡Œå”¤é†’é‚£äº›å¤„äºé˜»å¡çŠ¶æ€çš„çº¿ç¨‹æœ‰æœºä¼šå»ç«äº‰é”ï¼›</p><p>ä¸¾ä¸ªä¾‹å­ï¼šå‡è®¾ç¬¬ä¸€ä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹Aæ¥è¿›è¡Œæ‰§è¡ŒåŒæ­¥ä»£ç å—ï¼›<br>é‚£ä¹ˆçº¿ç¨‹Aç«äº‰å¾—åˆ°é”ä»è€Œè¿›å…¥åŒæ­¥ä»£ç å—å½“ä¸­è¿›è¡Œæ‰§è¡Œï¼›<br>ä¸æ­¤åŒæ—¶åˆæ¥äº†ç¬¬äºŒä¸ªçº¿ç¨‹ï¼Œå³çº¿ç¨‹Bï¼›ç¬¬äºŒä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹Bä¹Ÿæ¥è¿›è¡Œæ‰§è¡ŒåŒæ­¥ä»£ç å—ï¼›ä½†æ˜¯çº¿ç¨‹Aç”±äºæ²¡æœ‰é‡Šæ”¾é”ï¼›ä»è€Œçº¿ç¨‹Bå°±æ²¡æœ‰åŠæ³•è·å–å¾—åˆ°é”ä»è€Œæ— æ³•è¿›å…¥åŒæ­¥ä»£ç å—ä»è€Œè¿›å…¥é˜»å¡çŠ¶æ€ï¼›åªæœ‰ç¬¬ä¸€ä¸ªçº¿ç¨‹å³çº¿ç¨‹Aé€€å‡ºåŒæ­¥ä»£ç å—å¹¶ä¸”å°†é”é‡Šæ”¾ä¹‹åæ‰ä¼šå»å”¤é†’é˜»å¡çŠ¶æ€çš„çº¿ç¨‹Bï¼›ä»è€Œç¬¬äºŒä¸ªçº¿ç¨‹çº¿ç¨‹Bæ‰èƒ½å¤Ÿæœ‰æœºä¼šå†æ¬¡è·å–é”ä»è€Œè¿›å…¥åŒæ­¥ä»£ç å—ä¸­ï¼›<br>çº¿ç¨‹çš„é˜»å¡å’Œå”¤é†’æ˜¯éœ€è¦CPUä»ç”¨æˆ·æ€åˆ‡æ¢è‡³å†…æ ¸æ€çš„ï¼›<br>é¢‘ç¹çš„çŠ¶æ€åˆ‡æ¢å¯¹äºCPUçš„å¼€é”€æ¥è¯´ä¹Ÿæ˜¯æ¯”è¾ƒå¤§çš„ï¼›<br>å¹¶ä¸”è™šæ‹Ÿæœºå¼€å‘å›¢é˜Ÿä¹Ÿå‘ç°å…¶å®å¤§éƒ¨åˆ†æƒ…å†µä¸‹çº¿ç¨‹å¯¹å…±äº«èµ„æºçš„æ“ä½œæ‰€æŒç»­çš„æ—¶é—´æ˜¯æ¯”è¾ƒçŸ­çš„ï¼›å³ä¹Ÿå°±æ˜¯è¯´è¿›å…¥åŒæ­¥ä»£ç å—åˆ°é€€å‡ºåŒæ­¥ä»£ç å—é‡Šæ”¾é”çš„æ—¶é—´ä¹Ÿæ˜¯æ¯”è¾ƒçŸ­çš„ï¼›<br>é‚£ä¹ˆä¹‹å‰éƒ½æ˜¯æ‰§è¡Œæ‰§è¡ŒåŒæ­¥ä»£ç å—è€Œè®©å…¶ä»–æ²¡æœ‰è·å–å¾—åˆ°é”çš„çº¿ç¨‹è¿›è¡Œç­‰å¾…é˜»å¡çŠ¶æ€ï¼›é‚£ä¹ˆè¿™æ ·å…¶å®æ˜¯ä¸åˆ’ç®—çš„ï¼›</p><p>å…·ä½“æ¥è¯´æ˜¯è¿™æ ·çš„ï¼š<br>å‡è®¾ç¬¬ä¸€ä¸ªçº¿ç¨‹Aè·å–å¾—åˆ°é”å¹¶è¿›å…¥åŒæ­¥ä»£ç å—å½“ä¸­å»æ‰§è¡Œï¼Œå¾ˆå¿«å°±å¯ä»¥æ‰§è¡Œå®Œæˆï¼›<br>ä½†æ˜¯ä¸æ­¤åŒæ—¶æ¥äº†ç¬¬äºŒä¸ªçº¿ç¨‹çº¿ç¨‹Bï¼›è€Œæ­¤æ—¶çº¿ç¨‹Aå¹¶æ²¡æœ‰é‡Šæ”¾é”ï¼›æ‰€ä»¥çº¿ç¨‹Bæ²¡æœ‰è·å¾—é”ä»è€Œè¿›å…¥é˜»å¡çŠ¶æ€ï¼›å¯èƒ½åœ¨çº¿ç¨‹Bè¿˜æ²¡æœ‰è¿›å…¥åˆ°é˜»å¡çŠ¶æ€æ—¶è¿™ä¸ªçº¿ç¨‹Aå°±å·²ç»æ‰§è¡Œå®Œå¹¶ä¸”å°†é”è¿›è¡Œé‡Šæ”¾äº†ï¼›<br>é‚£ä¹ˆå¯¹äºå¤–é¢é™·å…¥ç­‰å¾…é˜»å¡çš„çº¿ç¨‹Bæ¥è¯´å°±å¼€é”€è¾ƒå¤§å¹¶ä¸”æ¯”è¾ƒè€—è´¹èµ„æºï¼›<br>å…¶å®è¿™ä¸ªæ—¶å€™åªè¦è®©å¤–é¢è¿™ä¸ªçº¿ç¨‹Båœ¨åŒæ­¥ä»£ç å—å¤–é¢å¤šå¾ªç¯å‡ æ¬¡å¤šå°è¯•ä¸€ä¸‹å°±æœ‰å¯èƒ½è·å–å¾—åˆ°é”ï¼›å°±ä¸å¿…è¦è®©å¤–é¢è¿™ä¸ªçº¿ç¨‹Bè¿›å…¥é˜»å¡çŠ¶æ€ï¼›ä»¥åŠåé¢è¿˜è¦å»å”¤é†’å®ƒï¼Œæµªè´¹èµ„æºï¼›</p><p>ä¸¾ä¸ªä¾‹å­ï¼š<br>åœ¨ç«è½¦ä¸Šçš„ä¸€é—´å«ç”Ÿé—´å½“ä¸­ï¼›<br>å‡è®¾æœ‰ä¸¤ä¸ªäººåˆ†åˆ«æ˜¯å«åšAç”¨æˆ·å’ŒBç”¨æˆ·ï¼›<br>é‚£ä¹ˆæ­¤æ—¶Aç”¨æˆ·å…ˆè¿›å…¥åˆ°ç«è½¦çš„è¿™ä¸€é—´å«ç”Ÿé—´å½“ä¸­ï¼›å¹¶ä¸”å°†å«ç”Ÿé—´çš„é—¨ç»™é”ä¸Šäº†ï¼›<br>åé¢æ¥äº†çš„ç¬¬äºŒä¸ªäººå³ç”¨æˆ·Bï¼Œä»ä»–çš„ä½ç½®ä¸Šèµ°è¿‡æ¥åˆ°å«ç”Ÿé—´ï¼Œè¡¨ç¤ºä¹Ÿæƒ³è¦ä¸Šå•æ‰€ï¼›<br>ä½†æ˜¯ç”¨æˆ·Bå‘ç°æ­¤æ—¶å«ç”Ÿé—´çš„é—¨å·²ç»è¢«é”ä¸Šäº†ï¼›æ‰€ä»¥ç”¨æˆ·Båˆä»å«ç”Ÿé—´å›åˆ°äº†ä»–è‡ªå·±çš„ä½ç½®ä¸Šå»äº†ï¼›<br>é‚£ä¹ˆæ­¤æ—¶å°±æœ‰è¿™æ ·ä¸€ç§æƒ…å†µå‘ç”Ÿï¼š<br>å½“ç”¨æˆ·Aè¿›è¡Œä¸Šå«ç”Ÿé—´åªéœ€è¦èŠ±è´¹10ç§’é’Ÿçš„æ—¶é—´ï¼›<br>è€Œç”¨æˆ·Bä»ä½ç½®ä¸Šåˆ°è¾¾å«ç”Ÿé—´å¯èƒ½éœ€è¦èŠ±è´¹30ç§’çš„æ—¶é—´ï¼›<br>å½“ç”¨æˆ·Aè¿›å…¥åˆ°å«ç”Ÿé—´å¹¶å°†å«ç”Ÿé—´çš„é—¨é”ä¸Šçš„æ—¶å€™ï¼›10ç§’é’Ÿè¿˜æ²¡æœ‰æ‰§è¡Œå®Œï¼›<br>ä¸æ­¤åŒæ—¶ç”¨æˆ·Bä»ä½ç½®ä¸Šèµ°åˆ°å«ç”Ÿé—´èŠ±è´¹äº†30ç§’çš„æ—¶é—´ï¼Œå‘ç°å«ç”Ÿé—´çš„é—¨è¢«é”ä¸Šäº†ï¼›æ‰€ä»¥åˆä»å«ç”Ÿé—´è¿”å›åˆ°å…¶ä½ç½®ä¸Šå»èŠ±è´¹äº†30ç§’é’Ÿçš„æ—¶é—´ï¼›<br>å…¶å®ç”¨æˆ·Aä¹Ÿè®¸10ç§’é’Ÿä¹‹åå°±å¯ä»¥ä»å«ç”Ÿé—´ä¸­å‡ºæ¥äº†ï¼›é‚£ä¹ˆå³ç”¨æˆ·Bå°±æµªè´¹äº†ä¸€éƒ¨åˆ†çš„æ—¶é—´èµ„æºï¼›<br>è¿™ä¸ªä¾‹å­å…¶å®å°±ç›¸å½“äºæ˜¯é‡é‡çº§é”ï¼›<br>é‚£ä¹ˆå…¶å®ä¹Ÿè¿˜å¯ä»¥è¿™ä¹ˆåšï¼Œå½“ç”¨æˆ·Aè¿›å…¥å«ç”Ÿé—´å¹¶å°†é—¨é”ä¸Šçš„æ—¶å€™ï¼›ç”¨æˆ·Bä»ä½ç½®ä¸Šèµ°åˆ°å«ç”Ÿé—´æ¥çœ‹åˆ°å«ç”Ÿé—´çš„é—¨è¢«é”ä½ï¼Œç¬¬ä¸€æ—¶é—´å¹¶ä¸æ˜¯åˆè¿”å›åˆ°ä½ç½®ä¸Šé¢å»è¿™æ ·èŠ±è´¹çš„æ—¶é—´å¤ªé•¿äº†ï¼›è€Œæ˜¯åœ¨å«ç”Ÿé—´çš„é—¨å£è¿›è¡Œç­‰å¾…ï¼›è€Œä¸”å¯ä»¥æ¯éš”ä¸€ç§’æ•²ä¸€ä¸‹é—¨çœ‹é—¨å†…çš„ç”¨æˆ·Aæ˜¯å¦ç”¨å®Œäº†å«ç”Ÿé—´å¯ä»¥å‡ºæ¥ï¼›å³å¦‚æœç”¨æˆ·Aæ²¡æœ‰å‡ºé—¨åˆ™å¯ä»¥å†éš”ä¸€ç§’é’Ÿå†æ¬¡æ•²ä¸€ä¸‹é—¨ï¼Œå¦‚æœç”¨æˆ·Aä»ç„¶è¿˜æ²¡æœ‰å‡ºæ¥é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ç”¨æˆ·Båˆè¿‡ä¸€ç§’å†æ¬¡æ•²ä¸€ä¸‹é—¨ï¼Œå¦‚æœç”¨æˆ·Aå‡ºæ¥äº†é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å«ç”Ÿé—´å¤–çš„ç”¨æˆ·Bå°±å¯ä»¥è¿›å»äº†ï¼›<br>é‚£ä¹ˆå¯ä»¥çœ‹åˆ°å«ç”Ÿé—´å¤–çš„ç”¨æˆ·Båªè¦åœ¨é—¨å£ç­‰å¤šå°è¯•å‡ æ¬¡å°±å¯ä»¥è·å–å¾—åˆ°é”ï¼›<br>å°±é¿å…äº†ä»å«ç”Ÿé—´åˆèµ°åˆ°ä½ç½®ä¸ŠèŠ±äº†30ç§’çš„æ—¶é—´ï¼›</p><p>è¦è®©å¤–é¢çš„çº¿ç¨‹ä¸è¿›è¡Œé˜»å¡ï¼›è€Œæ˜¯å¾ªç¯å‡ æ¬¡æ¥è¿›è¡ŒæŠ¢é”ï¼›<br>é‚£ä¹ˆå°±éœ€è¦ä¿è¯æœ¬æœºæ˜¯ä¸€ä¸ªå¤šæ ¸CPUï¼Œèƒ½å¤Ÿè®©ä¸¤ä¸ªæˆ–ä»¥ä¸Šçš„çº¿ç¨‹æ¥è¿›è¡Œå¹¶è¡Œæ‰§è¡Œï¼›<br>è¿™æ ·å°±å¯ä»¥çº¿ç¨‹Aåœ¨åŒæ­¥ä»£ç å—å†…è¿›è¡Œæ‰§è¡Œä»£ç ï¼›è€Œå¦å¤–å…¶ä»–çš„çº¿ç¨‹Båˆ™åœ¨åŒæ­¥ä»£ç å—å¤–è¿›è¡Œå°è¯•çš„æ¥è¿›è¡Œè·å–é”ï¼›<br>å³åŒæ­¥ä»£ç å—å¤–é¢çš„çº¿ç¨‹Bå°±ä¸ä¼šè¿›å…¥åˆ°é˜»å¡çŠ¶æ€ä¸­å»ï¼›<br>è¿™æ ·çš„è¯å¯èƒ½æ€§èƒ½å¼€é”€å°±å°ä¸€ç‚¹ï¼›<br>é‚£ä¹ˆè®©åŒæ­¥ä»£ç å—å¤–é¢çš„çº¿ç¨‹Bè¿›è¡Œå¤šæ¬¡å°è¯•æŠ¢é”çš„è¿™ä¸ªè¿‡ç¨‹å°±å«åšè‡ªæ—‹ï¼›<br>é‚£ä¹ˆæ”¯æŒè¿™ç§è‡ªæ—‹çš„é”å°±ç§°ä¹‹ä¸ºè‡ªæ—‹é”ï¼›<br>å¦å¤–è¿˜éœ€è¦æ³¨æ„çš„æ˜¯å¾ªç¯æ˜¯å¾ˆå¿«çš„æ‰€ä»¥å°±éœ€è¦è®©è¿™ä¸ªå¾ªç¯å°½é‡æ…¢ä¸€ç‚¹ï¼›å³è®©è¿™ä¸ªå¾ªç¯é”èŠ±è´¹çš„æ—¶é—´å°½é‡é•¿ä¸€ç‚¹ï¼›<br>é‚£ä¹ˆä¹Ÿå°±çŸ¥é“äº†è‡ªæ—‹é”åœ¨ä¸€å®šæƒ…å†µä¸‹æ˜¯å¯ä»¥å‡å°æ€§èƒ½å¼€é”€çš„ï¼›</p><h3 id="ç›®æ ‡-20"><a href="#ç›®æ ‡-20" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>å­¦ä¹ è‡ªæ—‹é”çš„åŸç†</p><h3 id="è‡ªæ—‹é”åŸç†"><a href="#è‡ªæ—‹é”åŸç†" class="headerlink" title="è‡ªæ—‹é”åŸç†"></a>è‡ªæ—‹é”åŸç†</h3><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">synchronized(<span class="module-access"><span class="module"><span class="identifier">Demo01</span>.</span></span><span class="keyword">class</span>)&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"aaa"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‰é¢è®¨è®º monitorå®ç°é” çš„æ—¶å€™ï¼ŒçŸ¥é“ monitorä¼šé˜»å¡å’Œå”¤é†’çº¿ç¨‹ï¼Œ<br>çº¿ç¨‹çš„é˜»å¡å’Œå”¤é†’ éœ€è¦CPUä»ç”¨æˆ·æ€è½¬åŒ–ä¸ºæ ¸å¿ƒæ€ï¼Œ<br>é¢‘ç¹çš„é˜»å¡å’Œå”¤é†’å¯¹CPUæ¥è¯´ æ˜¯ä¸€ä»¶è´Ÿæ‹…å¾ˆé‡çš„å·¥ä½œã€‚<br>è¿™äº›æ“ä½œç»™ç³»ç»Ÿçš„å¹¶å‘æ€§èƒ½ å¸¦æ¥äº†å¾ˆå¤§çš„å‹åŠ›ã€‚<br>åŒæ—¶ï¼Œè™šæ‹Ÿæœºçš„å¼€å‘å›¢é˜Ÿä¹Ÿæ³¨æ„åˆ°åœ¨è®¸å¤šåº”ç”¨ä¸Šï¼Œå…±äº«æ•°æ®çš„é”å®šçŠ¶æ€åªä¼šæŒç»­å¾ˆçŸ­çš„ä¸€æ®µæ—¶é—´ï¼Œä¸ºäº†è¿™æ®µæ—¶é—´é˜»å¡å’Œå”¤é†’çº¿ç¨‹å¹¶ä¸å€¼å¾—ã€‚<br>å¦‚æœç‰©ç†æœºå™¨æœ‰ä¸€ä¸ªä»¥ä¸Šçš„å¤„ç†å™¨ï¼Œèƒ½è®©ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„çº¿ç¨‹åŒæ—¶å¹¶å‘æ‰§è¡Œï¼Œ<br>å°±å¯ä»¥è®©åé¢è¯·æ±‚é”çš„é‚£ä¸ªçº¿ç¨‹ â€œç¨ç­‰ä¸€ä¸‹â€ï¼Œ<br>ä½†ä¸æ”¾å¼ƒå¤„ç†å™¨çš„æ‰§è¡Œæ—¶é—´ï¼Œçœ‹çœ‹æŒæœ‰é”çš„çº¿ç¨‹ æ˜¯å¦å¾ˆå¿«å°±ä¼šé‡Šæ”¾é”ã€‚<br>ä¸ºäº†è®©çº¿ç¨‹ç­‰å¾…ï¼Œåªéœ€è®©çº¿ç¨‹æ‰§è¡Œä¸€ä¸ªå¿™å¾ªç¯ï¼ˆè‡ªæ—‹ï¼‰ï¼Œè¿™é¡¹æŠ€æœ¯å°±æ˜¯æ‰€è°“çš„è‡ªæ—‹é”ã€‚</p><p><strong>è‡ªæ—‹é”</strong>åœ¨<strong>JDK 1.4.2</strong>ä¸­å°±å·²ç»å¼•å…¥ï¼Œåªä¸è¿‡<strong>é»˜è®¤æ˜¯å…³é—­</strong>çš„ï¼Œ<br>å¯ä»¥ä½¿ç”¨<code>-XX:+UseSpinning</code>å‚æ•°æ¥å¼€å¯ï¼Œ<br>åœ¨<strong>JDK 6</strong>ä¸­å°±å·²ç»æ”¹ä¸º<strong>é»˜è®¤å¼€å¯</strong>äº†ã€‚<br>è‡ªæ—‹ç­‰å¾…ä¸èƒ½ä»£æ›¿é˜»å¡ï¼Œä¸”å…ˆä¸è¯´å¤„ç†å™¨æ•°é‡çš„è¦æ±‚ï¼Œè‡ªæ—‹ç­‰å¾…æœ¬èº«è™½ç„¶é¿å…äº†çº¿ç¨‹åˆ‡æ¢çš„å¼€é”€ï¼Œä½†å®ƒæ˜¯è¦å ç”¨å¤„ç†å™¨æ—¶é—´çš„ï¼›<br>å› æ­¤ï¼Œå¦‚æœé”è¢«å ç”¨çš„æ—¶é—´å¾ˆçŸ­ï¼Œè‡ªæ—‹ç­‰å¾…çš„æ•ˆæœå°±ä¼šéå¸¸å¥½ï¼›<br>åä¹‹ï¼Œå¦‚æœé”è¢«å ç”¨çš„æ—¶é—´å¾ˆé•¿ï¼Œé‚£ä¹ˆè‡ªæ—‹çš„çº¿ç¨‹åªä¼šç™½ç™½æ¶ˆè€—å¤„ç†å™¨èµ„æºï¼Œè€Œä¸ä¼šåšä»»ä½•æœ‰ç”¨çš„å·¥ä½œï¼Œåè€Œä¼šå¸¦æ¥æ€§èƒ½ä¸Šçš„æµªè´¹ï¼›<br>å› æ­¤ï¼Œè‡ªæ—‹ç­‰å¾…çš„æ—¶é—´å¿…é¡»è¦æœ‰ä¸€å®šçš„é™åº¦ï¼Œå¦‚æœè‡ªæ—‹è¶…è¿‡äº†é™å®šçš„æ¬¡æ•°ä»ç„¶æ²¡æœ‰æˆåŠŸè·å¾—é”ï¼Œå°±åº”å½“ä½¿ç”¨ä¼ ç»Ÿçš„æ–¹å¼å»æŒ‚èµ·çº¿ç¨‹äº†ã€‚<br>è‡ªæ—‹æ¬¡æ•°çš„é»˜è®¤å€¼æ˜¯10æ¬¡ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨å‚æ•°-XX:PreBlockSpinæ¥æ›´æ”¹ï¼›</p><p>é€šè¿‡å‰é¢çš„å­¦ä¹ ä¸­å¯ä»¥çŸ¥é“è‡ªæ—‹é”ä¸ä¸€å®šæ˜¯æœ€å¥½çš„ï¼Œè€Œæ˜¯åœ¨ï¼ˆæŸäº›æƒ…å†µä¸‹æ¯”è¾ƒå¥½ï¼‰ç‰¹å®šä¸€å®šçš„æ¡ä»¶ä¸‹ï¼›<br>å³åŒæ­¥ä»£ç å—æ‰§è¡Œçš„æ—¶é—´è¾ƒçŸ­ï¼Œä»è€Œèƒ½å¤Ÿå¾ˆå¿«çš„æŠ¢åˆ°é”ï¼›<br>å¦å¤–è¿˜æœ‰å°±æ˜¯ç¡¬ä»¶è¦èƒ½å¤Ÿæ”¯æŒä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„çº¿ç¨‹è¿›è¡Œå¹¶è¡Œæ‰§è¡Œï¼›<br>å³ä¸€ä¸ªçº¿ç¨‹åœ¨åŒæ­¥ä»£ç å—å†…è¿›è¡Œæ‰§è¡Œï¼Œè€Œå¦ä¸€ä¸ªçº¿ç¨‹åˆ™åœ¨åŒæ­¥ä»£ç å—å¤–è¿›è¡Œè‡ªæ—‹å³å°è¯•è·å–é”ï¼›<br>ä½†æ˜¯è‡ªæ—‹ä¹Ÿæ˜¯ä¼šæ¶ˆè€—CPUçš„æ€§èƒ½çš„ï¼›<br>å› ä¸ºè¦åœ¨åŒæ­¥ä»£ç å—å¤–å±‚ä¸æ–­çš„è¿›è¡Œå¾ªç¯é‡è¯•è·å–é”ï¼›<br>å› æ­¤è¿™ä¸ªè‡ªæ—‹é”éœ€è¦å»æ§åˆ¶è¿™ä¸ªè‡ªæ—‹çš„æ—¶é—´æˆ–è€…æ˜¯è¯´è‡ªæ—‹å°è¯•è·å–é”çš„æ¬¡æ•°ï¼›<br>å¦‚æœè‡ªæ—‹çš„æ¬¡æ•°å¤ªå¤šäº†é‚£ä¹ˆå¯¹äºCPUçš„å¼€é”€ä¹Ÿæ˜¯å¾ˆå¤§çš„ï¼›<br>å¦‚æœè‡ªæ—‹çš„æ¬¡æ•°å¤ªå°‘äº†åˆæœ‰å¯èƒ½æŠ¢ä¸åˆ°é”å¯¼è‡´ç™½ç™½è‡ªæ—‹äº†ï¼›<br>è‡ªæ—‹é”é»˜è®¤çš„è‡ªæ—‹æ¬¡æ•°æ˜¯<strong>10æ¬¡</strong>ï¼Œå¯ä»¥é€šè¿‡æ‰‹åŠ¨çš„ä¿®æ”¹JVMçš„å¯åŠ¨å‚æ•°æ¥ä¿®æ”¹é»˜è®¤è‡ªæ—‹çš„æ¬¡æ•°ï¼ˆæ”¹å˜è‡ªæ—‹é”çš„è‡ªæ—‹æ¬¡æ•°ï¼‰ï¼›</p><p>ä½†æ˜¯åˆæœ‰ä¸€ä¸ªé—®é¢˜ï¼šè¿™ä¸ªè‡ªæ—‹é”çš„è‡ªæ—‹æ¬¡æ•°æ”¹æˆå¤šå°‘åˆé€‚å‘¢ï¼Ÿé‚£ä¹ˆè¿™å°±å¾ˆéš¾åˆ¤å®šäº†ï¼›<br>æ”¹å¤šäº†æµªè´¹èµ„æºï¼›æ”¹å°‘äº†åˆæ²¡æœ‰æŠ¢åˆ°é”ä¹Ÿæ˜¯æµªè´¹èµ„æºï¼›æ‰€ä»¥è¿™ä¸ªè‡ªæ—‹çš„æ¬¡æ•°å°±å¾ˆéš¾æ¥åˆ¤æ–­äº†ï¼›å› æ­¤åœ¨JDK6ä¸­å¼•å…¥äº†è‡ªé€‚åº”è‡ªæ—‹é”ï¼›</p><h3 id="é€‚åº”æ€§è‡ªæ—‹é”"><a href="#é€‚åº”æ€§è‡ªæ—‹é”" class="headerlink" title="é€‚åº”æ€§è‡ªæ—‹é”"></a>é€‚åº”æ€§è‡ªæ—‹é”</h3><p>åœ¨JDK 6ä¸­å¼•å…¥äº† è‡ªé€‚åº”çš„è‡ªæ—‹é”ã€‚<br>è‡ªé€‚åº” æ„å‘³ç€ è‡ªæ—‹çš„æ—¶é—´ä¸å†å›ºå®šäº†ï¼Œè€Œæ˜¯ç”±å‰ä¸€æ¬¡åœ¨åŒä¸€ä¸ªé”ä¸Šçš„è‡ªæ—‹æ—¶é—´åŠé”çš„æ‹¥æœ‰è€…çš„çŠ¶æ€æ¥å†³å®šã€‚<br>å¦‚æœåœ¨åŒä¸€ä¸ªé”å¯¹è±¡ä¸Šï¼Œè‡ªæ—‹ç­‰å¾…åˆšåˆšæˆåŠŸè·å¾—è¿‡é”ï¼Œå¹¶ä¸”æŒæœ‰é”çš„çº¿ç¨‹æ­£åœ¨è¿è¡Œä¸­ï¼Œé‚£ä¹ˆè™šæ‹Ÿæœº å°±ä¼šè®¤ä¸ºè¿™æ¬¡è‡ªæ—‹ä¹Ÿå¾ˆæœ‰å¯èƒ½å†æ¬¡æˆåŠŸï¼Œè¿›è€Œå®ƒå°†å…è®¸è‡ªæ—‹ç­‰å¾…æŒç»­ç›¸å¯¹æ›´é•¿çš„æ—¶é—´ï¼Œæ¯”å¦‚100æ¬¡å¾ªç¯ã€‚<br>å¦å¤–ï¼Œå¦‚æœå¯¹äºæŸä¸ªé”ï¼Œè‡ªæ—‹å¾ˆå°‘æˆåŠŸè·å¾—è¿‡ï¼Œé‚£åœ¨ä»¥åè¦è·å–è¿™ä¸ªé”æ—¶å°†å¯èƒ½çœç•¥æ‰è‡ªæ—‹è¿‡ç¨‹ï¼Œä»¥é¿å…æµªè´¹å¤„ç†å™¨èµ„æºã€‚<br>æœ‰äº†è‡ªé€‚åº”è‡ªæ—‹ï¼Œéšç€ç¨‹åºè¿è¡Œå’Œæ€§èƒ½ç›‘æ§ä¿¡æ¯çš„ä¸æ–­å®Œå–„ï¼Œè™šæ‹Ÿæœºå¯¹ç¨‹åºæœçš„çŠ¶å†µé¢„æµ‹å°±ä¼šè¶Šæ¥è¶Šå‡†ç¡®ï¼Œè™šæ‹Ÿæœºå°±ä¼šå˜å¾—è¶Šæ¥è¶Šâ€œèªæ˜â€äº†ã€‚</p><p>ï¼ˆè‡ªé€‚åº”è‡ªæ—‹é”ä¸­è‡ªæ—‹çš„æ¬¡æ•°æˆ–è€…æ˜¯è‡ªæ—‹çš„æ—¶é—´å°±ä¸å†å›ºå®šäº†ï¼Œè€Œæ˜¯ç”±å‰ä¸€æ¬¡è‡ªæ—‹çš„æ•ˆæœæ¥è¿›è¡Œå†³å®šï¼‰</p><p>ä¸¾ä¸ªä¾‹å­ï¼š<br>å‡è®¾ä¸€ä¸ªçº¿ç¨‹Aåœ¨åŒæ­¥ä»£ç å—ä¸Šï¼Œè‡ªæ—‹äº†10æ¬¡å¹¶ä¸”è·å¾—äº†é”ï¼›é‚£ä¹ˆå°±ä¼šè®¤ä¸ºè¿™ä¸ªåŒæ­¥ä»£ç å—é€šè¿‡è‡ªæ—‹æ˜¯æ¯”è¾ƒå®¹æ˜“è·å¾—é”çš„ï¼›æ‰€ä»¥åœ¨åç»­çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ä¹Ÿä¼šè¿›è¡Œè‡ªæ—‹ï¼›å¹¶ä¸”è¿˜å…è®¸è‡ªæ—‹çš„æ—¶é—´ç¨å¾®é•¿ä¸€ç‚¹ï¼›å› ä¸ºä¹‹å‰å¾—åˆ°è¿‡æ‰€ä»¥æ„Ÿè§‰ç°åœ¨ä¹Ÿèƒ½å¾—åˆ°ï¼›æ‰€ä»¥è‡ªæ—‹çš„æ—¶é—´è¿˜å…è®¸æ›´é•¿ä¸€ç‚¹ï¼›<br>å†ä¸¾ä¸€ä¸ªä¾‹å­ï¼š<br>å‡è®¾æœ‰ä¸€ä¸ªåŒæ­¥ä»£ç å—ï¼Œä½†æ˜¯è‡ªæ—‹ä»æ¥å°±æ²¡æœ‰åœ¨è¿™ä¸ªåŒæ­¥ä»£ç å—ä¸ŠæˆåŠŸè·å–è¿‡é”è¿‡ï¼›æ‰€ä»¥jvmå°±ä¼šè®¤ä¸ºè¿™ä¸ªåŒæ­¥ä»£ç å—å¾ˆéš¾é€šè¿‡è‡ªæ—‹æ¥è·å–å¾—åˆ°é”ï¼›å¹²è„†å°±ä¸å†è¿›è¡Œè‡ªæ—‹äº†ï¼›é‚£ä¹ˆè¿™æ ·å°±å¯ä»¥é¿å…æ€§èƒ½çš„æµªè´¹ï¼›å³æ‰€ä»¥è‡ªæ—‹é”ä¹Ÿæ˜¯è¶Šæ¥è¶Šâ€èªæ˜â€äº†ï¼›<br>monitoråœ¨è¿›å…¥ç«äº‰çš„æ—¶å€™ä¼šè¿›å…¥ObjectMonitor::enter(TRAPS)æ¥è¿›è¡Œç«äº‰ï¼›<br>è¯¥æ–¹æ³•ä¸­å‰ä¸€éƒ¨åˆ†æ˜¯æŠ¢åˆ°é”çš„æƒ…å†µï¼›åä¸€éƒ¨åˆ†æ˜¯æ²¡æœ‰æŠ¢åˆ°é”çš„æƒ…å†µï¼›<br>å½“æ²¡æœ‰æŠ¢åˆ°é”çš„æ—¶å€™ä¼šè¿›å…¥åˆ°EnterI(THREAD)æ–¹æ³•æ¥è¿›è¡Œçº¿ç¨‹çš„é˜»å¡ä»¥åŠæŒ‚èµ·ç­‰æ“ä½œï¼›<br>åœ¨EnterI(THREAD)å½“ä¸­å°±å‡†å¤‡è®©çº¿ç¨‹è¿›è¡Œé˜»å¡ï¼Œä½†æ˜¯åœ¨é˜»å¡ä¹‹å‰é¦–å…ˆè¿˜æ˜¯ä¼šå»è¿›è¡Œå°è¯•è·å–é”ï¼›å¦‚æœè¿˜æ˜¯è·å–ä¸åˆ°é”åˆ™è¿›å…¥TrySpin(Self)ï¼Œå³å°±æ˜¯å»è¿›è¡Œè‡ªæ—‹ï¼›<br>é‚£ä¹ˆæ¥ç€çœ‹TrySpin(Self)è¿›è¡Œäº†ä»€ä¹ˆæ“ä½œï¼›</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">#define TrySpin TrySpin_VaryDuration</span><br><span class="line"><span class="comment">// æ’å®šä¹‰å¯¹äºå¦å¤–ä¸€ä¸ªå‡½æ•°å³TrySpin_VaryDurationï¼›</span></span><br><span class="line">------------------------------------------------</span><br><span class="line"><span class="comment">//TrySpin_VaryDurationæ—¶é—´ä¸å›ºå®šçš„å°è¯•è‡ªæ—‹é”</span></span><br><span class="line"><span class="built_in">int</span> ObjectMonitor::TrySpin_VaryDuration(Thread * Self)&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Dumb , brutal spin, Good for comparative measurements against adaptive spinning.</span></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">  Knob_FixedSpinè‡ªæ—‹å›ºå®šçš„æ¬¡æ•°</span></span><br><span class="line"><span class="comment">  å¦‚è‡ªæ—‹å›ºå®šçš„æ¬¡æ•°ä¸ç­‰äº0é‚£ä¹ˆå°±ä¼šè¿›å…¥å¾ªç¯æ¥è¿›è¡Œè‡ªæ—‹ï¼›</span></span><br><span class="line"><span class="comment">  ç„¶åæ¯æ¬¡å¾ªç¯ä¸€æ¬¡å°±è®©æ•°é‡å‡å»ä¸€ï¼›</span></span><br><span class="line"><span class="comment">  æ¯æ¬¡è‡ªæ—‹ä¸€ä¸‹å°±è¦å»TryLockä¸€ä¸‹å°è¯•ä¸€ä¸‹å»è·å–é”ï¼›</span></span><br><span class="line"><span class="comment">  å°è¯•è·å–ä¸åˆ°é”åˆ™è‡ªæ—‹çš„æ—¶å€™ç¨å¾®èŠ±ç‚¹æ—¶é—´ç­‰å¾…ä¸€ä¸‹å³è°ƒç”¨SpinPause()æ–¹æ³•ï¼›</span></span><br><span class="line"><span class="comment">  å†æ¥ç€ä¸‹ä¸€æ¬¡è‡ªæ—‹ï¼›</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆè¿™ä¸ªå°±å±äºä¹‹å‰æ‰€è¯´çš„å›ºå®šçš„è‡ªæ—‹æ¬¡æ•°ä»¥åŠå›ºå®šçš„è‡ªæ—‹æ—¶é—´ï¼›</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="built_in">int</span> ctr = Knob_FixedSpin ;</span><br><span class="line">  <span class="keyword">if</span>( ctr != <span class="number">0</span> )&#123;</span><br><span class="line">    <span class="keyword">while</span>( --ctr &gt;= <span class="number">0</span>)&#123;</span><br><span class="line">      <span class="keyword">if</span>(TryLock(Self) &gt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">      SpinPause();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">  ä»¥ä¸‹çš„è¿™ä¸ªå¾ªç¯å°±æ˜¯æ‰€æ¨å‡ºçš„é€‚åº”æ€§è‡ªæ—‹é”ï¼›</span></span><br><span class="line"><span class="comment">  é¦–å…ˆæ¥è¿›è¡Œçœ‹åˆ°é€‚åº”æ€§è‡ªæ—‹é”çš„è‡ªæ—‹æ¬¡æ•°æ˜¯å¤šå°‘ï¼›</span></span><br><span class="line"><span class="comment">  åœ¨objectMonitor.cppå½“ä¸­ç»™Knob_PreSpinè®¾ç½®äº†é»˜è®¤å€¼ä¸º10æ¬¡ï¼š</span></span><br><span class="line"><span class="comment">  static int Knob_PreSpin = 10; // 20 - 100 likely better</span></span><br><span class="line"><span class="comment">  å¹¶ä¸”æ³¨é‡Šæ¨è20åˆ°100æ¬¡çš„è‡ªæ—‹æ¬¡æ•°æ˜¯æ¯”è¾ƒåˆé€‚çš„ï¼›</span></span><br><span class="line"><span class="comment">  è‡ªæ—‹æ¬¡æ•°æ˜¯10æ¬¡ï¼Œæ¯æ¬¡è‡ªæ—‹ä¸€æ¬¡å°±ä¼šå»è¿›è¡Œå°è¯•ä¸€æ¬¡çœ‹èƒ½ä¸èƒ½æŠ¢å¾—åˆ°é”ï¼›</span></span><br><span class="line"><span class="comment">  å¦‚æœæŠ¢åˆ°äº†é”é‚£ä¹ˆå°±å›å»ä¿®æ”¹è‡ªæ—‹çš„æ—¶é—´ï¼Œå®ƒå°±ä¼šå»å…è®¸è‡ªæ—‹çš„æ—¶é—´æ¯”ä»¥å‰è‡ªæ—‹çš„æ—¶é—´ç¨å¾®é•¿ä¸€ç‚¹ï¼›</span></span><br><span class="line"><span class="comment">  å› ä¸ºè¿™æ¬¡é€šè¿‡è‡ªæ—‹æŠ¢åˆ°äº†é‚£ä¹ˆä¸‹ä¸€æ¬¡ä¹Ÿæœ‰å¯èƒ½æŠ¢åˆ°ï¼›</span></span><br><span class="line"><span class="comment">  æ‰€ä»¥å®ƒå…è®¸è‡ªæ—‹æ‰€èŠ±çš„æ—¶é—´åŠ é•¿ä¸€ç‚¹ï¼›</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆå¦‚æœæ²¡æœ‰åœ¨ä¸€æ¬¡è‡ªæ—‹å½“ä¸­å³å¾ªç¯çš„ä¸€æ¬¡å°è¯•å½“ä¸­æ²¡æœ‰è·å–å¾—åˆ°é”ï¼›</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±ä¼šå»è°ƒç”¨SpinPause()å³è¿›å…¥è‡ªæ—‹çš„ä¸€ä¸ªç­‰å¾…ï¼›</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">for</span>( ctr = Knob_PreSpin + <span class="number">1</span>; --ctr &gt;= <span class="number">0</span> ; )&#123;</span><br><span class="line">    <span class="keyword">if</span>( TryLock(Self) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">      <span class="comment">// Increase _SpinDuration ...</span></span><br><span class="line">      <span class="comment">// Note that we don't clamp SpinDuration precisely at SpinLimit.</span></span><br><span class="line">      <span class="comment">// Raising _SpurDuration to the poverty line is key.</span></span><br><span class="line">      <span class="built_in">int</span> x = _SpinDuration ;</span><br><span class="line">      <span class="keyword">if</span>(x &lt; Knob_SpinLimit)&#123;</span><br><span class="line">        <span class="keyword">if</span>( x &lt; Knob_Poverty) x = Knob_Poverty ;</span><br><span class="line">        _SpinDuration = x + Knob_BonusB ;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    SpinPause();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="synchronizedä¼˜åŒ–-é”æ¶ˆé™¤"><a href="#synchronizedä¼˜åŒ–-é”æ¶ˆé™¤" class="headerlink" title="synchronizedä¼˜åŒ–-é”æ¶ˆé™¤"></a>synchronizedä¼˜åŒ–-é”æ¶ˆé™¤</h2><h3 id="å›é¡¾å¹¶å¼•å…¥-3"><a href="#å›é¡¾å¹¶å¼•å…¥-3" class="headerlink" title="å›é¡¾å¹¶å¼•å…¥"></a>å›é¡¾å¹¶å¼•å…¥</h3><p>åœ¨JDK6ä¸­ï¼Œå¯¹synchronizedåšäº†ä¸€ä¸ªä¼˜åŒ–ï¼Œå³ä¼šæœ‰ä¸€ä¸ªé”å‡çº§ï¼ˆæ— é”-åå‘é”-è½»é‡çº§é”-é‡é‡çº§é”ï¼‰çš„è¿‡ç¨‹ï¼›<br>é‚£ä¹ˆåœ¨JDK6å½“ä¸­é™¤äº†è¿™ä¸ªé”å‡çº§çš„ä¼˜åŒ–ä¹‹åè¿˜ä¼šæœ‰ä¸€ä¸ªé”æ¶ˆé™¤çš„ä¼˜åŒ–ï¼›</p><h3 id="ç›®æ ‡-21"><a href="#ç›®æ ‡-21" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>å­¦ä¹ é”æ¶ˆé™¤çš„åŸç†</p><p>é”æ¶ˆé™¤ æ˜¯æŒ‡ è™šæ‹Ÿæœº å³æ—¶ç¼–è¯‘å™¨ï¼ˆJITï¼‰åœ¨ è¿è¡Œæ—¶ï¼Œ<br>å¯¹ä¸€äº›ä»£ç ä¸Šè¦æ±‚åŒæ­¥ï¼Œä½†æ˜¯è¢«æ£€æµ‹åˆ° ä¸å¯èƒ½å­˜åœ¨å…±äº«æ•°æ®ç«äº‰çš„é” è¿›è¡Œæ¶ˆé™¤ã€‚</p><p>é”æ¶ˆé™¤ çš„ä¸»è¦åˆ¤å®šä¾æ® æ¥æºäº é€ƒé€¸åˆ†æçš„æ•°æ®æ”¯æŒï¼Œ<br>å¦‚æœåˆ¤æ–­åœ¨ä¸€æ®µä»£ç ä¸­ï¼Œå †ä¸Šçš„æ‰€æœ‰æ•°æ® éƒ½ä¸ä¼šé€ƒé€¸å‡ºå» ä»è€Œè¢«å…¶ä»–çº¿ç¨‹ è®¿é—®åˆ°ï¼Œé‚£å°±å¯ä»¥æŠŠå®ƒä»¬å½“åšæ ˆä¸Šæ•°æ®å¯¹å¾…ï¼Œè®¤ä¸ºå®ƒä»¬æ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œ<br>åŒæ­¥åŠ é” è‡ªç„¶å°±æ— éœ€è¿›è¡Œã€‚</p><p>å˜é‡æ˜¯å¦é€ƒé€¸ï¼Œå¯¹äºè™šæ‹Ÿæœºæ¥è¯´ éœ€è¦ä½¿ç”¨ æ•°æ®æµåˆ†ææ¥ç¡®å®šï¼Œä½†æ˜¯ç¨‹åºå‘˜è‡ªå·±åº”è¯¥æ˜¯å¾ˆæ¸…æ¥šçš„ï¼Œæ€ä¹ˆä¼šåœ¨ æ˜çŸ¥é“ä¸å­˜åœ¨æ•°æ®äº‰ç”¨çš„æƒ…å†µä¸‹ è¦æ±‚åŒæ­¥å‘¢ï¼Ÿ</p><p>å®é™…ä¸Šæœ‰è®¸å¤šåŒæ­¥æªæ–½å¹¶ä¸æ˜¯ç¨‹åºå‘˜è‡ªå·±åŠ å…¥çš„ï¼ŒåŒæ­¥çš„ä»£ç åœ¨Javaç¨‹åºä¸­çš„æ™®éç¨‹åº¦ä¹Ÿè®¸è¶…è¿‡äº†å¤§éƒ¨åˆ†è¯»è€…çš„æƒ³è±¡ã€‚<br>ä¸‹é¢è¿™æ®µéå¸¸ç®€å•çš„ä»£ç ä»…ä»…æ˜¯è¾“å‡º3ä¸ªå­—ç¬¦ä¸²ç›¸åŠ çš„ç»“æœï¼Œæ— è®ºæ˜¯æºç å­—é¢ä¸Šè¿˜æ˜¯ç¨‹åºè¯­ä¹‰ä¸Šéƒ½æ²¡æœ‰åŒæ­¥ã€‚</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">-----------------------------------------------------------</span><br><span class="line"><span class="keyword">public</span> class Demo01&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="keyword">String</span>[] args)&#123;</span><br><span class="line">    concatString(<span class="string">"aa"</span> , <span class="string">"bb"</span> , <span class="string">"cc"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> concatString(<span class="keyword">String</span> s1, <span class="keyword">String</span> s2, <span class="keyword">String</span> s3)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> StringBuffer().<span class="built_in">append</span>(s1).<span class="built_in">append</span>(s2).<span class="built_in">append</span>(s3).toString();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">-----------------------------------------------------------</span><br><span class="line">ä»£ç åˆ†æconcatString()è¯¥æ–¹æ³•ï¼š</span><br><span class="line">StringBuffer.<span class="built_in">append</span>()æ–¹æ³•æ˜¯åŒæ­¥çš„ï¼›</span><br><span class="line">-----------------------------------------------------------</span><br><span class="line">StringBuffer.java</span><br><span class="line">@Override</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> StringBuffer <span class="built_in">append</span>(<span class="keyword">String</span> <span class="built_in">str</span>)&#123;</span><br><span class="line">  toStringCache = <span class="keyword">null</span>;</span><br><span class="line">  <span class="keyword">super</span>.<span class="built_in">append</span>(<span class="built_in">str</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line">-----------------------------------------------------------</span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶å¯ä»¥çœ‹åˆ°StringBufferçš„<span class="built_in">append</span>()æ–¹æ³•ä½¿ç”¨äº†<span class="keyword">synchronized</span>è¿›è¡Œäº†åŒæ­¥å¤„ç†ï¼›</span><br><span class="line">è€ŒconcatStringå½“ä¸­è¿›è¡Œè°ƒç”¨äº†ä¸‰æ¬¡<span class="built_in">append</span>()æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¡¨æ˜ä¼šè¿›è¡Œæ‰§è¡Œä¸‰æ¬¡çš„è¿™ä¸ªåŒæ­¥æ–¹æ³•ï¼›</span><br><span class="line">å®é™…ä¸Šå†æ¥ä»”ç»†è§‚å¯Ÿä¸€ä¸‹concatString()æ–¹æ³•ï¼›</span><br><span class="line">ä¸‰ä¸ª<span class="built_in">append</span>()æ–¹æ³•è°ƒç”¨è€…æ˜¯è°ï¼Ÿ</span><br><span class="line">å³<span class="keyword">new</span> StringBuffer è¯¥å¯¹è±¡è¿›è¡Œè°ƒç”¨çš„<span class="built_in">append</span>()æ–¹æ³•ï¼›</span><br><span class="line">ä¹Ÿå°±æ˜¯StringBufferçš„<span class="built_in">append</span>()æ–¹æ³•å³æ™®é€šçš„åŒæ­¥æ–¹æ³•å®ƒæ‰€ä½¿ç”¨çš„å¯¹è±¡é”å³ä¸º<span class="keyword">this</span>ï¼›</span><br><span class="line">è€Œè¿™ä¸ª<span class="keyword">this</span>å¯¹è±¡å…¶å®ä¹Ÿå°±æ˜¯è¿™ä¸ª<span class="built_in">append</span>()æ–¹æ³•çš„è°ƒç”¨è€…ï¼Œä¹Ÿå°±æ˜¯<span class="keyword">new</span> StringBuffer()ï¼Œå³å¯¹è±¡é”å°±æ˜¯è¿™ä¸ª<span class="keyword">new</span> StringBuffer()ï¼›</span><br><span class="line">è€Œæ¥ç€åˆ†æconcatString()æ–¹æ³•å½“ä¸­çš„<span class="keyword">new</span> StringBuffer()æ˜¯concatString()æ–¹æ³•å½“ä¸­æ‰€<span class="keyword">new</span>å‡ºæ¥çš„å±€éƒ¨å˜é‡ï¼›</span><br><span class="line">å¹¶æ²¡æœ‰é€ƒé€¸å‡ºconcatString()è¿™ä¸ªæ–¹æ³•ï¼›</span><br><span class="line">é‚£ä¹ˆå°±ç®—ç°åœ¨æœ‰å¤šçº¿ç¨‹æ¥è¿›è¡Œæ‰§è¡Œï¼›å³å½“å‰äº†å­˜åœ¨ä¸¤ä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹Aå’Œçº¿ç¨‹Bï¼›</span><br><span class="line">å‡è®¾çº¿ç¨‹Aå…ˆæ¥è¿›è¡Œæ‰§è¡ŒconcatString()æ–¹æ³•ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™ä¸ªæ—¶å€™çº¿ç¨‹Aå°±ä¼šè¿›å…¥åˆ°concatString()æ–¹æ³•å½“ä¸­<span class="keyword">new</span> StringBuffer()å¯¹è±¡ä½œä¸ºé”æ¥è¿›è¡Œæ¥é”ä½StringBufferç±»å½“ä¸­çš„<span class="built_in">append</span>()æ–¹æ³•ï¼›</span><br><span class="line">é‚£ä¹ˆå‡è®¾CPUåˆ‡æ¢åˆ°çº¿ç¨‹Bä¸Šæ¥ï¼Œé‚£ä¹ˆæ­¤æ—¶çº¿ç¨‹Bä¹Ÿä¼šè¿›å…¥åˆ°concatString()æ–¹æ³•å½“ä¸­æ¥ä¹Ÿè¿›è¡Œ<span class="keyword">new</span> StringBuffer()å¯¹è±¡ä½œä¸ºé”æ¥è¿›è¡Œé”ä½StringBufferç±»çš„<span class="built_in">append</span>()æ–¹æ³•ï¼›</span><br><span class="line">é”å°±æ˜¯å¦å¤–ä¸€ä¸ªå¯¹è±¡äº†ï¼›</span><br><span class="line">ä¹Ÿå°±æ˜¯è¯´concatString()æ–¹æ³•å†…éƒ¨çš„<span class="keyword">new</span> StringBuffer()å¯¹è±¡æ²¡æœ‰é€ƒé€¸å‡ºconcatString()è¿™ä¸ªæ–¹æ³•ï¼›</span><br><span class="line">å°±ç®—æœ‰ä¸åŒçš„çº¿ç¨‹æ¥è¿›è¡Œæ‰§è¡Œï¼Œé‚£ä¹ˆæ¯ä¸ªçº¿ç¨‹ä¹Ÿéƒ½æ˜¯è·å–æ‹¿åˆ°çš„ä¸åŒçš„é”ï¼›</span><br><span class="line">å³æ¯ä¸ªçº¿ç¨‹æ‹¿åˆ°çš„éƒ½æ˜¯ä¸åŒçš„<span class="keyword">new</span> StringBuffer()å¯¹è±¡å³ä¸åŒçš„é”ï¼›</span><br><span class="line">æ‰€ä»¥æ ¹æœ¬ä¸å­˜åœ¨æœ‰ç«äº‰ï¼›</span><br><span class="line">é‚£ä¹ˆæ—¢ç„¶ä¸å­˜åœ¨æœ‰ç«äº‰é‚£ä¹ˆè¿™ä¸ªStringBufferç±»å½“ä¸­çš„<span class="built_in">append</span>()æ–¹æ³•çš„åŒæ­¥ä»£ç å—<span class="keyword">synchronized</span>å°±æ²¡æœ‰å¿…è¦äº†ï¼›</span><br><span class="line">æ‰€ä»¥ä¼šè‡ªåŠ¨è¿›è¡Œæ¶ˆé™¤æ‰è¿™ä¸ªåŒæ­¥ä»£ç å—<span class="keyword">synchronized</span>ï¼›çŸ¥é“æ­¤å¤„æ²¡æœ‰ç«äº‰ï¼›å³è½¬å˜æˆ</span><br><span class="line"></span><br><span class="line">---------------------------------------------------</span><br><span class="line"><span class="keyword">public</span> StringBuffer <span class="built_in">append</span>(<span class="keyword">String</span> <span class="built_in">str</span>)&#123;</span><br><span class="line">  toStringCache = <span class="keyword">null</span>;</span><br><span class="line">  <span class="keyword">super</span>.<span class="built_in">append</span>(<span class="built_in">str</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line">---------------------------------------------------</span><br><span class="line"></span><br><span class="line">å³çº¿ç¨‹Aä¸çº¿ç¨‹Bä¸¤è€…ä¹‹é—´é”ä½StringBufferç±»å½“ä¸­çš„<span class="built_in">append</span>()æ–¹æ³•ä½¿ç”¨çš„ä¸åŒçš„é”ï¼›</span><br><span class="line">å¾ˆæ˜æ˜¾çº¿ç¨‹Aæ‰€<span class="keyword">new</span> StringBuffer()å¯¹è±¡ä¸çº¿ç¨‹Bæ‰€<span class="keyword">new</span> StringBuffer()å¯¹è±¡æ˜¾ç„¶ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œ</span><br><span class="line">è€Œè¿™ä¸ª<span class="keyword">new</span> StringBuffer()å¯¹è±¡ä¹Ÿå°±æ˜¯è°ƒç”¨StringBufferç±»å½“ä¸­çš„<span class="built_in">append</span>()æ–¹æ³•çš„<span class="keyword">this</span>ï¼Œ</span><br><span class="line">ä¹Ÿå°±æ˜¯è¿™ä¸ªåŒæ­¥<span class="keyword">synchronized</span>æ–¹æ³•<span class="built_in">append</span>()çš„å¯¹è±¡é”ï¼›</span><br><span class="line">å³çº¿ç¨‹Aä¸çº¿ç¨‹Bæ‰€è·å–çš„é”ä¸æ˜¯åŒä¸€æŠŠé”ï¼›</span><br><span class="line"></span><br><span class="line">é‚£ä¹ˆè¿™å°±æ˜¯é”æ¶ˆé™¤ï¼›</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆè¿™ä¸ªé”æ¶ˆé™¤æ˜¯è°æ¥è¿›è¡Œå®Œæˆè¿™ä¸€èŒè´£çš„å‘¢ï¼Ÿ<br>é”æ¶ˆé™¤æ˜¯è™šæ‹Ÿæœº å³æ—¶ç¼–è¯‘å™¨JITåœ¨å¯¹ä»£ç æ‰§è¡Œä¹‹å‰ä¹Ÿä¼šå¯¹ä»£ç è¿›è¡Œä¸€ä¸ªç¼–è¯‘æ“ä½œï¼›<br>æœ€ç»ˆå³æ—¶ç¼–è¯‘å™¨ä¼šæ ¹æ®å¯¹è±¡çš„é€ƒé€¸åˆ†ææ¥åˆ¤æ–­ï¼Œå¦‚æœå¯¹è±¡é€ƒé€¸ä¸å‡ºè¿™ä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªé”æ˜¯ä¸å­˜åœ¨ç«äº‰çš„ï¼Œå³é‚£ä¹ˆå°±ä¼šå–æ¶ˆè¿™ä¸ªåŒæ­¥ä»£ç å—ï¼›</p><p>StringBufferçš„append()æ˜¯ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œ<br>é”å°±æ˜¯thisä¹Ÿå°±æ˜¯(new StringBuffer())ã€‚<br>è™šæ‹Ÿæœºå‘ç°å®ƒçš„ åŠ¨æ€ä½œç”¨äºè¢«é™åˆ¶åœ¨ concatString()æ–¹æ³•å†…éƒ¨ã€‚<br>ä¹Ÿå°±æ˜¯è¯´ï¼Œnew StringBuffer()å¯¹è±¡çš„å¼•ç”¨æ°¸è¿œä¸ä¼šâ€œé€ƒé€¸â€åˆ°concatString()æ–¹æ³•ä¹‹å¤–ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•è®¿é—®åˆ°å®ƒï¼Œ<br>å› æ­¤ï¼Œè™½ç„¶è¿™é‡Œæœ‰é”ï¼Œä½†æ˜¯å¯ä»¥è¢«å®‰å…¨åœ°æ¶ˆé™¤æ‰ï¼›<br>åœ¨å³æ—¶ç¼–è¯‘ä¹‹åï¼Œè¿™æ®µä»£ç å°±ä¼šå¿½ç•¥æ‰æ‰€æœ‰çš„åŒæ­¥è€Œæ‰§è¡Œäº†ï¼›</p><h2 id="synchronizedä¼˜åŒ–-é”ç²—åŒ–"><a href="#synchronizedä¼˜åŒ–-é”ç²—åŒ–" class="headerlink" title="synchronizedä¼˜åŒ–-é”ç²—åŒ–"></a>synchronizedä¼˜åŒ–-é”ç²—åŒ–</h2><h3 id="å›é¡¾å¹¶å¼•å…¥-4"><a href="#å›é¡¾å¹¶å¼•å…¥-4" class="headerlink" title="å›é¡¾å¹¶å¼•å…¥"></a>å›é¡¾å¹¶å¼•å…¥</h3><p>é”ç²—åŒ–</p><p>JDK1.6åœ¨å¯¹synchronizedè¿›è¡Œä¼˜åŒ–çš„æ—¶å€™é™¤äº†é”å‡çº§ã€é”æ¶ˆé™¤ï¼›<br>è¿˜ä¼šåšä¸€ä¸ªé”ç²—åŒ–çš„æ“ä½œï¼›</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">----------------------------------------------------------</span><br><span class="line"><span class="keyword">package</span> com.xxx.demo10_lock_coarsing;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> Demo01&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="keyword">String</span>[] args)&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    å»ºè®®åŒæ­¥ä»£ç å—å½“ä¸­çš„ä»£ç å°½é‡çš„å°‘ï¼›</span></span><br><span class="line"><span class="comment">    æ‰§è¡Œçš„æ—¶é—´å°½é‡çš„çŸ­ï¼›</span></span><br><span class="line"><span class="comment">    å¦‚æœåŒæ­¥ä»£ç å—å½“ä¸­çš„ä»£ç å°‘ä¸”æ—¶é—´çŸ­é‚£ä¹ˆåå‘é”å°±æœ‰å¯èƒ½æ»¡è¶³è¦æ±‚ï¼›</span></span><br><span class="line"><span class="comment">    æˆ–è€…è¯´è½»é‡çº§é”å°±èƒ½å¤Ÿæ»¡è¶³è¦æ±‚ï¼›</span></span><br><span class="line"><span class="comment">    æˆ–è€…è¯´åœ¨è‡ªæ—‹çš„æ—¶å€™å°±èƒ½å¤Ÿæ»¡è¶³è¦æ±‚ï¼›</span></span><br><span class="line"><span class="comment">    å°±ä¸ä¼šè¿›å…¥åˆ°é‡é‡çº§é”çš„çŠ¶æ€ï¼›</span></span><br><span class="line"><span class="comment">    ä½†æ˜¯å¾€å¾€å¯èƒ½æƒ…å†µåˆæ¯”è¾ƒç‰¹æ®Šï¼›</span></span><br><span class="line"><span class="comment">    æ¯”å¦‚è¯´ä¸‹é¢çš„æƒ…å†µï¼›</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="comment">//synchronized(Demo01.class)&#123;</span></span><br><span class="line">    <span class="comment">//  System.out.println("aaa");</span></span><br><span class="line">    <span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     åœ¨å¾ªç¯å¤–å±‚new StringBuffer()ï¼›</span></span><br><span class="line"><span class="comment">     åœ¨å¾ªç¯å†…å­˜è°ƒç”¨append()å³æ‰§è¡Œäº†100æ¬¡çš„append()</span></span><br><span class="line"><span class="comment">     è€ŒStringBuffer.append()æ˜¯ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼›</span></span><br><span class="line"><span class="comment">     é‚£ä¹ˆè¿™ä¹Ÿå°±æ„å‘³ç€åœ¨è°ƒç”¨100æ¬¡StringBuffer.append()æ–¹æ³•æ—¶ï¼Œ</span></span><br><span class="line"><span class="comment">     é‚£ä¹ˆå°±ä¼šè¿›å…¥åŒæ­¥ä»£ç å—append()100æ¬¡ï¼›</span></span><br><span class="line"><span class="comment">     å‡ºæ¥åŒæ­¥ä»£ç å—append()100æ¬¡ï¼›</span></span><br><span class="line"><span class="comment">     é‚£ä¹ˆè¿™ä¸ªæ€§èƒ½æ¶ˆè€—ä¹Ÿæ˜¯æ¯”è¾ƒå¤§çš„ï¼›</span></span><br><span class="line"><span class="comment">     å®ƒå¯èƒ½ä¼šåšè¿™æ ·ä¸€ä¸ªå¤„ç†ï¼›</span></span><br><span class="line"><span class="comment">     å°†StringBuffer.append()æ–¹æ³•å½“ä¸­çš„synchronizedè¿›è¡Œæ¶ˆé™¤æ‰ï¼›</span></span><br><span class="line"><span class="comment">     ç„¶åå†å°†synchronizedåŠ å…¥åˆ°100æ¬¡forå¾ªç¯çš„å¤–é¢ï¼›</span></span><br><span class="line"><span class="comment">     å³ï¼š</span></span><br><span class="line"><span class="comment">     ------------------------------------</span></span><br><span class="line"><span class="comment">     StringBuffer.java</span></span><br><span class="line"><span class="comment">     public StringBuffer append(String str)&#123;</span></span><br><span class="line"><span class="comment">      toStringCache = null;</span></span><br><span class="line"><span class="comment">      super.append(str);</span></span><br><span class="line"><span class="comment">      return this;</span></span><br><span class="line"><span class="comment">     &#125;</span></span><br><span class="line"><span class="comment">     ------------------------------------</span></span><br><span class="line"><span class="comment">     Demo01.java</span></span><br><span class="line"><span class="comment">      public static void main(String[] args)&#123;</span></span><br><span class="line"><span class="comment">        StringBuffer sb = new StringBuffer();</span></span><br><span class="line"><span class="comment">        synchronized&#123;</span></span><br><span class="line"><span class="comment">          for(int i = 0; i&lt; 100 ; ++)&#123;</span></span><br><span class="line"><span class="comment">            sb.append("aa");</span></span><br><span class="line"><span class="comment">          &#125;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        System.out.println(sb.toString());</span></span><br><span class="line"><span class="comment">      &#125;</span></span><br><span class="line"><span class="comment">     ------------------------------------</span></span><br><span class="line"><span class="comment">     é‚£ä¹ˆæ­¤æ—¶å†æ¥çœ‹å°±åªéœ€è¦è¿›å…¥ä¸€æ¬¡åŒæ­¥ä»£ç å—ç„¶åå†forå¾ªç¯100æ¬¡å³å¯ï¼›</span></span><br><span class="line"><span class="comment">     é‚£ä¹ˆè¿™å°±æ˜¯é”ç²—åŒ–ï¼›</span></span><br><span class="line"><span class="comment">     ç”±ä¹‹å‰forå¾ªç¯é›¶æ•£çš„è°ƒç”¨å¾ˆå¤šæ¬¡çš„åŒæ­¥ä»£ç å—åˆ°ç°åœ¨å°†å…¶æ”¾åˆ°åŒæ­¥ä»£ç å—é‡Œé¢æ¥åšä¸€æ¬¡è¿›å…¥åŒæ­¥ä»£ç å—å³å¯ï¼ŒæŠŠå¾ˆå¤šå°é”å»æ‰äº†å˜æˆä¸€ä¸ªå¤§é”ï¼›</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">    <span class="keyword">for</span>( <span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++)&#123;</span><br><span class="line">      sb.<span class="built_in">append</span>(<span class="string">"aa"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    System.out.<span class="built_in">println</span>(sb.toString());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">----------------------------------------------------------</span><br><span class="line">StringBuffer.java</span><br><span class="line">@Override</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> StringBuffer <span class="built_in">append</span>(<span class="keyword">String</span> <span class="built_in">str</span>)&#123;</span><br><span class="line">  toStringCache = <span class="keyword">null</span>;</span><br><span class="line">  <span class="keyword">super</span>.<span class="built_in">append</span>(<span class="built_in">str</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç›®æ ‡-22"><a href="#ç›®æ ‡-22" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>å­¦ä¹ é”ç²—åŒ–çš„åŸç†</p><p>åŸåˆ™ä¸Šï¼Œåœ¨ç¼–å†™ä»£ç çš„æ—¶å€™ï¼Œæ€»æ˜¯æ¨èå°† åŒæ­¥äºå•Šçš„ä½œç”¨èŒƒå›´ é™åˆ¶å¾—å°½é‡å°ï¼Œ<br>åªåœ¨å…±äº«æ•°æ®çš„å®é™…ä½œç”¨åŸŸä¸­ æ‰è¿›è¡ŒåŒæ­¥ï¼Œ<br>è¿™æ ·æ˜¯ä¸ºäº†ä½¿å¾—éœ€è¦åŒæ­¥çš„æ“ä½œæ•°é‡ å°½å¯èƒ½å˜å°ï¼Œå¦‚æœå­˜åœ¨é”ç«äº‰ï¼Œé‚£ç­‰å¾…é”çš„çº¿ç¨‹ä¹Ÿèƒ½å°½å¿«æ‹¿åˆ°é”ã€‚</p><p>å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œä¸Šé¢çš„åŸåˆ™éƒ½æ˜¯æ­£ç¡®åœ°ï¼Œä½†æ˜¯å¦‚æœä¸€äº›åˆ—çš„è¿ç»­æ“ä½œéƒ½å¯¹åŒä¸€ä¸ªå¯¹è±¡åå¤åŠ é”å’Œè§£é”ï¼Œç”šè‡³åŠ é”æ“ä½œæ˜¯å‡ºç°åœ¨å¾ªç¯ä½“ä¸­çš„ï¼Œé‚£å³ä½¿æ²¡æœ‰çº¿ç¨‹ç«äº‰ï¼Œé¢‘ç¹åœ°è¿›è¡Œäº’æ–¥åŒæ­¥æ“ä½œä¹Ÿä¼šå¯¼è‡´ä¸å¿…è¦çš„æ€§èƒ½æ¶ˆè€—ã€‚</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> class Demo01&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="keyword">String</span>[] args)&#123;</span><br><span class="line">    <span class="keyword">String</span> <span class="built_in">str</span> = <span class="keyword">new</span> StringBuffer()</span><br><span class="line">          .<span class="built_in">append</span>(<span class="string">"aa"</span>).<span class="built_in">append</span>(<span class="string">"bb"</span>).<span class="built_in">append</span>(<span class="string">"cc"</span>).toString();</span><br><span class="line">    </span><br><span class="line">    System.out.<span class="built_in">println</span>(<span class="string">"aa"</span>);</span><br><span class="line">    System.out.<span class="built_in">println</span>(<span class="string">"bb"</span>);</span><br><span class="line">    System.out.<span class="built_in">println</span>(<span class="string">"cc"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœè™šæ‹Ÿæœºæ£€æµ‹åˆ°æœ‰è¿™æ ·ä¸€ä¸² é›¶ç¢å°çš„æ“ä½œ éƒ½æ˜¯ç”¨ä¸€ä¸ªå¯¹è±¡åŠ é”ï¼Œå°†ä¼šæŠŠåŠ é”åŒæ­¥çš„èŒƒå›´æ‰©å±•ï¼ˆç²—åŒ–ï¼‰åˆ°æ•´ä¸ªæ“ä½œåºåˆ—çš„å¤–éƒ¨ï¼Œè¿™æ ·åªéœ€è¦åŠ é”ä¸€æ¬¡å°±å¯ä»¥äº†ã€‚</p><h3 id="å°ç»“-17"><a href="#å°ç»“-17" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>ä»€ä¹ˆæ˜¯é”ç²—åŒ–ï¼Ÿ<br>JVMä¼šæ¢æµ‹åˆ°ä¸€è¿ä¸²ç»†å°çš„æ“ä½œéƒ½æ˜¯ç”¨åŒä¸€ä¸ªå¯¹è±¡åŠ é”ï¼Œ<br>å°†åŒæ­¥ä»£ç å—çš„èŒƒå›´æ”¾å¤§ï¼›<br>æ”¾åˆ°è¿™ä¸²æ“ä½œçš„å¤–é¢ï¼›<br>é‚£ä¹ˆè¿™æ ·åªéœ€è¦åŠ ä¸€æ¬¡é”å³å¯ï¼›</p><h2 id="å¹³æ—¶å†™ä»£ç å¦‚ä½•å¯¹synchronizedä¼˜åŒ–"><a href="#å¹³æ—¶å†™ä»£ç å¦‚ä½•å¯¹synchronizedä¼˜åŒ–" class="headerlink" title="å¹³æ—¶å†™ä»£ç å¦‚ä½•å¯¹synchronizedä¼˜åŒ–"></a>å¹³æ—¶å†™ä»£ç å¦‚ä½•å¯¹synchronizedä¼˜åŒ–</h2><ul><li>synchronizedçš„åŸç†ï¼›</li><li>JDK1.6å¯¹synchronizedæ‰€åšçš„ä¼˜åŒ–ï¼›</li><li>åå‘é”ã€è½»é‡çº§é”ã€è‡ªæ—‹é”ã€é”æ¶ˆé™¤ã€é”ç²—åŒ–ç­‰ï¼›</li></ul><h3 id="å‡å°‘synchronizedçš„èŒƒå›´"><a href="#å‡å°‘synchronizedçš„èŒƒå›´" class="headerlink" title="å‡å°‘synchronizedçš„èŒƒå›´"></a>å‡å°‘synchronizedçš„èŒƒå›´</h3><p>åŒæ­¥ä»£ç å—ä¸­å°½é‡çŸ­ï¼Œå‡å°‘åŒæ­¥ä»£ç å—ä¸­ä»£ç çš„æ‰§è¡Œæ—¶é—´ï¼Œå‡å°‘é”çš„ç«äº‰ã€‚</p><p>å°½é‡è®©synchronizedåŒæ­¥ä»£ç å—å½“ä¸­çš„ä»£ç å°‘ä¸€ç‚¹è¿™æ ·æ‰§è¡Œçš„æ—¶é—´ä¹Ÿå°±ä¼šå°‘ä¸€ç‚¹ï¼›<br>é‚£ä¹ˆåœ¨å•ä½æ—¶é—´å†…æ‰€æ‰§è¡Œçš„çº¿ç¨‹ä¹Ÿå°±å¤šä¸€ç‚¹ï¼›ç­‰å¾…çš„çº¿ç¨‹ä¹Ÿå°±å°‘ä¸€ç‚¹ï¼›<br>å¦å¤–ç”±äºæ‰§è¡Œæ¯”è¾ƒçŸ­ï¼Œç”±è½»é‡çº§é”å°±æœ‰å¯èƒ½æå¾—å®šï¼›æˆ–è€…é€šè¿‡è‡ªæ—‹é”å°±å¯ä»¥æå¾—å®šï¼›<br>é¿å…å‡çº§åˆ°é‡é‡çº§é”ï¼›</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">synchronized(<span class="module-access"><span class="module"><span class="identifier">Demo01</span>.</span></span><span class="keyword">class</span>)&#123;</span><br><span class="line">  <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"aaa"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é™ä½synchronizedé”çš„ç²’åº¦"><a href="#é™ä½synchronizedé”çš„ç²’åº¦" class="headerlink" title="é™ä½synchronizedé”çš„ç²’åº¦"></a>é™ä½synchronizedé”çš„ç²’åº¦</h3><p>å°†ä¸€ä¸ªé”æ‹†åˆ†ä¸ºå¤šä¸ªé”æé«˜å¹¶å‘åº¦</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br></pre></td><td class="code"><pre><span class="line">--------------------------------</span><br><span class="line"><span class="keyword">package</span> com.xxx.demo11;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Hashtable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> class Demo01&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="keyword">String</span>[] args)&#123;</span><br><span class="line">    Hashtable hs = <span class="keyword">new</span> Hashtable();</span><br><span class="line">    hs.put(<span class="string">"aa"</span>,<span class="string">"bb"</span>);</span><br><span class="line">    hs.put(<span class="string">"xx"</span>,<span class="string">"yy"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------</span><br><span class="line"># æˆªå–éƒ¨åˆ†ä»£ç  Hashtable.java</span><br><span class="line"><span class="keyword">public</span> class Hashtable&lt;K,V&gt; extends Dictionary&lt;K,V&gt; implements Map&lt;K,V&gt;, Cloneable, java.io.Serializable&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">    The hash table data/</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">transient</span> Entry&lt;?,?&gt;[] table;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">    The total number of entries in the hash table.</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">transient</span> <span class="built_in">int</span> count;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//çœç•¥ä¸€äº›ä»£ç </span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//å¯¹putæ•´ä¸ªæ–¹æ³•è¿›è¡ŒåŠ é”</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">synchronized</span> V put(K <span class="built_in">key</span>, V value)&#123;</span><br><span class="line">    <span class="comment">// Make sure the value is not null</span></span><br><span class="line">    <span class="keyword">if</span>(value == <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> NUllPointerException();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Makes sure the key is  not already in the hashtable</span></span><br><span class="line">    Entry&lt;?,?&gt; tab[] = table;</span><br><span class="line">    <span class="built_in">int</span> hash = <span class="built_in">key</span>.hashCode();</span><br><span class="line">    <span class="built_in">int</span> index = (hash &amp; <span class="number">0x7FFFFFFF</span>) % tab.length;</span><br><span class="line">    /unchecked/</span><br><span class="line">    Entry&lt;K,V&gt; entry = (Entry&lt;K,V&gt;)tab[index];</span><br><span class="line">    <span class="keyword">for</span>(; entry != <span class="keyword">null</span> ; entry = entry.next)&#123;</span><br><span class="line">      <span class="keyword">if</span>((entry.hash==hash) &amp;&amp; entry.<span class="built_in">key</span>.equlas(<span class="built_in">key</span>))&#123;</span><br><span class="line">        <span class="comment">//çœç•¥ä¸€äº›ä»£ç </span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">//å¯¹getæ•´ä¸ªæ–¹æ³•è¿›è¡ŒåŠ é”</span></span><br><span class="line">  /unchecked/</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">synchronized</span> V <span class="built_in">get</span>(<span class="keyword">Object</span> <span class="built_in">key</span>)&#123;</span><br><span class="line">    Entry&lt;?,?&gt; tab[] = table;</span><br><span class="line">    <span class="built_in">int</span> hash = <span class="built_in">key</span>.hashCode();</span><br><span class="line">    <span class="built_in">int</span> index = (hash &amp; <span class="number">0x7FFFFFFF</span>) % tab.length;</span><br><span class="line">    <span class="keyword">for</span>(Entry&lt;?,?&gt; e = tab[index] ; e != <span class="keyword">null</span> ; e=e.next)&#123;</span><br><span class="line">      <span class="keyword">if</span>((e.hash == hash) &amp;&amp; e.<span class="built_in">key</span>.equals(<span class="built_in">key</span>))&#123;</span><br><span class="line">        <span class="keyword">return</span> (V)e.value;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//å¯¹removeæ•´ä¸ªæ–¹æ³•è¿›è¡ŒåŠ é”</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">synchronized</span> V remove(<span class="keyword">Object</span> <span class="built_in">key</span>)&#123;</span><br><span class="line">    Entry&lt;?,?&gt; tab[] = table;</span><br><span class="line">    <span class="built_in">int</span> hash = <span class="built_in">key</span>.hashCode();</span><br><span class="line">    <span class="built_in">int</span> index = (hash &amp; <span class="number">0x7FFFFFFF</span>) % tab.length;</span><br><span class="line">    /unchecked/</span><br><span class="line">    Entry&lt;K,V&gt; e = (Entry&lt;K,V&gt;)tab[index];</span><br><span class="line">    <span class="keyword">for</span>(Entry&lt;K,V&gt; prev=<span class="keyword">null</span> ; e != <span class="keyword">null</span>; prev = e, e=e.next)&#123;</span><br><span class="line">      <span class="keyword">if</span>((e.hash==hash) &amp;&amp; e.<span class="built_in">key</span>.equals(<span class="built_in">key</span>))&#123;</span><br><span class="line">        modCount++;</span><br><span class="line">        <span class="keyword">if</span>(prev != <span class="keyword">null</span>)&#123;</span><br><span class="line">          prev.next = e.next;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          tab[index] = e.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//çœç•¥ä¸€äº›ä»£ç </span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">----------------------------------------------</span><br><span class="line">ç”±æ­¤å¯ä»¥çœ‹åˆ°Hashtableå¯¹å¢åˆ æ”¹æŸ¥çš„æ–¹æ³•å…¨éƒ¨æ·»åŠ äº†<span class="keyword">synchronized</span>ï¼Œ</span><br><span class="line">ä½¿ä¹‹æˆä¸ºåŒæ­¥æ–¹æ³•ï¼›</span><br><span class="line">é‚£ä¹ˆåŒæ­¥æ–¹æ³•çš„é”å¯¹è±¡æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯<span class="keyword">this</span>ï¼›</span><br><span class="line">ä¹Ÿå°±æ„å‘³ç€Hashtableå…¶å¢åˆ æ”¹æŸ¥è¿™å‡ ä¸ªæ–¹æ³•ä½¿ç”¨çš„éƒ½æ˜¯åŒä¸€æŠŠé”ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™æ ·ä¼šé€ æˆä»€ä¹ˆé—®é¢˜ï¼Ÿ</span><br><span class="line">å› ä¸ºHashtableçš„æ–¹æ³•å…¨éƒ¨åŠ äº†<span class="keyword">synchronized</span>ä»è€Œå˜æˆäº†åŒæ­¥æ–¹æ³•ï¼›</span><br><span class="line">é‚£ä¹ˆæ„å‘³ç€å¯¹äºHashtableè¿™ä¸ªå¯¹è±¡ï¼›</span><br><span class="line">å¦‚æœæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨å¾€è¿™ä¸ªHashtableå¯¹è±¡å½“ä¸­çš„ä¸€ä¸ªæ¡¶å½“ä¸­è¿›è¡Œæ·»åŠ ï¼›</span><br><span class="line">é‚£ä¹ˆå°±æ²¡æœ‰åŠæ³•å­˜åœ¨å¦å¤–ä¸€ä¸ªçº¿ç¨‹å¾€åŒæ ·çš„è¿™ä¸ªHashtableè¿™ä¸ªå¯¹è±¡å½“ä¸­çš„å¦å¤–ä¸€ä¸ªæ¡¶ä¸­è¿›è¡Œæ·»åŠ äº†ï¼›</span><br><span class="line">è‚¯å®šæ˜¯ä¸è¡Œçš„ï¼›å› ä¸ºput()æ–¹æ³•åŠ é”<span class="keyword">synchronized</span>äº†ï¼›</span><br><span class="line">ä¸”é”å¯¹è±¡ä¸º<span class="keyword">this</span>å³æ‰€æ“ä½œçš„Hashtableå¯¹è±¡ï¼›</span><br><span class="line">ç”±äºput()æ–¹æ³•åŠ é”äº†ï¼›</span><br><span class="line">æ‰€ä»¥åªå…è®¸ä¸€ä¸ªçº¿ç¨‹Aè¿›è¡Œå¾€Hashtableå¯¹è±¡çš„ä¸€ä¸ªæ¡¶ä¸­æ·»åŠ ï¼›</span><br><span class="line">è€Œå¦å¤–çš„å…¶ä»–çº¿ç¨‹Båˆ™å¿…é¡»ç­‰å¾…çº¿ç¨‹Aæ·»åŠ å®Œæˆï¼Œæ‰èƒ½å¾€ç›¸åŒçš„è¯¥Hashtableå¯¹è±¡å½“ä¸­çš„å…¶ä»–æ¡¶ä¸­æ·»åŠ ï¼›</span><br><span class="line">è€Œäº‹å®ä¸Šå¹¶æ²¡æœ‰å¿…è¦è¿™æ ·æ“ä½œï¼›</span><br><span class="line">å³Açº¿ç¨‹æ“ä½œHashtableå¯¹è±¡çš„ç¬¬ä¸€ä¸ªæ¡¶è¿›è¡Œæ·»åŠ æ“ä½œï¼›</span><br><span class="line">çº¿ç¨‹Bæ“ä½œä¸çº¿ç¨‹Aæ“ä½œçš„åŒä¸€ä¸ªHashtableå¯¹è±¡ï¼Œå…¶å½“ä¸­çš„å¦å¤–ä¸€ä¸ªæ¡¶è¿›è¡Œæ·»åŠ æ“ä½œï¼›å®åˆ™å¹¶ä¸å½±å“ï¼›</span><br><span class="line">å¦å¤–Hashtableè¿˜å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼›</span><br><span class="line">å³å½“æœ‰ä¸€ä¸ªçº¿ç¨‹Aåœ¨å¯¹Hashtableå¯¹è±¡çš„ç¬¬ä¸€ä¸ªæ¡¶è¿›è¡Œæ·»åŠ çš„æ—¶å€™ï¼›</span><br><span class="line">æ­¤æ—¶å­˜åœ¨æœ‰å¦å¤–ä¸€ä¸ªçº¿ç¨‹Bå¯¹åŒæ ·çš„Hashtableå¯¹è±¡çš„å…¶ä»–æ¡¶è¿›è¡Œè¯»å–<span class="built_in">get</span>()æˆ–è€…æ˜¯remove()æ–¹æ³•çš„æ—¶å€™æ˜¯ä¸å¯ä»¥çš„ï¼›åªèƒ½ç­‰å¾…çº¿ç¨‹Aæ“ä½œå®Œå¯¹ç¬¬ä¸€ä¸ªæ¡¶è¿›è¡Œæ·»åŠ çš„è¿™ä¸ªæ“ä½œï¼›</span><br><span class="line">å› ä¸ºå…¶æ–¹æ³•éƒ½æ˜¯<span class="keyword">synchronized</span>åŒæ­¥æ–¹æ³•ï¼›ä¸”åŠ çš„é”éƒ½æ˜¯åŒä¸€æŠŠé”å³<span class="keyword">this</span>ï¼›</span><br><span class="line">é‚£ä¹ˆè¿™æ ·å°±å¯¼è‡´äº†æ•ˆç‡çš„ä½ä¸‹ï¼›</span><br><span class="line">å› æ­¤jdkåˆæ¨å‡ºäº†ä¸€ä¸ªæ–°çš„ç±»å«åšConcurrentHashMapï¼›</span><br><span class="line">--------------------------------------------------</span><br><span class="line"><span class="keyword">package</span> com.xxx.demo11;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Hashtable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> class Demo01&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="keyword">String</span>[] args)&#123;</span><br><span class="line">    Hashtable hs = <span class="keyword">new</span> Hashtable();</span><br><span class="line">    hs.put(<span class="string">"aa"</span>,<span class="string">"bb"</span>);</span><br><span class="line">    hs.put(<span class="string">"xx"</span>,<span class="string">"yy"</span>);</span><br><span class="line">    hs.<span class="built_in">get</span>(<span class="string">"a"</span>);</span><br><span class="line">    hs.remove(<span class="string">"b"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------</span><br><span class="line"># æˆªå–éƒ¨åˆ†ä»£ç  ConcurrentHashMap.java</span><br><span class="line"><span class="keyword">public</span> class ConcurrentHashMap&lt;K,V&gt; extends AbstractMap&lt;K,V&gt; implements ConcurrentMap&lt;K,V&gt;, Serializable&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">724906924676318397</span>L;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// çœç•¥éƒ¨åˆ†ä»£ç </span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//ConcurrentHashMapå¯¹äºgetæ²¡æœ‰åŠ é”</span></span><br><span class="line">  <span class="keyword">public</span> V <span class="built_in">get</span>(<span class="keyword">Object</span> <span class="built_in">key</span>)&#123;</span><br><span class="line">    Node&lt;K,V&gt;p[] tab; Node&lt;K,V&gt; e, p; <span class="built_in">int</span> n , eh; K ek;</span><br><span class="line">    <span class="built_in">int</span> h = spread(<span class="built_in">key</span>.hashCode());</span><br><span class="line">    <span class="keyword">if</span>((tab==table) != <span class="keyword">null</span> &amp;&amp; (n=tab.length) &gt; <span class="number">0</span> &amp;&amp; (e=tabAt(tab, (n<span class="number">-1</span>)&amp; h)) != <span class="keyword">null</span>)&#123;</span><br><span class="line">      <span class="keyword">if</span>((eh=e.hash) == h)&#123;</span><br><span class="line">        <span class="keyword">if</span>((ek=e.<span class="built_in">key</span>) == <span class="built_in">key</span> || (ek != <span class="keyword">null</span> &amp;&amp; <span class="built_in">key</span>.equals(ek)))&#123;</span><br><span class="line">          <span class="keyword">return</span> e.val;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(ek &lt; <span class="number">0</span>)</span><br><span class="line">          <span class="keyword">return</span> (p = e.find(h, <span class="built_in">key</span>)) != <span class="keyword">null</span> ? p.val:<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">while</span>((e=e.next) != <span class="keyword">null</span>)&#123;</span><br><span class="line">          <span class="keyword">if</span>(e.hash == h &amp;&amp; ((ek=e.<span class="built_in">key</span>) == <span class="built_in">key</span> || (ek != <span class="keyword">null</span> &amp;&amp; <span class="built_in">key</span>.equlas(ek))))</span><br><span class="line">          <span class="keyword">return</span> e.val;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> V put(@NotNUll K <span class="built_in">key</span>, @NotNull V value)&#123;</span><br><span class="line">      <span class="keyword">return</span> putVal(<span class="built_in">key</span> , value , <span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*Implementation for put and putIfAbsent */</span></span><br><span class="line">    <span class="keyword">final</span> V putVal(K <span class="built_in">key</span>, V value, <span class="built_in">boolean</span> onlyIfAbsent)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">key</span> == <span class="keyword">null</span> || value == <span class="keyword">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">        <span class="built_in">int</span> hash = spread(<span class="built_in">key</span>.hashCode());</span><br><span class="line">        <span class="built_in">int</span> binCount = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(Node&lt;K,V&gt;[] tab = table;;)&#123;</span><br><span class="line">          Node&lt;K,V&gt; f;<span class="built_in">int</span> n,i,fh;</span><br><span class="line">          <span class="keyword">if</span>(tab == <span class="keyword">null</span> || (n = tab.length) == <span class="number">0</span>)</span><br><span class="line">            tab = initTable();</span><br><span class="line">          <span class="keyword">else</span> <span class="keyword">if</span>((f = tabAt(tab, i = (n<span class="number">-1</span>) &amp; hash)) == <span class="keyword">null</span>)&#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//casTabAt æ­¤å¤„å³ä¸ºCASæ“ä½œå»è¿›è¡Œæ·»åŠ ä¸€ä¸ªç»“ç‚¹</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(casTabAt(tab, i, <span class="keyword">null</span>, <span class="keyword">new</span> Node&lt;K,V&gt;(hash,<span class="built_in">key</span>,value,<span class="keyword">null</span>)))</span><br><span class="line">              <span class="keyword">break</span>;  <span class="comment">// no lock when adding to empty bin</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span> <span class="keyword">if</span>((fh = f.hash) == MOVED)</span><br><span class="line">            tab = helpTransfer(tab, f);</span><br><span class="line">          <span class="keyword">else</span>&#123;</span><br><span class="line">            V oldVal = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">            å¦å¤–ä¸‹é¢è¿˜æœ‰synchronizedæ¥è¿›è¡Œæ·»åŠ ä¸€ä¸ªç»“ç‚¹</span></span><br><span class="line"><span class="comment">            è€Œä¸”è¯¥synchronizedæ‰€ç”¨çš„é”å¹¶ä¸æ˜¯ä¸€æŠŠé”ï¼›</span></span><br><span class="line"><span class="comment">            synchronizedæ‰€ç”¨çš„é”æ˜¯æ¡¶ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼›</span></span><br><span class="line"><span class="comment">            ä¹Ÿå°±æ„å‘³ç€æ˜¯è¿™æ ·ï¼š</span></span><br><span class="line"><span class="comment">            ConcurrentHashMapåœ¨è¿›è¡Œæ·»åŠ å…ƒç´ çš„æ—¶å€™;</span></span><br><span class="line"><span class="comment">            å¦‚æœè¯¥æ¡¶å½“ä¸­ä¸€ä¸ªå…ƒç´ ä¹Ÿæ²¡æœ‰,é‚£ä¹ˆå°±æ˜¯ç”¨CASæ“ä½œæ¥è¿›è¡Œæ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ ï¼›</span></span><br><span class="line"><span class="comment">            å¦‚æœè¯¥æ¡¶å½“ä¸­æœ‰å­˜åœ¨å…ƒç´ å¾€åé¢åŠ å…ƒç´ å‘¢?</span></span><br><span class="line"><span class="comment">            é‚£ä¹ˆè¿™ä¸ªæ—¶å€™åœ¨é”çš„æ—¶å€™ä¼šä½¿ç”¨è¯¥æ¡¶å½“ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ä½œä¸ºé”å¯¹è±¡ï¼Œé‚£ä¹ˆä¹Ÿå°±æ„å‘³ç€åªä¼šé”ä½è¿™ä¸€ä¸ªæ¡¶ï¼›</span></span><br><span class="line"><span class="comment">            å³è¿™ä¸€ä¸ªçº¿ç¨‹å¾€è¿™ä¸€ä¸ªæ¡¶å½“ä¸­è¿›è¡Œæ·»åŠ ï¼Œåªä¼šå¯¹è¿™ä¸€ä¸ªæ¡¶è¿›è¡Œé”ï¼›</span></span><br><span class="line"><span class="comment">            å¦å¤–å†æ¥ä¸€ä¸ªçº¿ç¨‹å¾€åŒä¸€ä¸ªConcurrentHashMapå¯¹è±¡ä¸­çš„å…¶ä»–æ¡¶å½“ä¸­è¿›è¡Œæ·»åŠ é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±æ˜¯å¯ä»¥è¿›è¡Œçš„ï¼›</span></span><br><span class="line"><span class="comment">            å› ä¸ºå¦å¤–ä¸€ä¸ªçº¿ç¨‹æ‰€è¦è¿›è¡Œæ·»åŠ çš„æ˜¯è¯¥åŒä¸€ä¸ªConcurrentHashMapå¯¹è±¡å½“ä¸­çš„å…¶ä»–æ¡¶ï¼Œé‚£ä¹ˆé”çš„å¯¹è±¡å³ä¸ºå…¶ä»–æ¡¶å½“ä¸­çš„ç¬¬ä¸€ä¸ªç»“ç‚¹å¯¹è±¡ï¼›</span></span><br><span class="line"><span class="comment">            å³è¿™ä¸¤ä¸ªçº¿ç¨‹ä¹‹é—´æ‰€æ“ä½œçš„åŒä¸€ä¸ªConcurrentHashMapå¯¹è±¡çš„æ¡¶ä¸ä¸€æ ·å…¶é”ä¹Ÿä¸ä¸€æ ·ï¼›</span></span><br><span class="line"><span class="comment">            ç”±äºé”ä¸ä¸€æ ·æ‰€ä»¥çº¿ç¨‹å¾€å…¶ä»–æ¡¶å½“ä¸­è¿›è¡Œæ·»åŠ æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼›</span></span><br><span class="line"><span class="comment">            ä¹Ÿå°±æ˜¯è¯´ConcurrentHashMapåªè¦æ˜¯ä¸åŒçš„æ¡¶é‚£ä¹ˆæ˜¯å¯ä»¥è¿›è¡ŒåŒæ—¶æ·»åŠ çš„ï¼›</span></span><br><span class="line"><span class="comment">            é™¤æ­¤ä¹‹å¤–è¿˜çœ‹åˆ°ConcurrentHashMapçš„get()æ–¹æ³•æ˜¯æ²¡æœ‰åŠ synchronizedå˜æˆåŒæ­¥æ–¹æ³•çš„ï¼›</span></span><br><span class="line"><span class="comment">            è¿™ä¹Ÿå°±æ„å‘³ç€å½“ä¸€ä¸ªçº¿ç¨‹Aåœ¨å¯¹è¯¥ConcurrentHashMapå½“ä¸­çš„ä¸€ä¸ªæ¡¶è¿›è¡Œæ·»åŠ çš„æ—¶å€™ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹è¿˜å¯ä»¥å¯¹è¯¥åŒä¸€ä¸ªConcurrentHashMapå¯¹è±¡å½“ä¸­çš„åŒä¸€ä¸ªæ¡¶è¿›è¡Œè¯»å–æ“ä½œï¼›é‚£ä¹ˆè¿™æ ·çš„è¯ä¹Ÿä¸ä¼šå—åˆ°é”çš„å½±å“ï¼›</span></span><br><span class="line"><span class="comment">            å…¶æ€§èƒ½ä¹Ÿå°±æ›´é«˜ä¸€ç‚¹ï¼›</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">synchronized</span>(f)&#123;</span><br><span class="line">              <span class="keyword">if</span>(tabAt(tab, i) == f)&#123;</span><br><span class="line">                <span class="keyword">if</span>(fh &gt;= <span class="number">0</span>)&#123;</span><br><span class="line">                  binCount = <span class="number">1</span>;</span><br><span class="line">                  <span class="keyword">for</span>(Node&lt;K,V&gt; e = f;; ++binCount)&#123;</span><br><span class="line">                    K ek;</span><br><span class="line">                    <span class="keyword">if</span>(e.hash == hash &amp;&amp; ((ek = e.<span class="built_in">key</span>) == <span class="built_in">key</span> || (ek!=<span class="keyword">null</span> &amp;&amp; <span class="built_in">key</span>.equals(ek))))&#123;</span><br><span class="line">                      oldVal = e.val;</span><br><span class="line">                      <span class="keyword">if</span>(!onlyIfAbsent)&#123;</span><br><span class="line">                        e.val=value;</span><br><span class="line">                        <span class="comment">//çœç•¥éƒ¨åˆ†ä»£ç </span></span><br><span class="line">                      &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------</span><br><span class="line"><span class="keyword">package</span> com.xxx.demo11;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Hashtable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> class Demo01&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="keyword">String</span>[] args)&#123;</span><br><span class="line">    Hashtable hs = <span class="keyword">new</span> Hashtable();</span><br><span class="line">    hs.put(<span class="string">"aa"</span>,<span class="string">"bb"</span>);</span><br><span class="line">    hs.put(<span class="string">"xx"</span>,<span class="string">"yy"</span>);</span><br><span class="line">    hs.<span class="built_in">get</span>(<span class="string">"a"</span>);</span><br><span class="line">    hs.remove(<span class="string">"b"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> test01()&#123;</span><br><span class="line">    <span class="keyword">synchronized</span>(Demo01.class)&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> test02()&#123;</span><br><span class="line">    <span class="keyword">synchronized</span>(Demo01.class)&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">  å†™ä»£ç çš„æ—¶å€™åƒä¸‡æ³¨æ„ä¸è¦è¿™ä¹ˆå»åšï¼š</span></span><br><span class="line"><span class="comment">  è¿™ä¸¤ä¸ªæ–¹æ³•test01()ä»¥åŠtest02()æ²¡æœ‰ä»»ä½•ä¸šåŠ¡å…³è”ï¼›</span></span><br><span class="line"><span class="comment">  ä¸”å¾ˆå¤šæ—¶å€™ä¸€èˆ¬ä½¿ç”¨ ç±»å.classæ¥ä½œä¸ºé”ï¼›</span></span><br><span class="line"><span class="comment">  è§‰å¾—è¿™æ ·å¾ˆç®€å•æœ‰å¯ä»¥é”ä½ï¼›</span></span><br><span class="line"><span class="comment">  å¦‚æœä½¿ç”¨ç±»å.classä½œä¸ºé”çš„è¯ï¼›</span></span><br><span class="line"><span class="comment">  å¦‚æœä¸€ä¸ªçº¿ç¨‹Aåœ¨è¿›è¡Œæ‰§è¡Œtest01()å½“ä¸­çš„åŒæ­¥ä»£ç å—æ—¶ï¼›</span></span><br><span class="line"><span class="comment">  è€Œå¯¹äºå¦å¤–ä¸€ä¸ªçº¿ç¨‹Bæ‰§è¡Œæ¯«æ— ä¸šåŠ¡å…³è”çš„test02()æ–¹æ³•æ—¶ï¼Œ</span></span><br><span class="line"><span class="comment">  ä¹Ÿå°±æ„å‘³ç€çº¿ç¨‹AæŠ¢äº†çº¿ç¨‹Bçš„é”å¹¶ä¸”çº¿ç¨‹Aè¿˜æ²¡æœ‰é‡Šæ”¾é”ï¼›</span></span><br><span class="line"><span class="comment">  æ‰€ä»¥çº¿ç¨‹Bæ— æ³•è¿›å…¥test02()æ–¹æ³•ä¸­çš„åŒæ­¥ä»£ç å—ä»è€Œé˜»å¡åªèƒ½ç­‰å¾…çº¿ç¨‹Aé‡Šæ”¾é”ï¼›</span></span><br><span class="line"><span class="comment">  é‚£ä¹ˆè¿™æ ·çš„è¯å¹¶å‘æ•ˆç‡å°±å¾ˆä½äº†ï¼›</span></span><br><span class="line"><span class="comment">  æ‰€ä»¥å°½é‡ä¸è¦ä½¿ç”¨ç±»å.classè¿™æ ·çš„é”ï¼›</span></span><br><span class="line"><span class="comment">  å»ºè®®æ˜¯é™ä½é”çš„ç²’åº¦ï¼›è¿™æ ·ä½¿å¾—å…¶å¹¶å‘æ•ˆç‡å¯ä»¥æ›´é«˜ä¸€ç‚¹ï¼›</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">&#125;</span><br><span class="line">--------------------------------------------------</span><br></pre></td></tr></table></figure><p><strong>HashTableï¼šé”å®šæ•´ä¸ªå“ˆå¸Œè¡¨ï¼Œä¸€ä¸ªæ“ä½œæ­£åœ¨è¿›è¡Œæ—¶ï¼Œå…¶ä»–æ“ä½œä¹ŸåŒæ—¶é”å®šï¼Œæ•ˆç‡ä½ä¸‹</strong>ï¼š</p><p><strong>ConcurrentHashMapï¼šå±€éƒ¨é”å®šï¼Œåªé”å®šæ¡¶ï¼Œå½“å¯¹å½“å‰å…ƒç´ é”å®šæ—¶ï¼Œå…¶ä»–å…ƒç´ ä¸é”å®š</strong>ã€‚</p><p>HashTableä¸ConcurrentHashMapè¿™ä¸¤ä¸ªå®¹å™¨éƒ½å®ç°äº†Mapæ¥å£ï¼Œå¹¶ä¸”éƒ½èƒ½å¤Ÿä¿è¯çº¿ç¨‹å®‰å…¨ï¼›</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">-----------------------------------------</span><br><span class="line">|<span class="string"> å…ƒç´ 1 </span>|<span class="string"> å…ƒç´ 2 </span>|<span class="string"> å…ƒç´ 3 </span>|<span class="string"> å…ƒç´ 4 </span>|<span class="string"> å…ƒç´ 5 </span>|</span><br><span class="line">----â†‘------------------------------â†‘-----</span><br><span class="line">    |<span class="string">            objA              </span>|</span><br><span class="line">takeæ·»åŠ å…ƒç´ ä½¿ç”¨ä¸€æŠŠé”objA          putæ·»åŠ å…ƒç´ ä½¿ç”¨ä¸€æŠŠé”objA</span><br><span class="line"></span><br><span class="line">/<span class="symbol">*</span><span class="symbol">*</span></span><br><span class="line">å¾€å…¶å¤´éƒ¨è¿›è¡Œè·å–å…ƒç´ ï¼›å¾€å°¾éƒ¨è¿›è¡Œæ·»åŠ å…ƒç´ ï¼›</span><br><span class="line">ä¸ºäº†ä¿è¯é˜Ÿåˆ—çš„çº¿ç¨‹å®‰å…¨ï¼Œå°±æœ‰å¯èƒ½åŠ ä¸€æŠŠé”ï¼›</span><br><span class="line">å±Šæ—¶è·å–å’Œæ·»åŠ éƒ½æ˜¯ç”¨è¿™åŒä¸€æŠŠé”ï¼›</span><br><span class="line">è¿™æ ·ä¹Ÿå°±å¯¼è‡´äº†åœ¨è·å–çš„æ—¶å€™æ²¡æœ‰åŠæ³•è¿›è¡Œæ·»åŠ ï¼›</span><br><span class="line">æ‰€ä»¥æ•ˆç‡å°±ä¼šæ›´ä½ï¼›</span><br><span class="line">å› æ­¤å°±æœ‰äº†LinkedBlockingQueueçš„å­˜åœ¨ï¼›</span><br><span class="line"><span class="symbol">*</span>/</span><br></pre></td></tr></table></figure><p>LinkedBlockingQueueå…¥é˜Ÿå’Œå‡ºé˜Ÿä½¿ç”¨ä¸åŒçš„é”ï¼Œç›¸å¯¹äºè¯»å†™åªæœ‰ä¸€ä¸ªé”æ•ˆç‡è¦é«˜ã€‚</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">-----------------------------------------</span><br><span class="line">|<span class="string"> å…ƒç´ 1 </span>|<span class="string"> å…ƒç´ 2 </span>|<span class="string"> å…ƒç´ 3 </span>|<span class="string"> å…ƒç´ 4 </span>|<span class="string"> å…ƒç´ 5 </span>|</span><br><span class="line">----â†‘------------------------------â†‘-----</span><br><span class="line">    |<span class="string">                              </span>|</span><br><span class="line">takeæ·»åŠ å…ƒç´ ä½¿ç”¨ä¸€æŠŠé”objB          putæ·»åŠ å…ƒç´ ä½¿ç”¨ä¸€æŠŠé”objA</span><br><span class="line"></span><br><span class="line">/<span class="symbol">*</span><span class="symbol">*</span></span><br><span class="line">æ·»åŠ å…ƒç´ çš„æ—¶å€™ä½¿ç”¨objAé”</span><br><span class="line">è·å–å…ƒç´ çš„æ—¶å€™ä½¿ç”¨objBé”</span><br><span class="line">å³ä¸¤æŠŠé”ï¼›</span><br><span class="line">å½“åœ¨è·å–çš„æ—¶å€™ï¼›é‚£ä¹ˆæ·»åŠ å…ƒç´ åˆ™ä¸å—å½±å“ï¼›</span><br><span class="line">å¦å¤–åœ¨æ·»åŠ çš„æ—¶å€™ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¦å¤–ä¸€æŠŠé”æ¥è¿›è¡Œè·å–å…ƒç´ ï¼›</span><br><span class="line">è¿™å°±å¯ä»¥ä¿è¯åŒæ—¶åˆå¯ä»¥æ·»åŠ åˆå¯ä»¥è·å–ï¼›</span><br><span class="line"><span class="symbol">*</span>/</span><br></pre></td></tr></table></figure><h3 id="è¯»å†™åˆ†ç¦»"><a href="#è¯»å†™åˆ†ç¦»" class="headerlink" title="è¯»å†™åˆ†ç¦»"></a>è¯»å†™åˆ†ç¦»</h3><p>ConcurrentHashMap<br>ï¼ˆåœ¨å†™çš„æ—¶å€™ä¸ºäº†ä¿è¯çº¿ç¨‹å®‰å…¨ä¸Šé”ï¼Œä½†æ˜¯åœ¨è¯»çš„æ—¶å€™ä¸ä¼šä¿®æ”¹æ•°æ®æ‰€ä»¥æ²¡æœ‰åŠ é”ï¼Œè¿™æ ·å³ä¿è¯å¤šä¸ªçº¿ç¨‹æ¥è¿›è¡Œè¯»å–ï¼›å†™çš„æ—¶å€™åŠ é”ä¿è¯åœ¨å†™çš„è¿‡ç¨‹ä¸­çš„çº¿ç¨‹å®‰å…¨ï¼›è¯»çš„æ—¶å€™ä¸ä¼šæ”¹å˜æ•°æ®å¯ä»¥è®©å¤šä¸ªçº¿ç¨‹æ¥è¿›è¡Œè¯»å–ï¼‰ï¼Œ CopyOnWriteArrayListå’ŒConyOnWriteSet<br>ï¼ˆéƒ½æ˜¯è¯»çš„æ—¶å€™ä¸åŠ é”ï¼Œå†™çš„æ—¶å€™æ‰åŠ é”ï¼›ï¼‰</p><p>è¯»å–æ—¶ä¸åŠ é”ï¼Œå†™å…¥å’Œåˆ é™¤æ—¶åŠ é”</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;è§‚çœ‹ç¬”è®°ï¼š&lt;code&gt;https://www.bilibili.com/video/BV1aJ411V763?from=search&amp;amp
      
    
    </summary>
    
    
      <category term="é¢è¯•" scheme="https://fengshana.github.io/categories/%E9%9D%A2%E8%AF%95/"/>
    
    
      <category term="é¢è¯•" scheme="https://fengshana.github.io/tags/%E9%9D%A2%E8%AF%95/"/>
    
      <category term="é”" scheme="https://fengshana.github.io/tags/%E9%94%81/"/>
    
      <category term="synchronized" scheme="https://fengshana.github.io/tags/synchronized/"/>
    
  </entry>
  
  <entry>
    <title>Modern Java IN ACTION01</title>
    <link href="https://fengshana.github.io/2020/06/09/%E3%80%90Modern%20Java%20IN%20ACTION%E3%80%91/Modern%20Java%20IN%20ACTION01/"/>
    <id>https://fengshana.github.io/2020/06/09/%E3%80%90Modern%20Java%20IN%20ACTION%E3%80%91/Modern%20Java%20IN%20ACTION01/</id>
    <published>2020-06-08T18:50:05.976Z</published>
    <updated>2020-06-08T20:10:03.909Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;
      
    
    </summary>
    
    
      <category term="jdk8" scheme="https://fengshana.github.io/categories/jdk8/"/>
    
    
      <category term="jdk8" scheme="https://fengshana.github.io/tags/jdk8/"/>
    
      <category term="java" scheme="https://fengshana.github.io/tags/java/"/>
    
      <category term="ç¬”è®°" scheme="https://fengshana.github.io/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>SpringæŠ€æœ¯å†…å¹•01</title>
    <link href="https://fengshana.github.io/2020/06/02/%E3%80%90Spring%E6%8A%80%E6%9C%AF%E5%86%85%E5%B9%95%E3%80%91/Spring%E6%8A%80%E6%9C%AF%E5%86%85%E5%B9%9501/"/>
    <id>https://fengshana.github.io/2020/06/02/%E3%80%90Spring%E6%8A%80%E6%9C%AF%E5%86%85%E5%B9%95%E3%80%91/Spring%E6%8A%80%E6%9C%AF%E5%86%85%E5%B9%9501/</id>
    <published>2020-06-02T09:28:52.500Z</published>
    <updated>2020-06-05T18:32:48.183Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Spring Internals</p></blockquote><h2 id="Spring-æŠ€æœ¯å†…å¹•"><a href="#Spring-æŠ€æœ¯å†…å¹•" class="headerlink" title="Spring æŠ€æœ¯å†…å¹•"></a>Spring æŠ€æœ¯å†…å¹•</h2><h3 id="æ·±å…¥è§£æ-Springæ¶æ„-ä¸-è®¾è®¡åŸç†"><a href="#æ·±å…¥è§£æ-Springæ¶æ„-ä¸-è®¾è®¡åŸç†" class="headerlink" title="æ·±å…¥è§£æ Springæ¶æ„ ä¸ è®¾è®¡åŸç†"></a>æ·±å…¥è§£æ Springæ¶æ„ ä¸ è®¾è®¡åŸç†</h3><p>ï¼ˆç¬¬2ç‰ˆï¼‰  è®¡æ–‡æŸ¯ è‘—  </p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><h3 id="ä¸ºä»€ä¹ˆè¦å†™è¿™æœ¬ä¹¦"><a href="#ä¸ºä»€ä¹ˆè¦å†™è¿™æœ¬ä¹¦" class="headerlink" title="ä¸ºä»€ä¹ˆè¦å†™è¿™æœ¬ä¹¦"></a>ä¸ºä»€ä¹ˆè¦å†™è¿™æœ¬ä¹¦</h3><p>æœ¬ä¹¦æ¢è®¨äº† <strong>Springæ¡†æ¶çš„è®¾è®¡åŸç†ã€æ¶æ„å’Œè¿è¡Œæœºåˆ¶</strong>ã€‚<br>ä½œä¸ºåœ¨ Javaé¢†åŸŸ æœ€ä¸ºæˆåŠŸçš„ å¼€æºè½¯ä»¶ä¹‹ä¸€ï¼Œ<br>Sprignåœ¨Java EEå¼€å‘ä¸­ï¼Œä½¿ç”¨è€…ä¼—å¤šã€‚<br>æœ¬ä¹¦ä»¥ Springçš„æºä»£ç  ä¸ºä¾æ‰˜ï¼Œ<br>ç»“åˆ Springçš„è®¾è®¡æ€è·¯ï¼Œ<br>ä»å†…éƒ¨å®ç°çš„è§’åº¦ï¼Œå¯¹Springçš„å®ç°è¿›è¡Œäº†ç¿”å®çš„åˆ†æï¼Œ<br>å¸Œæœ›èƒ½å¤Ÿé€šè¿‡è¿™ç§åˆ†æï¼Œä½¿è¯»è€…åœ¨å¼€å‘è€…çš„å±‚é¢æŒæ¡Springï¼Œä¸ºå¼€å‘Springåº”ç”¨æä¾›æ›´æ‰å®çš„æ¡†æ¶åŸºç¡€ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;Spring Internals&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;Spring-æŠ€æœ¯å†…å¹•&quot;&gt;&lt;a href=&quot;#Spring-æŠ€æœ¯å†…å¹•&quot; class=&quot;headerlink&quot; title=&quot;Spring æŠ€æœ¯å†…å¹•&quot;&gt;&lt;/a&gt;Sp
      
    
    </summary>
    
    
      <category term="Spring" scheme="https://fengshana.github.io/categories/Spring/"/>
    
    
      <category term="ç¬”è®°" scheme="https://fengshana.github.io/tags/%E7%AC%94%E8%AE%B0/"/>
    
      <category term="Spring" scheme="https://fengshana.github.io/tags/Spring/"/>
    
      <category term="SpringæŠ€æœ¯å†…å¹•" scheme="https://fengshana.github.io/tags/Spring%E6%8A%80%E6%9C%AF%E5%86%85%E5%B9%95/"/>
    
  </entry>
  
  <entry>
    <title>å…¨é¢æ·±å…¥è®²è§£MySQLæ•°æ®åº“ä¼˜åŒ–03</title>
    <link href="https://fengshana.github.io/2020/05/29/%E3%80%90MYSQL%E3%80%91/%E3%80%90MYSQL%E3%80%91%E5%85%A8%E9%9D%A2%E6%B7%B1%E5%85%A5%E8%AE%B2%E8%A7%A3MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%9603/"/>
    <id>https://fengshana.github.io/2020/05/29/%E3%80%90MYSQL%E3%80%91/%E3%80%90MYSQL%E3%80%91%E5%85%A8%E9%9D%A2%E6%B7%B1%E5%85%A5%E8%AE%B2%E8%A7%A3MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%9603/</id>
    <published>2020-05-29T11:23:31.802Z</published>
    <updated>2020-06-05T17:56:02.512Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è§‚çœ‹ç¬”è®°ï¼š<code>https://www.bilibili.com/video/BV1fJ41127Rj?from=search&amp;seid=13531213796559959972</code>  </p><p>æœ¬è¯¾ç¨‹ä½œä¸ºMySQLé«˜çº§è¯¾ç¨‹ï¼Œä¸»è¦è®²è§£äº†ï¼š  </p><ul><li><strong>MySQL</strong>ä¸­çš„<strong>è§†å›¾</strong>/<strong>å­˜å‚¨è¿‡ç¨‹</strong>/<strong>è§¦å‘å™¨</strong>/<strong>ç´¢å¼•</strong>ç­‰å¯¹è±¡çš„ä½¿ç”¨</li><li>å¸¸è§çš„<strong>SQL</strong>è¯­å¥<strong>ä¼˜åŒ–</strong>çš„æŠ€å·§</li><li><strong>åº”ç”¨ä¼˜åŒ–</strong></li><li><strong>æ•°æ®åº“ä¼˜åŒ–</strong></li><li><strong>æ•°æ®åº“æ—¥å¿—</strong></li></ul><p>ç­‰æ–¹é¢çš„çŸ¥è¯†ï¼Œå¹¶é€šè¿‡ç»¼åˆæ¡ˆä¾‹ï¼Œå¯¹è¯¾ç¨‹ä¸­çš„çŸ¥è¯†è¿›è¡Œä¸€ä¸ªæ•´åˆåº”ç”¨ã€‚  </p><p>æœ¬è¯¾ç¨‹æ—¨åœ¨é€šè¿‡MySQlé«˜çº§éƒ¨åˆ†å†…å®¹ï¼Œå¯ä»¥åœ¨æ»¡è¶³ç°æœ‰ä¸šåŠ¡éœ€æ±‚åŸºç¡€ä¸Šï¼Œå¯¹<strong>MySQLåº•å±‚çš„ä½“ç³»ç»“æ„</strong>ï¼ŒåŠ<strong>åº•å±‚çš„ä¼˜åŒ–</strong>æœ‰ä¸€ä¸ªæ·±å…¥çš„ç†è§£ï¼Œå¯¹<strong>ç³»ç»Ÿçš„æ•´ä½“æ€§èƒ½</strong>è¿›è¡Œæå‡ã€‚  </p><h2 id="ä»Šæ—¥å†…å®¹"><a href="#ä»Šæ—¥å†…å®¹" class="headerlink" title="ä»Šæ—¥å†…å®¹"></a>ä»Šæ—¥å†…å®¹</h2><ul><li><strong>åº”ç”¨ä¼˜åŒ–</strong></li><li><strong>MySQLä¸­æŸ¥è¯¢ç¼“å­˜ä¼˜åŒ–</strong></li><li><strong>MySQLå†…å­˜ç®¡ç†ä»¥åŠä¼˜åŒ–</strong></li><li><strong>MySQLå¹¶å‘å‚æ•°</strong>è°ƒæ•´</li><li><strong>MySQLé”</strong>é—®é¢˜</li><li>å¸¸ç”¨SQLæŠ€å·§</li></ul><h2 id="åº”ç”¨ä¼˜åŒ–"><a href="#åº”ç”¨ä¼˜åŒ–" class="headerlink" title="åº”ç”¨ä¼˜åŒ–"></a>åº”ç”¨ä¼˜åŒ–</h2><p>å‰é¢ç« èŠ‚ï¼Œä»‹ç»äº†å¾ˆå¤š<strong>æ•°æ®åº“çš„ä¼˜åŒ–æªæ–½</strong>ï¼Œä½†æ˜¯åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œç”±äº<strong>æ•°æ®åº“ æœ¬èº«çš„æ€§èƒ½ å±€é™</strong>ï¼Œå°±å¿…é¡»å¯¹å‰å°çš„åº”ç”¨è¿›è¡Œä¸€äº›ä¼˜åŒ–ï¼Œæ¥<strong>é™ä½ æ•°æ®åº“çš„ è®¿é—®å‹åŠ›</strong>ã€‚  </p><h3 id="ä½¿ç”¨è¿æ¥æ± "><a href="#ä½¿ç”¨è¿æ¥æ± " class="headerlink" title="ä½¿ç”¨è¿æ¥æ± "></a>ä½¿ç”¨è¿æ¥æ± </h3><p>å¯¹äº<strong>è®¿é—®æ•°æ®åº“</strong>æ¥è¯´ï¼Œ<strong>å»ºç«‹è¿æ¥çš„ä»£ä»·</strong>æ˜¯æ¯”è¾ƒ<strong>æ˜‚è´µ</strong>çš„ï¼Œå› ä¸º<strong>é¢‘ç¹çš„ åˆ›å»ºå…³é—­è¿æ¥</strong>ï¼Œæ˜¯æ¯”è¾ƒ<strong>è€—è´¹èµ„æº</strong>çš„ï¼Œæœ‰å¿…è¦<strong>å»ºç«‹æ•°æ®åº“è¿æ¥æ± </strong>ï¼Œä»¥<strong>æé«˜è®¿é—®çš„æ€§èƒ½</strong>ã€‚  </p><h3 id="å‡å°‘å¯¹MySQLçš„è®¿é—®"><a href="#å‡å°‘å¯¹MySQLçš„è®¿é—®" class="headerlink" title="å‡å°‘å¯¹MySQLçš„è®¿é—®"></a>å‡å°‘å¯¹MySQLçš„è®¿é—®</h3><h4 id="å‡å°‘å¯¹æ•°æ®è¿›è¡Œé‡å¤æ£€ç´¢"><a href="#å‡å°‘å¯¹æ•°æ®è¿›è¡Œé‡å¤æ£€ç´¢" class="headerlink" title="å‡å°‘å¯¹æ•°æ®è¿›è¡Œé‡å¤æ£€ç´¢"></a>å‡å°‘å¯¹æ•°æ®è¿›è¡Œé‡å¤æ£€ç´¢</h4><p>åœ¨ç¼–å†™åº”ç”¨ä»£ç æ—¶ï¼Œéœ€è¦èƒ½å¤Ÿ<strong>ç†è§£ å¯¹ æ•°æ®åº“çš„ è®¿é—®é€»è¾‘</strong>ã€‚  </p><p><strong>èƒ½å¤Ÿ ä¸€æ¬¡è¿æ¥ å°± è·å–å¾—åˆ°ç»“æœçš„ï¼Œå°± ä¸ç”¨ä¸¤æ¬¡è¿æ¥</strong>ï¼Œè¿™æ ·å¯ä»¥<strong>å¤§å¤§å‡å°‘ å¯¹ æ•°æ®åº“ æ— ç”¨çš„é‡å¤è¯·æ±‚</strong>ã€‚  </p><p>æ¯”å¦‚ï¼Œéœ€è¦è·å–ä¹¦ç±çš„idå’Œnameå­—æ®µï¼Œåˆ™æŸ¥è¯¢å¦‚ä¸‹ï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>, <span class="keyword">name</span> <span class="keyword">from</span> tb_book;</span><br></pre></td></tr></table></figure><p>ä¹‹åï¼Œåœ¨ä¸šåŠ¡é€»è¾‘ä¸­æœ‰éœ€è¦è·å–å¾—åˆ°ä¹¦ç±çŠ¶æ€ä¿¡æ¯ï¼Œåˆ™æŸ¥è¯¢å¦‚ä¸‹ï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span> ,<span class="keyword">status</span> <span class="keyword">from</span> tb_book;</span><br></pre></td></tr></table></figure><p>è¿™æ ·ï¼Œå°±éœ€è¦å‘æ•°æ®åº“æäº¤ä¸¤æ¬¡è¯·æ±‚ï¼Œæ•°æ®åº“å°±è¦åšä¸¤æ¬¡æŸ¥è¯¢æ“ä½œã€‚<br>å…¶å®å®Œå…¨å¯ä»¥ç”¨ä¸€æ¡SQLè¯­å¥å¾—åˆ°æƒ³è¦çš„ç»“æœã€‚  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>,<span class="keyword">name</span> ,<span class="keyword">status</span> <span class="keyword">from</span> tb_book;</span><br></pre></td></tr></table></figure><h4 id="å¢åŠ cacheå±‚"><a href="#å¢åŠ cacheå±‚" class="headerlink" title="å¢åŠ cacheå±‚"></a>å¢åŠ cacheå±‚</h4><p>åœ¨åº”ç”¨ä¸­ï¼Œå¯ä»¥åœ¨åº”ç”¨ä¸­<strong>å¢åŠ  ç¼“å­˜ å±‚</strong> æ¥è¾¾åˆ°<strong>å‡è½»æ•°æ®åº“è´Ÿæ‹…</strong>çš„ç›®çš„ã€‚  </p><p>ç¼“å­˜å±‚æœ‰å¾ˆå¤šç§ï¼Œä¹Ÿæœ‰å¾ˆå¤šå®ç°æ–¹å¼ï¼Œåªè¦è¾¾åˆ°<strong>é™ä½æ•°æ®åº“çš„è´Ÿæ‹…</strong>åˆèƒ½<strong>æ»¡è¶³åº”ç”¨éœ€æ±‚</strong>å°±å¯ä»¥ã€‚  </p><p>å› æ­¤å¯ä»¥éƒ¨åˆ†æ•°æ®ä»æ•°æ®åº“ä¸­æŠ½å–å‡ºæ¥æ”¾åˆ°åº”ç”¨ç«¯ä»¥<strong>æ–‡æœ¬æ–¹å¼å­˜å‚¨</strong>ï¼Œæˆ–è€…ä½¿ç”¨<strong>æ¡†æ¶ï¼ˆMybatisï¼ŒHibernateï¼‰æä¾›çš„ä¸€çº§ç¼“å­˜ã€äºŒçº§ç¼“å­˜</strong>ï¼Œæˆ–è€…ä½¿ç”¨<strong>redisæ•°æ®åº“</strong>æ¥<strong>ç¼“å­˜æ•°æ®</strong>ã€‚  </p><h3 id="è´Ÿè½½å‡è¡¡"><a href="#è´Ÿè½½å‡è¡¡" class="headerlink" title="è´Ÿè½½å‡è¡¡"></a>è´Ÿè½½å‡è¡¡</h3><p><strong>è´Ÿè½½å‡è¡¡</strong>æ˜¯åº”ç”¨ä¸­ä½¿ç”¨éå¸¸<strong>æ™®é</strong>çš„ä¸€ç§<strong>ä¼˜åŒ–æ–¹å¼</strong>ã€‚  </p><p><strong>è´Ÿè½½å‡è¡¡çš„æœºåˆ¶</strong>å°±æ˜¯åˆ©ç”¨<strong>æŸç§å‡è¡¡ç®—æ³•</strong>ï¼Œå°†<strong>å›ºå®šçš„è´Ÿè½½é‡</strong> <strong>åˆ†åˆ° ä¸åŒçš„ æœåŠ¡å™¨</strong>ä¸Šï¼Œä¸€æ¬¡æ¥<strong>é™ä½ å•å°æœåŠ¡å™¨çš„ è´Ÿè½½</strong>ï¼Œè¾¾åˆ°<strong>ä¼˜åŒ–</strong>çš„æ•ˆæœã€‚  </p><h4 id="åˆ©ç”¨MySQLå¤åˆ¶åˆ†æµæŸ¥è¯¢"><a href="#åˆ©ç”¨MySQLå¤åˆ¶åˆ†æµæŸ¥è¯¢" class="headerlink" title="åˆ©ç”¨MySQLå¤åˆ¶åˆ†æµæŸ¥è¯¢"></a>åˆ©ç”¨MySQLå¤åˆ¶åˆ†æµæŸ¥è¯¢</h4><p>é€šè¿‡<strong>MySQLçš„ ä¸»ä»å¤åˆ¶</strong>ï¼Œå®ç°<strong>è¯»å†™åˆ†ç¦»</strong>ï¼Œä½¿å¾—<strong>å¢åˆ æ”¹æ“ä½œ èµ° ä¸»èŠ‚ç‚¹</strong>ï¼Œ<strong>æŸ¥è¯¢æ“ä½œ èµ° ä»ç»“ç‚¹</strong>ï¼Œä»è€Œå¯ä»¥<strong>é™ä½ å•å°æœåŠ¡å™¨çš„è¯»å†™å‹åŠ›</strong>ã€‚  </p><h4 id="é‡‡ç”¨åˆ†å¸ƒå¼æ•°æ®åº“æ¶æ„"><a href="#é‡‡ç”¨åˆ†å¸ƒå¼æ•°æ®åº“æ¶æ„" class="headerlink" title="é‡‡ç”¨åˆ†å¸ƒå¼æ•°æ®åº“æ¶æ„"></a>é‡‡ç”¨åˆ†å¸ƒå¼æ•°æ®åº“æ¶æ„</h4><p><strong>åˆ†å¸ƒå¼æ•°æ®åº“</strong>æ¶æ„é€‚åˆ<strong>å¤§æ•°æ®é‡ã€è´Ÿè½½é«˜</strong>çš„æƒ…å†µï¼Œå®ƒæœ‰<strong>è‰¯å¥½çš„ æ‹“å±•æ€§ å’Œ é«˜å¯ç”¨æ€§</strong>ã€‚<br>é€šè¿‡åœ¨<strong>å¤šå°æœåŠ¡å™¨</strong>ä¹‹é—´<strong>åˆ†å¸ƒæ•°æ®</strong>ï¼Œå¯ä»¥å®ç°åœ¨<strong>å¤šå°æœåŠ¡å™¨</strong>ä¹‹é—´çš„<strong>è´Ÿè½½å‡è¡¡</strong>ï¼Œ<strong>æé«˜è®¿é—®æ•ˆç‡</strong>ã€‚  </p><h2 id="æŸ¥è¯¢ç¼“å­˜-æ¦‚è¿°åŠæµç¨‹"><a href="#æŸ¥è¯¢ç¼“å­˜-æ¦‚è¿°åŠæµç¨‹" class="headerlink" title="æŸ¥è¯¢ç¼“å­˜ - æ¦‚è¿°åŠæµç¨‹"></a>æŸ¥è¯¢ç¼“å­˜ - æ¦‚è¿°åŠæµç¨‹</h2><h3 id="Mysqlä¸­æŸ¥è¯¢ç¼“å­˜ä¼˜åŒ–-æ¦‚è¿°"><a href="#Mysqlä¸­æŸ¥è¯¢ç¼“å­˜ä¼˜åŒ–-æ¦‚è¿°" class="headerlink" title="Mysqlä¸­æŸ¥è¯¢ç¼“å­˜ä¼˜åŒ–-æ¦‚è¿°"></a>Mysqlä¸­æŸ¥è¯¢ç¼“å­˜ä¼˜åŒ–-æ¦‚è¿°</h3><p><strong>å¼€å¯mysqlçš„ æŸ¥è¯¢ç¼“å­˜</strong>ï¼Œå½“<strong>æ‰§è¡Œå®Œå…¨ç›¸åŒçš„SQLè¯­å¥</strong>çš„æ—¶å€™ï¼Œ<strong>æœåŠ¡å™¨</strong>å°±ä¼šç›´æ¥<strong>ä»ç¼“å­˜ä¸­è¯»å–ç»“æœ</strong>ï¼›<br>å½“<strong>æ•°æ®è¢«ä¿®æ”¹</strong>ï¼Œä¹‹å‰çš„<strong>ç¼“å­˜å°±ä¼šå¤±æ•ˆ</strong>ï¼Œ<strong>ä¿®æ”¹æ¯”è¾ƒé¢‘ç¹çš„ è¡¨ ä¸é€‚åˆ åš æŸ¥è¯¢ç¼“å­˜</strong>ã€‚  </p><h3 id="æ“ä½œæµç¨‹"><a href="#æ“ä½œæµç¨‹" class="headerlink" title="æ“ä½œæµç¨‹"></a>æ“ä½œæµç¨‹</h3><ol><li><strong>å®¢æˆ·ç«¯</strong> <strong>å‘é€ä¸€æ¡æŸ¥è¯¢SQL</strong> ç»™ <strong>æœåŠ¡å™¨</strong></li><li><strong>æœåŠ¡å™¨</strong>å…ˆä¼š <strong>æ£€æŸ¥æŸ¥è¯¢ç¼“å­˜</strong>ï¼Œå¦‚æœ<strong>å‘½ä¸­</strong>äº†<strong>ç¼“å­˜</strong>ï¼Œåˆ™<strong>ç«‹å³è¿”å›å­˜å‚¨åœ¨ç¼“å­˜ä¸­çš„ç»“æœ</strong>ã€‚å¦åˆ™è¿›å…¥ä¸‹ä¸€é˜¶æ®µã€‚</li><li><strong>æœåŠ¡å™¨ç«¯</strong>è¿›è¡Œ<strong>SQLè§£æ</strong>ã€<strong>é¢„å¤„ç†</strong>ï¼Œå†ç”±<strong>ä¼˜åŒ–å™¨</strong>ç”Ÿæˆå¯¹åº”çš„<strong>æ‰§è¡Œè®¡åˆ’</strong>ï¼›</li><li><strong>MySQL</strong>æ ¹æ®<strong>ä¼˜åŒ–å™¨ç”Ÿæˆçš„æ‰§è¡Œè®¡åˆ’</strong>ï¼Œè°ƒç”¨<strong>å­˜å‚¨å¼•æ“çš„API</strong>æ¥<strong>æ‰§è¡ŒæŸ¥è¯¢</strong>ï¼›</li><li>å°†ç»“æœ<strong>ç¼“å­˜</strong>å¹¶<strong>è¿”å›ç»™å®¢æˆ·ç«¯</strong>ï¼›</li></ol><h2 id="æŸ¥è¯¢ç¼“å­˜-é…ç½®å‚æ•°"><a href="#æŸ¥è¯¢ç¼“å­˜-é…ç½®å‚æ•°" class="headerlink" title="æŸ¥è¯¢ç¼“å­˜ - é…ç½®å‚æ•°"></a>æŸ¥è¯¢ç¼“å­˜ - é…ç½®å‚æ•°</h2><h3 id="æŸ¥è¯¢ç¼“å­˜é…ç½®"><a href="#æŸ¥è¯¢ç¼“å­˜é…ç½®" class="headerlink" title="æŸ¥è¯¢ç¼“å­˜é…ç½®"></a>æŸ¥è¯¢ç¼“å­˜é…ç½®</h3><ol><li>æŸ¥çœ‹å½“å‰çš„<strong>MySQLæ•°æ®åº“ æ˜¯å¦ æ”¯æŒ æŸ¥è¯¢ç¼“å­˜</strong>ï¼š  </li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p  </span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">VARIABLES</span> <span class="keyword">LIKE</span> <span class="string">'have_query_cache'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>have_query_cache</td>    <td>YES</td>  </tr></table><ol start="2"><li>æŸ¥çœ‹å½“å‰<strong>MySQL æ˜¯å¦ å¼€å¯äº† æŸ¥è¯¢ç¼“å­˜</strong>ï¼š  </li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">VARIABLES</span> <span class="keyword">LIKE</span> <span class="string">'query_cache_type'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>query_cache_type</td>    <td>OFF(å…³é—­)</td>  </tr></table><ol start="3"><li>æŸ¥çœ‹ <strong>æŸ¥è¯¢ç¼“å­˜ çš„ å ç”¨å¤§å°</strong>ï¼ˆå»ºè®®æŒ‰ç…§1024å€æ•°è¿›è¡Œå¢å¤§ï¼‰ï¼š  </li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">VARIABLES</span> <span class="keyword">LIKE</span> <span class="string">'query_cache_size'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>query_cache_size</td>    <td>1048576ï¼ˆå•ä½ä¸ºå­—èŠ‚ï¼Œå ç”¨å†…å­˜ç©ºé—´çº¦ä¸ºï¼š1048576/1024/1024çº¦ä¸º 1Mçš„å†…å­˜ç©ºé—´ï¼‰</td>  </tr></table><ol start="4"><li>æŸ¥çœ‹<strong>æŸ¥è¯¢ç¼“å­˜ çš„ çŠ¶æ€å˜é‡</strong></li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">STATUS</span> <span class="keyword">LIKE</span> <span class="string">'Qcache%'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>Qcache_free_blocks</td>    <td>1</td>  </tr>  <tr>    <td>Qcache_free_memory</td>    <td>1038344</td>  </tr>  <tr>    <td>Qcache_hits</td>    <td>13</td>  </tr>  <tr>    <td>Qcache_inserts</td>    <td>6</td>  </tr>  <tr>    <td>Qcache_lowmen_prunes</td>    <td>0</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_not_cached(å½“å‰æŸ¥è¯¢æ²¡æœ‰è¿›è¡Œç¼“å­˜)</td>    <td>16</td>  </tr>  <tr>    <td>Qcache_queryies_in_cache</td>    <td>1</td>  </tr>  <tr>    <td>Qcache_total_blocks</td>    <td>4</td>  </tr></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> demo_02; <span class="comment"># åˆ‡æ¢æ•°æ®åº“ä¹Ÿç®—æ˜¯ä¸€æ¬¡æŸ¥è¯¢mysqlåº•å±‚å½“ä¸­</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> tb_item; <span class="comment"># è€—è´¹æ—¶é—´2.76 second</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> tb_item; <span class="comment"># è€—è´¹æ—¶é—´2.53 second</span></span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>Qcache_free_blocksï¼ˆå¯ç”¨çš„å†…å­˜å—çš„ä¸ªæ•°ï¼‰</td>    <td>1</td>  </tr>  <tr>    <td>Qcache_free_memoryï¼ˆå¯ç”¨çš„å†…å­˜ç©ºé—´ï¼‰</td>    <td>1038344</td>  </tr>  <tr>    <td>Qcache_hitsï¼ˆæŸ¥è¯¢ç¼“å­˜çš„å‘½ä¸­æ¬¡æ•°ï¼‰</td>    <td>13</td>  </tr>  <tr>    <td>Qcache_insertsï¼ˆæ·»åŠ åˆ°ç¼“å­˜å½“ä¸­çš„æ¬¡æ•°ï¼‰</td>    <td>6</td>  </tr>  <tr>    <td>Qcache_lowmen_prunesï¼ˆå¦‚æœå†…å­˜ç©ºé—´ä¸è¶³ï¼Œå°†å†…å­˜ä¸­æ•°æ®ç§»å‡ºç¼“å­˜ç©ºé—´æ¬¡æ•°ï¼‰</td>    <td>0</td>  </tr>  <tr>    <td style="color:red;font-weight:bolder;">Qcache_not_cached(å½“å‰æŸ¥è¯¢æ²¡æœ‰è¿›è¡Œç¼“å­˜æ¬¡æ•°)</td>    <td style="color:red;font-weight:bolder;">19</td>  </tr>  <tr>    <td>Qcache_queryies_in_cache</td>    <td>1</td>  </tr>  <tr>    <td>Qcache_total_blocks</td>    <td>4</td>  </tr></table><table>  <tr>    <th>å‚æ•°</th>    <th>å«ä¹‰</th>  </tr>  <tr>    <td>Qcache_free_blocks</td>    <td>æŸ¥è¯¢ç¼“å­˜ä¸­çš„å¯ç”¨å†…å­˜å—æ•°</td>  </tr>  <tr>    <td>Qcache_free_memory</td>    <td>æŸ¥è¯¢ç¼“å­˜çš„å¯ç”¨å†…å­˜é‡</td>  </tr><tr style="color:red;font-weight:bolder;">    <td>Qcache_hits</td>    <td>æŸ¥è¯¢ç¼“å­˜å‘½ä¸­æ•°</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_inserts</td>    <td>æ·»åŠ åˆ°æŸ¥è¯¢ç¼“å­˜çš„æŸ¥è¯¢æ•°</td>  </tr>  <tr>    <td>Qcache_lowmen_prunes</td>    <td>ç”±äºå†…å­˜ä¸è¶³è€Œä»æŸ¥è¯¢ç¼“å­˜ä¸­åˆ é™¤çš„æŸ¥è¯¢æ•°</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_not_cached</td>    <td>éç¼“å­˜æŸ¥è¯¢çš„æ•°é‡ï¼ˆç”±äºquery_cache_typeè®¾ç½®è€Œæ— æ³•ç¼“å­˜æˆ–è€…æœªç¼“å­˜ï¼‰</td>  </tr>  <tr>    <td>Qcache_queries_in_cache</td>    <td>æŸ¥è¯¢ç¼“å­˜ä¸­æ³¨å†Œçš„æŸ¥è¯¢æ•°</td>  </tr>  <tr>    <td>Qcache_total_blocks</td>    <td>æŸ¥è¯¢ç¼“å­˜ä¸­çš„å—æ€»æ•°</td>  </tr></table><h2 id="æŸ¥è¯¢ç¼“å­˜-å¼€å¯æŸ¥è¯¢ç¼“å­˜"><a href="#æŸ¥è¯¢ç¼“å­˜-å¼€å¯æŸ¥è¯¢ç¼“å­˜" class="headerlink" title="æŸ¥è¯¢ç¼“å­˜ - å¼€å¯æŸ¥è¯¢ç¼“å­˜"></a>æŸ¥è¯¢ç¼“å­˜ - å¼€å¯æŸ¥è¯¢ç¼“å­˜</h2><p>MySQLçš„æŸ¥è¯¢ç¼“å­˜é»˜è®¤æ˜¯å…³é—­çš„ï¼Œéœ€è¦æ‰‹åŠ¨é…ç½®å‚æ•° query_cache_typeï¼Œæ¥å¼€å¯æŸ¥è¯¢ç¼“å­˜ã€‚  </p><p>query_cache_type è¯¥å‚æ•°çš„å¯å–å€¼æœ‰ä¸‰ä¸ªï¼š  </p><table>  <tr>    <th>å€¼</th>    <th>å®šä¹‰</th>  </tr>  <tr>    <td>OFF æˆ– 0</td>    <td>æŸ¥è¯¢ç¼“å­˜åŠŸèƒ½å…³é—­</td>  </tr>    <tr>    <td>ON æˆ– 1</td>    <td>æŸ¥è¯¢ç¼“å­˜åŠŸèƒ½æ‰“å¼€ï¼ŒSELECTçš„ç»“æœç¬¦åˆç¼“å­˜æ¡ä»¶å³ä¼šç¼“å­˜ï¼›å¦åˆ™ä¸äºˆç¼“å­˜ï¼›æ˜¾å¼æŒ‡å®šSQL_NO_CACHEï¼Œåˆ™ä¸äºˆç¼“å­˜</td>  </tr>    <tr>    <td> DEMAND æˆ– 2</td>    <td>æŸ¥è¯¢ç¼“å­˜åŠŸèƒ½æŒ‰éœ€è¿›è¡Œï¼Œ<span style="color:red;font-weight:bolder;">æ˜¾å¼æŒ‡å®š SQL_CACHE çš„SELECTè¯­å¥æ‰ä¼šç¼“å­˜</span>ï¼›å…¶ä»–å‡ä¸äºˆç¼“å­˜</td>  </tr></table><p>åœ¨ /usr/my.cnfé…ç½®ä¸­ï¼Œå¢åŠ ä»¥ä¸‹é…ç½®ï¼š  </p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åœ¨å¼€å¯mysqlçš„æŸ¥è¯¢ç¼“å­˜</span></span><br><span class="line"><span class="attr">query_cache_type</span>=<span class="number">1</span></span><br></pre></td></tr></table></figure><p>é…ç½®å®Œæ¯•ä¹‹åï¼Œé‡å¯æœåŠ¡å³å¯ç”Ÿæ•ˆï¼›  </p><p>ç„¶åå°±å¯ä»¥åœ¨å‘½ä»¤è¡Œæ‰§è¡ŒSQLè¯­å¥è¿›è¡ŒéªŒè¯ï¼Œæ‰§è¡Œä¸€æ¡æ¯”è¾ƒè€—æ—¶çš„SQLè¯­å¥ï¼Œç„¶åå†æ‰§è¡Œå¤šæ¬¡ï¼ŒæŸ¥çœ‹åé¢å‡ æ¬¡çš„æ‰§è¡Œæ—¶é—´ï¼›  </p><p>è·å–é€šè¿‡æŸ¥çœ‹æŸ¥è¯¢ç¼“å­˜çš„ç¼“å­˜å‘½ä¸­æ•°ï¼Œæ¥åˆ¤å®šæ˜¯å¦èµ°äº†æŸ¥è¯¢ç¼“å­˜ã€‚  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">vi /usr/my.cnf</span><br><span class="line">query_cache_type:1</span><br><span class="line"></span><br><span class="line">service mysql restart<span class="comment">#é‡å¯mysql</span></span><br><span class="line"></span><br><span class="line">mysql -u root -p</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> demo_02;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> tb_item;<span class="comment">#è€—æ—¶ 2.58 second</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> tb_item;<span class="comment">#è€—æ—¶ 0.00 second</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> tb_item;<span class="comment">#è€—æ—¶ 0.00 second</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> tb_item;<span class="comment">#è€—æ—¶ 0.00 second</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">status</span> <span class="string">'Qcache'</span>%;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>Qcache_free_blocks</td>    <td>1</td>  </tr>  <tr>    <td>Qcache_free_memory</td>    <td>1038344</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_hits</td>    <td>4</td>  </tr>  <tr>    <td>Qcache_inserts</td>    <td>1</td>  </tr>  <tr>    <td>Qcache_lowmen_prunes</td>    <td>0</td>  </tr>  <tr>    <td>Qcache_not_cached(å½“å‰æŸ¥è¯¢æ²¡æœ‰è¿›è¡Œç¼“å­˜)</td>    <td>2</td>  </tr>  <tr>    <td>Qcache_queryies_in_cache</td>    <td>1</td>  </tr>  <tr>    <td>Qcache_total_blocks</td>    <td>4</td>  </tr></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> tb_item;<span class="comment">#è€—æ—¶ 0.00 second</span></span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>Qcache_free_blocks</td>    <td>1</td>  </tr>  <tr>    <td>Qcache_free_memory</td>    <td>1038344</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_hits</td>    <td>5</td>  </tr>  <tr>    <td>Qcache_inserts</td>    <td>1</td>  </tr>  <tr>    <td>Qcache_lowmen_prunes</td>    <td>0</td>  </tr>  <tr>    <td>Qcache_not_cached(å½“å‰æŸ¥è¯¢æ²¡æœ‰è¿›è¡Œç¼“å­˜)</td>    <td>2</td>  </tr>  <tr>    <td>Qcache_queryies_in_cache</td>    <td>1</td>  </tr>  <tr>    <td>Qcache_total_blocks</td>    <td>4</td>  </tr></table><h2 id="æŸ¥è¯¢ç¼“å­˜-SELECTé€‰é¡¹"><a href="#æŸ¥è¯¢ç¼“å­˜-SELECTé€‰é¡¹" class="headerlink" title="æŸ¥è¯¢ç¼“å­˜ - SELECTé€‰é¡¹"></a>æŸ¥è¯¢ç¼“å­˜ - SELECTé€‰é¡¹</h2><p>å¯ä»¥åœ¨SELECTè¯­å¥ä¸­æŒ‡å®šä¸¤ä¸ªä¸æŸ¥è¯¢ç¼“å­˜ç›¸å…³çš„é€‰é¡¹ï¼š  </p><ul><li>SQL_CACHEï¼šå¦‚æœæŸ¥è¯¢ç»“æœæ˜¯å¯ç¼“å­˜çš„ï¼Œå¹¶ä¸”query_cache_type ç³»ç»Ÿå˜é‡çš„å€¼ä¸ºONæˆ–è€…DEMANDï¼Œåˆ™ç¼“å­˜æŸ¥è¯¢ç»“æœï¼›  </li><li>SQL_NO_CACHE: æœåŠ¡å™¨ä¸ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ï¼Œå®ƒæ—¢ä¸æ£€æŸ¥æŸ¥è¯¢ç¼“å­˜ï¼Œä¹Ÿä¸æ£€æŸ¥ç»“æœæ˜¯å¦å·²ç¼“å­˜ï¼Œä¹Ÿä¸ç¼“å­˜æŸ¥è¯¢ç»“æœã€‚  </li></ul><p>ä¾‹å­ï¼š  </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT SQL_CACHE id, name <span class="keyword">FROM</span> customer;</span><br><span class="line">SELECT SQL_NO_CACHE id,name <span class="keyword">FROM</span> customer;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_item  <span class="keyword">limit</span> <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> title, sellerid <span class="keyword">from</span> tb_item <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">status</span>  <span class="keyword">like</span> <span class="string">'Qcache%'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>Qcache_free_blocks</td>    <td>1</td>  </tr>  <tr>    <td>Qcache_free_memory</td>    <td>1038344</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_hits</td>    <td>5</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_inserts</td>    <td>3</td>  </tr>  <tr>    <td>Qcache_lowmen_prunes</td>    <td>0</td>  </tr>  <tr>    <td>Qcache_not_cached(å½“å‰æŸ¥è¯¢æ²¡æœ‰è¿›è¡Œç¼“å­˜)</td>    <td>2</td>  </tr>  <tr>    <td>Qcache_queryies_in_cache</td>    <td>3</td>  </tr>  <tr>    <td>Qcache_total_blocks</td>    <td>8</td>  </tr></table><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> SQL_NO_CACHE <span class="built_in">title</span>, sellerid <span class="keyword">from</span> tb_item <span class="keyword">where</span> id=<span class="number">2</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>Qcache_free_blocks</td>    <td>1</td>  </tr>  <tr>    <td>Qcache_free_memory</td>    <td>1038344</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_hits</td>    <td>6</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_insertsï¼ˆæ·»åŠ åˆ°ç¼“å­˜çš„æ•°é‡ï¼‰</td>    <td>3</td>  </tr>  <tr>    <td>Qcache_lowmen_prunes</td>    <td>0</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_not_cached(å½“å‰æŸ¥è¯¢æ²¡æœ‰è¿›è¡Œç¼“å­˜)</td>    <td>2</td>  </tr>  <tr>    <td>Qcache_queryies_in_cache</td>    <td>3</td>  </tr>  <tr>    <td>Qcache_total_blocks</td>    <td>8</td>  </tr></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> SQL_NO_CACHE title, sellerid <span class="keyword">from</span> tb_item <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">2</span>;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">status</span> <span class="keyword">like</span> <span class="string">'Qcache%'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>Qcache_free_blocks</td>    <td>1</td>  </tr>  <tr>    <td>Qcache_free_memory</td>    <td>1038344</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_hits</td>    <td>6</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_insertsï¼ˆæ·»åŠ åˆ°ç¼“å­˜çš„æ•°é‡ï¼‰</td>    <td>3</td>  </tr>  <tr>    <td>Qcache_lowmen_prunes</td>    <td>0</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_not_cached(å½“å‰æŸ¥è¯¢æ²¡æœ‰è¿›è¡Œç¼“å­˜)</td>    <td>3</td>  </tr>  <tr>    <td>Qcache_queryies_in_cache</td>    <td>3</td>  </tr>  <tr>    <td>Qcache_total_blocks</td>    <td>8</td>  </tr></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> SQL_NO_CACHE title, sellerid <span class="keyword">from</span> tb_item <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">2</span>;</span><br><span class="line"><span class="keyword">select</span> SQL_NO_CACHE title, sellerid <span class="keyword">from</span> tb_item <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">2</span>;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">status</span> <span class="keyword">like</span> <span class="string">'Qcache%'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>Qcache_free_blocks</td>    <td>1</td>  </tr>  <tr>    <td>Qcache_free_memory</td>    <td>1035936</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_hits</td>    <td>6</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_insertsï¼ˆæ·»åŠ åˆ°ç¼“å­˜çš„æ•°é‡ï¼‰</td>    <td>3</td>  </tr>  <tr>    <td>Qcache_lowmen_prunes</td>    <td>0</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_not_cached(å½“å‰æŸ¥è¯¢æ²¡æœ‰è¿›è¡Œç¼“å­˜)</td>    <td>5</td>  </tr>  <tr>    <td>Qcache_queryies_in_cache</td>    <td>3</td>  </tr>  <tr>    <td>Qcache_total_blocks</td>    <td>8</td>  </tr></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">SQL_CACHE</span> title, sellerid <span class="keyword">from</span> tb_item <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">3</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">SQL_CACHE</span> title, sellerid <span class="keyword">from</span> tb_item <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">3</span>;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">status</span> <span class="keyword">like</span> <span class="string">'Qcache%'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>Qcache_free_blocks</td>    <td>1</td>  </tr>  <tr>    <td>Qcache_free_memory</td>    <td>1038344</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_hits</td>    <td>7</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_insertsï¼ˆæ·»åŠ åˆ°ç¼“å­˜çš„æ•°é‡ï¼‰</td>    <td>4</td>  </tr>  <tr>    <td>Qcache_lowmen_prunes</td>    <td>0</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_not_cached(å½“å‰æŸ¥è¯¢æ²¡æœ‰è¿›è¡Œç¼“å­˜)</td>    <td>5</td>  </tr>  <tr>    <td>Qcache_queryies_in_cache</td>    <td>4</td>  </tr>  <tr>    <td>Qcache_total_blocks</td>    <td>10</td>  </tr></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">SQL_CACHE</span> title, sellerid <span class="keyword">from</span> tb_item <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">3</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">SQL_CACHE</span> title, sellerid <span class="keyword">from</span> tb_item <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">3</span>;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">status</span> <span class="keyword">like</span> <span class="string">'Qcache%'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>Qcache_free_blocks</td>    <td>1</td>  </tr>  <tr>    <td>Qcache_free_memory</td>    <td>1038344</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_hits</td>    <td>9</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_insertsï¼ˆæ·»åŠ åˆ°ç¼“å­˜çš„æ•°é‡ï¼‰</td>    <td>4</td>  </tr>  <tr>    <td>Qcache_lowmen_prunes</td>    <td>0</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_not_cached(å½“å‰æŸ¥è¯¢æ²¡æœ‰è¿›è¡Œç¼“å­˜)</td>    <td>5</td>  </tr>  <tr>    <td>Qcache_queryies_in_cache</td>    <td>4</td>  </tr>  <tr>    <td>Qcache_total_blocks</td>    <td>10</td>  </tr></table><h2 id="æŸ¥è¯¢ç¼“å­˜-å¤±æ•ˆåœºæ™¯"><a href="#æŸ¥è¯¢ç¼“å­˜-å¤±æ•ˆåœºæ™¯" class="headerlink" title="æŸ¥è¯¢ç¼“å­˜ - å¤±æ•ˆåœºæ™¯"></a>æŸ¥è¯¢ç¼“å­˜ - å¤±æ•ˆåœºæ™¯</h2><table>  <tr>    <th>å€¼</th>    <th>å®šä¹‰</th>  </tr>  <tr>    <td>OFF æˆ– 0</td>    <td>æŸ¥è¯¢ç¼“å­˜åŠŸèƒ½å…³é—­</td>  </tr>    <tr>    <td>ON æˆ– 1</td>    <td>æŸ¥è¯¢ç¼“å­˜åŠŸèƒ½æ‰“å¼€ï¼Œ<span style="color:red;font-weight:bolder;">SELECTçš„ç»“æœç¬¦åˆç¼“å­˜æ¡ä»¶å³ä¼šç¼“å­˜</span>ï¼›å¦åˆ™ä¸äºˆç¼“å­˜ï¼›æ˜¾å¼æŒ‡å®šSQL_NO_CACHEï¼Œåˆ™ä¸äºˆç¼“å­˜</td>  </tr>    <tr>    <td> DEMAND æˆ– 2</td>    <td>æŸ¥è¯¢ç¼“å­˜åŠŸèƒ½æŒ‰éœ€è¿›è¡Œï¼Œæ˜¾å¼æŒ‡å®š SQL_CACHE çš„SELECTè¯­å¥æ‰ä¼šç¼“å­˜ï¼›å…¶ä»–å‡ä¸äºˆç¼“å­˜</td>  </tr></table><p>å¼€å¯mysqlçš„æŸ¥è¯¢ç¼“å­˜ï¼Œå½“æ‰§è¡Œ<strong>å®Œå…¨ç›¸åŒçš„SQLè¯­å¥</strong>çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨å°±ä¼šç›´æ¥ä»ç¼“å­˜ä¸­è¯»å–ç»“æœï¼›å½“æ•°æ®è¢«ä¿®æ”¹ï¼Œä¹‹å‰çš„ç¼“å­˜å°±ä¼šå¤±æ•ˆï¼Œä¿®æ”¹æ¯”è¾ƒé¢‘ç¹çš„è¡¨ä¸é€‚åˆåšæŸ¥è¯¢ç¼“å­˜ã€‚</p><ol><li>SQLè¯­å¥ä¸ä¸€è‡´çš„æƒ…å†µï¼Œè¦æƒ³å‘½ä¸­æŸ¥è¯¢ç¼“å­˜ï¼ŒæŸ¥è¯¢çš„SQLè¯­å¥å¿…é¡»ä¸€è‡´ã€‚  </li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SQL1ï¼š</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> tb_item;<span class="comment">#3000000 è€—æ—¶0.00 second</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#SQL2ï¼š</span></span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> tb_item;<span class="comment">#3000000 è€—æ—¶2.79 second</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">status</span> <span class="keyword">like</span> <span class="string">'Qcache%'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>Qcache_free_blocks</td>    <td>1</td>  </tr>  <tr>    <td>Qcache_free_memory</td>    <td>1033888</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_hits</td>    <td>11</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_inserts</td>    <td>5</td>  </tr>  <tr>    <td>Qcache_lowmen_prunes</td>    <td>0</td>  </tr>  <tr>    <td>Qcache_not_cached(å½“å‰æŸ¥è¯¢æ²¡æœ‰è¿›è¡Œç¼“å­˜)</td>    <td>5</td>  </tr>  <tr>    <td>Qcache_queryies_in_cache</td>    <td>5</td>  </tr>  <tr>    <td>Qcache_total_blocks</td>    <td>12</td>  </tr></table><ol start="2"><li>å½“æŸ¥è¯¢è¯­å¥ä¸­æœ‰ä¸€äº›ä¸ç¡®å®šçš„æ—¶å€™ï¼Œåˆ™ä¸ä¼šç¼“å­˜ã€‚å¦‚ï¼šnow()ã€current_date()ã€curdate()ã€curtime()ã€rand()ã€uuid()ã€user()ã€database()ï¼›  </li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">now</span>(); <span class="comment"># è€—æ—¶ 0.01 second</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">now</span>(); <span class="comment"># è€—æ—¶ 0.01 secondï¼›æ—¶é—´æ˜¯å‘ç”Ÿäº†å˜åŒ–çš„ï¼›å³ä¸ä¼šèµ°ç¼“å­˜</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">status</span> <span class="keyword">like</span> <span class="string">'Qcache%'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>Qcache_free_blocks</td>    <td>1</td>  </tr>  <tr>    <td>Qcache_free_memory</td>    <td>1033888</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_hits</td>    <td>11</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_inserts</td>    <td>5</td>  </tr>  <tr>    <td>Qcache_lowmen_prunes</td>    <td>0</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_not_cached(å½“å‰æŸ¥è¯¢æ²¡æœ‰è¿›è¡Œç¼“å­˜)</td>    <td>7</td>  </tr>  <tr>    <td>Qcache_queryies_in_cache</td>    <td>5</td>  </tr>  <tr>    <td>Qcache_total_blocks</td>    <td>12</td>  </tr></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SQL1ï¼š</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_item <span class="keyword">where</span> updatetime &lt; <span class="keyword">now</span>() <span class="keyword">limit</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">#SQL2ï¼š</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">user</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">#SQL3ï¼š</span></span><br><span class="line"><span class="keyword">select</span> databse();</span><br></pre></td></tr></table></figure><ol start="3"><li>ä¸é€‚ç”¨ä»»ä½•è¡¨æŸ¥è¯¢è¯­å¥ã€‚  </li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="string">'Hello'</span>;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">status</span> <span class="keyword">like</span> <span class="string">'Qcache%'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>Qcache_free_blocks</td>    <td>1</td>  </tr>  <tr>    <td>Qcache_free_memory</td>    <td>1033888</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_hits</td>    <td>11</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_inserts</td>    <td>5</td>  </tr>  <tr>    <td>Qcache_lowmen_prunes</td>    <td>0</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_not_cached(å½“å‰æŸ¥è¯¢æ²¡æœ‰è¿›è¡Œç¼“å­˜)</td>    <td>8</td>  </tr>  <tr>    <td>Qcache_queryies_in_cache</td>    <td>5</td>  </tr>  <tr>    <td>Qcache_total_blocks</td>    <td>12</td>  </tr></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="string">'A'</span>;</span><br></pre></td></tr></table></figure><ol start="4"><li>æŸ¥è¯¢mysqlã€information_schema æˆ–è€… performance_schema æ•°æ®åº“ä¸­çš„è¡¨æ—¶ï¼Œä¸ä¼šèµ°æŸ¥è¯¢ç¼“å­˜ã€‚  </li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line"><span class="comment">#information_schema</span></span><br><span class="line"><span class="comment">#mysql</span></span><br><span class="line"><span class="comment">#performance_schema</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> information_schema.engines;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">status</span> <span class="keyword">like</span> <span class="string">'Qcache%'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>Qcache_free_blocks</td>    <td>1</td>  </tr>  <tr>    <td>Qcache_free_memory</td>    <td>1033888</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_hits</td>    <td>11</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_inserts</td>    <td>5</td>  </tr>  <tr>    <td>Qcache_lowmen_prunes</td>    <td>0</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_not_cached(å½“å‰æŸ¥è¯¢æ²¡æœ‰è¿›è¡Œç¼“å­˜)</td>    <td>9</td>  </tr>  <tr>    <td>Qcache_queryies_in_cache</td>    <td>5</td>  </tr>  <tr>    <td>Qcache_total_blocks</td>    <td>12</td>  </tr></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> information_schema.engines;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">status</span> <span class="keyword">like</span> <span class="string">'Qcache%'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>Qcache_free_blocks</td>    <td>1</td>  </tr>  <tr>    <td>Qcache_free_memory</td>    <td>1033888</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_hits</td>    <td>11</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_inserts</td>    <td>5</td>  </tr>  <tr>    <td>Qcache_lowmen_prunes</td>    <td>0</td>  </tr>  <tr style="color:red;font-weight:bolder;">    <td>Qcache_not_cached(å½“å‰æŸ¥è¯¢æ²¡æœ‰è¿›è¡Œç¼“å­˜)</td>    <td>10</td>  </tr>  <tr>    <td>Qcache_queryies_in_cache</td>    <td>5</td>  </tr>  <tr>    <td>Qcache_total_blocks</td>    <td>12</td>  </tr></table><ol start="5"><li><p>åœ¨å­˜å‚¨çš„å‡½æ•°ï¼Œè§¦å‘å™¨æˆ–è€…æ—¶é—´çš„ä¸»ä½“å†…æ‰§è¡Œçš„æŸ¥è¯¢ï¼›</p></li><li><p>å¦‚æœè¡¨æ›´æ”¹ï¼Œåˆ™ä½¿ç”¨è¯¥è¡¨çš„æ‰€æœ‰é«˜é€Ÿç¼“å­˜æŸ¥è¯¢éƒ½å°†å˜ä¸ºæ— æ•ˆå¹¶ä»é«˜é€Ÿç¼“å­˜ä¸­åˆ é™¤ã€‚è¿™åŒ…æ‹¬ä½¿ç”¨<strong>MERGE</strong>æ˜ å°„åˆ°å·²æ›´æ”¹è¡¨çš„æŸ¥è¯¢ã€‚ä¸€ä¸ªè¡¨å¯ä»¥è¢«è®¸å¤šç±»å‹çš„è¯­å¥ï¼Œå¦‚è¢«æ”¹å˜INSERTã€UPDATEã€DELETEã€TRUNCATE TABLEã€ALTER TABLEã€DROP TABLE æˆ–è€… DROP DATABASEã€‚  </p></li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> tb_item;<span class="comment">#è€—æ—¶ 0.00 second</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> tb_item <span class="keyword">set</span> title=<span class="string">'test1'</span> <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> tb_item;<span class="comment">#è€—æ—¶ 2.67 secondï¼›è¯¥SQLå¤±æ•ˆï¼›ä½†æ˜¯å¤±æ•ˆçš„åŒæ—¶åˆå»è¿›è¡Œäº†ç¼“å­˜ï¼›å½“å‰æŸ¥è¯¢æ—¶å¹¶æœªç¼“å­˜</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> tb_item;<span class="comment">#è€—æ—¶ 0.00 secondï¼›æ­¤æ—¶å†å»æŸ¥è¯¢ï¼›å³æŸ¥è¯¢çš„ç¼“å­˜åŒºå†…çš„å†…å®¹</span></span><br></pre></td></tr></table></figure><h2 id="å†…å­˜ä¼˜åŒ–-ä¼˜åŒ–åŸåˆ™"><a href="#å†…å­˜ä¼˜åŒ–-ä¼˜åŒ–åŸåˆ™" class="headerlink" title="å†…å­˜ä¼˜åŒ– - ä¼˜åŒ–åŸåˆ™"></a>å†…å­˜ä¼˜åŒ– - ä¼˜åŒ–åŸåˆ™</h2><h3 id="å†…å­˜ä¼˜åŒ–åŸåˆ™"><a href="#å†…å­˜ä¼˜åŒ–åŸåˆ™" class="headerlink" title="å†…å­˜ä¼˜åŒ–åŸåˆ™"></a>å†…å­˜ä¼˜åŒ–åŸåˆ™</h3><ol><li>å°†å°½é‡å¤šçš„å†…å­˜åˆ†é…ç»™MySQLåšç¼“å­˜(æé«˜mysqlçš„è®¿é—®æ•ˆç‡)ï¼Œä½†è¦ç»™æ“ä½œç³»ç»Ÿå’Œå…¶ä»–ç¨‹åºé¢„ç•™è¶³å¤Ÿå†…å­˜ï¼›</li><li>MyISAMå­˜å‚¨å¼•æ“çš„æ•°æ®æ–‡ä»¶è¯»å–ä¾èµ–äºæ“ä½œç³»ç»Ÿè‡ªèº«çš„I/Oç¼“å­˜ï¼Œå› æ­¤ï¼Œå¦‚æœæœ‰MyISAMè¡¨ï¼Œå°±è¦é¢„ç•™æ›´å¤šçš„å†…å­˜ç»™æ“ä½œç³»ç»ŸåšI/Oç¼“å­˜ã€‚</li><li>æ’åºåŒºã€è¿æ¥åŒºç­‰ç¼“å­˜æ˜¯åˆ†é…ç»™æ¯ä¸ªæ•°æ®åº“ä¼šè¯ï¼ˆsessionï¼‰ä¸“ç”¨çš„ï¼Œå…¶é»˜è®¤å€¼çš„è®¾ç½®è¦æ ¹æ®æœ€å¤§è¿æ¥æ•°åˆç†åˆ†é…ï¼Œå¦‚æœè®¾ç½®å¤ªå¤§ï¼Œä¸ä½†æµªè´¹èµ„æºï¼Œè€Œä¸”åœ¨å¹¶å‘è¿æ¥è¾ƒé«˜æ—¶ä¼šå¯¼è‡´ç‰©ç†å†…å­˜è€—å°½ã€‚</li></ol><h2 id="å†…å­˜ä¼˜åŒ–-MyISAMå†…å­˜ä¼˜åŒ–"><a href="#å†…å­˜ä¼˜åŒ–-MyISAMå†…å­˜ä¼˜åŒ–" class="headerlink" title="å†…å­˜ä¼˜åŒ– - MyISAMå†…å­˜ä¼˜åŒ–"></a>å†…å­˜ä¼˜åŒ– - MyISAMå†…å­˜ä¼˜åŒ–</h2><p>MyISAMçš„ç¼“å­˜æœºåˆ¶ï¼š  </p><p>MyISAMå­˜å‚¨å¼•æ“ä½¿ç”¨key_bufferç¼“å­˜ç´¢å¼•å—ï¼ˆæ²¡æœ‰ç¼“å­˜æ•°æ®å—ï¼‰ï¼ŒåŠ é€ŸMyISAMç´¢å¼•çš„è¯»å†™é€Ÿåº¦ï¼Œå¯¹äºMyISAMè¡¨çš„æ•°æ®å—ï¼Œmysqlæ²¡æœ‰ç‰¹åˆ«çš„ç¼“å­˜æœºåˆ¶ï¼Œå®Œå…¨ä¾èµ–äºæ“ä½œç³»ç»Ÿçš„I/Oç¼“å­˜ã€‚  </p><p><strong>key_buffer_size</strong>  </p><p>key_buffer_sizeå†³å®šMyISAMç´¢å¼•å—ç¼“å­˜åŒºçš„å¤§å°ï¼Œç›´æ¥å½±å“åˆ°MyISAMè¡¨çš„å­˜å–æ•ˆç‡ã€‚  </p><p>å¯ä»¥åœ¨mysqlå‚æ•°æ–‡ä»¶ä¸­è®¾ç½®key_buffer_sizeçš„å€¼ï¼Œå¯¹äºä¸€èˆ¬MyISAMæ•°æ®åº“ï¼Œå»ºè®®è‡³å°‘å°†1/4å¯ç”¨å†…å­˜åˆ†é…ç»™key_buffer_sizeã€‚  </p><p>åœ¨/usr/my.cnf ä¸­åšå¦‚ä¸‹é…ç½®ï¼š  </p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">key_buffer_size</span>=<span class="number">512</span>M</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">'key_buffer_size'</span>;<span class="comment">#mysql å‘½ä»¤è¡Œ</span></span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>key_buffer_size</td>    <td>8388608(å•ä½ä¸ºå­—èŠ‚ï¼›é»˜è®¤å¤§å°)</td>  </tr></table><p><strong>read_buffer_size</strong>  </p><p>å¦‚æœéœ€è¦ç»å¸¸é¡ºåºæ‰«æMyISAMè¡¨ï¼Œå¯ä»¥é€šè¿‡å¢å¤§read_buffer_sizeçš„å€¼æ¥æ”¹å–„æ€§èƒ½ã€‚  </p><p>ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯read_buffer_sizeæ˜¯æ¯ä¸ªsessionç‹¬å çš„ï¼Œå¦‚æœé»˜è®¤å€¼è®¾ç½®å¤ªå¤§ï¼Œå°±ä¼šé€ æˆå†…å­˜æµªè´¹ã€‚  </p><p><strong>read_rnd_buffer_size</strong>  </p><p>å¯¹äºéœ€è¦åšæ’åºçš„MyISAMè¡¨çš„æŸ¥è¯¢ï¼Œå¦‚å¸¦æœ‰ order by å­å¥çš„SQLï¼Œé€‚å½“å¢åŠ read_rnd_buffer_sizeçš„å€¼ï¼Œå¯ä»¥æ”¹å–„æ­¤ç±»çš„SQLæ€§èƒ½ã€‚  </p><p>ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯read_rnd_buffer_size æ˜¯æ¯ä¸ªsessionç‹¬å çš„ï¼Œå¦‚æœé»˜è®¤å€¼è®¾ç½®å¤ªå¤§ï¼Œå°±ä¼šé€ æˆå†…å­˜æµªè´¹ã€‚  </p><h2 id="å†…å­˜ä¼˜åŒ–-InnoDBå†…å­˜ä¼˜åŒ–"><a href="#å†…å­˜ä¼˜åŒ–-InnoDBå†…å­˜ä¼˜åŒ–" class="headerlink" title="å†…å­˜ä¼˜åŒ– - InnoDBå†…å­˜ä¼˜åŒ–"></a>å†…å­˜ä¼˜åŒ– - InnoDBå†…å­˜ä¼˜åŒ–</h2><p>innodbçš„ç¼“å­˜æœºåˆ¶ï¼š<br>InnoDBç”¨ä¸€å—å†…å­˜åŒºåšIOç¼“å­˜æ± ï¼Œè¯¥ç¼“å­˜æ± ä¸ä»…ç”¨æ¥ç¼“å­˜InnoDBçš„ç´¢å¼•å—ï¼Œè€Œä¸”ä¹Ÿç”¨æ¥ç¼“å­˜InnoDBçš„æ•°æ®å—ã€‚  </p><p><strong>innodb_buffer_pool_size</strong>  </p><p>è¯¥å˜é‡å†³å®šäº†innodbå­˜å‚¨å¼•æ“è¡¨æ•°æ®å’Œç´¢å¼•æ•°æ®çš„æœ€å¤§ç¼“å­˜åŒºå¤§å°ã€‚<br>åœ¨ä¿è¯æ“ä½œç³»ç»Ÿä»¥åŠå…¶ä»–ç¨‹åºæœ‰è¶³å¤Ÿå†…å­˜å¯ç”¨çš„æƒ…å†µä¸‹ï¼Œinnodb_buffer_pool_sizeçš„å€¼è¶Šå¤§ï¼Œç¼“å­˜å‘½ä¸­ç‡è¶Šé«˜ï¼Œè®¿é—®innodbè¡¨çš„éœ€è¦çš„ç£ç›˜I/Oå°±è¶Šå°‘ï¼Œæ€§èƒ½ä¹Ÿå°±è¶Šé«˜ã€‚  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">'innodb_buffer_pool_size'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>innodb_buffer_pool_size</td>    <td>134217728(å•ä½ä¸ºå­—èŠ‚ï¼›é»˜è®¤å¤§å°128Mï¼›134217728/1024-->131072ï¼ˆæ¢ç®—æˆBï¼‰ï¼Œ134217728/1024/1024-->128ï¼ˆæ¢ç®—æˆMï¼‰ï¼›)</td>  </tr></table><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vi /usr/<span class="keyword">my</span>.cnf</span><br><span class="line"><span class="comment"># innodb_buffer_pool_size=512M #ä¿®æ”¹å†…å®¹</span></span><br></pre></td></tr></table></figure><p><strong>innodb_log_buffer_size</strong>  </p><p>å†³å®šäº†innodbé‡åšæ—¥å¿—ç¼“å­˜çš„å¤§å°ï¼Œå¯¹äºé¿å…äº§ç”Ÿå¤§é‡æ›´æ–°è®°å½•çš„å¤§äº‹åŠ¡ï¼Œå¢åŠ innodb_log_buffer_sizeçš„å¤§å°ï¼Œå¯ä»¥é¿å…innodbåœ¨äº‹åŠ¡æäº¤å‰å°±æ‰§è¡Œä¸å¿…è¦çš„æ—¥å¿—å†™å…¥ç£ç›˜æ“ä½œã€‚  </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi /usr/my.cnf</span><br><span class="line"><span class="comment"># innodb_log_buffer_size=10M #ä¿®æ”¹å†…å®¹</span></span><br><span class="line">service mysql restart</span><br></pre></td></tr></table></figure><h2 id="å¹¶å‘å‚æ•°è°ƒæ•´"><a href="#å¹¶å‘å‚æ•°è°ƒæ•´" class="headerlink" title="å¹¶å‘å‚æ•°è°ƒæ•´"></a>å¹¶å‘å‚æ•°è°ƒæ•´</h2><h3 id="mysqlå¹¶å‘å‚æ•°è°ƒæ•´"><a href="#mysqlå¹¶å‘å‚æ•°è°ƒæ•´" class="headerlink" title="mysqlå¹¶å‘å‚æ•°è°ƒæ•´"></a>mysqlå¹¶å‘å‚æ•°è°ƒæ•´</h3><p>ä»å®ç°ä¸Šæ¥è¯´ï¼ŒMySQL Serveræ˜¯å¤šçº¿ç¨‹ç»“æ„ï¼ŒåŒ…æ‹¬åå°çº¿ç¨‹å’Œå®¢æˆ·æœåŠ¡çº¿ç¨‹ã€‚  </p><p>å¤šçº¿ç¨‹å¯ä»¥æœ‰æ•ˆåˆ©ç”¨æœåŠ¡å™¨èµ„æºï¼Œæé«˜æ•°æ®åº“çš„å¹¶å‘æ€§èƒ½ã€‚  </p><p>åœ¨mysqlä¸­ï¼Œæ§åˆ¶å¹¶å‘è¿æ¥å’Œçº¿ç¨‹çš„ä¸»è¦å‚æ•°åŒ…æ‹¬ max_connectionsã€back_logã€thread_cache_sizeã€table_open_sizeï¼›  </p><h4 id="max-connectionsï¼ˆæœ€å¤§è¿æ¥æ•°ï¼‰"><a href="#max-connectionsï¼ˆæœ€å¤§è¿æ¥æ•°ï¼‰" class="headerlink" title="max_connectionsï¼ˆæœ€å¤§è¿æ¥æ•°ï¼‰"></a>max_connectionsï¼ˆæœ€å¤§è¿æ¥æ•°ï¼‰</h4><p>é‡‡ç”¨max_connections æ§åˆ¶å…è®¸è¿æ¥åˆ°MySQLæ•°æ®åº“çš„æœ€å¤§æ•°é‡ï¼Œé»˜è®¤å€¼æ˜¯151ã€‚  </p><p>å¦‚æœçŠ¶æ€å˜é‡ connection_errors_max_connections ä¸ä¸ºé›¶ï¼Œå¹¶ä¸”ä¸€ç›´å¢é•¿ï¼Œåˆ™è¯´æ˜ä¸æ–­æœ‰è¿æ¥è¯·æ±‚å› æ•°æ®åº“è¿æ¥æ•°å·²ç»è¾¾åˆ°å…è®¸æœ€å¤§å€¼è€Œå¤±è´¥ï¼Œè¿™æ—¶å¯ä»¥è€ƒè™‘å¢å¤§max_connectionsçš„å€¼ã€‚  </p><p>MySQLæœ€å¤§å¯æ”¯æŒçš„è¿æ¥æ•°ï¼Œå–å†³äºå¾ˆå¤šå› ç´ ï¼ŒåŒ…æ‹¬ç»™å®šæ“ä½œç³»ç»Ÿå¹³å°çš„çº¿ç¨‹åº“çš„è´¨é‡ã€å†…å­˜å¤§å°ã€æ¯ä¸ªè¿æ¥çš„è´Ÿè·ã€CPUçš„å¤„ç†é€Ÿåº¦ï¼ŒæœŸæœ›çš„å“åº”æ—¶é—´ç­‰ã€‚  </p><p>åœ¨Linuxå¹³å°ä¸‹ï¼Œæ€§èƒ½å¥½çš„æœåŠ¡å™¨ï¼Œæ”¯æŒ500-1000ä¸ªè¿æ¥éƒ½ä¸æ˜¯éš¾äº‹ï¼Œéœ€è¦æ ¹æ®æœåŠ¡å™¨æ€§èƒ½è¿›è¡Œè¯„ä¼°è®¾å®šã€‚  </p><h4 id="back-log"><a href="#back-log" class="headerlink" title="back_log"></a>back_log</h4><p>back_log å‚æ•°æ§åˆ¶MySQLç›‘å¬TCPç«¯å£æ—¶è®¾ç½®çš„ç§¯å‹è¯·æ±‚æ ˆå¤§å°ã€‚  </p><p>å¦‚æœmysqlçš„è¿æ¥æ•°è¾¾åˆ°max_connectionsæ—¶ï¼Œæ–°æ¥çš„è¯·æ±‚å°†ä¼šè¢«å­˜åœ¨å †æ ˆä¸­ï¼Œä»¥ç­‰å¾…æŸä¸€è¿æ¥é‡Šæ”¾èµ„æºï¼Œè¯¥å †æ ˆçš„æ•°é‡å³back_logï¼Œå¦‚æœç­‰å¾…è¿æ¥çš„æ•°é‡è¶…è¿‡back_logï¼Œå°†ä¸è¢«æˆäºˆè¿æ¥èµ„æºï¼Œå°†ä¼šæŠ¥é”™ã€‚  </p><p>5.6.6ç‰ˆæœ¬ä¹‹å‰é»˜è®¤å€¼ä¸º50ï¼Œä¹‹åçš„ç‰ˆæœ¬é»˜è®¤ä¸º50+ï¼ˆmax_connections/5ï¼‰ï¼Œä½†æœ€å¤§ä¸è¶…è¿‡900ã€‚  </p><p>å¦‚æœéœ€è¦æ•°æ®åº“åœ¨è¾ƒçŸ­çš„æ—¶é—´å†…å¤„ç†å¤§é‡è¿æ¥è¯·æ±‚ï¼Œå¯ä»¥è€ƒè™‘é€‚å½“å¢å¤§back_logçš„å€¼ã€‚  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">'back_log'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>back_log</td>    <td>80(é»˜è®¤ä¸ªæ•°)</td>  </tr></table><h4 id="table-open-cache"><a href="#table-open-cache" class="headerlink" title="table_open_cache"></a>table_open_cache</h4><p>è¯¥å‚æ•°ç”¨æ¥æ§åˆ¶æ‰€æœ‰SQLè¯­å¥æ‰§è¡Œçº¿ç¨‹å¯æ‰“å¼€è¡¨ç¼“å­˜çš„æ•°é‡ï¼Œè€Œåœ¨æ‰§è¡ŒSQLè¯­å¥æ—¶ï¼Œæ¯ä¸€ä¸ªSQLæ‰§è¡Œçº¿ç¨‹è‡³å°‘è¦æ‰“å¼€ä¸€ä¸ªè¡¨ç¼“å­˜ï¼Œè¯¥å‚æ•°çš„å€¼åº”è¯¥æ ¹æ®è®¾ç½®çš„æœ€å¤§è¿æ¥æ•°max_connections ä»¥åŠæ¯ä¸ªè¿æ¥æ‰§è¡Œå…³è”æŸ¥è¯¢ä¸­æ¶‰åŠçš„ç™½é¸¥çš„æœ€å¤§æ•°é‡æ¥å†³å®šã€‚  </p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">max_connections x N<span class="comment">;</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">'table_open_cache'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>table_open_cache</td>    <td>2000(é»˜è®¤å¤§å°)</td>  </tr></table><h4 id="thread-cache-sizeï¼ˆçº¿ç¨‹ç¼“å­˜å¤§å°ï¼‰"><a href="#thread-cache-sizeï¼ˆçº¿ç¨‹ç¼“å­˜å¤§å°ï¼‰" class="headerlink" title="thread_cache_sizeï¼ˆçº¿ç¨‹ç¼“å­˜å¤§å°ï¼‰"></a>thread_cache_sizeï¼ˆçº¿ç¨‹ç¼“å­˜å¤§å°ï¼‰</h4><p>ä¸ºäº†åŠ å¿«è¿æ¥æ•°æ®åº“çš„é€Ÿåº¦ï¼ŒMySQLä¼šç¼“å­˜ä¸€å®šæ•°é‡çš„å®¢æˆ·æœåŠ¡çº¿ç¨‹ï¼ˆçº¿ç¨‹æ± ï¼‰ä»¥å¤‡é‡ç”¨ï¼Œé€šè¿‡å‚æ•° thread_cache_size å¯æ§åˆ¶MySQLç¼“å­˜å®¢æˆ·æœåŠ¡çº¿ç¨‹çš„æ•°é‡ï¼ˆçº¿ç¨‹æ± çš„å¤§å°ï¼‰ã€‚  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">'thread_cache_size'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>thread_cache_size</td>    <td>9(é»˜è®¤å¤§å°9ä¸ªçº¿ç¨‹)</td>  </tr></table><h4 id="innodb-lock-wait-timeoutï¼ˆinnodbè¡Œé”çš„ç­‰å¾…æ—¶é—´ï¼‰"><a href="#innodb-lock-wait-timeoutï¼ˆinnodbè¡Œé”çš„ç­‰å¾…æ—¶é—´ï¼‰" class="headerlink" title="innodb_lock_wait_timeoutï¼ˆinnodbè¡Œé”çš„ç­‰å¾…æ—¶é—´ï¼‰"></a>innodb_lock_wait_timeoutï¼ˆinnodbè¡Œé”çš„ç­‰å¾…æ—¶é—´ï¼‰</h4><p>è¯¥å‚æ•°æ˜¯ç”¨æ¥è®¾ç½®InnoDBäº‹åŠ¡ç­‰å¾…è¡Œé”çš„æ—¶é—´ï¼Œé»˜è®¤å€¼æ—¶å€™50msã€‚  </p><p>å¯ä»¥æ ¹æ®éœ€è¦è¿›è¡ŒåŠ¨æ€è®¾ç½®ã€‚  </p><p>å¯¹äºéœ€è¦å¿«é€Ÿåé¦ˆçš„ä¸šåŠ¡ç³»ç»Ÿæ¥è¯´ï¼Œå¯ä»¥å°†è¡Œé”çš„ç­‰å¾…æ—¶é—´è°ƒå°ï¼Œä»¥é¿å…äº‹åŠ¡é•¿æ—¶é—´æŒ‚èµ·ï¼›  </p><p>å¯¹äºåå°è¿è¡Œçš„æ‰¹é‡å¤„ç†ç¨‹åºæ¥è¯´ï¼Œå¯ä»¥å°†è¡Œé”çš„ç­‰å¾…æ—¶é—´è°ƒå¤§ï¼Œä»¥é¿å…å‘ç”Ÿå¤§çš„å›æ»šæ“ä½œã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">'innodb_lock_wait_timeout'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>innodb_lock_wait_timeout</td>    <td>50</td>  </tr></table><h2 id="é”-é”çš„æ¦‚è¿°åŠåˆ†ç±»"><a href="#é”-é”çš„æ¦‚è¿°åŠåˆ†ç±»" class="headerlink" title="é” - é”çš„æ¦‚è¿°åŠåˆ†ç±»"></a>é” - é”çš„æ¦‚è¿°åŠåˆ†ç±»</h2><h3 id="é”æ¦‚è¿°"><a href="#é”æ¦‚è¿°" class="headerlink" title="é”æ¦‚è¿°"></a>é”æ¦‚è¿°</h3><p>é”æ˜¯è®¡ç®—æœºåè°ƒå¤šä¸ªè¿›ç¨‹ æˆ–è€… çº¿ç¨‹ å¹¶å‘è®¿é—®æŸä¸€èµ„æºçš„æœºåˆ¶ï¼ˆé¿å…äº‰æŠ¢ï¼‰ã€‚  </p><p>åœ¨æ•°æ®åº“ä¸­ï¼Œé™¤äº†ä¼ ç»Ÿçš„è®¡ç®—èµ„æºï¼ˆå¦‚CPUã€RAMã€I/Oç­‰ï¼‰çš„äº‰ç”¨ä»¥å¤–ï¼Œæ•°æ®ä¹Ÿæ˜¯ä¸€ç§ä¾›è®¸å¤šç”¨æˆ·å…±äº«çš„èµ„æºã€‚  </p><p>å¦‚ä½•ä¿è¯æ•°æ®å¹¶å‘è®¿é—®çš„ä¸€è‡´æ€§ã€æœ‰æ•ˆæ€§æ˜¯æ‰€æœ‰æ•°æ®åº“å¿…é¡»è§£å†³çš„ä¸€ä¸ªé—®é¢˜ï¼Œé”å†²çªä¹Ÿæ˜¯å½±å“æ•°æ®åº“å¹¶å‘è®¿é—®æ€§èƒ½çš„ä¸€ä¸ªé‡è¦å› ç´ ã€‚  </p><p>ä»è¿™ä¸ªè§’åº¦æ¥è¯´ï¼Œé”å¯¹æ•°æ®åº“è€Œè¨€æ˜¾å¾—å°¤å…¶é‡è¦ï¼Œä¹Ÿæ›´åŠ å¤æ‚ã€‚  </p><h3 id="é”åˆ†ç±»"><a href="#é”åˆ†ç±»" class="headerlink" title="é”åˆ†ç±»"></a>é”åˆ†ç±»</h3><p>ä»å¯¹æ•°æ®æ“ä½œçš„ç²’åº¦åˆ†ä¸ºï¼š  </p><ol><li>è¡¨é”ï¼šæ“ä½œæ—¶ï¼Œä¼šé”å®šæ•´ä¸ªè¡¨</li><li>è¡Œé”ï¼šæ“ä½œæ—¶ï¼Œä¼šé”å®šå½“å‰æ“ä½œè¡Œ</li></ol><p>ä»å¯¹æ•°æ®æ“ä½œçš„ç±»å‹åˆ†ï¼š  </p><ol><li>è¯»é”ï¼ˆå…±äº«é”ï¼‰ï¼šé’ˆå¯¹åŒä¸€ä»½æ•°æ®ï¼Œå¤šä¸ªè¯»æ“ä½œå¯ä»¥åŒæ—¶è¿›è¡Œè€Œä¸ä¼šäº’ç›¸å½±å“</li><li>å†™é”ï¼ˆæ’å®ƒé”ï¼‰ï¼šå½“å‰æ“ä½œæ²¡æœ‰å®Œæˆä¹‹å‰ï¼Œä»–ä¼šé˜»æ–­å…¶ä»–å†™é”å’Œè¯»é”</li></ol><h2 id="é”-MySQLå¯¹é”çš„æ”¯æŒ"><a href="#é”-MySQLå¯¹é”çš„æ”¯æŒ" class="headerlink" title="é” - MySQLå¯¹é”çš„æ”¯æŒ"></a>é” - MySQLå¯¹é”çš„æ”¯æŒ</h2><p>ç›¸å¯¹å…¶ä»–æ•°æ®åº“è€Œè¨€ï¼ŒMySQLçš„é”æœºåˆ¶æ¯”è¾ƒç®€å•ã€‚  </p><p>å…¶æœ€æ˜¾è‘—çš„ç‰¹ç‚¹æ˜¯ä¸åŒçš„å­˜å‚¨å¼•æ“æ”¯æŒä¸åŒçš„é”æœºåˆ¶ã€‚  </p><p>ä¸‹æ ‡ç½—åˆ—å‡ºäº†å„ä¸ªå­˜å‚¨å¼•æ“å¯¹é”çš„æ”¯æŒæƒ…å†µã€‚  </p><table>  <tr>    <th>å­˜å‚¨å¼•æ“</th>    <th>è¡¨çº§é”</th>    <th>è¡Œçº§é”</th>    <th>é¡µé¢é”</th>  </tr>  <tr>    <td>MyISAM</td>    <td>æ”¯æŒ</td>    <td>ä¸æ”¯æŒ</td>    <td>ä¸æ”¯æŒ</td>  </tr>    <tr>    <td>InnoDB</td>    <td>æ”¯æŒ</td>    <td>æ”¯æŒ</td>    <td>ä¸æ”¯æŒ</td>  </tr>    <tr>    <td>MEMORY</td>    <td>æ”¯æŒ</td>    <td>ä¸æ”¯æŒ</td>    <td>ä¸æ”¯æŒ</td>  </tr>    <tr>    <td>BDB</td>    <td>æ”¯æŒ</td>    <td>ä¸æ”¯æŒ</td>    <td>æ”¯æŒ</td>  </tr></table><p>MySQLè¿™ä¸‰ç§é”çš„ç‰¹æ€§å¯å¤§è‡´å½’çº³å¦‚ä¸‹ï¼š  </p><table>  <tr>    <th>é”ç±»å‹</th>    <th>ç‰¹å®š</th>  </tr>  <tr>    <td>è¡¨çº§é”</td>    <td>åå‘MyISAMå­˜å‚¨å¼•æ“ï¼Œå¼€é”€å°ï¼ŒåŠ é”å¿«ï¼›ä¸ä¼šå‡ºç°æ­»é”ï¼›é”å®šç²’åº¦å¤§ï¼Œå‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€é«˜ï¼Œå¹¶å‘åº¦æœ€ä½ã€‚</td>  </tr>    <tr>    <td>è¡Œçº§é”</td>    <td>åå‘InnoDBå­˜å‚¨å¼•æ“ï¼Œå¼€é”€å¤§ï¼ŒåŠ é”æ…¢ï¼›ä¼šå‡ºç°æ­»é”ï¼›é”å®šç²’åº¦æœ€å°ï¼Œå‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€ä½ï¼Œå¹¶å‘åº¦ä¹Ÿæœ€é«˜ã€‚</td>  </tr>    <tr>    <td>é¡µé¢é”</td>    <td>å¼€é”€å’ŒåŠ é”æ—¶é—´ä»‹äºè¡¨é”å’Œè¡Œé”ä¹‹é—´ï¼›ä¼šå‡ºç°æ­»é”ï¼›é”å®šç²’åº¦ä»‹äºè¡¨é”å’Œè¡Œé”ä¹‹é—´ï¼Œå¹¶å‘åº¦ä¸€èˆ¬ã€‚</td>  </tr></table><p>ä»ä¸Šè¿°ç‰¹ç‚¹å¯è§ï¼Œå¾ˆéš¾ç¬¼ç»Ÿçš„è¯´å“ªç§é”æ›´å¥½ï¼Œåªèƒ½å°±å…·ä½“åº”ç”¨çš„ç‰¹ç‚¹æ¥è¯´å“ªç§é”æ›´åˆé€‚ã€‚  </p><p>ä»…ä»é”çš„è§’åº¦æ¥è¯´ï¼š<br>  è¡¨çº§é”æ›´é€‚åˆäºä»¥æŸ¥è¯¢ä¸ºä¸»ï¼Œåªæœ‰å°‘é‡æŒ‰ç´¢å¼•æ¡ä»¶æ›´æ–°æ•°æ®çš„åº”ç”¨ï¼Œå¦‚Webåº”ç”¨ï¼›<br>  è€Œè¡Œçº§é”åˆ™æ›´é€‚åˆäºæœ‰å¤§é‡æŒ‰ç´¢å¼•æ¡ä»¶å¹¶å‘æ›´æ–°å°‘é‡ä¸åŒæ•°æ®ï¼ŒåŒæ—¶åˆæœ‰å¹¶å‘æŸ¥è¯¢çš„åº”ç”¨ï¼Œå¦‚ä¸€äº›åœ¨çº¿äº‹åŠ¡å¤„ç†ï¼ˆOLTPï¼‰ç³»ç»Ÿï¼›  </p><h2 id="é”-MyISAMè¡¨é”-è¯»é”"><a href="#é”-MyISAMè¡¨é”-è¯»é”" class="headerlink" title="é” - MyISAMè¡¨é” - è¯»é”"></a>é” - MyISAMè¡¨é” - è¯»é”</h2><p>è¯»é”ï¼ˆå…±äº«é”ï¼‰ï¼šé’ˆå¯¹åŒä¸€ä»½æ•°æ®ï¼Œå¤šä¸ªè¯»æ“ä½œå¯ä»¥åŒæ—¶è¿›è¡Œè€Œä¸ä¼šäº’ç›¸å½±å“ã€‚</p><p>MyISAMå­˜å‚¨å¼•æ“æ”¯æŒè¡¨é”ï¼Œè¿™ä¹Ÿæ˜¯MySQLå¼€å§‹å‡ ä¸ªç‰ˆæœ¬ä¸­å”¯ä¸€æ”¯æŒçš„é”ç±»å‹ã€‚  </p><h3 id="å¦‚ä½•åŠ è¡¨é”"><a href="#å¦‚ä½•åŠ è¡¨é”" class="headerlink" title="å¦‚ä½•åŠ è¡¨é”"></a>å¦‚ä½•åŠ è¡¨é”</h3><p>MyISAMåœ¨æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼ˆSELECTï¼‰å‰ï¼Œä¼šè‡ªåŠ¨ç»™æ¶‰åŠçš„æ‰€æœ‰è¡¨åŠ è¯»é”ï¼Œåœ¨æ‰§è¡Œæ›´æ–°æ“ä½œï¼ˆUPDATEã€DELETEã€INSERTç­‰ï¼‰ï¼Œä¼šè‡ªåŠ¨ç»™æ¶‰åŠçš„è¡¨åŠ å†™é”ï¼Œè¿™ä¸ªè¿‡ç¨‹å¹¶ä¸éœ€è¦ç”¨æˆ·å¹²é¢„ã€‚  </p><p>å› æ­¤ï¼Œç”¨æˆ·ä¸€èˆ¬ä¸éœ€è¦ç›´æ¥ç”¨LOCK TABLEå‘½ä»¤ç»™MyISAMè¡¨æ˜¾å¼åŠ é”ã€‚  </p><p>æ˜¾ç¤ºåŠ è¡¨é”è¯­æ³•ï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åŠ è¯»é”ï¼š  </span></span><br><span class="line"><span class="keyword">lock</span> <span class="keyword">table</span> table_name <span class="keyword">read</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">#åŠ å†™é”ï¼š  </span></span><br><span class="line"><span class="keyword">lock</span> <span class="keyword">table</span> table_name write;</span><br></pre></td></tr></table></figure><h3 id="è¯»é”æ¡ˆä¾‹"><a href="#è¯»é”æ¡ˆä¾‹" class="headerlink" title="è¯»é”æ¡ˆä¾‹"></a>è¯»é”æ¡ˆä¾‹</h3><p>å‡†å¤‡ç¯å¢ƒ  </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">create database demo_03<span class="built_in"> default </span><span class="attribute">charset</span>=utf8mb4;</span><br><span class="line"></span><br><span class="line">use demo_03;</span><br><span class="line"></span><br><span class="line">CREATE TABLE <span class="string">'tb_book'</span>(</span><br><span class="line">  <span class="string">'id'</span> INT(11) AUTO_INCREMENT,</span><br><span class="line">  <span class="string">'name'</span> VARCHAR(50)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'publish_name'</span> DATE<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'status'</span> CHAR(1)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY KEY (<span class="string">'id'</span>)</span><br><span class="line">)<span class="attribute">ENGINE</span>=myisam<span class="built_in"> DEFAULT </span><span class="attribute">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ’å…¥tb_book åŸºç¡€æ•°æ®</span></span><br><span class="line"></span><br><span class="line">CREATE TABLE <span class="string">'tb_user'</span>(</span><br><span class="line">  <span class="string">'id'</span> INT(11) AUTO_INCREMENT,</span><br><span class="line">  <span class="string">'name'</span> VARCHAR(50)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY KEY(<span class="string">'id'</span>)</span><br><span class="line">)<span class="attribute">ENGINE</span>=myisam<span class="built_in"> DEFAULT </span><span class="attribute">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ’å…¥tb_user åŸºç¡€æ•°æ®</span></span><br><span class="line"></span><br><span class="line">show tables;</span><br><span class="line"></span><br><span class="line">lock table tb_book read;</span><br><span class="line"></span><br><span class="line">select * <span class="keyword">from</span> tb_books;</span><br><span class="line"></span><br><span class="line">select * <span class="keyword">from</span> tb_user;# Table <span class="string">'tb_user'</span> was <span class="keyword">not</span> locked with LOCK TABLES é”å®štb_bookè¡¨é€”ä¸­æ— æ³•å»æ“ä½œå…¶ä»–è¡¨ï¼›é™¤éå½“å‰tb_bookè¡¨é”é‡Šæ”¾ï¼›</span><br><span class="line"></span><br><span class="line">update tb_book <span class="builtin-name">set</span> name =<span class="string">'solr'</span> where <span class="attribute">id</span>=2;#å½“å‰å¯¹tb_bookè¡¨è¿›è¡Œçš„é”æ˜¯è¯»é”ï¼Œè€Œä¸æ˜¯å†™é”ï¼›æ‰€ä»¥å½“å‰æ— æ³•è¿›è¡Œæ›´æ–°ï¼›Table <span class="string">'tb_book'</span> was locked with a READ lock <span class="keyword">and</span> can<span class="string">'t be updated.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">unlock tables;#åªæœ‰å½“å½“å‰çš„tb_bookè¡¨å½“ä¸­çš„è¯»é”è¿›è¡Œè§£é”ï¼Œå…¶ä»–å®¢æˆ·ç«¯è¿æ¥mysqlçš„è¯¥è¡¨æ—¶æ‰èƒ½å¤Ÿè¿›è¡Œå†™é”ï¼›å¦åˆ™å°†ä¸€ç›´ç­‰å¾…å½“å‰è¯¥tb_bookçš„è¯»é”é‡Šæ”¾ï¼›</span></span><br></pre></td></tr></table></figure><p>å¦‚æœå¯¹MyISAMè¡¨è¿›è¡Œæ“ä½œäº†è¯»é”ï¼Œå…¶ä¸ä¼šé˜»å¡å…¶ä»–çº¿ç¨‹çš„è¯»æ“ä½œï¼Œä½†æ˜¯ä¼šé˜»å¡å…¶ä»–çº¿ç¨‹çš„å†™æ“ä½œã€‚  </p><h2 id="é”-MyISAMè¡¨é”-å†™é”"><a href="#é”-MyISAMè¡¨é”-å†™é”" class="headerlink" title="é” - MyISAMè¡¨é” - å†™é”"></a>é” - MyISAMè¡¨é” - å†™é”</h2><p>å†™é”ï¼ˆæ’å®ƒé”ï¼‰ï¼šå½“å‰æ“ä½œæ²¡æœ‰å®Œæˆä¹‹å‰ï¼Œå®ƒä¼šé˜»æ–­å…¶ä»–å†™é”å’Œè¯»é”ã€‚  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å½“å‰å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="keyword">lock</span> <span class="keyword">table</span> tb_book write;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_book;</span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> tb_book <span class="keyword">set</span> <span class="keyword">name</span> =<span class="string">'solr'</span> <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_book(<span class="keyword">id</span>,<span class="keyword">name</span>) <span class="keyword">values</span>(<span class="literal">null</span>,<span class="string">'es'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">#å…¶ä»–å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_book;<span class="comment">#å…¶ä»–å®¢æˆ·ç«¯å°†ä¸€ç›´å¤„äºç­‰å¾…çŠ¶æ€ï¼Œé™¤éå½“å‰å®¢æˆ·ç«¯çš„å†™é”é‡Šæ”¾ï¼ˆå³å½“å‰å®¢æˆ·ç«¯çš„ä¸šåŠ¡æ“ä½œå®Œæˆï¼‰ï¼Œå¦åˆ™å…¶ä»–å®¢æˆ·ç«¯ä¸€ç›´å¤„äºç­‰å¾…çŠ¶æ€ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å½“å‰å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="keyword">unlock</span> <span class="keyword">tables</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">#å…¶ä»–å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_book;<span class="comment">#å½“ å½“å‰å®¢æˆ·ç«¯é‡Šæ”¾é”ä¹‹åï¼Œè¯¥å…¶ä»–å®¢æˆ·ç«¯å³ç«‹åˆ»èƒ½æŸ¥è¯¢åˆ°æ•°æ®ã€‚</span></span><br></pre></td></tr></table></figure><h2 id="é”-MyISAMè¡¨é”-å°ç»“"><a href="#é”-MyISAMè¡¨é”-å°ç»“" class="headerlink" title="é” - MyISAMè¡¨é” - å°ç»“"></a>é” - MyISAMè¡¨é” - å°ç»“</h2><p>é”æ¨¡å¼çš„äº’ç›¸å…¼å®¹æ€§å¦‚è¡¨æ‰€ç¤ºï¼š  </p><table>  <tr>    <th>å½“å‰é”æ¨¡å¼/è¯·æ±‚é”æ¨¡å¼</th>    <th>Noneï¼ˆç†è§£ä¸ºå½“å‰å®¢æˆ·ç«¯è·å–å¾—åˆ°çš„é”ï¼‰</th>    <th>è¯»é”ï¼ˆå…¶ä»–å®¢æˆ·ç«¯å¯¹äºè¯»æ“ä½œæ˜¯å¦å¯è¡Œï¼‰</th>    <th>å†™é”ï¼ˆå…¶ä»–å®¢æˆ·ç«¯å¯¹äºå†™æ“ä½œæ˜¯å¦å¯è¡Œï¼‰</th>  </tr>  <tr>    <th>è¯»é”</th>    <td>æ˜¯ï¼ˆå½“å‰å®¢æˆ·ç«¯è·å–å¾—åˆ°çš„è¯»é”ï¼‰</td>    <td>æ˜¯ï¼ˆå…¶ä»–å®¢æˆ·ç«¯å¯ä»¥è¿›è¡Œè¯»æ“ä½œï¼‰</td>    <td>å¦ï¼ˆå…¶ä»–å®¢æˆ·ç«¯æ— æ³•è¿›è¡Œå†™æ“ä½œï¼‰</td>  </tr>    <tr>    <th>å†™é”</th>    <td>æ˜¯ï¼ˆå½“å‰å®¢æˆ·ç«¯è·å–å¾—åˆ°çš„å†™é”ï¼‰</td>    <td>å¦ï¼ˆå…¶ä»–å®¢æˆ·ç«¯æ— æ³•è¿›è¡Œè¯»æ“ä½œï¼‰</td>    <td>å¦ï¼ˆå…¶ä»–å®¢æˆ·ç«¯æ— æ³•è¿›è¡Œå†™æ“ä½œï¼‰</td>  </tr></table><p>ç”±ä¸Šè¡¨å¯è§ï¼š  </p><ol><li>å¯¹MyISAMè¡¨çš„è¯»æ“ä½œï¼Œä¸ä¼šé˜»å¡å…¶ä»–ç”¨æˆ·å¯¹åŒä¸€å¼ è¡¨çš„è¯»è¯·æ±‚ï¼Œä½†æ˜¯ä¼šé˜»å¡å¯¹åŒä¸€å¼ è¡¨çš„å†™è¯·æ±‚ã€‚</li><li>å¯¹MyISAMè¡¨çš„å†™æ“ä½œï¼Œåˆ™ä¼šé˜»å¡å…¶ä»–ç”¨æˆ·å¯¹åŒä¸€å¼ è¡¨çš„è¯»å’Œå†™æ“ä½œã€‚</li></ol><p>ç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯è¯»é”ä¼šé˜»å¡å†™ï¼Œä½†æ˜¯ä¸ä¼šé˜»å¡è¯»ï¼›è€Œå†™é”ï¼Œåˆ™æ—¢ä¼šé˜»å¡è¯»ï¼Œåˆä¼šé˜»å¡å†™ã€‚  </p><p>æ­¤å¤–ï¼ŒMyISAMçš„è¯»å†™é”è°ƒåº¦æ˜¯å†™æ“ä½œä¼˜å…ˆï¼Œè¿™ä¹Ÿæ˜¯MyISAMä¸é€‚åˆåšå†™ä¸ºä¸»çš„è¡¨çš„å­˜å‚¨å¼•æ“çš„åŸå› ã€‚<br>å› ä¸ºå†™é”åï¼Œå…¶ä»–çº¿ç¨‹ä¸èƒ½åšä»»ä½•æ“ä½œï¼Œå¤§é‡çš„æ›´æ–°ä¼šä½¿æŸ¥è¯¢å¾ˆéš¾å¾—åˆ°é”ï¼Œä»è€Œé€ æˆæ°¸è¿œé˜»å¡ã€‚</p><h2 id="é”-MyISAMè¡¨é”-æŸ¥çœ‹é”äº‰ç”¨æƒ…å†µ"><a href="#é”-MyISAMè¡¨é”-æŸ¥çœ‹é”äº‰ç”¨æƒ…å†µ" class="headerlink" title="é” - MyISAMè¡¨é” - æŸ¥çœ‹é”äº‰ç”¨æƒ…å†µ"></a>é” - MyISAMè¡¨é” - æŸ¥çœ‹é”äº‰ç”¨æƒ…å†µ</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">open</span> <span class="keyword">tables</span>;</span><br></pre></td></tr></table></figure><p>Database: æ•°æ®åº“  </p><p>Table: æ•°æ®è¡¨  </p><p>In_use: è¡¨å½“å‰è¢«æŸ¥è¯¢ä½¿ç”¨çš„æ¬¡æ•°ã€‚å¦‚æœè¯¥æ•°ä¸ºé›¶ï¼Œåˆ™è¡¨æ˜¯æ‰“å¼€çš„ï¼Œä½†æ˜¯å½“å‰æ²¡æœ‰è¢«ä½¿ç”¨ã€‚  </p><p>Name_locked: è¡¨åç§°æ˜¯å¦è¢«é”å®šã€‚åç§°é”å®šç”¨äºå–æ¶ˆè¡¨æˆ–è€…å¯¹è¡¨è¿›è¡Œé‡å‘½åç­‰æ“ä½œã€‚  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">lock</span> <span class="keyword">table</span> tb_book write;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">open</span> <span class="keyword">tables</span>;<span class="comment">#database: demo_03; table: tb_book ; In_use(æ­£åœ¨ä½¿ç”¨):1ï¼›Name_locked:0</span></span><br><span class="line"><span class="keyword">unlock</span> <span class="keyword">tables</span>;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">status</span> <span class="keyword">like</span> <span class="string">'Table_locks%'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>Table_lockes_immediate</td>    <td>70</td>  </tr>    <tr>    <td>Table_locks_waited</td>    <td>0</td>  </tr></table><p>Table_locks_immediate: æŒ‡çš„æ˜¯èƒ½å¤Ÿç«‹å³è·å¾—è¡¨çº§é”çš„æ¬¡æ•°ï¼Œæ¯æ¬¡ç«‹å³è·å–é”ï¼Œå€¼åŠ 1ï¼›  </p><p>Table_locks_waited: æŒ‡çš„æ˜¯ä¸èƒ½ç«‹å³è·å–è¡¨çº§é”è€Œéœ€è¦ç­‰å¾…çš„æ¬¡æ•°ï¼Œæ¯ç­‰å¾…ä¸€æ¬¡ï¼Œè¯¥å€¼åŠ 1ï¼Œæ­¤å€¼é«˜è¯´æ˜å­˜åœ¨ç€è¾ƒä¸ºä¸¥é‡çš„è¡¨çº§é”äº‰ç”¨æƒ…å†µã€‚</p><h2 id="é”-InnoDBè¡Œé”-ä»‹ç»åŠèƒŒæ™¯çŸ¥è¯†"><a href="#é”-InnoDBè¡Œé”-ä»‹ç»åŠèƒŒæ™¯çŸ¥è¯†" class="headerlink" title="é” - InnoDBè¡Œé” - ä»‹ç»åŠèƒŒæ™¯çŸ¥è¯†"></a>é” - InnoDBè¡Œé” - ä»‹ç»åŠèƒŒæ™¯çŸ¥è¯†</h2><h3 id="è¡Œé”ä»‹ç»"><a href="#è¡Œé”ä»‹ç»" class="headerlink" title="è¡Œé”ä»‹ç»"></a>è¡Œé”ä»‹ç»</h3><p>InnoDBé»˜è®¤æ”¯æŒè¡Œé”ï¼Œä¹Ÿæ”¯æŒè¡¨é”ï¼›  </p><p>è¡Œé”ç‰¹ç‚¹ï¼šåå‘InnoDBå­˜å‚¨è¿è¯·ï¼Œå¼€é”€å¤§ï¼ŒåŠ é”æ…¢ï¼›ä¼šå‡ºç°æ­»é”ï¼›é”å®šç²’åº¦æœ€å°ï¼Œå‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€ä½ï¼Œå¹¶å‘åº¦ä¹Ÿæœ€é«˜ã€‚<br>ï¼ˆç”±äºé”å®šç²’åº¦æœ€å°ï¼Œæ‰€ä»¥å‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€ä½ï¼ŒäºŒè€…å­˜åœ¨å…³è”ï¼‰  </p><p>InnoDBä¸MyISAMçš„æœ€å¤§ä¸åŒæœ‰ä¸¤ç‚¹ï¼šä¸€æ˜¯æ”¯æŒäº‹åŠ¡ï¼›äºŒæ˜¯é‡‡ç”¨äº†è¡Œçº§é”ï¼›<br>(äº‹åŠ¡å’Œè¡Œçº§é”ä¹‹é—´å­˜åœ¨å…³è”ï¼Œæ”¯æŒäº‹åŠ¡çš„åŸå› å³åœ¨äºInnoDBé‡‡ç”¨çš„æ˜¯è¡Œçº§é”)</p><h3 id="èƒŒæ™¯çŸ¥è¯†"><a href="#èƒŒæ™¯çŸ¥è¯†" class="headerlink" title="èƒŒæ™¯çŸ¥è¯†"></a>èƒŒæ™¯çŸ¥è¯†</h3><p><strong>äº‹åŠ¡åŠå…¶ACIDå±æ€§</strong>  </p><p>äº‹åŠ¡æ˜¯ç”±ä¸€ç»„SQLè¯­å¥ç»„æˆçš„é€»è¾‘å¤„ç†å•å…ƒã€‚<br>äº‹åŠ¡å…·æœ‰ä»¥ä¸‹4ä¸ªç‰¹æ€§ï¼Œç®€ç§°ä¸ºäº‹åŠ¡ACIDå±æ€§ã€‚  </p><table>  <tr>    <th>ACIDå±æ€§</th>    <th>å«ä¹‰</th>  </tr>  <tr>    <td>åŸå­æ€§ï¼ˆAtomicï¼‰</td>    <td>äº‹åŠ¡æ˜¯ä¸€ä¸ªåŸå­æ“ä½œå•å…ƒï¼Œå…¶å¯¹æ•°æ®çš„ä¿®æ”¹ï¼Œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥</td>  </tr>  <tr>    <td>ä¸€è‡´æ€§ï¼ˆConsistentï¼‰</td>    <td>åœ¨äº‹åŠ¡å¼€å§‹å’Œå®Œæˆæ—¶ï¼Œæ•°æ®éƒ½å¿…é¡»ä¿æŒä¸€è‡´çŠ¶æ€</td>  </tr>  <tr>    <td>éš”ç¦»æ€§ï¼ˆIsolationï¼‰</td>    <td>æ•°æ®åº“ç³»ç»Ÿæä¾›ä¸€å®šçš„éš”ç¦»æœºåˆ¶ï¼Œä¿è¯äº‹åŠ¡åœ¨ä¸å—å¤–éƒ¨å¹¶å‘æ“ä½œå½±å“çš„â€œç‹¬ç«‹â€ç¯å¢ƒä¸‹è¿è¡Œ</td>  </tr>  <tr>    <td>æŒä¹…æ€§ï¼ˆDurableï¼‰</td>    <td>äº‹åŠ¡å®Œæˆä¹‹åï¼Œå¯¹äºæ•°æ®çš„ä¿®æ”¹æ˜¯æ°¸ä¹…çš„</td>  </tr></table><p><strong>å¹¶å‘äº‹åŠ¡å¤„ç†å¸¦æ¥çš„é—®é¢˜</strong>  </p><table>  <tr>    <th>é—®é¢˜</th>    <th>å«ä¹‰</th>  </tr>  <tr>    <td>ä¸¢å¤±æ›´æ–°ï¼ˆLost Updateï¼‰</td>    <td>å½“ä¸¤ä¸ªæˆ–è€…å¤šä¸ªäº‹åŠ¡é€‰æ‹©åŒä¸€è¡Œï¼Œæœ€åˆçš„äº‹åŠ¡ä¿®æ”¹çš„å€¼ï¼Œä¼šè¢«åé¢çš„äº‹åŠ¡ä¿®æ”¹çš„å€¼è¦†ç›–</td>  </tr>  <tr>    <td>è„è¯»ï¼ˆDirty Readsï¼‰</td>    <td>å½“ä¸€ä¸ªäº‹åŠ¡æ­£åœ¨è®¿é—®æ•°æ®ï¼Œå¹¶ä¸”å¯¹æ•°æ®è¿›è¡Œäº†ä¿®æ”¹ï¼Œè€Œè¿™ç§ä¿®æ”¹è¿˜æ²¡æœ‰æäº¤åˆ°æ•°æ®åº“ä¸­ï¼Œè¿™æ—¶ï¼Œå¦å¤–ä¸€ä¸ªäº‹åŠ¡ä¹Ÿè®¿é—®è¿™ä¸ªæ•°æ®ï¼Œç„¶åä½¿ç”¨äº†è¿™ä¸ªæ•°æ®ï¼ˆä¸€ä¸ªäº‹åŠ¡è¯»å–åˆ°äº†å¦å¤–ä¸€ä¸ªäº‹åŠ¡è¿˜æœªæäº¤çš„æ•°æ®ï¼‰</td>  </tr>  <tr>    <td>ä¸å¯é‡å¤åº¦ï¼ˆNon_repeatable Readsï¼‰</td>    <td>ä¸€ä¸ªäº‹åŠ¡åœ¨è¯»å–æŸäº›æ•°æ®åçš„æŸä¸ªæ—¶é—´ï¼Œå†æ¬¡è¯»å–ä»¥å‰è¯»è¿‡çš„æ•°æ®ï¼Œå´å‘ç°å’Œä»¥å‰ç‹¬å¤„çš„æ•°æ®ä¸ä¸€è‡´</td>  </tr>  <tr>    <td>å¹»è¯»ï¼ˆPhantom Readsï¼‰</td>    <td>ä¸€ä¸ªäº‹åŠ¡æŒ‰ç…§ç›¸åŒçš„æŸ¥è¯¢æ¡ä»¶é‡æ–°è¯»å–ä»¥å‰æŸ¥è¯¢è¿‡çš„æ•°æ®ï¼Œå´å‘ç°å…¶ä»–äº‹åŠ¡æ’å…¥äº†æ»¡è¶³å…¶æŸ¥è¯¢æ¡ä»¶çš„æ–°æ•°æ®ã€‚</td>  </tr></table><p><strong>äº‹åŠ¡éš”ç¦»çº§åˆ«</strong>  </p><p>ä¸ºäº†è§£å†³ä¸Šè¿°æåˆ°çš„äº‹åŠ¡å¹¶å‘é—®é¢˜ï¼Œæ•°æ®åº“æä¾›ä¸€å®šçš„äº‹åŠ¡éš”ç¦»æœºåˆ¶æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚  </p><p>æ•°æ®åº“çš„äº‹åŠ¡éš”ç¦»è¶Šä¸¥æ ¼ï¼Œå¹¶å‘å‰¯ä½œç”¨è¶Šå°ï¼Œä½†ä»˜å‡ºçš„ä»£ä»·ä¹Ÿå°±è¶Šå¤§(æ€§èƒ½è¶Šä½)ï¼Œå› ä¸ºäº‹åŠ¡éš”ç¦»å®è´¨ä¸Šå°±æ˜¯ä½¿ç”¨äº‹åŠ¡åœ¨ä¸€å®šç¨‹åº¦ä¸Šâ€œä¸²è¡ŒåŒ–â€è¿›è¡Œï¼Œè¿™æ˜¾ç„¶ä¸â€œå¹¶å‘â€æ˜¯çŸ›ç›¾çš„ã€‚  </p><p>æ•°æ®åº“çš„éš”ç¦»çº§åˆ«æœ‰4ä¸ªï¼Œç”±ä½åˆ°é«˜ä¾æ¬¡ä¸ºRead uncommittedã€Read committedã€Repeatable readã€Serializable ï¼Œè¿™å››ä¸ªç•Œåˆ«å¯ä»¥é€ä¸ªè§£å†³è„å†™ã€è„è¯»ã€ä¸å¯é‡å¤åº¦ã€å¹»è¯»è¿™å‡ ç±»é—®é¢˜ã€‚  </p><table>  <tr>    <th>éš”ç¦»çº§åˆ«</th>    <th>ä¸¢å¤±æ›´æ–°</th>    <th>è„è¯»</th>    <th>ä¸å¯é‡å¤è¯»</th>    <th>å¹»è¯»</th>  </tr>  <tr>    <td>Read uncommitted</td>    <td>x</td>    <td>âˆš</td>    <td>âˆš</td>    <td>âˆš</td>  </tr>    <tr>    <td>Read committed</td>    <td>x</td>    <td>x</td>    <td>âˆš</td>    <td>âˆš</td>  </tr>   <tr>    <td>Repeatable read(é»˜è®¤)</td>    <td>x</td>    <td>x</td>    <td>x</td>    <td>âˆš</td>  </tr>    <tr>    <td>Serializable</td>    <td>x</td>    <td>x</td>    <td>x</td>    <td>x</td>  </tr></table><p>å¤‡æ³¨ï¼š âˆš ä»£è¡¨å¯èƒ½å‡ºç°ï¼Œ x ä»£è¡¨ä¸ä¼šå‡ºç°ã€‚  </p><p>MySQLçš„æ•°æ®åº“çš„é»˜è®¤éš”ç¦»çº§åˆ«æ˜¯ Repeatable readï¼ŒæŸ¥çœ‹æ–¹å¼ï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">'tx_isolation'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>tx_isolation</td>    <td>REPEATABLE-READ</td>  </tr></table><h2 id="é”-InnoDBè¡Œé”-ç±»å‹"><a href="#é”-InnoDBè¡Œé”-ç±»å‹" class="headerlink" title="é” - InnoDBè¡Œé” - ç±»å‹"></a>é” - InnoDBè¡Œé” - ç±»å‹</h2><h3 id="InnoDBçš„è¡Œé”æ¨¡å¼"><a href="#InnoDBçš„è¡Œé”æ¨¡å¼" class="headerlink" title="InnoDBçš„è¡Œé”æ¨¡å¼"></a>InnoDBçš„è¡Œé”æ¨¡å¼</h3><p><strong>InnoDB</strong>å®ç°äº†ä»¥ä¸‹<strong>ä¸¤ç§ç±»å‹çš„è¡Œé”</strong>ï¼š  </p><ul><li><p><strong>å…±äº«é”ï¼ˆSï¼‰</strong>ï¼š åˆç§°ä¸º<strong>è¯»é”</strong>ï¼Œ<br>ç®€ç§°<strong>Sé”</strong>ï¼Œ</p></li><li><p><em>å…±äº«é”*</em>å°±æ˜¯<strong>å¤šä¸ªäº‹åŠ¡</strong> å¯¹äº <strong>åŒä¸€æ•°æ®</strong> å¯ä»¥ <strong>å…±äº«ä¸€æŠŠé”</strong>ï¼Œéƒ½èƒ½ <strong>è®¿é—®åˆ° æ•°æ®</strong>ï¼Œ<br>ä½†æ˜¯ <strong>åªèƒ½è¯» ä¸èƒ½ä¿®æ”¹</strong>ã€‚  </p></li><li><p><strong>æ’å®ƒé”ï¼ˆXï¼‰</strong>ï¼šåˆç§°ä¸º<strong>å†™é”</strong>ï¼Œ<br>ç®€ç§°<strong>Xé”</strong>ï¼Œ</p></li><li><p><em>æ’å®ƒé”*</em>å°±æ˜¯<strong>ä¸èƒ½ä¸å…¶ä»–é” å¹¶å­˜</strong>ã€‚<br>å¦‚æœ<strong>ä¸€ä¸ªäº‹åŠ¡ è·å–äº† ä¸€ä¸ªæ•°æ®è¡Œçš„æ’å®ƒé”</strong>ï¼Œ</p></li><li><p><em>å…¶ä»–äº‹åŠ¡*</em>å°±<strong>ä¸èƒ½å†è·å–</strong> <strong>è¯¥è¡Œçš„å…¶ä»–é”</strong>ï¼Œ<br>åŒ…æ‹¬<strong>å…±äº«é”å’Œæ’å®ƒé”</strong>ï¼Œ<br>ä½†æ˜¯ <strong>è·å–æ’å®ƒé”çš„äº‹åŠ¡</strong> å¯ä»¥<strong>å¯¹æ•°æ® è¿›è¡Œ è¯»å– å’Œ ä¿®æ”¹</strong>ã€‚  </p></li></ul><p>å¯¹äº<strong>UPDATEã€DELETEå’ŒINSERT</strong>è¯­å¥ï¼Œ<strong>InnoDB</strong>ä¼š<strong>è‡ªåŠ¨</strong>ç»™æ¶‰åŠæ•°æ®é›† åŠ  <strong>æ’å®ƒé”ï¼ˆXï¼‰</strong>ï¼›<br>å¯¹äº<strong>æ™®é€šSELECTè¯­å¥</strong>ï¼Œ<strong>InnoDBä¸ä¼šåŠ ä»»ä½•é”</strong>ï¼›  </p><p>å¯ä»¥é€šè¿‡ä»¥ä¸‹è¯­å¥<strong>æ˜¾å¼</strong>ç»™è®°å½•é›†åŠ <strong>å…±äº«é”æˆ–è€…æ’å®ƒé”</strong>ï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å…±äº«é”ï¼ˆSï¼‰</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> ...... <span class="keyword">LOCK</span> <span class="keyword">IN</span> <span class="keyword">SHARE</span> <span class="keyword">MODE</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ’å®ƒé”ï¼ˆXï¼‰</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> ....... <span class="keyword">FOR</span> <span class="keyword">UPDATE</span></span><br></pre></td></tr></table></figure><h3 id="æ¡ˆä¾‹å‡†å¤‡å·¥ä½œ"><a href="#æ¡ˆä¾‹å‡†å¤‡å·¥ä½œ" class="headerlink" title="æ¡ˆä¾‹å‡†å¤‡å·¥ä½œ"></a>æ¡ˆä¾‹å‡†å¤‡å·¥ä½œ</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> test_innodb_lock(</span><br><span class="line">  <span class="keyword">id</span> <span class="built_in">int</span>(<span class="number">11</span>),</span><br><span class="line">  <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">16</span>),</span><br><span class="line">  sex <span class="built_in">varchar</span>(<span class="number">1</span>)</span><br><span class="line">)<span class="keyword">engine</span>=<span class="keyword">innodb</span> <span class="keyword">default</span> <span class="keyword">charset</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ’å…¥åŸºç¡€æ•°æ®</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆ›å»ºå•åˆ—ç´¢å¼•</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> idx_test_innodb_lock_id <span class="keyword">on</span> test_innodb_lock(<span class="keyword">id</span>);</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> idx_test_innodb_lock_name <span class="keyword">on</span> test_innodb_lock(<span class="keyword">name</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span>;</span><br></pre></td></tr></table></figure><h3 id="è¡Œé”åŸºæœ¬æ¼”ç¤º"><a href="#è¡Œé”åŸºæœ¬æ¼”ç¤º" class="headerlink" title="è¡Œé”åŸºæœ¬æ¼”ç¤º"></a>è¡Œé”åŸºæœ¬æ¼”ç¤º</h3><table>  <tr>    <th>Session-1</th>    <th>Session-2</th>  </tr>  <tr>    <td>å…³é—­è‡ªåŠ¨æäº¤åŠŸèƒ½ï¼ˆset autocommit=0;ï¼‰</td>    <td>å…³é—­è‡ªåŠ¨æäº¤åŠŸèƒ½ï¼ˆset autocommit=0;ï¼‰</td>  </tr>  <tr>    <td>å¯ä»¥æ­£å¸¸çš„æŸ¥è¯¢å‡ºå…¨éƒ¨çš„æ•°æ®ï¼ˆselect * from test_innodb_lock;ï¼‰</td>    <td>å¯ä»¥æ­£å¸¸çš„æŸ¥è¯¢å‡ºå…¨éƒ¨çš„æ•°æ®ï¼ˆselect * from test_innodb_lock;ï¼‰</td>  </tr>  <tr>    <td>æŸ¥è¯¢idä¸º3çš„æ•°æ®ï¼›ï¼ˆselect * from test_innodb_lock where id=3;ï¼‰</td>    <td>æŸ¥è¯¢idä¸º3çš„æ•°æ®ï¼›ï¼ˆselect * from test_innodb_lock where id=3;ï¼‰</td>  </tr>   <tr>    <td>æ›´æ–°idä¸º3çš„æ•°æ®ï¼Œä½†æ˜¯ä¸æäº¤ï¼ˆupdate test_innodb_lock set name='AI' where id=3;ï¼‰</td>    <td>æ›´æ–°idä¸º3çš„æ•°æ®ï¼Œåœ¨Session-1çš„æ›´æ–°æäº¤å®Œæˆä¹‹å‰ä¸€ç›´å¤„äºç­‰å¾…çŠ¶æ€ï¼›ï¼ˆupdate test_innodb_lock set name='AII' where id=3;ï¼‰</td>  </tr><tr>    <td>é€šè¿‡commitï¼Œæäº¤äº‹åŠ¡ï¼ˆcommit;ï¼‰</td>    <td>æ¥è§¦é˜»å¡ï¼Œæ›´æ–°æ­£å¸¸è¿›è¡Œï¼ˆupdate test_innodb_lock set name='AII' where id=3;ï¼‰</td>  </tr>  <tr>    <td colspan="2">ä»¥ä¸Šï¼Œæ“ä½œçš„éƒ½æ˜¯åŒä¸€è¡Œçš„æ•°æ®ï¼Œæ¥ä¸‹æ¥ï¼Œæ¼”ç¤ºä¸åŒè¡Œçš„æ•°æ®ï¼›</td>  </tr>  <tr>    <td>æ›´æ–°idä¸º3çš„æ•°æ®ï¼Œæ­£å¸¸çš„è·å–åˆ°è¡Œé”ï¼Œæ‰§è¡Œæ›´æ–°ï¼›(update test_innodb_lock set name='a1' where id =3;)</td>    <td>ç”±äºä¸Session-1æ“ä½œä¸æ˜¯åŒä¸€è¡Œï¼Œè·å–å½“å‰è¡Œé”ï¼Œæ‰§è¡Œæ›´æ–°ï¼›ï¼ˆupdate test_innodb_lock set name ="C1" where id=5;ï¼‰</td>  </tr></table><h2 id="é”-InnoDBè¡Œé”-è¡Œé”å‡çº§ä¸ºè¡¨é”"><a href="#é”-InnoDBè¡Œé”-è¡Œé”å‡çº§ä¸ºè¡¨é”" class="headerlink" title="é” - InnoDBè¡Œé” - è¡Œé”å‡çº§ä¸ºè¡¨é”"></a>é” - InnoDBè¡Œé” - è¡Œé”å‡çº§ä¸ºè¡¨é”</h2><p>å¦‚æœä¸é€šè¿‡ç´¢å¼•æ¡ä»¶æ£€ç´¢æ•°æ®ï¼Œé‚£ä¹ˆinnodbå°†å¯¹è¡¨ä¸­çš„æ‰€æœ‰è®°å½•åŠ é”ï¼Œå®é™…æ•ˆæœè·Ÿè¡¨é”ä¸€æ ·ã€‚  </p><p>æŸ¥çœ‹å½“å‰è¡¨çš„ç´¢å¼•ï¼šshow index from test_innodb_lock;</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">index</span> <span class="keyword">from</span> test_innodb_lock\G;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Session-1</th>    <th>Session-2</th>  </tr>  <tr>    <td>å…³é—­äº‹åŠ¡çš„è‡ªåŠ¨æäº¤ï¼ˆset autocommit=0;ï¼‰</td>    <td>å…³é—­äº‹åŠ¡çš„è‡ªåŠ¨æäº¤ï¼ˆset autocommit=0;ï¼‰</td>  </tr>  <tr>    <td>æ‰§è¡Œæ›´æ–°è¯­å¥ï¼ˆupdate test_innodb_lock set sex='2' where <span style="color:red;font-weight:bolder;">name=400</span>; ï¼‰</td>    <td>æ‰§è¡Œæ›´æ–°è¯­å¥ï¼Œä½†æ˜¯å‡ºäºé˜»å¡çŠ¶æ€ï¼ˆupdate test_innodb_lock set sex='2' where id=9;ï¼‰</td>  </tr>   <tr>    <td>æäº¤äº‹åŠ¡ï¼ˆcommit;ï¼‰</td>    <td>è§£é™¤é˜»å¡ï¼Œæ‰§è¡Œæ›´æ–°æˆåŠŸï¼ˆupdate test_innodb_lock set sex='2' where id=9;ï¼‰</td>  </tr>  <tr>    <td></td>    <td>æ‰§è¡Œæäº¤æ“ä½œï¼ˆcommit;ï¼‰</td>  </tr></table><p>ç”±äºæ‰§è¡Œæ›´æ–°æ—¶ï¼Œnameå­—æ®µæœ¬æ¥ä¸ºvarcharç±»å‹ï¼Œä½†æ˜¯Session-1å½“ä¸­nameä½œä¸ºæ•°å­—ç±»å‹æ¥ä½¿ç”¨ï¼Œæ‰€ä»¥å­˜åœ¨ç±»å‹è½¬æ¢ï¼Œç´¢å¼•å¤±æ•ˆï¼Œæœ€ç»ˆè¡Œé”å˜ä¸ºè¡¨é”ï¼›  </p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">desc</span> test_innodb_lock;<span class="meta">#æŸ¥çœ‹è¡¨ç»“æ„</span></span><br></pre></td></tr></table></figure><p>ç´¢å¼•å¤±æ•ˆï¼šnameå­—æ®µæœ¬æ¥çš„ç±»å‹ä¸ºvarcahrç±»å‹ï¼›å¦‚æœæ˜¯varcharç±»å‹ä½†æ˜¯åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œæ²¡æœ‰ç»™å…¶nameå­—æ®µçš„å–å€¼åŠ ä¸Šå•å¼•å·ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ç´¢å¼•å°±å°†å¤±æ•ˆï¼›ç´¢å¼•å¤±æ•ˆï¼Œè¡Œé”å‡çº§ä¸ºè¡¨é”ï¼›</p><h2 id="é”-InnoDBè¡Œé”-é—´éš™é”å±å®³"><a href="#é”-InnoDBè¡Œé”-é—´éš™é”å±å®³" class="headerlink" title="é” - InnoDBè¡Œé” - é—´éš™é”å±å®³"></a>é” - InnoDBè¡Œé” - é—´éš™é”å±å®³</h2><p>å½“ç”¨ <strong>èŒƒå›´æ¡ä»¶</strong>ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç›¸ç­‰æ¡ä»¶æ£€ç´¢æ•°æ®ï¼Œå¹¶è¯·æ±‚å…±äº«æˆ–è€…æ’å®ƒé”çš„æ—¶å€™ï¼ŒInnoDBä¼šç»™ç¬¦åˆæ¡ä»¶çš„å·²æœ‰æ•°æ®è¿›è¡ŒåŠ é”ï¼›<br>å¯¹äºé”®å€¼åœ¨æ¡ä»¶èŒƒå›´å†…ä½†å¹¶ä¸å­˜åœ¨çš„è®°å½•ï¼Œå«åšâ€œé—´éš™ï¼ˆGAPï¼‰â€ï¼ŒInnoDBä¹Ÿä¼šå¯¹è¿™ä¸ªâ€œé—´éš™â€åŠ é”ï¼Œè¿™ç§é”æœºåˆ¶å°±æ˜¯æ‰€è°“çš„ é—´éš™é”ï¼ˆNext-Keyé”ï¼‰ï¼›  </p><p>ID &lt; 10 ï¼š  </p><ul><li>1,2,3,4,5,6,7,8,9</li><li>1,2,3,4,6,9(æ­¤æ—¶å½“ä¸­çš„5 å’Œ 7ã€8 åˆ™ç§°ä¹‹ä¸ºé—´éš™)</li></ul><p>ç¤ºä¾‹ï¼š  </p><table>  <tr>    <th>Session-1</th>    <th>Session-2</th>  </tr>  <tr>    <td>å…³é—­äº‹åŠ¡è‡ªåŠ¨æäº¤ï¼ˆset autocommit=0;ï¼‰</td>    <td>å…³é—­äº‹åŠ¡è‡ªåŠ¨æäº¤ï¼ˆset autocommit=0;ï¼‰</td>  </tr>  <tr>    <td>æ ¹æ®idèŒƒå›´æ›´æ–°æ•°æ®ï¼ˆupdate test_innodb_lock set name='332423' where id < 4 ;ï¼‰</td>    <td>æ’å…¥idä¸º2çš„è®°å½•ï¼Œå¤„äºé˜»å¡çŠ¶æ€ï¼ˆinsert into test_innodb_lock values(2,'1001','1'); ï¼‰</td>  </tr>    <tr>    <td>æäº¤äº‹åŠ¡ï¼ˆcommit;ï¼‰</td>    <td>è§£é™¤é˜»å¡ï¼Œæ‰§è¡Œæ’å…¥æ“ä½œï¼ˆinsert into test_innodb_lock values(2,'1001','1'); ï¼‰</td>  </tr>   <tr>    <td></td>    <td>æäº¤äº‹åŠ¡ï¼ˆcommit;ï¼‰</td>  </tr></table><h2 id="é”-InnoDBè¡Œé”-äº‰ç”¨æƒ…å†µæŸ¥çœ‹"><a href="#é”-InnoDBè¡Œé”-äº‰ç”¨æƒ…å†µæŸ¥çœ‹" class="headerlink" title="é” - InnoDBè¡Œé” - äº‰ç”¨æƒ…å†µæŸ¥çœ‹"></a>é” - InnoDBè¡Œé” - äº‰ç”¨æƒ…å†µæŸ¥çœ‹</h2><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">show status like <span class="string">'innodb_row_lock%'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#Innodb_row_lock_current_waits: å½“å‰æ­£åœ¨ç­‰å¾…é”å®šçš„æ•°é‡ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#Innodb_row_lock_timeï¼š ä»ç³»ç»Ÿå¯åŠ¨åˆ°ç°åœ¨é”å®šæ€»æ—¶é—´é•¿åº¦</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#Innodb_row_lock_time_avg: æ¯æ¬¡ç­‰å¾…æ‰€èŠ±å¹³å‡æ—¶é•¿</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#Innodb_row_lock_time_max: ä»ç³»ç»Ÿå¯åŠ¨åˆ°ç°åœ¨ç­‰å¾…æœ€é•¿çš„ä¸€æ¬¡æ‰€èŠ±æ—¶é—´</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#Innodb_row_lock_waitsï¼š ç³»ç»Ÿå¯åŠ¨ååˆ°ç°åœ¨æ€»å…±ç­‰å¾…çš„æ¬¡æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#å½“ç­‰å¾…çš„æ¬¡æ•°å¾ˆé«˜ï¼Œè€Œä¸”æ¯æ¬¡ç­‰å¾…çš„æ—¶é•¿ä¹Ÿä¸å°çš„æ—¶å€™ï¼Œå°±éœ€è¦åˆ†æç³»ç»Ÿä¸­ä¸ºä»€ä¹ˆä¼šæœ‰å¦‚æ­¤å¤šçš„ç­‰å¾…ï¼Œç„¶åæ ¹æ®åˆ†æç»“æœç€æ‰‹åˆ¶å®šä¼˜åŒ–è®¡åˆ’ã€‚</span></span><br></pre></td></tr></table></figure><h2 id="é”-InnoDBè¡Œé”-æ€»ç»“"><a href="#é”-InnoDBè¡Œé”-æ€»ç»“" class="headerlink" title="é” - InnoDBè¡Œé” - æ€»ç»“"></a>é” - InnoDBè¡Œé” - æ€»ç»“</h2><p><strong>Innodbå­˜å‚¨å¼•æ“</strong> ç”±äºå®ç°äº† <strong>è¡Œçº§é”å®š</strong> ï¼Œ<br>è™½ç„¶åœ¨ <strong>é”å®šæœºåˆ¶</strong> çš„å®ç°æ–¹é¢å¸¦æ¥äº† <strong>æ€§èƒ½æŸè€—</strong> å¯èƒ½æ¯”è¡¨é”ä¼šæ›´é«˜ä¸€äº›ï¼Œ<br>ä½†æ˜¯åœ¨ <strong>æ•´ä½“å¹¶å‘å¤„ç†èƒ½åŠ›æ–¹é¢</strong>è¦è¿œè¿œ <strong>ä¼˜äº</strong> <strong>MyISAMçš„è¡¨é”</strong> çš„ã€‚  </p><p>å½“ <strong>ç³»ç»Ÿå¹¶å‘é‡è¾ƒé«˜</strong> çš„æ—¶å€™ï¼Œ<strong>InnoDBçš„æ•´ä½“æ€§èƒ½</strong> å’Œ <strong>MyISAM</strong> ç›¸æ¯”å°±ä¼šæœ‰æ¯”è¾ƒ<strong>æ˜æ˜¾çš„ä¼˜åŠ¿</strong>ã€‚  </p><p>ä½†æ˜¯ï¼Œ<strong>InnoDBçš„è¡Œçº§é”</strong> åŒæ ·ä¹Ÿæœ‰å…¶è„†å¼±çš„ä¸€é¢ï¼Œä½†<strong>ä½¿ç”¨ä¸å½“</strong>çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šè®©<strong>InnoDBçš„æ•´ä½“æ€§èƒ½</strong>ä¸ä»…<strong>ä¸èƒ½æ¯”MyISAMé«˜</strong>ï¼Œç”šè‡³<strong>å¯èƒ½</strong>ä¼š<strong>æ›´å·®</strong>ã€‚  </p><p><strong>ä¼˜åŒ–å»ºè®®</strong>ï¼š  </p><ul><li>å°½å¯èƒ½è®©æ‰€æœ‰ <strong>æ•°æ®æ£€ç´¢</strong> éƒ½èƒ½é€šè¿‡ <strong>ç´¢å¼•</strong> æ¥å®Œæˆï¼Œ<strong>é¿å… æ— ç´¢å¼• è¡Œé”</strong> <strong>å‡çº§</strong>ä¸º<strong>è¡¨é”</strong></li><li><strong>åˆç†è®¾è®¡ç´¢å¼•</strong>ï¼Œå°½é‡ <strong>ç¼©å°é”çš„èŒƒå›´</strong></li><li>å°½å¯èƒ½<strong>å‡å°‘ç´¢å¼•æ¡ä»¶</strong>ï¼Œä»¥åŠ<strong>ç´¢å¼•èŒƒå›´</strong>ï¼Œ<strong>é¿å…é—´éš™é”</strong></li><li>å°½é‡<strong>æ§åˆ¶äº‹åŠ¡å¤§å°</strong>ï¼Œ<strong>å‡å°‘é”å®šèµ„æºé‡å’Œæ—¶é—´é•¿åº¦</strong></li><li>å°½å¯èƒ½ä½¿ç”¨<strong>ä½çº§åˆ«äº‹åŠ¡éš”ç¦»</strong>ï¼ˆå‰æï¼šä½†æ˜¯éœ€è¦<strong>ä¸šåŠ¡å±‚é¢æ»¡è¶³éœ€æ±‚</strong>ï¼‰</li></ul><h2 id="SQLæŠ€å·§-SQLæ‰§è¡Œé¡ºåºåŠæ­£åˆ™è¡¨è¾¾å¼"><a href="#SQLæŠ€å·§-SQLæ‰§è¡Œé¡ºåºåŠæ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="SQLæŠ€å·§ - SQLæ‰§è¡Œé¡ºåºåŠæ­£åˆ™è¡¨è¾¾å¼"></a>SQLæŠ€å·§ - SQLæ‰§è¡Œé¡ºåºåŠæ­£åˆ™è¡¨è¾¾å¼</h2><h3 id="SQLæ‰§è¡Œé¡ºåº"><a href="#SQLæ‰§è¡Œé¡ºåº" class="headerlink" title="SQLæ‰§è¡Œé¡ºåº"></a>SQLæ‰§è¡Œé¡ºåº</h3><p>ç¼–å†™é¡ºåº</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span></span><br><span class="line">  &lt;<span class="keyword">select</span> <span class="keyword">list</span>&gt;</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  &lt;left_table&gt; &lt;join_type&gt;</span><br><span class="line"><span class="keyword">JOIN</span></span><br><span class="line">  &lt;right_table&gt; <span class="keyword">ON</span> &lt;join_condition&gt;</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">  &lt;where_condition&gt;</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line">  &lt;group_by_list&gt;</span><br><span class="line"><span class="keyword">HAVING</span></span><br><span class="line">  &lt;having_condition&gt;</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">  &lt;order_by_condition&gt;</span><br><span class="line"><span class="keyword">LIMIT</span></span><br><span class="line">  &lt;limit_params&gt;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œé¡ºåº  </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> &lt;left_table&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ON</span> &lt;join_condition&gt;</span><br><span class="line"></span><br><span class="line">&lt;join_type&gt; <span class="keyword">JOIN</span> &lt;right_table&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">WHERE</span> &lt;where_condition&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> &lt;group_by_list&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">HAVING</span> &lt;having_condition&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> &lt;<span class="keyword">select</span> list&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> &lt;order_by_condition&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">LIMIT</span> &lt;limit_params&gt;</span><br></pre></td></tr></table></figure><h3 id="æ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨"><a href="#æ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨"></a>æ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_book;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ­£åˆ™è¡¨è¾¾å¼ regexp</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_book <span class="keyword">where</span> <span class="keyword">name</span> regexp <span class="string">'^j'</span>;<span class="comment">#æŸ¥è¯¢nameå­—æ®µå–å€¼ä»¥ â€œjâ€ å­—ç¬¦å¼€å¤´çš„è®°å½•è¡Œ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_book <span class="keyword">where</span> <span class="keyword">name</span> regexp <span class="string">'S$'</span>;<span class="comment">#æŸ¥è¯¢nameå­—æ®µå–å€¼ä»¥ â€œSâ€ å­—ç¬¦ç»“å°¾çš„è®°å½•è¡Œ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_book <span class="keyword">where</span> <span class="keyword">name</span> regexp <span class="string">'[uvw]'</span>;<span class="comment">#æŸ¥è¯¢nameå­—æ®µå–å€¼åŒ…å« â€œuâ€ã€â€œvâ€ã€â€œwâ€ å­—ç¬¦çš„è®°å½•è¡Œ</span></span><br></pre></td></tr></table></figure><table>  <tr>    <th>ç¬¦å·</th>    <th>å«ä¹‰</th>  </tr>  <tr>    <td>^</td>    <td>åœ¨å­—ç¬¦ä¸²å¼€å§‹å¤„è¿›è¡ŒåŒ¹é…</td>  </tr>    <tr>    <td>$</td>    <td>åœ¨å­—ç¬¦ä¸²æœ«å°¾å¤„è¿›è¡ŒåŒ¹é…</td>  </tr>    <tr>    <td>.</td>    <td>åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦ï¼ŒåŒ…æ‹¬æ¢è¡Œç¬¦</td>  </tr>  <tr>    <td>[...]</td>    <td>åŒ¹é…å‡ºæ‹¬å·å†…çš„ä»»æ„å­—ç¬¦</td>  </tr>  <tr>    <td>[^...]</td>    <td>åŒ¹é…ä¸å‡ºæ‹¬å·å†…çš„ä»»æ„å­—ç¬¦</td>  </tr>  <tr>    <td>a*</td>    <td>åŒ¹é…é›¶ä¸ªæˆ–è€…å¤šä¸ªaï¼ˆåŒ…æ‹¬ç©ºä¸²ï¼‰</td>  </tr>  <tr>    <td>a+</td>    <td>åŒ¹é…ä¸€ä¸ªæˆ–è€…å¤šä¸ªaï¼ˆä¸åŒ…æ‹¬ç©ºä¸²ï¼‰</td>  </tr>  <tr>    <td>a?</td>    <td>åŒ¹é…é›¶ä¸ªæˆ–è€…ä¸€ä¸ªa</td>  </tr>    <tr>    <td>a1|a2</td>    <td>åŒ¹é…a1æˆ–è€…a2</td>  </tr>    <tr>    <td>a(m)</td>    <td>åŒ¹é…mä¸ªa</td>  </tr>      <tr>    <td>a(m,)</td>    <td>è‡³å°‘åŒ¹é…mä¸ªa</td>  </tr>      <tr>    <td>a(m,n)</td>    <td>åŒ¹é…mä¸ªa åˆ°nä¸ªa</td>  </tr>      <tr>    <td>a(,n)</td>    <td>åŒ¹é…0åˆ°nä¸ªa</td>  </tr>      <tr>    <td>(...)</td>    <td>å°†æ¨¡å¼å…ƒç´ ç»„æˆå•ä¸€å…ƒç´ </td>  </tr></table><h2 id="SQLæŠ€å·§-æ•°å­—å‡½æ•°ä¸å­—ç¬¦ä¸²å‡½æ•°"><a href="#SQLæŠ€å·§-æ•°å­—å‡½æ•°ä¸å­—ç¬¦ä¸²å‡½æ•°" class="headerlink" title="SQLæŠ€å·§ - æ•°å­—å‡½æ•°ä¸å­—ç¬¦ä¸²å‡½æ•°"></a>SQLæŠ€å·§ - æ•°å­—å‡½æ•°ä¸å­—ç¬¦ä¸²å‡½æ•°</h2><h3 id="æ•°å­—å‡½æ•°"><a href="#æ•°å­—å‡½æ•°" class="headerlink" title="æ•°å­—å‡½æ•°"></a>æ•°å­—å‡½æ•°</h3><table>  <tr>    <th>å‡½æ•°åç§°</th>    <th>ä½œç”¨</th>  </tr>  <tr>    <td>ABS</td>    <td>æ±‚ç»å¯¹å€¼</td>  </tr>    <tr>    <td>SQRT</td>    <td>æ±‚äºŒæ¬¡æ–¹æ ¹</td>  </tr>    <tr>    <td>MOD</td>    <td>æ±‚ä½™æ•°</td>  </tr>    <tr>    <td>CEILå’ŒCEILING</td>    <td>ä¸¤ä¸ªå‡½æ•°åŠŸèƒ½ç›¸åŒï¼Œéƒ½æ˜¯è¿”å›ä¸å°äºå‚æ•°çš„æœ€å°æ•´æ•°ï¼Œå³å‘ä¸Šå–æ•´</td>  </tr>  <tr>    <td>FLOOR</td>    <td>å‘ä¸‹å–æ•´ï¼Œè¿”å›å€¼è½¬åŒ–ä¸ºä¸€ä¸ªBIGINT</td>  </tr>  <tr>    <td>RAND</td>    <td>ç”Ÿæˆä¸€ä¸ª0-1ä¹‹é—´çš„éšæœºæ•°ï¼Œä¼ å…¥æ•´æ•°å‚æ•°æ˜¯ï¼Œç”¨æ¥äº§ç”Ÿé‡å¤åºåˆ—</td>  </tr>  <tr>    <td>ROUND</td>    <td>å¯¹æ‰€ä¼ å…¥å‚æ•°è¿›è¡Œå››èˆäº”å…¥</td>  </tr>    <tr>    <td>SIGN</td>    <td>è¿”å›å‚æ•°çš„ç¬¦å·</td>  </tr>    <tr>    <td>POWå’ŒPOWER</td>    <td>ä¸¤ä¸ªå‡½æ•°çš„åŠŸèƒ½ç›¸åŒï¼Œéƒ½æ˜¯æ‰€ä¼ å‚æ•°çš„æ¬¡æ–¹çš„ç»“æœå€¼</td>  </tr>  <tr>    <td>SIN</td>    <td>æ±‚æ­£å¼¦å€¼</td>  </tr>  <tr>    <td>COS</td>    <td>æ±‚ä½™å¼¦å€¼</td>  </tr>  <tr>    <td>ACOS</td>    <td>æ±‚åä½™å¼¦å€¼ï¼Œä¸å‡½æ•°COSäº’ä¸ºåå‡½æ•°</td>  </tr>    <tr>    <td>TAN</td>    <td>æ±‚æ­£åˆ‡å€¼</td>  </tr>  <tr>    <td>ATAN</td>    <td>æ±‚åæ­£åˆ‡å€¼ï¼Œä¸å‡½æ•°TANäº’ä¸ºåå‡½æ•°</td>  </tr>  <tr>    <td>COT</td>    <td>æ±‚ä½™åˆ‡å€¼</td>  </tr></table><h3 id="å­—ç¬¦ä¸²å‡½æ•°"><a href="#å­—ç¬¦ä¸²å‡½æ•°" class="headerlink" title="å­—ç¬¦ä¸²å‡½æ•°"></a>å­—ç¬¦ä¸²å‡½æ•°</h3><table>  <tr>    <th>å‡½æ•°åç§°</th>    <th>ä½œç”¨</th>  </tr>  <tr>    <td>LENGTH</td>    <td>è®¡ç®—å­—ç¬¦ä¸²é•¿åº¦å‡½æ•°ï¼Œè¿”å›å­—ç¬¦ä¸²çš„å­—èŠ‚é•¿åº¦</td>  </tr>    <tr>    <td>CONCAT</td>    <td>åˆå¹¶å­—ç¬¦ä¸²å‡½æ•°ï¼Œè¿”å›ç»“æœä¸ºè¿æ¥å‚æ•°äº§ç”Ÿçš„å­—ç¬¦ä¸²ï¼Œå‚æ•°å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæˆ–è€…å¤šä¸ª</td>  </tr>    <tr>    <td>INSERT</td>    <td>æ›¿æ¢å­—ç¬¦ä¸²å‡½æ•°</td>  </tr>    <tr>    <td>LOWER</td>    <td>å°†å­—ç¬¦ä¸²ä¸­çš„å­—æ¯è½¬æ¢ä¸ºå°å†™</td>  </tr>    <tr>    <td>UPPER</td>    <td>å°†å­—ç¬¦ä¸²ä¸­çš„å­—æ¯è½¬æ¢ä¸ºå¤§å†™</td>  </tr>    <tr>    <td>LEFT</td>    <td>ä»å·¦ä¾§æˆªå–å­—ç¬¦ä¸²ï¼Œè¿”å›å­—ç¬¦ä¸²å·¦è¾¹çš„è‹¥å¹²ä¸ªå­—ç¬¦</td>  </tr>    <tr>    <td>RIGTH</td>    <td>ä»å³ä¾§æˆªå–å­—ç¬¦ä¸²ï¼Œè¿”å›å­—ç¬¦ä¸²å³è¾¹çš„è‹¥å¹²ä¸ªå­—ç¬¦</td>  </tr>    <tr>    <td>TRIM</td>    <td>åˆ é™¤å­—ç¬¦ä¸²å·¦å³ä¸¤ä¾§çš„ç©ºæ ¼</td>  </tr>    <tr>    <td>REPLACE</td>    <td>å­—ç¬¦ä¸²æ›¿æ¢å‡½æ•°ï¼Œè¿”å›æ›¿æ¢åçš„æ–°å­—ç¬¦ä¸²</td>  </tr>    <tr>    <td>SUBSTRING</td>    <td>æˆªå–å­—ç¬¦ä¸²ï¼Œè¿”å›ä»æŒ‡å®šä½ç½®å¼€å§‹çš„æŒ‡å®šé•¿åº¦çš„å­—ç¬¦ä¸²</td>  </tr>    <tr>    <td>REVERSE</td>    <td>å­—ç¬¦ä¸²åè½¬ï¼ˆé€†åºï¼‰å‡½æ•°ï¼Œè¿”å›ä¸åŸå§‹å­—ç¬¦ä¸²é¡ºåºç›¸åçš„å­—ç¬¦ä¸²</td>  </tr></table><h2 id="SQLæŠ€å·§-æ—¥æœŸå‡½æ•°ä¸èšåˆå‡½æ•°"><a href="#SQLæŠ€å·§-æ—¥æœŸå‡½æ•°ä¸èšåˆå‡½æ•°" class="headerlink" title="SQLæŠ€å·§ - æ—¥æœŸå‡½æ•°ä¸èšåˆå‡½æ•°"></a>SQLæŠ€å·§ - æ—¥æœŸå‡½æ•°ä¸èšåˆå‡½æ•°</h2><h3 id="æ—¥æœŸå‡½æ•°"><a href="#æ—¥æœŸå‡½æ•°" class="headerlink" title="æ—¥æœŸå‡½æ•°"></a>æ—¥æœŸå‡½æ•°</h3><table>  <tr>    <th>å‡½æ•°åç§°</th>    <th>ä½œç”¨</th>  </tr>  <tr>    <td>CURDATEå’ŒCURRENT_DATE</td>    <td>ä¸¤ä¸ªå‡½æ•°ä½œç”¨ç›¸åŒï¼Œè¿”å›å½“å‰ç³»ç»Ÿçš„æ—¥æœŸå€¼</td>  </tr>  <tr>    <td>CURTIMEå’ŒCURRENT_TIME</td>    <td>ä¸¤ä¸ªå‡½æ•°ä½œç”¨ç›¸åŒï¼Œè¿”å›å½“å‰ç³»ç»Ÿçš„æ—¶é—´å€¼</td>  </tr>  <tr>    <td>NOWå’ŒSYSDATE</td>    <td>ä¸¤ä¸ªå‡½æ•°ä½œç”¨ç›¸åŒï¼Œè¿”å›å½“å‰ç³»ç»Ÿçš„æ—¥æœŸå’Œæ—¶é—´å€¼</td>  </tr>  <tr>    <td>MONTH</td>    <td>è·å–æŒ‡å®šæ—¥æœŸä¸­çš„æœˆä»½</td>  </tr>  <tr>    <td>MONTHNAME</td>    <td>è·å–æŒ‡å®šæ—¥æœŸä¸­çš„æœˆä»½è‹±æ–‡åç§°</td>  </tr>  <tr>    <td>DAYNAE</td>    <td>è·å–æŒ‡å®šæ—¥æœŸå¯¹åº”çš„æ˜ŸæœŸå‡ çš„è‹±æ–‡åç§°</td>  </tr>  <tr>    <td>DAYOFWEEK</td>    <td>è·å–æŒ‡å®šæ—¥æœŸå¯¹åº”çš„ä¸€å‘¨çš„ç´¢å¼•ä½ç½®å€¼</td>  </tr>  <tr>    <td>WEEK</td>    <td>è·å–æŒ‡å®šæ—¥æœŸæ˜¯ä¸€å¹´ä¸­çš„ç¬¬å‡ å‘¨ï¼Œè¿”å›å€¼çš„èŒƒå›´æ˜¯å¦ä¸º0~52æˆ–è€…1~53</td>  </tr>  <tr>    <td>DAYOFYEAR</td>    <td>è·å–æŒ‡å®šæ—¥æœŸæ˜¯ä¸€å¹´ä¸­çš„ç¬¬å‡ å¤©ï¼Œè¿”å›å€¼èŒƒå›´æ˜¯1~366</td>  </tr>  <tr>    <td>DAYOFMONTH</td>    <td>è·å–æŒ‡å®šæ—¥æœŸæ˜¯ä¸€ä¸ªæœˆä¸­çš„ç¬¬å‡ å¤©ï¼Œè¿”å›å€¼æ˜¯1~31</td>  </tr>  <tr>    <td>YEAR</td>    <td>è·å–å¹´ä»½ï¼Œè¿”å›å€¼èŒƒå›´æ˜¯1970~2069</td>  </tr>  <tr>    <td>TIME_TO_SEC</td>    <td>å°†æ—¶é—´å‚æ•°è½¬æ¢ä¸ºç§’æ•°</td>  </tr>  <tr>    <td>SEC_TO_TIME</td>    <td>å°†ç§’æ•°è½¬æ¢ä¸ºæ—¶é—´ï¼Œä¸TIME_TO_SECäº’ä¸ºåå‡½æ•°</td>  </tr>  <tr>    <td>DATE_ADDå’ŒADDDATE</td>    <td>ä¸¤ä¸ªå‡½æ•°åŠŸèƒ½ç›¸åŒï¼Œéƒ½æ˜¯å‘æ—¥æœŸæ·»åŠ æŒ‡å®šçš„æ—¶é—´é—´éš”</td>  </tr>  <tr>    <td>DATE_SUBå’ŒSUBDATE</td>    <td>ä¸¤ä¸ªå‡½æ•°åŠŸèƒ½ç›¸åŒï¼Œéƒ½æ˜¯å‘æ—¥æœŸå‡å»æŒ‡å®šçš„æ—¶é—´é—´éš”</td>  </tr>  <tr>    <td>ADDTIME</td>    <td>æ—¶é—´åŠ æ³•è¿ç®—ï¼Œåœ¨åŸå§‹æ—¶é—´ä¸Šæ·»åŠ æŒ‡å®šçš„æ—¶é—´</td>  </tr>  <tr>    <td>SUBTIME</td>    <td>æ—¶é—´å‡æ³•è¿ç®—ï¼Œåœ¨åŸå§‹æ—¶é—´ä¸Šå‡å»æŒ‡å®šæ—¶é—´</td>  </tr>  <tr>    <td>DATEDIFF</td>    <td>è·å–ä¸¤ä¸ªæ—¥æœŸä¹‹é—´é—´éš”ï¼Œè¿”å›å‚æ•°1å‡å»å‚æ•°2çš„å€¼</td>  </tr>  <tr>    <td>DATE_FORMAT</td>    <td>æ ¼å¼åŒ–æŒ‡å®šçš„æ—¥æœŸï¼Œæ ¹æ®å‚æ•°è¿”å›æŒ‡å®šæ ¼å¼çš„å€¼</td>  </tr>  <tr>    <td>WEEKDAY</td>    <td>è·å–æŒ‡å®šæ—¥æœŸåœ¨ä¸€å‘¨å†…çš„å¯¹åº”çš„å·¥ä½œæ—¥ç´¢å¼•</td>  </tr></table><h3 id="èšåˆå‡½æ•°"><a href="#èšåˆå‡½æ•°" class="headerlink" title="èšåˆå‡½æ•°"></a>èšåˆå‡½æ•°</h3><table>  <tr>    <th>å‡½æ•°åç§°</th>    <th>ä½œç”¨</th>  </tr>  <tr>    <td style="color:red;font-weight:bolder;">MAX</td>    <td>æŸ¥è¯¢ <span style="color:red;font-weight:bolder;">æŒ‡å®šåˆ—çš„æœ€å¤§å€¼</span></td>  </tr>  <tr>    <td style="color:red;font-weight:bolder;">MIN</td>    <td>æŸ¥è¯¢ <span style="color:red;font-weight:bolder;">æŒ‡å®šåˆ—çš„æœ€å°å€¼</span></td>  </tr>  <tr>    <td style="color:red;font-weight:bolder;">COUNT</td>    <td><span style="color:red;font-weight:bolder;">ç»Ÿè®¡æŸ¥è¯¢ç»“æœçš„è¡Œæ•°</span></td>  </tr>  <tr>    <td style="color:red;font-weight:bolder;">SUM</td>    <td>æ±‚å’Œï¼Œè¿”å› <span style="color:red;font-weight:bolder;">æŒ‡å®šåˆ—çš„æ€»å’Œ</span></td>  </tr>  <tr>    <td style="color:red;font-weight:bolder;">AVG</td>    <td>æ±‚å¹³å‡å€¼ï¼Œè¿”å› <span style="color:red;font-weight:bolder;">æŒ‡å®šåˆ—æ•°æ®çš„å¹³å‡å€¼</span></td>  </tr></table><h2 id="è¯¾ç¨‹å†…å®¹"><a href="#è¯¾ç¨‹å†…å®¹" class="headerlink" title="è¯¾ç¨‹å†…å®¹"></a>è¯¾ç¨‹å†…å®¹</h2><h2 id="å¸¸ç”¨å·¥å…·-mysql"><a href="#å¸¸ç”¨å·¥å…·-mysql" class="headerlink" title="å¸¸ç”¨å·¥å…· - mysql"></a>å¸¸ç”¨å·¥å…· - mysql</h2><h2 id="å¸¸ç”¨å·¥å…·-mysqladmin"><a href="#å¸¸ç”¨å·¥å…·-mysqladmin" class="headerlink" title="å¸¸ç”¨å·¥å…· - mysqladmin"></a>å¸¸ç”¨å·¥å…· - mysqladmin</h2><h2 id="å¸¸ç”¨å·¥å…·-mysqlbinlogä¸mysqldump"><a href="#å¸¸ç”¨å·¥å…·-mysqlbinlogä¸mysqldump" class="headerlink" title="å¸¸ç”¨å·¥å…· - mysqlbinlogä¸mysqldump"></a>å¸¸ç”¨å·¥å…· - mysqlbinlogä¸mysqldump</h2><h2 id="å¸¸ç”¨å·¥å…·-mysqlimportä¸source"><a href="#å¸¸ç”¨å·¥å…·-mysqlimportä¸source" class="headerlink" title="å¸¸ç”¨å·¥å…· - mysqlimportä¸source"></a>å¸¸ç”¨å·¥å…· - mysqlimportä¸source</h2><h2 id="å¸¸ç”¨å·¥å…·-mysqlshow"><a href="#å¸¸ç”¨å·¥å…·-mysqlshow" class="headerlink" title="å¸¸ç”¨å·¥å…· - mysqlshow"></a>å¸¸ç”¨å·¥å…· - mysqlshow</h2><h2 id="æ—¥å¿—-é”™è¯¯æ—¥å¿—"><a href="#æ—¥å¿—-é”™è¯¯æ—¥å¿—" class="headerlink" title="æ—¥å¿— - é”™è¯¯æ—¥å¿—"></a>æ—¥å¿— - é”™è¯¯æ—¥å¿—</h2><h2 id="æ—¥å¿—-äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆstatementï¼‰"><a href="#æ—¥å¿—-äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆstatementï¼‰" class="headerlink" title="æ—¥å¿— - äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆstatementï¼‰"></a>æ—¥å¿— - äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆstatementï¼‰</h2><h2 id="æ—¥å¿—-äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆrowåŠæ—¥å¿—åˆ é™¤ï¼‰"><a href="#æ—¥å¿—-äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆrowåŠæ—¥å¿—åˆ é™¤ï¼‰" class="headerlink" title="æ—¥å¿— - äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆrowåŠæ—¥å¿—åˆ é™¤ï¼‰"></a>æ—¥å¿— - äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆrowåŠæ—¥å¿—åˆ é™¤ï¼‰</h2><h2 id="æ—¥å¿—-æŸ¥è¯¢æ—¥å¿—"><a href="#æ—¥å¿—-æŸ¥è¯¢æ—¥å¿—" class="headerlink" title="æ—¥å¿— - æŸ¥è¯¢æ—¥å¿—"></a>æ—¥å¿— - æŸ¥è¯¢æ—¥å¿—</h2><h2 id="æ—¥å¿—-æ…¢æŸ¥è¯¢æ—¥å¿—"><a href="#æ—¥å¿—-æ…¢æŸ¥è¯¢æ—¥å¿—" class="headerlink" title="æ—¥å¿— - æ…¢æŸ¥è¯¢æ—¥å¿—"></a>æ—¥å¿— - æ…¢æŸ¥è¯¢æ—¥å¿—</h2><h2 id="å¤åˆ¶-åŸç†"><a href="#å¤åˆ¶-åŸç†" class="headerlink" title="å¤åˆ¶ - åŸç†"></a>å¤åˆ¶ - åŸç†</h2><h2 id="æ¡ˆä¾‹-éœ€æ±‚åŠç¯å¢ƒå‡†å¤‡"><a href="#æ¡ˆä¾‹-éœ€æ±‚åŠç¯å¢ƒå‡†å¤‡" class="headerlink" title="æ¡ˆä¾‹ - éœ€æ±‚åŠç¯å¢ƒå‡†å¤‡"></a>æ¡ˆä¾‹ - éœ€æ±‚åŠç¯å¢ƒå‡†å¤‡</h2><h2 id="æ¡ˆä¾‹-åŸºæœ¬å·¥ç¨‹å¯¼å…¥"><a href="#æ¡ˆä¾‹-åŸºæœ¬å·¥ç¨‹å¯¼å…¥" class="headerlink" title="æ¡ˆä¾‹ - åŸºæœ¬å·¥ç¨‹å¯¼å…¥"></a>æ¡ˆä¾‹ - åŸºæœ¬å·¥ç¨‹å¯¼å…¥</h2><h2 id="æ¡ˆä¾‹-AOPè®°å½•æ—¥å¿—"><a href="#æ¡ˆä¾‹-AOPè®°å½•æ—¥å¿—" class="headerlink" title="æ¡ˆä¾‹ - AOPè®°å½•æ—¥å¿—"></a>æ¡ˆä¾‹ - AOPè®°å½•æ—¥å¿—</h2><h2 id="æ¡ˆä¾‹-æ—¥å¿—æŸ¥è¯¢åç«¯-mapperæ¥å£"><a href="#æ¡ˆä¾‹-æ—¥å¿—æŸ¥è¯¢åç«¯-mapperæ¥å£" class="headerlink" title="æ¡ˆä¾‹ - æ—¥å¿—æŸ¥è¯¢åç«¯ - mapperæ¥å£"></a>æ¡ˆä¾‹ - æ—¥å¿—æŸ¥è¯¢åç«¯ - mapperæ¥å£</h2><h2 id="æ¡ˆä¾‹-æ—¥å¿—æŸ¥è¯¢åç«¯-Service-amp-Controller"><a href="#æ¡ˆä¾‹-æ—¥å¿—æŸ¥è¯¢åç«¯-Service-amp-Controller" class="headerlink" title="æ¡ˆä¾‹ - æ—¥å¿—æŸ¥è¯¢åç«¯ - Service&amp;Controller"></a>æ¡ˆä¾‹ - æ—¥å¿—æŸ¥è¯¢åç«¯ - Service&amp;Controller</h2><h2 id="æ¡ˆä¾‹-æ—¥å¿—æŸ¥è¯¢-å‰ç«¯"><a href="#æ¡ˆä¾‹-æ—¥å¿—æŸ¥è¯¢-å‰ç«¯" class="headerlink" title="æ¡ˆä¾‹ - æ—¥å¿—æŸ¥è¯¢ - å‰ç«¯"></a>æ¡ˆä¾‹ - æ—¥å¿—æŸ¥è¯¢ - å‰ç«¯</h2><h2 id="æ¡ˆä¾‹-ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–åˆ†æ"><a href="#æ¡ˆä¾‹-ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–åˆ†æ" class="headerlink" title="æ¡ˆä¾‹ - ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–åˆ†æ"></a>æ¡ˆä¾‹ - ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–åˆ†æ</h2><h2 id="æ¡ˆä¾‹-ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–-åˆ†é¡µä¼˜åŒ–"><a href="#æ¡ˆä¾‹-ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–-åˆ†é¡µä¼˜åŒ–" class="headerlink" title="æ¡ˆä¾‹ - ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ– - åˆ†é¡µä¼˜åŒ–"></a>æ¡ˆä¾‹ - ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ– - åˆ†é¡µä¼˜åŒ–</h2><h2 id="æ¡ˆä¾‹-ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–-ç´¢å¼•ä¼˜åŒ–"><a href="#æ¡ˆä¾‹-ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–-ç´¢å¼•ä¼˜åŒ–" class="headerlink" title="æ¡ˆä¾‹ - ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ– - ç´¢å¼•ä¼˜åŒ–"></a>æ¡ˆä¾‹ - ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ– - ç´¢å¼•ä¼˜åŒ–</h2><h2 id="æ¡ˆä¾‹-ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–-è¯»å†™åˆ†ç¦»æ¦‚è¿°"><a href="#æ¡ˆä¾‹-ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–-è¯»å†™åˆ†ç¦»æ¦‚è¿°" class="headerlink" title="æ¡ˆä¾‹ - ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ– - è¯»å†™åˆ†ç¦»æ¦‚è¿°"></a>æ¡ˆä¾‹ - ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ– - è¯»å†™åˆ†ç¦»æ¦‚è¿°</h2><h2 id="æ¡ˆä¾‹-ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–-æ•°æ®æºé…ç½®"><a href="#æ¡ˆä¾‹-ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–-æ•°æ®æºé…ç½®" class="headerlink" title="æ¡ˆä¾‹ - ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ– - æ•°æ®æºé…ç½®"></a>æ¡ˆä¾‹ - ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ– - æ•°æ®æºé…ç½®</h2><h2 id="æ¡ˆä¾‹-ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–-AOPåˆ‡æ¢æ•°æ®æº"><a href="#æ¡ˆä¾‹-ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–-AOPåˆ‡æ¢æ•°æ®æº" class="headerlink" title="æ¡ˆä¾‹ - ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ– - AOPåˆ‡æ¢æ•°æ®æº"></a>æ¡ˆä¾‹ - ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ– - AOPåˆ‡æ¢æ•°æ®æº</h2><h2 id="æ¡ˆä¾‹-ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–-AOPåˆ‡æ¢æ•°æ®æº-æµ‹è¯•"><a href="#æ¡ˆä¾‹-ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–-AOPåˆ‡æ¢æ•°æ®æº-æµ‹è¯•" class="headerlink" title="æ¡ˆä¾‹ - ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ– - AOPåˆ‡æ¢æ•°æ®æº - æµ‹è¯•"></a>æ¡ˆä¾‹ - ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ– - AOPåˆ‡æ¢æ•°æ®æº - æµ‹è¯•</h2><h2 id="æ¡ˆä¾‹-ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–-AOPåˆ‡æ¢æ•°æ®æº-åŸç†è§£æ"><a href="#æ¡ˆä¾‹-ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–-AOPåˆ‡æ¢æ•°æ®æº-åŸç†è§£æ" class="headerlink" title="æ¡ˆä¾‹ - ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ– - AOPåˆ‡æ¢æ•°æ®æº - åŸç†è§£æ"></a>æ¡ˆä¾‹ - ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ– - AOPåˆ‡æ¢æ•°æ®æº - åŸç†è§£æ</h2><h2 id="æ¡ˆä¾‹-ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–-åº”ç”¨ä¼˜åŒ–"><a href="#æ¡ˆä¾‹-ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–-åº”ç”¨ä¼˜åŒ–" class="headerlink" title="æ¡ˆä¾‹ - ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ– - åº”ç”¨ä¼˜åŒ–"></a>æ¡ˆä¾‹ - ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ– - åº”ç”¨ä¼˜åŒ–</h2>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;è§‚çœ‹ç¬”è®°ï¼š&lt;code&gt;https://www.bilibili.com/video/BV1fJ41127Rj?from=search&amp;amp
      
    
    </summary>
    
    
      <category term="ç¬”è®°" scheme="https://fengshana.github.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="ç¬”è®°" scheme="https://fengshana.github.io/tags/%E7%AC%94%E8%AE%B0/"/>
    
      <category term="MySQL" scheme="https://fengshana.github.io/tags/MySQL/"/>
    
      <category term="æ•°æ®åº“ä¼˜åŒ–" scheme="https://fengshana.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>å…¨é¢æ·±å…¥è®²è§£MySQLæ•°æ®åº“ä¼˜åŒ–02</title>
    <link href="https://fengshana.github.io/2020/05/29/%E3%80%90MYSQL%E3%80%91/%E3%80%90MYSQL%E3%80%91%E5%85%A8%E9%9D%A2%E6%B7%B1%E5%85%A5%E8%AE%B2%E8%A7%A3MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%9602/"/>
    <id>https://fengshana.github.io/2020/05/29/%E3%80%90MYSQL%E3%80%91/%E3%80%90MYSQL%E3%80%91%E5%85%A8%E9%9D%A2%E6%B7%B1%E5%85%A5%E8%AE%B2%E8%A7%A3MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%9602/</id>
    <published>2020-05-29T11:23:12.998Z</published>
    <updated>2020-06-05T17:55:53.838Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è§‚çœ‹ç¬”è®°ï¼š<code>https://www.bilibili.com/video/BV1fJ41127Rj?from=search&amp;seid=13531213796559959972</code>  </p><p>æœ¬è¯¾ç¨‹ä½œä¸ºMySQLé«˜çº§è¯¾ç¨‹ï¼Œä¸»è¦è®²è§£äº†ï¼š  </p><ul><li><strong>MySQL</strong>ä¸­çš„<strong>è§†å›¾</strong>/<strong>å­˜å‚¨è¿‡ç¨‹</strong>/<strong>è§¦å‘å™¨</strong>/<strong>ç´¢å¼•</strong>ç­‰å¯¹è±¡çš„ä½¿ç”¨</li><li>å¸¸è§çš„<strong>SQL</strong>è¯­å¥<strong>ä¼˜åŒ–</strong>çš„æŠ€å·§</li><li><strong>åº”ç”¨ä¼˜åŒ–</strong></li><li><strong>æ•°æ®åº“ä¼˜åŒ–</strong></li><li><strong>æ•°æ®åº“æ—¥å¿—</strong></li></ul><p>ç­‰æ–¹é¢çš„çŸ¥è¯†ï¼Œå¹¶é€šè¿‡ç»¼åˆæ¡ˆä¾‹ï¼Œå¯¹è¯¾ç¨‹ä¸­çš„çŸ¥è¯†è¿›è¡Œä¸€ä¸ªæ•´åˆåº”ç”¨ã€‚  </p><p>æœ¬è¯¾ç¨‹æ—¨åœ¨é€šè¿‡MySQlé«˜çº§éƒ¨åˆ†å†…å®¹ï¼Œå¯ä»¥åœ¨æ»¡è¶³ç°æœ‰ä¸šåŠ¡éœ€æ±‚åŸºç¡€ä¸Šï¼Œå¯¹<strong>MySQLåº•å±‚çš„ä½“ç³»ç»“æ„</strong>ï¼ŒåŠ<strong>åº•å±‚çš„ä¼˜åŒ–</strong>æœ‰ä¸€ä¸ªæ·±å…¥çš„ç†è§£ï¼Œå¯¹<strong>ç³»ç»Ÿçš„æ•´ä½“æ€§èƒ½</strong>è¿›è¡Œæå‡ã€‚  </p><h2 id="ä»Šæ—¥å†…å®¹"><a href="#ä»Šæ—¥å†…å®¹" class="headerlink" title="ä»Šæ—¥å†…å®¹"></a>ä»Šæ—¥å†…å®¹</h2><blockquote><p>Mysqlé«˜çº§-day02</p></blockquote><p>1ï¼‰ MySqlçš„ä½“ç³»ç»“æ„æ¦‚è§ˆï¼ˆMySQLå†…éƒ¨åŸç†ï¼Œå†…éƒ¨æ‰§è¡Œæµç¨‹æœ‰ä¸€ä¸ªè®¤è¯†ï¼‰<br>2ï¼‰ <strong>å­˜å‚¨å¼•æ“</strong>ï¼ˆInnoDBä»¥åŠMyISAMï¼‰<br>3ï¼‰ <strong>ä¼˜åŒ–SQL</strong>æ­¥éª¤ï¼ˆä»å“ªäº›æ–¹é¢ä»¥åŠå‚è€ƒæŒ‡æ ‡ï¼‰<br>4ï¼‰ <strong>ç´¢å¼•çš„ä½¿ç”¨</strong>ï¼ˆåœ¨<strong>SQLä¼˜åŒ–</strong>ä¸­å¦‚ä½•ä½¿ç”¨ï¼‰<br>5ï¼‰ <strong>SQLä¼˜åŒ–</strong>  </p><h2 id="ä½“ç³»ç»“æ„"><a href="#ä½“ç³»ç»“æ„" class="headerlink" title="ä½“ç³»ç»“æ„"></a>ä½“ç³»ç»“æ„</h2><h3 id="MySQLçš„ä½“ç³»ç»“æ„æ¦‚è§ˆ"><a href="#MySQLçš„ä½“ç³»ç»“æ„æ¦‚è§ˆ" class="headerlink" title="MySQLçš„ä½“ç³»ç»“æ„æ¦‚è§ˆ"></a>MySQLçš„ä½“ç³»ç»“æ„æ¦‚è§ˆ</h3><p><strong>MySQLçš„ä½“ç³»ç»“æ„</strong>å›¾å’Œåœ¨è¿›è¡Œ<strong>Webå¼€å‘çš„ä¸‰å±‚æ¶æ„</strong>æ˜¯ç›¸ç±»ä¼¼çš„ï¼›  </p><p><strong>Webå¼€å‘æ—¶çš„ä¸‰å±‚æ¶æ„</strong>ï¼š<br><strong>ï¼ˆ1ï¼‰</strong> å‰ç«¯å‘èµ·è¯·æ±‚å…ˆåˆ°è¾¾controllerï¼›<br><strong>ï¼ˆ2ï¼‰</strong> controllerè°ƒserviceï¼›serviceè°ƒç”¨dao;<br><strong>ï¼ˆ3ï¼‰</strong> daoå†å»è®¿é—®æ•°æ®åº“ï¼›  </p><p>mysqlçš„ä½“ç³»ç»“æ„å½“ä¸­ï¼Œé¦–å…ˆæœ€ä¸Šé¢çš„éƒ¨åˆ†<strong>Connectors</strong>å®é™…ä¸Šä»£è¡¨çš„å°±ç›¸å½“äºæ˜¯<strong>å®¢æˆ·ç«¯</strong>ï¼›<br>åœ¨å®¢æˆ·ç«¯è¿æ¥å½“ä¸­Natice C APIï¼ŒJDBCï¼ŒODBC,.NETï¼ŒPHP,Perlï¼ŒPythonï¼ŒRubyï¼ŒCobolè¿™äº›ä¸ªï¼›<br>JDBCå°±å¾ˆç†Ÿæ‚‰äº†ï¼›åœ¨Javaç¨‹åºå½“ä¸­å¯ä»¥é€šè¿‡JDBCæ¥è¿›è¡Œæ“ä½œmysqlï¼›<br>æ‰€ä»¥æœ€ä¸Šé¢éƒ¨åˆ†å³mysqlè¿æ¥çš„å®¢æˆ·ç«¯é€šè¿‡JDBCæ¥è¿›è¡Œæ“ä½œï¼›<br>ç„¶åç´§æ¥ç€ä¸­å±‚å³MySQL Serverï¼›  </p><p>MySQL Serverå½“ä¸­æœ€ä¸Šé¢ä¸€å±‚å³<strong>Connection Poolè¿æ¥æ± </strong>ï¼›<br>åœ¨è¿æ¥æ± å½“ä¸­æœ‰å¾ˆå¤šçš„ç»„ä»¶æ¨¡å—Authenticationã€Thread Reuseã€Connection Limitsã€Check Memoryã€Cachesï¼›<br>ä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯å‘èµ·ä¸€ä¸ªè¿æ¥ï¼›<br>è¿™ä¸ªè¿æ¥å°±ä¼šåˆ°<strong>MySQL Serverçš„è¿™ä¸ªConnection Poolè¿æ¥æ± å½“ä¸­</strong>æ¥è¿›è¡Œ<strong>è·å–ä¸€ä¸ªè¿æ¥ æ¥ æ‰§è¡Œ å¯¹åº”çš„è¯·æ±‚</strong>ï¼›<br>å½“ç„¶ï¼Œåœ¨MySQL Serverçš„Connection Poolè¿›è¡Œè·å–è¿æ¥çš„æ—¶å€™è¿˜éœ€è¦è¿›è¡Œè®¤è¯ã€è¿æ¥æœ€å¤§æ•°ã€ç¼“å­˜ç­‰ç›¸å…³æ“ä½œï¼›<br>æ­¤ä¸ºMySQL Serverçš„ç¬¬ä¸€å±‚è¿æ¥å±‚ï¼›<br>è¿æ¥å±‚ä¸»è¦è´Ÿè´£çš„å°±æ˜¯å®¢æˆ·ç«¯å‘èµ·ä¸€ä¸ªè¯·æ±‚ï¼Œ<br>MySQL Serveræ¥æ”¶åˆ°è¿™ä¸ªè¯·æ±‚ä¹‹åï¼Œå¼€å¯ä¸€æ®µçº¿ç¨‹è¿›è¡Œä¸å®¢æˆ·ç«¯è¯·æ±‚ç›¸å…³çš„æ“ä½œï¼›<br>è¿™æ˜¯è¿æ¥å±‚ï¼›  </p><p>MySQL Serverå½“ä¸­çš„ç¬¬äºŒå±‚å³Management Services &amp; Utilltiesã€SQL Interfaceã€Parserã€Optimizerã€Caches &amp; Buffers è¿™ä¸€éƒ¨åˆ†ï¼›<br>MySQL Serverç¬¬äºŒå±‚å½“ä¸­æœ‰å¾ˆå¤šçš„ç»„ä»¶ï¼›<br>å…¶ä¸­ç¬¬ä¸€ä¸ªï¼ˆç¬¬ä¸€ä¸ªæ¨¡å—ï¼‰å³MySQLçš„ç®¡ç†æœåŠ¡ä»¥åŠä¸€äº›å·¥å…·ï¼›ç®¡ç†å±‚Management Serviceså½“ä¸­å¯ä»¥è¿›è¡Œæ•°æ®çš„å¤‡ä»½ä¸æ¢å¤ä»¥åŠé›†ç¾¤å®‰å…¨ä»¥åŠç³»ç»Ÿé…ç½®ç›¸å…³çš„å†…å®¹ï¼ˆBackup &amp; Recoveryï¼ŒSecurityï¼ŒReplicationï¼ŒClusterï¼ŒAdministratorï¼ŒConfigurationï¼ŒMigration &amp; Metadataï¼‰<br>ç¬¬äºŒå±‚çš„ç¬¬äºŒä¸ªæ¨¡å—ï¼šSQL Interfaceå³SQLçš„ä¸€ä¸ªæ¥å£ï¼Œåœ¨æ­¤å½“ä¸­å¯ä»¥å»è¿›è¡Œæ‰§è¡Œæˆ–è€…æ˜¯å»å°è£…DMLã€DDLè¯­å¥ä»¥åŠå­˜å‚¨è¿‡ç¨‹ã€å­˜å‚¨å‡½æ•°ã€è§†å›¾ã€è§¦å‘å™¨ç­‰ç­‰ç›¸å…³æ•°æ®åº“å¯¹è±¡ï¼ˆDMLã€DDLã€Stored Proceduresï¼ŒViews ï¼ŒTriggers ï¼Œetc.ï¼‰</p><p>ç¬¬äºŒå±‚çš„ç¬¬ä¸‰ä¸ªæ¨¡å—å³ï¼šParserï¼ŒParserå°±æ˜¯ä¸€ä¸ªè§£æå™¨ï¼Œè¿™ä¸ªè§£æå™¨è§£æçš„æ˜¯å®¢æˆ·ç«¯å‘èµ·çš„ä¸€ä¸ªè¯·æ±‚ï¼Œå®¢æˆ·ç«¯å‘èµ·çš„è¿™ä¸ªè¯·æ±‚å°±æ˜¯SQLè¯­å¥ï¼ŒSQLè¯­å¥éœ€è¦ç»è¿‡è¿™ä¸ªè§£æå™¨Parserçš„è§£æï¼Œè§£æä¹‹åå¹¶ä¸”åœ¨è¿™ä¸€å—è¿›è¡Œç›¸å…³çš„è¿‡æ»¤ï¼ˆQuery Translation,Object Privilegeï¼‰  </p><p>è§£æå®Œæˆä¹‹åï¼Œåœ¨MySQLçš„å†…éƒ¨è¿˜éœ€è¦å‡ ä¸ªè¿‡ç¨‹ï¼›<br>ç¬¬äºŒå±‚çš„ç¬¬å››ä¸ªæ¨¡å—ï¼šOptimizerï¼Œè¿™ä¸ªè¿‡ç¨‹å®é™…ä¸Šç§°ä½œä¼˜åŒ–å™¨ï¼›å³åœ¨è§£æå®Œæˆäº†å‰ç«¯è¯·æ±‚è¿‡æ¥çš„SQLè¯­å¥å¹¶è¿›è¡Œç›¸å…³çš„è¿‡æ»¤ä¹‹åï¼ŒMySQLå†…éƒ¨è¿˜é¡»è¦é€šè¿‡å…¶å†…éƒ¨çš„ä¸€ä¸ªä¼˜åŒ–å™¨ï¼Œå¯¹å‰ç«¯è¯·æ±‚æ¥çš„SQLè¯­å¥è§£æå¹¶è¿‡æ»¤åè¿›è¡Œä¸€ä¸ªä¼˜åŒ–å¤„ç†ï¼›MySQLå†…éƒ¨ä¼šæŒ‰ç…§å…¶å†…éƒ¨è‡ªå·±çš„ä¸€ä¸ªä¼˜åŒ–ä½“ç³»æ¥è¿›è¡Œä¼˜åŒ–ï¼ˆAccess Pathsï¼ŒStatisticsï¼‰  </p><p>å½“ä¼˜åŒ–å®Œæˆä¹‹åï¼Œæ¥ä¸‹æ¥è¿˜éœ€è¦è¿›è¡Œç¼“å­˜çš„ä¸€ä¸ªæ“ä½œï¼š<br>ç¬¬äºŒç¨‹çš„ç¬¬äº”ä¸ªæ¨¡å—ï¼šCaches &amp; Buffersï¼Œå³æŸ¥è¯¢åœ¨ç¼“å­˜å½“ä¸­æœ‰æ²¡æœ‰è¦æŸ¥è¯¢çš„æ•°æ®ï¼›å¦‚æœå­˜åœ¨æœ‰å¯¹åº”çš„æ ‘æ®ä¿¡æ¯ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å¯èƒ½å°±ç›´æ¥è¿”å›ç»™å‰ç«¯å®¢æˆ·ç«¯äº†ï¼›ï¼ˆGlobal and Engine ï¼ŒSpecific Caches &amp; Buffersï¼‰  </p><p>æ‰€ä»¥ç¬¬äºŒå±‚å½“ä¸­çš„è¿™äº”ä¸ªæ¨¡å—å°±æ˜¯MySQLçš„æœåŠ¡å±‚æ“ä½œï¼›å³å°†å‰ç«¯è¯·æ±‚çš„SQLè¯­å¥è¿›è¡Œå°è£…èµ·æ¥å¹¶ä¸”è¿›è¡Œè§£æä»¥åŠç›¸å…³è¿‡æ»¤ï¼Œä»¥åŠå¯¹å…¶è¿›è¡Œä¼˜åŒ–ï¼Œæœ€ç»ˆè¿˜éœ€è¦æ“ä½œMySQLå½“ä¸­çš„ç¼“å­˜åŒºçš„ä¿¡æ¯ï¼›  </p><p>MySQL Serverçš„ç¬¬ä¸‰å±‚ï¼šPluggable Storage Engines(Memoryï¼ŒIndex &amp; Storage Management)ï¼Œæ­¤å¤„å®é™…æŒ‡çš„æ˜¯å­˜å‚¨å¼•æ“ï¼›<br>Pluggableæ’ä»¶å¼çš„å­˜å‚¨å¼•æ“ï¼›<br>ä»¥ä¸‹æ˜¯MySQLå½“ä¸­çš„å­˜å‚¨å¼•æ“:<br>ï¼ˆMyISAMã€InnoDBã€NDBã€Archiveã€Federatedã€Memoryã€Mergeã€Partnerã€Communityã€Custom â€¦.ï¼‰<br>MySQLç‰ˆæœ¬5.5ä¹‹åé»˜è®¤çš„å­˜å‚¨å¼•æ“å³ä¸ºInnoDBï¼›<br>å¼•æ“ï¼šå‘åŠ¨æœºï¼›<br>å­˜å‚¨å¼•æ“æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆä¸é£æœºä¸Šçš„å¼•æ“æ¯”è¾ƒç±»ä¼¼ï¼Œæ¯”å¦‚å®¢æœºåˆ™æœ‰å®¢æœºçš„å¼•æ“ï¼Œå®¢æœºå³è¿é€ä¹˜å®¢ã€æ—…å®¢ï¼›ä½†æ˜¯è¿˜æœ‰å¯¹åº”çš„è´§æœºï¼Œé‚£ä¹ˆè´§æœºå³å¯¹åº”çš„å³è¿è¾“è´§ç‰©çš„ï¼›è¿˜æœ‰ç›´å‡æœºç­‰ç­‰ï¼›ä¸åŒçš„é£æœºæœ‰ä¸åŒçš„é£æœºå¼•æ“ï¼›ä¸åŒçš„é£æœºå¼•æ“åœ¨ç›¸å¯¹åº”çš„æœºå‹å½“ä¸­éƒ½å‘æŒ¥ç€ä¸åŒçš„ä½œç”¨ï¼›åœ¨æ“ä½œçš„æ—¶å€™éœ€è¦è€ƒè™‘åˆ°ï¼Œç”¨æˆ·æ˜¯ä»€ä¹ˆï¼Œç„¶åå»è€ƒè™‘æ›´é€‚åˆå“ªä¸€ç§å¼•æ“ï¼Œå¯¹åº”çš„å‘åŠ¨æœºï¼›åŒæ ·å¯¹äºmysqlçš„å­˜å‚¨å¼•æ“æ˜¯ä¸€ä¸ªé“ç†ï¼›å­˜å‚¨å¼•æ“åˆ™éœ€è¦æ ¹æ®å­˜å‚¨çš„æ•°æ®ä¸åŒæˆ–è€…æ˜¯éœ€æ±‚ä¸åŒè€Œé€‰æ‹©ä¸åŒçš„å­˜å‚¨å¼•æ“æ¥è¿›è¡Œå­˜å‚¨ä¸åŒçš„æ•°æ®ï¼›ï¼‰<br>MySQL Serverçš„ç¬¬ä¸‰å±‚ä¸ºå­˜å‚¨å¼•æ“å±‚ï¼›  </p><p>MySQL Serverçš„ç¬¬å››å±‚å³å­˜å‚¨å±‚ï¼šFile systemï¼ˆNTFSï¼Œufsï¼Œext2/3ï¼ŒNFSï¼ŒSANï¼ŒNASï¼‰<br>Files &amp; Logsï¼ˆRedoï¼ŒUndoï¼ŒDataï¼ŒIndexï¼ŒBinaryï¼ŒErrorï¼ŒQuery and Slowï¼‰<br>åœ¨æ“ä½œMySQLæ•°æ®åº“ä¸­è¡¨å½“ä¸­çš„æ•°æ®çš„æ—¶å€™ï¼Œä¸ç®¡æ˜¯æ’å…¥è¿˜æ˜¯æŸ¥è¯¢æˆ–è€…ä¿®æ”¹åˆ é™¤ç­‰æ“ä½œï¼›å®é™…ä¸Šæœ€ç»ˆéƒ½æ˜¯æ“ä½œçš„File systemå³æ–‡ä»¶ç³»ç»Ÿï¼›æœ€ç»ˆæ“ä½œçš„éƒ½æ˜¯æ–‡ä»¶ç³»ç»Ÿå½“ä¸­çš„æ–‡ä»¶ï¼›è€Œè¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿå³å°±å¤„äºç£ç›˜å½“ä¸­ï¼›æ‰€ä»¥æœ€ä¸‹é¢ä¸€å±‚å°±æ–‡ä»¶ç³»ç»Ÿï¼›æœ€é‡è¦æ“ä½œçš„ä¹Ÿå°±æ˜¯æ–‡ä»¶ç³»ç»Ÿï¼›é™¤äº†åœ¨è¡¨ç»“æ„å½“ä¸­çš„æ•°æ®ï¼Œè¿˜æœ‰å¯¹åº”çš„ç´¢å¼•ä¿¡æ¯ã€äºŒè¿›åˆ¶é”™è¯¯ã€æŸ¥è¯¢ã€æ…¢æŸ¥è¯¢æ—¥å¿—ç­‰ï¼›  </p><p>æ­¤ä¸ºMySQLä½“ç³»ç»“æ„å½“ä¸­çš„å››å±‚ï¼›  </p><p>ç¬¬ä¸€å±‚è¿æ¥å±‚ï¼›è´Ÿè´£æ¥æ”¶å®¢æˆ·ç«¯çš„å‘é€çš„è¯·æ±‚ï¼›ç„¶åMySQL Serverå¼€å¯ä¸€æ®µçº¿ç¨‹è¿›è¡Œç›¸å…³çš„è®¤è¯æˆæƒä¹‹åå†æ¥è¿›è¡Œè¯·æ±‚çš„å¤„ç†ï¼›<br>ç¬¬äºŒå±‚æœåŠ¡å±‚ï¼šæœåŠ¡å±‚åœ¨ä¸»è¦èµ·åˆ°å¤‡ä»½æ¢å¤ã€SQLå°è£…ã€è§£æè¿‡æ»¤ã€SQLè¯­å¥ä¼˜åŒ–ã€ç¼“å­˜æŸ¥è¯¢ç­‰ç›¸å…³æ“ä½œï¼›<br>ç¬¬ä¸‰å±‚å­˜å‚¨å¼•æ“å±‚ï¼Œé€‰æ‹©åˆé€‚çš„å­˜å‚¨å¼•æ“å¯¹ç›¸å…³æ•°æ®è¿›è¡Œç›¸å…³çš„å¤„ç†ï¼›<br>ç¬¬å››å±‚æ–‡ä»¶ç³»ç»Ÿï¼šå½“ç¬¬ä¸‰å±‚çš„æ•°æ®è¿›è¡Œç›¸å…³çš„å¤„ç†å®Œæˆä¹‹åï¼Œåˆ™éœ€è¦å°†æ•°æ®æœ€ç»ˆå†™å…¥æ–‡ä»¶ç³»ç»Ÿå½“ä¸­ï¼Œå³å®é™…çš„ç‰©ç†ç£ç›˜å½“ä¸­ï¼›</p><p>æ•´ä¸ªMySQLç”±ä»¥ä¸‹ç»„æˆï¼š  </p><ul><li>Connection Poolï¼šè¿æ¥æ± ç»„ä»¶</li><li>Management Service &amp; Utillties: ç®¡ç†æœåŠ¡å’Œå·¥å…·ç»„ä»¶</li><li>SQL Interface: SQLæ¥å£ç»„ä»¶</li><li>Parser: æŸ¥è¯¢åˆ†æå™¨ç»„ä»¶</li><li>Optimizer: ä¼˜åŒ–å™¨ç»„ä»¶</li><li>Caches &amp; Buffers: ç¼“å†²æ± ç»„ä»¶</li><li>Pluggable Storage Engines: å­˜å‚¨å¼•æ“</li><li>File System: æ–‡ä»¶ç³»ç»Ÿ</li></ul><ol><li>è¿æ¥å±‚<br>æœ€ä¸Šå±‚æ˜¯ä¸€äº›å®¢æˆ·å’Œè¿æ¥æœåŠ¡ï¼ŒåŒ…å«æœ¬åœ°socketé€šä¿¡å’Œå¤§å¤šæ•°åŸºäºå®¢æˆ·ç«¯/æœåŠ¡ç«¯å·¥å…·å®ç°çš„ç±»ä¼¼äºTCP/IPçš„é€šä¿¡ã€‚<br>ä¸»è¦å®Œæˆä¸€äº›ç±»ä¼¼äºè¿æ¥å¤„ç†ã€æˆæƒè®¤è¯ã€ä»¥åŠç›¸å…³çš„å®‰å…¨æ–¹æ¡ˆã€‚<br>åœ¨è¯¥å±‚ä¸Šå¼•å…¥äº†çº¿ç¨‹æ± çš„æ¦‚å¿µï¼Œæœªé€šè¿‡è®¤è¯å®‰å…¨æ¥å…¥çš„å®¢æˆ·ç«¯æä¾›çº¿ç¨‹ã€‚<br>åŒæ ·åœ¨è¯¥å±‚ä¸Šå¯ä»¥å®ç°åŸºäºSSLçš„å®‰å…¨è¿æ¥ï¼ŒæœåŠ¡å™¨ä¹Ÿä¼šä¸ºå®‰å…¨æ¥å…¥çš„æ¯ä¸ªå®¢æˆ·ç«¯éªŒè¯å®ƒæ‰€å…·æœ‰çš„çš„æ“ä½œæƒé™ï¼›  </li><li>æœåŠ¡å±‚<br>ç¬¬äºŒå±‚æ¶æ„ä¸»è¦å®Œæˆå¤§å¤šæ•°çš„æ ¸å¿ƒæœåŠ¡åŠŸèƒ½ï¼Œå¦‚SQLæ¥å£ï¼Œå¹¶å®Œæˆç¼“å­˜çš„æŸ¥è¯¢ï¼ŒSQLçš„åˆ†æå’Œä¼˜åŒ–ï¼Œéƒ¨åˆ†å†…ç½®å‡½æ•°çš„æ‰§è¡Œã€‚<br>æ‰€æœ‰è·¨å­˜å‚¨å¼•æ“çš„åŠŸèƒ½ä¹Ÿåœ¨è¿™ä¸€å±‚å®ç°ï¼Œå¦‚è¿‡ç¨‹ã€å‡½æ•°ç­‰ã€‚<br>åœ¨è¯¥å±‚ï¼ŒæœåŠ¡å™¨ä¼šè§£ææŸ¥è¯¢å¹¶åˆ›å»ºç›¸åº”çš„å†…éƒ¨è§£ææ ‘ï¼Œå¹¶å¯¹å…¶å®Œæˆå“åº”çš„ä¼˜åŒ–å¦‚ç¡®å®šè¡¨çš„æŸ¥è¯¢é¡ºåºï¼Œæ˜¯å¦åˆ©ç”¨ç´¢å¼•ç­‰ï¼Œæœ€åç”Ÿæˆå“åº”çš„æ‰§è¡Œæ“ä½œã€‚<br>å¦‚æœæ˜¯selectè¯­å¥ï¼ŒæœåŠ¡å™¨è¿˜ä¼šæŸ¥è¯¢å†…éƒ¨çš„ç¼“å­˜ï¼Œå¦‚æœç¼“å­˜ç©ºé—´è¶³å¤Ÿå¤§ï¼Œè¿™æ ·åœ¨è§£å†³å¤§é‡è¯»æ“ä½œçš„ç¯å¢ƒä¸­èƒ½å¤Ÿå¾ˆå¥½çš„æå‡ç³»ç»Ÿçš„æ€§èƒ½ã€‚  </li><li>å¼•æ“å±‚<br>å­˜å‚¨å¼•æ“å±‚ï¼Œå­˜å‚¨å¼•æ“çœŸæ­£çš„è´Ÿè´£äº†MySQLä¸­æ•°æ®çš„å­˜å‚¨å’Œæå–ï¼ŒæœåŠ¡å™¨é€šè¿‡APIå’Œå­˜å‚¨å¼•æ“è¿›è¡Œé€šä¿¡ã€‚<br>ä¸åŒçš„å­˜å‚¨å¼•æ“å…·æœ‰ä¸åŒçš„åŠŸèƒ½ï¼Œè¿™æ ·å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦ï¼Œæ¥é€‰å–åˆé€‚çš„å­˜å‚¨å¼•æ“ï¼›  </li><li>å­˜å‚¨å±‚<br>æ•°æ®å­˜å‚¨å±‚ï¼Œä¸»è¦æ˜¯å°†æ•°æ®å­˜å‚¨åœ¨æ–‡ä»¶ç³»ç»Ÿä¹‹ä¸Šï¼Œå¹¶å®Œæˆä¸å­˜å‚¨å¼•æ“çš„äº¤äº’ï¼›  </li></ol><p>å’Œå…¶å®ƒæ•°æ®åº“ç›¸æ¯”ï¼ŒMySQLæœ‰ç‚¹ä¸ä¼—ä¸åŒï¼Œå®ƒçš„æ¶æ„å¯ä»¥åœ¨å¤šç§ä¸åŒåœºæ™¯ä¸­åº”ç”¨å¹¶å‘æŒ¥è‰¯å¥½ä½œç”¨ã€‚<br>ä¸»è¦ä½“ç°åœ¨å­˜å‚¨å¼•æ“ä¸Šï¼Œæ’ä»¶å¼çš„å­˜å‚¨å¼•æ“æ¶æ„ï¼Œå°†æŸ¥è¯¢å¤„ç†å’Œå…¶ä»–çš„ç³»ç»Ÿä»»åŠ¡ä»¥åŠæ•°æ®çš„å­˜å‚¨æå–åˆ†ç¦»ã€‚<br>è¿™ç§æ¶æ„å¯ä»¥æ ¹æ®ä¸šåŠ¡çš„éœ€æ±‚å’Œå®é™…éœ€è¦é€‰æ‹©åˆé€‚çš„å­˜å‚¨å¼•æ“ï¼›  </p><h2 id="å­˜å‚¨å¼•æ“-æ¦‚è¿°"><a href="#å­˜å‚¨å¼•æ“-æ¦‚è¿°" class="headerlink" title="å­˜å‚¨å¼•æ“ - æ¦‚è¿°"></a>å­˜å‚¨å¼•æ“ - æ¦‚è¿°</h2><p>å’Œå¤§å¤šæ•°çš„æ•°æ®åº“ä¸åŒï¼ŒMySQLä¸­æœ‰ä¸€ä¸ªå­˜å‚¨å¼•æ“çš„æ¦‚å¿µï¼Œé’ˆå¯¹ä¸åŒçš„å­˜å‚¨éœ€æ±‚å¯ä»¥é€‰æ‹©æœ€ä¼˜çš„å­˜å‚¨å¼•æ“ï¼›<br>å­˜å‚¨å¼•æ“å°±æ˜¯å­˜å‚¨æ•°æ®ï¼Œå»ºç«‹ç´¢å¼•ï¼Œæ›´æ–°æŸ¥è¯¢æ•°æ®ç­‰ç­‰æŠ€æœ¯çš„å®ç°æ–¹å¼ã€‚<br>å­˜å‚¨å¼•æ“æ˜¯åŸºäºè¡¨çš„ï¼Œè€Œä¸æ˜¯åŸºäºåº“çš„ã€‚<br>ç´¢å¼•å­˜å‚¨å¼•æ“ä¹Ÿå¯è¢«ç§°ä¸ºè¡¨ç±»å‹ã€‚<br>Oracleã€SQLServerç­‰æ•°æ®åº“åªæœ‰ä¸€ç§å­˜å‚¨å¼•æ“ã€‚<br>MySQLæä¾›äº†æ’ä»¶å¼çš„å­˜å‚¨å¼•æ“æ¶æ„ã€‚<br>ç´¢å¼•MySQlå­˜åœ¨å¤šç§å­˜å‚¨å¼•æ“ï¼Œå¯ä»¥æ ¹æ®éœ€è¦ä½¿ç”¨ç›¸åº”å¼•æ“ï¼Œæˆ–è€…ç¼–å†™å­˜å‚¨å¼•æ“ã€‚<br>MySQL5.0æ”¯æŒçš„å­˜å‚¨å¼•æ“åŒ…å«ï¼šInnoDBã€MyISAMã€BDBã€MEMORYã€MERGEã€EXAMPLEã€NDB Clusterã€ARCHIVEã€CSVã€BLACKHOLEã€FEDERATEDç­‰ï¼Œå…¶ä¸­InnoDBå’ŒBDBæä¾›é£Ÿç‰©å®‰å…¨è¡¨ï¼Œå…¶ä»–å­˜å‚¨å¼•æ“æ˜¯éäº‹åŠ¡å®‰å…¨è¡¨ï¼›<br>å¯ä»¥é€šè¿‡æŒ‡å®š show enginesï¼Œæ¥è¿›è¡ŒæŸ¥è¯¢å½“å‰æ•°æ®åº“æ”¯æŒçš„å­˜å‚¨å¼•æ“ï¼›  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">engines</span>;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºæ–°è¡¨æ—¶ï¼Œå¦‚æœä¸æŒ‡å®šå­˜å‚¨å¼•æ“ï¼Œé‚£ä¹ˆç³»ç»Ÿå°±ä¼šä½¿ç”¨é»˜è®¤çš„å­˜å‚¨å¼•æ“ã€‚<br>MySQL5.5ä¹‹å‰çš„é»˜è®¤å­˜å‚¨å¼•æ“æ˜¯MyISAMï¼Œ5.5ä¹‹åå°±æ”¹ä¸ºInnoDBï¼›  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p <span class="comment">#è¿æ¥mysql</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">engines</span>;</span><br><span class="line"><span class="comment"># Engine å­˜å‚¨å¼•æ“çš„åå­—</span></span><br><span class="line"><span class="comment"># Support æ˜¯å¦æ”¯æŒè¯¥å­˜å‚¨å¼•æ“ï¼ŒYES/NO/DEFAULTï¼ŒDEFAULTé»˜è®¤ï¼Œé»˜è®¤æ”¯æŒçš„å­˜å‚¨å¼•æ“InnoDB</span></span><br><span class="line"><span class="comment"># comment æ³¨é‡Š</span></span><br></pre></td></tr></table></figure><blockquote><p>Commentæ³¨é‡Š</p></blockquote><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">MyISAM : MyISAM <span class="keyword">storage</span> engines</span><br><span class="line">MRG_MYISAM : COLLECTION <span class="keyword">OF</span> IDENTICAL MyISAM <span class="keyword">tables</span></span><br><span class="line">MEMORY : Hash based,stored <span class="keyword">in</span> memory,useful <span class="keyword">for</span> <span class="keyword">temporary</span> <span class="keyword">tables</span></span><br><span class="line">BLACKHOLE : /dev/<span class="keyword">null</span> <span class="keyword">storage</span> engine (anything you wirte <span class="keyword">to</span> it disappears)</span><br><span class="line">CSV : CSV <span class="keyword">storage</span> engine</span><br><span class="line">PERFIRMANCE_SCHEMA : Performance <span class="keyword">Schema</span></span><br><span class="line">ARCHIVE : Archive <span class="keyword">storage</span> engine</span><br><span class="line">FEDERATED ï¼š Federated MySQL <span class="keyword">storage</span> engine</span><br><span class="line">InnoDB ï¼š Support <span class="keyword">transaction</span>,<span class="keyword">row</span>-<span class="keyword">level</span> locking, <span class="keyword">and</span> <span class="keyword">foreign</span> keys # æ”¯æŒäº‹åŠ¡ï¼Œæ”¯æŒè¡Œçº§é”å¹¶ä¸”æ”¯æŒå¤–é”®</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æŸ¥çœ‹æ•°æ®åº“å½“ä¸­çš„è¯æ±‡ï¼Ÿ</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">'%storage_engine%'</span>;</span><br><span class="line"></span><br><span class="line">default_storage_engine InnoDB</span><br><span class="line">default_tmp_storage_engine InnoDB</span><br><span class="line">storage_engine InnoDB</span><br></pre></td></tr></table></figure><h2 id="å­˜å‚¨å¼•æ“-ç‰¹æ€§"><a href="#å­˜å‚¨å¼•æ“-ç‰¹æ€§" class="headerlink" title="å­˜å‚¨å¼•æ“ - ç‰¹æ€§"></a>å­˜å‚¨å¼•æ“ - ç‰¹æ€§</h2><p>ä¸‹é¢é‡ç‚¹ä»‹ç»å‡ ç§å¸¸ç”¨çš„å­˜å‚¨å¼•æ“ï¼Œå¹¶å¯¹æ¯”å„ä¸ªå­˜å‚¨å¼•æ“ä¹‹é—´çš„åŒºåˆ«ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š  </p><table>    <tr>      <th>ç‰¹ç‚¹</th>      <th style="background-color:lightblue;color:red;font-weight:bolder;">InnoDB</th>      <th style="background-color:lightblue;color:red;font-weight:bolder;">MyISAM</th>      <th>MEMORY</th>      <th>MERGE</th>      <th>NDB</th>    </tr>    <tr>      <td>å­˜å‚¨é™åˆ¶</td>      <td>64TB</td>      <td>æœ‰</td>      <td>æœ‰</td>      <td>æ²¡æœ‰</td>      <td>æœ‰</td>    </tr>    <tr>      <td style="background-color:lightblue;color:red;font-weight:bolder;">äº‹åŠ¡å®‰å…¨</td>      <td>æ”¯æŒ</td>      <td></td>      <td></td>      <td></td>      <td></td>    </tr>    <tr>      <td style="background-color:lightblue;color:red;font-weight:bolder;">é”æœºåˆ¶</td>      <td style="background-color:lightgreen;color:red;font-weight:bolder;">è¡Œé”ï¼ˆé€‚åˆé«˜å¹¶å‘ï¼‰</td>      <td style="background-color:lightgreen;color:red;font-weight:bolder;">è¡¨é”</td>      <td>è¡¨é”</td>      <td>è¡¨é”</td>      <td>è¡Œé”</td>    </tr>    <tr>      <td>Bæ ‘ç´¢å¼•</td>      <td>æ”¯æŒ</td>      <td>æ”¯æŒ</td>      <td>æ”¯æŒ</td>      <td>æ”¯æŒ</td>      <td>æ”¯æŒ</td>    </tr>    <tr>      <td>å“ˆå¸Œç´¢å¼•</td>      <td>ï¼ˆå½“å‰æˆ‘çœ‹åˆ°çš„æ˜¯æ”¯æŒçš„ï¼‰</td>      <td></td>      <td>æ”¯æŒ</td>      <td></td>      <td></td>    </tr>    <tr>      <td>å…¨æ–‡ç´¢å¼•</td>      <td>æ”¯æŒï¼ˆ5.6ç‰ˆæœ¬ä¹‹åï¼‰</td>      <td>æ”¯æŒ</td>      <td></td>      <td></td>      <td></td>    </tr>    <tr>      <td>é›†ç¾¤ç´¢å¼•</td>      <td>æ”¯æŒ</td>      <td></td>      <td></td>      <td></td>      <td></td>    </tr>    <tr>      <td>æ•°æ®ç´¢å¼•</td>      <td>æ”¯æŒ</td>      <td></td>      <td>æ”¯æŒ</td>      <td></td>      <td>æ”¯æŒ</td>    </tr>     <tr>      <td>ç´¢å¼•ç¼“å­˜</td>      <td>æ”¯æŒ</td>      <td>æ”¯æŒ</td>      <td>æ”¯æŒ</td>      <td>æ”¯æŒ</td>      <td>æ”¯æŒ</td>    </tr> <tr>      <td>æ•°æ®å¯å‹ç¼©</td>      <td></td>      <td>æ”¯æŒ</td>      <td></td>      <td></td>      <td></td>    </tr> <tr>      <td>ç©ºé—´ä½¿ç”¨</td>      <td>é«˜</td>      <td>ä½</td>      <td>N/A</td>      <td>ä½</td>      <td>ä½</td>    </tr> <tr>      <td>å†…å­˜ä½¿ç”¨</td>      <td>é«˜</td>      <td>ä½</td>      <td>ä¸­ç­‰</td>      <td>ä½</td>      <td>é«˜</td>    </tr>     <tr>      <td>æ‰¹é‡æ’å…¥é€Ÿåº¦</td>      <td>ä½</td>      <td>é«˜</td>      <td>é«˜</td>      <td>é«˜</td>      <td>é«˜</td>    </tr>     <tr>      <td style="background-color:lightblue;color:red;font-weight:bolder;">æ”¯æŒå¤–é”®</td>      <td style="background-color:lightgreen;color:red;font-weight:bolder;">æ”¯æŒ</td>      <td></td>      <td></td>      <td></td>      <td></td>    </tr></table><p>ä¸‹é¢å°†é‡ç‚¹ä»‹ç»æœ€å¸¸ä½¿ç”¨çš„ä¸¤ç§å­˜å‚¨å¼•æ“ï¼šInnoDBã€MyISAMï¼Œå¦å¤–ä¸¤ç§MEMORYã€MERGEï¼Œäº†è§£å³å¯ï¼›  </p><h2 id="å­˜å‚¨å¼•æ“-InnoDBç‰¹æ€§"><a href="#å­˜å‚¨å¼•æ“-InnoDBç‰¹æ€§" class="headerlink" title="å­˜å‚¨å¼•æ“ - InnoDBç‰¹æ€§"></a>å­˜å‚¨å¼•æ“ - InnoDBç‰¹æ€§</h2><p>InnoDBå­˜å‚¨å¼•æ“æ˜¯MySQLçš„é»˜è®¤å­˜å‚¨å¼•æ“ã€‚<br>InnoDBå­˜å‚¨å¼•æ“æä¾›äº†å…·æœ‰æäº¤ã€å›æ»šã€å´©æºƒæ¢å¤èƒ½åŠ›çš„äº‹åŠ¡å®‰å…¨ã€‚<br>ä½†æ˜¯å¯¹æ¯”MyISAMçš„å­˜å‚¨å¼•æ“ï¼ŒInnoDBå†™çš„å¤„ç†æ•ˆç‡å·®ä¸€äº›ï¼Œå¹¶ä¸”ä¼šå ç”¨æ›´å¤šçš„ç£ç›˜ç©ºé—´ä»¥ä¿ç•™æ•°æ®å’Œç´¢å¼•ï¼›  </p><p>InnoDBå­˜å‚¨å¼•æ“ä¸åŒäºå…¶ä»–å­˜å‚¨å¼•æ“çš„ç‰¹ç‚¹ï¼š  </p><p><strong>äº‹åŠ¡æ§åˆ¶</strong></p><p>MySQL å½“ä¸­äº‹åŠ¡é»˜è®¤è‡ªåŠ¨æäº¤ï¼›  </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">create database demo_02<span class="built_in"> default </span><span class="attribute">charset</span>=utf8mb4;  </span><br><span class="line">use demo_01;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">create table goods_innodb(</span><br><span class="line">  id int(11) <span class="keyword">not</span> <span class="literal">null</span> auto_increment,</span><br><span class="line">  name varchar(20) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">  primary key(id)</span><br><span class="line">)<span class="attribute">ENGINE</span>=innodb<span class="built_in"> default </span><span class="attribute">charset</span>=utf8;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">start</span> <span class="keyword">transaction</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> goods_innodb(<span class="keyword">id</span>,<span class="keyword">name</span>) <span class="keyword">values</span>(<span class="literal">null</span>,<span class="string">'Meta20'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">commit</span>;<span class="comment"># å¦‚ä¸æäº¤ï¼Œåˆ™å…¶ä»–å®¢æˆ·ç«¯æ— æ³•æŸ¥çœ‹å¾—åˆ°æ’å…¥çš„æ•°æ®ï¼›</span></span><br><span class="line"><span class="comment"># MySQLé»˜è®¤çš„éš”ç¦»çº§åˆ«ä¸ºå¯é‡å¤è¯»</span></span><br></pre></td></tr></table></figure><p><strong>å¤–é”®çº¦æŸ</strong></p><p>MySQLæ”¯æŒå¤–é”®çš„å­˜å‚¨å¼•æ“åªæœ‰InnoDBï¼Œåœ¨åˆ›å»ºå¤–é”®çš„æ—¶å€™ï¼Œè¦æ±‚çˆ¶è¡¨å¿…é¡»æœ‰å¯¹åº”çš„ç´¢å¼•ï¼Œå­è¡¨åœ¨åˆ›å»ºç´¢å¼•çš„æ—¶å€™ï¼Œä¹Ÿä¼šè‡ªåŠ¨çš„åˆ›å»ºå¯¹åº”çš„ç´¢å¼•ï¼›<br>ä¸‹é¢ä¸¤å¼ è¡¨ä¸­ï¼Œ<br>1ï¼‰ country_innodbæ˜¯çˆ¶è¡¨ï¼Œcountry_idä¸ºä¸»é”®ç´¢å¼•ï¼›<br>2ï¼‰ city_innodbæ˜¯å­è¡¨ï¼Œcountry_idå­—æ®µä¸ºå¤–é”®ï¼Œå¯¹åº”äºcountry_innodbè¡¨ä¸­çš„ä¸»é”®country_idï¼›</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> country_innodb(</span><br><span class="line">  country_id <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span> auto_increment,</span><br><span class="line">  counry_name <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">not</span> <span class="literal">null</span> ,</span><br><span class="line">  primary <span class="keyword">key</span> (country_id)</span><br><span class="line">)<span class="keyword">engine</span>=<span class="keyword">innodb</span> <span class="keyword">default</span> <span class="keyword">charset</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> city_innodb(</span><br><span class="line">  city_id <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span> auto_increment,</span><br><span class="line">  city_name <span class="built_in">varchar</span>(<span class="number">50</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">  country_id <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">  primary <span class="keyword">key</span> (city_id),</span><br><span class="line">  <span class="keyword">key</span> idx_fk_country_id(country_id),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> <span class="string">'fk_city_contry'</span> <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span>(country_id) <span class="keyword">REFERENCES</span> country_innodb(country_id) <span class="keyword">ON</span> DFLETE RESTRICT <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="keyword">CASCADE</span></span><br><span class="line">)<span class="keyword">engine</span>=<span class="keyword">innodb</span> <span class="keyword">default</span> <span class="keyword">charset</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ON DELETE RESTRICT åœ¨åˆ é™¤ä¸»è¡¨æ•°æ®æ—¶ï¼Œå¦‚æœæœ‰å…³è”è®°å½•åˆ™ä¸åˆ é™¤</span></span><br><span class="line"><span class="comment"># ON UPDATE CASCADE æ›´æ–°ä¸»è¡¨æ—¶ï¼Œå¦‚æœå­è¡¨æœ‰å…³è”è®°å½•ï¼Œåˆ™æ›´æ–°å­è¡¨è®°å½•  </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ’å…¥æ•°æ®</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> country_innodb <span class="keyword">values</span>(<span class="literal">null</span>,<span class="string">'China'</span>),(<span class="literal">null</span>,<span class="string">'America'</span>),(<span class="literal">null</span>,<span class="string">'Japan'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> city_innodb <span class="keyword">values</span>(<span class="literal">null</span>,<span class="string">'Xian'</span>,<span class="number">1</span>),(<span class="literal">null</span>,<span class="string">'NewYork'</span>,<span class="number">2</span>),(<span class="literal">null</span>,<span class="string">'BeiJing'</span>,<span class="number">1</span>);</span><br></pre></td></tr></table></figure><p>åœ¨åˆ›å»ºç´¢å¼•æ—¶ï¼Œå¯ä»¥æŒ‡å®šåœ¨åˆ é™¤ã€æ›´æ–°çˆ¶è¡¨æ—¶ï¼Œå¯¹å­è¡¨è¿›è¡Œçš„ç›¸åº”æ“ä½œï¼ŒåŒ…æ‹¬RESTRICTã€CASCADEã€SET NULLå’ŒNO ACTIONã€‚<br>RESTRICTå’ŒNO ACTIONç›¸åŒï¼Œæ˜¯æŒ‡é™åˆ¶åœ¨å­è¡¨æœ‰å…³è”è®°å½•çš„æƒ…å†µä¸‹ï¼Œçˆ¶è¡¨ä¸èƒ½æ›´æ–°ï¼›<br>CASCADEè¡¨ç¤ºçˆ¶è¡¨åœ¨æ›´æ–°æˆ–è€…åˆ é™¤æ—¶ï¼Œæ›´æ–°æˆ–è€…åˆ é™¤å­è¡¨å¯¹åº”çš„è®°å½•ï¼›<br>SET NULLåˆ™è¡¨ç¤ºçˆ¶è¡¨åœ¨æ›´æ–°æˆ–è€…åˆ é™¤çš„æ—¶å€™ï¼Œå­è¡¨å¯¹åº”å­—æ®µè¢«SET NULLã€‚<br>é’ˆå¯¹ä¸Šé¢åˆ›å»ºçš„ä¸¤ä¸ªè¡¨ï¼Œå­è¡¨åœ¨å¤–é”®æŒ‡å®šæ˜¯ON DELETE RESTRICT ON UPDATE CASCADEæ–¹å¼çš„ï¼Œé‚£ä¹ˆåœ¨ä¸»è¡¨åˆ é™¤è®°å½•çš„æ—¶å€™ï¼Œå¦‚æœå­è¡¨æœ‰å¯¹åº”è®°å½•ï¼Œåˆ™ä¸å…è®¸åˆ é™¤ã€‚ä¸»è¡¨åœ¨æ›´æ–°è®°å½•çš„æ—¶å€™ï¼Œå¦‚æœå­è¡¨æœ‰å¯¹åº”è®°å½•ï¼Œåˆ™å­è¡¨ä¹Ÿä¼šå¯¹åº”æ›´æ–°ï¼›  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> country_innodb;<span class="comment">#ä¸»è¡¨</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> city_innodb;<span class="comment">#å­è¡¨ï¼›å­è¡¨å½“ä¸­çš„å¤–é”®country_idæŒ‡å‘ä¸»è¡¨country_innodbå½“ä¸­çš„ä¸»é”®country_id</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> country_innodb <span class="keyword">where</span> country_id=<span class="number">2</span>;</span><br><span class="line"><span class="comment">#æ­¤å¤„ç”±äºå¤–é”®å…³è”ï¼Œæ‰€ä»¥å¯¼è‡´åˆ é™¤æŠ¥é”™ï¼Œæ— æ³•æ›´æ–°ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> country_innodb <span class="keyword">set</span> country_id=<span class="number">100</span> <span class="keyword">where</span> country_id=<span class="number">1</span>;</span><br><span class="line"><span class="comment">#æ­¤æ—¶å­è¡¨å½“ä¸­å…³è”æœ‰1ï¼›é‚£ä¹ˆè¯´åˆ™åˆšæ‰çš„å­è¡¨å½“ä¸­å¯¹åº”country_idä¹Ÿä¸º1 çš„è®°å½•å°†ä¼šè¿›è¡Œç›¸åº”çš„æ›´æ–°ï¼›  </span></span><br><span class="line">æŸ¥çœ‹ä¸»è¡¨ä»¥åŠå­è¡¨ï¼š  </span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> country_innodb;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> city_innodb;</span><br></pre></td></tr></table></figure><p><strong>å­˜å‚¨æ–¹å¼</strong></p><p>å­˜å‚¨æ–¹å¼å®é™…ä¸ŠæŒ‡çš„æ˜¯InnoDBè¿™ä¸ªå­˜å‚¨å¼•æ“å¯¹åº”çš„è¡¨åœ¨æ•°æ®åº“å½“ä¸­ä»¥æ•°æ®æ–‡ä»¶çš„å­˜å‚¨æ–¹å¼ï¼›<br>InnoDBå­˜å‚¨è¡¨å’Œç´¢å¼•æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š  </p><ol><li>ä½¿ç”¨å…±äº«è¡¨ç©ºé—´å­˜å‚¨ï¼Œè¿™ç§æ–¹å¼åˆ›å»ºçš„è¡¨çš„è¡¨ç»“æ„ä¿å­˜åœ¨.frmæ–‡ä»¶ä¸­ï¼Œæ•°æ®å’Œç´¢å¼•ä¿å­˜åœ¨ innodb_data_home_dirå’Œinnodb_data_file_pathå®šä¹‰çš„è¡¨ç©ºé—´ä¸­ï¼Œå¯ä»¥æ˜¯å¤šä¸ªæ–‡ä»¶ï¼›  </li><li>ä½¿ç”¨å¤šè¡¨ç©ºé—´å­˜å‚¨ï¼Œè¿™ç§æ–¹å¼å­˜å‚¨çš„è¡¨çš„è¡¨ç»“æ„ä»ç„¶å­˜åœ¨.frmæ–‡ä»¶ä¸­ï¼Œä½†æ˜¯æ¯ä¸ªè¡¨çš„æ•°æ®å’Œç´¢å¼•å•ç‹¬ä¿å­˜åœ¨.ibdä¸­ï¼›</li></ol><h2 id="å­˜å‚¨å¼•æ“-MyISAMç‰¹æ€§"><a href="#å­˜å‚¨å¼•æ“-MyISAMç‰¹æ€§" class="headerlink" title="å­˜å‚¨å¼•æ“ - MyISAMç‰¹æ€§"></a>å­˜å‚¨å¼•æ“ - MyISAMç‰¹æ€§</h2><p>MyISAMä¸æ”¯æŒäº‹åŠ¡ï¼Œä¹Ÿä¸æ”¯æŒå¤–é”®ï¼Œå…¶ä¼˜åŠ¿æ˜¯è®¿é—®çš„é€Ÿåº¦å¿«ï¼Œå¯¹äº‹åŠ¡çš„å®Œæ•´æ€§æ²¡æœ‰è¦æ±‚æˆ–è€…ä»¥SELECTã€INSERTä¸ºä¸»çš„åº”ç”¨åŸºæœ¬ä¸Šéƒ½å¯ä»¥ä½¿ç”¨è¿™ä¸ªå¼•æ“æ¥åˆ›å»ºè¡¨ï¼Œæœ‰ä»¥ä¸‹ä¸¤ä¸ªæ¯”è¾ƒé‡è¦çš„ç‰¹ç‚¹ï¼š  </p><p><strong>ä¸æ”¯æŒäº‹åŠ¡</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> goods_myisam(</span><br><span class="line">  <span class="keyword">id</span> <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span> auto_increment,</span><br><span class="line">  <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">  primary <span class="keyword">key</span>(<span class="keyword">id</span>)</span><br><span class="line">)<span class="keyword">engine</span>=myisam <span class="keyword">default</span> <span class="keyword">charset</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">start</span> <span class="keyword">transaction</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> goods_myisam <span class="keyword">values</span>(<span class="literal">null</span>,<span class="string">'ç”µè„‘3'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">rollback</span>;</span><br></pre></td></tr></table></figure><p>é€šè¿‡æµ‹è¯•å¯ä»¥å‘ç°ï¼Œåœ¨MyISAMå­˜å‚¨å¼•æ“ä¸­ï¼Œæ˜¯æ²¡æœ‰äº‹åŠ¡æ§åˆ¶çš„ï¼›  </p><p><strong>æ–‡ä»¶å­˜å‚¨æ–¹å¼</strong></p><p>æ¯ä¸ªMyISAMåœ¨ç£ç›˜ä¸Šå­˜å‚¨æˆ3ä¸ªæ–‡ä»¶ï¼Œå…¶æ–‡ä»¶åéƒ½å’Œè¡¨æ˜ç›¸åŒï¼Œä½†æ‹“å±•åç§°åˆ†åˆ«æ˜¯ï¼š</p><ul><li><strong>.frm</strong> (<strong>å­˜å‚¨è¡¨å®šä¹‰</strong>)</li><li><strong>.MYD</strong> (MYDataï¼Œ<strong>å­˜å‚¨æ•°æ®</strong>)</li><li><strong>.MYI</strong> (MYIndexï¼Œ<strong>å­˜å‚¨ç´¢å¼•</strong>)</li></ul><h2 id="å­˜å‚¨å¼•æ“-Memoryä¸Mergeç‰¹æ€§"><a href="#å­˜å‚¨å¼•æ“-Memoryä¸Mergeç‰¹æ€§" class="headerlink" title="å­˜å‚¨å¼•æ“ - Memoryä¸Mergeç‰¹æ€§"></a>å­˜å‚¨å¼•æ“ - Memoryä¸Mergeç‰¹æ€§</h2><p>Memoryï¼ˆå†…å­˜ï¼‰å­˜å‚¨å¼•æ“å°†è¡¨çš„æ•°æ®æ”¾åœ¨å†…å­˜ä¸­ã€‚<br>æ¯ä¸ªMEMORYè¡¨å®é™…å¯¹åº”ä¸€ä¸ªç£ç›˜æ–‡ä»¶ï¼Œæ ¼å¼æ˜¯.frmï¼Œæ”¹æ–‡ä»¶ä¸­åªå­˜å‚¨è¡¨çš„æ•°æ®ç»“æ„ï¼Œè€Œå…¶æ•°æ®æ–‡ä»¶ï¼Œéƒ½æ˜¯å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œè¿™æ ·æœ‰åˆ©äºæ•°æ®çš„å¿«é€Ÿå¤„ç†ï¼Œæé«˜æ•´ä¸ªè¡¨è¾¾æ•ˆç‡ã€‚<br>MEMORYç±»å‹çš„è¡¨è®¿é—®éå¸¸çš„å¿«ï¼Œå› ä¸ºä»–çš„æ•°æ®æ˜¯å­˜æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œå¹¶ä¸”é»˜è®¤ä½¿ç”¨HASHç´¢å¼•ï¼Œä½†æ˜¯æœåŠ¡ä¸€æ—¦å…³é—­ï¼Œè¡¨ä¸­çš„æ•°æ®å°±ä¼šä¸¢å¤±ï¼›  </p><p>MERGEï¼ˆåˆå¹¶ï¼‰å­˜å‚¨å¼•æ“æ˜¯ä¸€ç»„MyISAMè¡¨çš„ç»„åˆï¼Œè¿™äº›MyISAMè¡¨å¿…é¡»ç»“æ„å®Œå…¨ç›¸åŒï¼ŒMERGEè¡¨æœ¬èº«å¹¶æ²¡æœ‰å­˜å‚¨æ•°æ®ï¼Œå¯¹MERGEç±»å‹çš„è¡¨å¯ä»¥è¿›è¡ŒæŸ¥è¯¢ã€æ›´æ–°ã€åˆ é™¤æ“ä½œï¼Œè¿™äº›æ“ä½œå®é™…ä¸Šæ˜¯å¯¹å†…éƒ¨çš„MyISAMè¡¨è¿›è¡Œçš„ï¼›  </p><p>å¯¹äºMERGEç±»å‹è¡¨çš„æ’å…¥æ“ä½œæ˜¯é€šè¿‡INSERT_METHODå­å¥å®šä¹‰æ’å…¥çš„è¡¨ï¼Œå¯ä»¥æœ‰ä¸‰ä¸ªä¸åŒçš„å€¼ï¼Œä½¿ç”¨FIRSTæˆ–è€…LASTå€¼ä½¿å¾—æ’å…¥æ“ä½œè¢«ç›¸åº”çš„ä½œç”¨åœ¨ç¬¬ä¸€æˆ–è€…æ˜¯æœ€åä¸€ä¸ªè¡¨ä¸Šï¼Œä¸å®šä¹‰è¿™ä¸ªå­å¥æˆ–è€…å®šä¹‰ä¸ºNOï¼Œè¡¨ç¤ºä¸èƒ½å¯¹è¿™ä¸ªMERGEè¡¨æ‰§è¡Œæ’å…¥æ“ä½œï¼›  </p><p>å¯ä»¥å¯¹MERGEè¡¨è¿›è¡ŒDROPæ“ä½œï¼Œä½†æ˜¯è¿™ä¸ªæ“ä½œçŸ¥è¯†åˆ é™¤MERGEè¡¨çš„å®šä¹‰ï¼Œå¯¹å†…éƒ¨çš„è¡¨æ˜¯æ²¡æœ‰ä»»ä½•å½±å“çš„ï¼›  </p><p>MERGEå­˜å‚¨å¼•æ“ä¸viewè§†å›¾æœ‰äº›ç±»ä¼¼ï¼›  </p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªåˆ›å»ºå’Œä½¿ç”¨MERGEè¡¨çš„ç¤ºä¾‹ï¼š<br>1ï¼‰åˆ›å»ºä¸‰ä¸ªæµ‹è¯•è¡¨ payment_2006ã€payment_2007ã€payment_allï¼Œå…¶ä¸­payment_allæ˜¯å‰ä¸¤ä¸ªè¡¨çš„MERGEè¡¨ï¼›</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">create table order_1990(</span><br><span class="line">  order_id int,</span><br><span class="line">  order_money double(10,2),</span><br><span class="line">  order_address varchar(50),</span><br><span class="line">  primary key (order_id)</span><br><span class="line">)<span class="attribute">engine</span>=myisam<span class="built_in"> default </span><span class="attribute">charset</span>=utf8;</span><br><span class="line"></span><br><span class="line">create table order_1991(</span><br><span class="line">  order_id int,</span><br><span class="line">  order_money double(10,2),</span><br><span class="line">  order_address varchar(50),</span><br><span class="line">  primary key (order_id)</span><br><span class="line">)<span class="attribute">engine</span>=myisam<span class="built_in"> default </span><span class="attribute">charset</span>=utf8;</span><br><span class="line"></span><br><span class="line">create table order_all(</span><br><span class="line">  order_id int,</span><br><span class="line">  order_money double(10,2),</span><br><span class="line">  order_address varchar(50),</span><br><span class="line">  primary key (order_id)</span><br><span class="line">)<span class="attribute">engine</span>=merge  </span><br><span class="line">union = ( order_1990, order_1991 )  </span><br><span class="line"><span class="attribute">INSERT_METHOD</span>=LAST  </span><br><span class="line">default <span class="attribute">charset</span>=utf8;</span><br></pre></td></tr></table></figure><p>2ï¼‰ åˆ†åˆ«å‘ä¸¤å¼ è¡¨ä¸­æ’å…¥è®°å½•  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> order_1990 <span class="keyword">values</span>(<span class="number">1</span>,<span class="number">100.0</span>,<span class="string">'ä¸Šæµ·'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> order_1990 <span class="keyword">values</span>(<span class="number">2</span>,<span class="number">100.0</span>,<span class="string">'åŒ—äº¬'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> order_1991 <span class="keyword">values</span>(<span class="number">10</span>,<span class="number">100.0</span>,<span class="string">'åŒ—äº¬'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> order_1991 <span class="keyword">values</span>(<span class="number">11</span>,<span class="number">100.0</span>,<span class="string">'ä¸Šæµ·'</span>);</span><br></pre></td></tr></table></figure><p>3ï¼‰ æŸ¥è¯¢ä¸‰å¼ è¡¨å½“ä¸­çš„æ•°æ®ï¼š<br>order_1990è¡¨ä¸­çš„æ•°æ®ï¼š  </p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> order_1990;</span><br></pre></td></tr></table></figure><p>order_1991è¡¨ä¸­çš„æ•°æ®ï¼š  </p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> order_1991;</span><br></pre></td></tr></table></figure><p>order_allè¡¨ä¸­çš„æ•°æ®ï¼š  </p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> order_all;</span><br></pre></td></tr></table></figure><h2 id="å­˜å‚¨å¼•æ“-é€‰æ‹©åŸåˆ™"><a href="#å­˜å‚¨å¼•æ“-é€‰æ‹©åŸåˆ™" class="headerlink" title="å­˜å‚¨å¼•æ“ - é€‰æ‹©åŸåˆ™"></a>å­˜å‚¨å¼•æ“ - é€‰æ‹©åŸåˆ™</h2><p>åœ¨é€‰æ‹©å­˜å‚¨å¼•æ“æ—¶ï¼Œåº”è¯¥é€‰æ‹©æ ¹æ®åº”ç”¨ç³»ç»Ÿçš„ç‰¹ç‚¹é€‰æ‹©åˆé€‚çš„å­˜å‚¨å¼•æ“ã€‚<br>å¯¹äºå¤æ‚çš„åº”ç”¨ç³»ç»Ÿï¼Œè¿˜å¯ä»¥æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©å¤šç§å­˜å‚¨å¼•æ“è¿›è¡Œç»„åˆï¼›<br>ä»¥ä¸‹æ˜¯å‡ ç§å¸¸ç”¨çš„å­˜å‚¨å¼•æ“çš„ä½¿ç”¨ç¯å¢ƒï¼š  </p><ul><li>InnoDB<ul><li>æ˜¯MySQLçš„é»˜è®¤å­˜å‚¨å¼•æ“ï¼Œç”¨äºäº‹åŠ¡å¤„ç†åº”ç”¨ç¨‹åºï¼Œæ”¯æŒå¤–é”®ã€‚</li><li>å¦‚æœåº”ç”¨å¯¹äº‹åŠ¡çš„å®Œæ•´æ€§æœ‰æ¯”è¾ƒé«˜çš„è¦æ±‚ï¼Œåœ¨å¹¶å‘æ¡ä»¶ä¸‹è¦æ±‚æ•°æ®çš„ä¸€è‡´æ€§ï¼Œæ•°æ®æ“ä½œé™¤äº†æ’å…¥å’ŒæŸ¥è¯¢ä»¥å¤–ï¼Œè¿˜åŒ…å«å¾ˆå¤šçš„æ›´æ–°ã€åˆ é™¤æ“ä½œï¼Œé‚£ä¹ˆInnoDBå­˜å‚¨å¼•æ“æ˜¯æ¯”è¾ƒåˆé€‚çš„é€‰æ‹©ã€‚  </li><li>InnoDBå­˜å‚¨å¼•æ“é™¤äº†æœ‰æ•ˆçš„é™ä½ç”±äºåˆ é™¤å’Œæ›´æ–°å¯¼è‡´çš„é”å®šï¼Œè¿˜å¯ä»¥ç¡®ä¿äº‹åŠ¡çš„å®Œæ•´æäº¤å’Œå›æ»šï¼Œå¯¹äºç±»ä¼¼äºè®¡è´¹ç³»ç»Ÿæˆ–è€…æ˜¯è´¢åŠ¡ç³»ç»Ÿç­‰å¯¹æ•°æ®å‡†ç¡®æ€§è¦æ±‚æ¯”è¾ƒé«˜çš„ç³»ç»Ÿï¼ŒInnoDBæ˜¯æœ€åˆé€‚çš„é€‰æ‹©ï¼›  </li></ul></li><li>MyISAM<ul><li>å¦‚æœåº”ç”¨æ˜¯ä»¥è¯»æ“ä½œå’Œæ’å…¥æ“ä½œä¸ºä¸»ï¼Œåªæœ‰å¾ˆå°‘çš„æ›´æ–°å’Œåˆ é™¤æ“ä½œï¼Œå¹¶ä¸”å¯¹äº‹åŠ¡çš„å®Œæ•´æ€§ã€å¹¶å‘æ€§è¦æ±‚ä¸æ˜¯å¾ˆé«˜ï¼Œé‚£ä¹ˆé€‰æ‹©è¿™ä¸ªå­˜å‚¨å¼•æ“æ˜¯éå¸¸åˆé€‚çš„ï¼›  </li></ul></li><li>MEMORY<ul><li>å°†æ‰€æœ‰çš„æ•°æ®ä¿å­˜åœ¨å†…å­˜å½“ä¸­RAMï¼Œåœ¨éœ€è¦å¿«é€Ÿå®šä½è®°å½•å’Œå…¶ä»–ç±»ä¼¼æ•°æ®ç¯å¢ƒä¸‹ï¼Œå¯ä»¥æä¾›å‡ å—çš„è®¿é—®ã€‚</li><li>MEMORYçš„ç¼ºé™·å°±æ˜¯å¯¹è¡¨çš„å¤§å°æœ‰é™åˆ¶ï¼Œå¤ªå¤§çš„è¡¨æ— æ³•ç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œå…¶æ¬¡æ˜¯è¦ç¡®ä¿è¡¨çš„æ•°æ®å¯ä»¥æ¢å¤ï¼Œæ•°æ®åº“å¼‚å¸¸ç»ˆæ­¢åè¡¨ä¸­çš„æ•°æ®æ˜¯å¯ä»¥æ¢å¤çš„ã€‚  </li><li>MEMORYè¡¨é€šå¸¸ç”¨äºæ›´æ–°ä¸å¤ªé¢‘ç¹çš„å°è¡¨ï¼Œç”¨ä»¥å¿«é€Ÿå¾—åˆ°è®¿é—®ç»“æœã€‚  </li></ul></li><li>MERGE<ul><li>ç”¨äºå°†ä¸€äº›åˆ—ç­‰åŒçš„MyISAMè¡¨ä»¥é€»è¾‘æ–¹å¼ç»„åˆåœ¨ä¸€èµ·ï¼Œå¹¶ä½œä¸ºä¸€ä¸ªå¯¹è±¡å¼•ç”¨ä»–ä»¬ã€‚</li><li>MERGEè¡¨çš„ä¼˜ç‚¹åœ¨äºå¯ä»¥çªç ´å¯¹å•ä¸ªMyISAMè¡¨çš„å¤§å°é™åˆ¶ï¼Œå¹¶ä¸”é€šè¿‡å°†ä¸åŒçš„è¡¨åˆ†å¸ƒåœ¨å¤šä¸ªç£ç›˜ä¸Šï¼Œå¯ä»¥æœ‰æ•ˆçš„æ”¹å–„MERGEè¡¨çš„è®¿é—®æ•ˆç‡ï¼Œè¿™å¯¹äºå­˜å‚¨è¯¸å¦‚æ•°æ®ä»“åº“ç­‰VLDBç¯å¢ƒååˆ†åˆé€‚ã€‚  </li></ul></li></ul><p>æœ‰ä¸€ä¸ªç‚¹ï¼šå°±æ˜¯æœ‰æ²¡æœ‰ç±»ä¼¼emmï¼ŒMERGEç„¶åå†…éƒ¨åŸºå±‚çš„è¡¨çš„å­˜å‚¨å¼•æ“æ˜¯InnoDBè¿™ç§çš„ï¼›å¦‚æœæ˜¯è¿™ç§çš„è¯ï¼›ä¸æ˜¯æœ‰é‚£ä¸ªä»€ä¹ˆåˆ†åº“åˆ†è¡¨ä»€ä¹ˆçš„ï¼Ÿï¼ˆæˆ‘ä¸å¤ªäº†è§£åˆ†åº“åˆ†è¡¨ï¼Œä¹±è¯´çš„ï¼‰  </p><h2 id="ä¼˜åŒ–SQLæ­¥éª¤-SQLæ‰§è¡Œé¢‘ç‡"><a href="#ä¼˜åŒ–SQLæ­¥éª¤-SQLæ‰§è¡Œé¢‘ç‡" class="headerlink" title="ä¼˜åŒ–SQLæ­¥éª¤ - SQLæ‰§è¡Œé¢‘ç‡"></a>ä¼˜åŒ–SQLæ­¥éª¤ - SQLæ‰§è¡Œé¢‘ç‡</h2><p>åœ¨åº”ç”¨çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œç”±äºåˆæœŸæ•°æ®é‡å°ï¼Œå¼€å‘äººå‘˜å†™SQLè¯­å¥æ—¶æ›´é‡è§†åŠŸèƒ½ä¸Šçš„å®ç°ï¼Œä½†æ˜¯å½“åº”ç”¨ç³»ç»Ÿæ­£å¼ä¸Šçº¿åï¼Œéšç€ç”Ÿäº§æ•°æ®çš„æ€¥å‰§å¢é•¿ï¼Œå¾ˆå¤šSQLè¯­å¥å¼€å§‹é€æ¸æ˜¾éœ²å‡ºæ€§èƒ½é—®é¢˜ï¼Œå¯¹ç”Ÿäº§çš„å½±å“ä¹Ÿè¶Šæ¥è¶Šå¤§ï¼Œæ­¤æ—¶è¿™äº›æœ‰é—®é¢˜çš„SQLè¯­å¥å°±æˆä¸ºæ•´ä¸ªç³»ç»Ÿæ€§èƒ½çš„ç“¶é¢ˆï¼Œå› æ­¤å¿…é¡»è¦å¯¹å®ƒä»¬è¿›è¡Œä¼˜åŒ–ï¼Œæœ¬ç« å°†è¯¦ç»†ä»‹ç»MySQLä¸­ä¼˜åŒ–SQLè¯­å¥çš„æ–¹æ³•ã€‚  </p><p>å½“é¢å¯¹ä¸€ä¸ªæœ‰SQLæ€§èƒ½é—®é¢˜çš„æ•°æ®åº“æ—¶ï¼Œåº”è¯¥ä»ä½•å¤„å…¥æ‰‹æ¥è¿›è¡Œç³»ç»Ÿçš„åˆ†æï¼Œä½¿å¾—èƒ½å¤Ÿå°½å¿«å®šä½é—®é¢˜SQLå¹¶å°½å¿«è§£å†³é—®é¢˜ã€‚  </p><h3 id="æŸ¥çœ‹SQLæ‰§è¡Œé¢‘ç‡"><a href="#æŸ¥çœ‹SQLæ‰§è¡Œé¢‘ç‡" class="headerlink" title="æŸ¥çœ‹SQLæ‰§è¡Œé¢‘ç‡"></a>æŸ¥çœ‹SQLæ‰§è¡Œé¢‘ç‡</h3><p>MySQLå®¢æˆ·ç«¯è¿æ¥æˆåŠŸåï¼Œé€šè¿‡ <strong>show [ session | global ] status</strong> å‘½ä»¤å¯ä»¥æä¾›<strong>æœåŠ¡å™¨çŠ¶æ€ä¿¡æ¯</strong>ã€‚<br><strong>show [ session | global ] status</strong> å¯ä»¥æ ¹æ®éœ€è¦åŠ ä¸Šå‚æ•° <strong>â€œsessionâ€</strong> æˆ–è€… <strong>â€œglobalâ€</strong> æ¥æ˜¾ç¤º <strong>sessionçº§</strong>ï¼ˆå½“å‰è¿æ¥ï¼‰çš„ç»Ÿè®¡ç»“æœå’Œ <strong>globalçº§</strong>ï¼ˆè‡ªæ•°æ®åº“ä¸Šæ¬¡å¯åŠ¨è‡³ä»Šï¼‰çš„ç»Ÿè®¡ç»“æœã€‚<br>å¦‚æœä¸å†™ï¼Œ<strong>é»˜è®¤ä½¿ç”¨å‚æ•°æ˜¯â€œsessionâ€</strong>ã€‚  </p><p>ä¸‹é¢çš„å‘½ä»¤æ˜¾ç¤ºäº†å½“å‰sessionä¸­æ‰€æœ‰ç»Ÿè®¡å‚æ•°çš„å€¼ï¼š</p><blockquote><p>é’ˆå¯¹<strong>æ•°æ®åº“</strong></p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">status</span> <span class="keyword">like</span> <span class="string">'Com_______'</span>; <span class="comment"># _ å ä½å­—ç¬¦ï¼ŒåŒ¹é…çš„æ¨¡ç³Šå­—ç¬¦ æŸ¥è¯¢çº§åˆ«ä¸ºsessionä¼šè¯çº§åˆ«</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">global</span> <span class="keyword">status</span> <span class="keyword">like</span> <span class="string">'Com_______'</span>; <span class="comment"># _ åŒ¹é…çš„æ¨¡ç³Šå­—ç¬¦ æŸ¥è¯¢çº§åˆ«ä¸ºglobalå…¨å±€çº§åˆ«</span></span><br><span class="line"></span><br><span class="line">Com_binlog</span><br><span class="line">Com_commit</span><br><span class="line">Com_delete <span class="comment">#åˆ é™¤çš„æ¬¡æ•°</span></span><br><span class="line">Com_insert <span class="comment">#æ’å…¥çš„æ¬¡æ•°</span></span><br><span class="line">Com_repair</span><br><span class="line">Com_select <span class="comment">#æŸ¥è¯¢çš„æ¬¡æ•°</span></span><br><span class="line">Com_revoke</span><br><span class="line">Com_signal</span><br><span class="line">Com_update <span class="comment">#ä¿®æ”¹çš„æ¬¡æ•°</span></span><br><span class="line">Com_xa_end</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ­¤æ—¶æŸ¥è¯¢çš„ä¸ºå½“å‰è¿æ¥sessionçš„ä¿¡æ¯ï¼Œå¹¶éä¸ºæ•´ä¸ªæ•°æ®åº“å…¨å±€çš„ç»Ÿè®¡å‚æ•°</span></span><br><span class="line"><span class="comment">#å¦‚æœéœ€è¦æŸ¥è¯¢å…¨å±€åˆ™ï¼šshow global status like 'Com_______';</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#é€šè¿‡çŸ¥é“å½“å‰æ•°æ®åº“å½“ä¸­æ˜¯ä»¥æŸ¥è¯¢ä¸ºä¸»è¿˜æ˜¯å¢åˆ æ”¹ä¸ºä¸»ï¼›ä¸ºSQLä¼˜åŒ–æä¾›å€Ÿé‰´æ€§æŒ‡æ ‡</span></span><br></pre></td></tr></table></figure><p>Com_xxxè¡¨ç¤ºæ¯ä¸ªxxxè¯­å¥<strong>æ‰§è¡Œçš„æ¬¡æ•°</strong>ï¼Œé€šå¸¸æ¯”è¾ƒå…³å¿ƒçš„æ˜¯ä»¥ä¸‹å‡ ä¸ªç»Ÿè®¡å‚æ•°</p><table>  <tr>    <th>å‚æ•°</th>    <th>å«ä¹‰</th>  </tr>  <tr>    <td>Com_select</td>    <td>æ‰§è¡Œselectæ“ä½œçš„æ¬¡æ•°ï¼Œä¸€æ¬¡æŸ¥è¯¢åªç´¯åŠ 1</td>  </tr>  <tr>    <td>Com_insert</td>    <td>æ‰§è¡ŒINSERTæ“ä½œçš„æ¬¡æ•°ï¼Œå¯¹äºæ‰¹é‡æ’å…¥çš„INSERTæ“ä½œï¼Œåªç´¯åŠ ä¸€æ¬¡</td>  </tr>  <tr>    <td>Com_update</td>    <td>æ‰§è¡ŒUPDATEæ“ä½œçš„æ¬¡æ•°</td>  </tr>  <tr>    <td>Com_delete</td>    <td>æ‰§è¡ŒDELETEæ“ä½œçš„æ¬¡æ•°</td>  </tr>  <tr>    <td>Innodb_rows_read</td>    <td>selectæŸ¥è¯¢è¿”å›çš„è¡Œæ•°</td>  </tr>  <tr>    <td>Innodb_rows_inserted</td>    <td>æ‰§è¡ŒINSERTæ“ä½œæ’å…¥çš„è¡Œæ•°</td>  </tr>  <tr>    <td>Innodb_rows_updated</td>    <td>æ‰§è¡ŒUPDATEæ“ä½œæ›´æ–°çš„è¡Œæ•°</td>  </tr>  <tr>    <td>Innodb_rows_deleted</td>    <td>æ‰§è¡ŒDELETEæ“ä½œåˆ é™¤çš„è¡Œæ•°</td>  </tr>  <tr>    <td>Connections</td>    <td>è§†å›¾è¿æ¥MySQLæœåŠ¡å™¨çš„æ¬¡æ•°</td>  </tr>  <tr>    <td>Uptime</td>    <td>æœåŠ¡å™¨å·¥ä½œæ—¶é—´</td>  </tr>  <tr>    <td>Slow_queries</td>    <td>æ…¢æŸ¥è¯¢çš„æ¬¡æ•°</td>  </tr></table><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Com_*** : è¿™äº›å‚æ•°å¯¹äºæ‰€æœ‰å­˜å‚¨å¼•æ“çš„è¡¨æ“ä½œéƒ½ä¼šè¿›è¡Œç´¯è®¡</span><br><span class="line">Innodb_** : è¿™å‡ ä¸ªå‚æ•°åªæ˜¯é’ˆå¯¹<span class="type">Innodb</span>å­˜å‚¨å¼•æ“çš„ï¼Œç´¯åŠ çš„ç®—æ³•ä¹Ÿç•¥æœ‰ä¸åŒã€‚</span><br></pre></td></tr></table></figure><blockquote><p>é’ˆå¯¹<strong>InnoDBå­˜å‚¨å¼•æ“</strong></p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">é’ˆå¯¹äºInnoDBï¼š  </span><br><span class="line"><span class="keyword">show</span> <span class="keyword">status</span> <span class="keyword">like</span> <span class="string">'Innodb_rows_%'</span>;<span class="comment"># æ­¤æ—¶æŸ¥è¯¢å‡ºæ¥çš„ä¸ºInnoDBçš„å„ä¸ªæ“ä½œæ‰€å½±å“çš„è¡Œï¼Œæ•°é‡</span></span><br><span class="line"></span><br><span class="line">Innodb_rows_deleted 2 <span class="comment"># è¯¥å­˜å‚¨å¼•æ“ä¸­åˆ å»çš„è¡Œæ•°</span></span><br><span class="line">Innodb_rows_inserted 49<span class="comment"># è¯¥å­˜å‚¨å¼•æ“ä¸­æ’å…¥çš„è¡Œæ•°</span></span><br><span class="line">Innodb_rows_read 380<span class="comment"># è¯¥å­˜å‚¨å¼•æ“ä¸­è¯»å–çš„è¡Œæ•°</span></span><br><span class="line">Innodb_rows_updated 15<span class="comment"># æ›´æ–°çš„è¡Œæ•°</span></span><br><span class="line"></span><br><span class="line">mysql -u root -p</span><br><span class="line"><span class="keyword">use</span> demo_01l</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> goods_innodb; <span class="comment"># Innodb_rows_readæ­¤æ—¶ä¼šå¢åŠ ï¼ŒæŸ¥è¯¢å‡ºæ¥çš„ç»“æœé›†æœ‰næ¡è®°å½•ï¼Œåˆ™Innodb_rows_readå¢åŠ n</span></span><br><span class="line"></span><br><span class="line">Innodb_rows_deleted 2 <span class="comment"># è¯¥å­˜å‚¨å¼•æ“ä¸­åˆ å»çš„è¡Œæ•°</span></span><br><span class="line">Innodb_rows_inserted 49<span class="comment"># è¯¥å­˜å‚¨å¼•æ“ä¸­æ’å…¥çš„è¡Œæ•°</span></span><br><span class="line">Innodb_rows_read 382<span class="comment"># è¯¥å­˜å‚¨å¼•æ“ä¸­è¯»å–çš„è¡Œæ•°</span></span><br><span class="line">Innodb_rows_updated 15<span class="comment"># æ›´æ–°çš„è¡Œæ•°</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> goods_innodb <span class="keyword">set</span> <span class="keyword">name</span> =<span class="string">'Meta30'</span>; <span class="comment"># Innodb_rows_updateæ­¤æ—¶ä¼šå¢åŠ ï¼›ä¿®æ”¹å½±å“næ¡è®°å½•ï¼Œåˆ™Innodb_rows_updateå¢åŠ n;</span></span><br><span class="line"></span><br><span class="line">Innodb_rows_deleted 2 <span class="comment"># è¯¥å­˜å‚¨å¼•æ“ä¸­åˆ å»çš„è¡Œæ•°</span></span><br><span class="line">Innodb_rows_inserted 49<span class="comment"># è¯¥å­˜å‚¨å¼•æ“ä¸­æ’å…¥çš„è¡Œæ•°</span></span><br><span class="line">Innodb_rows_read 382<span class="comment"># è¯¥å­˜å‚¨å¼•æ“ä¸­è¯»å–çš„è¡Œæ•°</span></span><br><span class="line">Innodb_rows_updated 17<span class="comment"># æ›´æ–°çš„è¡Œæ•°</span></span><br></pre></td></tr></table></figure><h2 id="ä¼˜åŒ–SQLæ­¥éª¤-å®šä½ä½æ•ˆSQL"><a href="#ä¼˜åŒ–SQLæ­¥éª¤-å®šä½ä½æ•ˆSQL" class="headerlink" title="ä¼˜åŒ–SQLæ­¥éª¤ - å®šä½ä½æ•ˆSQL"></a>ä¼˜åŒ–SQLæ­¥éª¤ - å®šä½ä½æ•ˆSQL</h2><p>å¯ä»¥é€šè¿‡ä»¥ä¸‹<strong>ä¸¤ç§æ–¹å¼</strong>å®šä½æ‰§è¡Œæ•ˆç‡è¾ƒä½çš„SQLè¯­å¥ã€‚  </p><ul><li><strong>æ…¢æŸ¥è¯¢æ—¥å¿—</strong>ï¼šé€šè¿‡æ…¢æŸ¥è¯¢æ—¥å¿—å®šä½é‚£äº›æ‰§è¡Œæ•ˆç‡è¾ƒä½çš„SQLè¯­å¥ï¼Œç”¨ <strong>â€“log-slow-queries[ =file_name ]</strong> é€‰é¡¹å¯åŠ¨æ—¶ï¼Œmysqldå†™ä¸€ä¸ªåŒ…å«æ‰€æœ‰æ‰§è¡Œæ—¶é—´è¶…è¿‡ <strong>long_query_time</strong> ç§’çš„SQLè¯­å¥çš„<strong>æ—¥å¿—æ–‡ä»¶</strong>ã€‚</li><li><strong>show processlist</strong> ï¼š<strong>æ…¢æŸ¥è¯¢æ—¥å¿—</strong>åœ¨ æŸ¥<strong>è¯¢ç»“æŸä»¥åæ‰è®°å½•</strong>ï¼Œæ‰€ä»¥åœ¨åº”è¯¥ ç”¨åæ˜ æ‰§è¡Œæ•ˆç‡å‡ºç°é—®é¢˜çš„æ—¶å€™ æŸ¥è¯¢æ…¢æ—¥å¿— å¹¶ä¸èƒ½å®šä½é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ <strong>show processlist</strong> å‘½ä»¤æŸ¥çœ‹å½“å‰MySQLåœ¨è¿›è¡Œçš„çº¿ç¨‹ï¼ŒåŒ…æ‹¬<strong>çº¿ç¨‹çš„çŠ¶æ€ã€æ˜¯å¦é”è¡¨</strong>ç­‰ï¼Œå¯ä»¥<strong>å®æ—¶åœ°æŸ¥çœ‹SQLçš„æ‰§è¡Œæƒ…å†µ</strong>ï¼ŒåŒæ—¶<strong>å¯¹ä¸€äº› é”è¡¨æ“ä½œ è¿›è¡Œ ä¼˜åŒ–</strong>ã€‚(<strong>å®æ—¶</strong>)  </li></ul><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">show processlist;</span><br><span class="line"></span><br><span class="line"><span class="meta">#ï¼ˆ1ï¼‰idåˆ—ï¼šç”¨æˆ·ç™»å½•mysqlæ—¶ï¼Œç³»ç»Ÿåˆ†é…çš„â€œconnection_idâ€ï¼Œå¯ä»¥ä½¿ç”¨å‡½æ•°connection_id()æŸ¥çœ‹ï¼›</span></span><br><span class="line"><span class="meta">#ï¼ˆ2ï¼‰useråˆ—ï¼šæ˜¾ç¤ºå½“å‰ç”¨æˆ·ï¼Œå¦‚æœä¸æ˜¯rootï¼Œè¿™ä¸ªå‘½ä»¤å°±åªæ˜¾ç¤ºç”¨æˆ·æƒé™èŒƒå›´çš„sqlè¯­å¥ï¼›</span></span><br><span class="line"><span class="meta">#ï¼ˆ3ï¼‰hoståˆ—ï¼šæ˜¾ç¤ºè¿™ä¸ªè¯­å¥æ˜¯ä»å“ªä¸ªipçš„å“ªä¸ªç«¯å£ä¸Šå‘çš„ï¼Œå¯ä»¥ç”¨æ¥è·Ÿè¸ªå‡ºç°é—®é¢˜è¯­å¥çš„ç”¨æˆ·ï¼›</span></span><br><span class="line"><span class="meta">#ï¼ˆ4ï¼‰dbåˆ—ï¼šæ˜¾ç¤ºè¿™ä¸ªè¿›ç¨‹ç›®å‰è¿æ¥çš„æ˜¯å“ªä¸ªæ•°æ®åº“ï¼›</span></span><br><span class="line"><span class="meta">#ï¼ˆ5ï¼‰commandåˆ—ï¼šæ˜¾ç¤ºå½“å‰è¿æ¥çš„æ‰§è¡Œå‘½ä»¤ï¼Œä¸€èˆ¬å–å€¼ä¸ºä¼‘çœ ï¼ˆsleepï¼‰ã€æŸ¥è¯¢ï¼ˆqueryï¼‰ã€è¿æ¥ï¼ˆconnectï¼‰ç­‰ï¼›</span></span><br><span class="line"><span class="meta">#ï¼ˆ6ï¼‰timeåˆ—ï¼Œæ˜¾ç¤ºè¿™ä¸ªçŠ¶æ€æŒç»­çš„æ—¶é—´ï¼Œå•ä½æ˜¯ç§’ï¼›</span></span><br><span class="line"><span class="meta">#ï¼ˆ7ï¼‰stateåˆ—ï¼Œæ˜¾ç¤ºä½¿ç”¨å½“å‰è¿æ¥çš„sqlè¯­å¥çš„çŠ¶æ€ï¼Œå¾ˆé‡è¦çš„åˆ—ã€‚stateæè¿°çš„æ˜¯è¯­å¥æ‰§è¡Œä¸­çš„æŸä¸ªçŠ¶æ€ã€‚ä¸€ä¸ªsqlè¯­å¥ï¼Œä»¥æŸ¥è¯¢ä¸ºä¾‹ï¼Œå¯èƒ½éœ€è¦ç»è¿‡copying to tmp tableï¼Œ sorting resultï¼Œ sending dataç­‰çŠ¶æ€æ‰å¯ä»¥å®Œæˆã€‚  </span></span><br><span class="line"><span class="meta">#ï¼ˆ8ï¼‰infoåˆ—ï¼Œæ˜¾ç¤ºè¿™ä¸ªsqlè¯­å¥ï¼Œæ˜¯åˆ¤æ–­é—®é¢˜è¯­å¥çš„ä¸€ä¸ªé‡è¦ä¾æ®ã€‚</span></span><br></pre></td></tr></table></figure><h2 id="ä¼˜åŒ–SQLæ­¥éª¤-explainæŒ‡ä»¤ä»‹ç»"><a href="#ä¼˜åŒ–SQLæ­¥éª¤-explainæŒ‡ä»¤ä»‹ç»" class="headerlink" title="ä¼˜åŒ–SQLæ­¥éª¤ - explainæŒ‡ä»¤ä»‹ç»"></a>ä¼˜åŒ–SQLæ­¥éª¤ - explainæŒ‡ä»¤ä»‹ç»</h2><p>é€šè¿‡ä»¥ä¸Šæ­¥éª¤æŸ¥è¯¢åˆ°æ•ˆç‡ä½çš„SQLè¯­å¥åï¼Œ<br>å¯ä»¥é€šè¿‡ <strong>EXPLAIN</strong> æˆ–è€… <strong>DESC</strong> <strong>å‘½ä»¤</strong> è·å–MySQLå¦‚ä½•æ‰§è¡ŒSELECTè¯­å¥çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬SELECTè¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸­è¡¨<strong>å¦‚ä½• è¿æ¥ å’Œ è¿æ¥ çš„é¡ºåº</strong>ã€‚  </p><p>æŸ¥è¯¢SQLè¯­å¥çš„æ‰§è¡Œè®¡åˆ’ï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_item <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">1</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_keys</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>tb_item</td>    <td>const</td>    <td>PRIMARY</td>    <td>PRIMARY</td>    <td>4</td>    <td>const</td>    <td>1</td>    <td>NULL</td>  </tr></table><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_item <span class="keyword">where</span> <span class="built_in">title</span>=<span class="string">'é˜¿å°”å¡ç‰¹ï¼ˆOT-979ï¼‰å†°å·ç™½ è”é€š3Gæ‰‹æœº3'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_keys</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>tb_item</td>    <td>ALL</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>9816098</td>    <td>Using where</td>  </tr></table><table>  <tr>    <th>å­—æ®µ</th>    <th>å«ä¹‰</th>  </tr>  <tr>    <td>id</td>    <td>selectæŸ¥è¯¢çš„åºåˆ—å·ï¼Œæ˜¯ä¸€ç»„æ•°å­—ï¼Œè¡¨ç¤ºçš„æ˜¯æŸ¥è¯¢ä¸­selectå­å¥æˆ–è€…æ˜¯æ“ä½œè¡¨çš„é¡ºåºã€‚ï¼ˆä¸è¡¨ç»“æ„æ‰§è¡Œçš„é¡ºåºæœ‰å…³ç³»ï¼‰</td>  </tr>  <tr>    <td>select_type</td>    <td>è¡¨ç¤ºSELECTçš„ç±»å‹ï¼Œå¸¸è§çš„å–å€¼æœ‰SIMPLEï¼ˆç®€å•è¡¨ï¼Œå³ä¸ä½¿ç”¨è¡¨è¿æ¥æˆ–è€…æ˜¯å­æŸ¥è¯¢ï¼‰ã€PRIMARYï¼ˆä¸»æŸ¥è¯¢ï¼Œå³å¤–å±‚çš„æŸ¥è¯¢ï¼‰ã€UNIONï¼ˆUNIONä¸­çš„ç¬¬äºŒä¸ªæˆ–è€…åé¢çš„æŸ¥è¯¢è¯­å¥ï¼‰ã€SUBQUERYï¼ˆå­æŸ¥è¯¢ä¸­çš„ç¬¬ä¸€ä¸ªSELECTï¼‰ç­‰</td>  </tr>  <tr>    <td>table</td>    <td>è¾“å‡ºç»“æœé›†çš„è¡¨ï¼ˆå½“å‰è¾“å‡ºçš„æ•°æ®ä¸å“ªä¸€å¼ è¡¨æœ‰å…³ï¼‰</td>  </tr>  <tr>    <td>type</td>    <td>è¡¨ç¤ºè¡¨çš„è¿æ¥ç±»å‹ï¼Œæ€§èƒ½ç”±å¥½åˆ°å·®çš„è¿æ¥ç±»å‹ä¸ºï¼ˆsystem---->const---->eq_ref------>ref------->ref_or_null------>index_merge------>index_subquery------->range------>index------>allï¼‰</td>  </tr>  <tr>    <td>possible_keys</td>    <td>è¡¨ç¤ºæŸ¥è¯¢æ—¶ï¼Œå¯èƒ½ä½¿ç”¨çš„ç´¢å¼•ã€‚</td>  </tr>  <tr>    <td>key</td>    <td>è¡¨ç¤ºå®é™…ä½¿ç”¨çš„ç´¢å¼•</td>  </tr>  <tr>    <td>key_len</td>    <td>ç´¢å¼•å­—æ®µçš„é•¿åº¦</td>  </tr>  <tr>    <td>ref</td>    <td>å¼•ç”¨</td>  </tr>  <tr>    <td>rows</td>    <td>æ‰«æè¡Œçš„æ•°é‡</td>  </tr>  <tr>    <td>extra</td>    <td>æ‰§è¡Œæƒ…å†µçš„è¯´æ˜å’Œæè¿°ï¼Œé¢å¤–çš„å†…å®¹ï¼Œå‰é¢å‡ ä¸ªå­—æ®µå½“ä¸­æ²¡æœ‰è¡¨è¿°æ¸…æ¥šçš„ï¼Œåœ¨è¿™ä¸ªå­—æ®µå½“ä¸­è¡¨è¿°å‡ºæ¥</td>  </tr></table><blockquote><p><strong>explain</strong> ç”¨æ¥ <strong>æŸ¥çœ‹ SQLè¯­å¥ çš„ æ‰§è¡Œè®¡åˆ’</strong>ã€‚</p></blockquote><h2 id="ä¼˜åŒ–SQLæ­¥éª¤-explainä¹‹id"><a href="#ä¼˜åŒ–SQLæ­¥éª¤-explainä¹‹id" class="headerlink" title="ä¼˜åŒ–SQLæ­¥éª¤ - explainä¹‹id"></a>ä¼˜åŒ–SQLæ­¥éª¤ - explainä¹‹id</h2><p><strong>ç¯å¢ƒå‡†å¤‡</strong></p><p>ç”¨æˆ·è¡¨ã€è§’è‰²è¡¨ã€ç”¨æˆ·è§’è‰²è¡¨ï¼ˆå¤šå¯¹å¤šå…³ç³»ï¼‰  </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE <span class="string">'t_role'</span>(</span><br><span class="line">  <span class="string">'id'</span> varchar(32) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'role_name'</span> varchar(255)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'role_code'</span> varchar(255)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'description'</span> varchar(255)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY KEY (<span class="string">'id'</span>),</span><br><span class="line">  UNIQUE KEY <span class="string">'union_role_name'</span> (<span class="string">'role_name'</span>)</span><br><span class="line">)<span class="attribute">ENGINE</span>=InnoDB<span class="built_in"> DEFAULT </span><span class="attribute">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line">CREATE TABLE <span class="string">'t_user'</span>(</span><br><span class="line">  <span class="string">'id'</span> varchar(32) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'username'</span> varchar(45)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'name'</span> varchar(45)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'password'</span> varchar(96)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY KEY (<span class="string">'id'</span>),</span><br><span class="line">  UNIQUE KEY <span class="string">'union_user_username'</span> (<span class="string">'user_name'</span>)</span><br><span class="line">)<span class="attribute">ENGINE</span>=InnoDB<span class="built_in"> DEFAULT </span><span class="attribute">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CREATE TABLE <span class="string">'user_role'</span>(</span><br><span class="line">  <span class="string">'id'</span> int(11) <span class="keyword">NOT</span> <span class="literal">NULL</span> autoincrement,</span><br><span class="line">  <span class="string">'user_id'</span> varchar(32)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'role_id'</span> varchar(32)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY KEY (<span class="string">'id'</span>),</span><br><span class="line">  KEY <span class="string">'fk_ur_user_id'</span>(<span class="string">'user_id'</span>),</span><br><span class="line">  KEY <span class="string">'fk_ur_role_id'</span>(<span class="string">'role_id'</span>),</span><br><span class="line">  CONSTRAINT <span class="string">'fk_ur_role_id'</span> FOREIGN KEY (<span class="string">'role_id'</span>) REFERENCES <span class="string">'t_role'</span> (<span class="string">'id'</span>) ON DELETE <span class="literal">NO</span> ACTION ON UPDATE <span class="literal">NO</span> ACTION,</span><br><span class="line">  CONSTRAINT <span class="string">'fk_ur_user_id'</span> FOREIGN KEY (<span class="string">'user_id'</span>) REFERENCES <span class="string">'t_user'</span> (<span class="string">'id'</span>) ON DELETE <span class="literal">NO</span> ACTION ON UPDATE <span class="literal">NO</span> ACTION</span><br><span class="line">)<span class="attribute">ENGINE</span>=InnoDB<span class="built_in"> DEFAULT </span><span class="attribute">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ’å…¥ç”¨æˆ¶æ•°æ®</span></span><br><span class="line">insert into <span class="string">'t_user'</span>(<span class="string">'id'</span>,<span class="string">'username'</span>,<span class="string">'password'</span>,<span class="string">'name'</span>) values(<span class="string">'1'</span>,<span class="string">'è€ç‹'</span>,<span class="string">'xxxxxyyyyyyy'</span>,<span class="string">'è¶…çº§ç®¡ç†å‘˜'</span>);</span><br><span class="line">insert into <span class="string">'t_user'</span>(<span class="string">'id'</span>,<span class="string">'username'</span>,<span class="string">'password'</span>,<span class="string">'name'</span>) values(<span class="string">'2'</span>,<span class="string">'è€æ'</span>,<span class="string">'xxxxxyyyyyyyzzzzz'</span>,<span class="string">'ç³»ç»Ÿç®¡ç†å‘˜'</span>);</span><br><span class="line">insert into <span class="string">'t_user'</span>(<span class="string">'id'</span>,<span class="string">'username'</span>,<span class="string">'password'</span>,<span class="string">'name'</span>) values(<span class="string">'3'</span>,<span class="string">'è€å¤´å­'</span>,<span class="string">'xxxxxyyyytyyyzzzzz'</span>,<span class="string">'å­¦ç”Ÿ1'</span>);</span><br><span class="line">insert into <span class="string">'t_user'</span>(<span class="string">'id'</span>,<span class="string">'username'</span>,<span class="string">'password'</span>,<span class="string">'name'</span>) values(<span class="string">'4'</span>,<span class="string">'è€å©†å­'</span>,<span class="string">'xxxxxyywyyyyyzzzzz'</span>,<span class="string">'å­¦ç”Ÿ2'</span>);</span><br><span class="line">insert into <span class="string">'t_user'</span>(<span class="string">'id'</span>,<span class="string">'username'</span>,<span class="string">'password'</span>,<span class="string">'name'</span>) values(<span class="string">'5'</span>,<span class="string">'super'</span>,<span class="string">'xxxxxyyfyyyyyzzzzz'</span>,<span class="string">'å­¦ç”Ÿ3'</span>);</span><br><span class="line">insert into <span class="string">'t_user'</span>(<span class="string">'id'</span>,<span class="string">'username'</span>,<span class="string">'password'</span>,<span class="string">'name'</span>) values(<span class="string">'6'</span>,<span class="string">'admin'</span>,<span class="string">'xxxxxyyyyyyyzzzzze'</span>,<span class="string">'å­¦ç”Ÿ4'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ’å…¥è§’è‰²æ•°æ®</span></span><br><span class="line"><span class="built_in">..</span><span class="built_in">..</span></span><br><span class="line"><span class="comment"># æ’å…¥ç”¨æˆ·è§’è‰²æ•°æ®</span></span><br><span class="line"><span class="built_in">..</span><span class="built_in">..</span></span><br></pre></td></tr></table></figure><p><strong>explainå½“ä¸­çš„idå­—æ®µ</strong></p><p>idå­—æ®µæ˜¯selectæŸ¥è¯¢çš„åºå·(å¹¶ä¸æ˜¯è‡ªå¢ï¼Œæ§åˆ¶è¡¨ç»“æ„çš„æ‰§è¡Œé¡ºåº)ï¼Œæ˜¯ä¸€ç»„æ•°å­—ï¼Œè¡¨ç¤ºæ˜¯çš„æ˜¯å¤„æŸ¥è¯¢ä¸­æ‰§è¡Œselectå­å¥æˆ–è€…æ˜¯æ“ä½œè¡¨çš„é¡ºåºï¼Œidæƒ…å†µæœ‰ä¸‰ç§ï¼š<br><strong>ï¼ˆ1ï¼‰</strong> <strong>idç›¸åŒè¡¨ç¤ºåŠ è½½è¡¨çš„é¡ºåºæ˜¯ä»ä¸Šåˆ°ä¸‹</strong>  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> t_role r,t_user u,user_role ur <span class="keyword">where</span> r.id=ur.role_id <span class="keyword">and</span> u.id=ur.user_id;<span class="comment"># å¤šè¡¨è”æŸ¥</span></span><br></pre></td></tr></table></figure><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_keys</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>r</td>    <td>PRIMARY</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>5</td>    <td>NULL</td>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>ur</td>    <td>ref</td>    <td>fk_ur_user_id,fk_ur_role_id</td>    <td>fk_ur_role_id</td>    <td>99</td>    <td>db03.r.id</td>    <td>1</td>    <td>Using where</td>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>u</td>    <td>eq_ref</td>    <td>PRIMARY</td>    <td>PRIMARY</td>    <td>98</td>    <td>db.ur.user_id</td>    <td>1</td>    <td>NULL</td>  </tr></table><p><strong>ï¼ˆ2ï¼‰</strong> <strong>idä¸åŒidå€¼è¶Šå¤§ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼Œè¶Šå…ˆè¢«æ‰§è¡Œ</strong>  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> t_role <span class="keyword">WHERE</span> <span class="keyword">id</span>=</span><br><span class="line">(</span><br><span class="line">  <span class="keyword">SELECT</span> role_id <span class="keyword">FROM</span> user_role <span class="keyword">WHERE</span> user_id=</span><br><span class="line">  (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">id</span> <span class="keyword">FROM</span> t_user <span class="keyword">WHERE</span> username=<span class="string">'stu1'</span></span><br><span class="line">  )</span><br><span class="line">)<span class="comment"># åµŒå¥—å­æŸ¥è¯¢</span></span><br></pre></td></tr></table></figure><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_keys</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>PRIMARY</td>    <td>t_role</td>    <td>const</td>    <td>PRIMARY</td>    <td>PRIMARY</td>    <td>98</td>    <td>const</td>    <td>1</td>    <td>NULL</td>  </tr>  <tr>    <td>2</td>    <td>SUBQUERY</td>    <td>user_role</td>    <td>ref</td>    <td>fk_ur_user_id</td>    <td>fk_ur_user_id</td>    <td>99</td>    <td>const</td>    <td>1</td>    <td>Using where</td>  </tr>  <tr>    <td>3</td>    <td>SUBQUERY</td>    <td>t_user</td>    <td>const</td>    <td>unique_user_username</td>    <td>unique_user_username</td>    <td>137</td>    <td>const</td>    <td>1</td>    <td>Using index</td>  </tr></table><p><strong>ï¼ˆ3ï¼‰</strong> <strong>idæœ‰ç›¸åŒï¼Œä¹Ÿæœ‰ä¸åŒï¼ŒåŒæ—¶å­˜åœ¨ã€‚idç›¸åŒçš„å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç»„ï¼Œä»ä¸Šå¾€ä¸‹é¡ºåºæ‰§è¡Œï¼›åœ¨æ‰€æœ‰çš„ç»„ä¸­ï¼Œidçš„å€¼è¶Šå¤§ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼Œè¶Šå…ˆæ‰§è¡Œã€‚</strong>  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> t_role r,</span><br><span class="line">(</span><br><span class="line">  <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> user_role ur <span class="keyword">WHERE</span> ur.<span class="string">'user_id'</span>=<span class="string">'2'</span></span><br><span class="line">) a  </span><br><span class="line"><span class="keyword">WHERE</span> r.id=a.role_id;  </span><br><span class="line"><span class="comment">#ä¸‰è¡¨æŸ¥è¯¢åˆè¿æ¥äº†ä¸€ä¸ªå­æŸ¥è¯¢</span></span><br></pre></td></tr></table></figure><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_keys</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>PRIMARY</td>    <td>< derived2></td>    <td>ALL</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>2</td>    <td>Using where</td>  </tr>  <tr>    <td>1</td>    <td>PRIMARY</td>    <td>r</td>    <td>eq_ref</td>    <td>PRIMARY</td>    <td>PRIMARY</td>    <td>98</td>    <td>a.role_id</td>    <td>1</td>    <td>NULL</td>  </tr>  <tr>    <td>2</td>    <td>DERIVED</td>    <td>ur</td>    <td>ref</td>    <td>fk_ur_user_id</td>    <td>fk_ur_user_id</td>    <td>99</td>    <td>const</td>    <td>1</td>    <td>Using index condition</td>  </tr></table><h2 id="ä¼˜åŒ–SQLæ­¥éª¤-explainä¹‹select-type"><a href="#ä¼˜åŒ–SQLæ­¥éª¤-explainä¹‹select-type" class="headerlink" title="ä¼˜åŒ–SQLæ­¥éª¤ - explainä¹‹select_type"></a>ä¼˜åŒ–SQLæ­¥éª¤ - explainä¹‹select_type</h2><p><strong>explainä¹‹select_type</strong><br>è¡¨ç¤º<strong>SELECTçš„ç±»å‹</strong>ï¼Œå¸¸è§çš„å–å€¼ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼ˆ<strong>ä»ä¸Šå¾€ä¸‹</strong>ï¼Œ<strong>æ•ˆç‡è¶Šæ¥è¶Šä½</strong>ï¼‰ï¼š  </p><table>  <tr>    <th>select_type</th>    <th>å«ä¹‰</th>  </tr>  <tr>    <td>SIMPLE</td>    <td>ç®€å•çš„selectæŸ¥è¯¢ï¼ŒæŸ¥è¯¢ä¸­ä¸åŒ…å«å­æŸ¥è¯¢æˆ–è€…UNIONã€‚</td>  </tr>  <tr>    <td>PRIMARY</td>    <td>æŸ¥è¯¢ä¸­è‹¥åŒ…å«ä»»ä½•å¤æ‚çš„å­æŸ¥è¯¢ï¼Œæœ€å¤–å±‚æŸ¥è¯¢æ ‡è®°ä¸ºè¯¥æ ‡è¯†ã€‚</td>  </tr>  <tr>    <td>SUBQUERY</td>    <td>åœ¨SELECTæˆ–è€…WHEREåˆ—è¡¨ä¸­åŒ…å«äº†å­æŸ¥è¯¢ã€‚</td>  </tr>  <tr>    <td>DERIVED</td>    <td>åœ¨FROMåˆ—è¡¨ä¸­åŒ…å«çš„å­æŸ¥è¯¢ï¼Œè¢«æ ‡è®°ä¸ºDERIVEDï¼ˆè¡ç”Ÿï¼‰MYSQLæˆ–é€’å½’æ‰§è¡Œè¿™äº›å­æŸ¥è¯¢ï¼ŒæŠŠç»“æœæ”¾åœ¨ä¸´æ—¶è¡¨ä¸­ã€‚</td>  </tr>  <tr>    <td>UNION</td>    <td>è‹¥ç¬¬äºŒä¸ªSELECTå‡ºç°åœ¨UNIONä¹‹åï¼Œåˆ™æ ‡è®°ä¸ºUNIONï¼›è‹¥UNIONåŒ…å«åœ¨FROMå­å¥çš„å­æŸ¥è¯¢ä¸­ï¼Œå¤–å±‚SELECTå°†æ ‡è®°ä¸ºï¼šDERIVED</td>  </tr>  <tr>    <td>UNION RESULT</td>    <td>ä»UNIONè¡¨è·å–ç»“æœçš„SELECT</td>  </tr></table><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_item;</span><br><span class="line"># SIMPLE  </span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">where</span> id=(<span class="keyword">select</span> id <span class="keyword">from</span> user_role <span class="keyword">where</span> role_id=<span class="string">'9'</span>);  </span><br><span class="line"># <span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">where</span> idï¼š <span class="keyword">PRIMARY</span> ï¼›  </span><br><span class="line">#(<span class="keyword">select</span> id <span class="keyword">from</span> user_role <span class="keyword">where</span> role_id=<span class="string">'9'</span>)ï¼šSUBQUERY  </span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> a.* <span class="keyword">from</span> (<span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">where</span> id <span class="keyword">in</span> (<span class="string">'1'</span>,<span class="string">'2'</span>)) a;</span><br><span class="line"># <span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">where</span> id <span class="keyword">in</span> (<span class="string">'1'</span>,<span class="string">'2'</span>): <span class="keyword">DERIVED</span>ï¼›å­˜å‚¨è‡³è¡ç”Ÿçš„ä¸´æ—¶è¡¨</span><br><span class="line"># <span class="keyword">select</span> a.* <span class="keyword">from</span> ï¼š <span class="keyword">PRIMARY</span>  derived2æŒ‡çš„æ˜¯<span class="keyword">derived</span>æŒ‡çš„æ˜¯è¡ç”Ÿçš„è¡¨aï¼Œ<span class="number">2</span>åˆ™æŒ‡çš„æ˜¯idï¼Œæ‰§è¡Œæ“ä½œè¡¨é¡ºåºå­—æ®µï¼›</span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">where</span> id=<span class="string">'1'</span> <span class="keyword">union</span> <span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">where</span> id=<span class="string">'2'</span>;</span><br><span class="line">#<span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">where</span> id=<span class="string">'1'</span>: <span class="keyword">PRIMARY</span></span><br><span class="line">#<span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">where</span> id=<span class="string">'2'</span> ï¼š <span class="keyword">UNION</span></span><br><span class="line"># <span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">where</span> id=<span class="string">'1'</span>çš„ç»“æœ  &amp;&amp;  <span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">where</span> id=<span class="string">'2'</span>çš„ç»“æœè”åˆèµ·æ¥ï¼š <span class="keyword">UNION</span> RESULT</span><br></pre></td></tr></table></figure><h2 id="ä¼˜åŒ–SQLæ­¥éª¤-explainä¹‹table-ã€type"><a href="#ä¼˜åŒ–SQLæ­¥éª¤-explainä¹‹table-ã€type" class="headerlink" title="ä¼˜åŒ–SQLæ­¥éª¤ - explainä¹‹table ã€type"></a>ä¼˜åŒ–SQLæ­¥éª¤ - explainä¹‹table ã€type</h2><p><strong>explainä¹‹table</strong><br>å±•ç¤ºè¿™ä¸€è¡Œçš„æ•°æ®æ˜¯<strong>å…³äºå“ªä¸€å¼ è¡¨</strong>çš„ï¼›  </p><p><strong>explainä¹‹type</strong><br><strong>type</strong>æ˜¾ç¤ºçš„æ˜¯<strong>è®¿é—®ç±»å‹</strong>ï¼Œæ˜¯è¾ƒä¸ºé‡è¦çš„ä¸€ä¸ªæŒ‡æ ‡ï¼Œå¯å–å€¼ä¸ºï¼š  </p><table>  <tr>    <th>type</th>    <th>å«ä¹‰</th>  </tr>  <tr>    <td>NULL</td>    <td>MySQLä¸è®¿é—®ä»»ä½•è¡¨ï¼Œç´¢å¼•ï¼Œç›´æ¥è¿”å›ç»“æœ</td>  </tr>  <tr>    <td>system</td>    <td>è¡¨åªæœ‰ä¸€è¡Œè®°å½•ï¼ˆç­‰åŒäºç³»ç»Ÿè¡¨ï¼‰ï¼Œè¿™æ˜¯constç±»å‹çš„ç‰¹ä¾‹ï¼Œä¸€èˆ¬ä¸ä¼šå‡ºç°</td>  </tr>  <tr>    <td>const</td>    <td>è¡¨ç¤ºé€šè¿‡ç´¢å¼•ä¸€æ¬¡å°±æ‰¾åˆ°äº†ï¼Œconstç”¨äºæ¯”è¾ƒprimary keyæˆ–è€…uniqueç´¢å¼•ã€‚å› ä¸ºåªåŒ¹é…ä¸€è¡Œæ•°æ®ï¼Œç´¢å¼•å¾ˆå¿«ã€‚å¦‚å°†ä¸»é”®ç½®äºwhereåˆ—è¡¨ä¸­ï¼ŒMySQLå°±èƒ½å°†è¯¥æŸ¥è¯¢è½¬æ¢æˆä¸€ä¸ªå¸¸é‡ã€‚(æ ¹æ®ä¸»é”®æˆ–è€…å”¯ä¸€ç´¢å¼•è¿›è¡ŒæŸ¥è¯¢)</td>  </tr>  <tr>    <td>eq_ref</td>    <td>ç±»ä¼¼refï¼ŒåŒºåˆ«åœ¨äºä½¿ç”¨çš„æ˜¯å”¯ä¸€ç´¢å¼•ï¼Œä½¿ç”¨ä¸»é”®çš„å…³è”æŸ¥è¯¢ï¼Œå…³è”æŸ¥è¯¢å‡ºçš„è®°å½•åªæœ‰ä¸€æ¡ã€‚å¸¸è§äºä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•æ‰«æ</td>  </tr>  <tr>    <td>ref</td>    <td>éå”¯ä¸€æ€§ç´¢å¼•æ‰«æï¼Œè¿”å›çš®è¯¶æŸä¸ªå•ç‹¬å€¼çš„æ‰€æœ‰è¡Œã€‚æœ¬è´¨ä¸Šä¹Ÿæ˜¯é‡ç§ç´¢å¼•è®¿é—®ï¼Œè¿”å›æ‰€æœ‰åŒ¹é…æŸä¸ªå•ç‹¬å€¼çš„æ‰€æœ‰è¡Œï¼ˆå¤šä¸ªï¼‰</td>  </tr>  <tr>    <td>range</td>    <td>åªæ£€ç´¢ç»™å®šè¿”å›çš„è¡Œï¼Œä½¿ç”¨ä¸€ä¸ªç´¢å¼•æ¥é€‰æ‹©è¡Œã€‚whereä¹‹åå‡ºç°betweenï¼Œ<ï¼Œ>ï¼Œinç­‰æ“ä½œ</ï¼Œ></td>  </tr>  <tr>    <td>index</td>    <td>indexä¸ALLçš„åŒºåˆ«ä¸ºindexç±»å‹åªæ˜¯éå†äº†ç´¢å¼•æ ‘ï¼Œé€šå¸¸æ¯”ALLå¿«ï¼ŒALLæ˜¯éå†æ•°æ®æ–‡ä»¶ã€‚</td>  </tr>  <tr>    <td>all</td>    <td>å°†éå†å…¨è¡¨ä»¥æ‰¾åˆ°åŒ¹é…çš„è¡Œ</td>  </tr></table><p><strong>typeä¸ºNULL</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> now(); # æŸ¥è¯¢å½“å‰æ—¶é—´(æŸ¥è¯¢æ•ˆç‡éå¸¸é«˜) ï¼š <span class="keyword">type</span>-&gt;<span class="keyword">NULL</span></span><br></pre></td></tr></table></figure><blockquote><p>ç¤ºä¾‹ï¼š</p></blockquote><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_keys</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>No tables used</td>  </tr></table><p><strong>typeä¸ºsystem</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> (<span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">where</span> id=<span class="string">'1'</span>) a;ï¼š <span class="keyword">type</span>-&gt;<span class="keyword">system</span></span><br></pre></td></tr></table></figure><blockquote><p>ç¤ºä¾‹ï¼š</p></blockquote><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_keys</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>PRIMARY</td>    <td>< derived2></td>    <td>system</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>1</td>    <td>NULL</td>  </tr>  <tr>    <td>2</td>    <td>DERIVED</td>    <td>t_user</td>    <td>const</td>    <td>PRIMARY</td>    <td>PRIMARY</td>    <td>98</td>    <td>const</td>    <td>1</td>    <td>NULL</td>  </tr></table><p><strong>typeä¸ºconst</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">where</span> <span class="keyword">id</span>=<span class="string">'1'</span>;<span class="comment"># æ ¹æ®ä¸»é”®æŸ¥è¯¢è¿”å›ä¸€æ¡è®°å½•ï¼štype-&gt;const</span></span><br></pre></td></tr></table></figure><blockquote><p>ç¤ºä¾‹ï¼š</p></blockquote><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_keys</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>t_user</td>    <td>const</td>    <td>PRIMARY</td>    <td>PRIMARY</td>    <td>98</td>    <td>const</td>    <td>1</td>    <td>NULL</td>  </tr></table><p><strong>typeä¸ºconst</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">where</span> username=<span class="string">'stu1'</span>;<span class="comment">#æ ¹æ®å”¯ä¸€ç´¢å¼•æŸ¥è¯¢è¿”å›ä¸€æ¡è®°å½•ï¼štype-&gt;const</span></span><br></pre></td></tr></table></figure><blockquote><p>ç¤ºä¾‹ï¼š</p></blockquote><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_keys</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>t_user</td>    <td>const</td>    <td>unique_user_username</td>    <td>unique_user_username</td>    <td>137</td>    <td>const</td>    <td>1</td>    <td>NULL</td>  </tr></table><p><strong>typeä¸ºeq_ref</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> t_user;//idæœ‰1ã€2ã€3ã€4ã€5ã€6</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> t_role;//idæœ‰10ã€5ã€7ã€8ã€9</span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> t_user u ,t_role r <span class="keyword">where</span> u.id=r.id;<span class="comment">#ä¸šåŠ¡é€»è¾‘å±‚é¢ä¸ç¬¦åˆï¼Œåªæ˜¯æ•°æ®åº“ç¡¬æ€§æŸ¥è¯¢ï¼ˆå¼ºè¡Œå…³è”ï¼‰å‡ºä¸€ä¸ªtypeä¸ºeq_refçš„ç¤ºä¾‹è€Œå·²</span></span><br></pre></td></tr></table></figure><blockquote><p>ç¤ºä¾‹ï¼š</p></blockquote><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_keys</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>r</td>    <td>ALL</td>    <td>PRIMARY</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>5</td>    <td>NULL</td>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>u</td>    <td>eq_ref</td>    <td>PRIMARY</td>    <td>PRIMARY</td>    <td>98</td>    <td>demo_02.r.id</td>    <td>1</td>    <td>NULL</td>  </tr></table><p><strong>typeä¸ºref</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">index</span> <span class="keyword">from</span> t_user;<span class="comment">#æŸ¥è¯¢t_userè¡¨å½“ä¸­çš„ç´¢å¼•</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> idx_user_name <span class="keyword">on</span> t_user(<span class="string">'name'</span>);</span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'a'</span>;<span class="comment">#æ ¹æ®éå”¯ä¸€æ€§ç´¢å¼•è¿›è¡ŒæŸ¥è¯¢ï¼Œè¿”å›çš„è®°å½•åªæœ‰ä¸€æ¡</span></span><br></pre></td></tr></table></figure><blockquote><p>ç¤ºä¾‹ï¼š</p></blockquote><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_keys</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>t_user</td>    <td>ref</td>    <td>idx_user_name</td>    <td>idx_user_name</td>    <td>137</td>    <td>const</td>    <td>1</td>    <td>Using index condition</td>  </tr></table><p><strong>typeä¸ºrange(èŒƒå›´æŸ¥è¯¢)</strong></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">explain <span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span>.ï¼ˆbetween <span class="keyword">and</span>ï¼‰ã€ï¼ˆ&gt;ã€&lt;ã€&gt;=ã€&lt;=ï¼‰<span class="built_in">..</span>.</span><br></pre></td></tr></table></figure><p><strong>typeä¸ºindex(æŒ‡çš„å³ç´¢å¼•)</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> t_user;//æŸ¥è¯¢æ‰€æœ‰æ•°æ®ï¼Œè¿›è¡Œå…¨è¡¨æ‰«æï¼Œå³åˆ°æ•°æ®æ–‡ä»¶å½“ä¸­è¿›è¡Œè¯»å–ï¼›<span class="keyword">type</span>ä¸º<span class="keyword">ALL</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> id <span class="keyword">from</span> t_user;//æ­¤æ—¶<span class="keyword">type</span>ä¸º<span class="keyword">index</span>ï¼›å› ä¸ºidä¸ºä¸»é”®ï¼Œä¸»é”®åˆ™èµ°ä¸»é”®ç´¢å¼•ï¼›</span><br></pre></td></tr></table></figure><p>ç»“æœå€¼ä»æœ€å¥½åˆ°æœ€åä¾æ¬¡æ˜¯ï¼š  </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">NULL</span> &gt;<span class="built_in"> system </span>&gt; const &gt; eq_ref &gt; ref &gt; fulltext &gt; ref_or_null &gt; index_merge &gt; unique_subquery &gt; index_subquery &gt; range &gt; index &gt; all</span><br></pre></td></tr></table></figure><h2 id="ä¼˜åŒ–SQLæ­¥éª¤-explainä¹‹key-rows-extra"><a href="#ä¼˜åŒ–SQLæ­¥éª¤-explainä¹‹key-rows-extra" class="headerlink" title="ä¼˜åŒ–SQLæ­¥éª¤ - explainä¹‹key rows extra"></a>ä¼˜åŒ–SQLæ­¥éª¤ - explainä¹‹key rows extra</h2><p><strong>explainä¹‹key</strong>  </p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">possible_keys:</span>æ˜¾ç¤ºå¯èƒ½åº”ç”¨åœ¨è¿™å¼ è¡¨çš„ç´¢å¼•ï¼Œä¸€ä¸ªæˆ–è€…å¤šä¸ªï¼›</span><br><span class="line"><span class="symbol">key:</span>å®é™…ä½¿ç”¨çš„ç´¢å¼•ï¼Œå¦‚æœä¸ºNULLï¼Œåˆ™æ²¡æœ‰ä½¿ç”¨ç´¢å¼•ï¼›</span><br><span class="line">key_lenï¼šè¡¨ç¤ºç´¢å¼•ä¸­ä½¿ç”¨çš„å­—èŠ‚æ•°ï¼Œè¯¥å€¼ä¸ºç´¢å¼•å­—æ®µæœ€å¤§å¯èƒ½é•¿åº¦ï¼Œå¹¶éå®é™…ä½¿ç”¨é•¿åº¦ï¼Œåœ¨ä¸æŸå¤±ç²¾ç¡®æ€§çš„å‰æä¸‹ï¼Œé•¿åº¦è¶ŠçŸ­è¶Šå¥½ï¼ˆè¶ŠçŸ­æ‰§è¡Œæ•ˆç‡è¶Šé«˜ï¼‰ï¼›</span><br></pre></td></tr></table></figure><p><strong>explainä¹‹rows</strong>  </p><p>æ‰«æè¡Œçš„æ•°é‡ã€‚  </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">where</span> <span class="type">name</span> =<span class="string">'a'</span>;#<span class="type">name</span>å»ºäº†ç´¢å¼•ï¼Œæ‰€ä»¥æŸ¥è¯¢<span class="keyword">rows</span>ä¸º<span class="number">1</span>è¡Œ</span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">where</span> <span class="keyword">password</span>=<span class="string">'aaa'</span>;# <span class="keyword">password</span>æ²¡æœ‰å»ºç«‹ç´¢å¼•ï¼Œæ•´è¡¨æ‰«æï¼›<span class="keyword">rows</span>å³<span class="keyword">SQL</span>è¯­å¥æŸ¥è¯¢æ—¶æ‰€æŸ¥è¯¢çš„è¡Œæ•°ï¼›</span><br></pre></td></tr></table></figure><p><strong>explainä¹‹extra</strong>  </p><p><strong>å…¶ä»–çš„é¢å¤–çš„æ‰§è¡Œè®¡åˆ’ä¿¡æ¯</strong>ï¼Œåœ¨è¯¥åˆ—å±•ç¤ºã€‚<br>ï¼ˆusing_filesortä»¥åŠusing_temporaryéå¸¸è€—æ€§èƒ½ï¼›<br>éœ€è¦ä¼˜åŒ–using_filesortä»¥åŠusing_temporaryï¼›ä¿æŒusing_indexï¼‰</p><table>  <tr>    <th>extra</th>    <th>å«ä¹‰</th>  </tr>  <tr>    <td>using_filesort</td>    <td>è¯´æ˜mysqlä¼šå¯¹æ•°æ®ä½¿ç”¨ä¸€ä¸ªå¤–éƒ¨çš„ç´¢å¼•æ’åºï¼Œè€Œä¸æ˜¯æŒ‰ç…§è¡¨å†…çš„ç´¢å¼•é¡ºåºè¿›è¡Œè¯»å–ï¼Œç§°ä¸ºâ€œæ–‡ä»¶æ’åºâ€</td>  </tr>  <tr>    <td>using_temporary</td>    <td>ä½¿ç”¨äº†ä¸´æ—¶è¡¨ä¿å­˜ä¸­é—´ç»“æœï¼ŒMySQLå¯¹æŸ¥è¯¢ç»“æœæ’åºæ—¶ä½¿ç”¨ä¸´æ—¶è¡¨ã€‚å¸¸è§äºorder by å’Œgroup by</td>  </tr>  <tr>    <td>using_index</td>    <td>è¡¨ç¤ºç›¸åº”çš„selectæ“ä½œä½¿ç”¨äº†è¦†ç›–ç´¢å¼•ï¼Œé¿å…è®¿é—®è¡¨çš„æ•°æ®è¡Œï¼Œæ•ˆç‡ä¸é”™ã€‚</td>  </tr></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">id</span>;<span class="comment">#æŒ‰ç…§idè¿›è¡Œæ’åº</span></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">password</span>;<span class="comment">#æ ¹æ®æ–‡ä»¶è¿›è¡Œæ’åºï¼›å³éœ€è¦æ‰«ææ–‡ä»¶å½“ä¸­çš„å†…å®¹ï¼Œç„¶åå†å»è¿›è¡Œæ’åºï¼›æ•ˆç‡éå¸¸ä½ï¼›è¿™ä¸ªæ—¶å€™å¦‚æœéœ€è¦è¿›è¡Œä¼˜åŒ–çš„è¯ï¼Œå¯ä»¥åœ¨passwordå­—æ®µä¸Šä¸nameä¸€æ ·å»ºç«‹ç´¢å¼•ï¼›</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">name</span>; <span class="comment">#æ­¤æ—¶ä¾ç„¶æ˜¯using_filesortæ ¹æ®æ–‡ä»¶æ’åº</span></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> <span class="keyword">name</span> <span class="keyword">from</span> t_user <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">name</span>;<span class="comment">#æ­¤æ—¶åˆ™ä½¿ç”¨çš„æ˜¯using_indexæ ¹æ®ç´¢å¼•æ’åº</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">name</span>;<span class="comment">#æ­¤æ—¶extraä¸ºnullï¼ŒåŸå› æ˜¯æ ¹æ®nameå­—æ®µå»ºç«‹äº†ç´¢å¼•</span></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">password</span>;<span class="comment">#æ­¤æ—¶passwordå­—æ®µæ²¡æœ‰å»ºç«‹ç´¢å¼•ï¼›extraä¸ºusing temporaryï¼›using filesortæ•ˆç‡ä½ï¼›</span></span><br></pre></td></tr></table></figure><h2 id="ä¼˜åŒ–SQLæ­¥éª¤-show-profile"><a href="#ä¼˜åŒ–SQLæ­¥éª¤-show-profile" class="headerlink" title="ä¼˜åŒ–SQLæ­¥éª¤ - show profile"></a>ä¼˜åŒ–SQLæ­¥éª¤ - show profile</h2><p>MySQLä»5.0.37ç‰ˆæœ¬å¼€å§‹å¢åŠ äº†å¯¹ <strong>show profiles</strong> å’Œ <strong>show profile</strong> è¯­å¥çš„æ”¯æŒã€‚  </p><p><strong>show profiles</strong> èƒ½å¤Ÿåœ¨åšSQLä¼˜åŒ–æ—¶å¸®åŠ©äº†è§£æ—¶é—´éƒ½è€—è´¹åˆ°å“ªé‡Œå»äº†ï¼›  </p><p>é€šè¿‡ <strong>have_profiling</strong> å‚æ•°ï¼Œèƒ½å¤Ÿçœ‹åˆ° <strong>å½“å‰MySQL æ˜¯å¦æ”¯æŒ profile</strong>ï¼›  </p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">select</span> <span class="comment">@@</span>have_profiling;<span class="meta">#ç³»ç»Ÿå˜é‡ï¼›YES/NO</span></span><br></pre></td></tr></table></figure><p>é»˜è®¤ profiling æ˜¯å…³é—­çš„ï¼Œå¯ä»¥é€šè¿‡setè¯­å¥åœ¨Sessionçº§åˆ«å¼€å¯profilingï¼š  </p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> @<span class="symbol">@profiling</span><span class="comment">;</span></span><br></pre></td></tr></table></figure><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">set</span> <span class="attribute">profiling</span>=1;# å¼€å¯profilingå¼€å…³ï¼›0:æœªå¼€å¯ï¼›1ï¼šå¼€å¯</span><br></pre></td></tr></table></figure><p>é€šè¿‡profileï¼Œèƒ½å¤Ÿæ›´æ¸…æ¥šçš„äº†è§£SQLæ‰§è¡Œçš„è¿‡ç¨‹ï¼›<br>é¦–å…ˆï¼Œå¯ä»¥æ‰§è¡Œä¸€ç³»åˆ—çš„æ“ä½œï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> db01;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> t_user;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> tb_item;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_item <span class="keyword">where</span> title=<span class="string">'abc'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">profiles</span>;<span class="comment">#æŸ¥çœ‹ä¹‹å‰æ¯ä¸€ä¸ªæ“ä½œçš„è€—æ—¶æƒ…å†µ query_id(å½“å‰æŸ¥è¯¢çš„id)ã€durationï¼ˆæ‰§è¡Œçš„è€—æ—¶æ—¶é—´ï¼‰ã€queryï¼ˆæŸ¥è¯¢çš„sqlï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># use db01;å…¶å®åº•å±‚å³select database();</span></span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå®Œä¸Šè¿°å‘½ä»¤ä¹‹åï¼Œå†æ‰§è¡Œshow profilesæŒ‡ä»¤ï¼Œæ¥æŸ¥çœ‹SQLè¯­å¥æ‰§è¡Œçš„è€—æ—¶ï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">profiles</span>;<span class="comment"># query_idã€durationã€query</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡ show profile for query query_id è¯­å¥å¯ä»¥æŸ¥çœ‹åˆ°è¯¥SQLæ‰§è¡Œè¿‡ç¨‹ä¸­æ¯ä¸ªçº¿ç¨‹çš„çŠ¶æ€å’Œæ¶ˆè€—çš„æ—¶é—´ï¼›  </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show<span class="built_in"> profile </span><span class="keyword">for</span> query 6;#6å³é€šè¿‡show profilesæŸ¥è¯¢å‡ºæ¥çš„query_id;  statusã€duration</span><br></pre></td></tr></table></figure><table>  <tr>    <th>statusï¼ˆç»å†çš„æ¯ä¸€ä¸ªé˜¶æ®µï¼‰</th>    <th>durationï¼ˆæ¯ä¸€ä¸ªé˜¶æ®µçš„è€—æ—¶æƒ…å†µï¼‰</th>  </tr>  <tr>    <td>startingï¼ˆå¼€å¯ï¼‰</td>    <td>0.000046</td>  </tr>  <tr>    <td>checking permissionsï¼ˆæ ¡éªŒæƒé™ï¼‰</td>    <td>...</td>  </tr>  <tr>    <td>opening tablesï¼ˆæ‰“å¼€è¡¨ï¼‰</td>    <td>...</td>  </tr>    <tr>    <td>initï¼ˆåˆå§‹åŒ–ï¼‰</td>    <td>...</td>  </tr>    <tr>    <td>system lockï¼ˆç³»ç»Ÿé”ï¼‰</td>    <td>...</td>  </tr>    <tr>    <td>optimizingï¼ˆä¼˜åŒ–å™¨ï¼‰</td>    <td>...</td>  </tr>    <tr>    <td>statisticsï¼ˆç»Ÿè®¡ï¼‰</td>    <td>...</td>  </tr>    <tr>    <td>perparingï¼ˆå‡†å¤‡ï¼‰</td>    <td>...</td>  </tr>    <tr>    <td>executingï¼ˆæ‰§è¡Œï¼‰</td>    <td>...</td>  </tr>    <tr>    <td>sending dataï¼ˆå‘é€æ•°æ®ï¼‰</td>    <td>...</td>  </tr>    <tr>    <td>endï¼ˆç»“æŸï¼‰</td>    <td>...</td>  </tr>    <tr>    <td>query endï¼ˆæŸ¥è¯¢ç»“æŸï¼‰</td>    <td>...</td>  </tr>    <tr>    <td>closing tablsï¼ˆå…³é—­è¡¨ï¼‰</td>    <td>...</td>  </tr>    <tr>    <td>freeing itmesï¼ˆé‡Šæ”¾å…¶ä»–é¡¹ï¼‰</td>    <td>...</td>  </tr>    <tr>    <td>cleaning upï¼ˆæ¸…é™¤ï¼‰</td>    <td>...</td>  </tr></table><p>ï¼ˆselect count(*) from tb_itemï¼›è¯¥sqlè¯­å¥çš„æ—¶é—´éƒ½è€—è´¹åœ¨sending dataä¸Šäº†ï¼›ï¼‰  </p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">TIP:  </span></span><br><span class="line"><span class="code">    Sending data çŠ¶æ€è¡¨ç¤ºMySQLçº¿ç¨‹å¼€å§‹è®¿é—®æ•°æ®è¡Œå¹¶æŠŠç»“æœæ”¾å›ç»™å®¢æˆ·ç«¯ï¼Œè€Œä¸ä»…ä»…æ˜¯è¿”å›ç»™å®¢æˆ·ç«¯ã€‚  </span></span><br><span class="line"><span class="code">    ç”±äºSending data çŠ¶æ€ä¸‹ï¼ŒMySQLçº¿ç¨‹å¾€å¾€éœ€è¦åšå¤§é‡çš„ç£ç›˜è¯»å–æ“ä½œï¼Œæ‰€ä»¥ç»å¸¸æ˜¯æ•´ä¸ªæŸ¥è¯¢ä¸­è€—æ—¶æœ€é•¿çš„çŠ¶æ€ã€‚</span></span><br></pre></td></tr></table></figure><p>åœ¨è·å–åˆ°æœ€è€—æ—¶æ—¶é—´çš„çº¿ç¨‹çŠ¶æ€åï¼ŒMySQLæ”¯æŒè¿›ä¸€æ­¥é€‰æ‹©allã€cpuã€block ioã€context switchã€page faults ç­‰æ˜ç»†ç±»å‹ç­‰æŸ¥çœ‹MySQLåœ¨ä½¿ç”¨ä»€ä¹ˆèµ„æºä¸Šè€—è´¹äº†è¿‡é«˜çš„æ—¶é—´ã€‚<br>ä¾‹å¦‚ï¼Œé€‰æ‹©æŸ¥çœ‹CPUçš„è€—è´¹æ—¶é—´ï¼š  </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select<span class="built_in"> profile </span>cpu <span class="keyword">for</span> query 6;# statusã€durationã€CPU_userã€CPU_SystemæŸ¥è¯¢åˆ°çš„æ˜¯idä¸º6çš„è¯¥æ¡sqlè¯­å¥åœ¨å„ä¸ªé˜¶æ®µå½“ä¸­cpuçš„è€—è´¹æƒ…å†µï¼›</span><br><span class="line"></span><br><span class="line">select<span class="built_in"> profile </span>all <span class="keyword">for</span> query 6;# statusã€durationã€CPU_userã€CPU_systemã€context_voluntaryã€context_involuntaryã€block_ops_inã€block_ops_outã€<span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span></span><br></pre></td></tr></table></figure><blockquote><p>é€šè¿‡ <strong>show profile</strong> å¯ä»¥ <strong>åˆ†æSQLè¯­å¥ å„ä¸ªé˜¶æ®µçš„ è€—æ—¶æƒ…å†µ</strong></p></blockquote><h2 id="ä¼˜åŒ–SQLæ­¥éª¤-traceå·¥å…·"><a href="#ä¼˜åŒ–SQLæ­¥éª¤-traceå·¥å…·" class="headerlink" title="ä¼˜åŒ–SQLæ­¥éª¤ - traceå·¥å…·"></a>ä¼˜åŒ–SQLæ­¥éª¤ - traceå·¥å…·</h2><p>mysqlçš„æœåŠ¡ç«¯serveræœ‰ä¸€ä¸ªæ­¥éª¤å°±æ˜¯optimizerï¼Œä¼˜åŒ–sqléƒ¨åˆ†ï¼›æŒ‰ç…§mysqlå½“ä¸­å…·ä½“å¯¹åº”çš„è§„åˆ™å¯¹SQLè¿›è¡Œä¼˜åŒ–å¤„ç†ï¼›traceå³åˆ†æä¼˜åŒ–å™¨</p><p><strong>traceåˆ†æä¼˜åŒ–å™¨æ‰§è¡Œè®¡åˆ’</strong><br>MySQL5.6æä¾›äº†å¯¹SQLçš„è·Ÿè¸ª traceï¼Œé€šè¿‡traceæ–‡ä»¶èƒ½å¤Ÿè¿›ä¸€æ­¥äº†è§£ä¸ºä»€ä¹ˆä¼˜åŒ–å™¨é€‰æ‹©Aè®¡åˆ’ï¼Œè€Œä¸æ˜¯Bè®¡åˆ’ã€‚  </p><p>æ‰“å¼€traceï¼Œè®¾ç½®æ ¼å¼ä¸ºJSONï¼Œå¹¶è®¾ç½®traceæœ€å¤§èƒ½å¤Ÿä½¿ç”¨çš„å†…å­˜å¤§å°ï¼Œé¿å…è§£æè¿‡ç¨‹ä¸­å› ä¸ºé»˜è®¤å†…å­˜è¿‡å°è€Œä¸èƒ½å¤Ÿå®Œæ•´å±•ç¤ºã€‚  </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">SET</span> optimizer_trace =<span class="string">'enabled=on'</span>, <span class="attribute">end_markers_in_json</span>=on;# optimizer_trace =<span class="string">'enabled=on'</span>è¿›è¡Œå¼€å¯ï¼›<span class="attribute">end_markers_in_json</span>=on è®¾ç½®æ ¼å¼ä¸ºJSON</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">set</span> <span class="attribute">optimizer_trace_max_mem_size</span>=1000000;# æ—¥å¿—æ–‡ä»¶å ç”¨å†…å­˜å¤§å°</span><br></pre></td></tr></table></figure><p>æ‰§è¡ŒSQLè¯­å¥ï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_item <span class="keyword">where</span> <span class="keyword">id</span> &lt; <span class="number">4</span>;</span><br></pre></td></tr></table></figure><p>æœ€åï¼Œæ£€æŸ¥information_schema.optimizer_traceå°±å¯ä»¥çŸ¥é“MySQLæ˜¯å¦‚ä½•æ‰§è¡ŒSQLçš„ï¼š  </p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> infomation_schema.optimizer_trace\G;# infomation_schemaç³»ç»Ÿåº“ï¼›optimizer_traceç³»ç»Ÿåº“å½“ä¸­çš„æ—¥å¿—è¡¨</span><br><span class="line"></span><br><span class="line"># QUERY æŸ¥è¯¢çš„SQLè¯­å¥ï¼›<span class="keyword">select</span> * <span class="keyword">from</span> tb_item <span class="keyword">where</span> id&lt;<span class="number">4</span>;</span><br><span class="line"># TRACE è·Ÿè¸ªä¿¡æ¯ï¼›åœ¨è·Ÿè¸ªä¿¡æ¯å½“ä¸­æœ€ç»ˆ<span class="keyword">select</span> * å½“ä¸­çš„* æœ€ç»ˆè§£æä¸ºtb_itemè¡¨å½“ä¸­çš„æ¯ä¸€ä¸ªå…·ä½“çš„å­—æ®µ</span><br></pre></td></tr></table></figure><h2 id="ç´¢å¼•çš„ä½¿ç”¨-éªŒè¯ç´¢å¼•æå‡æŸ¥è¯¢æ•ˆç‡"><a href="#ç´¢å¼•çš„ä½¿ç”¨-éªŒè¯ç´¢å¼•æå‡æŸ¥è¯¢æ•ˆç‡" class="headerlink" title="ç´¢å¼•çš„ä½¿ç”¨ - éªŒè¯ç´¢å¼•æå‡æŸ¥è¯¢æ•ˆç‡"></a>ç´¢å¼•çš„ä½¿ç”¨ - éªŒè¯ç´¢å¼•æå‡æŸ¥è¯¢æ•ˆç‡</h2><p><strong>ç´¢å¼•çš„ä½¿ç”¨</strong><br>ç´¢å¼•æ—¶å€™æ•°æ®åº“ä¼˜åŒ–æœ€å¸¸ç”¨ä¹Ÿæ˜¯æœ€é‡è¦çš„æ‰‹æ®µä¹‹ä¸€ï¼Œé€šè¿‡ç´¢å¼•é€šå¸¸å¯ä»¥å¸®åŠ©ç”¨æˆ·è§£å†³å¤§å¤šæ•°çš„MySQLçš„æ€§èƒ½ä¼˜åŒ–é—®é¢˜ï¼›  </p><p><strong>éªŒè¯ç´¢å¼•æå‡æŸ¥è¯¢æ•ˆç‡</strong><br>åœ¨å‡†å¤‡çš„è¡¨ç»“æ„tb_itemä¸­ï¼Œä¸€å…±å­˜å‚¨äº†300ä¸‡æ¡è®°å½•ï¼›  </p><p><strong>A.</strong> æ ¹æ®IDæŸ¥è¯¢  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> tb_items;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_item <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">1888</span>;<span class="comment">#idå­—æ®µå…·æœ‰ä¸»é”®ç´¢å¼•</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_item <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">1999</span>\G;</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ ¹æ®titleè¿›è¡Œç²¾ç¡®æŸ¥è¯¢</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_item <span class="keyword">where</span> title=<span class="string">'é˜¿å°”å¡ç‰¹'</span>;<span class="comment">#æŸ¥è¯¢é€Ÿåº¦æ…¢ï¼Œå› ä¸ºtitleå­—æ®µæ²¡æœ‰ç´¢å¼•ï¼ŒæŸ¥è¯¢æ•ˆç‡ä½ï¼Œåˆ›å»ºä¸»é”®å³è‡ªåŠ¨ç”Ÿæˆä¸»é”®ç´¢å¼•ï¼›</span></span><br><span class="line"><span class="comment">#æŸ¥çœ‹SQLè¯­å¥çš„æ‰§è¡Œè®¡åˆ’ï¼š  </span></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_item <span class="keyword">where</span> title=<span class="string">'é˜¿å°”å¡ç‰¹'</span>\G;</span><br></pre></td></tr></table></figure><p>å¤„ç†æ–¹æ¡ˆï¼Œé’ˆå¯¹titleå­—æ®µï¼Œåˆ›å»ºç´¢å¼•ï¼š  </p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> idx_item_title <span class="keyword">on</span> tb_item(<span class="built_in">title</span>);</span><br></pre></td></tr></table></figure><p>ç´¢å¼•åˆ›å»ºå®Œæˆä¹‹åï¼Œå†æ¬¡æŸ¥è¯¢ï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_item <span class="keyword">where</span> title=<span class="string">'é˜¿å°”å¡ç‰¹'</span>\G;</span><br><span class="line"><span class="comment"># åˆ›å»ºç´¢å¼•çš„è¿‡ç¨‹ä¸­ï¼Œmysqlåœ¨åšä»€ä¹ˆï¼Ÿè¡¨tb_itemä¸­æœ‰300ä¸‡æ¡è®°å½•ï¼Œé‚£ä¹ˆåœ¨åˆ›å»ºç´¢å¼•çš„æ—¶å€™å°±ä¼šå¯¹è¿™300ä¸‡æ¡è®°å½•é‡å»ºç´¢å¼•ï¼›æ‰€ä»¥æ­¤æ—¶å³æ•°æ®åº“åº•å±‚åœ¨é‡å»ºç´¢å¼•ï¼›åˆ›å»ºå®Œç´¢å¼•ä¹‹åå†è¿›è¡ŒæŸ¥è¯¢æ•ˆç‡åˆ™å˜å¿«ï¼›ç´¢å¼•æ˜¯ä¼˜åŒ–æŸ¥è¯¢æœ€æœ‰æ•ˆçš„æ–¹å¼ä¹‹ä¸€ï¼›</span></span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢é€Ÿåº¦å¾ˆå¿«ï¼Œæ¥è¿‘0sï¼Œä¸»è¦çš„åŸå› æ˜¯å› ä¸ºidä¸ºä¸»é”®ï¼Œæœ‰ç´¢å¼•ï¼›  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_item <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">1999</span>\G;</span><br></pre></td></tr></table></figure><p><strong>å‡†å¤‡ç¯å¢ƒ</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="string">'tb_seller'</span>(</span><br><span class="line">  <span class="string">'sellerid'</span> <span class="built_in">varchar</span>(<span class="number">100</span>),</span><br><span class="line">  <span class="string">'name'</span> <span class="built_in">varchar</span>(<span class="number">100</span>),</span><br><span class="line">  <span class="string">'nickname'</span> <span class="built_in">varchar</span>(<span class="number">50</span>),</span><br><span class="line">  <span class="string">'password'</span> <span class="built_in">varchar</span>(<span class="number">60</span>),</span><br><span class="line">  <span class="string">'status'</span> <span class="built_in">varchar</span>(<span class="number">1</span>),</span><br><span class="line">  <span class="string">'address'</span> <span class="built_in">varchar</span>(<span class="number">100</span>),</span><br><span class="line">  <span class="string">'createtime'</span> datetime,</span><br><span class="line">  primary <span class="keyword">key</span>(<span class="string">'sellerid'</span>)</span><br><span class="line">)<span class="keyword">engine</span>=<span class="keyword">innodb</span> <span class="keyword">default</span> <span class="keyword">charset</span>=utf8mb4;</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ’å…¥è®°å½• å¯¼å…¥åŸºæœ¬æ•°æ®</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_seller <span class="keyword">values</span> ......</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºè”åˆç´¢å¼•</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> idx_seller_name_sta_addr <span class="keyword">on</span> tb_seller(<span class="keyword">name</span>,<span class="keyword">status</span>,address);</span><br></pre></td></tr></table></figure><p>åˆ›å»ºäº†ç´¢å¼•å¹¶ä¸æ˜¯ä¸€å®šä¼šæé«˜æ•ˆç‡ï¼›åˆ›å»ºäº†ç´¢å¼•å¹¶ä¸”éœ€è¦åˆç†è¿ç”¨ç´¢å¼•æ‰èƒ½å¤Ÿæé«˜æŸ¥è¯¢æ•ˆç‡ï¼›  </p><h2 id="ç´¢å¼•çš„ä½¿ç”¨-å…¨å€¼åŒ¹é…"><a href="#ç´¢å¼•çš„ä½¿ç”¨-å…¨å€¼åŒ¹é…" class="headerlink" title="ç´¢å¼•çš„ä½¿ç”¨ - å…¨å€¼åŒ¹é…"></a>ç´¢å¼•çš„ä½¿ç”¨ - å…¨å€¼åŒ¹é…</h2><p><strong>é¿å…ç´¢å¼•å¤±æ•ˆ</strong>  </p><p><strong>(1)</strong> <strong>å…¨å€¼åŒ¹é…</strong>ï¼Œ<strong>å¯¹ç´¢å¼•ä¸­æ‰€æœ‰åˆ—éƒ½æŒ‡å®šå…·ä½“å€¼</strong>ã€‚<br>è¯¥æƒ…å†µä¸‹ï¼Œç´¢å¼•ç”Ÿæ•ˆï¼Œæ‰§è¡Œæ•ˆç‡æé«˜ã€‚  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'å°ç±³ç§‘æŠ€'</span> <span class="keyword">and</span> <span class="keyword">status</span>=<span class="string">'1'</span> <span class="keyword">and</span> address=<span class="string">'åŒ—äº¬å¸‚'</span>\G;</span><br></pre></td></tr></table></figure><h2 id="ç´¢å¼•çš„ä½¿ç”¨-æœ€å·¦å‰ç¼€æ³•åˆ™"><a href="#ç´¢å¼•çš„ä½¿ç”¨-æœ€å·¦å‰ç¼€æ³•åˆ™" class="headerlink" title="ç´¢å¼•çš„ä½¿ç”¨ - æœ€å·¦å‰ç¼€æ³•åˆ™"></a>ç´¢å¼•çš„ä½¿ç”¨ - æœ€å·¦å‰ç¼€æ³•åˆ™</h2><p><strong>é¿å…ç´¢å¼•å¤±æ•ˆ</strong>  </p><p><strong>(2)</strong> <strong>æœ€å·¦å‰ç¼€æ³•åˆ™</strong><br>tb_selleråˆ›å»ºäº†ä¸€ä¸ªå¤åˆç´¢å¼•å³nameã€statusã€addressè¿™ä¸‰ä¸ªå­—æ®µï¼›<br>å¦‚æœç´¢å¼•äº†å¤šåˆ—ï¼Œè¦éµå®ˆ<strong>æœ€å·¦å‰ç¼€æ³•åˆ™</strong>ã€‚<br>æŒ‡çš„æ˜¯æŸ¥è¯¢<strong>ä» ç´¢å¼•çš„æœ€å·¦å‰åˆ— å¼€å§‹</strong>ï¼Œ<strong>å¹¶ä¸” ä¸è·³è¿‡ ç´¢å¼•ä¸­çš„åˆ—</strong>ã€‚<br><strong>åŒ¹é…æœ€å·¦å‰ç¼€æ³•åˆ™</strong>ï¼Œèµ°ç´¢å¼•ï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="keyword">name</span> =<span class="string">'å°ç±³ç§‘æŠ€'</span>;<span class="comment"># key:idx_name_sta_addrï¼› key_lenï¼š403</span></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'å°ç±³ç§‘æŠ€'</span> <span class="keyword">and</span> <span class="keyword">status</span>=<span class="string">'1'</span>;<span class="comment"># key:idx_name_sta_addrï¼› key_lenï¼š410</span></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'å°ç±³ç§‘æŠ€'</span> <span class="keyword">and</span> <span class="keyword">status</span>=<span class="string">'1'</span> <span class="keyword">and</span> address=<span class="string">'åŒ—äº¬å¸‚'</span>;<span class="comment"># key:idx_name_sta_addrï¼› key_lenï¼š813</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="keyword">status</span>=<span class="string">'1'</span> <span class="keyword">and</span> address=<span class="string">'åŒ—äº¬å¸‚'</span>;<span class="comment"># key:NULL key_lenï¼šNULL æ­¤æ—¶åˆ™ä¸å†èµ°ç´¢å¼•ï¼›å› ä¸ºä¸å†ç¬¦åˆæœ€å·¦å‰ç¼€æ³•åˆ™ï¼Œæ²¡æœ‰ä»¥æœ€å·¦è¾¹çš„åˆ—å¼€å§‹ï¼›  </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="keyword">status</span>=<span class="string">'1'</span> <span class="keyword">and</span> address=<span class="string">'åŒ—äº¬å¸‚'</span> <span class="keyword">and</span> <span class="keyword">name</span>=<span class="string">'å°ç±³ç§‘æŠ€'</span>;<span class="comment"># key:idx_name_sta_addrï¼› key_lenï¼š813 æ­¤æ—¶æ˜¯èµ°ç´¢å¼•çš„ï¼›ä¸whereåˆ—è¡¨å½“ä¸­å­—æ®µçš„å…ˆåé¡ºåºæ— å…³ï¼›ä¼šæ£€æŸ¥whereæ¡ä»¶åˆ—è¡¨ä¸­åŒ…ä¸åŒ…å«æœ€å·¦åˆ—ï¼›è€Œæ˜¯ä¸å¤åˆç´¢å¼•å½“ä¸­çš„æ˜¯å¦å­˜åœ¨æœ‰å¤åˆç´¢å¼•å½“ä¸­çš„æœ€å·¦å­—æ®µï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'å°ç±³ç§‘æŠ€'</span> <span class="keyword">and</span> address=<span class="string">'åŒ—äº¬å¸‚'</span> ;<span class="comment">#è·³è¿‡ç´¢å¼•åˆ—ä¸èµ°ç´¢å¼•; key:idx_sellter_name_sta_addrï¼›key_len: 403ï¼›æ­¤æ—¶ç´¢å¼•çš„é•¿åº¦æ˜¯403ï¼›ä¹Ÿå°±æ˜¯è¿™æ˜¯æ‰§è¡Œ explain select * from tb_seller where name ='å°ç±³ç§‘æŠ€'; æ—¶æ‰€èµ°çš„ç´¢å¼•ï¼›å³åé¢çš„ and address='åŒ—äº¬å¸‚' å¹¶æœªèµ°ç´¢å¼•ï¼›</span></span><br></pre></td></tr></table></figure><blockquote><p><strong>è¿åæœ€å·¦å‰ç¼€æ³•åˆ™ï¼Œç´¢å¼•å¤±æ•ˆ</strong>ï¼›<br><strong>éœ€è¦åŒ…å« å¤åˆç´¢å¼•å½“ä¸­çš„æœ€å·¦åˆ—</strong>ï¼Œå¹¶ä¸”<strong>ä¸èƒ½è·³è¿‡</strong> <strong>å¤åˆç´¢å¼•å½“ä¸­çš„æŸä¸€åˆ—</strong>è¿›è¡ŒæŸ¥è¯¢å¦åˆ™å¤åˆç´¢å¼•å¤±æ•ˆï¼›</p></blockquote><h2 id="ç´¢å¼•çš„ä½¿ç”¨-ç´¢å¼•å¤±æ•ˆæƒ…å†µï¼ˆèŒƒå›´æŸ¥è¯¢ã€å­—æ®µè¿ç®—ï¼‰"><a href="#ç´¢å¼•çš„ä½¿ç”¨-ç´¢å¼•å¤±æ•ˆæƒ…å†µï¼ˆèŒƒå›´æŸ¥è¯¢ã€å­—æ®µè¿ç®—ï¼‰" class="headerlink" title="ç´¢å¼•çš„ä½¿ç”¨ - ç´¢å¼•å¤±æ•ˆæƒ…å†µï¼ˆèŒƒå›´æŸ¥è¯¢ã€å­—æ®µè¿ç®—ï¼‰"></a>ç´¢å¼•çš„ä½¿ç”¨ - ç´¢å¼•å¤±æ•ˆæƒ…å†µï¼ˆèŒƒå›´æŸ¥è¯¢ã€å­—æ®µè¿ç®—ï¼‰</h2><p><strong>é¿å…ç´¢å¼•å¤±æ•ˆ</strong>  </p><p><strong>ï¼ˆ3ï¼‰</strong> <strong>èŒƒå›´æŸ¥è¯¢å³è¾¹çš„åˆ—</strong>ï¼Œ<strong>ä¸èƒ½ä½¿ç”¨ç´¢å¼•</strong>ï¼›<br>æ ¹æ®å‰é¢çš„ä¸¤ä¸ªå­—æ®µnameã€statusæŸ¥è¯¢æ˜¯èµ°ç´¢å¼•çš„ï¼Œä½†æ˜¯æœ€åä¸€ä¸ªæ¡ä»¶addressæ²¡æœ‰ç”¨åˆ°ç´¢å¼•ã€‚  </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">explain select * <span class="keyword">from</span> tb_seller where <span class="attribute">name</span>=<span class="string">'å°ç±³ç§‘æŠ€'</span> <span class="keyword">and</span> <span class="attribute">status</span>=<span class="string">'1'</span> <span class="keyword">and</span> <span class="attribute">address</span>=<span class="string">'åŒ—äº¬å¸‚'</span>;# key:idx_name_sta_addrï¼› key_lenï¼š813ï¼›æ­¤æ—¶ä¸‰ä¸ªå­—æ®µnameã€statusã€addressä¸‰ä¸ªå­—æ®µéƒ½èµ°äº†ç´¢å¼•ï¼›  </span><br><span class="line"></span><br><span class="line">explain select * <span class="keyword">from</span> tb_seller where name =<span class="string">'å°ç±³ç§‘æŠ€'</span> <span class="keyword">and</span> status &gt;<span class="string">'1'</span> <span class="keyword">and</span><span class="built_in"> address </span>=<span class="string">'åŒ—äº¬å¸‚'</span>;# key:idx_name_sta_addrï¼› key_lenï¼š410;æ­¤æ—¶èµ°çš„ç´¢å¼•æ˜¯nameå’Œstatuså­—æ®µçš„ç´¢å¼•ï¼›è€ŒèŒƒå›´æŸ¥è¯¢status&gt;<span class="string">'1'</span>ä¹‹åçš„addresså¹¶æ²¡æœ‰èµ°ç´¢å¼•ï¼›  </span><br><span class="line"><span class="comment"># èŒƒå›´æŸ¥è¯¢ä¹‹åçš„ç´¢å¼•å­—æ®µå°†å¤±æ•ˆ</span></span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ4ï¼‰</strong> ä¸è¦åœ¨<strong>ç´¢å¼•åˆ—</strong>ä¸Š<strong>è¿›è¡Œè¿ç®—æ“ä½œ</strong>ï¼Œç´¢å¼•å°†å¤±æ•ˆï¼›  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_seller;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_seller  <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'å°ç±³ç§‘æŠ€'</span>;<span class="comment">#æ­¤æ—¶èµ°ç´¢å¼•</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="keyword">substring</span>(<span class="keyword">name</span>,<span class="number">3</span>,<span class="number">2</span>)=<span class="string">'ç§‘æŠ€'</span>;</span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="keyword">substring</span>(<span class="keyword">name</span>,<span class="number">3</span>,<span class="number">2</span>)=<span class="string">'ç§‘æŠ€'</span>;<span class="comment">#æ­¤æ—¶keyä¸ºnullä»¥åŠkey_lenä¸ºnullï¼›è€Œtypeä¸ºALLåˆ™è¯´æ˜äº†è¿›è¡Œäº†å…¨è¡¨æ‰«æï¼›æ²¡æœ‰èµ°ç´¢å¼•</span></span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ5ï¼‰</strong> <strong>å­—ç¬¦ä¸²ä¸åŠ å•å¼•å·</strong>ï¼Œä¼šé€ æˆç´¢å¼•å¤±æ•ˆï¼›  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'ç§‘æŠ€'</span> <span class="keyword">and</span> <span class="keyword">status</span>=<span class="string">'0'</span>;<span class="comment"># æ­¤æ—¶key:idx_name_sta_addrï¼›key_lenï¼š410ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'ç§‘æŠ€'</span> <span class="keyword">and</span> <span class="keyword">status</span>=<span class="number">0</span>;<span class="comment"># æ­¤æ—¶keyï¼šidx_name_sta_addrï¼›key_lenï¼š403ï¼›ç´¢å¼•é•¿åº¦ä¸º403ï¼›åˆ™è¯´æ˜èµ°çš„ç´¢å¼•ä¸ºnameå­—æ®µçš„ç´¢å¼•ï¼›è€Œstatuså­—æ®µçš„ç´¢å¼•å¹¶æ²¡æœ‰èµ°ï¼›é€ æˆäº†status=0 è¯¥ç´¢å¼•å­—æ®µçš„å¤±æ•ˆï¼›å½“statuså­—æ®µå–å€¼æ²¡æœ‰åŠ å•å¼•å·æ—¶ï¼Œmysqlåº•å±‚æ£€æµ‹åˆ°statuså­—æ®µä¸ºvarcharç±»å‹æ‰€ä»¥ä¼šå¯¹å…¶æ²¡æœ‰åŠ å•å¼•å·çš„å–å€¼è¿›è¡Œéšå¼ç±»å‹è½¬æ¢ï¼›éšå¼ç±»å‹è½¬æ¢äº†ä¹‹åè¯¥statusç´¢å¼•å­—æ®µå°±å¤±æ•ˆäº†ï¼›å› ä¸ºåº•å±‚å¯¹è¯¥å­—æ®µè¿›è¡Œäº†è¿ç®—æ“ä½œï¼›</span></span><br></pre></td></tr></table></figure><h2 id="ç´¢å¼•çš„ä½¿ç”¨-è¦†ç›–ç´¢å¼•"><a href="#ç´¢å¼•çš„ä½¿ç”¨-è¦†ç›–ç´¢å¼•" class="headerlink" title="ç´¢å¼•çš„ä½¿ç”¨ - è¦†ç›–ç´¢å¼•"></a>ç´¢å¼•çš„ä½¿ç”¨ - è¦†ç›–ç´¢å¼•</h2><p><strong>é¿å…ç´¢å¼•å¤±æ•ˆ</strong>  </p><p><strong>ï¼ˆ6ï¼‰</strong> <strong>å°½é‡ä½¿ç”¨è¦†ç›–ç´¢å¼•</strong>ï¼Œ<strong>é¿å…ä½¿ç”¨ select *</strong>  </p><p><strong>å°½é‡ä½¿ç”¨è¦†ç›–ç´¢å¼•</strong>ï¼ˆåªè®¿é—®ç´¢å¼•çš„æŸ¥è¯¢ï¼ˆç´¢å¼•åˆ—å®Œå…¨åŒ…å«æŸ¥è¯¢åˆ—ï¼‰ï¼‰ï¼Œ <strong>å‡å°‘select *</strong> ï¼›  </p><p>å¦‚æœæŸ¥è¯¢åˆ—ï¼Œ<strong>è¶…å‡ºç´¢å¼•åˆ—</strong>ï¼Œä¹Ÿä¼š<strong>é™ä½æ€§èƒ½</strong>ï¼›  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="keyword">name</span> =<span class="string">'å°ç±³ç§‘æŠ€'</span>;</span><br><span class="line"><span class="comment"># extraä¸ºusing index conditionæŒ‡çš„æ˜¯ï¼šåœ¨æŸ¥è¯¢çš„æ—¶å€™ç¡®å®ç”¨åˆ°äº†nameè¿™ä¸ªå­—æ®µçš„ç´¢å¼•ï¼›</span></span><br><span class="line"><span class="comment">#ä½†æ˜¯ç”¨åˆ°äº†nameè¿™ä¸ªå­—æ®µçš„ç´¢å¼•ä¿¡æ¯ä¹‹åï¼Œåœ¨è¿”å›æ•°æ®çš„æ—¶å€™è¿˜éœ€è¦è¿›è¡Œç´¢å¼•å›è°ƒæŸ¥è¯¢ï¼›  </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> <span class="keyword">name</span> , <span class="keyword">status</span> ,address <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'å°ç±³ç§‘æŠ€'</span>;</span><br><span class="line"><span class="comment"># æ­¤æ—¶extraä¸ºusing where ;using indexï¼›</span></span><br><span class="line"><span class="comment"># æ­¤æ—¶è¡¨ç¤ºçš„æ˜¯ï¼šå¯ä»¥é€šè¿‡ç´¢å¼•è¿›è¡ŒæŸ¥è¯¢ï¼›ä½†æ˜¯æ­¤æ—¶å¹¶ä¸éœ€è¦è¿›è¡Œå›è°ƒæŸ¥è¯¢äº†ï¼›</span></span><br><span class="line"><span class="comment"># åŸå› å°±åœ¨äºæŸ¥è¯¢çš„å­—æ®µåœ¨ç´¢å¼•ç»“æ„å½“ä¸­å·²ç»è¢«è®°å½•äº†ï¼›</span></span><br><span class="line"><span class="comment"># æ‰€ä»¥å¹¶ä¸éœ€è¦å»è¿›è¡Œå›è°ƒæŸ¥è¯¢ï¼›  </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> <span class="keyword">name</span> , <span class="keyword">status</span>  <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'å°ç±³ç§‘æŠ€'</span>; <span class="comment">#åŒä¸Š</span></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> <span class="keyword">name</span> ,  address <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'å°ç±³ç§‘æŠ€'</span>; <span class="comment">#åŒä¸Š</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> <span class="keyword">name</span> ,  address ,<span class="keyword">password</span> <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'å°ç±³ç§‘æŠ€'</span>;</span><br><span class="line"><span class="comment"># å¤åˆç´¢å¼•å½“ä¸­å¹¶æœªåŒ…æ‹¬passwordå­—æ®µåˆ™æ­¤æ—¶nameç´¢å¼•å­—æ®µä»¥åŠaddressç´¢å¼•å­—æ®µå½“ä¸­å¹¶æ²¡æœ‰åŒ…æ‹¬passwordå­—æ®µçš„ä¿¡æ¯ï¼Œ</span></span><br><span class="line"><span class="comment"># åˆ™æ­¤æ—¶éœ€è¦å»å›è°ƒæŸ¥è¯¢passwordå­—æ®µçš„ä¿¡æ¯ï¼›</span></span><br><span class="line"><span class="comment"># å³extraä¸ºusing index_condition</span></span><br></pre></td></tr></table></figure><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">TIP:  </span></span><br><span class="line">ç´¢å¼•å›è°ƒæŸ¥è¯¢æŒ‡çš„æ˜¯ï¼š  </span><br><span class="line"><span class="code">    using index : ä½¿ç”¨è¦†ç›–ç´¢å¼•çš„æ—¶å€™å°±ä¼šå‡ºç°</span></span><br><span class="line"><span class="code">    using where : åœ¨æŸ¥æ‰¾ä½¿ç”¨ç´¢å¼•çš„æƒ…å†µä¸‹ï¼Œéœ€è¦å›è¡¨å»æŸ¥è¯¢æ‰€éœ€çš„æ•°æ®</span></span><br><span class="line"><span class="code">    using index condition ï¼šæŸ¥æ‰¾ä½¿ç”¨äº†ç´¢å¼•ï¼Œä½†æ˜¯éœ€è¦å›è¡¨æŸ¥è¯¢æ•°æ®ï¼ˆä»ç´¢å¼•å½“ä¸­æ‹¿åˆ°äº†æ•°æ®ï¼Œç„¶åå†åˆ°è¡¨ç»“æ„å½“ä¸­å»æ‹¿åˆ°è¯¥æ•°æ®å¯¹åº”çš„ä¸€æ•´è¡Œæ•°æ®ï¼Œå› ä¸ºè¯¥nameç´¢å¼•å­—æ®µå¹¶æ²¡æœ‰è®°å½•æ‰€æœ‰çš„æ•°æ®ï¼Œåªæ˜¯è®°å½•äº†é‚£ä¹ˆå­—æ®µçš„æ•°æ®ï¼›æ‰€ä»¥éœ€è¦å›è¡¨æŸ¥è¯¢æ•°æ®ï¼›å³ç”¨äº†ç´¢å¼•è¿˜éœ€è¦å›è°ƒæŸ¥è¯¢ï¼‰</span></span><br><span class="line"><span class="code">    using index ; using where : æŸ¥æ‰¾ä½¿ç”¨äº†ç´¢å¼•ï¼Œä½†æ˜¯éœ€è¦çš„æ•°æ®éƒ½åœ¨ç´¢å¼•åˆ—ä¸­èƒ½æ‰¾åˆ°ï¼Œç´¢å¼•ä¸éœ€è¦å›è¡¨æŸ¥è¯¢æ•°æ®</span></span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ7ï¼‰</strong> <strong>inèµ°ç´¢å¼•ï¼Œnot in ç´¢å¼•å¤±æ•ˆ</strong></p><h2 id="ç´¢å¼•çš„ä½¿ç”¨-orç´¢å¼•å¤±æ•ˆæƒ…å†µ"><a href="#ç´¢å¼•çš„ä½¿ç”¨-orç´¢å¼•å¤±æ•ˆæƒ…å†µ" class="headerlink" title="ç´¢å¼•çš„ä½¿ç”¨ - orç´¢å¼•å¤±æ•ˆæƒ…å†µ"></a>ç´¢å¼•çš„ä½¿ç”¨ - orç´¢å¼•å¤±æ•ˆæƒ…å†µ</h2><p><strong>é¿å…ç´¢å¼•å¤±æ•ˆ</strong><br>ï¼ˆ7ï¼‰ç”¨oråˆ†éš”å¼€çš„æ¡ä»¶ï¼Œå¦‚æœorå‰çš„æ¡ä»¶ä¸­çš„åˆ—æœ‰ç´¢å¼•ï¼Œè€Œåé¢çš„åˆ—ä¸­æ²¡æœ‰ç´¢å¼•ï¼Œé‚£ä¹ˆæ¶‰åŠçš„ç´¢å¼•éƒ½ä¸ä¼šè¢«ç”¨åˆ°ï¼›  </p><p>ç¤ºä¾‹ï¼šnameå­—æ®µæ˜¯ç´¢å¼•åˆ—ï¼Œè€Œcreatetimeä¸æ˜¯ç´¢å¼•åˆ—ï¼Œä¸­é—´æ˜¯orè¿›è¡Œè¿æ¥æ˜¯ä¸èµ°ç´¢å¼•çš„ï¼›  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_seller;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'å°ç±³ç§‘æŠ€'</span> <span class="keyword">and</span> createtime=<span class="string">'2088-01-01 12:00:00'</span>\G;<span class="comment">#key:idx_name_sta_addrï¼› key_len: 403;æ­¤æ—¶èµ°ç´¢å¼•</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'å°ç±³ç§‘æŠ€'</span> <span class="keyword">or</span> createtime=<span class="string">'2088-01-01 12:00:00'</span>\G;<span class="comment">#key:idx_name_sta_addrï¼› key_len: NULL</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'å°ç±³ç§‘æŠ€'</span> <span class="keyword">and</span> nickname=<span class="string">'å°ç±³å®˜æ–¹æ——èˆ°åº—'</span>;<span class="comment">#æ­¤æ—¶èµ°ç´¢å¼•ï¼›key_len:403;èµ°çš„æ˜¯nameå­—æ®µçš„ç´¢å¼•</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'å°ç±³ç§‘æŠ€'</span> <span class="keyword">or</span> nickname=<span class="string">'å°ç±³å®˜æ–¹æ——èˆ°åº—'</span>;<span class="comment">#æ¢æˆorä¹‹åï¼Œnicknameå­—æ®µéç´¢å¼•å­—æ®µï¼›æ‰€ä»¥æ­¤æ—¶å°†å…¨è¡¨æ‰«æï¼›ä¸ä¼šèµ°ç´¢å¼•ï¼›key_len:NULLï¼›ä»¥åŠtypeä¸ºALL</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># orä¹‹åçš„å­—æ®µå¦‚æœæ²¡æœ‰ç´¢å¼•çš„è¯ï¼›é‚£ä¹ˆæ•´ä¸ªwhereåˆ—è¡¨å½“ä¸­å³ä¾¿æœ‰ç´¢å¼•å­—æ®µä¹Ÿå°†éƒ½å¤±æ•ˆï¼Œä¸å†èµ°ç´¢å¼•ï¼›</span></span><br></pre></td></tr></table></figure><h2 id="ç´¢å¼•çš„ä½¿ç”¨-likeæ¨¡ç³ŠåŒ¹é…"><a href="#ç´¢å¼•çš„ä½¿ç”¨-likeæ¨¡ç³ŠåŒ¹é…" class="headerlink" title="ç´¢å¼•çš„ä½¿ç”¨ - likeæ¨¡ç³ŠåŒ¹é…"></a>ç´¢å¼•çš„ä½¿ç”¨ - likeæ¨¡ç³ŠåŒ¹é…</h2><p><strong>é¿å…ç´¢å¼•å¤±æ•ˆ</strong>  </p><p><strong>ï¼ˆ8ï¼‰</strong> <strong>ä»¥%å¼€å¤´çš„Likeæ¨¡ç³ŠæŸ¥è¯¢</strong>ï¼Œç´¢å¼•å¤±æ•ˆã€‚  </p><p>å¦‚æœä»…ä»…æ˜¯å°¾éƒ¨æ¨¡ç³ŠæŸ¥è¯¢ï¼Œç´¢å¼•ä¸ä¼šå¤±æ•ˆã€‚<br>å¦‚æœæ˜¯å¤´éƒ¨æ¨¡ç³ŠæŸ¥è¯¢åŒ¹é…ï¼Œåˆ™ç´¢å¼•å¤±æ•ˆã€‚  </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="type">name</span> <span class="keyword">like</span> <span class="string">'å°ç±³ç§‘æŠ€'</span>;#key: idx_name_sta_addrï¼› key_len: <span class="number">403</span>; æ­¤æ—¶èµ°ç´¢å¼•ï¼›ç´¢å¼•èµ°çš„æ˜¯<span class="type">name</span>å­—æ®µ</span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="type">name</span> <span class="keyword">like</span> <span class="string">'%å°ç±³ç§‘æŠ€'</span>;#key: <span class="keyword">NULL</span>ï¼› key_len: <span class="keyword">NULL</span>; æ­¤æ—¶ä¸èµ°ç´¢å¼•ï¼›ä¸”<span class="keyword">type</span>ä¸º<span class="keyword">ALL</span>ï¼›å…¨è¡¨æ‰«æ</span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="type">name</span> <span class="keyword">like</span> <span class="string">'%å°ç±³ç§‘æŠ€%'</span>;#key: <span class="keyword">NULL</span>ï¼› key_len: <span class="keyword">NULL</span>; æ­¤æ—¶ä¸èµ°ç´¢å¼•ï¼›ä¸”<span class="keyword">type</span>ä¸º<span class="keyword">ALL</span>ï¼›å…¨è¡¨æ‰«æ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="type">name</span> <span class="keyword">like</span> <span class="string">'ç§‘æŠ€%'</span>;#key: idx_name_sta_addrï¼› key_len: <span class="number">403</span>; æ­¤æ—¶èµ°ç´¢å¼•ï¼›ç´¢å¼•èµ°çš„æ˜¯<span class="type">name</span>å­—æ®µ</span><br></pre></td></tr></table></figure><p>ç±»ä¼¼ â€œ%ç§‘æŠ€%â€ è¿™ç§æƒ…å†µåœ¨ä¸šåŠ¡é€»è¾‘å¤„ç†å½“ä¸­è¿˜æ˜¯æ¯”è¾ƒå¤šçš„ï¼›ä½†æ˜¯è¿™æ ·æ•ˆç‡å°†ååˆ†ä½ä¸‹ï¼›æ‰€ä»¥é’ˆå¯¹è¿™ç§æƒ…å†µçš„å¤„ç†æ–¹å¼ä¸ºï¼š<br>è¦†ç›–ç´¢å¼•ï¼šè¦†ç›–ç´¢å¼•æŒ‡çš„æ˜¯ï¼Œå°½é‡ä¸è¦ä½¿ç”¨select * è¿™ç§æ–¹å¼è¿›è¡ŒæŸ¥è¯¢ï¼›è€Œæ˜¯ä½¿ç”¨å¤åˆç´¢å¼•å½“ä¸­çš„é‚£äº›ç´¢å¼•åˆ—ï¼Œå³ç´¢å¼•å­—æ®µï¼›å³å¤åˆç´¢å¼•ä¸ºidx_name_sta_addrï¼Œå½“ä¸­åŒ…å«çš„ç´¢å¼•å­—æ®µä¸ºnameã€statusã€addressï¼›æ‰€ä»¥select æŸ¥è¯¢åˆ—åç§°çš„æ—¶å€™å°½é‡æŸ¥è¯¢çš„åˆ—åç§°ä¸ºå¤åˆç´¢å¼•å½“ä¸­çš„ç´¢å¼•åˆ—ï¼Œæˆ–è€…æ˜¯å…¶ä»–ç´¢å¼•çš„å­—æ®µï¼ˆä¾‹å¦‚å”¯ä¸€ç´¢å¼•çš„ç´¢å¼•å­—æ®µã€ä¸»é”®ç´¢å¼•çš„ç´¢å¼•å­—æ®µç­‰ï¼‰ï¼›<br>å³é€šè¿‡è¦†ç›–ç´¢å¼•å°±å¯ä»¥è§£å†³ â€œ%ç§‘æŠ€%â€ likeæ¨¡ç³ŠæŸ¥è¯¢æ•ˆç‡ä½ä¸‹çš„æƒ…å†µï¼ˆæ¡ä»¶æ˜¯select æŸ¥è¯¢çš„å­—æ®µéƒ½éœ€è¦æ˜¯ç´¢å¼•å­—æ®µï¼Œå¦‚æœå‡ºç°äº†æŸ¥è¯¢éç´¢å¼•å­—æ®µåˆ™å°†ä¸å†èµ°ç´¢å¼•ï¼‰ï¼›  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> sellerid <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="keyword">name</span> <span class="keyword">like</span> <span class="string">'%ç§‘æŠ€%'</span>;<span class="comment"># åˆ™æ­¤æ—¶æ˜¯èµ°ç´¢å¼•çš„ï¼›key:idx_seller_name_sta_addrï¼›key_lenï¼š813ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> sellerid,<span class="keyword">name</span> <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="keyword">name</span> <span class="keyword">like</span> <span class="string">'%ç§‘æŠ€%'</span>;<span class="comment"># åˆ™æ­¤æ—¶æ˜¯èµ°ç´¢å¼•çš„ï¼›key:idx_seller_name_sta_addrï¼›key_lenï¼š813ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> sellerid,<span class="keyword">name</span>,<span class="keyword">status</span>,address <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="keyword">name</span> <span class="keyword">like</span> <span class="string">'%ç§‘æŠ€%'</span>;<span class="comment"># åˆ™æ­¤æ—¶æ˜¯èµ°ç´¢å¼•çš„ï¼›key:idx_seller_name_sta_addrï¼›key_lenï¼š813ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> sellerid,<span class="keyword">name</span>,<span class="keyword">status</span>,address,<span class="keyword">password</span> <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="keyword">name</span> <span class="keyword">like</span> <span class="string">'%ç§‘æŠ€%'</span>;<span class="comment"># åˆ™æ­¤æ—¶æ˜¯ä¸èµ°ç´¢å¼•çš„ï¼Œç”±äºpasswordå­—æ®µå¹¶ä¸æ˜¯ç´¢å¼•å­—æ®µï¼Œæ‰€ä»¥å°†é€ æˆä¸ä¼šèµ°ç´¢å¼•çš„å±€é¢ï¼›key:NULLï¼›key_lenï¼šNULLï¼›</span></span><br></pre></td></tr></table></figure><h2 id="ç´¢å¼•çš„ä½¿ç”¨-å…¨è¡¨æ‰«ææ›´å¿«"><a href="#ç´¢å¼•çš„ä½¿ç”¨-å…¨è¡¨æ‰«ææ›´å¿«" class="headerlink" title="ç´¢å¼•çš„ä½¿ç”¨ - å…¨è¡¨æ‰«ææ›´å¿«"></a>ç´¢å¼•çš„ä½¿ç”¨ - å…¨è¡¨æ‰«ææ›´å¿«</h2><p><strong>é¿å…ç´¢å¼•å¤±æ•ˆ</strong>  </p><p><strong>ï¼ˆ9ï¼‰</strong> å¦‚æœ<strong>MySQLè¯„ä¼°</strong>ä½¿ç”¨ç´¢å¼•æ¯”å…¨è¡¨æ›´æ…¢ï¼Œåˆ™ä¸ä½¿ç”¨ç´¢å¼•ï¼›  </p><p>å¦‚æœå‘ç°èµ°å…¨è¡¨æ‰«ææ¯”èµ°ç´¢å¼•è¦å¿«ï¼Œè¿™ä¸ªæ—¶å€™mysqlå°±ä¼šèµ°å…¨è¡¨æ‰«æï¼›</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_seller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> address=<span class="string">'åŒ—äº¬å¸‚'</span>;<span class="comment">#æ­¤æ—¶key:NULL ä»¥åŠkey_len: NULLï¼›ç”±äºaddressæ˜¯å¤åˆç´¢å¼•å½“ä¸­çš„ç´¢å¼•å­—æ®µä½†æ˜¯åˆä¸æ»¡è¶³æœ€å·¦å‰ç¼€æ³•åˆ™ï¼›æ‰€ä»¥ä¸èµ°ç´¢å¼•ï¼›  </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> idx_seller_address <span class="keyword">on</span> tb_seller(address);<span class="comment">#åœ¨tb_sellerè¡¨ä¸­çš„addresså­—æ®µä¸Šå»ºç«‹ç´¢å¼•ï¼›å•åˆ—ç´¢å¼•</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> address=<span class="string">'åŒ—äº¬å¸‚'</span>;<span class="comment"># ä½†æ˜¯æ­¤æ—¶ä»ç„¶æ²¡æœ‰èµ°ç´¢å¼•ï¼›possible_keyå‡ºç°æœ‰idx_seller_addressï¼›ä½†æ˜¯keyä¸ºNULLï¼›ä»¥åŠkey_lenä¸ºNULLï¼›typeä¸ºALLï¼›å³èµ°çš„è¿˜æ˜¯å…¨è¡¨æ‰«æ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> address=<span class="string">'è¥¿å®‰å¸‚'</span>;<span class="comment">#æ­¤æ—¶æ˜¯èµ°ç´¢å¼•çš„ï¼Œkeyä¸ºidx_addressï¼›key_lenä¸º403;ç´¢å¼•èµ°çš„æ˜¯addresså­—æ®µï¼›extraä¸ºusing index condition</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#åŒæ ·ä¸€æ¡SQLè¯­å¥ï¼Œåªæ˜¯ä¼ å…¥çš„å‚æ•°ä¸åŒï¼›ä¹Ÿå°±å¯¼è‡´äº†æ˜¯å¦èµ°ç´¢å¼•çš„ä¸åŒï¼›ä¸€ä¸ªæ˜¯å…¨è¡¨æ‰«ææ²¡æœ‰èµ°ç´¢å¼•ï¼›è€Œå¦å¤–ä¸€ä¸ªæ˜¯èµ°äº†ç´¢å¼•idx_seller_addressï¼›  </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#åŸå› å°±åœ¨äºï¼šè¿™ä¸ªä¸æ•°æ®åº“å½“ä¸­çš„æ•°æ®æ˜¯å­˜åœ¨ä¸€å®šçš„å…³ç³»çš„ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_seller; <span class="comment">#è¯¥è¡¨å½“ä¸­ä¸€å…±æœ‰12æ¡è®°å½•ï¼›è¿™12æ¡è®°å½•å½“ä¸­å‡ºç°æœ‰addressä¸ºâ€œåŒ—äº¬å¸‚â€çš„è®°å½•è¡Œæ•°å°±æœ‰11æ¡è®°å½•ï¼›åªæœ‰ä¸€æ¡æ˜¯1æ¡æ˜¯â€œè¥¿å®‰å¸‚â€ï¼›  </span></span><br><span class="line"><span class="comment">#å¦‚æœæ•°æ®é‡å¤§ï¼Œä¸”ç²¾ç¡®æŸ¥è¯¢çš„å†…å®¹åˆåœ¨è¡¨ä¸­å æ¯”å¤§ï¼›æ­¤æ—¶å°±ææœ‰å¯èƒ½èµ°çš„æ˜¯å…¨è¡¨æ‰«æè€Œéèµ°ç´¢å¼•äº†ï¼›é€Ÿåº¦æ›´å¿«</span></span><br></pre></td></tr></table></figure><h2 id="ç´¢å¼•çš„ä½¿ç”¨-NULLå€¼çš„åˆ¤å®š"><a href="#ç´¢å¼•çš„ä½¿ç”¨-NULLå€¼çš„åˆ¤å®š" class="headerlink" title="ç´¢å¼•çš„ä½¿ç”¨ - NULLå€¼çš„åˆ¤å®š"></a>ç´¢å¼•çš„ä½¿ç”¨ - NULLå€¼çš„åˆ¤å®š</h2><p><strong>é¿å…ç´¢å¼•å¤±æ•ˆ</strong>  </p><p><strong>ï¼ˆ10ï¼‰</strong> <strong>is NULLï¼Œis  NOT NULL</strong>  <strong><span style="color:red;">æœ‰æ—¶</span></strong> ç´¢å¼•å¤±æ•ˆï¼›  </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">index</span> <span class="keyword">from</span> tb_seller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> address <span class="keyword">is</span> <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">explain</span>  <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> address <span class="keyword">is</span> <span class="keyword">null</span>;</span><br><span class="line"># æ­¤æ—¶æ˜¯èµ°ç´¢å¼•çš„ï¼›keyï¼šidx_seller_address ;key_lenï¼š<span class="number">403</span> èµ°çš„ç´¢å¼•å­—æ®µä¸ºaddress</span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span>  <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> address <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>;</span><br><span class="line"># æ­¤æ—¶æ˜¯æ²¡æœ‰èµ°ç´¢å¼•çš„ï¼›keyï¼š<span class="keyword">null</span> ;key_len:<span class="keyword">null</span>;<span class="keyword">type</span>:<span class="keyword">all</span> èµ°çš„æ˜¯å…¨è¡¨æ‰«æ</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_seller;</span><br><span class="line"># å½“å‰è¯¥è¡¨å½“ä¸­æ¯ä¸€æ¡è®°å½•éƒ½addresså­—æ®µè®°å½•å–å€¼éƒ½æ˜¯ <span class="keyword">not</span> <span class="keyword">null</span>;</span><br><span class="line"># å½“å‰<span class="keyword">explain</span> <span class="keyword">where</span> address <span class="keyword">is</span> <span class="keyword">null</span>æ—¶èµ°äº†ç´¢å¼•ï¼Œ</span><br><span class="line"># å³address <span class="keyword">is</span> <span class="keyword">null</span>è¿™æ ·çš„è®°å½•åœ¨è¡¨å½“ä¸­å æ¯”è¾ƒå°‘æ­¤æ—¶åˆ™èµ°ç´¢å¼•ï¼›</span><br><span class="line"># è€Œ<span class="keyword">explain</span> <span class="keyword">where</span> address <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>æ—¶æ²¡æœ‰èµ°ç´¢å¼•ï¼›</span><br><span class="line"># è€Œæ­¤æ—¶ address <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>åˆ™åœ¨è¡¨å½“ä¸­å æ¯”è¾ƒå¤šï¼›</span><br><span class="line"># æ‰€ä»¥å°±ä¸ä¼šå»èµ°ç´¢å¼•è€Œæ˜¯å…¨è¡¨æ‰«æï¼›</span><br><span class="line"># è¿™ä¸ªä¸å‰é¢æ‰€è¯´çš„å…¨è¡¨æ‰«ææ›´å¿«æ˜¯ä¸€ä¸ªé“ç†ï¼›</span><br><span class="line"># å…¨è¡¨æ‰«æä¸èµ°ç´¢å¼•çš„è¿™ä¸¤ç§æ–¹å¼å“ªä¸€ç§æ›´å¿«å°±é€‰æ‹©å“ªä¸€ç§æ–¹å¼ï¼›</span><br><span class="line"># ä¹Ÿå°±æ˜¯è¯´mysqlåº•å±‚ä¼šå»è‡ªåŠ¨çš„åˆ¤æ–­å¦‚æœèµ°å…¨è¡¨æ‰«ææ›´å¿«å°±èµ°å…¨è¡¨æ‰«æï¼›</span><br><span class="line"># å¦‚æœèµ°ç´¢å¼•æ›´å¿«å°±èµ°ç´¢å¼•çš„è¿™ç§æ–¹å¼ï¼›  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="type">name</span> <span class="keyword">is</span> <span class="keyword">null</span>;</span><br><span class="line"># æ­¤æ—¶èµ°ç´¢å¼•ï¼›key:idx_name_sta_addrï¼›key_lenï¼š<span class="number">403</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="type">name</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>;</span><br><span class="line"># æ­¤æ—¶ä¸èµ°ç´¢å¼•ï¼›key:<span class="keyword">null</span>ï¼› key_lenï¼š<span class="keyword">null</span>; <span class="keyword">type</span>ï¼š<span class="keyword">ALL</span> èµ°çš„æ˜¯å…¨è¡¨æ‰«æ</span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">where</span> <span class="type">name</span> <span class="keyword">is</span> <span class="keyword">null</span>;</span><br><span class="line"># æ­¤æ—¶ä¸èµ°ç´¢å¼•ï¼›keyï¼š<span class="keyword">null</span>ï¼›key_len: <span class="keyword">null</span> ; <span class="keyword">type</span>:<span class="keyword">all</span> èµ°çš„æ˜¯å…¨è¡¨æ‰«æ</span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">where</span> <span class="type">name</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>;</span><br><span class="line"># æ­¤æ—¶èµ°äº†ç´¢å¼•ï¼›key:idx_name; key_len:<span class="number">138</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> t_user;</span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> t_user <span class="keyword">set</span> <span class="type">name</span> =<span class="keyword">null</span> <span class="keyword">where</span> id &lt;&gt; <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> t_user;</span><br><span class="line"># åˆ™æ­¤æ—¶é™¤äº†idä¸º<span class="number">1</span>çš„è®°å½•å…¶ä½™çš„è®°å½•çš„<span class="type">name</span>å­—æ®µå°±å˜æˆäº†<span class="keyword">null</span>ï¼›</span><br><span class="line"># æ‰€ä»¥å¦‚æœæ­¤æ—¶æŸ¥è¯¢t_userè¡¨å½“ä¸­<span class="type">name</span>å­—æ®µä¸º<span class="keyword">is</span> <span class="keyword">null</span>åˆ™èµ°å…¨è¡¨æ‰«æï¼›</span><br><span class="line"># è€ŒæŸ¥è¯¢<span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>åˆ™èµ°ç´¢å¼•ï¼›</span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">index</span> <span class="keyword">from</span> t_user;#æ­¤æ—¶åœ¨t_userè¡¨å½“ä¸­<span class="type">name</span>å­—æ®µæ˜¯å­˜åœ¨ç´¢å¼•çš„ï¼›</span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">where</span> <span class="type">name</span> <span class="keyword">is</span> <span class="keyword">null</span>;</span><br><span class="line"># key:<span class="keyword">null</span> ; key_len:<span class="keyword">null</span>;<span class="keyword">type</span>:<span class="keyword">all</span> èµ°çš„æ˜¯å…¨è¡¨æ‰«æï¼ˆåŸå› å°±åœ¨äºæ­¤æ—¶åœ¨è¡¨å½“ä¸­è®°å½•<span class="type">name</span>å­—æ®µä¸º<span class="keyword">null</span>å æ¯”å¤§äº<span class="type">name</span>å­—æ®µ<span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>ï¼›</span><br><span class="line"># æ‰€ä»¥å…¨è¡¨æ‰«æä¸èµ°ç´¢å¼•çš„æ–¹å¼è¿™ä¸¤è€…ç›¸æ¯”è¾ƒä¹‹ä¸‹ï¼Œå…¨è¡¨æ‰«ææ›´å¿«ï¼›ï¼‰</span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">where</span> <span class="type">name</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>;</span><br><span class="line"># æ­¤æ—¶æ˜¯èµ°ç´¢å¼•çš„ï¼›key:idx_user_name;key_len:<span class="number">138</span>;  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ä¹Ÿå°±æ˜¯è¯´<span class="keyword">is</span> <span class="keyword">null</span>ä¸<span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>ï¼›</span><br><span class="line"># æœ‰æ—¶æ˜¯ä¼šèµ°ç´¢å¼•çš„æœ‰æ—¶åˆä¸ä¼šèµ°ç´¢å¼•ï¼›</span><br><span class="line"># è¿™è¦åˆ†æƒ…å†µè€Œå®šï¼›</span><br><span class="line"># è¿™ä¸ªæ ¹æ®æ•°æ®åº“å½“ä¸­çš„æ•°æ®é‡æ¥å†³å®šçš„ï¼›</span><br><span class="line"># å¦‚æœæŸ¥è¯¢çš„å­—æ®µåœ¨æ•°æ®é‡å½“ä¸­çš„<span class="keyword">null</span>å€¼å æ¯”è¾ƒå¤š,é‚£ä¹ˆè¿™ä¸ªæ—¶å€™<span class="keyword">is</span> <span class="keyword">null</span>å°†ä¼šèµ°å…¨è¡¨æ‰«æè€Œ<span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>åˆ™èµ°ç´¢å¼•ï¼›</span><br><span class="line"># å¦‚æœæŸ¥è¯¢çš„å­—æ®µåœ¨æ•°æ®é‡å½“ä¸­ç»å¤§éƒ¨åˆ†éƒ½æ˜¯å­˜åœ¨æœ‰å€¼çš„ä¹Ÿå°±æ˜¯è¯´<span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>å æ®è¾ƒå¤šï¼›</span><br><span class="line"># åˆ™æ­¤æ—¶<span class="keyword">is</span> <span class="keyword">null</span>å°±ä¼šèµ°ç´¢å¼•ï¼›è€Œ<span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>åˆ™èµ°å…¨è¡¨æ‰«æï¼›</span><br></pre></td></tr></table></figure><h2 id="ç´¢å¼•çš„ä½¿ç”¨-inå’Œnot-in"><a href="#ç´¢å¼•çš„ä½¿ç”¨-inå’Œnot-in" class="headerlink" title="ç´¢å¼•çš„ä½¿ç”¨ - inå’Œnot in"></a>ç´¢å¼•çš„ä½¿ç”¨ - inå’Œnot in</h2><p><strong>é¿å…ç´¢å¼•å¤±æ•ˆ</strong>  </p><p><strong>ï¼ˆ11ï¼‰</strong> <strong>in èµ°ç´¢å¼•ï¼› not in ç´¢å¼•å¤±æ•ˆ</strong>ï¼›  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> sellerid <span class="keyword">in</span> (<span class="string">'oppo'</span>,<span class="string">'xiaomi'</span>,<span class="string">'sina'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> sellerid <span class="keyword">not</span> <span class="keyword">in</span> (<span class="string">'oppo'</span>,<span class="string">'xiaomi'</span>,<span class="string">'sina'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_seller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> sellerid <span class="keyword">in</span> (<span class="string">'oppo'</span>,<span class="string">'xiaomi'</span>,<span class="string">'sina'</span>);</span><br><span class="line"><span class="comment"># æ­¤æ—¶ä½¿ç”¨äº†ç´¢å¼•ï¼›key:PRIMARYï¼›key_len:402;  </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> sellerid <span class="keyword">not</span> <span class="keyword">in</span> (<span class="string">'oppo'</span>,<span class="string">'xiaomi'</span>,<span class="string">'sina'</span>);</span><br><span class="line"><span class="comment"># æ­¤æ—¶æœªèµ°ç´¢å¼•ï¼›ç´¢å¼•å¤±æ•ˆï¼›key:NULLï¼›key_len:NULLï¼›type:ALL å…¨è¡¨æ‰«æ</span></span><br></pre></td></tr></table></figure><h2 id="ç´¢å¼•çš„ä½¿ç”¨-å•åˆ—ç´¢å¼•ä¸å¤åˆç´¢å¼•é€‰æ‹©"><a href="#ç´¢å¼•çš„ä½¿ç”¨-å•åˆ—ç´¢å¼•ä¸å¤åˆç´¢å¼•é€‰æ‹©" class="headerlink" title="ç´¢å¼•çš„ä½¿ç”¨ - å•åˆ—ç´¢å¼•ä¸å¤åˆç´¢å¼•é€‰æ‹©"></a>ç´¢å¼•çš„ä½¿ç”¨ - å•åˆ—ç´¢å¼•ä¸å¤åˆç´¢å¼•é€‰æ‹©</h2><p><strong>é¿å…ç´¢å¼•å¤±æ•ˆ</strong>  </p><p><strong>ï¼ˆ12ï¼‰</strong> <strong>å•åˆ—ç´¢å¼• å’Œ å¤åˆç´¢å¼•</strong>  </p><p><strong>å°½é‡ä½¿ç”¨ å¤åˆç´¢å¼•ï¼Œè€Œå°‘é‡ä½¿ç”¨ å•åˆ—ç´¢å¼•</strong>ï¼›  </p><p>åˆ›å»ºå¤åˆç´¢å¼•ï¼š  </p><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">create <span class="built_in">index</span> idx_name_sta_address on tb_seller(<span class="keyword">name</span>,<span class="keyword">status</span>,address);</span><br><span class="line"></span><br><span class="line">å°±ç›¸å½“äºåˆ›å»ºäº†ä¸‰ä¸ªç´¢å¼•ï¼š  </span><br><span class="line">* <span class="keyword">name</span></span><br><span class="line">* <span class="keyword">name</span> + <span class="keyword">status</span></span><br><span class="line">* <span class="keyword">name</span> + <span class="keyword">status</span> + address</span><br></pre></td></tr></table></figure><p>åˆ›å»ºå•åˆ—ç´¢å¼•ï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> idx_seller_name <span class="keyword">on</span> tb_seller(<span class="keyword">name</span>);</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> idx_seller_status <span class="keyword">on</span> tb_seller(<span class="keyword">status</span>);</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> idx_seller_address <span class="keyword">on</span> tb_seller(address);</span><br></pre></td></tr></table></figure><p>å½“å¯¹nameã€statusã€addresså­—æ®µè¿›è¡Œæœç´¢çš„æ—¶å€™ï¼Œæ•°æ®åº“åªä¼šé€‰æ‹©ä¸€ä¸ªç´¢å¼•ï¼›<br>æ‰€ä»¥æ­¤æ—¶åœ¨è¿™ç§æƒ…å†µä¸‹å•åˆ—ç´¢å¼•å¹¶ä¸å ä¼˜åŠ¿ï¼›  </p><p>æ•°æ®åº“ä¼šé€‰æ‹©ä¸€ä¸ªæœ€ä¼˜çš„ç´¢å¼•æ¥ä½¿ç”¨ï¼Œå¹¶ä¸ä¼šä½¿ç”¨å…¨éƒ¨ç´¢å¼•ï¼›  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">index</span> <span class="keyword">from</span> tb_seller;<span class="comment">#æŸ¥çœ‹tb_sellerè¡¨å½“ä¸­çš„ç´¢å¼•</span></span><br><span class="line"><span class="comment"># PRIMARY ä¸»é”®ç´¢å¼•</span></span><br><span class="line"><span class="comment"># idx_name_sta_address name</span></span><br><span class="line"><span class="comment"># idx_name_sta_address status</span></span><br><span class="line"><span class="comment"># idx_name_sta_address address</span></span><br><span class="line"><span class="comment"># idx_seller_address address</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆ é™¤å•åˆ—ç´¢å¼•</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">index</span> <span class="keyword">from</span> idx_seller_address <span class="keyword">on</span> tb_seller;</span><br><span class="line"></span><br><span class="line"><span class="comment">#æŸ¥çœ‹tb_sellerè¡¨çš„ç´¢å¼•</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">index</span> <span class="keyword">from</span> tb_seller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'å°ç±³ç§‘æŠ€'</span> <span class="keyword">and</span>  <span class="keyword">status</span>=<span class="string">'0'</span> <span class="keyword">and</span> address=<span class="string">'è¥¿å®‰å¸‚'</span>;<span class="comment">#æ­¤æ—¶ä½¿ç”¨å¤åˆç´¢å¼•ï¼›key:idx_name_sta_addrï¼›key_lenï¼š813</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆ é™¤å¤åˆç´¢å¼•</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">index</span> idx_name_sta_address <span class="keyword">on</span> tb_seller;</span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆ›å»ºå•åˆ—ç´¢å¼•</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> idx_seller_name <span class="keyword">on</span> tb_seller(<span class="keyword">name</span>);</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> idx_seller_status <span class="keyword">on</span> tb_seller(<span class="keyword">status</span>);</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> idx_seller_address <span class="keyword">on</span> tb_seller(address);</span><br><span class="line"></span><br><span class="line"><span class="comment">#æŸ¥çœ‹å•åˆ—ç´¢å¼•</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">index</span> <span class="keyword">from</span> tb_seller;</span><br><span class="line"><span class="comment">#PRIMARY ä¸»é”®ç´¢å¼•</span></span><br><span class="line"><span class="comment"># idx_seller_name å•åˆ—ç´¢å¼•nameå­—æ®µ</span></span><br><span class="line"><span class="comment"># idx_seller_status å•åˆ—ç´¢å¼•statuså­—æ®µ</span></span><br><span class="line"><span class="comment"># idx_seller_address å•åˆ—ç´¢å¼•addresså­—æ®µ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="keyword">name</span> =<span class="string">'å°ç±³ç§‘æŠ€'</span> <span class="keyword">and</span> <span class="keyword">status</span>=<span class="string">'0'</span> <span class="keyword">and</span> address=<span class="string">'è¥¿å®‰å¸‚'</span>;</span><br><span class="line"><span class="comment"># æ­¤æ—¶èµ°ç´¢å¼•ä½†æ˜¯ï¼›key:idx_seller_name; key_len:403;</span></span><br><span class="line"><span class="comment"># åªèµ°äº†nameå­—æ®µçš„ç´¢å¼•ï¼›</span></span><br><span class="line"><span class="comment"># è€Œstatuså­—æ®µä»¥åŠaddresså­—æ®µçš„ç´¢å¼•æœªèµ°ï¼›</span></span><br><span class="line"><span class="comment"># ç›¸å½“äºç™½åˆ›å»ºäº†statusä»¥åŠaddresså­—æ®µçš„ç´¢å¼•äº†ï¼›</span></span><br><span class="line"><span class="comment"># å³æ­¤æ—¶possible_keyï¼šidx_seller_nameã€idx_seller_statusã€idx_seller_addressï¼›è¿™ä¸‰ä¸ªç´¢å¼•å¯èƒ½éƒ½ä¼šç”¨åˆ°ï¼›</span></span><br><span class="line"><span class="comment"># ä½†æ˜¯å®é™…ä¸Šåªç”¨åˆ°äº†idx_seller_nameç´¢å¼•ï¼›å³nameå­—æ®µçš„ç´¢å¼•ï¼›</span></span><br><span class="line"><span class="comment"># ä¸ºä»€ä¹ˆé€‰æ‹©äº†nameå­—æ®µæ¥ä½œä¸ºè¯¥SQLçš„ç´¢å¼•ï¼›</span></span><br><span class="line"><span class="comment"># åŸå› åœ¨äºï¼šæ•°æ®åº“ä¼šé€‰æ‹©ä¸€ä¸ªæœ€ä¼˜çš„ç´¢å¼•æ¥ä½¿ç”¨ï¼›å¹¶ä¸ä¼šä½¿ç”¨å…¨éƒ¨ç´¢å¼•ï¼›ä¹Ÿå°±æ„å‘³ç€nameè¯¥å­—æ®µçš„ç´¢å¼•åœ¨è¿™ä¸‰ä¸ªç´¢å¼•å½“ä¸­æœ€ä¼˜ï¼›</span></span><br><span class="line"><span class="comment"># ä¸ºä»€ä¹ˆnameè¯¥å­—æ®µçš„ç´¢å¼•idx_seller_nameæœ€ä¼˜ï¼Œ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_seller;</span><br><span class="line"><span class="comment"># å› ä¸ºåœ¨æ­¤è¡¨å½“ä¸­ï¼ŒnameæŸ¥è¯¢çš„ç²¾ç¡®å€¼ä¸ºâ€œå°ç±³ç§‘æŠ€â€è¾¨è¯†åº¦æœ€é«˜ï¼Œè®°å½•è¡Œä¸º1ï¼›</span></span><br><span class="line"><span class="comment"># è€Œstatuså­—æ®µå–å€¼ä¸º0çš„è®°å½•è¡Œè¶…è¿‡1ï¼›</span></span><br><span class="line"><span class="comment"># addresså­—æ®µå–å€¼ä¸ºâ€œè¥¿å®‰å¸‚â€è®°å½•è¡Œä¹Ÿåªæœ‰1ï¼›</span></span><br><span class="line"><span class="comment"># ä¹Ÿåº”è¯¥æ˜¯éµå¾ªäº†ä»å·¦åˆ°å³çš„ä¸€ä¸ªåˆ¤æ–­ï¼›æ‰€ä»¥æ­¤æ—¶idx_seller_nameç´¢å¼•æœ€ä¼˜ï¼›</span></span><br><span class="line"><span class="comment"># ä»è€Œèµ°äº†idx_seller_nameç´¢å¼•ï¼›  </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="keyword">status</span>=<span class="string">'0'</span> <span class="keyword">and</span> address=<span class="string">'è¥¿å®‰å¸‚'</span>;</span><br><span class="line"><span class="comment"># æ­¤æ—¶æ²¡æœ‰nameå­—æ®µï¼›</span></span><br><span class="line"><span class="comment"># è€Œaddressåœ¨æ•°æ®è¡¨å½“ä¸­è¾¨è¯†åº¦æœ€é«˜ï¼›</span></span><br><span class="line"><span class="comment"># å³è®°å½•è¡Œä¸º1ï¼›æ‰€ä»¥æ­¤æ—¶èµ°çš„ç´¢å¼•è‡ªç„¶å³ä¸ºidx_seller_addressï¼›</span></span><br><span class="line"><span class="comment"># key:idx_seller_address;key_len:403;possible_key:idx_seller_status,idx_seller_address;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="keyword">status</span>=<span class="string">'0'</span> <span class="keyword">and</span> address=<span class="string">'åŒ—äº¬å¸‚'</span>;</span><br><span class="line"><span class="comment"># å¦‚æœæ­¤æ—¶addresså–ç²¾ç¡®å€¼ä¸ºâ€œåŒ—äº¬å¸‚â€ï¼›</span></span><br><span class="line"><span class="comment"># è€Œåœ¨æ•°æ®åº“å½“ä¸­addresså–å€¼ä¸ºâ€œåŒ—äº¬å¸‚â€çš„è®°å½•è¡Œè¾¨è¯†åº¦å¹¶ä¸é«˜ï¼›</span></span><br><span class="line"><span class="comment"># ä¹Ÿå°±æ˜¯å–å€¼ä¸ºâ€œåŒ—äº¬å¸‚â€çš„addresså­—æ®µå…¶è®°å½•è¡Œæœ‰å¾ˆå¤šè¶…è¿‡1ï¼Œå³æ€»å…±12æ¡è®°å½•ï¼Œæœ‰11æ¡è®°å½•å½“ä¸­çš„addresséƒ½æ˜¯â€œåŒ—äº¬å¸‚â€ï¼Œä»è€Œå…¶è¾¨è¯†åº¦å¹¶ä¸é«˜ï¼›</span></span><br><span class="line"><span class="comment"># è€Œæ­¤æ—¶statuså­—æ®µç›¸æ¯”è¾ƒä¹‹ä¸‹ï¼Œå–å€¼ä¸º0çš„è®°å½•è¡Œæ•°ï¼Œæ€»è¡Œæ•°12è¡Œï¼Œè€Œstatuså–å€¼ä¸º0çš„è®°å½•è¡Œæ•°ä¸º3è¡Œï¼Œé‚£ä¹ˆæ­¤æ—¶è¾ƒä¹‹addressçš„è¾¨è¯†åº¦è‡ªç„¶æ˜¯è¦é«˜ä¸€äº›ï¼›</span></span><br><span class="line"><span class="comment"># æ‰€ä»¥å°†èµ°statuså­—æ®µçš„ç´¢å¼•ï¼Œå³idx_seller_statusç´¢å¼•ï¼›</span></span><br><span class="line"><span class="comment"># possible_key:idx_seller_status,idx_seller_addressï¼›key:idx_seller_status;key_len:7ï¼›</span></span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´ï¼šæ•°æ®åº“ä¼šé€‰æ‹©ä¸€ä¸ªæœ€ä¼˜çš„ç´¢å¼•ï¼ˆè¾¨è¯†åº¦æœ€é«˜ç´¢å¼•ï¼‰æ¥ä½¿ç”¨ï¼Œå¹¶ä¸ä¼šä½¿ç”¨å…¨éƒ¨çš„ç´¢å¼•ï¼›  </p><h2 id="ç´¢å¼•çš„ä½¿ç”¨-æŸ¥çœ‹ç´¢å¼•ä½¿ç”¨æƒ…å†µ"><a href="#ç´¢å¼•çš„ä½¿ç”¨-æŸ¥çœ‹ç´¢å¼•ä½¿ç”¨æƒ…å†µ" class="headerlink" title="ç´¢å¼•çš„ä½¿ç”¨ - æŸ¥çœ‹ç´¢å¼•ä½¿ç”¨æƒ…å†µ"></a>ç´¢å¼•çš„ä½¿ç”¨ - æŸ¥çœ‹ç´¢å¼•ä½¿ç”¨æƒ…å†µ</h2><p><strong>æŸ¥çœ‹ç´¢å¼•ä½¿ç”¨æƒ…å†µ</strong>  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">status</span> <span class="keyword">like</span> <span class="string">'Handler_read%'</span>;<span class="comment">#æŸ¥çœ‹çš„æ˜¯å½“å‰ä¼šè¯ä¸­ç´¢å¼•çš„ä½¿ç”¨æƒ…å†µ</span></span><br><span class="line"><span class="comment">#Variable_name  Value</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">global</span> <span class="keyword">status</span> <span class="keyword">like</span> <span class="string">'Handler_read%'</span>;<span class="comment">#æŸ¥çœ‹çš„æ˜¯å…¨å±€ä¸­ç´¢å¼•çš„ä½¿ç”¨æƒ…å†µ</span></span><br></pre></td></tr></table></figure><table border="1">  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>Handler_read_first</td>    <td>0</td>  </tr>  <tr>    <td>Handler_read_key</td>    <td>2</td>  </tr>  <tr>    <td>Handler_read_last</td>    <td>0</td>  </tr>    <tr>    <td>Handler_read_next</td>    <td>0</td>  </tr>    <tr>    <td>Handler_read_prev</td>    <td>0</td>  </tr>    <tr>    <td>Handler_read_rnd</td>    <td>0</td>  </tr>    <tr>    <td>Handler_read_rnd_next</td>    <td>22</td>  </tr></table><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Handler_read_first</span>: ç´¢å¼•ä¸­ç¬¬ä¸€æ¡è¢«è¯»çš„æ¬¡æ•°ã€‚å¦‚æœè¾ƒé«˜ï¼Œè¡¨ç¤ºæœåŠ¡å™¨æ­£åœ¨è‡ªè¡Œå¤§é‡å…¨ç´¢å¼•æ‰«æï¼ˆè¿™ä¸ªå€¼è¶Šä½è¶Šå¥½ï¼‰ï¼›</span><br><span class="line"></span><br><span class="line"><span class="attribute">Handler_read_key</span>: å¦‚æœç´¢å¼•æ­£åœ¨å·¥ä½œï¼Œè¿™ä¸ªå€¼ä»£è¡¨ä¸€ä¸ªè¡Œè¢«ç´¢å¼•å€¼è¯»å–çš„æ¬¡æ•°ï¼›å¦‚æœå€¼è¶Šä½ï¼Œè¡¨ç¤ºç´¢å¼•å¾—åˆ°çš„æ€§èƒ½æ”¹å–„ä¸é«˜ï¼Œå› ä¸ºç´¢å¼•ä¸ç»å¸¸ä½¿ç”¨ï¼ˆè¿™ä¸ªå€¼è¶Šé«˜è¶Šå¥½ï¼‰ï¼›</span><br><span class="line"></span><br><span class="line"><span class="attribute">Handler_read_next</span>: æŒ‰ç…§é”®é¡ºåºè¯»ä¸‹ä¸€è¡Œçš„è¯·æ±‚æ•°ã€‚å¦‚æœç”¨èŒƒå›´çº¦æŸæˆ–è€…å¦‚æœæ‰§è¡Œç´¢å¼•æ‰«ææ¥æŸ¥è¯¢ç´¢å¼•åˆ—ï¼Œè¯¥å€¼å¢åŠ ï¼›  </span><br><span class="line"></span><br><span class="line"><span class="attribute">Handler_read_prev</span>: æŒ‰ç…§é”®é¡ºåºè¯»å‰ä¸€è¡Œçš„è¯·æ±‚æ•°ï¼Œè¯¥è¯»æ–¹æ³•ä¸»è¦ç”¨äºä¼˜åŒ–ORDER BY.....DESCï¼›</span><br><span class="line"></span><br><span class="line"><span class="attribute">Handler_read_rnd</span>: æ ¹æ®å›ºå®šä½ç½®è¯»ä¸€è¡Œçš„è¯·æ±‚æ•°ã€‚å¦‚æœæ­£æ‰§è¡Œå¤§é‡æŸ¥è¯¢å¹¶éœ€è¦å¯¹ç»“æœè¿›è¡Œæ’åºè¯¥å€¼è¾ƒé«˜ã€‚å¯èƒ½ä½¿ç”¨äº†å¤§é‡éœ€è¦MySQLæ‰«ææ•´ä¸ªè¡¨çš„æŸ¥è¯¢æˆ–è€…è¿æ¥æ²¡æœ‰æ­£ç¡®ä½¿ç”¨é”®ã€‚è¿™ä¸ªå€¼è¾ƒé«˜ï¼Œæ„å‘³ç€è¿è¡Œæ•ˆç‡ä½ï¼Œåº”è¯¥å»ºç«‹ç´¢å¼•æ¥è¡¥æ•‘ï¼›  </span><br><span class="line"></span><br><span class="line"><span class="attribute">Handler_read_rnd_next</span>: åœ¨æ•°æ®æ–‡ä»¶ä¸­è¯»ä¸‹ä¸€è¡Œçš„è¯·æ±‚æ•°ã€‚å¦‚æœæ­£è¿›è¡Œå¤§é‡çš„è¡¨æ‰«æï¼Œè¯¥å€¼è¦æ±‚è¾ƒé«˜ã€‚é€šå¸¸è¯´æ˜è¡¨ç´¢å¼•ä¸æ­£ç¡®æˆ–è€…æ˜¯å†™å…¥çš„æŸ¥è¯¢æ²¡æœ‰åˆ©ç”¨ç´¢å¼•ï¼›</span><br></pre></td></tr></table></figure><h2 id="SQLä¼˜åŒ–-å¤§æ‰¹é‡æ’å…¥æ•°æ®"><a href="#SQLä¼˜åŒ–-å¤§æ‰¹é‡æ’å…¥æ•°æ®" class="headerlink" title="SQLä¼˜åŒ– - å¤§æ‰¹é‡æ’å…¥æ•°æ®"></a>SQLä¼˜åŒ– - å¤§æ‰¹é‡æ’å…¥æ•°æ®</h2><p><strong>å¤§æ‰¹é‡æ’å…¥æ•°æ®</strong>  </p><p>ç¯å¢ƒå‡†å¤‡ï¼š  </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE <span class="string">'tb_user_1'</span>(</span><br><span class="line">  <span class="string">'id'</span> int(11) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">'username'</span> varchar(45) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'password'</span> varchar(96) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'name'</span> varchar(45) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'birthday'</span> datetime<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'sex'</span> char(1)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'email'</span> varchar(45)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'phone'</span> varchar(45)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'qq'</span> varchar(32)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'status'</span>  varchar(32)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span> comment <span class="string">'ç”¨æˆ·çŠ¶æ€'</span>,</span><br><span class="line">  <span class="string">'create_time'</span>  datetime <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'update_time'</span> datetime<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY KEY(<span class="string">'id'</span>),</span><br><span class="line">  UNIQUE KEY <span class="string">'unique_user_username'</span>(<span class="string">'username'</span>)</span><br><span class="line">)<span class="attribute">ENGINE</span>=InnoDB<span class="built_in"> DEFAULT </span><span class="attribute">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line">CREATE TABLE <span class="string">'tb_user_2'</span>(</span><br><span class="line">  <span class="string">'id'</span> int(11) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">'username'</span> varchar(45) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'password'</span> varchar(96) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'name'</span> varchar(45) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'birthday'</span> datetime<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'sex'</span> char(1)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'email'</span> varchar(45)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'phone'</span> varchar(45)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'qq'</span> varchar(32)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'status'</span>  varchar(32)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span> comment <span class="string">'ç”¨æˆ·çŠ¶æ€'</span>,</span><br><span class="line">  <span class="string">'create_time'</span>  datetime <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'update_time'</span> datetime<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY KEY(<span class="string">'id'</span>),</span><br><span class="line">  UNIQUE KEY <span class="string">'unique_user_username'</span>(<span class="string">'username'</span>)</span><br><span class="line">)<span class="attribute">ENGINE</span>=InnoDB<span class="built_in"> DEFAULT </span><span class="attribute">CHARSET</span>=utf8;</span><br></pre></td></tr></table></figure><p>å½“ä½¿ç”¨loadå‘½ä»¤å¯¼å…¥æ•°æ®çš„æ—¶å€™ï¼Œé€‚å½“çš„è®¾ç½®å¯ä»¥æé«˜å¯¼å…¥çš„æ•ˆç‡ã€‚  </p><p>å¼•æ“ä½¿ç”¨çš„æ˜¯Innodbï¼ŒInnodbåº•å±‚ä½¿ç”¨çš„ç´¢å¼•æ˜¯B+æ ‘ç´¢å¼•ï¼›è€ŒB+æ ‘ç´¢å¼•å½“ä¸­çš„æ•°æ®æœ‰é¡ºåºçš„ï¼›  </p><p>å¯¹äºInnodbç±»å‹çš„è¡¨ï¼Œæœ‰ä»¥ä¸‹é›†ä¸­æ–¹å¼å¯ä»¥æé«˜å¯¼å…¥çš„æ•ˆç‡ï¼š  </p><p><strong>ï¼ˆ1ï¼‰</strong> <strong>ä¸»é”®é¡ºåºæ’å…¥</strong>  </p><p>å› ä¸º<strong>InnoDBç±»å‹</strong>çš„è¡¨æ˜¯<strong>æŒ‰ç…§ä¸»é”®çš„é¡ºåº</strong>ä¿å­˜çš„ï¼Œæ‰€ä»¥å°†å¯¼å…¥çš„æ•°æ®<strong>æŒ‰ç…§ä¸»é”®çš„é¡ºåºæ’åˆ—</strong>ï¼Œå¯ä»¥<strong>æœ‰æ•ˆçš„æé«˜ å¯¼å…¥æ•°æ®çš„ æ•ˆç‡</strong>ã€‚  </p><p>å¦‚æœ<strong>InnoDBè¡¨ æ²¡æœ‰ä¸»é”®</strong>ï¼Œé‚£ä¹ˆç³»ç»Ÿä¼š<strong>è‡ªåŠ¨é»˜è®¤åˆ›å»ºä¸€ä¸ªå†…éƒ¨åˆ—</strong>ä½œä¸º<strong>ä¸»é”®</strong>ï¼Œæ‰€ä»¥å¦‚æœå¯ä»¥ç»™è¡¨åˆ›å»ºä¸€ä¸ªä¸»é”®ï¼Œå°†å¯ä»¥åˆ©ç”¨è¿™ç‚¹ï¼Œæ¥<strong>æé«˜å¯¼å…¥æ•°æ®çš„æ•ˆç‡</strong>ã€‚  </p><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è„šæœ¬æ–‡ä»¶ä»‹ç»ï¼š  </span><br><span class="line">  <span class="function"><span class="title">sql1</span>.<span class="built_in">log</span> -----&gt;</span> ä¸»é”®æœ‰åº</span><br><span class="line">  <span class="function"><span class="title">sql2</span>.<span class="built_in">log</span> -----&gt;</span> ä¸»é”®æ— åº</span><br></pre></td></tr></table></figure><p>æ’å…¥IDé¡ºåºæ’åˆ—æ•°æ®ï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">load</span> <span class="keyword">data</span> <span class="keyword">local</span> <span class="keyword">infile</span> <span class="string">'/root/sql1.log'</span> <span class="keyword">into</span> <span class="keyword">table</span> <span class="string">'tb_user_1'</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">','</span> <span class="keyword">lines</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\n'</span>;</span><br><span class="line"><span class="comment"># è€—è´¹æ—¶é•¿ï¼š20.58 second</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> tb_user_1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">load</span> <span class="keyword">data</span> <span class="keyword">local</span> <span class="keyword">infile</span> <span class="string">'/root/sql2.log'</span> <span class="keyword">into</span> <span class="keyword">table</span> <span class="string">'tb_user_2'</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">','</span> <span class="keyword">lines</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\n'</span>;</span><br><span class="line"><span class="comment">#è€—è´¹æ—¶é•¿ï¼š1min 59.29 second</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> tb_user_2;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sql1.logå½“ä¸­æ•°æ®æœ‰åºè¿›è¡Œæ’åˆ—ï¼›sql2.logå½“ä¸­æ•°æ®æ— åºè¿›è¡Œæ’åˆ—ï¼›</span></span><br><span class="line"><span class="comment">#è€Œsql1.logå½“ä¸­çš„æ•°æ®å°†æ’å…¥åˆ°tb_user_1è¡¨ï¼›sql2.logå½“ä¸­çš„æ•°æ®å°†æ’å…¥åˆ°tb_user_2è¡¨å½“ä¸­ï¼›</span></span><br><span class="line"><span class="comment">#sql1.logä¸sql2.logå½“ä¸­æ•°æ®é‡å®Œå…¨ä¸€è‡´ï¼›åªæ•°æ®æ’åˆ—åˆ†å¸ƒé¡ºåºä¸ä¸€è‡´ï¼›</span></span><br><span class="line"></span><br><span class="line">head sql1.log <span class="comment">#linux æŸ¥çœ‹sql1.logå‰ä¸€éƒ¨åˆ†çš„æ•°æ®å†…å®¹ï¼Œidä¸»é”®æ•°æ®æœ‰åº</span></span><br><span class="line">head sql2.log <span class="comment">#linux æŸ¥çœ‹sql2.logå‰ä¸€éƒ¨åˆ†çš„æ•°æ®å†…å®¹ï¼Œä¸»é”®æ•°æ®æ— åº</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">load</span> <span class="keyword">data</span> <span class="keyword">local</span> <span class="keyword">infile</span> <span class="string">'/root/sql1.log'</span> <span class="keyword">into</span> <span class="keyword">table</span> <span class="string">'tb_user_1'</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">','</span> <span class="keyword">lines</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\n'</span>;</span><br><span class="line"><span class="comment"># load data åŠ è½½æ•°æ®  </span></span><br><span class="line"><span class="comment">#local infile ä»æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿå½“ä¸­åŠ è½½æ•°æ®ï¼›</span></span><br><span class="line"><span class="comment">#'/root/sql1.log' æ•°æ®æ–‡ä»¶åœ¨linuxå½“ä¸­çš„ä½ç½®</span></span><br><span class="line"><span class="comment"># into table 'tb_user_1' åŠ è½½æ•°æ®åˆ°å…·ä½“è¡¨tb_user_1å½“ä¸­</span></span><br><span class="line"><span class="comment"># fields terminated by ',' æ¯ä¸€ä¸ªåŸŸä¹‹é—´ä½¿ç”¨é€—å·,è¿›è¡Œåˆ†éš”</span></span><br><span class="line"><span class="comment"># lines terminated by '\n' æ¯ä¸€è¡Œä¹‹é—´ä½¿ç”¨\nè¿›è¡Œåˆ†éš”,ä¹Ÿå°±æ˜¯æ¢è¡Œ</span></span><br><span class="line"><span class="comment"># å›è½¦ä¹‹åï¼Œåœ¨å¯¼å…¥æ•°æ®çš„è¿‡ç¨‹å½“ä¸­ï¼Œè¿˜éœ€è¦å»è¿›è¡Œç»´æŠ¤ç´¢å¼•ï¼Œç»´æŠ¤å”¯ä¸€ç´¢å¼•ï¼›uniqueï¼›</span></span><br><span class="line"><span class="comment"># sql1.logå¯¼å…¥åˆ°tb_user_1è¡¨å½“ä¸­è€—è´¹æ—¶é—´ä¸º19.37 second</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> tb_user_1;<span class="comment"># 1000000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">load</span> <span class="keyword">data</span> <span class="keyword">local</span> <span class="keyword">infile</span> <span class="string">'/root/sql2.log'</span> <span class="keyword">into</span> <span class="keyword">table</span> <span class="string">'tb_user_2'</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">','</span> <span class="keyword">lines</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\n'</span>;</span><br><span class="line"><span class="comment">#å›è½¦ä¹‹åï¼Œè€—è´¹çš„æ—¶é—´ä¸º 1min 51.42 secondï¼›å’Œsql1.logå¯¼å…¥tb_user_1æ—¶å·®è·å¾ˆå¤§ï¼›  </span></span><br><span class="line"><span class="comment">#æ‰€ä»¥è¿™æ ·å°±éªŒè¯äº†å¤§æ‰¹é‡å¯¼å…¥æ•°æ®æ—¶ï¼Œæœ‰åºæ•°æ®å¯¼å…¥è¡¨å½“ä¸­æ—¶è€—è´¹çš„æ—¶é—´å°äºæ— åºæ•°æ®å¯¼å…¥è¡¨å½“ä¸­çš„æ—¶é—´ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> tb_user_2;<span class="comment"># 1000000</span></span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ2ï¼‰</strong> <strong>å…³é—­å”¯ä¸€æ€§æ ¡éªŒ</strong>  </p><p>åœ¨<strong>å¯¼å…¥æ•°æ®å‰</strong>æ‰§è¡Œ <strong>SET UNIQUE_CHECKS=0</strong> ï¼Œ<strong>å…³é—­å”¯ä¸€æ€§æ ¡éªŒ</strong>ï¼Œ<br>åœ¨<strong>å¯¼å…¥ç»“æŸå</strong>æ‰§è¡Œ <strong>SET UNIQUE_CHECKS=1</strong>ï¼Œ<strong>æ¢å¤å”¯ä¸€æ€§æ ¡éªŒ</strong>ï¼Œå¯ä»¥<strong>æé«˜å¯¼å…¥çš„æ•ˆç‡</strong>ã€‚  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åœ¨tb_user_1è¡¨ç»“æ„å½“ä¸­å­˜åœ¨usernameå­—æ®µçš„å”¯ä¸€æ€§ç´¢å¼•ï¼›å¦‚æœå­˜åœ¨å”¯ä¸€æ€§ç´¢å¼•åˆ™åœ¨æ’å…¥æ•°æ®çš„æ—¶å€™æ˜¯éœ€è¦å¯¹å”¯ä¸€æ€§å­—æ®µæ•°æ®çš„å–å€¼è¿›è¡Œæ ¡éªŒçš„ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> UNIQUE_CHECKS=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">load</span> <span class="keyword">data</span> <span class="keyword">local</span> infiles <span class="string">'/root/sql1.log'</span> <span class="keyword">into</span> <span class="keyword">table</span> <span class="string">'tb_user_1'</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">','</span> <span class="keyword">lines</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\n'</span>;</span><br><span class="line"><span class="comment">#è€—è´¹æ—¶é•¿ä¸º 19.39 second</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> UNIQUE_CHECKS=<span class="number">1</span>;</span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ3ï¼‰</strong> <strong>æ‰‹åŠ¨æäº¤äº‹åŠ¡</strong>  </p><p>å¦‚æœåº”ç”¨ä½¿ç”¨<strong>è‡ªåŠ¨æäº¤</strong>çš„æ–¹å¼ï¼Œ<br>å»ºè®®åœ¨<strong>å¯¼å…¥å‰</strong>æ‰§è¡Œ <strong>SET AUTOCOMMIT=0</strong>ï¼Œ<strong>å…³é—­è‡ªåŠ¨æäº¤</strong>ï¼Œ<br><strong>å¯¼å…¥ç»“æŸå</strong>å†æ‰§è¡Œ <strong>SET AUTOCOMMIT=1</strong>ï¼›<strong>æ‰“å¼€è‡ªåŠ¨æäº¤</strong>ï¼Œä¹Ÿå¯ä»¥<strong>æé«˜å¯¼å…¥çš„æ•ˆç‡</strong>ã€‚  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> AUTOCOMMIT=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">load</span> <span class="keyword">data</span> <span class="keyword">local</span> infiles <span class="string">'/root/sql1.log'</span> <span class="keyword">into</span> <span class="keyword">table</span> <span class="string">'tb_user_1'</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">','</span> <span class="keyword">lines</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\n'</span>;</span><br><span class="line"><span class="comment">#è€—è´¹æ—¶é•¿ä¸º 19.58 second</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> tb_user_1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> AUTOCOMMIT=<span class="number">1</span>;</span><br></pre></td></tr></table></figure><h2 id="SQLä¼˜åŒ–-insertä¼˜åŒ–"><a href="#SQLä¼˜åŒ–-insertä¼˜åŒ–" class="headerlink" title="SQLä¼˜åŒ– - insertä¼˜åŒ–"></a>SQLä¼˜åŒ– - insertä¼˜åŒ–</h2><p><strong>ä¼˜åŒ–insertè¯­å¥</strong>  </p><p>å½“è¿›è¡Œæ•°æ®çš„insertæ“ä½œçš„æ—¶å€™ï¼Œå¯ä»¥è€ƒè™‘é‡‡ç”¨ä»¥ä¸‹å‡ ç§ä¼˜åŒ–æ–¹æ¡ˆã€‚  </p><ul><li><p>å¦‚æœéœ€è¦åŒæ—¶å¯¹ä¸€å¼ è¡¨æ’å…¥å¾ˆå¤šè¡Œæ•°æ®æ—¶ï¼Œåº”è¯¥å°½é‡ä½¿ç”¨å¤šä¸ªå€¼è¡¨çš„insertè¯­å¥ï¼Œè¿™ç§æ–¹å¼å°†å¤§å¤§çš„ç¼©å‡å®¢æˆ·ç«¯ä¸æ•°æ®åº“ä¹‹é—´çš„è¿æ¥ã€å…³é—­ç­‰æ¶ˆè€—ã€‚<br>ä½¿å¾—æ•ˆç‡æ¯”åˆ†å¼€æ‰§è¡Œçš„å•ä¸ªinsertè¯­å¥å—ã€‚<br>ç¤ºä¾‹ï¼ŒåŸå§‹æ–¹å¼ä¸ºï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">'tom'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">'cat'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">3</span>,<span class="string">'Jerry'</span>);</span><br></pre></td></tr></table></figure><p>ä¼˜åŒ–åçš„æ–¹æ¡ˆä¸ºï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span> (<span class="number">1</span>,<span class="string">'tom'</span>),(<span class="number">2</span>,<span class="string">'cat'</span>),(<span class="number">3</span>,<span class="string">'Jerry'</span>);</span><br></pre></td></tr></table></figure></li><li><p>åœ¨<strong>äº‹åŠ¡ä¸­</strong>è¿›è¡Œæ•°æ®æ’å…¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">start</span> <span class="keyword">transaction</span>;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">'tom'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">'cat'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">3</span>,<span class="string">'Jerry'</span>);</span><br><span class="line"><span class="keyword">commit</span>;</span><br></pre></td></tr></table></figure></li><li><p>æ•°æ®<strong>æœ‰åºæ’å…¥</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">4</span>,<span class="string">'Tim'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">'tom'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">'cat'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">5</span>,<span class="string">'Rose'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">3</span>,<span class="string">'Jerry'</span>);</span><br></pre></td></tr></table></figure><p>ä¼˜åŒ–åï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">'Tim'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">'tom'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">3</span>,<span class="string">'cat'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">4</span>,<span class="string">'Rose'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">5</span>,<span class="string">'Jerry'</span>);</span><br></pre></td></tr></table></figure></li></ul><h2 id="SQLä¼˜åŒ–-orderbyä¼˜åŒ–"><a href="#SQLä¼˜åŒ–-orderbyä¼˜åŒ–" class="headerlink" title="SQLä¼˜åŒ– - orderbyä¼˜åŒ–"></a>SQLä¼˜åŒ– - orderbyä¼˜åŒ–</h2><p><strong>ä¼˜åŒ– order by è¯­å¥</strong>  </p><p><strong>ç¯å¢ƒå‡†å¤‡</strong>  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">'emp'</span>(</span><br><span class="line">  <span class="string">'id'</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">'name'</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'age'</span> <span class="built_in">int</span>(<span class="number">3</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">'salary'</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span>(<span class="string">'id'</span>)</span><br><span class="line">)<span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> DEAFULT <span class="keyword">CHARSET</span>=utf8mb4;</span><br><span class="line"></span><br><span class="line"><span class="comment">#åŸºç¡€æ•°æ®æ’å…¥</span></span><br><span class="line">.....</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> idx_emp_age_salary <span class="keyword">on</span> emp(age,salary);<span class="comment">#å»ºç«‹ageã€salaryå­—æ®µçš„å¤åˆç´¢å¼•</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">index</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="comment">#PRIMARY ä¸»é”®ç´¢å¼•</span></span><br><span class="line"><span class="comment">#idx_emp_age_salary age å¤åˆç´¢å¼•</span></span><br><span class="line"><span class="comment">#idx_emp_age_salary salary å¤åˆç´¢å¼•</span></span><br></pre></td></tr></table></figure><p><strong>ä¸¤ç§æ’åºæ–¹å¼</strong>  </p><p><strong>ï¼ˆ1ï¼‰</strong> <strong>ç¬¬ä¸€ç§æ˜¯é€šè¿‡å¯¹è¿”å›æ•°æ®è¿›è¡Œæ’åºï¼Œä¹Ÿå°±æ˜¯é€šå¸¸è¯´çš„ filesort æ’åºï¼Œæ‰€æœ‰ä¸æ˜¯é€šè¿‡ç´¢å¼•ç›´æ¥è¿”å›æ’åºç»“æœçš„æ’åºéƒ½å«åš FileSortæ’åº</strong>ã€‚  </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> age;#key:<span class="keyword">NULL</span>ï¼›key_len:<span class="keyword">NULL</span>ï¼›Extraï¼š<span class="keyword">Using</span> filesort;<span class="keyword">type</span>:<span class="keyword">ALL</span> æ²¡æœ‰èµ°ç´¢å¼•ï¼Œå…¨è¡¨æ‰«æï¼ˆå‡åºï¼‰</span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> age,salary;#key:<span class="keyword">NULL</span>ï¼›key_len:<span class="keyword">NULL</span>ï¼›Extraï¼š<span class="keyword">Using</span> filesort;<span class="keyword">type</span>:<span class="keyword">ALL</span> æ²¡æœ‰èµ°ç´¢å¼•ï¼Œå…¨è¡¨æ‰«æï¼ˆå‡åºï¼‰</span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">desc</span>;#key:<span class="keyword">NULL</span>ï¼›key_len:<span class="keyword">NULL</span>ï¼›Extraï¼š<span class="keyword">Using</span> filesort;<span class="keyword">type</span>:<span class="keyword">ALL</span> æ²¡æœ‰èµ°ç´¢å¼•ï¼Œå…¨è¡¨æ‰«æï¼ˆé™åºï¼‰</span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">desc</span>,salary <span class="keyword">desc</span>;#key:<span class="keyword">NULL</span>ï¼›key_len:<span class="keyword">NULL</span>ï¼›Extraï¼š<span class="keyword">Using</span> filesort;<span class="keyword">type</span>:<span class="keyword">ALL</span> æ²¡æœ‰èµ°ç´¢å¼•ï¼Œå…¨è¡¨æ‰«æï¼ˆé™åºï¼‰</span><br><span class="line"></span><br><span class="line">#é€šè¿‡file sort æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œæ’åºï¼Œæ•ˆç‡è¾ƒä½</span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">desc</span>;#<span class="keyword">type</span>ï¼š<span class="keyword">ALL</span>ï¼Œkeyï¼š<span class="keyword">NULL</span>ï¼›key_len:<span class="keyword">NULL</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">asc</span>;#<span class="keyword">type</span>ï¼š<span class="keyword">ALL</span>ï¼Œkeyï¼š<span class="keyword">NULL</span>ï¼›key_len:<span class="keyword">NULL</span></span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ2ï¼‰</strong> <strong>ç¬¬äºŒç§é€šè¿‡æœ‰åºç´¢å¼•é¡ºåºæ‰«æç›´æ¥è¿”å›æœ‰åºæ•°æ®ï¼Œè¿™ç§æƒ…å†µå³ä¸º using indexï¼Œä¸éœ€è¦é¢å¤–æ’åºï¼Œæ“ä½œæ•ˆç‡é«˜</strong>ã€‚  </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> id <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">asc</span>;#èµ°ç´¢å¼•ï¼›keyï¼šidx_age_salaryï¼›key_len:<span class="number">9</span>ï¼›Extraï¼š<span class="keyword">Using</span> <span class="keyword">index</span> èµ°ç´¢å¼•</span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> id,age <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">asc</span>;#èµ°ç´¢å¼•ï¼›keyï¼šidx_age_salaryï¼›key_len:<span class="number">9</span>ï¼›Extraï¼š<span class="keyword">Using</span> <span class="keyword">index</span> èµ°ç´¢å¼•</span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> id,age,salary <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">asc</span>;#èµ°ç´¢å¼•ï¼›keyï¼šidx_age_salaryï¼›key_len:<span class="number">9</span>ï¼›Extraï¼š<span class="keyword">Using</span> <span class="keyword">index</span> èµ°ç´¢å¼•</span><br><span class="line">#è¦†ç›–ç´¢å¼•çš„ç”¨æ³•ï¼›æŸ¥è¯¢<span class="keyword">select</span> çš„å­—æ®µéƒ½æ˜¯è¦†ç›–ç´¢å¼•åˆ™è¿™ä¸ªæ—¶å€™ä½¿ç”¨çš„å³ä¸º<span class="keyword">using</span> <span class="keyword">index</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> id,age,salary,<span class="type">name</span> <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">asc</span>;#èµ°ç´¢å¼•ï¼›keyï¼š<span class="keyword">NULL</span>ï¼›key_len:<span class="keyword">NULL</span>ï¼›<span class="keyword">type</span>:<span class="keyword">ALL</span>ï¼›Extraï¼š<span class="keyword">Using</span> filesort å…¨è¡¨æ‰«æï¼›ç”±äºæŸ¥è¯¢çš„å­—æ®µå½“ä¸­åŒ…å«äº†éç´¢å¼•å­—æ®µï¼›å³å¹¶æœªè¦†ç›–ç´¢å¼•ï¼›æ‰€ä»¥èµ°å…¨è¡¨æ‰«æçš„æ–¹å¼ï¼›idã€ageã€salaryè¿™ä¸‰ä¸ªå­—æ®µéƒ½æœ‰ç´¢å¼•ï¼›è€Œ<span class="type">name</span>å­—æ®µæ²¡æœ‰ç´¢å¼•ï¼›</span><br></pre></td></tr></table></figure><p><strong>å¤šå­—æ®µæ’åº</strong>  </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> id ,age,salary <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> age,salary;#key:idx_age_salary;key_len:<span class="number">9</span>;Extra:<span class="keyword">Using</span> <span class="keyword">index</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> id ,age,salary <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">asc</span>,salary <span class="keyword">asc</span>;#key:idx_age_salary;key_len:<span class="number">9</span>;Extra:<span class="keyword">Using</span> <span class="keyword">index</span>(<span class="keyword">order</span> <span class="keyword">by</span> å¦‚ä¸æ ‡æ˜<span class="keyword">desc</span>æˆ–è€…<span class="keyword">asc</span>;é»˜è®¤ä¸º<span class="keyword">asc</span>å‡åºæ’åº)</span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> id,age,salary <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">desc</span>,salary <span class="keyword">desc</span>;#key:idx_age_salary;key_len:<span class="number">9</span>;Extra:<span class="keyword">Using</span> <span class="keyword">index</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> id,age,salary <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">asc</span>,salary <span class="keyword">desc</span>;#key:idx_age_salary;key_len:<span class="number">9</span>;Extra:<span class="keyword">Using</span> <span class="keyword">index</span>;<span class="keyword">Using</span> filesortæ­¤æ—¶å°±ä¼šå‡ºç°Filesort</span><br><span class="line"></span><br><span class="line"># å³åœ¨ä½¿ç”¨<span class="keyword">order</span> <span class="keyword">by</span>è¿›è¡Œå¤šå­—æ®µæ’åºçš„æ—¶å€™ï¼Œå¦‚æœæƒ³è¦æ•ˆç‡è¾ƒé«˜ï¼›é‚£ä¹ˆæ­¤æ—¶æœ€å¥½è¿™äº›å¤šå­—æ®µç»Ÿä¸€æ’åºæ–¹å¼ï¼›è¦ä¹ˆéƒ½æ˜¯å‡åºè¦ä¹ˆéƒ½æ˜¯é™åºï¼›å¦‚æœå‡ºç°ä¸€å‡ä¸€é™é‚£ä¹ˆå°±ä¼šå‡ºç°Filesortï¼›æ–‡ä»¶ç³»ç»Ÿæ’åºé€ æˆæ•ˆç‡ä½ï¼›</span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> id,age,salary <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> salary <span class="keyword">asc</span>,age <span class="keyword">asc</span>;#key:idx_age_salary;key_len:<span class="number">9</span>;Extra:<span class="keyword">Using</span> <span class="keyword">index</span>;<span class="keyword">Using</span> filesortï¼›æ­¤æ—¶å°†age <span class="keyword">asc</span>è¿›è¡Œäº†è°ƒåå¤„ç†ï¼›ä¹Ÿå‡ºç°äº†Filesort</span><br><span class="line">#åŸå› åœ¨äºï¼š</span><br><span class="line">#æŒ‰ç…§å¤šå­—æ®µè¿›è¡Œæ’åºï¼Œè¦ä¹ˆç»Ÿä¸€è¿›è¡Œå‡åº<span class="keyword">asc</span>è¦ä¹ˆç»Ÿä¸€è¿›è¡Œé™åºæ’åºï¼›</span><br><span class="line">#å¦‚æœæŒ‰ç…§å¤šå­—æ®µè¿›è¡Œæ’åºï¼Œé‚£ä¹ˆæ’åºçš„é¡ºåºéœ€è¦å’Œå¤åˆç´¢å¼•å½“ä¸­çš„å­—æ®µé¡ºåºè¦ä¿æŒä¸€è‡´ï¼›</span><br><span class="line">#å¤åˆç´¢å¼•ä¸ºidx_emp_age_salaryï¼ˆageï¼Œsalaryï¼‰å¤åˆç´¢å¼•å½“ä¸­ageå­—æ®µçš„ç´¢å¼•é¡ºåºå…ˆäºsalaryå­—æ®µçš„é¡ºåºï¼›</span><br><span class="line">#è€Œæ­¤æ—¶<span class="keyword">SQL</span>å½“ä¸­<span class="keyword">order</span> <span class="keyword">by</span>è¯­å¥å¤šå­—æ®µæ’åºsalaryå­—æ®µå…ˆäºageå­—æ®µï¼›æ‰€ä»¥æ­¤æ—¶Extraå½“ä¸­å°±å‡ºç°äº†<span class="keyword">using</span> <span class="keyword">index</span>ï¼›ä¹Ÿå‡ºç°äº†<span class="keyword">using</span> filesort;</span><br></pre></td></tr></table></figure><p>äº†è§£äº†MySQLçš„æ’åºæ–¹å¼ï¼Œä¼˜åŒ–ç›®æ ‡å°±æ¸…æ™°äº†ï¼šå°½é‡å‡å°‘é¢å¤–çš„æ’åºï¼Œé€šè¿‡ç´¢å¼•ç›´æ¥è¿”å›æœ‰åºæ•°æ®ã€‚  </p><p>whereæ¡ä»¶å’ŒOrder by ä½¿ç”¨ç›¸åŒçš„ç´¢å¼•å¹¶ä¸”Order by çš„é¡ºåºå’Œç´¢å¼•é¡ºåºç›¸åŒï¼Œå¹¶ä¸”Order byçš„å­—æ®µéƒ½æ˜¯å‡åºï¼Œæˆ–è€…éƒ½æ˜¯é™åºã€‚  </p><p>å¦åˆ™è‚¯å®šéœ€è¦é¢å¤–çš„æ“ä½œï¼Œè¿™æ ·å°±ä¼šå‡ºç°FileSortæ’åºï¼›  </p><h3 id="Filesortçš„ä¼˜åŒ–"><a href="#Filesortçš„ä¼˜åŒ–" class="headerlink" title="Filesortçš„ä¼˜åŒ–"></a>Filesortçš„ä¼˜åŒ–</h3><p><strong>å°½å¯èƒ½é¿å…Filesort</strong>çš„å‡ºç°ï¼Œä½†æ˜¯æ— æ³•å®Œå…¨é¿å…Filesortçš„å‡ºç°ï¼›  </p><p>é€šè¿‡åˆ›å»ºåˆé€‚çš„ç´¢å¼•ï¼Œèƒ½å¤Ÿå‡å°‘Filesortçš„å‡ºç°ã€‚  </p><p>ä½†æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ¡ä»¶é™åˆ¶ä¸èƒ½è®©Filesortå°æ—¶ï¼Œé‚£å°±éœ€è¦åŠ å¿«Filesortçš„æ’åºæ“ä½œï¼Œå¯¹äºFilesortï¼ŒMySQLæœ‰ä¸¤ç§æ’åºç®—æ³•ï¼š  </p><p>ï¼ˆ1ï¼‰ä¸¤æ¬¡æ‰«æç®—æ³•ï¼šMySQL4.1ä¹‹å‰ï¼Œä½¿ç”¨è¯¥æ–¹å¼æ’åºã€‚<br>    é¦–å…ˆï¼Œæ ¹æ®æ¡ä»¶å–å‡ºæ’åºå­—æ®µå’Œè¡ŒæŒ‡é’ˆä¿¡æ¯ï¼Œç„¶ååœ¨æ’åºåŒº sort bufferä¸­æ’åºï¼›<br>    å¦‚æœsort bufferä¸å¤Ÿï¼Œåˆ™åœ¨ä¸´æ—¶è¡¨ temporary tableä¸­å­˜å‚¨æ’åºç»“æœã€‚<br>    å®Œæˆæ’åºä¹‹åï¼Œå†æ ¹æ®èˆªæŒ‡é’ˆå›è¡¨è¯»å–è®°å½•ï¼Œè¯¥æ“ä½œå¯èƒ½ä¼šå¯¼è‡´å¤§é‡éšæœºI/Oæ“ä½œã€‚  </p><p>ï¼ˆ2ï¼‰ä¸€æ¬¡æ‰«æç®—æ³•ï¼šä¸€æ¬¡æ€§å–å‡ºæ»¡è¶³æ¡ä»¶çš„æ‰€æœ‰å­—æ®µï¼Œç„¶ååœ¨æ’åºåŒºsort bufferä¸­æ’åºåç›´æ¥è¾“å‡ºç»“æœé›†ã€‚<br>    æ’åºæ—¶å†…å­˜å¼€é”€è¾ƒå¤§ï¼Œä½†æ˜¯æ’åºæ•ˆç‡æ¯”ä¸¤æ¬¡æ‰«æç®—æ³•è¦é«˜ï¼›  </p><p>MySQL é€šè¿‡æ¯”è¾ƒç³»ç»Ÿå˜é‡ max_length_for_sort_data çš„å¤§å°å’ŒQuery è¯­å¥å–å‡ºçš„å­—æ®µæ€»å¤§å°ï¼Œæ¥åˆ¤å®šåˆé€‚å“ªä¸€ç§æ’åºç®—æ³•ï¼Œå¦‚æœmax_length_for_sort_data æ›´å¤§ï¼Œé‚£ä¹ˆä½¿ç”¨ç¬¬äºŒç§ä¼˜åŒ–ä¹‹åçš„ç®—æ³•ï¼›å¦åˆ™ä½¿ç”¨ç¬¬ä¸€ç§ï¼›  </p><p>å¯ä»¥é€‚å½“æé«˜ sort_buffer_sizeå’Œ max_length_for_sort_data ç³»ç»Ÿå˜é‡ï¼Œæ¥å¢å¤§æ’åºåŒºçš„å¤§å°ï¼Œæé«˜æ’åºçš„æ•ˆç‡ã€‚  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">'max_length_for_sort_data'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>max_length_for_sort_data</td>    <td>1024</td>  </tr></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">'sort_buffer_size'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>Variable_name</th>    <th>Value</th>  </tr>  <tr>    <td>sort_buffer_size</td>    <td>262144</td>  </tr></table><h2 id="SQLä¼˜åŒ–-group-byä¼˜åŒ–"><a href="#SQLä¼˜åŒ–-group-byä¼˜åŒ–" class="headerlink" title="SQLä¼˜åŒ– - group byä¼˜åŒ–"></a>SQLä¼˜åŒ– - group byä¼˜åŒ–</h2><p>ç”±äºGROUP BY å®é™…ä¸Šä¹ŸåŒæ ·ä¼šè¿›è¡Œæ’åºæ“ä½œï¼Œè€Œä¸”ä¸ORDER BYç›¸æ¯”ï¼ŒGROUP BYä¸»è¦åªæ˜¯å¤šäº†æ’åºå­—åçš„åˆ†ç»„æ“ä½œã€‚  </p><p>å½“ç„¶å¦‚æœåœ¨åˆ†ç»„çš„æ—¶å€™è¿˜æ˜¯ç”¨äº†å…¶ä»–çš„ä¸€äº›èšåˆå‡½æ•°ï¼Œé‚£ä¹ˆè¿˜éœ€è¦ä¸€äº›èšåˆå‡½æ•°çš„è®¡ç®—ã€‚  </p><p>æ‰€ä»¥ï¼Œåœ¨GROUP BYçš„å®ç°è¿‡ç¨‹ä¸­ï¼Œä¸ORDER BYä¸€æ ·ä¹Ÿå¯ä»¥åˆ©ç”¨åˆ°ç´¢å¼•ã€‚  </p><p>å¦‚æœæŸ¥è¯¢åŒ…å«GROUP BYï¼Œä½†æ˜¯ç”¨æˆ·æƒ³è¦é¿å…æ’åºç»“æœçš„æ¶ˆè€—ï¼Œåˆ™å¯ä»¥æ‰§è¡Œorder by null ç¦æ­¢æ’åºã€‚  </p><p>å¦‚ä¸‹ï¼š  </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">index</span> <span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">index</span> idx_emp_age_salary <span class="keyword">on</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> age,count(*) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> age;#key:<span class="keyword">NULL</span>,key_len:<span class="keyword">NULL</span>;<span class="keyword">type</span>:<span class="keyword">ALL</span>;Extra:<span class="keyword">Using</span> <span class="keyword">temporary</span>;<span class="keyword">Using</span> filesort; ç”±æ­¤å¯ä»¥çœ‹å‡º<span class="keyword">GROUP</span> <span class="keyword">BY</span> åº•å±‚è¿›è¡Œäº†æ’åºæ“ä½œï¼›<span class="keyword">Using</span> filesort</span><br><span class="line"><span class="meta">#Using temporaryä¸Using Filesortéƒ½æ˜¯æ¯”è¾ƒè€—æ—¶çš„æ“ä½œï¼›</span></span><br></pre></td></tr></table></figure><p>ä¼˜åŒ–åï¼š  </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> age,count(*) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> age <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">null</span>;#key:<span class="keyword">null</span>;key_len:<span class="keyword">null</span>;<span class="keyword">type</span>:<span class="keyword">All</span>;Extra:<span class="keyword">Using</span> <span class="keyword">temporary</span>;æ­¤æ—¶å°±æ²¡æœ‰<span class="keyword">Using</span> filesortäº†</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œç¬¬ä¸€ä¸ªSQLè¯­å¥éœ€è¦è¿›è¡Œâ€œFilesortâ€ï¼Œè€Œç¬¬äºŒä¸ªSQLè¯­å¥ç”±äºorder by nullä¸éœ€è¦è¿›è¡Œâ€œFilesortâ€ï¼Œè€Œä¸Šæ–‡æè¿‡FileSortå¾€å¾€éå¸¸è€—è´¹æ—¶é—´ã€‚  </p><p> åˆ›å»ºç´¢å¼•ï¼š  </p> <figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> idx_emp_age_salary  <span class="keyword">on</span> emp(age,salary);</span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> age,<span class="built_in">count</span>(*) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> age <span class="keyword">order</span> <span class="keyword">by</span> <span class="literal">null</span>;#key:idx_emp_age_salary;key_len:9;extra:using <span class="keyword">index</span> æ­¤æ—¶èµ°ç´¢å¼•ï¼›</span><br><span class="line">#<span class="keyword">group</span> <span class="keyword">by</span>è¯­å¥ä¹Ÿæ˜¯å¯ä»¥é€šè¿‡ç´¢å¼•æ¥æé«˜æ•ˆç‡çš„ï¼›</span><br></pre></td></tr></table></figure><h2 id="SQLä¼˜åŒ–-å­æŸ¥è¯¢ä¼˜åŒ–"><a href="#SQLä¼˜åŒ–-å­æŸ¥è¯¢ä¼˜åŒ–" class="headerlink" title="SQLä¼˜åŒ– - å­æŸ¥è¯¢ä¼˜åŒ–"></a>SQLä¼˜åŒ– - å­æŸ¥è¯¢ä¼˜åŒ–</h2><p><strong>ä¼˜åŒ–åµŒå¥—æŸ¥è¯¢</strong>  </p><p>MySQL4.1 ç‰ˆæœ¬ä¹‹åï¼Œå¼€å§‹æ”¯æŒSQLçš„å­æŸ¥è¯¢ã€‚  </p><p>è¿™ä¸ªæŠ€æœ¯å¯ä»¥ä½¿ç”¨selectè¯­å¥æ¥åˆ›å»ºä¸€ä¸ªå•åˆ—çš„æŸ¥è¯¢ç»“æœï¼Œç„¶åå§è¿™ä¸ªç»“æœæ¥ä½œä¸ºè¿‡æ»¤æ¡ä»¶ç”¨åœ¨å¦ä¸€ä¸ªæŸ¥è¯¢å½“ä¸­ã€‚  </p><p>ä½¿ç”¨å­æŸ¥è¯¢å¯ä»¥ä¸€æ¬¡æ€§çš„å®Œæˆå¾ˆå¤šé€»è¾‘ä¸Šéœ€è¦å¤šä¸ªæ­¥éª¤æ‰èƒ½å®Œæˆçš„SQLæ“ä½œï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥é¿å…äº‹åŠ¡æˆ–è€…è¡¨é”æ­»ï¼Œå¹¶ä¸”å†™èµ·æ¥ä¹Ÿå¾ˆå®¹æ˜“ã€‚  </p><p>ä½†æ˜¯ï¼Œæœ‰äº›æƒ…å†µä¸‹ï¼Œå­æŸ¥è¯¢æ˜¯å¯ä»¥è¢«æ›´é«˜æ•ˆçš„è¿æ¥ï¼ˆJOINï¼‰æ›¿ä»£ã€‚(ä½¿ç”¨å¤šè¡¨è¿æ¥æŸ¥è¯¢æ¥æ›¿æ¢å­æŸ¥è¯¢)  </p><p>ç¤ºä¾‹ï¼ŒæŸ¥æ‰¾æœ‰è§’è‰²çš„æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯ï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span>;<span class="comment"># t_user ç”¨æˆ·è¡¨ , t_role è§’è‰²è¡¨ , user_role ç”¨æˆ·è§’è‰²ä¸­é—´è¡¨ ï¼›</span></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">where</span> <span class="keyword">id</span> <span class="keyword">in</span> ( <span class="keyword">select</span> user_id <span class="keyword">from</span> user_role);</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œè®¡åˆ’ä¸ºï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> t_user <span class="keyword">where</span> <span class="keyword">id</span> <span class="keyword">in</span> (<span class="keyword">select</span> user_id <span class="keyword">from</span> user_role);</span><br></pre></td></tr></table></figure><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_key</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>t_user</td>    <td>ALL</td>    <td>PRIMARY</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>6</td>    <td>Using where</td>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>< subquery2></td>    <td>eq_ref</td>    <td>< auto_key></td>    <td>< auto_key></td>    <td>99</td>    <td>demo_02.t_user.id</td>    <td>1</td>    <td>NULL</td>  </tr>  <tr>    <td>2</td>    <td>MATERIALIZED</td>    <td>user_role</td>    <td>index</td>    <td>fk_ur_user_id</td>    <td>fk_ur_user_id</td>    <td>99</td>    <td>NULL</td>    <td>6</td>    <td>Using index</td>  </tr></table><p>ä¼˜åŒ–åï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> t_user u,user_role ur <span class="keyword">where</span> u.id=ur.user_id;<span class="comment">#å¤šè¡¨è”æŸ¥æ›¿ä»£å­æŸ¥è¯¢</span></span><br></pre></td></tr></table></figure><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_key</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>u</td>    <td>ALL</td>    <td>PRIMARY</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>6</td>    <td>NULL</td>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>ur</td>    <td>ref(refçš„æ•ˆç‡æ¯”indexæ•ˆç‡é«˜)</td>    <td>fk_ur_user_id</td>    <td>fk_ur_user_id</td>    <td>99</td>    <td>demo_02.u.id</td>    <td>1</td>    <td>NULL</td>  </tr></table><h2 id="SQLä¼˜åŒ–-orä¼˜åŒ–"><a href="#SQLä¼˜åŒ–-orä¼˜åŒ–" class="headerlink" title="SQLä¼˜åŒ– - orä¼˜åŒ–"></a>SQLä¼˜åŒ– - orä¼˜åŒ–</h2><p><strong>å¯¹äºåŒ…å« ORçš„æŸ¥è¯¢å­å¥ï¼Œå¦‚æœè¦åˆ©ç”¨ç´¢å¼•ï¼Œåˆ™ORä¹‹é—´çš„æ¯ä¸ªæ¡ä»¶åˆ—éƒ½å¿…é¡»ç”¨åˆ°ç´¢å¼•ï¼Œè€Œä¸”ä¸èƒ½ä½¿ç”¨åˆ°å¤åˆç´¢å¼•ï¼›å¦‚æœæ²¡æœ‰ç´¢å¼•ï¼Œåˆ™åº”è¯¥è€ƒè™‘å¢åŠ ç´¢å¼•</strong>ã€‚  </p><p>è·å–empè¡¨ä¸­çš„æ‰€æœ‰çš„ç´¢å¼•ï¼›  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">index</span> <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š  </p><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">show</span> index <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp;</span><br><span class="line">explain <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="built_in">where</span> id=<span class="number">1</span> <span class="built_in">or</span> name='Tom;#idä¸ºä¸»é”®ï¼Œå³å­˜åœ¨ä¸»é”®ç´¢å¼•ï¼›è€Œnameå­—æ®µæ²¡æœ‰è®¾ç½®ç´¢å¼•ï¼›æ‰€ä»¥æ­¤æ—¶ç”¨<span class="built_in">or</span>æ¥è¿æ¥ä¸¤ä¸ªæ¡ä»¶æ—¶ï¼Œå½“ä¸­åŒ…å«æœ‰ä¸€ä¸ªéç´¢å¼•å­—æ®µï¼›æ‰€ä»¥ä¸ä¼šèµ°ç´¢å¼•,ç´¢å¼•å¤±æ•ˆï¼Œé‡‡ç”¨çš„æ˜¯å…¨è¡¨æ‰«æï¼›<span class="built_in">key</span>:NULL;key_len:NULL;<span class="built_in">type</span>:ALL;extra:Using <span class="built_in">where</span>ï¼›<span class="built_in">or</span>å…³é”®å­—å¦‚æœæƒ³è¦èµ°ç´¢å¼•åˆ™<span class="built_in">or</span>è¿æ¥çš„æ¡ä»¶åˆ—å­—æ®µéœ€è¦æ˜¯ç´¢å¼•åˆ—ï¼›ä»è€Œèƒ½å¤Ÿèµ°ç´¢å¼•å¦åˆ™å…¨è¡¨æ‰«æä¸èµ°ç´¢å¼•ï¼›</span><br><span class="line"></span><br><span class="line">explain <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="built_in">where</span> age=<span class="number">20</span> <span class="built_in">or</span> salary=<span class="number">3500</span>;#<span class="built_in">key</span>:NULL,key_len:NULL;<span class="built_in">type</span>;All;extra:Using <span class="built_in">where</span>;æ­¤æ—¶æœªèµ°ç´¢å¼•ï¼›ageä¸salaryä¸ºå¤åˆç´¢å¼•å½“ä¸­çš„ç´¢å¼•åˆ—ï¼›è€Œ<span class="built_in">or</span>å…³é”®å­—æ‰€è¿æ¥çš„æ¡ä»¶åˆ—å½“ä¸­å­—æ®µçš„ç´¢å¼•ä¸èƒ½ä¸ºå¤åˆç´¢å¼•åˆ—ï¼›å¯ä»¥ä¸ºä¸»é”®ç´¢å¼•åˆ—ã€å”¯ä¸€ç´¢å¼•åˆ—ã€å•åˆ—ç´¢å¼•ç­‰ï¼›å°±æ˜¯ä¸èƒ½ä¸ºå¤åˆç´¢å¼•åˆ—å…¶ä»–çš†å¯ï¼›</span><br><span class="line"></span><br><span class="line">explain <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="built_in">where</span> id=<span class="number">1</span> <span class="built_in">or</span> age=<span class="number">30</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_key</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>t_user</td>    <td>ALL</td>    <td>PRIMARY</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>6</td>    <td>Using where</td>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>emp</td>    <td>index_merge</td>    <td>PRIMARY,idx_emp_age_salary</td>    <td>PRIMARY,idx_emp_age_salary</td>    <td>4,4</td>    <td>NULL</td>    <td>2</td>    <td>Using sort_union(idx_emp_age_salary,PRIMARY);Using where</td>  </tr></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">1</span> <span class="keyword">or</span> <span class="keyword">id</span>=<span class="number">10</span> \G;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_key</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>emp</td>    <td>range</td>    <td>PRIMARY</td>    <td>PRIMARY</td>    <td>4</td>    <td>NULL</td>    <td>2</td>    <td>Using where</td>  </tr></table><p>å»ºè®®ä½¿ç”¨ union æ›¿æ¢ orï¼›  </p><p>ä¼˜åŒ–ï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="keyword">id</span> =<span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="keyword">id</span> =<span class="number">10</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_key</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>PRIMARY</td>    <td>emp</td>    <td>const(constæ•ˆç‡è¿œé«˜äºrange)</td>    <td>PRIMARY</td>    <td>PRIMARY</td>    <td>4</td>    <td>const</td>    <td>1</td>    <td>NULL</td>  </tr>  <tr>    <td>2</td>    <td>UNION</td>    <td>emp</td>    <td>const</td>    <td>PRIMARY</td>    <td>PRIMARY</td>    <td>4</td>    <td>const</td>    <td>1</td>    <td>NULL</td>  </tr>  <tr>    <td>NULL</td>    <td>UNION RESULT</td>    <td>< union1,2></td>    <td>ALL</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>Using temporary</td>  </tr></table><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">explain select * from emp where id=<span class="number">1</span> or age=<span class="number">20</span>;</span><br><span class="line"><span class="meta">#id 1</span></span><br><span class="line"><span class="meta">#select_type SIMPLE</span></span><br><span class="line"><span class="meta">#table emp</span></span><br><span class="line"><span class="meta">#possible_key PRIMARY,idx_emp_age_salary</span></span><br><span class="line"><span class="meta">#key idx_emp_age_salary,PRIMARY</span></span><br><span class="line"><span class="meta">#key_len 4,4</span></span><br><span class="line"><span class="meta">#ref NULL</span></span><br><span class="line"><span class="meta">#rows 2</span></span><br><span class="line"><span class="meta">#extra Using sort_union(idx_emp_age_salary,PRIMARY)</span></span><br><span class="line"><span class="meta">#type index_merge</span></span><br></pre></td></tr></table></figure><p>ä¼˜åŒ–ï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> age=<span class="number">20</span>;</span><br><span class="line"><span class="comment">#unionå³ä¸ºä¸€ä¸ªæ±‚å¹¶é›†çš„ä¸€ä¸ªæ“ä½œï¼›</span></span><br></pre></td></tr></table></figure><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_key</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>PRIMARY</td>    <td>emp</td>    <td>const(constæ•ˆç‡è¿œé«˜äºrange)</td>    <td>PRIMARY</td>    <td>PRIMARY</td>    <td>4</td>    <td>const</td>    <td>1</td>    <td>NULL</td>  </tr>  <tr>    <td>2</td>    <td>UNION</td>    <td>emp</td>    <td>ref(refæ¯”index_mergeæ•ˆç‡é«˜)</td>    <td>idx_emp_age_salary</td>    <td>idx_emp_age_salary</td>    <td>4</td>    <td>const</td>    <td>1</td>    <td>NULL</td>  </tr>  <tr>    <td>NULL</td>    <td>UNION RESULT</td>    <td>< union1,2></td>    <td>ALL</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>Using temporary</td>  </tr></table><p>å»ºè®®é€šè¿‡unionæ›¿æ¢orï¼›<br>æ¥æ¯”è¾ƒä¸‹é‡è¦æŒ‡æ ‡ï¼Œå‘ç°ä¸»è¦å·®åˆ«æ˜¯typeå’Œrefè¿™ä¸¤é¡¹ï¼›<br>typeæ˜¾ç¤ºçš„æ˜¯è®¿é—®ç±»å‹ï¼Œæ˜¯è¾ƒä¸ºé‡è¦çš„ä¸€ä¸ªæŒ‡æ ‡ï¼Œç»“æœå€¼ä»å¥½åˆ°åä¾æ¬¡æ˜¯ï¼š  </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">system</span> &gt; const &gt; eq_ref &gt; <span class="keyword">ref</span> &gt; fulltext &gt; ref_or_null &gt; index_merge &gt; uniqe_subquery &gt; index_subquery &gt; range &gt; <span class="keyword">index</span> &gt; <span class="keyword">ALL</span></span><br></pre></td></tr></table></figure><p>UNIONè¯­å¥çš„typeå€¼ä¸ºrefï¼ŒORè¯­å¥çš„typeå€¼ä¸ºrangeï¼Œå¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„å·®è·  </p><p>UNIONè¯­å¥çš„refå€¼ä¸ºconstï¼ŒORè¯­å¥çš„typeå€¼ä¸ºNULLï¼Œconstè¡¨ç¤ºæ˜¯å¸¸é‡å€¼å¼•ç”¨ï¼Œéå¸¸å¿«  </p><p>è¿™ä¸¤é¡¹çš„å·®è·å°±è¯´æ˜äº†UNIONè¦ä¼˜äºORï¼›</p><h2 id="SQLä¼˜åŒ–-limitä¼˜åŒ–"><a href="#SQLä¼˜åŒ–-limitä¼˜åŒ–" class="headerlink" title="SQLä¼˜åŒ– - limitä¼˜åŒ–"></a>SQLä¼˜åŒ– - limitä¼˜åŒ–</h2><h3 id="ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢"><a href="#ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢" class="headerlink" title="ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢"></a>ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢</h3><p>ä¸€èˆ¬åˆ†é¡µæŸ¥è¯¢æ—¶ï¼Œé€šè¿‡åˆ›å»ºè¦†ç›–ç´¢å¼•èƒ½å¤Ÿæ¯”è¾ƒå¥½çš„æé«˜æ€§èƒ½ã€‚  </p><p>ä¸€ä¸ªå¸¸è§åˆéå¸¸å¤´ç–¼çš„é—®é¢˜å°±æ˜¯ limit 2000000,10;   æ­¤æ—¶éœ€è¦MySQLæ’åºå‰2000010è®°å½•ï¼Œä»…ä»…è¿”å› 2000000 - 2000010 çš„è®°å½•ï¼Œå…¶ä»–è®°å½•ä¸¢å¼ƒï¼ŒæŸ¥è¯¢æ’åºçš„ä»£ä»·éå¸¸å¤§ã€‚  </p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_item <span class="keyword">limit</span> <span class="number">2000000</span>,<span class="number">10</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_key</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>tb_item</td>    <td>ALL</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>9816098</td>    <td>NULL</td>  </tr></table><h3 id="ä¼˜åŒ–æ€è·¯ä¸€"><a href="#ä¼˜åŒ–æ€è·¯ä¸€" class="headerlink" title="ä¼˜åŒ–æ€è·¯ä¸€"></a>ä¼˜åŒ–æ€è·¯ä¸€</h3><p>åœ¨ç´¢å¼•ä¸Šå®Œæˆæ’åºåˆ†é¡µæ“ä½œï¼Œæœ€åæ ¹æ®ä¸»é”®å…³è”å›åŸè¡¨æŸ¥è¯¢æ‰€éœ€è¦çš„å…¶ä»–åˆ—å†…å®¹ã€‚  </p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">slect count(*) from tb_item;#3000000</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_item <span class="keyword">limit</span> <span class="number">10</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_item <span class="keyword">limit</span> <span class="number">10</span>,<span class="number">10</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_item <span class="keyword">limit</span> <span class="number">20</span>,<span class="number">10</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_item <span class="keyword">limit</span> <span class="number">2000000</span>,<span class="number">10</span>;#æŸ¥è¯¢æ•ˆç‡ä½ æ­¤æ—¶ä¸ºå…¨è¡¨æ‰«ææ²¡æœ‰ä½¿ç”¨å¾—åˆ°ç´¢å¼•ï¼›</span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_item t, (<span class="keyword">select</span> id <span class="keyword">from</span> tb_item <span class="keyword">order</span> <span class="keyword">by</span> id <span class="keyword">limit</span> <span class="number">2000000</span>,<span class="number">10</span>) a <span class="keyword">where</span> t.id=a.id;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_key</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>PRIMARY</td>    <td>< derived2></td>    <td>ALL</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>NULL</td>    <td>2000010</td>    <td>NULL</td>  </tr>  <tr>    <td>1</td>    <td>PRIMARY</td>    <td>t</td>    <td>eq_ref</td>    <td>PRIMARY</td>    <td>PRIMARY</td>    <td>4</td>    <td>a.id</td>    <td>1</td>    <td>NULL</td>  </tr>    <tr>    <td>2</td>    <td>DERIVED</td>    <td>tb_item</td>    <td>index</td>    <td>NULL</td>    <td>PRIMARY</td>    <td>4</td>    <td>NULL</td>    <td>2903274</td>    <td>Using index</td>  </tr></table><h3 id="ä¼˜åŒ–æ€è·¯äºŒ"><a href="#ä¼˜åŒ–æ€è·¯äºŒ" class="headerlink" title="ä¼˜åŒ–æ€è·¯äºŒ"></a>ä¼˜åŒ–æ€è·¯äºŒ</h3><p>è¯¥æ–¹æ¡ˆé€‚ç”¨äº<strong>ä¸»é”®è‡ªå¢çš„è¡¨(ä¸”ä¸»é”®è‡ªå¢çš„åˆ—ä¸èƒ½å¤Ÿå‡ºç°æ–­å±‚)</strong>ï¼Œå¯ä»¥æŠŠlimit æŸ¥è¯¢è½¬æ¢æˆæŸä¸ªä½ç½®çš„æŸ¥è¯¢ï¼›  </p><p><strong>æ–­å±‚</strong>ï¼šå³æŒ‡çš„æ˜¯å½“åœ¨æŸ¥è¯¢æ•°æ®æ—¶ï¼Œidä¸»é”®è‡ªå¢åˆ—å½“ä¸­å¯èƒ½ä¼šæœ‰å‡ºç°ä¿®æ”¹æˆ–è€…åˆ é™¤çš„æ“ä½œï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™æ•°æ®å°±ä¸ä¸€å®šå‡†ç¡®äº†ï¼›</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_item <span class="keyword">where</span> <span class="keyword">id</span> &gt; <span class="number">1000000</span> <span class="keyword">limit</span> <span class="number">10</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_key</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>tb_item</td>    <td>range</td>    <td>PRIMARY</td>    <td>PRIMARY</td>    <td>4</td>    <td>NULL</td>    <td>4908049</td>    <td>Using where</td>  </tr></table><h2 id="SQLä¼˜åŒ–-ç´¢å¼•æç¤º"><a href="#SQLä¼˜åŒ–-ç´¢å¼•æç¤º" class="headerlink" title="SQLä¼˜åŒ– - ç´¢å¼•æç¤º"></a>SQLä¼˜åŒ– - ç´¢å¼•æç¤º</h2><p><strong>ä½¿ç”¨SQLæç¤º</strong>  </p><p>SQLæç¤ºï¼Œæ˜¯ä¼˜åŒ–æ•°æ®åº“çš„ä¸€ä¸ªé‡è¦æ‰‹æ®µï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯åœ¨SQLè¯­å¥ä¸­åŠ å…¥ä¸€äº›äººä¸ºçš„æç¤ºæ¥è¾¾åˆ°ä¼˜åŒ–æ“ä½œçš„ç›®çš„ã€‚  </p><h3 id="USE-INDEX"><a href="#USE-INDEX" class="headerlink" title="USE INDEX"></a>USE INDEX</h3><p>åœ¨æŸ¥è¯¢è¯­å¥ä¸­ è¡¨åç§°çš„åé¢ ï¼Œæ·»åŠ  use index æ¥æä¾›å¸Œæœ›MySQLå»<strong>å‚è€ƒ</strong>çš„ç´¢å¼•åˆ—è¡¨ï¼Œå°±å¯ä»¥è®©MySQLä¸å†è€ƒè™‘å…¶ä»–å¯ç”¨çš„ç´¢å¼•ã€‚  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_seller;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">index</span> <span class="keyword">from</span> tb_seller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> idx_seller_name <span class="keyword">on</span> tb_seller(<span class="keyword">name</span>);</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> idx_seller_status <span class="keyword">on</span> tb_seller(<span class="keyword">status</span>);</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> idx_seller_address <span class="keyword">on</span> tb_seller(address);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> idx_seller_name_sta_addr <span class="keyword">on</span> tb_seller(<span class="keyword">name</span>,<span class="keyword">status</span>,address);</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'å°ç±³ç§‘æŠ€'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_key</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>tb_seller</td>    <td>ref</td>    <td>idx_seller_name_sta_address,idx_seller_name</td>    <td>idx_seller_name(æ•°æ®åº“é€‰æ‹©ä½¿ç”¨idx_seller_nameç´¢å¼•)</td>    <td>403</td>    <td>const</td>    <td>1</td>    <td>Using index condition</td>  </tr></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">use</span> <span class="keyword">index</span>(idx_seller_name_sta_address) <span class="keyword">where</span> <span class="keyword">name</span> =<span class="string">'å°ç±³ç§‘æŠ€'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_key</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>tb_seller</td>    <td>ref</td>    <td>idx_seller_name_sta_address</td>    <td>idx_seller_name_sta_address</td>    <td>403</td>    <td>const</td>    <td>1</td>    <td>Using index condition</td>  </tr></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">use</span> <span class="keyword">index</span>(idx_seller_name) <span class="keyword">where</span> <span class="keyword">name</span> =<span class="string">'å°ç±³ç§‘æŠ€'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_key</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>tb_seller</td>    <td>ref</td>    <td>idx_seller_name</td>    <td>idx_seller_name</td>    <td>403</td>    <td>const</td>    <td>1</td>    <td>Using index condition</td>  </tr></table><h3 id="IGNORE-INDEX"><a href="#IGNORE-INDEX" class="headerlink" title="IGNORE INDEX"></a>IGNORE INDEX</h3><p>å¦‚æœç”¨æˆ·åªæ˜¯å•çº¯çš„æƒ³è®©MySQL<strong>å¿½ç•¥</strong>ä¸€ä¸ªæˆ–è€…å¤šä¸ªç´¢å¼•ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ ignore index ä½œä¸º hintï¼›</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">ignore</span> <span class="keyword">index</span>(idx_seller_name) <span class="keyword">where</span> <span class="keyword">name</span> =<span class="string">'å°ç±³ç§‘æŠ€'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_key</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>tb_seller</td>    <td>ref</td>    <td>idx_seller_name_sta_address</td>    <td>idx_seller_name_sta_address</td>    <td>403</td>    <td>const</td>    <td>1</td>    <td>Using index condition</td>  </tr></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">ignore</span> <span class="keyword">index</span>(idx_seller_name_sta_address) <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'å°ç±³ç§‘æŠ€'</span>;</span><br></pre></td></tr></table></figure><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_key</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>tb_seller</td>    <td>ref</td>    <td>idx_seller_name</td>    <td>idx_seller_name</td>    <td>403</td>    <td>const</td>    <td>1</td>    <td>Using index condition</td>  </tr></table><h3 id="FORCE-INDEX"><a href="#FORCE-INDEX" class="headerlink" title="FORCE INDEX"></a>FORCE INDEX</h3><p>ä¸ºäº†<strong>å¼ºåˆ¶</strong>MySQLä½¿ç”¨ä¸€ä¸ªç‰¹å®šçš„ç´¢å¼•ï¼Œå¯åœ¨æŸ¥è¯¢ä¸­ä½¿ç”¨ force index æ¥ä½œä¸º hint;</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> idx_seller_address <span class="keyword">on</span> tb_seller(address);</span><br></pre></td></tr></table></figure><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller <span class="keyword">where</span> address=<span class="string">'åŒ—äº¬å¸‚'</span>;#å®é™…æ²¡æœ‰ä½¿ç”¨åˆ°ç´¢å¼•ï¼›<span class="keyword">type</span>:<span class="keyword">all</span>;key:<span class="keyword">null</span>;key_len:<span class="keyword">null</span>;extra:<span class="keyword">using</span> <span class="keyword">where</span>ä½¿ç”¨çš„æ˜¯å…¨è¡¨æ‰«æï¼›åŸå› åœ¨äºaddressä¸ºåŒ—äº¬å¸‚æ—¶åœ¨è¡¨å½“ä¸­å æ¯”è¾ƒå¤šæ‰€ä»¥ç”±mysqlåº•å±‚åˆ¤æ–­å†³å®šä¸èµ°ç´¢å¼•å³å…¨è¡¨æ‰«æä¼šå¿«äºèµ°ç´¢å¼•ï¼›æ‰€ä»¥æ­¤å¤„æ²¡æœ‰ä½¿ç”¨å¾—åˆ°ç´¢å¼•ï¼›</span><br><span class="line"></span><br><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> tb_seller use <span class="keyword">index</span>(idx_seller_address) <span class="keyword">where</span> address=<span class="string">'åŒ—äº¬å¸‚'</span>;#æ­¤æ—¶åˆ™èµ°ç´¢å¼•</span><br></pre></td></tr></table></figure><table>  <tr>    <th>id</th>    <th>select_type</th>    <th>table</th>    <th>type</th>    <th>possible_key</th>    <th>key</th>    <th>key_len</th>    <th>ref</th>    <th>rows</th>    <th>Extra</th>  </tr>  <tr>    <td>1</td>    <td>SIMPLE</td>    <td>tb_seller</td>    <td>ALL</td>    <td>idx_seller_address</td>    <td>idx_seller_address</td>    <td>NULL</td>    <td>NULL</td>    <td>12</td>    <td>Using where</td>  </tr></table>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;è§‚çœ‹ç¬”è®°ï¼š&lt;code&gt;https://www.bilibili.com/video/BV1fJ41127Rj?from=search&amp;amp
      
    
    </summary>
    
    
      <category term="ç¬”è®°" scheme="https://fengshana.github.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="ç¬”è®°" scheme="https://fengshana.github.io/tags/%E7%AC%94%E8%AE%B0/"/>
    
      <category term="MySQL" scheme="https://fengshana.github.io/tags/MySQL/"/>
    
      <category term="æ•°æ®åº“ä¼˜åŒ–" scheme="https://fengshana.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>å²ä¸Šæœ€å¥½~ç²¾é€šSpring Boot Cloud - åœ£æ€å›­</title>
    <link href="https://fengshana.github.io/2020/05/29/%E3%80%90Spring%E3%80%91/%E5%8F%B2%E4%B8%8A%E6%9C%80%E5%A5%BD~%E7%B2%BE%E9%80%9ASpring%20Boot%20Cloud%20-%20%E5%9C%A3%E6%80%9D%E5%9B%AD/"/>
    <id>https://fengshana.github.io/2020/05/29/%E3%80%90Spring%E3%80%91/%E5%8F%B2%E4%B8%8A%E6%9C%80%E5%A5%BD~%E7%B2%BE%E9%80%9ASpring%20Boot%20Cloud%20-%20%E5%9C%A3%E6%80%9D%E5%9B%AD/</id>
    <published>2020-05-29T11:04:48.100Z</published>
    <updated>2020-06-05T17:53:31.670Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è§‚çœ‹ç¬”è®°ï¼š<code>https://www.bilibili.com/video/BV1Eg4y187XT</code>  </p><h2 id="å­¦ä¹ æ–¹æ³•è°ˆå¿ƒ"><a href="#å­¦ä¹ æ–¹æ³•è°ˆå¿ƒ" class="headerlink" title="å­¦ä¹ æ–¹æ³•è°ˆå¿ƒ"></a>å­¦ä¹ æ–¹æ³•è°ˆå¿ƒ</h2><h2 id="SpringBootä¸Cloudæ•´ä½“ä»‹ç»"><a href="#SpringBootä¸Cloudæ•´ä½“ä»‹ç»" class="headerlink" title="SpringBootä¸Cloudæ•´ä½“ä»‹ç»"></a>SpringBootä¸Cloudæ•´ä½“ä»‹ç»</h2><h2 id="è¯¾ç¨‹å¤§çº²æ·±å…¥è§£è¯»ä¸å‰–æ"><a href="#è¯¾ç¨‹å¤§çº²æ·±å…¥è§£è¯»ä¸å‰–æ" class="headerlink" title="è¯¾ç¨‹å¤§çº²æ·±å…¥è§£è¯»ä¸å‰–æ"></a>è¯¾ç¨‹å¤§çº²æ·±å…¥è§£è¯»ä¸å‰–æ</h2><h2 id="å¾®æœåŠ¡é‡è¦æ¦‚å¿µä¸æƒå¨è§£è¯»"><a href="#å¾®æœåŠ¡é‡è¦æ¦‚å¿µä¸æƒå¨è§£è¯»" class="headerlink" title="å¾®æœåŠ¡é‡è¦æ¦‚å¿µä¸æƒå¨è§£è¯»"></a>å¾®æœåŠ¡é‡è¦æ¦‚å¿µä¸æƒå¨è§£è¯»</h2><h2 id="è§£è¯»å¾®æœåŠ¡é‡è¦è®ºæ–‡"><a href="#è§£è¯»å¾®æœåŠ¡é‡è¦è®ºæ–‡" class="headerlink" title="è§£è¯»å¾®æœåŠ¡é‡è¦è®ºæ–‡"></a>è§£è¯»å¾®æœåŠ¡é‡è¦è®ºæ–‡</h2><h2 id="æ·±åˆ»è§£è¯»Martin-Fowlerå¾®æœåŠ¡ç»å…¸æ–‡ç« "><a href="#æ·±åˆ»è§£è¯»Martin-Fowlerå¾®æœåŠ¡ç»å…¸æ–‡ç« " class="headerlink" title="æ·±åˆ»è§£è¯»Martin Fowlerå¾®æœåŠ¡ç»å…¸æ–‡ç« "></a>æ·±åˆ»è§£è¯»Martin Fowlerå¾®æœåŠ¡ç»å…¸æ–‡ç« </h2><h2 id="å¾®æœåŠ¡æ•°æ®æ²»ç†ä¸å»ä¸­å¿ƒåŒ–è§£è¯»"><a href="#å¾®æœåŠ¡æ•°æ®æ²»ç†ä¸å»ä¸­å¿ƒåŒ–è§£è¯»" class="headerlink" title="å¾®æœåŠ¡æ•°æ®æ²»ç†ä¸å»ä¸­å¿ƒåŒ–è§£è¯»"></a>å¾®æœåŠ¡æ•°æ®æ²»ç†ä¸å»ä¸­å¿ƒåŒ–è§£è¯»</h2><h2 id="å¾®æœåŠ¡æ¼”è¿›å¼è®¾è®¡ä¸ä¼˜ç¼ºç‚¹å‰–æ"><a href="#å¾®æœåŠ¡æ¼”è¿›å¼è®¾è®¡ä¸ä¼˜ç¼ºç‚¹å‰–æ" class="headerlink" title="å¾®æœåŠ¡æ¼”è¿›å¼è®¾è®¡ä¸ä¼˜ç¼ºç‚¹å‰–æ"></a>å¾®æœåŠ¡æ¼”è¿›å¼è®¾è®¡ä¸ä¼˜ç¼ºç‚¹å‰–æ</h2><h2 id="å¾®æœåŠ¡å®è§‚æŠŠæ§ä¸æ·±åº¦å‰–æ"><a href="#å¾®æœåŠ¡å®è§‚æŠŠæ§ä¸æ·±åº¦å‰–æ" class="headerlink" title="å¾®æœåŠ¡å®è§‚æŠŠæ§ä¸æ·±åº¦å‰–æ"></a>å¾®æœåŠ¡å®è§‚æŠŠæ§ä¸æ·±åº¦å‰–æ</h2><h2 id="SOAç†è®ºä¸æ¦‚å¿µæ·±å…¥å‰–æ"><a href="#SOAç†è®ºä¸æ¦‚å¿µæ·±å…¥å‰–æ" class="headerlink" title="SOAç†è®ºä¸æ¦‚å¿µæ·±å…¥å‰–æ"></a>SOAç†è®ºä¸æ¦‚å¿µæ·±å…¥å‰–æ</h2><h2 id="æœåŠ¡å®šä¹‰æ¦‚å¿µä¸åŸåˆ™"><a href="#æœåŠ¡å®šä¹‰æ¦‚å¿µä¸åŸåˆ™" class="headerlink" title="æœåŠ¡å®šä¹‰æ¦‚å¿µä¸åŸåˆ™"></a>æœåŠ¡å®šä¹‰æ¦‚å¿µä¸åŸåˆ™</h2><h2 id="SOAå®ç°æ–¹å¼ä¸æ¨¡å¼"><a href="#SOAå®ç°æ–¹å¼ä¸æ¨¡å¼" class="headerlink" title="SOAå®ç°æ–¹å¼ä¸æ¨¡å¼"></a>SOAå®ç°æ–¹å¼ä¸æ¨¡å¼</h2><h2 id="SOAçš„ç¼ºé™·åŠå…¶ä¸å¾®æœåŠ¡çš„å…³ç³»"><a href="#SOAçš„ç¼ºé™·åŠå…¶ä¸å¾®æœåŠ¡çš„å…³ç³»" class="headerlink" title="SOAçš„ç¼ºé™·åŠå…¶ä¸å¾®æœåŠ¡çš„å…³ç³»"></a>SOAçš„ç¼ºé™·åŠå…¶ä¸å¾®æœåŠ¡çš„å…³ç³»</h2><h2 id="SOAä¸å¾®æœåŠ¡æœ¬è´¨æ¯”è¾ƒä¸é€å½»åˆ†æ"><a href="#SOAä¸å¾®æœåŠ¡æœ¬è´¨æ¯”è¾ƒä¸é€å½»åˆ†æ" class="headerlink" title="SOAä¸å¾®æœåŠ¡æœ¬è´¨æ¯”è¾ƒä¸é€å½»åˆ†æ"></a>SOAä¸å¾®æœåŠ¡æœ¬è´¨æ¯”è¾ƒä¸é€å½»åˆ†æ</h2><h2 id="SpringBootåº”ç”¨èµ·æ­¥ä¸é…ç½®"><a href="#SpringBootåº”ç”¨èµ·æ­¥ä¸é…ç½®" class="headerlink" title="SpringBootåº”ç”¨èµ·æ­¥ä¸é…ç½®"></a>SpringBootåº”ç”¨èµ·æ­¥ä¸é…ç½®</h2><h2 id="SpringBootåº”ç”¨é…ç½®åˆ†æä¸æ‹†è§£"><a href="#SpringBootåº”ç”¨é…ç½®åˆ†æä¸æ‹†è§£" class="headerlink" title="SpringBootåº”ç”¨é…ç½®åˆ†æä¸æ‹†è§£"></a>SpringBootåº”ç”¨é…ç½®åˆ†æä¸æ‹†è§£</h2><h2 id="SpringBootæ‰“åŒ…æ–‡ä»¶å†…å®¹ä¸ç»“æ„æ·±å…¥åˆ†æ"><a href="#SpringBootæ‰“åŒ…æ–‡ä»¶å†…å®¹ä¸ç»“æ„æ·±å…¥åˆ†æ" class="headerlink" title="SpringBootæ‰“åŒ…æ–‡ä»¶å†…å®¹ä¸ç»“æ„æ·±å…¥åˆ†æ"></a>SpringBootæ‰“åŒ…æ–‡ä»¶å†…å®¹ä¸ç»“æ„æ·±å…¥åˆ†æ</h2><h2 id="ä½¿ç”¨Gradleæ„å»ºSpringBootåº”ç”¨"><a href="#ä½¿ç”¨Gradleæ„å»ºSpringBootåº”ç”¨" class="headerlink" title="ä½¿ç”¨Gradleæ„å»ºSpringBootåº”ç”¨"></a>ä½¿ç”¨Gradleæ„å»ºSpringBootåº”ç”¨</h2><h2 id="SpringBootå‚æ•°è‡ªåŠ¨è£…é…ä¸loaderæœºåˆ¶è¯¦ç»†åˆ†æ"><a href="#SpringBootå‚æ•°è‡ªåŠ¨è£…é…ä¸loaderæœºåˆ¶è¯¦ç»†åˆ†æ" class="headerlink" title="SpringBootå‚æ•°è‡ªåŠ¨è£…é…ä¸loaderæœºåˆ¶è¯¦ç»†åˆ†æ"></a>SpringBootå‚æ•°è‡ªåŠ¨è£…é…ä¸loaderæœºåˆ¶è¯¦ç»†åˆ†æ</h2><h2 id="SpringBootLoaderæºç åˆ†æåŠè‡ªå®šä¹‰ç±»åŠ è½½å™¨ä½œç”¨åˆ†æ"><a href="#SpringBootLoaderæºç åˆ†æåŠè‡ªå®šä¹‰ç±»åŠ è½½å™¨ä½œç”¨åˆ†æ" class="headerlink" title="SpringBootLoaderæºç åˆ†æåŠè‡ªå®šä¹‰ç±»åŠ è½½å™¨ä½œç”¨åˆ†æ"></a>SpringBootLoaderæºç åˆ†æåŠè‡ªå®šä¹‰ç±»åŠ è½½å™¨ä½œç”¨åˆ†æ</h2><h2 id="LaunchedURLClassLoaderåœ¨FatJarä¸­çš„é‡è¦ä½œç”¨åˆ†æåŠåå°„çš„ç»å…¸åº”ç”¨"><a href="#LaunchedURLClassLoaderåœ¨FatJarä¸­çš„é‡è¦ä½œç”¨åˆ†æåŠåå°„çš„ç»å…¸åº”ç”¨" class="headerlink" title="LaunchedURLClassLoaderåœ¨FatJarä¸­çš„é‡è¦ä½œç”¨åˆ†æåŠåå°„çš„ç»å…¸åº”ç”¨"></a>LaunchedURLClassLoaderåœ¨FatJarä¸­çš„é‡è¦ä½œç”¨åˆ†æåŠåå°„çš„ç»å…¸åº”ç”¨</h2><h2 id="JDWPè¿œç¨‹è°ƒè¯•è¯¦è§£"><a href="#JDWPè¿œç¨‹è°ƒè¯•è¯¦è§£" class="headerlink" title="JDWPè¿œç¨‹è°ƒè¯•è¯¦è§£"></a>JDWPè¿œç¨‹è°ƒè¯•è¯¦è§£</h2><h2 id="è°ƒè¯•spring-boot-loaderçš„å¯åŠ¨ä¸åŠ è½½å…¨æµç¨‹"><a href="#è°ƒè¯•spring-boot-loaderçš„å¯åŠ¨ä¸åŠ è½½å…¨æµç¨‹" class="headerlink" title="è°ƒè¯•spring-boot-loaderçš„å¯åŠ¨ä¸åŠ è½½å…¨æµç¨‹"></a>è°ƒè¯•spring-boot-loaderçš„å¯åŠ¨ä¸åŠ è½½å…¨æµç¨‹</h2><h2 id="SpringBootApplicationæ³¨è§£æ·±åº¦è§£æ"><a href="#SpringBootApplicationæ³¨è§£æ·±åº¦è§£æ" class="headerlink" title="@SpringBootApplicationæ³¨è§£æ·±åº¦è§£æ"></a>@SpringBootApplicationæ³¨è§£æ·±åº¦è§£æ</h2><h2 id="Configurationæ³¨è§£æ·±å…¥è®²è§£"><a href="#Configurationæ³¨è§£æ·±å…¥è®²è§£" class="headerlink" title="@Configurationæ³¨è§£æ·±å…¥è®²è§£"></a>@Configurationæ³¨è§£æ·±å…¥è®²è§£</h2><h2 id="SpringApplicationæºç åˆ†æä¸ä½œç”¨è¯¦è§£"><a href="#SpringApplicationæºç åˆ†æä¸ä½œç”¨è¯¦è§£" class="headerlink" title="SpringApplicationæºç åˆ†æä¸ä½œç”¨è¯¦è§£"></a>SpringApplicationæºç åˆ†æä¸ä½œç”¨è¯¦è§£</h2><h2 id="SpringBootåº”ç”¨å¯åŠ¨æµç¨‹æºç åˆ†æ"><a href="#SpringBootåº”ç”¨å¯åŠ¨æµç¨‹æºç åˆ†æ" class="headerlink" title="SpringBootåº”ç”¨å¯åŠ¨æµç¨‹æºç åˆ†æ"></a>SpringBootåº”ç”¨å¯åŠ¨æµç¨‹æºç åˆ†æ</h2><h2 id="SpringBootå¯åŠ¨æµç¨‹åˆ†æ"><a href="#SpringBootå¯åŠ¨æµç¨‹åˆ†æ" class="headerlink" title="SpringBootå¯åŠ¨æµç¨‹åˆ†æ"></a>SpringBootå¯åŠ¨æµç¨‹åˆ†æ</h2><h2 id="SpringApplicationæ³›åŒ–ä¸å…·ä½“æ¨¡å¼å‰–æ"><a href="#SpringApplicationæ³›åŒ–ä¸å…·ä½“æ¨¡å¼å‰–æ" class="headerlink" title="SpringApplicationæ³›åŒ–ä¸å…·ä½“æ¨¡å¼å‰–æ"></a>SpringApplicationæ³›åŒ–ä¸å…·ä½“æ¨¡å¼å‰–æ</h2><h2 id="å·¥å‚åŠ è½½æœºåˆ¶è¯¦å°½åˆ†æ"><a href="#å·¥å‚åŠ è½½æœºåˆ¶è¯¦å°½åˆ†æ" class="headerlink" title="å·¥å‚åŠ è½½æœºåˆ¶è¯¦å°½åˆ†æ"></a>å·¥å‚åŠ è½½æœºåˆ¶è¯¦å°½åˆ†æ</h2><h2 id="å·¥å‚ç¼“å­˜æºç æ·±åº¦è§£æ"><a href="#å·¥å‚ç¼“å­˜æºç æ·±åº¦è§£æ" class="headerlink" title="å·¥å‚ç¼“å­˜æºç æ·±åº¦è§£æ"></a>å·¥å‚ç¼“å­˜æºç æ·±åº¦è§£æ</h2><h2 id="Springå·¥å‚BeanåŠ è½½è¿‡ç¨‹æ·±åº¦è§£æ"><a href="#Springå·¥å‚BeanåŠ è½½è¿‡ç¨‹æ·±åº¦è§£æ" class="headerlink" title="Springå·¥å‚BeanåŠ è½½è¿‡ç¨‹æ·±åº¦è§£æ"></a>Springå·¥å‚BeanåŠ è½½è¿‡ç¨‹æ·±åº¦è§£æ</h2><h2 id="SpringApplicationæ„é€ è¿‡ç¨‹å…¨æ™¯åˆ†æ"><a href="#SpringApplicationæ„é€ è¿‡ç¨‹å…¨æ™¯åˆ†æ" class="headerlink" title="SpringApplicationæ„é€ è¿‡ç¨‹å…¨æ™¯åˆ†æ"></a>SpringApplicationæ„é€ è¿‡ç¨‹å…¨æ™¯åˆ†æ</h2><h2 id="ApplicationContextä¸­å¤®åŒ–ç»„ä»¶ä½œç”¨è¯¦è§£"><a href="#ApplicationContextä¸­å¤®åŒ–ç»„ä»¶ä½œç”¨è¯¦è§£" class="headerlink" title="ApplicationContextä¸­å¤®åŒ–ç»„ä»¶ä½œç”¨è¯¦è§£"></a>ApplicationContextä¸­å¤®åŒ–ç»„ä»¶ä½œç”¨è¯¦è§£</h2><h2 id="SpringApplicationRunListenersç›‘å¬å™¨å®¹å™¨è¯¦è§£"><a href="#SpringApplicationRunListenersç›‘å¬å™¨å®¹å™¨è¯¦è§£" class="headerlink" title="SpringApplicationRunListenersç›‘å¬å™¨å®¹å™¨è¯¦è§£"></a>SpringApplicationRunListenersç›‘å¬å™¨å®¹å™¨è¯¦è§£</h2><h2 id="è§‚å¯Ÿç€æ¨¡å¼åœ¨SpringBootä¸­çš„ç»å…¸åº”ç”¨"><a href="#è§‚å¯Ÿç€æ¨¡å¼åœ¨SpringBootä¸­çš„ç»å…¸åº”ç”¨" class="headerlink" title="è§‚å¯Ÿç€æ¨¡å¼åœ¨SpringBootä¸­çš„ç»å…¸åº”ç”¨"></a>è§‚å¯Ÿç€æ¨¡å¼åœ¨SpringBootä¸­çš„ç»å…¸åº”ç”¨</h2><h2 id="Environmentç»„ä»¶çš„é‡è¦ä½œç”¨è¯¦è§£"><a href="#Environmentç»„ä»¶çš„é‡è¦ä½œç”¨è¯¦è§£" class="headerlink" title="Environmentç»„ä»¶çš„é‡è¦ä½œç”¨è¯¦è§£"></a>Environmentç»„ä»¶çš„é‡è¦ä½œç”¨è¯¦è§£</h2><h2 id="Bannerä¿¡æ¯è¾“å‡ºä¸å®šåˆ¶å†…å¹•åˆ†æ"><a href="#Bannerä¿¡æ¯è¾“å‡ºä¸å®šåˆ¶å†…å¹•åˆ†æ" class="headerlink" title="Bannerä¿¡æ¯è¾“å‡ºä¸å®šåˆ¶å†…å¹•åˆ†æ"></a>Bannerä¿¡æ¯è¾“å‡ºä¸å®šåˆ¶å†…å¹•åˆ†æ</h2><h2 id="SpringBootå®Œæ•´å¯åŠ¨æµç¨‹ç³»ç»ŸåŒ–æ€»ç»“"><a href="#SpringBootå®Œæ•´å¯åŠ¨æµç¨‹ç³»ç»ŸåŒ–æ€»ç»“" class="headerlink" title="SpringBootå®Œæ•´å¯åŠ¨æµç¨‹ç³»ç»ŸåŒ–æ€»ç»“"></a>SpringBootå®Œæ•´å¯åŠ¨æµç¨‹ç³»ç»ŸåŒ–æ€»ç»“</h2><h2 id="SpringBooté‡è¦æ¨¡å—è¯¦è§£"><a href="#SpringBooté‡è¦æ¨¡å—è¯¦è§£" class="headerlink" title="SpringBooté‡è¦æ¨¡å—è¯¦è§£"></a>SpringBooté‡è¦æ¨¡å—è¯¦è§£</h2><h2 id="SpringBootæ—¥å¿—å¤„ç†è¯¦è§£"><a href="#SpringBootæ—¥å¿—å¤„ç†è¯¦è§£" class="headerlink" title="SpringBootæ—¥å¿—å¤„ç†è¯¦è§£"></a>SpringBootæ—¥å¿—å¤„ç†è¯¦è§£</h2><h2 id="SpringBootæ•´åˆJSPè¯¦è§£"><a href="#SpringBootæ•´åˆJSPè¯¦è§£" class="headerlink" title="SpringBootæ•´åˆJSPè¯¦è§£"></a>SpringBootæ•´åˆJSPè¯¦è§£</h2><h2 id="SpringBootæ•´åˆWebSocketè¯¦è§£"><a href="#SpringBootæ•´åˆWebSocketè¯¦è§£" class="headerlink" title="SpringBootæ•´åˆWebSocketè¯¦è§£"></a>SpringBootæ•´åˆWebSocketè¯¦è§£</h2><h2 id="SpringBootæ•´åˆSockJSè¯¦è§£"><a href="#SpringBootæ•´åˆSockJSè¯¦è§£" class="headerlink" title="SpringBootæ•´åˆSockJSè¯¦è§£"></a>SpringBootæ•´åˆSockJSè¯¦è§£</h2><h2 id="SpringBootå¼€å‘è€…å·¥å…·ä¸å•å…ƒæµ‹è¯•è¯¦è§£"><a href="#SpringBootå¼€å‘è€…å·¥å…·ä¸å•å…ƒæµ‹è¯•è¯¦è§£" class="headerlink" title="SpringBootå¼€å‘è€…å·¥å…·ä¸å•å…ƒæµ‹è¯•è¯¦è§£"></a>SpringBootå¼€å‘è€…å·¥å…·ä¸å•å…ƒæµ‹è¯•è¯¦è§£</h2><h2 id="Apache-Kafkaä»‹ç»ä¸é¢å‘MQç¼–ç¨‹æ¨¡å¼è¯¦è§£"><a href="#Apache-Kafkaä»‹ç»ä¸é¢å‘MQç¼–ç¨‹æ¨¡å¼è¯¦è§£" class="headerlink" title="Apache Kafkaä»‹ç»ä¸é¢å‘MQç¼–ç¨‹æ¨¡å¼è¯¦è§£"></a>Apache Kafkaä»‹ç»ä¸é¢å‘MQç¼–ç¨‹æ¨¡å¼è¯¦è§£</h2><h2 id="Apache-Kafkaæ ¸å¿ƒAPIä¸è®¾è®¡ç†å¿µè¯¦è§£"><a href="#Apache-Kafkaæ ¸å¿ƒAPIä¸è®¾è®¡ç†å¿µè¯¦è§£" class="headerlink" title="Apache Kafkaæ ¸å¿ƒAPIä¸è®¾è®¡ç†å¿µè¯¦è§£"></a>Apache Kafkaæ ¸å¿ƒAPIä¸è®¾è®¡ç†å¿µè¯¦è§£</h2><h2 id="Apache-Kafkaåˆ†åŒºå‰¯æœ¬ä¸æ¶ˆè´¹è€…ç»„è¯¦è§£"><a href="#Apache-Kafkaåˆ†åŒºå‰¯æœ¬ä¸æ¶ˆè´¹è€…ç»„è¯¦è§£" class="headerlink" title="Apache Kafkaåˆ†åŒºå‰¯æœ¬ä¸æ¶ˆè´¹è€…ç»„è¯¦è§£"></a>Apache Kafkaåˆ†åŒºå‰¯æœ¬ä¸æ¶ˆè´¹è€…ç»„è¯¦è§£</h2><h2 id="Apache-Kafkaæµå¼å¤„ç†è¯¦è§£"><a href="#Apache-Kafkaæµå¼å¤„ç†è¯¦è§£" class="headerlink" title="Apache Kafkaæµå¼å¤„ç†è¯¦è§£"></a>Apache Kafkaæµå¼å¤„ç†è¯¦è§£</h2><h2 id="Apache-Kafkaç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…å®ä¾‹æ¼”ç¤ºä¸è§£æ"><a href="#Apache-Kafkaç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…å®ä¾‹æ¼”ç¤ºä¸è§£æ" class="headerlink" title="Apache Kafkaç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…å®ä¾‹æ¼”ç¤ºä¸è§£æ"></a>Apache Kafkaç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…å®ä¾‹æ¼”ç¤ºä¸è§£æ</h2><h2 id="Apache-Kafkaé‡ç‚¹å†…å®¹å‰–æä¸å›é¡¾"><a href="#Apache-Kafkaé‡ç‚¹å†…å®¹å‰–æä¸å›é¡¾" class="headerlink" title="Apache Kafkaé‡ç‚¹å†…å®¹å‰–æä¸å›é¡¾"></a>Apache Kafkaé‡ç‚¹å†…å®¹å‰–æä¸å›é¡¾</h2><h2 id="Apache-Kafkaåˆ†åŒºæ„æˆä¸åŸåˆ™è¯¦è§£"><a href="#Apache-Kafkaåˆ†åŒºæ„æˆä¸åŸåˆ™è¯¦è§£" class="headerlink" title="Apache Kafkaåˆ†åŒºæ„æˆä¸åŸåˆ™è¯¦è§£"></a>Apache Kafkaåˆ†åŒºæ„æˆä¸åŸåˆ™è¯¦è§£</h2><h2 id="Apache-Kafkaåˆ†åŒºç†è®ºä¸ä½œç”¨è¯¦è§£"><a href="#Apache-Kafkaåˆ†åŒºç†è®ºä¸ä½œç”¨è¯¦è§£" class="headerlink" title="Apache Kafkaåˆ†åŒºç†è®ºä¸ä½œç”¨è¯¦è§£"></a>Apache Kafkaåˆ†åŒºç†è®ºä¸ä½œç”¨è¯¦è§£</h2><h2 id="Apache-Kafkaåˆ†åŒºä¸æ®µä¹‹é—´çš„å…³ç³»æ·±å…¥è¯¦è§£"><a href="#Apache-Kafkaåˆ†åŒºä¸æ®µä¹‹é—´çš„å…³ç³»æ·±å…¥è¯¦è§£" class="headerlink" title="Apache Kafkaåˆ†åŒºä¸æ®µä¹‹é—´çš„å…³ç³»æ·±å…¥è¯¦è§£"></a>Apache Kafkaåˆ†åŒºä¸æ®µä¹‹é—´çš„å…³ç³»æ·±å…¥è¯¦è§£</h2><h2 id="Apache-Kafkaæ—¥å¿—æ–‡ä»¶æ ¼å¼è¯¦è§£"><a href="#Apache-Kafkaæ—¥å¿—æ–‡ä»¶æ ¼å¼è¯¦è§£" class="headerlink" title="Apache Kafkaæ—¥å¿—æ–‡ä»¶æ ¼å¼è¯¦è§£"></a>Apache Kafkaæ—¥å¿—æ–‡ä»¶æ ¼å¼è¯¦è§£</h2><h2 id="Apache-Kafkaè„šæœ¬å‘½ä»¤å®æˆ˜è¯¦è§£"><a href="#Apache-Kafkaè„šæœ¬å‘½ä»¤å®æˆ˜è¯¦è§£" class="headerlink" title="Apache Kafkaè„šæœ¬å‘½ä»¤å®æˆ˜è¯¦è§£"></a>Apache Kafkaè„šæœ¬å‘½ä»¤å®æˆ˜è¯¦è§£</h2><h2 id="Apache-Kafkaæ¶ˆè´¹è€…ç»„æ“ä½œä¸ä¸»é¢˜åˆ é™¤åŸç†è¯¦è§£"><a href="#Apache-Kafkaæ¶ˆè´¹è€…ç»„æ“ä½œä¸ä¸»é¢˜åˆ é™¤åŸç†è¯¦è§£" class="headerlink" title="Apache Kafkaæ¶ˆè´¹è€…ç»„æ“ä½œä¸ä¸»é¢˜åˆ é™¤åŸç†è¯¦è§£"></a>Apache Kafkaæ¶ˆè´¹è€…ç»„æ“ä½œä¸ä¸»é¢˜åˆ é™¤åŸç†è¯¦è§£</h2><h2 id="Apache-Kafkaé‡è¦æ“ä½œè¯¦è§£ä¸ç³»ç»Ÿæ€»ç»“å›é¡¾"><a href="#Apache-Kafkaé‡è¦æ“ä½œè¯¦è§£ä¸ç³»ç»Ÿæ€»ç»“å›é¡¾" class="headerlink" title="Apache Kafkaé‡è¦æ“ä½œè¯¦è§£ä¸ç³»ç»Ÿæ€»ç»“å›é¡¾"></a>Apache Kafkaé‡è¦æ“ä½œè¯¦è§£ä¸ç³»ç»Ÿæ€»ç»“å›é¡¾</h2><h2 id="SpringBootæ•´åˆApache-Kafkaè¯¦è§£"><a href="#SpringBootæ•´åˆApache-Kafkaè¯¦è§£" class="headerlink" title="SpringBootæ•´åˆApache Kafkaè¯¦è§£"></a>SpringBootæ•´åˆApache Kafkaè¯¦è§£</h2><h2 id="SpringBootæ“çºµApache-Kafkaå®ä¾‹åˆ†æ"><a href="#SpringBootæ“çºµApache-Kafkaå®ä¾‹åˆ†æ" class="headerlink" title="SpringBootæ“çºµApache Kafkaå®ä¾‹åˆ†æ"></a>SpringBootæ“çºµApache Kafkaå®ä¾‹åˆ†æ</h2><h2 id="ä¸»æµæ¶ˆæ¯é˜Ÿåˆ—äº§å“æ€»ç»“ä¸åˆ†æ"><a href="#ä¸»æµæ¶ˆæ¯é˜Ÿåˆ—äº§å“æ€»ç»“ä¸åˆ†æ" class="headerlink" title="ä¸»æµæ¶ˆæ¯é˜Ÿåˆ—äº§å“æ€»ç»“ä¸åˆ†æ"></a>ä¸»æµæ¶ˆæ¯é˜Ÿåˆ—äº§å“æ€»ç»“ä¸åˆ†æ</h2><h2 id="SpringBootå¯¹äºSpringMVCçš„æ•´åˆåŸç†æ·±åº¦è§£æ"><a href="#SpringBootå¯¹äºSpringMVCçš„æ•´åˆåŸç†æ·±åº¦è§£æ" class="headerlink" title="SpringBootå¯¹äºSpringMVCçš„æ•´åˆåŸç†æ·±åº¦è§£æ"></a>SpringBootå¯¹äºSpringMVCçš„æ•´åˆåŸç†æ·±åº¦è§£æ</h2><h2 id="SpringServletContainerInitializeråˆå§‹åŒ–æµç¨‹è¯¦è§£"><a href="#SpringServletContainerInitializeråˆå§‹åŒ–æµç¨‹è¯¦è§£" class="headerlink" title="SpringServletContainerInitializeråˆå§‹åŒ–æµç¨‹è¯¦è§£"></a>SpringServletContainerInitializeråˆå§‹åŒ–æµç¨‹è¯¦è§£</h2>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;è§‚çœ‹ç¬”è®°ï¼š&lt;code&gt;https://www.bilibili.com/video/BV1Eg4y187XT&lt;/code&gt;  &lt;/p&gt;
&lt;h
      
    
    </summary>
    
    
      <category term="jdk8" scheme="https://fengshana.github.io/categories/jdk8/"/>
    
    
      <category term="java" scheme="https://fengshana.github.io/tags/java/"/>
    
      <category term="SprigBoot" scheme="https://fengshana.github.io/tags/SprigBoot/"/>
    
  </entry>
  
  <entry>
    <title>MicroservicesGuide-èµ°è¿‘å¾®æœåŠ¡</title>
    <link href="https://fengshana.github.io/2020/05/27/%E3%80%90MICROSERVICES%E3%80%91/%E3%80%90MICROSERVICES%E3%80%91MicroservicesGuide-%E8%B5%B0%E8%BF%91%E5%BE%AE%E6%9C%8D%E5%8A%A1/"/>
    <id>https://fengshana.github.io/2020/05/27/%E3%80%90MICROSERVICES%E3%80%91/%E3%80%90MICROSERVICES%E3%80%91MicroservicesGuide-%E8%B5%B0%E8%BF%91%E5%BE%AE%E6%9C%8D%E5%8A%A1/</id>
    <published>2020-05-27T10:36:35.464Z</published>
    <updated>2020-06-05T17:56:56.269Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote><p>Nothing better than a buzy Saturday morning.</p></blockquote><p>ä¸ºä»€ä¹ˆæƒ³è¦ç¿»è¯‘è¿™ç¯‡åšå®¢å‘¢ï¼Œå› ä¸ºä¹Ÿæ˜¯çœ‹äº†bç«™ä¸Šçš„ä¸€ä¸ªå­¦ä¹ springbootçš„ä¸€ä¸ªè§†é¢‘ï¼Œè€Œä¸”æˆ‘ä»Šå¤©é¢è¯•çš„æ—¶å€™äººå®¶é—®äº†å¾®æœåŠ¡æ˜¯ä»€ä¹ˆï¼Œç„¶åç”±æ­¤å¯å¾—æˆ‘ä¸‡åˆ†åæ‚”æ²¡æœ‰å½“æ—¶é€šç¯‡ç¿»è¯‘è¿™ç¯‡åšå®¢ã€‚<br>å¥½äº†ç°åœ¨åæ‚”ä¹ŸæŒ½æ•‘ä¸äº†æˆ‘çš„æ„šä¸å¯åŠäº†ã€‚<br>è§‚çœ‹ç¬”è®°ï¼š<code>https://www.bilibili.com/video/BV1Eg4y187XT</code><br>å°±æ˜¯è¿™ä¸ªè§†é¢‘å‘Šè¯‰äº†æˆ‘ï¼šæ¨èçœ‹å“¦~<br>ä¸ºäº†ä¸åæ‚”ï¼Œä»¥åæ¯ä»¶äº‹æƒ…ï¼Œèƒ½åšç¬”è®°å°±ä¸€å®šè¦å‹ç€è‡ªå·±åšï¼Œä¸ç„¶ä¼šåæ‚”çš„ï¼›  </p><h2 id="Microservices-Guide-å¾®æœåŠ¡æŒ‡å—ï¼ˆç¿»è¯‘ï¼‰"><a href="#Microservices-Guide-å¾®æœåŠ¡æŒ‡å—ï¼ˆç¿»è¯‘ï¼‰" class="headerlink" title="Microservices Guide å¾®æœåŠ¡æŒ‡å—ï¼ˆç¿»è¯‘ï¼‰"></a>Microservices Guide å¾®æœåŠ¡æŒ‡å—ï¼ˆç¿»è¯‘ï¼‰</h2><p>é“¾æ¥ï¼š<code>https://www.martinfowler.com/microservices/</code>  </p><blockquote><p>A guide to material on martinfowler.com about microservices.<br><strong>Matin Fowler</strong><br>21 Aug 2019  </p></blockquote><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">martinfowler.comç½‘ç«™å…³äºå¾®æœåŠ¡çš„ä¸€ä¸ªææ–™æŒ‡å—</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">--------------------------------------------------------</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">æœ‰é“è¯å…¸ç¿»è¯‘ï¼š</span></span><br><span class="line"><span class="keyword">martinfowler.com </span>ä¸Šå…³äºå¾®æœåŠ¡çš„ææ–™æŒ‡å—ã€‚</span><br></pre></td></tr></table></figure><h3 id="Microservices-Guide"><a href="#Microservices-Guide" class="headerlink" title="Microservices Guide"></a>Microservices Guide</h3><h4 id="Contents"><a href="#Contents" class="headerlink" title="Contents"></a>Contents</h4><blockquote><p>In short , the microservice architectural style is an approach to developing a single application as a <strong>suite of small services</strong> , each <strong>running in its own process</strong>  and communicating with lightweight mechanisms , often an HTTP resource API .<br>These services are <strong>built around business capabilities</strong> and <strong>independently deployable</strong> by fully automated deployment machinery .<br>There is a bare minimum of centralized management of these services , which may be written in different programming languages and use different data storage technologies .<br>â€“ <strong>James Lewis</strong> and <strong>Martin Fowler</strong>ï¼ˆ2014ï¼‰  </p></blockquote><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">ç®€è€Œè¨€ä¹‹ï¼Œ</span><br><span class="line">å¾®æœåŠ¡æ¶æ„é£æ ¼ æ˜¯ä¸€ç§è¿‘ä¼¼äº å°†ä¸€ä¸ªå•ä½“åº”ç”¨ç¨‹åºä½œä¸ºä¸€ä¸ªå°å‹æœåŠ¡å¥—ä»¶æ¥è¿›è¡Œå¼€å‘çš„é£æ ¼ï¼Œ</span><br><span class="line">æ¯ä¸€ä¸ªå°å‹æœåŠ¡éƒ½è¿è¡Œåœ¨å®ƒè‡ªèº«çš„è¿›ç¨‹å½“ä¸­ï¼Œ</span><br><span class="line">å¹¶ä¸”é€šè¿‡è½»é‡çº§æœºåˆ¶è¿›è¡Œç›¸äº’é—´çš„äº¤æµï¼Œ</span><br><span class="line">é€šå¸¸æ˜¯ä»¥ä¸€ç§è¶…æ–‡æœ¬ä¼ è¾“åè®®èµ„æºåº”ç”¨ç¼–ç¨‹æ¥å£çš„æ–¹å¼è¿›è¡Œäº¤äº’ã€‚</span><br><span class="line">è¿™äº›æœåŠ¡éƒ½æ˜¯å›´ç»•ä¸šåŠ¡é€»è¾‘æ¥è¿›è¡Œæ„å»ºçš„å¹¶ä¸”é€šè¿‡å…¨è‡ªåŠ¨åŒ–éƒ¨ç½²æœºåˆ¶æ¥è¿›è¡Œç‹¬ç«‹éƒ¨ç½²ã€‚</span><br><span class="line">æœ€ä½é™åº¦çš„é›†ä¸­å¼ç®¡ç†ç€è¿™äº›æœåŠ¡ï¼ˆè¿™äº›æœåŠ¡çš„é›†ä¸­ç®¡ç†éå¸¸å°‘ï¼‰ï¼Œ</span><br><span class="line">é€šè¿‡è¿™ç§æ–¹å¼ï¼Œ</span><br><span class="line">æˆ–è®¸å¯ä»¥ä½¿ç”¨ä¸åŒçš„ç¨‹åºè¯­è¨€è¿›è¡Œç¼–å†™ä»¥åŠä½¿ç”¨ä¸åŒçš„æ•°æ®å­˜å‚¨æŠ€æœ¯ã€‚</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------</span><br><span class="line"></span><br><span class="line">æœ‰é“è¯å…¸ç¿»è¯‘ï¼š</span><br><span class="line"></span><br><span class="line">ç®€è€Œè¨€ä¹‹ï¼Œ</span><br><span class="line">å¾®æœåŠ¡ä½“ç³»ç»“æ„é£æ ¼æ˜¯ä¸€ç§å°†å•ä¸ªåº”ç”¨ç¨‹åºä½œä¸ºä¸€ç»„å°æœåŠ¡è¿›è¡Œå¼€å‘çš„æ–¹æ³•ï¼Œ</span><br><span class="line">æ¯ä¸ªå°æœåŠ¡éƒ½åœ¨è‡ªå·±çš„è¿›ç¨‹ä¸­è¿è¡Œï¼Œå¹¶ä¸è½»é‡çº§æœºåˆ¶<span class="params">(é€šå¸¸æ˜¯HTTPèµ„æºAPI)</span>è¿›è¡Œé€šä¿¡ã€‚</span><br><span class="line">è¿™äº›æœåŠ¡æ˜¯å›´ç»•ä¸šåŠ¡åŠŸèƒ½æ„å»ºçš„ï¼Œ</span><br><span class="line">å¹¶ä¸”å¯ä»¥é€šè¿‡å®Œå…¨è‡ªåŠ¨åŒ–çš„éƒ¨ç½²æœºåˆ¶ç‹¬ç«‹éƒ¨ç½²ã€‚</span><br><span class="line">è¿™äº›æœåŠ¡çš„é›†ä¸­ç®¡ç†éå¸¸å°‘ï¼Œ</span><br><span class="line">å®ƒä»¬å¯ä»¥ç”¨ä¸åŒçš„ç¼–ç¨‹è¯­è¨€ç¼–å†™ï¼Œ</span><br><span class="line">å¹¶ä½¿ç”¨ä¸åŒçš„æ•°æ®å­˜å‚¨æŠ€æœ¯ã€‚</span><br><span class="line">â€”â€”è©¹å§†æ–¯Â·åˆ˜æ˜“æ–¯å’Œé©¬ä¸Â·ç¦å‹’<span class="params">(<span class="number">2014</span>)</span></span><br></pre></td></tr></table></figure><h3 id="Introduce-Martin-Fowler"><a href="#Introduce-Martin-Fowler" class="headerlink" title="Introduce - Martin Fowler"></a>Introduce - Martin Fowler</h3><p>äº†è§£å¾®æœåŠ¡ä¹‹å‰é¦–å…ˆæ¥çœ‹çœ‹<strong>Martin Fowler</strong>è€çˆ·å­çš„è‡ªæˆ‘ä»‹ç»ï¼›<br>Fowleråˆšè¢«æˆ‘æ‰“æˆäº†Flowerï¼›  </p><p>ç®€ä»‹é“¾æ¥ï¼š<code>https://www.martinfowler.com</code>  </p><h4 id="Contents-1"><a href="#Contents-1" class="headerlink" title="Contents"></a>Contents</h4><blockquote><p>Software development is a young profession , and we are still learning the techniques and building the tools to do it effectively .<br>Iâ€™ve been involved in this activity for over three decades and in the last two Iâ€™ve been writing on this website about patterns and practives that make it easier to build userful software .<br>The site began as a place to put my own writing , but I also use it to publish articles by my colleagues .  </p></blockquote><blockquote><p>In 2000 , I joined ThoughtWorkds , where my role is to learn about the techniques that weâ€™ve learned to deliver software for our clients , and pass these techniques on to the wider software industry .<br>As this site has developed into a respected platform on software development , Iâ€™ve edited and published articles by me colleagues , both ThoughtWorkers and others , to help useful writing reach a wider audience .  </p></blockquote><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">è½¯ä»¶å‘å±•æ˜¯ä¸€ä¸ªå¹´è½»çš„ä¸“ä¸šæŠ€æœ¯ï¼Œ</span><br><span class="line">å¹¶ä¸”æˆ‘ä»¬æ˜¯ä»ç„¶åœ¨å­¦ä¹ è¿™é—¨æŠ€æœ¯ å’Œ æ„å»ºä¸€äº›å·¥å…·å»æœ‰æ•ˆçš„å®Œæˆå®ƒã€‚</span><br><span class="line">æˆ‘å·²ç»å‚ä¸åˆ°è¿™ä¸€é¡¹æ´»åŠ¨ï¼ˆå·¥ä½œï¼‰å½“ä¸­å·²ç»è¶…è¿‡ä¸‰åå¹´äº†ï¼Œ</span><br><span class="line">å¹¶ä¸”åœ¨æœ€è¿‘ä¸¤å¹´å†…ï¼Œ</span><br><span class="line">æˆ‘åœ¨è¿™ä¸ªç½‘ç«™ç«™ç‚¹ä¸Šå·²ç»ç¼–å†™äº†å…³äºå¦‚ä½•æ›´å®¹æ˜“çš„å»æ„å»ºæœ‰ç”¨çš„è½¯ä»¶çš„ä¸€äº›æ€æƒ³æ¨¡å¼ä»¥åŠç»ƒä¹ æ–¹æ³•ï¼›</span><br><span class="line">è¿™ä¸ªç«™ç‚¹å¼€å§‹æ—¶ä½œä¸ºæ¥å­˜æ”¾æˆ‘è‡ªå·±çš„ä¸€ä¸ªå†™ä½œçš„ä¸€ä¸ªåœ°æ–¹ï¼Œ</span><br><span class="line">ä½†æ˜¯æˆ‘ä¹Ÿä½¿ç”¨è¿™ä¸ªåœ°æ–¹æ¥è¿›è¡Œå‘å¸ƒä¸€äº›é€šè¿‡æˆ‘åŒäº‹ä»¬å†™çš„æ–‡ç« ï¼›</span><br><span class="line"></span><br><span class="line">åœ¨<span class="number">2000</span>å¹´ï¼Œæˆ‘åŠ å…¥åˆ°äº†ThoughtWorksï¼Œ</span><br><span class="line">åœ¨è¿™ä¸ªåœ°æ–¹æˆ‘æ‰®æ¼”çš„è§’è‰²æ˜¯å»å­¦ä¹ è¿™ä¸€é¡¹æŠ€æœ¯ï¼Œ</span><br><span class="line">æˆ‘ä»¬å·²ç»å­¦ä¹ åˆ°å»ä¸ºæˆ‘ä»¬çš„å®¢æˆ·å®ç°è½¯ä»¶ï¼Œ</span><br><span class="line">ä»¥åŠé€šè¿‡è¿™äº›æŠ€æœ¯åœ¨æ›´å¹¿é˜”çš„è½¯ä»¶äº§ä¸šå½“ä¸­ï¼›</span><br><span class="line">è¿™ä¸ªç«™ç‚¹å·²ç»é€æ¸å‘å±•æˆä¸ºä¸€ä¸ªå—äººå°Šæ•¬çš„å¹³å°åœ¨è½¯ä»¶å‘å±•å²å½“ä¸­ï¼Œ</span><br><span class="line">æˆ‘å·²ç»å†™äº†å¾ˆå¤šä»¥åŠå‘å¸ƒäº†å¾ˆå¤šæˆ‘åŒäº‹å†™çš„æ–‡ç« ï¼ŒåŒæ—¶è¿˜æœ‰ThoughtWorkersçš„å‘˜å·¥ä»¥åŠå…¶ä»–äººï¼›</span><br><span class="line">æ¥å¸®åŠ©æœ‰ç”¨çš„å†™ä½œï¼Œå³é€æ¸æˆä¸ºä¸€ä¸ªæœ‰æ·±åº¦çš„å—ä¼—ï¼›</span><br><span class="line"></span><br><span class="line">------------------------------------------------</span><br><span class="line"></span><br><span class="line">æœ‰é“è¯å…¸ç¿»è¯‘ï¼š</span><br><span class="line">è½¯ä»¶å¼€å‘æ˜¯ä¸€ä¸ªå¹´è½»çš„èŒä¸šï¼Œ</span><br><span class="line">æˆ‘ä»¬ä»ç„¶åœ¨å­¦ä¹ æŠ€æœ¯å’Œæ„å»ºå·¥å…·æ¥æœ‰æ•ˆåœ°å®Œæˆå®ƒã€‚</span><br><span class="line">æˆ‘å·²ç»å‚ä¸è¿™é¡¹æ´»åŠ¨è¶…è¿‡<span class="number">30</span>å¹´äº†ï¼Œ</span><br><span class="line">åœ¨è¿‡å»çš„ä¸¤å¹´ä¸­ï¼Œ</span><br><span class="line">æˆ‘ä¸€ç›´åœ¨è¿™ä¸ªç½‘ç«™ä¸Šæ’°å†™å…³äºä½¿æ„å»ºæœ‰ç”¨è½¯ä»¶å˜å¾—æ›´å®¹æ˜“çš„æ¨¡å¼å’Œå®è·µçš„æ–‡ç« ã€‚</span><br><span class="line">è¿™ä¸ªç½‘ç«™ä¸€å¼€å§‹æ˜¯ä¸€ä¸ªæ”¾ç½®æˆ‘è‡ªå·±çš„æ–‡ç« çš„åœ°æ–¹ï¼Œ</span><br><span class="line">ä½†æˆ‘ä¹Ÿç”¨å®ƒæ¥å‘è¡¨æˆ‘åŒäº‹çš„æ–‡ç« ã€‚</span><br><span class="line"><span class="number">2000</span>å¹´ï¼Œæˆ‘åŠ å…¥äº†ThoughtWorksï¼Œ</span><br><span class="line">åœ¨è¿™é‡Œï¼Œæˆ‘çš„èŒè´£æ˜¯å­¦ä¹ æˆ‘ä»¬ä¸ºå®¢æˆ·äº¤ä»˜è½¯ä»¶çš„æŠ€æœ¯ï¼Œ</span><br><span class="line">å¹¶å°†è¿™äº›æŠ€æœ¯ä¼ é€’ç»™æ›´å¹¿æ³›çš„è½¯ä»¶è¡Œä¸šã€‚</span><br><span class="line">éšç€è¿™ä¸ªç½‘ç«™å‘å±•æˆä¸ºä¸€ä¸ªå—äººå°Šæ•¬çš„è½¯ä»¶å¼€å‘å¹³å°ï¼Œ</span><br><span class="line">æˆ‘å·²ç»ç¼–è¾‘å¹¶å‘è¡¨äº†æˆ‘çš„åŒäº‹ä»¬çš„æ–‡ç« ï¼Œ</span><br><span class="line">åŒ…æ‹¬ThoughtWorkerså’Œå…¶ä»–äººï¼Œ</span><br><span class="line">ä»¥å¸®åŠ©æ›´å¹¿æ³›çš„è¯»è€…é˜…è¯»æœ‰ç”¨çš„æ–‡ç« ã€‚</span><br></pre></td></tr></table></figure><h3 id="A-website-on-building-software-effectively"><a href="#A-website-on-building-software-effectively" class="headerlink" title="A website on building software effectively"></a>A website on building software effectively</h3><p>A website on building software effectively</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">åœ¨ä¸€ä¸ªç½‘ç«™ä¸Šæœ‰æ•ˆåœ°æ„å»ºè½¯ä»¶</span><br><span class="line"></span><br><span class="line"><span class="comment">-------------------------</span></span><br><span class="line"></span><br><span class="line">ä¸€ä¸ªæœ‰æ•ˆå¼€å‘è½¯ä»¶çš„ç½‘ç«™</span><br></pre></td></tr></table></figure><h4 id="Contents-2"><a href="#Contents-2" class="headerlink" title="Contents"></a>Contents</h4><blockquote><p>If thereâ€™s a theme that runs through my work and writing on this site , itâ€™s the interplay between the shift towards agile thinking and the technical patterns and practices that make agile software development practical .<br>While specifics of technology change rapidly in our profession , fundamental practices and patterns are more stable .<br>So writing about these allows me to have articles on this site that are several years old but still as relevant as when they were written .  </p></blockquote><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœ è¿™æ˜¯ä¸€ä¸ªä¸»é¢˜ï¼ˆå®šè¯­ï¼šè´¯ç©¿ç€æˆ‘çš„å·¥ä½œç»å†ä»¥åŠåœ¨è¿™ä¸ªç«™ç‚¹ä¸Šçš„æ–‡å­—ï¼‰</span><br><span class="line">é‚£ä¹ˆåœ¨ è½¬å˜æˆæ•æ·å¼æ€ç»´ ä¸ æŠ€æœ¯çš„æ¨¡å¼å’Œä½¿å¾—æ•æ·å¼è½¯ä»¶å¼€å‘ å˜æˆäº‹å® è¿™ä¸¤è€…ä¹‹é—´å…¶å®æ˜¯ç›¸äº’å½±å“çš„ã€‚</span><br><span class="line">å½“ æŠ€æœ¯çš„ç‰¹æ€§ åœ¨æˆ‘ä»¬çš„èŒä¸šè¯¥è¡Œå½“ä¸­ å‘å±•æ”¹å˜ååˆ†è¿…é€Ÿ æ—¶ï¼Œ</span><br><span class="line">åŸºæœ¬çš„å®è·µç»ƒä¹  ä¸ æ¨¡å¼ å°±å˜å¾—éœ€è¦ååˆ†çš„ç‰¢å›ºã€‚</span><br><span class="line">æ‰€ä»¥ç¼–å†™è¿™äº›å…³äº å®¹è®¸æˆ‘åœ¨è¿™ä¸ªç«™ç‚¹ï¼ˆå®šè¯­ï¼šè™½ç„¶æ‰åªæœ‰å‡ å²å³è™½ç„¶æ‰å¼€å§‹å‡ å¹´ï¼Œä½†æ˜¯åªè¦å½“é‡åˆ°ä¸ä¹‹ç›¸å…³çš„ä»–ä»¬å°±éƒ½ä¼šè¢«ä¸€è‡´æŒç»­å†™å…¥è¿›æ¥ï¼‰ä¸Šæ‹¥æœ‰äº†çš„æ–‡ç« ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">---------------------------------------------</span></span><br><span class="line"></span><br><span class="line">æœ‰é“è¯å…¸ç¿»è¯‘ï¼š</span><br><span class="line">å¦‚æœè¯´æˆ‘åœ¨è¿™ä¸ªç«™ç‚¹ä¸Šçš„å·¥ä½œå’Œå†™ä½œä¸­è´¯ç©¿ç€ä¸€ä¸ªä¸»é¢˜ï¼Œé‚£å°±æ˜¯æ•æ·æ€ç»´çš„è½¬å˜ä¸ä½¿æ•æ·è½¯ä»¶å¼€å‘åˆ‡å®å¯è¡Œçš„æŠ€æœ¯æ¨¡å¼å’Œå®è·µä¹‹é—´çš„ç›¸äº’ä½œç”¨ã€‚</span><br><span class="line">è™½ç„¶æŠ€æœ¯ç»†èŠ‚åœ¨æˆ‘ä»¬çš„èŒä¸šä¸­å˜åŒ–å¾ˆå¿«ï¼Œä½†åŸºæœ¬çš„å®è·µå’Œæ¨¡å¼æ›´åŠ ç¨³å®šã€‚</span><br><span class="line">æ‰€ä»¥å†™è¿™äº›ä¸œè¥¿è®©æˆ‘å¯ä»¥åœ¨è¿™ä¸ªç½‘ç«™ä¸Šå†™ä¸€äº›æ–‡ç« ï¼Œè¿™äº›æ–‡ç« å·²ç»æœ‰å¥½å‡ å¹´çš„å†å²äº†ï¼Œä½†æ˜¯ä»ç„¶å’Œå½“åˆå†™çš„æ—¶å€™ä¸€æ ·é‡è¦ã€‚</span><br></pre></td></tr></table></figure><blockquote><p>As software becomes more critical to modern business , software needs be able to react quickly to changes ,  allowing new features to be be conceived , developed and put into production rapidly .<br>The techniques of <font style="color:red;font-weight:bolder">agile software development</font> began in the 1990s and became steadily more popular in the last decade .<br>The focus on a flexible approach to planning , which allows software products to change direction as the userâ€™s needs change and as product managers learn more about how to make their users effective .<br>While widely accepted now , agile approaches are not easy , requiring significant skills for a team , but more importantly a culture of open collaboration both within the team and with a teamâ€™s partners .  </p></blockquote><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">å½“è½¯ä»¶ä¸ºäº†ç°åœ¨çš„ä¸šåŠ¡é€»è¾‘å°±è¶Šéœ€è¦æ‰¹è¯„ï¼Œ</span><br><span class="line">è½¯ä»¶éœ€è¦èƒ½å¤Ÿå¿«é€Ÿåœ°å¯¹æ”¹å˜åšå‡ºååº”ï¼Œå…è®¸ä¸€äº›æ–°ç‰¹æ€§è¢«æ„æ€å®ç°ï¼Œå‘å±•ä»¥åŠè¿…é€Ÿåœ°è½å®æˆä¸ºä¸€ä¸ªäº§å“ã€‚</span><br><span class="line">æ•æ·å¼å¼€å‘è½¯ä»¶çš„è¿™é¡¹æŠ€æœ¯å¼€å§‹åœ¨<span class="number">1990</span>å¹´çš„æ—¶å€™ï¼Œç›´åˆ°åœ¨è¿‘åå¹´å†…å¼€å§‹ç¨³å®šåœ°å˜å¾—è¶Šå‘æµè¡Œèµ·æ¥äº†ã€‚</span><br><span class="line">é›†ä¸­äºåœ¨ä¸€ä¸ªçµæ´»æ€§ä¸Šï¼Œç±»ä¼¼äºè§„åˆ’é¢„æœŸä¸­ï¼Œå®ƒå…è®¸è½¯ä»¶äº§å“æ¥è¿›è¡Œå®šå‘çš„æ”¹å˜å½“å®¢æˆ·éœ€è¦è¿›è¡Œæ”¹å˜ä»¥åŠå½“äº§å“ç®¡ç†è€…å­¦åˆ°æ›´å¤šå…³äºå¦‚ä½•è®©ä»–ä»¬çš„å®¢æˆ·å˜å¾—å°è±¡æ·±åˆ»ã€‚</span><br><span class="line">å½“ç°åœ¨è¢«æ›´å¹¿æ³›çš„æ¥å—ï¼Œæ•æ·å¼çš„å¤„ç†æ˜¯å¹¶ä¸å®¹æ˜“çš„ï¼Œå®ƒè¦æ±‚é‡å¤§çš„çš„æŠ€èƒ½å¯¹äºä¸€ä¸ªå›¢é˜Ÿæ¥è¯´ï¼Œä½†æ˜¯æ›´é‡è¦çš„æ˜¯ä¸€ä¸ªå¼€æºåˆä½œçš„æ–‡åŒ–ï¼Œè¿™ä¸¤è€…éƒ½éœ€è¦å›¢é˜Ÿä»¥åŠå›¢é˜Ÿæˆå‘˜ä¹‹é—´çš„åä½œã€‚</span><br><span class="line"></span><br><span class="line">----------------------------------------------------</span><br><span class="line"></span><br><span class="line">æœ‰é“è¯å…¸ç¿»è¯‘ï¼š</span><br><span class="line">éšç€è½¯ä»¶åœ¨ç°ä»£å•†ä¸šä¸­å˜å¾—è¶Šæ¥è¶Šé‡è¦ï¼Œ</span><br><span class="line">è½¯ä»¶éœ€è¦èƒ½å¤Ÿå¯¹å˜åŒ–åšå‡ºå¿«é€Ÿååº”ï¼Œ</span><br><span class="line">å…è®¸å¿«é€Ÿæ„æ€ã€å¼€å‘æ–°ç‰¹æ€§å¹¶å°†å…¶æŠ•å…¥ç”Ÿäº§ã€‚</span><br><span class="line">æ•æ·è½¯ä»¶å¼€å‘æŠ€æœ¯å¼€å§‹äº<span class="number">20</span>ä¸–çºª<span class="number">90</span>å¹´ä»£ï¼Œå¹¶åœ¨è¿‡å»åå¹´ä¸­é€æ¸æµè¡Œèµ·æ¥ã€‚</span><br><span class="line">ä»–ä»¬ä¸“æ³¨äºä¸€ç§çµæ´»çš„è®¡åˆ’æ–¹æ³•ï¼Œ</span><br><span class="line">è¿™ç§æ–¹æ³•å…è®¸è½¯ä»¶äº§å“éšç€ç”¨æˆ·éœ€æ±‚çš„å˜åŒ–è€Œæ”¹å˜æ–¹å‘ï¼Œ</span><br><span class="line">å¹¶ä¸”éšç€äº§å“ç»ç†æ›´å¤šåœ°äº†è§£å¦‚ä½•è®©ä»–ä»¬çš„ç”¨æˆ·æ›´æœ‰æ•ˆã€‚</span><br><span class="line">è™½ç„¶æ•æ·æ–¹æ³•ç°åœ¨å·²è¢«å¹¿æ³›æ¥å—ï¼Œ</span><br><span class="line">ä½†å®ƒå¹¶ä¸ç®€å•ï¼Œ</span><br><span class="line">éœ€è¦å›¢é˜Ÿçš„é‡è¦æŠ€èƒ½ï¼Œ</span><br><span class="line">ä½†æ›´é‡è¦çš„æ˜¯å›¢é˜Ÿå†…éƒ¨å’Œå›¢é˜Ÿåˆä½œä¼™ä¼´ä¹‹é—´çš„å¼€æ”¾åä½œæ–‡åŒ–ã€‚</span><br></pre></td></tr></table></figure><blockquote><p>This need to respond fluently to changes has an important impact upon the <font style="color:red;font-weight:bolder">architecture</font> of a software system.<br>The software needs to be built in such a way that it is able to adapt to unexpected changes in features .<br>One of the most important ways to do this is to write clear code , making it easy to understant what the program is supposed to do .<br>This code should be devided into modules which allow developers to understand only the parts of the system they need to make a change .<br>This production code should be supported with automated tests that can detect any errors made when making a change while providing examples of how internal structures are used .<br>Large and complex software efforts may find the <font style="color:red;font-weight:bolder">microservices</font> architectural style helps teams deploy software with less entangling dependencies .  </p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>Creating software that has a good architecture isnâ€™t something that can be done first time .<br>Like good prose , it needs regular revisions and programmers learn more about what the product needs to do and how best to design the product to achieve its goals .<br><font style="color:red;font-weight:bolder">Refactoring</font> is an essential technique to allow a program to be changed safety .<br>It consists of making small changes that donâ€™t alter the observable behavior of the software .<br>Bt combining lots of small changes , developers can revise the softwareâ€™s structure supporting significant modifications that werenâ€™t planned when the system was first conceived .  </p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>Software that runs only on a developerâ€™s machine isnâ€™t providing value to the customers of the software .<br>Traditionally releasing software has been a long and complicated process , one that hinders the need to evolve software quickly .<br><font style="color:red;font-weight:bolder">Continuous Delivery</font> uses automation and collaborative workflows to remove this bottleneck , allowing teams to release software as often as the customers demand .<br>For Continuous Delivery to be possible , we need to build in a solid foundation of <font style="color:red;font-weight:bolder">Testing</font> , with a range of automated tests that can give us confidence taht our changes havenâ€™t introduced any bugs .<br>This leads us to integrate testing into programming , which can act to improve our architectural .  </p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Photostream"><a href="#Photostream" class="headerlink" title="Photostream"></a>Photostream</h3><h3 id="Data-Management"><a href="#Data-Management" class="headerlink" title="Data Management"></a>Data Management</h3><h4 id="Contents-3"><a href="#Contents-3" class="headerlink" title="Contents"></a>Contents</h4><blockquote><p>There are many kinds of softeare out there , the kind Iâ€™m primarily engaged is Enterprise Applications .<br>One of the enduring problems we need to tackle in this world is <font style="color:red;font-weight:bolder">data management</font> .<br>The aspectes of data management Iâ€™ve focused on here are how to migrate data stores as their applications respond to changing needs , coping with different contexts across a large enterprice , the role of NoSQL databases , and the broader issues of coping with data that is both Big and Messy .  </p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Domain-Specific-Languages"><a href="#Domain-Specific-Languages" class="headerlink" title="Domain-Specific Languages"></a>Domain-Specific Languages</h3><h3 id="Contents-4"><a href="#Contents-4" class="headerlink" title="Contents"></a>Contents</h3><blockquote><p>A common problem in complex software systems is how to capture complicated domain logic in a way that programmers can both easily manipulate and also easily communicate to domain experts .<br><font style="color:red;font-weight:bolder">Domain-Specific Languages</font>(DSLs) create a custom language for a particular problem , either with custom parsers or by conventions within a host language .  </p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Books"><a href="#Books" class="headerlink" title="Books"></a>Books</h3><h4 id="Contents-5"><a href="#Contents-5" class="headerlink" title="Contents"></a>Contents</h4><blockquote><p>Iâ€™ve written seven books on software development , including Refactoring , Patterns of Enterprise Application Architectural , and UML Distilled .<br>Iâ€™m also the editor of a signature series for Addison-Wesley that includes five jolt award winners .<br><font style="color:red;font-weight:bolder">My Books Pageâ€¦</font>  </p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Conference-Talks"><a href="#Conference-Talks" class="headerlink" title="Conference Talks"></a>Conference Talks</h3><h4 id="Contents-6"><a href="#Contents-6" class="headerlink" title="Contents"></a>Contents</h4><blockquote><p>Iâ€™m often asked to give talks at conferences , from which Iâ€™ve inferred that Iâ€™m a pretty good speaker - which is ironic since I really hate giving talks .<br>You can form your own opinion of my talks by watching videos of some my conference talks .<br><font style="color:red;font-weight:bolder"> My Videos Pageâ€¦</font>  </p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Board-Games"><a href="#Board-Games" class="headerlink" title="Board Games"></a>Board Games</h3><h4 id="Contents-7"><a href="#Contents-7" class="headerlink" title="Contents"></a>Contents</h4><blockquote><p>Iâ€™ve long been a fan of board games , I enjoy a game that fully occupies my mind , clearing out all the serious thoughts for a bit , while enjoying the company of good friends .<br>Modern board games saw dramatic improvement in the 1990â€™s with the rise of Eurogames , and I expect many people would be surprised if they havenâ€™t tried any of this new generation .<br>I also appear regularly on <font style="color:red;font-weight:bolder">Heavy Cardboard</font> .<br><font style="color:red;font-weight:bolder">My Board Games pageâ€¦</font>  </p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;Nothing better than a buzy Saturday morning.&lt;/p&gt;
&lt;/blockq
      
    
    </summary>
    
    
      <category term="MICROSERVICES" scheme="https://fengshana.github.io/categories/MICROSERVICES/"/>
    
    
      <category term="é¢è¯•" scheme="https://fengshana.github.io/tags/%E9%9D%A2%E8%AF%95/"/>
    
      <category term="MICROSERVICES" scheme="https://fengshana.github.io/tags/MICROSERVICES/"/>
    
  </entry>
  
  <entry>
    <title>MicroservicesGuide-èµ°è¿‘å¾®æœåŠ¡è¯æ±‡</title>
    <link href="https://fengshana.github.io/2020/05/27/%E3%80%90MICROSERVICES%E3%80%91/%E3%80%90MICROSERVICES%E3%80%91MicroservicesGuide-%E8%B5%B0%E8%BF%91%E5%BE%AE%E6%9C%8D%E5%8A%A1%E8%AF%8D%E6%B1%87/"/>
    <id>https://fengshana.github.io/2020/05/27/%E3%80%90MICROSERVICES%E3%80%91/%E3%80%90MICROSERVICES%E3%80%91MicroservicesGuide-%E8%B5%B0%E8%BF%91%E5%BE%AE%E6%9C%8D%E5%8A%A1%E8%AF%8D%E6%B1%87/</id>
    <published>2020-05-27T10:36:35.464Z</published>
    <updated>2020-05-27T10:36:35.465Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Microservices-Guide-å¾®æœåŠ¡æŒ‡å—è¯æ±‡å¯¼è¯»"><a href="#Microservices-Guide-å¾®æœåŠ¡æŒ‡å—è¯æ±‡å¯¼è¯»" class="headerlink" title="Microservices Guide å¾®æœåŠ¡æŒ‡å—è¯æ±‡å¯¼è¯»"></a>Microservices Guide å¾®æœåŠ¡æŒ‡å—è¯æ±‡å¯¼è¯»</h2><p>æˆ‘è§‰å¾—æˆ‘å¯¹æœ‰é“è¯å…¸çš„ç¿»è¯‘æœ‰ç‚¹è¿·â€¦..<br>æ„Ÿè§‰æ€ªæ€ªçš„ï¼›  </p><p><strong>software</strong></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">so : f : t : wa : re ( è‹± /ËˆsÉ’ftweÉ™(r)/  )</span><br><span class="line">n. è½¯ä»¶</span><br><span class="line">ç½‘ç»œé‡Šä¹‰ è½¯ä»¶ï¼›è½¯ä»¶ï¼›è½¯ä»¶ï¼›è½¯è®¾å¤‡</span><br><span class="line">Software è½¯ä»¶ï¼›è½¯ä»¶ï¼›è½¯ä»¶ï¼›è½¯è®¾å¤‡</span><br><span class="line">free software è‡ªç”±è½¯ä»¶ï¼›è‡ªç”±è½¯ä½“ï¼›å…è´¹è½¯ä»¶ï¼›è‡ªåœ¨è½¯ä»¶</span><br><span class="line">software framework è½¯ä»¶æ¡†æ¶ï¼›è½¯ä½“æ¡†æ¶ï¼›è½¯ä»¶æ¶æ„</span><br><span class="line">software development è½¯ä»¶å¼€å‘</span><br><span class="line">software design è½¯ä»¶è®¾è®¡ï¼›è½¯ä»¶å¼€å‘</span><br><span class="line">software<span class="built_in"> system </span>è½¯ä»¶ç³»ç»Ÿ</span><br></pre></td></tr></table></figure><p><strong>development</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">de</span> : <span class="string">ve : lo : p : men : t ( è‹± /dÉªËˆvelÉ™pmÉ™nt/  )</span></span><br><span class="line"><span class="meta">n.</span> <span class="string">å‘å±•ï¼›å¼€å‘ï¼›å‘è‚²ï¼›ä½å®…å°åŒºï¼ˆä¸“æŒ‡ç”±åŒä¸€å¼€å‘å•†å¼€å‘çš„ï¼‰ï¼›[æ‘„]æ˜¾å½±</span></span><br><span class="line"><span class="meta">å¤æ•°</span> <span class="string">developments</span></span><br><span class="line"><span class="meta">ç½‘ç»œé‡Šä¹‰</span> <span class="string">å¼€å‘ï¼›å‘å±•ï¼›å‘è‚²ï¼›è¿›åŒ–ï¼›</span></span><br><span class="line"><span class="attr">Development</span> <span class="string">å¼€å‘ï¼›å‘å±•ï¼›å‘è‚²ï¼›è¿›åŒ–</span></span><br><span class="line"><span class="attr">Software</span> <span class="string">Development è½¯ä»¶å¼€å‘ï¼›è½¯ä½“å¼€å‘ï¼›è½¯ä»¶å‘å±•ï¼›è½¯ä»¶ç ”å‘</span></span><br><span class="line"><span class="attr">Career</span> <span class="string">Development ç”Ÿæ¶¯è§„åˆ’ï¼›èŒä¸šè§„åˆ’ï¼›ç”Ÿæ¶¯å‘å±•ï¼›äº‹ä¸šå‘å±•</span></span><br><span class="line"><span class="attr">sustainable</span> <span class="string">development å¯æŒç»­å‘å±•</span></span><br><span class="line"><span class="attr">economic</span> <span class="string">development ç»æµå‘å±•ï¼›ç»æµå¼€å‘</span></span><br><span class="line"><span class="attr">with</span> <span class="string">the development of éšç€ ... å‘å±•</span></span><br></pre></td></tr></table></figure><p><strong>young</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">young</span> <span class="string">( è‹± /jÊŒÅ‹/ )</span></span><br><span class="line"><span class="meta">adj.</span> <span class="string">å¹´è½»çš„ï¼›åˆæœŸçš„ï¼›æ²¡æœ‰ç»éªŒçš„</span></span><br><span class="line"><span class="meta">n.</span> <span class="string">å¹´è½»äººï¼›ï¼ˆåŠ¨ç‰©çš„ï¼‰å´½ï¼Œä»”</span></span><br><span class="line"><span class="meta">æ¯”è¾ƒçº§</span> <span class="string">younger</span></span><br><span class="line"><span class="meta">æœ€é«˜çº§</span> <span class="string">youngest</span></span><br><span class="line"><span class="meta">å¤æ•°</span> <span class="string">youngs</span></span><br><span class="line"><span class="meta">ç½‘ç»œé‡Šä¹‰</span> <span class="string">å¹´è½»äººï¼›é’å¹´ç‰ˆï¼›æ¨æ ¼</span></span><br><span class="line"><span class="attr">Young</span> <span class="string">å¹´è½»äººï¼›é’å¹´ç‰ˆï¼›æ¨æ ¼</span></span><br><span class="line"><span class="attr">Neil</span> <span class="string">Young å°¼å°” æ¨ï¼›å°¼å°”æ¨</span></span><br><span class="line"><span class="attr">Brigham</span> <span class="string">Young æ¨ç™¾ç¿°ï¼›æ¨ç™¾ç¿°å¤§å­¦ï¼›</span></span><br></pre></td></tr></table></figure><p><strong>profession</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">p</span> : <span class="string">ro : fe : ssion ( è‹± /prÉ™ËˆfeÊƒn/ )</span></span><br><span class="line"><span class="meta">n.</span> <span class="string">èŒä¸šï¼›ä¸“ä¸šï¼›å£°æ˜ï¼›å®£å¸ƒï¼›è¡¨ç™½</span></span><br><span class="line"><span class="meta">å¤æ•°</span> <span class="string">professions</span></span><br><span class="line"><span class="meta">ç½‘ç»œé‡Šä¹‰</span> <span class="string">èŒä¸šï¼›ä¸“ä¸šï¼›ä¸“ä¸šï¼›è¡Œä¸š</span></span><br><span class="line"><span class="attr">profession</span> <span class="string">èŒä¸šï¼›ä¸“ä¸šï¼›ä¸“ä¸šï¼›è¡Œä¸š</span></span><br><span class="line"><span class="attr">caring</span> <span class="string">profession æŠ¤ç†è¡Œä¸šï¼›ç…§é¡¾ä»–äººçš„èŒä¸š</span></span><br><span class="line"><span class="attr">Profession</span> <span class="string">informationization è¡Œä¸šä¿¡æ¯åŒ–</span></span><br><span class="line"><span class="attr">profession</span> <span class="string">of å®£ç§°ï¼ˆæ„Ÿæƒ…ã€ä¿¡å¿µç­‰ï¼‰ï¼›è¡¨ç™½</span></span><br><span class="line"><span class="attr">legal</span> <span class="string">profession æ³•å¾‹ç•Œï¼›æ³•å¾‹ä¸“ä¸š</span></span><br><span class="line"><span class="attr">medical</span> <span class="string">profession åŒ»ç–—èŒä¸š</span></span><br></pre></td></tr></table></figure><p><strong>still</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">s</span> : <span class="string">t : ill ( è‹± /stÉªl/  )</span></span><br><span class="line"><span class="meta">adv.</span> <span class="string">ä»ç„¶ï¼›æ›´ï¼›é™æ­¢åœ°</span></span><br><span class="line"><span class="meta">adj.</span> <span class="string">é™æ­¢çš„ï¼›ä¸åŠ¨çš„ï¼›å¯‚é™çš„ï¼›å¹³é™çš„ï¼›ä¸èµ·æ³¡çš„</span></span><br><span class="line"><span class="meta">n.</span> <span class="string">å¯‚é™ï¼›å‰§ç…§ï¼›è’¸é¦å®¤</span></span><br><span class="line"><span class="meta">conj.</span> <span class="string">ä»ç„¶ï¼›ä½†æ˜¯ï¼›å°½ç®¡å¦‚æ­¤</span></span><br><span class="line"><span class="meta">vt.</span> <span class="string">è’¸é¦ï¼›ä½¿...é™æ­¢ï¼›ä½¿....å¹³é™ä¸‹æ¥</span></span><br><span class="line"><span class="meta">vi.</span> <span class="string">é™æ­¢ï¼›å¹³é™ï¼›è’¸é¦</span></span><br><span class="line"><span class="meta">ç½‘ç»œé‡Šä¹‰</span> <span class="string">é™æ­¢ï¼›ä»ç„¶ï¼›è’¸é¦é‡œï¼›ä¾ç„¶</span></span><br><span class="line"><span class="attr">still</span> <span class="string">é™æ­¢ï¼›ä»ç„¶ï¼›è’¸é¦é‡œï¼›ä¾ç„¶</span></span><br><span class="line"><span class="attr">still</span> <span class="string">camera é™ç‰©ç…§ç›¸æœºï¼›é™ç‰©æ‘„å½±é›†ï¼›æ‹ç…§æœº</span></span><br><span class="line"><span class="attr">Still</span> <span class="string">wine é™æ­¢è‘¡è„é…’ï¼›é™æ€è‘¡è„é…’ï¼›æ— æ°”è‘¡è„é…’ï¼›å¹³é™è‘¡è„é…’</span></span><br><span class="line"><span class="attr">still</span> <span class="string">on ä»åœ¨è¿›è¡Œ</span></span><br><span class="line"><span class="attr">still</span> <span class="string">remains ä»ç„¶æ˜¯</span></span><br><span class="line"><span class="attr">sit</span> <span class="string">still å®‰é™åœ°åç€</span></span><br></pre></td></tr></table></figure><p><strong>learning</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">lear</span> : <span class="string">ning ( è‹± /ËˆlÉœËnÉªÅ‹/  )</span></span><br><span class="line"><span class="meta">n.</span> <span class="string">å­¦ä¹ ï¼›å­¦é—®</span></span><br><span class="line"><span class="meta">v.</span> <span class="string">å­¦ä¹ ï¼ˆlearnçš„ç°åœ¨åˆ†è¯ï¼‰</span></span><br><span class="line"><span class="meta">ç½‘ç»œé‡Šä¹‰</span> <span class="string">å­¦ä¹ ï¼›å­¦ä¹ ï¼›å­¦é—®ï¼›çŸ¥è¯†</span></span><br><span class="line"><span class="attr">learning</span> <span class="string">å­¦ä¹ ï¼›å­¦ä¹ ï¼›å­¦é—®ï¼›çŸ¥è¯†</span></span><br><span class="line"><span class="attr">ensemble</span> <span class="string">learning é›†æˆå­¦ä¹ ï¼›å›´ç»•ä¸­å¿ƒç‚¹çš„åˆ’åˆ†ï¼›ç»„åˆç®—æ³•</span></span><br><span class="line"><span class="attr">Blended</span> <span class="string">Learning æ··åˆå¼å­¦ä¹ ï¼›æ··åˆå­¦ä¹ ï¼›æ··åˆå¼æ•™å­¦</span></span><br><span class="line"><span class="attr">learning</span> <span class="string">English å­¦ä¹ è‹±è¯­</span></span><br><span class="line"><span class="attr">higher</span> <span class="string">learning n. é«˜ç­‰æ•™è‚²ï¼›é«˜æ·±å­¦é—®ï¼›ï¼ˆç”µå½±åç§°ï¼‰æ ¡å›­å¤§å†²çª</span></span><br><span class="line"><span class="attr">language</span> <span class="string">learning è¯­è¨€å­¦ä¹ </span></span><br></pre></td></tr></table></figure><p><strong>techniques</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">te</span> : <span class="string">chi : ni : qu : es ( chi è¯» k çš„éŸ³ï¼›qu è¯» k çš„éŸ³ï¼› è‹± /tekËˆni:ks/ )</span></span><br><span class="line"><span class="meta">n.</span> <span class="string">æŠ€æœ¯ï¼ˆtechniqueçš„å¤æ•°ï¼‰ï¼›æ–¹æ³•ï¼›æŠ€å·§</span></span><br><span class="line"><span class="meta">ç½‘ç»œé‡Šä¹‰</span> <span class="string">æŠ€æ³•ï¼›æŠ€æœ¯ï¼›æŠ€å·§ï¼›ç½‘ç«™æ¶æ„</span></span><br><span class="line"><span class="attr">Techniques</span> <span class="string">æŠ€æ³•ï¼›æŠ€æœ¯ï¼›æŠ€å·§ï¼›ç½‘ç«™æ¶æ„</span></span><br><span class="line"><span class="attr">Sampling</span> <span class="string">techniques é‡‡æ ·æŠ€æœ¯ï¼›æŠ½æ ·æŠ€æœ¯ï¼›å–æ ·æŠ€æœ¯ï¼›é‡‡æ ·å¦™æŠ€</span></span><br><span class="line"><span class="attr">Metallographic</span> <span class="string">Techniques é‡‘ç›¸æŠ€æœ¯</span></span><br><span class="line"><span class="attr">application</span> <span class="string">Techniques æ¶‚è£…æŠ€æœ¯</span></span><br><span class="line"><span class="attr">selling</span> <span class="string">techniques æ¨é”€æŠ€æœ¯</span></span><br><span class="line"><span class="attr">motivational</span> <span class="string">techniques æ¿€åŠ±æŠ€èƒ½ï¼›æ¿€åŠ±æ–¹æ³•ï¼ˆmotivational technique çš„å¤æ•°ï¼‰</span></span><br></pre></td></tr></table></figure><p><strong>building</strong></p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bu </span>: il : ding ( è‹± /Ëˆ<span class="keyword">bÉªldÉªÅ‹/ </span> )</span><br><span class="line"><span class="symbol">n.</span> å»ºç­‘ï¼›å»ºç­‘ç‰©</span><br><span class="line"><span class="symbol">v.</span> å»ºç­‘ï¼›å»ºç«‹ï¼›å¢åŠ ï¼ˆ<span class="keyword">buildçš„ingå½¢å¼ï¼‰</span></span><br><span class="line"><span class="keyword">å¤æ•° </span><span class="keyword">buildings</span></span><br><span class="line"><span class="keyword">ç½‘ç»œé‡Šä¹‰ </span>å»ºç­‘ç‰©ï¼›å¤§æ¥¼ï¼›å·æ¥¼ï¼›æˆ¿å±‹</span><br><span class="line"><span class="keyword">building </span>å»ºç­‘ç‰©ï¼›å¤§æ¥¼ï¼›å·æ¥¼ï¼›æˆ¿å±‹</span><br><span class="line"><span class="symbol">green</span> <span class="keyword">building </span>ç»¿è‰²å»ºç­‘ï¼›ç»¿è‰²ç”Ÿæ€å»ºç­‘ï¼›ç»¿è‰²ä¿®å»º</span><br><span class="line"><span class="symbol">Chrysler</span> <span class="keyword">Building </span>å…‹è±æ–¯å‹’å¤§å¦ï¼›å…‹è±æ–¯å‹’å¤§æ¥¼ï¼›ç¾å›½å…‹è±æ–¯å‹’å¤§å¦ï¼›å…‹è±æ–¯å‹’</span><br><span class="line"><span class="keyword">building </span>up å»ºé€ ï¼›è£…é…ï¼›å †ç„Šï¼›å»ºç«‹å¢é•¿</span><br><span class="line"><span class="symbol">office</span> <span class="keyword">building </span>åŠå…¬å¤§æ¥¼ï¼ˆç­‰äºoffice <span class="keyword">blockï¼‰</span></span><br><span class="line"><span class="keyword">building </span>material å»ºç­‘ææ–™</span><br></pre></td></tr></table></figure><p><strong>tools</strong></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">too : l : s ( è‹± /tuËlz/  )</span><br><span class="line">n. [è®¡]å·¥å…·ï¼Œå·¥å…·èœå•ï¼›å·¥å…·ç®±ï¼ˆtoolçš„å¤æ•°å½¢å¼ï¼‰</span><br><span class="line">v. ç”¨å·¥å…·åŠ å·¥<span class="built_in">..</span>. (toolçš„ç¬¬ä¸‰äººç§°å•æ•°å½¢å¼)</span><br><span class="line">ç½‘ç»œé‡Šä¹‰ å·¥å…·ï¼›åˆ€å…·ï¼›é¢æ¿ï¼›å·¥å…·æ </span><br><span class="line">Tools å·¥å…·ï¼›åˆ€å…·ï¼›é¢æ¿ï¼›å·¥å…·æ </span><br><span class="line">Game Tools æ¸¸æˆå¸¸ç”¨å·¥å…·ï¼›æ¸¸æˆå¸¸ç”¨æ”¯æŒå·¥å…·é›†åˆï¼›æ¸¸æˆå¼€å‘å·¥å…·ï¼›æ¸¸æˆå·¥å…·</span><br><span class="line">Debugging Tools è°ƒè¯•å·¥å…·ï¼›ç¿Ÿå·¥å…·ï¼›æ’é”™å·¥å…·ï¼›é™¤é”™å·¥å…·ï¼›</span><br><span class="line">hardware tools äº”é‡‘å·¥å…·ï¼›æ—¥ç”¨äº”é‡‘</span><br><span class="line">new tools æ–°å·¥å…·</span><br><span class="line">machines <span class="keyword">and</span> tools æœºå…·</span><br></pre></td></tr></table></figure><p><strong>effectively</strong></p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">e : <span class="type">ffe</span> : <span class="type">c</span> : <span class="type">ti</span> : <span class="type">ve</span> : <span class="type">ly</span> ( è‹± /ÉªËˆfektÉªvli/ )</span><br><span class="line">adv. æœ‰æ•ˆåœ°ï¼›ç”Ÿæ•ˆåœ°ï¼›æœ‰åŠ›åœ°ï¼›å®é™…ä¸Š</span><br><span class="line">ç½‘ç»œé‡Šä¹‰ æœ‰æ•ˆåœ°ï¼›èµ·ä½œç”¨åœ°ï¼›å®é™…ä¸Šï¼›æœ‰ç”¨åœ°</span><br><span class="line">effectively æœ‰æ•ˆåœ°ï¼›èµ·ä½œç”¨åœ°ï¼›å®é™…ä¸Šï¼›æœ‰ç”¨åœ°</span><br><span class="line">effectively grounded ç›´æ¥æ¥åœ°ï¼›æœ‰æ•ˆè¢«æ¥åœ°ï¼›æœ‰æ•ˆæ¥åœ°ï¼›æœ‰æ•ˆæ¥åœ°çš„</span><br><span class="line"><span class="keyword">use</span> effectively æœ‰æ•ˆåˆ©ç”¨ï¼›æœ‰æ•ˆåœ°åˆ©ç”¨</span><br></pre></td></tr></table></figure><p><strong>involved</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">in</span> : <span class="string">vol : ve : d (ve è¯» v çš„éŸ³ è‹± /ÉªnËˆvÉ’lvd/  )</span></span><br><span class="line"><span class="meta">adj.</span> <span class="string">æœ‰å…³çš„ï¼›å·å…¥çš„ï¼›å¤æ‚çš„</span></span><br><span class="line"><span class="meta">v.</span> <span class="string">æ¶‰åŠï¼›ä½¿å‚ä¸ï¼›åŒ…å«ï¼ˆinvolveçš„è¿‡å»æ—¶å’Œè¿‡å»åˆ†è¯ï¼‰</span></span><br><span class="line"><span class="meta">ç½‘ç»œé‡Šä¹‰</span> <span class="string">å·å…¥ï¼›æ¶‰æ¡ˆï¼›æ¶‰è¶³ï¼›æ‰€æ¶‰åŠ</span></span><br><span class="line"><span class="attr">Involved</span> <span class="string">å·å…¥ï¼›æ¶‰æ¡ˆï¼›æ¶‰è¶³ï¼›æ‰€æ¶‰åŠ</span></span><br><span class="line"><span class="attr">parties</span> <span class="string">involved äº¤æ¢ä¸­çš„å„æ–¹ï¼›å½“äº‹äººï¼›å½“äº‹è€…ï¼›äº’æ¢ä¸­çš„å„æ–¹</span></span><br><span class="line"><span class="attr">get</span> <span class="string">involved ä»‹å…¥ï¼›åŠ å…¥æˆ‘ä»¬ï¼›é¡¹ç›®ä»‹ç»ï¼›å‚ä¸</span></span><br><span class="line"><span class="attr">involved</span> <span class="string">in æ¶‰åŠï¼›åŒ…å«ï¼›ç‰µæ¶‰è¿›...</span></span><br><span class="line"><span class="attr">involved</span> <span class="string">with æ¶‰åŠï¼›ä¸...æœ‰å…³è”</span></span><br><span class="line"><span class="attr">get</span> <span class="string">involved in æ¶‰åŠï¼›å·å…¥</span></span><br></pre></td></tr></table></figure><p><strong>activity</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">a</span> : <span class="string">c : ti : vi : ty ( è‹± /Ã¦kËˆtÉªvÉ™ti/ )</span></span><br><span class="line"><span class="meta">n.</span> <span class="string">æ´»åŠ¨ï¼›è¡ŒåŠ¨ï¼›æ´»è·ƒ</span></span><br><span class="line"><span class="meta">å¤æ•°</span> <span class="string">activities</span></span><br><span class="line"><span class="meta">ç½‘ç»œé‡Šä¹‰</span> <span class="string">æ´»åŠ¨ï¼›æ´»æ€§ï¼›æ´»åº¦ï¼›æ´»åŠ¨</span></span><br><span class="line"><span class="attr">Activity</span> <span class="string">æ´»åŠ¨ï¼›æ´»æ€§ï¼›æ´»åº¦ï¼›æ´»åŠ¨</span></span><br><span class="line"><span class="attr">logistics</span> <span class="string">activity ç‰©æµæ´»åŠ¨ï¼›ç‰©æµ</span></span><br><span class="line"><span class="attr">physical</span> <span class="string">activity ä½“åŠ›æ´»åŠ¨ï¼›ä½“è‚²æ´»åŠ¨ï¼›ä½“èƒ½æ´»åŠ¨</span></span><br><span class="line"><span class="attr">economic</span> <span class="string">activity ç»æµæ´»åŠ¨</span></span><br><span class="line"><span class="attr">catalytic</span> <span class="string">activity å‚¬åŒ–æ´»æ€§</span></span><br><span class="line"><span class="attr">physical</span> <span class="string">activity èº«ä½“æ´»åŠ¨ï¼›ä½“è‚²æ´»åŠ¨ï¼›ä½“åŠ›æ´»åŠ¨</span></span><br></pre></td></tr></table></figure><p><strong>over</strong></p><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">o : v : er ( è‹± /ËˆÉ™ÊŠvÉ™(r)/  )</span><br><span class="line">adv. å€’ä¸‹ï¼›ç¿»è½¬ï¼›ç©¿è¿‡ï¼›å®Œå…¨è¦†ç›–ï¼›ä»¥ä¸Šï¼›å¤§äºï¼›å†ï¼›ç»“æŸï¼›æ”¹å˜ï¼›å®Œæ¯•ï¼›ä»”ç»†åœ°</span><br><span class="line">prep. åœ¨<span class="params">...</span>ä¸Šé¢ï¼›ä»<span class="params">...</span>ä¸Šæ–¹ï¼›ç©¿è¶Šï¼›åœ¨<span class="params">...</span>çš„å¦ä¸€è¾¹ï¼›åœ¨<span class="params">...</span>çš„è¿œç«¯ï¼›ä»<span class="params">...</span>è½ä¸‹ï¼›éåŠï¼›å¤šäºï¼›åœ¨<span class="params">...</span>æœŸé—´ï¼›æ¸¡è¿‡ï¼›ç”±äºï¼›å…³äºï¼›åˆ©ç”¨ï¼›é€šè¿‡ï¼›å£°éŸ³å¤§äºï¼›é«˜äºï¼›çº§åˆ«åœ¨<span class="params">...</span>ä¹‹ä¸Šï¼›ä¼˜å…ˆäºï¼›è¶…è¿‡</span><br><span class="line">n. ï¼ˆæ¿çƒï¼‰ä¸€è½®æŠ•çƒ</span><br><span class="line">adj. å€’ä¸‹çš„ï¼›æŠ˜èµ·æ¥çš„ï¼›ç»“æŸçš„ï¼›å‰©ä¸‹çš„</span><br><span class="line">v. è¶Šè¿‡</span><br><span class="line">ç½‘ç»œé‡Šä¹‰ ç»“æŸï¼›è¶Šè¿‡ï¼›è¶…è¿‡</span><br><span class="line">over ç»“æŸï¼›è¶Šè¿‡ï¼›è¶…è¿‡</span><br><span class="line">hand over ç§»äº¤ï¼›äº¤å‡ºï¼›è®©ä¸</span><br><span class="line">Over There é‚£æ—¶é‚£åœ°ï¼›åœ¨é‚£è¾¹ï¼›åœ¨é‚£é‡Œï¼›é‚£è¾¹</span><br><span class="line"><span class="literal">all</span> over åˆ°å¤„ï¼›éåŠï¼›æµ‘èº«ï¼›å…¨éƒ¨ç»“æŸ</span><br><span class="line">over there adv. åœ¨é‚£é‡Œ</span><br><span class="line">over <span class="literal">and</span> over åå¤ï¼›å†ä¸‰</span><br></pre></td></tr></table></figure><p><strong>decades</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">n.</span> <span class="string">æ•°åå¹´ï¼ˆdecadeçš„å¤æ•°ï¼‰</span></span><br><span class="line"><span class="meta">ç½‘ç»œé‡Šä¹‰</span> <span class="string">åå¹´ï¼›å‡ åå¹´ï¼›å‡ åå¹´æ¥ï¼›å°é˜¶</span></span><br><span class="line"><span class="attr">decades</span> <span class="string">åå¹´ï¼›å‡ åå¹´ï¼›å‡ åå¹´æ¥ï¼›å°é˜¶</span></span><br><span class="line"><span class="attr">Mixed</span> <span class="string">Decades æŸæŸå¹´ä»£é£</span></span><br><span class="line"><span class="attr">Frogger</span> <span class="string">Decades é’è›™è¿‡æ²³çºªå¿µç‰ˆ</span></span><br><span class="line"><span class="attr">over</span> <span class="string">the past decade åœ¨è¿‡å»çš„åå¹´é‡Œ</span></span><br></pre></td></tr></table></figure><p><strong>writing</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">wri</span> : <span class="string">ting ( è‹± /ËˆraÉªtÉªÅ‹/  )</span></span><br><span class="line"><span class="meta">n.</span> <span class="string">ä¹¦å†™ï¼›å†™ä½œæŠ€èƒ½ï¼›è‘—ä¹¦ç«‹è¯´ï¼›å†™ä½œçš„èŒä¸šï¼›ä½œå“ï¼›è‘—ä½œï¼›æ–‡å­—ï¼›ç¬”è¿¹</span></span><br><span class="line"><span class="meta">v.</span> <span class="string">ä¹¦å†™ï¼›å†™ä½œï¼ˆwriteçš„ç°åœ¨åˆ†è¯ï¼‰</span></span><br><span class="line"><span class="meta">å¤æ•°</span> <span class="string">writings</span></span><br><span class="line"><span class="meta">ç½‘ç»œé‡Šä¹‰</span> <span class="string">å†™ä½œï¼›ä¹¦å†™ï¼›æ–‡å­—</span></span><br><span class="line"><span class="attr">Writing</span> <span class="string">å†™ä½œï¼›ä¹¦å†™ï¼›æ–‡å­—</span></span><br><span class="line"><span class="attr">Nature</span> <span class="string">Writing è‡ªç„¶å†™ä½œï¼›è‡ªç„¶ä¹¦å†™ï¼›è‡ªç„¶æ–‡å­¦</span></span><br><span class="line"><span class="attr">English</span> <span class="string">Writing è‹±è¯­å†™ä½œï¼›è‹±æ–‡å†™ä½œï¼›è‹±æ–‡ä¹¦é¢è¡¨è¾¾ï¼›å†™ä½œ</span></span><br><span class="line"><span class="attr">in</span> <span class="string">writing ä¹¦é¢ï¼›ä¹¦é¢çš„ï¼›ç”¨ä¹¦é¢å†™</span></span><br><span class="line"><span class="attr">writing</span> <span class="string">ability å†™ä½œèƒ½åŠ›ï¼›ä¹¦å†™èƒ½åŠ›</span></span><br><span class="line"><span class="attr">writing</span> <span class="string">skill å†™ä½œæŠ€å·§ï¼›ä¹¦å†™æŠ€èƒ½ï¼›ç¬”å¤´</span></span><br></pre></td></tr></table></figure><p><strong>in the last two</strong></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">åœ¨æœ€åä¸¤ä¸ª</span><br><span class="line"><span class="keyword">in</span> <span class="keyword">the</span> <span class="keyword">last</span> <span class="literal">two</span> months åœ¨è¿‡å»çš„ä¸¤ä¸ªæœˆï¼›åœ¨æœ€åä¸¤ä¸ªæœˆ</span><br><span class="line">In <span class="keyword">the</span> <span class="keyword">last</span> <span class="literal">two</span> years åœ¨æœ€åä¸¤å¹´ä¸­</span><br><span class="line">In <span class="keyword">the</span> <span class="keyword">last</span> <span class="literal">two</span> decades åœ¨æœ€è¿‘äºŒåå¹´</span><br></pre></td></tr></table></figure><p><strong>website</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">we</span> : <span class="string">b : si : te ( è‹± /ËˆwebsaÉªt/ )</span></span><br><span class="line"><span class="meta">n.</span> <span class="string">ç½‘ç«™ï¼ˆå…¨çƒèµ„è®¯ç½‘çš„ä¸»æœºç«™ï¼‰</span></span><br><span class="line"><span class="meta">å¤æ•°</span> <span class="string">websites</span></span><br><span class="line"><span class="meta">ç½‘ç»œé‡Šä¹‰</span> <span class="string">ç½‘ç«™ï¼›ç½‘å€ï¼›ç½‘ç«™å»ºè®¾ï¼›ç«™ç‚¹</span></span><br><span class="line"><span class="attr">Website</span> <span class="string">ç½‘ç«™ï¼›ç½‘å€ï¼›ç½‘ç«™å»ºè®¾ï¼›ç«™ç‚¹</span></span><br><span class="line"><span class="attr">Website</span> <span class="string">Design ç½‘ç«™è®¾è®¡ï¼›ç½‘é¡µè®¾è®¡ï¼›ç½‘ç«™å»ºè®¾ï¼›å“ç‰Œç½‘ç«™å½¢è±¡è®¾è®¡</span></span><br><span class="line"><span class="attr">Website</span> <span class="string">Promotion ç½‘ç«™æ¨å¹¿ï¼›ç½‘ç«™æ¨å¹¿å¸¸è¯†ï¼›ç½‘ç«™æ¨å¹¿çŸ¥è¯†ï¼›ä¼ä¸šç½‘ç«™ç½‘ç»œæ¨å¹¿ï¼›</span></span><br><span class="line"><span class="attr">website</span> <span class="string">design ç½‘ç«™è®¾è®¡</span></span><br><span class="line"><span class="attr">website</span> <span class="string">promotion ç½‘ç«™æ¨å¹¿</span></span><br><span class="line"><span class="attr">website</span> <span class="string">development ç½‘ç«™å¼€å‘ï¼›ç½‘é¡µè®¾è®¡</span></span><br></pre></td></tr></table></figure><p><strong>patterns</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">pa</span> : <span class="string">tter : n : s</span></span><br><span class="line"><span class="meta">n.</span> <span class="string">æ¨¡å¼ï¼ˆpatternçš„å¤æ•°å½¢å¼ï¼‰</span></span><br><span class="line"><span class="meta">v.</span> <span class="string">æ‘¹åˆ¶ï¼›ç”¨å›¾æ¡ˆè£…é¥°ï¼›å¤å†™ï¼ˆpatternçš„ç¬¬ä¸‰äººç§°å•æ•°å½¢å¼ï¼‰</span></span><br><span class="line"><span class="meta">ç½‘ç»œé‡Šä¹‰</span> <span class="string">èŠ±æ ·ï¼›æ¨¡å‹ï¼›æœ¨æ¨¡ï¼›å½¢æ€</span></span><br><span class="line"><span class="attr">patterns</span> <span class="string">èŠ±æ ·ï¼›æ¨¡å‹ï¼›æœ¨æ¨¡ï¼›å½¢æ€</span></span><br><span class="line"><span class="attr">fashionable</span> <span class="string">patterns èŠ±è‰²å…¥æ—¶ï¼›èŠ±æ ·è¿›æ—¶ï¼›æ—¶å°šæ¨¡å¼ï¼›èŠ±æ ·å…¥æ—¶</span></span><br><span class="line"><span class="attr">Corrective</span> <span class="string">Patterns è°ƒæ•´æµªå½¢æ€ï¼›è°ƒå‰‚æµªå½¢æ€</span></span><br><span class="line"><span class="attr">development</span> <span class="string">patterns å‘å±•æ¨¡å¼</span></span><br></pre></td></tr></table></figure><p><strong>practices</strong></p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">p :</span> <span class="string">ra :</span> <span class="string">c :</span> <span class="string">ti :</span> <span class="string">ce :</span> s ( è‹± <span class="regexp">/ËˆprÃ¦ktÉªsÉªs/</span>  )</span><br><span class="line">n. å®è·µï¼ˆpractice çš„å¤æ•°ï¼‰ï¼›ç»ƒä¹ </span><br><span class="line">v. ç»ƒä¹ ï¼ˆpracticeçš„ç¬¬ä¸‰äººç§°å•æ•°å½¢å¼ï¼‰</span><br><span class="line">ç½‘ç»œé‡Šä¹‰ å®¢æˆ·ä¸“åŒºï¼›ä¸šåŠ¡ä¸­å¿ƒ</span><br><span class="line">Practices å®¢æˆ·ä¸“åŒºï¼›ä¸šåŠ¡ä¸­å¿ƒ</span><br><span class="line">Disciplinazy Practices æƒ©æˆ’æ€§æªæ–½ï¼›æ€§æªæ–½</span><br><span class="line">Agricultural practices å†œä¸šæ–¹å¼ï¼›è€•ä½œæ–¹æ³•ï¼›å†œä¸šæ–¹æ³•</span><br><span class="line">cultural practices æ–‡åŒ–å®è·µï¼›æ ½åŸ¹æŠ€æœ¯</span><br><span class="line">foreign corrupt practices act åå›½å¤–è¡Œè´¿æ³•è§„</span><br></pre></td></tr></table></figure><p><strong>easier</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ea</span> : <span class="string">si : er ( è‹± /'iËzÉªÉ™/  )</span></span><br><span class="line"><span class="meta">adj.</span> <span class="string">æ›´ç®€å•ï¼›å®¹æ˜“äº›ï¼ˆeasy çš„æ¯”è¾ƒçº§å½¢å¼ï¼‰ï¼›è¾ƒæ—©çš„</span></span><br><span class="line"><span class="meta">ç½‘ç»œé‡Šä¹‰</span> <span class="string">çŸ¥æ˜“è¡Œéš¾ï¼›æ›´ç®€å•ï¼›æ›´å®¹æ˜“çš„ï¼›æ›´ä¾¿æ·</span></span><br><span class="line"><span class="attr">Easier</span> <span class="string">çŸ¥æ˜“è¡Œéš¾ï¼›æ›´ç®€å•ï¼›æ›´å®¹æ˜“çš„ï¼›æ›´ä¾¿æ·</span></span><br><span class="line"><span class="attr">EASIER</span> <span class="string">RIDER æ›´é€é¥çš„éª‘å£«</span></span><br><span class="line"><span class="attr">Work</span> <span class="string">easier å·¥ä½œæ¯”è¾ƒè½»æ¾</span></span><br><span class="line"><span class="attr">easier</span> <span class="string">said than done è¯´æ¥å®¹æ˜“åšèµ·æ¥éš¾</span></span><br><span class="line"><span class="attr">make</span> <span class="string">life easier æ—¥å­ä¼šè¿‡å¾—æ›´æ½‡æ´’ï¼›ç”Ÿæ´»å˜å¾—æ›´åŠ èˆ’é€‚</span></span><br></pre></td></tr></table></figure><p><strong>useful</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">u</span> : <span class="string">se : ful ( è‹± /ËˆjuËsfl/  )</span></span><br><span class="line"><span class="meta">adj.</span> <span class="string">æœ‰ç”¨çš„ï¼›æœ‰ç›Šçš„ï¼›æœ‰å¸®åŠ©çš„</span></span><br><span class="line"><span class="meta">æ¯”è¾ƒçº§</span> <span class="string">more usefulï¼›</span></span><br><span class="line"><span class="meta">æœ€é«˜çº§</span> <span class="string">most useful</span></span><br><span class="line"><span class="meta">ç½‘ç»œé‡Šä¹‰</span> <span class="string">æœ‰ç”¨çš„ï¼›æœ‰ç›Šï¼›è½¯ç¢Ÿé€šè½¯ä»¶ï¼›æœ‰æ•ˆçš„</span></span><br><span class="line"><span class="attr">useful</span> <span class="string">æœ‰ç”¨çš„ï¼›æœ‰ç›Šï¼›è½¯ç¢Ÿé€šè½¯ä»¶ï¼›æœ‰æ•ˆçš„</span></span><br><span class="line"><span class="attr">Useful</span> <span class="string">numbers å¸¸ç”¨ç”µè¯å·ç ï¼›å¸¸ç”¨ç”µè¯ï¼›å¸¸ç”¨å¾·å¾‹é£å·ç ï¼›ç»å¸¸ä½¿ç”¨ç”µè¯å·å¤´</span></span><br><span class="line"><span class="attr">useful</span> <span class="string">resistance æœ‰ç›Šé˜»åŠ›</span></span><br><span class="line"><span class="attr">be</span> <span class="string">useful to å¯¹...æœ‰ç”¨ï¼›å…·æœ‰...ç”¨é€”</span></span><br><span class="line"><span class="attr">useful</span> <span class="string">life ä½¿ç”¨å¯¿å‘½ï¼›æœ‰æ•ˆæœŸ</span></span><br><span class="line"><span class="attr">useful</span> <span class="string">data æœ‰ç”¨æ•°æ®å’Œèµ„æ–™</span></span><br></pre></td></tr></table></figure><p><strong>began</strong></p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">be </span>: gan ( è‹± /<span class="keyword">bÉªËˆÉ¡Ã¦n/ </span>)</span><br><span class="line"><span class="symbol">v.</span> å¼€å§‹ï¼›åˆ›å»ºï¼›ç€æ‰‹äºï¼ˆ<span class="keyword">beginçš„è¿‡å»å¼ï¼‰</span></span><br><span class="line"><span class="keyword">ç½‘ç»œé‡Šä¹‰ </span>å¼€å§‹ï¼›è´åŠ ï¼›å¼€å§‹äº†ï¼›æ‰å¼€å§‹ï¼›</span><br><span class="line"><span class="keyword">began </span>å¼€å§‹ï¼›è´åŠ ï¼›å¼€å§‹äº†ï¼›æ‰å¼€å§‹</span><br><span class="line"><span class="keyword">Began </span>menopause å¼€å§‹æ›´å¹´æœŸ</span><br><span class="line"><span class="symbol">Passion</span> <span class="keyword">began </span>ç¿»è¯‘å…¬å¸å¼€å§‹</span><br><span class="line"><span class="keyword">begin </span>with ä»¥...å¼€å§‹ï¼›å¼€å§‹äº...</span><br><span class="line"><span class="keyword">begin </span>at å‡ ç‚¹å¼€å§‹ï¼›ä»..å¼€å§‹</span><br><span class="line"><span class="keyword">begin </span>again é‡æ–°å¼€å§‹ï¼›é‡åš</span><br></pre></td></tr></table></figure><p><strong>place</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">p</span> : <span class="string">la : ce ( è‹± /pleÉªs/  )</span></span><br><span class="line"><span class="meta">n.</span> <span class="string">åœ°æ–¹ï¼›ä½æ‰€ï¼›åº§ä½</span></span><br><span class="line"><span class="meta">vt.</span> <span class="string">æ”¾ç½®ï¼›ä»»å‘½ï¼›å¯„äºˆ</span></span><br><span class="line"><span class="meta">vi.</span> <span class="string">ååˆ—å‰èŒ…ï¼›å–å¾—åæ¬¡</span></span><br><span class="line"><span class="meta">è¿‡å»å¼</span> <span class="string">placed</span></span><br><span class="line"><span class="meta">è¿‡å»åˆ†è¯</span> <span class="string">placed</span></span><br><span class="line"><span class="meta">ç°åœ¨åˆ†è¯</span> <span class="string">placing</span></span><br><span class="line"><span class="meta">å¤æ•°</span> <span class="string">places</span></span><br><span class="line"><span class="meta">ç¬¬ä¸‰äººç§°å•æ•°</span> <span class="string">places</span></span><br><span class="line"><span class="meta">ç½‘ç»œé‡Šä¹‰</span> <span class="string">æ¸ é“ï¼›åœ°æ–¹ï¼›æ”¾ç½®ï¼›åœ°ç‚¹</span></span><br><span class="line"><span class="attr">Place</span> <span class="string">æ¸ é“ï¼›åœ°æ–¹ï¼›æ”¾ç½®ï¼›åœ°ç‚¹</span></span><br><span class="line"><span class="attr">Lanham</span> <span class="string">Place æœ—è±ªåŠï¼›æœ—è±ªé…’åº—ï¼›æœ—è±ªåŠå•†åœºï¼›æœ—è±ªé…’åº—</span></span><br><span class="line"><span class="attr">Martin</span> <span class="string">Place é©¬ä¸å¹¿åœºï¼›ç‰›ï¼›ç«è½¦ç«™</span></span><br><span class="line"><span class="attr">in</span> <span class="string">place é€‚å½“ï¼›é€‚å½“çš„ï¼›åœ¨é€‚å½“çš„åœ°æ–¹ï¼›åœ¨é€‚å½“çš„ä½ç½®</span></span><br><span class="line"><span class="attr">place</span> <span class="string">in å®‰æ’ï¼›æ”¾ç½®</span></span><br><span class="line"><span class="attr">take</span> <span class="string">place å‘ç”Ÿï¼›ä¸¾è¡Œ</span></span><br></pre></td></tr></table></figure><p><strong>publish</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">pub</span> : <span class="string">li : sh ( è‹± /ËˆpÊŒblÉªÊƒ/  )</span></span><br><span class="line"><span class="meta">vt.</span> <span class="string">å‡ºç‰ˆï¼›å‘è¡¨ï¼›å…¬å¸ƒ</span></span><br><span class="line"><span class="meta">vi.</span> <span class="string">å‡ºç‰ˆï¼›å‘è¡Œï¼›åˆŠå°</span></span><br><span class="line"><span class="meta">è¿‡å»å¼</span> <span class="string">published</span></span><br><span class="line"><span class="meta">è¿‡å»åˆ†è¯</span> <span class="string">published</span></span><br><span class="line"><span class="meta">ç°åœ¨åˆ†è¯</span> <span class="string">publishing</span></span><br><span class="line"><span class="meta">ç¬¬ä¸‰äººç§°å•æ•°</span> <span class="string">publishes</span></span><br><span class="line"><span class="meta">ç½‘ç»œé‡Šä¹‰</span> <span class="string">å‡ºç‰ˆï¼›å…¬å¸ƒï¼›å‘å¸ƒ</span></span><br><span class="line"><span class="attr">publish</span> <span class="string">å‡ºç‰ˆï¼›å…¬å¸ƒï¼›å‘å¸ƒ</span></span><br><span class="line"><span class="attr">publish</span> <span class="string">connections å‘å¸ƒè¿æ¥</span></span><br><span class="line"><span class="attr">Publish</span> <span class="string">Entry å‘å¸ƒé¡¹ï¼›å®£å¸ƒé¡¹</span></span><br></pre></td></tr></table></figure><p><strong>articles</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ar</span> : <span class="string">ti : cle : s</span></span><br><span class="line"><span class="attr">n.[è¯­]æ–‡ç« ï¼›ç‰©å“ï¼›[æ³•]æ¡æ¬¾ï¼ˆarticleçš„å¤æ•°ï¼‰ï¼›[è¯­]å† è¯</span></span><br><span class="line"><span class="meta">v.</span> <span class="string">ä½¿å—åè®®æ¡æ¬¾çš„çº¦æŸï¼›æŒ‡æ§ï¼ˆarticleçš„ä¸‰å•å½¢å¼ï¼‰</span></span><br><span class="line"><span class="meta">ç½‘ç»œé‡Šä¹‰</span> <span class="string">å† è¯ï¼›æ–‡ç« ï¼›å„æ¡ï¼›æœ¬åˆŠ</span></span><br><span class="line"><span class="attr">Articles</span> <span class="string">å† è¯ï¼›æ–‡ç« ï¼›å„æ¡ï¼›æœ¬åˆŠ</span></span><br><span class="line"><span class="attr">Instant</span> <span class="string">Articles å³æ—¶æ–‡ç« ï¼›æ–°é—»å¿«è¯»ï¼›å³æ—¶æ–‡æ±‡ï¼›æ–‡ç« å¿«æ‰‹</span></span><br><span class="line"><span class="attr">Plastic</span> <span class="string">Articles å¡‘æ–™åˆ¶å“ï¼›å¡‘æ–™ä»¶ï¼›æ•´å½¢ç¯‡ï¼›ä¸»è¦è¿›å£å•†å“è‹±æ–‡</span></span><br><span class="line"><span class="attr">articles</span> <span class="string">of association å…¬å¸ç« ç¨‹ï¼›ç»„ç»‡ç« ç¨‹</span></span><br><span class="line"><span class="attr">articles</span> <span class="string">for daily use ç”Ÿæ´»ç”¨å“</span></span><br><span class="line"><span class="attr">original</span> <span class="string">articles åŸä½œï¼›ç ”ç©¶æ–‡ç« </span></span><br></pre></td></tr></table></figure><p><strong>colleagues</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">co</span> : <span class="string">lle : gu : es</span></span><br><span class="line"><span class="meta">n.</span> <span class="string">åŒäº‹ï¼›åŒè¡Œï¼ˆcolleagueçš„å¤æ•°ï¼‰</span></span><br><span class="line"><span class="meta">ç½‘ç»œé‡Šä¹‰</span> <span class="string">åŒä»ï¼›åŒäººï¼›åŒäº‹ï¼›åŒäº‹ä¹‹é—´</span></span><br><span class="line"><span class="attr">Colleagues</span> <span class="string">åŒä»ï¼›åŒäººï¼›åŒäº‹ï¼›åŒäº‹ä¹‹é—´</span></span><br><span class="line"><span class="attr">Visiting</span> <span class="string">Colleagues æ‹œè®¿åŒäº‹ï¼›é€ è®¿åŒäº‹</span></span><br><span class="line"><span class="attr">Complimenting</span> <span class="string">Colleagues èµç¾åŒäº‹ï¼›èµèª‰åŒäº‹</span></span><br></pre></td></tr></table></figure><p><strong>joined</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jo</span> : <span class="string">in : ed ( è‹± /dÊ’É”ind/  )</span></span><br><span class="line"><span class="meta">v.</span> <span class="string">åŠ å…¥ï¼›å‚åŠ ï¼ˆjoinçš„è¿‡å»å¼ï¼›è¿‡å»åˆ†è¯ï¼‰ï¼›[è®¡]è¿æ¥</span></span><br><span class="line"><span class="meta">ç½‘ç»œé‡Šä¹‰</span> <span class="string">åŠ å…¥ï¼›å®¢æˆ·ç•™è¨€ï¼›è¿æ¥ï¼›æ‹›ç”Ÿç®€ç« </span></span><br><span class="line"><span class="attr">joined</span> <span class="string">åŠ å…¥ï¼›å®¢æˆ·ç•™è¨€ï¼›è¿æ¥ï¼›æ‹›ç”Ÿç®€ç« </span></span><br><span class="line"><span class="attr">JOINED</span> <span class="string">Strategy è¿æ¥ç­–ç•¥</span></span><br><span class="line"><span class="attr">joined</span> <span class="string">field å°†ä¸¤ä¸ªè¡¨ä¸­è¿æ¥å­—æ®µ</span></span><br><span class="line"><span class="attr">join</span> <span class="string">hands æºæ‰‹ï¼›è”æ‰‹ï¼›é½å¿ƒååŠ›</span></span><br><span class="line"><span class="attr">join</span> <span class="string">in åŠ å…¥ï¼›å‚åŠ </span></span><br><span class="line"><span class="attr">join</span> <span class="string">hands with æ¡æ‰‹ï¼›åŒ...è”åˆ</span></span><br></pre></td></tr></table></figure><p><strong>ThoughtWorks</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>role</strong></p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ro : le ( è‹± /rÉ™ÊŠl/  )</span><br><span class="line">n. è§’è‰²ï¼›ä»»åŠ¡</span><br><span class="line">ç½‘ç»œé‡Šä¹‰ è§’è‰²ï¼›ä½œç”¨ï¼›ç¤¾ä¼šè§’è‰²ï¼›ä»»åŠ¡</span><br><span class="line"><span class="keyword">Role</span> <span class="title">è§’è‰²ï¼›ä½œç”¨ï¼›ç¤¾ä¼šè§’è‰²ï¼›ä»»åŠ¡</span></span><br><span class="line"><span class="title">role</span> playing è§’è‰²æ‰®æ¼”ï¼›è§’è‰²æ‰®æ¼”æ³•ï¼›èŒèƒ½æ¼”ä¹ ï¼›è§’è‰²è¡¨æ¼”</span><br><span class="line"><span class="keyword">role</span> <span class="title">model</span> è¡Œä¸ºæ¦œæ ·ï¼›è§’è‰²æ¨¡å‹ï¼›æ¦œæ ·ï¼›æ¨¡èŒƒ</span><br><span class="line"><span class="keyword">role</span> <span class="title">of</span> ....çš„è§’è‰²</span><br><span class="line">play an important <span class="keyword">role</span> <span class="title">èµ·åˆ°é‡è¦ä½œç”¨</span></span><br><span class="line"><span class="title">leading</span> <span class="keyword">role</span> <span class="title">ä¸»å¯¼ä½œç”¨ï¼›ä¸»å¯¼åœ°ä½</span></span><br></pre></td></tr></table></figure><p><strong>learn</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">lear</span> : <span class="string">n ( è‹± /lÉœËn/  )</span></span><br><span class="line"><span class="meta">vt.</span> <span class="string">å­¦ä¹ ï¼›å¾—çŸ¥ï¼›è®¤è¯†åˆ°</span></span><br><span class="line"><span class="meta">vi.</span> <span class="string">å­¦ä¹ ï¼›è·æ‚‰</span></span><br><span class="line"><span class="meta">è¿‡å»å¼</span> <span class="string">learned æˆ– learnt</span></span><br><span class="line"><span class="meta">è¿‡å»åˆ†è¯</span> <span class="string">learned æˆ– learnt</span></span><br><span class="line"><span class="meta">ç°åœ¨åˆ†è¯</span> <span class="string">learning</span></span><br><span class="line"><span class="meta">ç½‘ç»œé‡Šä¹‰</span> <span class="string">å­¦ä¼šï¼›å¾—çŸ¥</span></span><br><span class="line"><span class="attr">Learn</span> <span class="string">å­¦ä¼šï¼›å¾—çŸ¥</span></span><br><span class="line"><span class="attr">learn</span> <span class="string">about äº†è§£ï¼›å¾—çŸ¥ï¼›è·æ‚‰ï¼›å¬åˆ°</span></span><br><span class="line"><span class="attr">learn</span> <span class="string">of å¬åˆ°ï¼›è·æ‚‰ï¼›è·æ‚‰çš„äº‹ï¼›å¬è¯´</span></span><br><span class="line"><span class="attr">learn</span> <span class="string">from å‘...å­¦ä¹ </span></span><br><span class="line"><span class="attr">learn</span> <span class="string">English å­¦ä¹ è‹±è¯­</span></span><br><span class="line"><span class="attr">learn</span> <span class="string">about äº†è§£ï¼›å­¦ä¹ </span></span><br></pre></td></tr></table></figure><p><strong>deliver</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">de</span> : <span class="string">li : ver ( è‹± /dÉªËˆlÉªvÉ™(r)/  )</span></span><br><span class="line"><span class="meta">vt.</span> <span class="string">äº¤ä»˜ï¼›å‘è¡¨ï¼›é€’é€ï¼›é‡Šæ”¾ï¼›ç»™äºˆï¼ˆæ‰“å‡»ï¼‰ï¼›ç»™...æ¥ç”Ÿ</span></span><br><span class="line"><span class="meta">vi.</span> <span class="string">å®ç°ï¼›ä¼ é€ï¼›å±¥è¡Œï¼›æŠ•é€’</span></span><br><span class="line"><span class="meta">n.</span> <span class="string">æŠ•çƒ</span></span><br><span class="line"><span class="meta">è¿‡å»å¼</span> <span class="string">delivered</span></span><br><span class="line"><span class="meta">è¿‡å»åˆ†è¯</span> <span class="string">delivered</span></span><br><span class="line"><span class="meta">ç°åœ¨åˆ†è¯</span> <span class="string">delivering</span></span><br><span class="line"><span class="meta">ç¬¬ä¸‰äººç§°å•æ•°</span> <span class="string">delivers</span></span><br><span class="line"><span class="meta">ç½‘ç»œé‡Šä¹‰</span> <span class="string">æŠ•é€’ï¼›äº¤ä»˜ï¼›å‘å‡ºï¼›å‘è¡¨</span></span><br><span class="line"><span class="attr">deliver</span> <span class="string">æŠ•é€’ï¼›äº¤ä»˜ï¼›å‘å‡ºï¼›å‘è¡¨</span></span><br><span class="line"><span class="attr">deliver</span> <span class="string">value ä»·å€¼ä¼ é€’ï¼›ä¼ é€’ä»·å€¼</span></span><br><span class="line"><span class="attr">Deliver</span> <span class="string">Hope ä¼ é€’å¸Œæœ›ï¼›é€’é€å¸Œæœ›</span></span><br><span class="line"><span class="attr">deliver</span> <span class="string">the goods äº¤è´§ï¼›å±¥è¡Œè¯ºè¨€</span></span><br><span class="line"><span class="attr">deliver</span> <span class="string">a speech å‘è¡¨æ¼”è®²ï¼›å‘è¡¨è®²è¯</span></span><br></pre></td></tr></table></figure><p><strong>clients</strong></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">c : lien : ts</span><br><span class="line">n. é¡¾å®¢ï¼›å®¢æˆ·ç«¯ï¼›å§”æ‰˜æ–¹ï¼ˆclientçš„å¤æ•°ï¼‰ï¼›æ•‘æµå¯¹è±¡ï¼›åº”å—è´¦æ¬¾</span><br><span class="line">ç½‘ç»œé‡Šä¹‰ å®¢æˆ·ï¼›å®¢æˆ·ç«¯ï¼›æ¡ˆä¾‹ï¼›åˆä½œå®¢æˆ·</span><br><span class="line">Clients å®¢æˆ·ï¼›å®¢æˆ·ç«¯ï¼›æ¡ˆä¾‹ï¼›åˆä½œå®¢æˆ·</span><br><span class="line">major clients å¤§å®¢æˆ·ï¼›ä¸»è¦å®¢æˆ·ï¼›å®¢æˆ·</span><br><span class="line">Entertaining Clients æ‹›å¾…å®¢æˆ·ï¼›æ¬¾å¾…å®¢æˆ·ï¼›å®´è¯·å®¢æˆ·ï¼›æ¥å¾…å®¢æˆ·</span><br><span class="line">client<span class="built_in"> service </span>å®¢æˆ·æœåŠ¡ï¼›å‘å§”æ‰˜éƒ¨é—¨æä¾›æœåŠ¡</span><br><span class="line">client base å®¢æˆ·ç¾¤ï¼›åŸºæœ¬é¡¾å®¢</span><br><span class="line">client side å®¢æˆ·ç«¯ï¼›ä½¿ç”¨ç«¯</span><br></pre></td></tr></table></figure><p><strong>pass</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">pa</span> : <span class="string">ss ( è‹± /pÉ‘Ës/  )</span></span><br><span class="line"><span class="meta">v.</span> <span class="string">é€šè¿‡ï¼›ç»è¿‡ï¼›æ²¿æŸæ–¹å‘å‰è¿›ï¼›ä½¿è¾¾åˆ°ï¼ˆæŸä½ç½®ï¼‰ï¼›ä¼ é€’ï¼›ä¼ çƒï¼›é—ç•™ç»™ï¼›è¶…è¿‡ï¼›å˜åŒ–ï¼›æ¨ç§»ï¼›åº¦è¿‡ï¼›ç»ˆæ­¢ï¼›å‡ ä¸ªï¼›ç»è¡¨å†³é€šè¿‡ï¼ˆæ³•å¾‹ç­‰ï¼‰ï¼›å…è®¸ï¼›å®£å¸ƒï¼›è¿‡ï¼›æ’æ³„ï¼›æµé€šï¼›æ”¾å¼ƒ</span></span><br><span class="line"><span class="meta">n.</span> <span class="string">åŠæ ¼ï¼›ç»è¿‡ï¼›é€šè¡Œè¯ï¼›é“è·¯ï¼Œå±±å£ï¼›ä¼ çƒï¼›é£è·ƒï¼›é˜¶æ®µï¼›é±¼é“ï¼›ï¼ˆæ¡¥ç‰Œï¼‰ä¸å«ï¼›ï¼ˆå‡»å‰‘ä¸­çš„ï¼‰æˆ³åˆºï¼›å˜æˆæ³•ï¼›ï¼ˆè®¡ç®—æœºï¼‰ä¸€æ¬¡æµè§ˆ</span></span><br><span class="line"><span class="meta">è¿‡å»å¼</span> <span class="string">passed</span></span><br><span class="line"><span class="meta">è¿‡å»åˆ†è¯</span> <span class="string">passed</span></span><br><span class="line"><span class="meta">ç°åœ¨åˆ†è¯</span> <span class="string">passing</span></span><br><span class="line"><span class="meta">ç¬¬ä¸‰äººç§°å•æ•°</span> <span class="string">passes</span></span><br><span class="line"><span class="meta">ç½‘ç»œé‡Šä¹‰</span> <span class="string">ä¼ çƒï¼›é€šè¿‡ï¼›ç»è¿‡ï¼›ä¼ é€’</span></span><br><span class="line"><span class="attr">Pass</span> <span class="string">ä¼ çƒï¼›é€šè¿‡ï¼›ç»è¿‡ï¼›ä¼ é€’</span></span><br><span class="line"><span class="attr">scissor</span> <span class="string">pass äº¤å‰ä¼ çƒï¼›äº¤ç»‡ä¼ çƒï¼›ç©¿æ’ä¼ çƒï¼›ä¼ çƒ</span></span><br><span class="line"><span class="attr">Khyber</span> <span class="string">Pass å¼€ä¼¯å°”å±±å£ï¼›å¼€ä¼¯å°”é€šé“ï¼›å’–å–±ç‹</span></span><br><span class="line"><span class="attr">pass</span> <span class="string">through ç©¿è¿‡....ï¼›é€šè¿‡...</span></span><br><span class="line"><span class="attr">come</span> <span class="string">to pass å®ç°ï¼›å‘ç”Ÿ</span></span><br><span class="line"><span class="attr">pass</span> <span class="string">on ä¼ é€’ï¼›ç»§ç»­ï¼›å»ä¸–</span></span><br></pre></td></tr></table></figure><p><strong>wider</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">wi</span> : <span class="string">d : er ( è‹± /waÉªdÉ™(r)/  )</span></span><br><span class="line"><span class="meta">adj.</span> <span class="string">å®½çš„ï¼›å¹¿é˜”çš„ï¼ˆwideçš„æ¯”è¾ƒçº§å½¢å¼ï¼‰</span></span><br><span class="line"><span class="meta">ç½‘ç»œé‡Šä¹‰</span> <span class="string">å¿«å°”è¾¾ï¼›ä¸–ç•Œå‘å±•ç»æµç ”ç©¶æ‰€ï¼›å®½çš„</span></span><br><span class="line"><span class="attr">WIDER</span> <span class="string">å¿«å°”è¾¾ï¼›ä¸–ç•Œå‘å±•ç»æµç ”ç©¶æ‰€ï¼›å®½çš„</span></span><br><span class="line"><span class="attr">wider</span> <span class="string">margin è¾ƒå¤§å·®å¹…ï¼›ä¿åˆ©</span></span><br><span class="line"><span class="attr">wider</span> <span class="string">spreading æ›´å¤§çš„ç©¿ç”µ</span></span><br></pre></td></tr></table></figure><p><strong>industry</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">in</span> : <span class="string">du : s : try ( è‹± /ËˆÉªndÉ™stri/  )</span></span><br><span class="line"><span class="meta">n.</span> <span class="string">äº§ä¸šï¼›å·¥ä¸šï¼›å‹¤å‹‰</span></span><br><span class="line"><span class="meta">å¤æ•°</span> <span class="string">industries</span></span><br><span class="line"><span class="meta">ç½‘ç»œé‡Šä¹‰</span> <span class="string">äº§ä¸šï¼›å·¥ä¸šï¼›èŒä¸šï¼›è¡Œä¸š</span></span><br><span class="line"><span class="attr">industry</span> <span class="string">äº§ä¸šï¼›å·¥ä¸šï¼›èŒä¸šï¼›è¡Œä¸š</span></span><br><span class="line"><span class="attr">water</span> <span class="string">industry æ°´åˆ©äº§ä¸šï¼›æ°´äº§ä¸šï¼›æ°´å·¥ä¸š</span></span><br><span class="line"><span class="attr">automobile</span> <span class="string">industry æ±½è½¦å·¥ä¸šï¼›æ±½è½¦äº§ä¸šï¼›æ±½è½¦ä¸šï¼›æ±½è½¦åˆ¶é€ ä¸š</span></span><br><span class="line"><span class="attr">industry</span> <span class="string">and commerce å·¥å•†ä¸š</span></span><br><span class="line"><span class="attr">chemical</span> <span class="string">industry åŒ–å­¦å·¥ä¸š</span></span><br><span class="line"><span class="attr">manufacturing</span> <span class="string">industry åˆ¶é€ ä¸šï¼›åˆ¶é€ å·¥ä¸š</span></span><br></pre></td></tr></table></figure><p><strong>site</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">si</span> : <span class="string">te ( è‹± /saÉªt/ )</span></span><br><span class="line"><span class="meta">n.</span> <span class="string">åœ°ç‚¹ï¼›ä½ç½®ï¼›åœºæ‰€</span></span><br><span class="line"><span class="meta">vt.</span> <span class="string">è®¾ç½®ï¼›ä¸º...é€‰å€</span></span><br><span class="line"><span class="meta">è¿‡å»å¼</span> <span class="string">sited</span></span><br><span class="line"><span class="meta">è¿‡å»åˆ†è¯</span> <span class="string">sited</span></span><br><span class="line"><span class="meta">ç°åœ¨åˆ†è¯</span> <span class="string">siting</span></span><br><span class="line"><span class="meta">å¤æ•°</span> <span class="string">sites</span></span><br><span class="line"><span class="meta">ç¬¬ä¸‰äººç§°å•æ•°</span> <span class="string">sites</span></span><br><span class="line"><span class="meta">ç½‘ç»œé‡Šä¹‰</span> <span class="string">ç«™ç‚¹ï¼›åœºåœ°ï¼›ç°åœºï¼›åœºæ‰€</span></span><br><span class="line"><span class="attr">Site</span> <span class="string">ç«™ç‚¹ï¼›åœºåœ°ï¼›ç°åœºï¼›åœºæ‰€</span></span><br><span class="line"><span class="attr">Site</span> <span class="string">planning æ•·åœ°è®¡åˆ’ï¼›æ€»å¹³é¢è®¾è®¡ï¼›åœºåœ°è§„åˆ’</span></span><br><span class="line"><span class="attr">Site</span> <span class="string">Selection é€‰å€ï¼›åŸºåœ°é€‰æ‹©ï¼›åœºåœ°é€‰æ‹©</span></span><br><span class="line"><span class="attr">web</span> <span class="string">site ç½‘é¡µï¼›ç½‘å€</span></span><br><span class="line"><span class="attr">on</span> <span class="string">site ç°åœºï¼›åŸåœ°ï¼›åŸä½</span></span><br><span class="line"><span class="attr">construction</span> <span class="string">site å»ºç­‘å·¥åœ°ï¼›æ–½å·¥åœºåœ°</span></span><br></pre></td></tr></table></figure><p><strong>developed</strong></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">de : ve : lo : p : ed ( è‹± /dÉªËˆvelÉ™pt/ )</span><br><span class="line">adj. å‘è¾¾çš„ï¼ˆå›½å®¶æˆ–åœ°åŒºï¼‰ï¼›æˆç†Ÿçš„</span><br><span class="line">ç½‘ç»œé‡Šä¹‰ å‘è¾¾ï¼›è‡ªä¸»å¼€å‘ï¼›ç ”åˆ¶å‡ºï¼›æˆç†Ÿçš„</span><br><span class="line">Developed å‘è¾¾ï¼›è‡ªä¸»å¼€å‘ï¼›ç ”åˆ¶å‡ºï¼›æˆç†Ÿçš„</span><br><span class="line">developed countries å‘è¾¾å›½å®¶ï¼›å·²å¼€å‘å›½å®¶ï¼›å·²å‘å±•å›½å®¶ï¼›å‘è¾¾å›½å®¶æˆ–å·¥ä¸šåŒ–å›½å®¶</span><br><span class="line">developed dimension å±•å¼€å°ºå¯¸</span><br><span class="line">developed country n.å‘è¾¾å›½å®¶</span><br><span class="line">developed<span class="built_in"> area </span>[è®¡]å±•å¼€é¢ç§¯</span><br><span class="line">less developed æ¬ å‘è¾¾åœ°åŒºï¼›ä¸å‘è¾¾çš„</span><br></pre></td></tr></table></figure><p><strong>respected</strong></p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">re :</span> <span class="string">s :</span> <span class="string">pe :</span> <span class="string">c :</span> <span class="string">te :</span> d ( è‹± <span class="regexp">/ri'spektid/</span>  )</span><br><span class="line">adj. å—å°Šæ•¬çš„</span><br><span class="line">v. å°Šæ•¬ï¼›é‡è§†ï¼ˆrespectçš„è¿‡å»å¼å’Œè¿‡å»åˆ†è¯ï¼‰</span><br><span class="line">ç½‘ç»œé‡Šä¹‰ æ¨å´‡ï¼›å—å°Šæ•¬çš„ï¼›å¾·é«˜æœ›é‡ï¼›å—äººå°Šæ•¬</span><br><span class="line">Respected æ¨å´‡ï¼›å—å°Šæ•¬çš„ï¼›å¾·é«˜æœ›é‡ï¼›å—äººå°Šæ•¬</span><br><span class="line">Are respected å¾ˆå—å°Šæ•¬</span><br><span class="line">Respected person å¾·é«˜æœ›é‡çš„äºº</span><br><span class="line">respected ideas å…¬è®¤ç†è®ºï¼›æƒå¨ç†è®º</span><br><span class="line">be respected <span class="keyword">as</span> è¢«å°Šä¸º...</span><br></pre></td></tr></table></figure><p><strong>platform</strong></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">p : la : t : <span class="keyword">for</span> : m ( è‹± /ËˆplÃ¦tfÉ”Ëm/  )</span><br><span class="line">n. å¹³å°ï¼›æœˆå°ï¼›ç«™å°ï¼›å›ï¼›è®²å°ï¼›åšåº•æ¾ç³•é‹</span><br><span class="line">ç½‘ç»œé‡Šä¹‰ å¹³å°ï¼›ç«™å°ï¼›å°ï¼›å¹³å°</span><br><span class="line">platform å¹³å°ï¼›ç«™å°ï¼›å°ï¼›å¹³å°</span><br><span class="line">side platform ä¾§å¼ç«™å°ï¼›ä¾§å¼æœˆå°ï¼›ä¾§å‘å¼ç«™å°ï¼›ä¾§å‘æ”¶å‰²å°</span><br><span class="line">fixed platform å›ºå®šå¹³å°ï¼›å›ºå®šå¼å¹³å°ï¼›å›ºå®šå¼é’»äº•å¹³å°</span><br><span class="line">service platform å·¥ä½œå°ï¼›æ“ä½œå¹³å°</span><br><span class="line">offshore platform æµ·ä¸Šå¹³å°ï¼›è¿‘æµ·å¹³å°</span><br><span class="line">open platform å¼€æ”¾å¹³å°</span><br></pre></td></tr></table></figure><p><strong>edited</strong></p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">e</span> : <span class="keyword">di</span> :<span class="keyword">te</span> : <span class="keyword">d</span> ( è‹± /'<span class="keyword">ed</span>ÉªtÉª<span class="keyword">d</span>/  )</span><br><span class="line">adj. ç¼–è¾‘è¿‡çš„</span><br><span class="line">v. ç¼–è¾‘ï¼›æ ¡è®¢ï¼›å‰ªæ¥ï¼›ä¸»ç¼–ï¼ˆ<span class="keyword">edit</span>çš„è¿‡å»å¼å’Œè¿‡å»åˆ†è¯ï¼‰</span><br><span class="line">ç½‘ç»œé‡Šä¹‰ ç¼–è¾‘è¿‡çš„ï¼›ç¼–è¾‘ï¼›åˆ†é’Ÿï¼›å·²ç¼–è¾‘</span><br><span class="line">Edited ç¼–è¾‘è¿‡çš„ï¼›ç¼–è¾‘ï¼›åˆ†é’Ÿï¼›å·²ç¼–è¾‘</span><br><span class="line">Edited Books ç¼–è¾‘ä¹¦ç±</span><br><span class="line">SpinnBox Edited æ—‹è½¬æ–¹å—</span><br><span class="line"><span class="keyword">edit</span> box [è®¡]ç¼–è¾‘æ¡†</span><br><span class="line"><span class="keyword">edit</span> mode [è®¡]ç¼–è¾‘æ–¹å¼</span><br><span class="line"><span class="keyword">edit</span> <span class="keyword">window</span> ç¼–è¾‘çª—å£</span><br></pre></td></tr></table></figure><p><strong>published</strong></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">adj. å·²å‘å¸ƒçš„</span><br><span class="line">v. å‡ºç‰ˆï¼›å‘è¡Œï¼ˆpublishçš„è¿‡å»å¼ï¼‰</span><br><span class="line">ç½‘ç»œé‡Šä¹‰ åˆŠç™»ï¼›åˆŠå‡ºï¼›åˆŠå‘ï¼›åˆŠè½½</span><br><span class="line">Published åˆŠç™»ï¼›åˆŠå‡ºï¼›åˆŠå‘ï¼›åˆŠè½½</span><br><span class="line">published<span class="built_in"> interface </span>å·²å‘å¸ƒæ¥å£ï¼›å‘å¸ƒæ¥å£</span><br><span class="line">published angle é¢„å®š</span><br><span class="line">published price å›¾ä¹¦é›¶å”®ä»·ï¼›å®šä»·ï¼›å…¬å¸ƒä»·æ ¼</span><br></pre></td></tr></table></figure><p><strong>ThoughtWorkers</strong></p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line">**others**</span><br></pre></td></tr></table></figure><p>  o : ther : s ( è‹± /ËˆÊŒÃ°É™(r)z/   )<br>  pron. å…¶ä»–äºº<br>  ç½‘ç»œé‡Šä¹‰ å…¶å®ƒï¼›å…¶ä»–ï¼›å…¨éƒ¨ä¿¡æ¯ï¼›å…¶ä»–ç»„ä»¶ä¿å…»<br>  Others å…¶ä»–ï¼›å…¶å®ƒï¼›å…¨éƒ¨ä¿¡æ¯ï¼›å…¶ä»–ç»„ä»¶ä¿å…»<br>  the others å°å²›æƒŠé­‚ï¼›ç¥é¬¼ç¬¬å…­æ„Ÿï¼›å…¶å®ƒ<br>  Introduce Others å…ˆå®¹åˆ«äºº<br>  each other å½¼æ­¤ï¼›äº’ç›¸<br>  on the other å¦ä¸€æ–¹é¢<br>  on the other hand å¦ä¸€æ–¹é¢</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*reach*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  rea : ch (  è‹± /riËtÊƒ/ )<br>  vi. è¾¾åˆ°ï¼›å»¶ä¼¸ï¼›ä¼¸å‡ºæ‰‹ï¼›ä¼ å¼€<br>  vt. è¾¾åˆ°ï¼›å½±å“ï¼›æŠµè¾¾ï¼›ä¼¸å‡º<br>  n. èŒƒå›´ï¼›å»¶ä¼¸ï¼›æ²³æ®µï¼›æ¨ªé£è¡Œé©¶<br>  ç¬¬ä¸‰äººç§°å•æ•° reaches<br>  è¿‡å»å¼ reached<br>  è¿‡å»åˆ†è¯ reached<br>  ç°åœ¨åˆ†è¯ reaching<br>  ç½‘ç»œé‡Šä¹‰ åˆ°è¾¾ï¼›è¾¾åˆ°ï¼›åˆ°è¾¾ç‡ï¼›åŒ–å­¦å“æ³¨å†Œ<br>  Reach åˆ°è¾¾ï¼›è¾¾åˆ°ï¼›åˆ°è¾¾ç‡ï¼›åŒ–å­¦å“æ³¨å†Œ<br>  Reach Me ä¹¦ç¼˜å¯»è¸ªï¼›æŠ“ä½æˆ‘ï¼›è¯·ä¸æˆ‘è”ç³»ï¼›è”ç³»æˆ‘<br>  reach out ä¼¸å‡ºï¼›æä¾›æ´åŠ©ï¼›æ¥çº³æˆ‘<br>  reach out vt. ä¼¸å‡º<br>  reach for ä¼¸æ‰‹å»æ‹¿<br>  reach an agreement è¾¾æˆåè®®ï¼›å–å¾—ä¸€è‡´æ„è§ï¼›è¾¾æˆå…±è¯†</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*audience*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  au : di : en : ce ( è‹± /ËˆÉ”ËdiÉ™ns/  )<br>  n. è§‚ä¼—ï¼›å¬ä¼—ï¼›è¯»è€…ï¼›æ¥è§ï¼›æ­£å¼ä¼šè§ï¼›æ‹œä¼š<br>  ç½‘ç»œé‡Šä¹‰ è§‚ä¼—ï¼›å¬ä¼—ï¼›å—ä¼—ï¼›é˜…å¬äºº<br>  Audience è§‚ä¼—ï¼›å¬ä¼—ï¼›å—ä¼—ï¼›é˜…å¬äºº<br>  target audience ç›®æ ‡è§‚ä¼—ï¼›ç›®æ ‡æ¶ˆè´¹è€…ï¼›ç›®æ ‡å¤§ä¼—ï¼›ç›®æ ‡å—ä¼—<br>  Audience area å¬ä¼—åŒºï¼›çœ‹å°åŒºï¼›è§‚ä¼—åŒº<br>  target audience ç›®æ ‡å—ä¼—ï¼›ç›®æ ‡è§‚ä¼—ï¼›ç›®æ ‡å®¢æˆ·<br>  audience rating n. æ”¶è§†ç‡ï¼›è¯•å¬ç‡<br>  mass audience å¤§ä¼—å—ä¼—</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*material*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  ma : te : ri : al ( è‹± /mÉ™ËˆtÉªÉ™riÉ™l/  )<br>  n. ææ–™ï¼›ç”¨å…·ï¼›ï¼ˆæœ‰æŒ‡æ˜ç‰¹å¾çš„ï¼‰äººæ‰ï¼›ç´ æï¼›æ›²ç›®ï¼›å¸ƒæ–™<br>  adj. ç‰©è´¨çš„ï¼›èº«ä½“éœ€è¦çš„ï¼›å’Œæ¨ç†å†…å®¹ç›¸å…³çš„ï¼›é‡è¦çš„ï¼›ï¼ˆè¯æ®æˆ–äº‹å®ï¼‰å†³å®šæ€§çš„ï¼›å®¢è§‚å­˜åœ¨çš„ï¼›ç‰©æ¬²çš„<br>  n. (Material)(æ„ã€ç¾)å¦ˆç‰¹åŠ›å¨…ä¸½ï¼ˆäººåï¼‰<br>  å¤æ•° materials<br>  ç½‘ç»œé‡Šä¹‰ æè´¨ï¼›ææ–™ï¼›ç‰©æ–™ï¼›èµ„æ–™<br>  Material æè´¨ï¼›ææ–™ï¼›ç‰©æ–™ï¼›èµ„æ–™<br>  Material Girl ç‰©è´¨å¥³å­©ï¼›æ‹œé‡‘å¥³å­©ï¼›ç‰©è´¨å¥³éƒï¼›æ‹œé‡‘å¥³éƒ<br>  insulating material éš”çƒ­ææ–™ï¼›ç»çƒ­ææ–™ï¼›ç»ç¼˜ç‰©<br>  raw material åŸæ–™<br>  teaching material æ•™å­¦å†…å®¹ï¼›æ•™å­¦èµ„æ–™<br>  new material æ–°ææ–™</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*MicroServices*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  Mi: cro : Ser : vi : ce : s<br>  å¾®æœåŠ¡ï¼›<br>  å¾®æœåŠ¡æ¶æ„<br>  ç½‘ç»œé‡Šä¹‰ å¾®æœåŠ¡ï¼›å¾®æœåŠ¡æ¶æ„<br>  Microservices å¾®æœåŠ¡ï¼›å¾®æœåŠ¡æ¶æ„<br>  cognitive microservices è®¤çŸ¥å¾®æœåŠ¡ï¼›è®¤è¯å¾®æœåŠ¡<br>  Microservices Architecture å¾®æœåŠ¡æ¶æ„</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*Guide*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  gui : de  ( è‹± /É¡aÉªd/ )<br>  n. æŒ‡å—ï¼›å‘å¯¼ï¼›å…¥é—¨ä¹¦ï¼›<br>  vt. å¼•å¯¼ï¼›å¸¦é¢†ï¼›æ“çºµï¼›<br>  vi. æ‹…ä»»å‘å¯¼ï¼›<br>  n.(Guide)äººåï¼›ï¼ˆæ³•ã€è‘¡ï¼‰å‰å¾·<br>  è¿‡å»å¼ guidedï¼›<br>  è¿‡å»åˆ†è¯ guidedï¼›<br>  ç°åœ¨åˆ†è¯ guidingï¼›<br>  å¤æ•° guidesï¼›<br>  ç¬¬ä¸‰äººç§°å•æ•° guidesï¼›<br>  ç½‘ç»œé‡Šä¹‰ å¯¼æ¸¸ã€æŒ‡å¯¼ã€æŒ‡å—ã€é¢†é˜Ÿ<br>  Guide å¯¼æ¸¸ï¼›æŒ‡å¯¼ï¼›æŒ‡å—ï¼›é¢†é˜Ÿï¼›<br>  guide post è·¯æ ‡ï¼›å¼•å¯¼æŸ±ï¼›å¯¼æŸ±ï¼›å¯¼æ†<br>  User Guide è¯´æ˜ä¹¦ï¼›ç”¨æˆ·æŒ‡å—ï¼›ç”¨æˆ·æ“ä½œæ‰‹å†Œ</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*In short*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  æ€»ä¹‹ï¼›<br>  ç®€è¨€ä¹‹ï¼›<br>  ç½‘ç»œé‡Šä¹‰ ç®€è¨€ä¹‹ï¼›æ€»ä¹‹ï¼›ç®€è€Œè¨€ä¹‹ï¼›ç®€å•åœ°è¯´<br>  in short ç®€è¨€ä¹‹ï¼›æ€»ä¹‹ï¼›ç®€è€Œè¨€ä¹‹ï¼›ç®€å•åœ°è¯´<br>  in the short term ä»çŸ­æœŸæ¥çœ‹<br>  in a short time ä¸ä¹…ï¼›åœ¨çŸ­æ—¶é—´å†…</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*architectural*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  ar : chi : te : c : tur : alï¼ˆchiè¯»kiçš„éŸ³ï¼Œè‹± /ËŒÉ‘ËkÉªËˆtektÊƒÉ™rÉ™l/  ï¼‰<br>  adj. å»ºç­‘å­¦çš„ï¼›å»ºç­‘ä¸Šçš„ï¼›ç¬¦åˆå»ºç­‘æ³•çš„<br>  ç½‘ç»œé‡Šä¹‰ å»ºç­‘ï¼›å»ºç­‘è®¾è®¡ï¼›å»ºç­‘æè´¨ï¼›å»ºç­‘å­¦çš„<br>  architectural å»ºç­‘ï¼›å»ºç­‘è®¾è®¡ï¼›å»ºç­‘æè´¨ï¼›å»ºç­‘å­¦çš„<br>  architectural style å»ºç­‘é£æ ¼ï¼›å»ºç­‘å½¢å¼ï¼›æ¶æ„é£æ ¼<br>  Architectural acoustics å»ºç­‘å£°å­¦ï¼›å»ºç­‘éŸ³å“ï¼›æ„ç­‘å£°å­¦ï¼›å»ºç­‘éŸ³å“å­¦</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*style*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  s : ty : le  ï¼ˆ è‹± /staÉªl/ ï¼‰<br>  n. é£æ ¼ï¼›æ—¶å°šï¼›ç±»å‹ï¼›å­—ä½“<br>  vt. è®¾è®¡ï¼›ç§°å‘¼ï¼›ä½¿åˆæ½®æµ<br>  vi. è®¾è®¡å¼æ ·ï¼›ç”¨åˆ»åˆ€ä½œè£…é¥°ç”»<br>  n. (Style)äººåï¼›ï¼ˆè‹±ï¼‰æ–¯æ³°å°”<br>  è¿‡å»å¼ styledï¼›<br>  è¿‡å»åˆ†è¯ styledï¼›<br>  ç°åœ¨åˆ†è¯ stylingï¼›<br>  å¤æ•° stylesï¼›<br>  ç¬¬ä¸‰äººç§°å•æ•° stylesï¼›<br>  ç½‘ç»œé‡Šä¹‰ é£æ ¼ï¼›æ ·å¼ï¼›æ¬¾å¼ï¼›ä½œé£<br>  style é£æ ¼ï¼›æ ·å¼ï¼›æ¬¾å¼ï¼›ä½œé£<br>  Style ä½œé£<br>  Text Style å­—ä½“æ ·å¼ï¼›å­—å¸ƒå±€ï¼›æ–‡å­—æ ·å¼ï¼›æ–‡å­—å¸ƒå±€</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="number">*a</span>pproach <span class="keyword">to</span>**</span><br></pre></td></tr></table></figure><p>  a : pp : roa : ch  ï¼ˆ è‹± /É™ËˆprÉ™ÊŠtÊƒ/  ï¼‰<br>  æ¥è¿‘ï¼›çº¦ç­‰äºï¼›é€šå¾€â€¦çš„æ–¹æ³•<br>  ç½‘ç»œé‡Šä¹‰ çº¦ç­‰äºï¼›æ¥è¿‘ï¼›ç±»ä¼¼ï¼›åŠæ³•ï¼›<br>  approach to çº¦ç­‰äºï¼›æ¥è¿‘ï¼›ç±»ä¼¼ï¼›åŠæ³•<br>  approach h to criticality æ¥è¿‘ä¸´ç•Œ<br>  approach h to åšæŸäº‹çš„æ–¹æ³•ï¼›çº¦ç­‰äºï¼›æ¥è¿‘ï¼›å¯¹â€¦çš„æ€åº¦</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*developing*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  de : ve : lo : ping  ï¼ˆ è‹± /dÉªËˆvelÉ™pÉªÅ‹/  ï¼‰<br>  adj. å‘å±•ä¸­çš„ï¼›ç”Ÿé•¿çš„ï¼›å˜åŒ–çš„<br>  n. å‘å±•<br>  v. å‘å±•ï¼›æˆé•¿ï¼›äº§ç”Ÿï¼›æ„Ÿå—ï¼›ä½¿ï¼ˆæ‘„å½±èƒ¶ç‰‡ï¼‰æ˜¾å½±ï¼ˆdevelopçš„ç°åœ¨åˆ†è¯ï¼‰<br>  ç½‘ç»œé‡Šä¹‰ å‘å±•ï¼›å‘å±•ä¸­çš„ï¼›æ˜¾å½±ï¼›å¼€å‘<br>  Developing å‘å±•ï¼›å‘å±•ä¸­çš„ï¼›æ˜¾å½±ï¼›å¼€å‘<br>  developing trend å‘å±•è¶‹åŠ¿ï¼›å‘å±•èµ°å‘ï¼›è¶‹åŠ¿<br>  developing machine æ´—ç‰‡æœºï¼›æ˜¾å½±æœºï¼›å¤´å½±æœºï¼ˆè¿™ä¸ªå¤´ï¼Ÿæˆ‘æŠ„çš„æœ‰é“è¯å…¸ä¸Šçš„ï¼‰ï¼›æ˜¾è‰²æœº</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*single*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  sin : gle ï¼ˆ è‹± /ËˆsÉªÅ‹É¡l/ ï¼‰<br>  adj. å•ä¸€çš„ï¼›å•èº«çš„ï¼›å•ç¨‹çš„<br>  n. ä¸€ä¸ªï¼›å•æ‰“ï¼›å•ç¨‹ç¥¨<br>  vt. é€‰å‡º<br>  vi. å‡»å‡ºä¸€å’å®‰æ‰“<br>  è¿‡å»å¼ singled<br>  è¿‡å»åˆ†è¯ singled<br>  ç°åœ¨åˆ†è¯ singling<br>  å¤æ•° singles<br>  ç¬¬ä¸‰äººç§°å•æ•° singles<br>  ç½‘ç»œé‡Šä¹‰ æœªå©šï¼›ä¸€å’å®‰æ‰“ï¼›å•æ›²ï¼›å•ä¸€çš„ï¼›<br>  single æœªå©šï¼›ä¸€å’å®‰æ‰“ï¼›å•æ›²ï¼›å•ä¸€çš„<br>  single market ç»Ÿä¸€å¸‚åœºï¼›åŒ—äº¬å¸‚åœºï¼›å•ä¸€å¸‚åœºï¼›åŒä¸€å¸‚åœº<br>  single parent å•äº²å®¶åº­ï¼›å•äº²ï¼›å•çˆ¶ååŒï¼›å•äº²æ¯äº²</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**<span class="built_in">application</span>**</span><br></pre></td></tr></table></figure><p>  a : pp : li : ca : tion ï¼ˆ è‹± /ËŒÃ¦plÉªËˆkeÉªÊƒn/  ï¼‰<br>  n. åº”ç”¨ï¼›ç”³è¯·ï¼›åº”ç”¨ç¨‹åºï¼›æ•·ç”¨ï¼›ï¼ˆå¯¹äº‹ç‰©ã€å­¦ä¹ ç­‰ï¼‰æŠ•å…¥<br>  ç½‘ç»œé‡Šä¹‰ ç”¨é€”ï¼›åº”ç”¨è½¯ä»¶ï¼›åº”ç”¨<br>  APPLICATION ç”¨é€”ï¼›åº”ç”¨è½¯ä»¶ï¼›åº”ç”¨<br>  application fee ç”³è¯·è´¹ï¼›æŠ¥åè´¹ï¼›ç”³è¯·è´¹ç”¨ï¼›ç™»è®°è´¹<br>  patent application ä¸“åˆ©ç”³è¯·ï¼›ä¸“åˆ©ç”³è¯·ä¹¦ï¼›ä¸“åˆ©å£°è¯·ï¼›ä¸“åˆ©ç”³è¯·è¯´æ˜ä¹¦</p><p>  patent<br>  pa : ten : t  ï¼ˆè‹± /â€˜pÃ¦t(É™)nt; â€˜peÉªt(É™)nt/ï¼‰<br>  n. ä¸“åˆ©æƒï¼›ä¸“åˆ©è¯ï¼›ä¸“åˆ©å“ï¼›<br>  adj. ä¸“åˆ©çš„ï¼›ç‰¹è®¸ç”Ÿäº§æˆ–é”€å”®çš„ï¼›æ˜¾è‘—çš„ï¼›å…¬å¼€çš„ï¼›ï¼ˆè„‰ç®¡ç­‰ï¼‰å¼€æ”¾çš„<br>  v. å–å¾—â€¦çš„ä¸“åˆ©æƒï¼›æˆäºˆä¸“åˆ©<br>  å¤æ•° patents<br>  è¿‡å»å¼ patented<br>  è¿‡å»åˆ†è¯ patented<br>  ç°åœ¨åˆ†è¯ patenting<br>  ç¬¬ä¸‰äººç§°å•æ•° patents<br>  ç½‘ç»œé‡Šä¹‰ ä¸“åˆ©æƒï¼›ä¸“åˆ©ï¼›ä¸“åˆ©å“ï¼›ç§‘æŠ€ç©å…·<br>  patent ä¸“åˆ©æƒï¼›ä¸“åˆ©ï¼›ä¸“åˆ©å“ï¼›ç§‘æŠ€ç©å…·<br>  patent family ä¸“åˆ©æ—ï¼›åŒæ—ä¸“åˆ©<br>  patent attorney ä¸“åˆ©å¾‹å¸ˆï¼›ä¸“åˆ©ä»£ç†äººï¼›ç§°ä¸ºä¸“åˆ©æ³•åŠ¡äººå‘˜</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">**a suite of**</span></span><br></pre></td></tr></table></figure><p>  s : ui : teï¼ˆuiè¯»wiçš„éŸ³ï¼Œ è‹± /swiËt/ ï¼‰<br>  ä¸€ç³»åˆ—<br>  ç½‘ç»œé‡Šä¹‰ ä¸€å¥—ï¼›ä¸€æ•´ç»„ï¼›è¯¦ç»†ç¿»è¯‘ï¼ˆè¯¦ç»†ç¿»è¯‘&gt;&gt;a suite of ä¸€ç³»åˆ—ï¼›ä¸€å¥—â€¦ï¼‰<br>  a suite of ä¸€å¥—ï¼›ä¸€æ•´ç»„ï¼›è¯¦ç»†ç¿»è¯‘<br>  a suite of racks ä¸€å¥—æœºæ¶<br>  a suite of paintings ä¸€ç»„ä»ä¸åŒè§’åº¦å’Œå±‚æ¬¡åæ˜ åŒä¸€ä¸­å¿ƒæ€æƒ³å’Œé¢˜æçš„ç»˜ç”»</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*small*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  s : ma : ll  ï¼ˆ è‹± /smÉ”Ël/  ï¼‰<br>  adj. å°‘çš„ï¼Œå°çš„ï¼›å¾®å¼±çš„ï¼›å‡ ä¹æ²¡æœ‰çš„ï¼›ä¸é‡è¦çš„ï¼›å¹¼å°çš„<br>  adv. å°å°åœ°ï¼›å‘é„™åœ°<br>  n. å°ä»¶ç‰©å“ï¼›çŸ®å°çš„äºº<br>  n. ï¼ˆSmallï¼‰äººåï¼›ï¼ˆè‹±ï¼‰æ–¯è«å°”<br>  ç½‘ç»œé‡Šä¹‰ å°çš„ï¼›å°å‹çš„ï¼›å°ç ï¼›å¡ç‰‡çº¸è‹±å›½æ ‡å‡†<br>  small å°çš„ï¼›å°å‹çš„ï¼›å°ç ï¼›å¡ç‰‡çº¸è‹±å›½æ ‡å‡†<br>  small intestine å°è‚ <br>  small incision å°åˆ‡å£ï¼›éš§é“åˆ‡å£ï¼›å¾®åˆ›ï¼›å¾®å°åˆ‡å£</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*services*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  s : er : vi : ce : s  ï¼ˆ è‹± /â€˜sÉ™:visis/ ï¼‰<br>  n. æœåŠ¡ï¼›æœåŠ¡é¡¹ç›®ï¼ˆserviceå¤æ•°å½¢å¼ï¼‰<br>  v. æœåŠ¡ï¼ˆserviceçš„ç¬¬ä¸‰äººç§°å•æ•°ï¼‰<br>  ç½‘ç»œé‡Šä¹‰ æœåŠ¡ï¼›æœåŠ¡é¡¹ç›®ï¼›æœåŠ¡èŒƒå›´ï¼›æœåŠ¡ä¸š<br>  Services æœåŠ¡ï¼›æœåŠ¡é¡¹ç›®ï¼›æœåŠ¡èŒƒå›´ï¼›æœåŠ¡ä¸š<br>  Services æœåŠ¡<br>  Web Services ç½‘ç»œæœåŠ¡ï¼›WebæœåŠ¡ï¼›åº”ç”¨</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**<span class="keyword">each</span>**</span><br></pre></td></tr></table></figure><p>  ea : ch  ï¼ˆ è‹± /iËtÊƒ/  ï¼‰<br>  det. ï¼ˆä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„äººæˆ–ç‰©ä¸­ï¼‰å„è‡ª<br>  pron. ï¼ˆä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„äººæˆ–ç‰©ä¸­ï¼‰æ¯ä¸ª<br>  adv. æ¯ä¸ªåœ°<br>  adj. å„è‡ªçš„<br>  ç½‘ç»œé‡Šä¹‰ æ¯ä¸ªï¼›å„è‡ªï¼›æ¯æ¬¡ï¼›æ¯ä¸€<br>  Each æ¯ä¸ªï¼›å„è‡ªï¼›æ¯æ¬¡ï¼›æ¯ä¸€<br>  each other äº’ç›¸ï¼›å½¼æ­¤ï¼›ç›¸äº’ï¼›å–é•¿è¡¥çŸ­<br>  Each line æ¯è¡Œ</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**<span class="built_in">running</span>**</span><br></pre></td></tr></table></figure><p>  run : ning  ï¼ˆ è‹± /ËˆrÊŒnÉªÅ‹/  ï¼‰<br>  n. è¿è½¬ï¼›èµ›è·‘ï¼›æµå‡º<br>  adj. è¿ç»­çš„ï¼›æµåŠ¨çš„ï¼›è·‘è€…çš„ï¼Œè¿è½¬ç€çš„<br>  v. è·‘ï¼›è¿è½¬ï¼ˆrunçš„ingå½¢å¼ï¼‰ï¼›è¡Œé©¶<br>  n. (Running)äººåï¼›ï¼ˆè‹±ï¼‰æœ—å®<br>  ç½‘ç»œé‡Šä¹‰ è·‘æ­¥ï¼›è·‘ï¼›ç£¨åˆï¼›è¿è¡Œ<br>  running è·‘æ­¥ï¼›è·‘ï¼›ç£¨åˆï¼›è¿è¡Œ<br>  Running Man è¿‡å…³æ–©å°†ï¼›å¥”è·‘å§å…„å¼Ÿï¼›è½è·‘è€çˆ¸ï¼›å¥”è·‘çš„ç”·äºº<br>  running shoes è·‘æ­¥é‹ï¼›æ…¢è·‘é‹ï¼›ç«èµ°é‹</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*own*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  o : wn ï¼ˆ è‹± /É™ÊŠn/  ï¼‰<br>  vt. æ‹¥æœ‰ï¼›æ‰¿è®¤<br>  vi. æ‰¿è®¤<br>  adj. è‡ªå·±çš„ï¼›ç‰¹æœ‰çš„<br>  n. è‡ªå·±çš„<br>  n.ï¼ˆOwnï¼‰äººåï¼›ï¼ˆé˜¿æ‹‰ä¼¯ï¼‰å¥¥æ©ï¼ˆæˆ‘å°±æœè¿™äº›äººåï¼Œä¸ä¼šè¯»æ˜¯å§ï¼Œè¯»è¿™ä¸ªä¸­æ–‡å¼è¯‘éŸ³äººåå°±ä¼šè¯»äº†ï¼‰</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**<span class="built_in">process</span>**</span><br></pre></td></tr></table></figure><p>  p : ro : ce : ss  (  è‹± /prÉ™Ëˆses; (for n.) ËˆprÉ™ÊŠses/ )<br>  n. ï¼ˆä¸ºè¾¾åˆ°æŸä¸€ç›®æ ‡çš„ï¼‰è¿‡ç¨‹ï¼›ï¼ˆè‡ªç„¶å˜åŒ–çš„ï¼‰å·¥ç¨‹ï¼›å·¥è‰ºæµç¨‹ï¼›è¯‰è®¼ç¨‹åºï¼›ä¼ ç¥¨ï¼›çªèµ·ï¼›è¿›å±•ï¼›ï¼ˆå‘å‹ï¼‰ç›´å‘å¼<br>  v. åŠ å·¥ï¼›å®¡æ ¸ï¼›å¤„ç†ï¼ˆæ•°æ®ï¼‰ï¼›é˜Ÿåˆ—è¡Œè¿›ï¼›å†²å°ï¼ˆç…§ç‰‡ï¼‰ï¼›æŠŠï¼ˆå¤´å‘ï¼‰å¼„æˆç›´å‘<br>  adj. ç»è¿‡ç‰¹æ®ŠåŠ å·¥çš„ï¼›ç…§ç›¸æ¿çš„ï¼›æŸ“å°æ³•çš„<br>  ç¬¬ä¸‰äººç§°å•æ•° processes<br>  è¿‡å»å¼ processed<br>  è¿‡å»åˆ†è¯ processed<br>  ç°åœ¨åˆ†è¯ processing<br>  å¤æ•° processes<br>  ç½‘ç»œé‡Šä¹‰ è¿›ç¨‹ï¼›æµç¨‹ï¼›è¿‡ç¨‹<br>  process è¿›ç¨‹ï¼›æµç¨‹ï¼›è¿‡ç¨‹<br>  Process Management è¿›ç¨‹ç®¡ç†ï¼›è¿‡ç¨‹ç®¡ç†ï¼›æµç¨‹ç®¡ç†ï¼›è¿›ç¨‹ç®¡ç†<br>  Background Process åå°è¿›ç¨‹ï¼›èƒŒæ™¯ç¨‹åºï¼›èƒŒæ™¯å¤„ç†ç¨‹åº</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*communicating*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  com : mu : ni : ca : ting ( è‹± /kÉ™â€™mjÊŠnÉ™,keÉªtÉªÅ‹/ )<br>  adj. ï¼ˆæˆ¿é—´ï¼‰ç›¸åŒçš„ï¼Œç›¸è¿çš„<br>  v. äº¤æµï¼›ä¼ é€’ï¼›ä¼ æ’­ï¼ˆcommunicateçš„ç°åœ¨åˆ†è¯ï¼‰<br>  ç½‘ç»œé‡Šä¹‰ æ²Ÿé€šï¼›äº¤æµï¼›é€šä¿¡çš„äº’é€šçš„ï¼›äº¤æµä¸é€šè®¯<br>  Communicating æ²Ÿé€šï¼›äº¤æµï¼›é€šä¿¡çš„äº’é€šçš„ï¼›äº¤æµä¸é€šè®¯<br>  communicating vessels è¿é€šå™¨ï¼›è¿é€šç®¡<br>  Communicating junctions é€šè®¯è¿æ¥</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*lightweight*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  li : ght : wei : ght ( è‹± /ËˆlaÉªtweÉªt/ )<br>  n. è½»é‡çº§ï¼ˆæ‹³å‡»æ‰‹ï¼‰ï¼›æ¯”é€šå¸¸é‡é‡è½»çš„äººæˆ–ä¸œè¥¿ï¼›æ— è¶³è½»é‡çš„äººï¼ˆæˆ–äº‹ï¼‰<br>  adj. è½»é‡çš„ï¼›ç»™äººå°è±¡ä¸æ·±çš„ï¼›æ— è¶³è½»é‡çš„ï¼›æ¯”é€šå¸¸é‡é‡è½»çš„ï¼›æµ…è–„çš„ï¼›<br>  ç½‘ç»œé‡Šä¹‰ è½»é‡çº§ï¼›è½»èº«çš„ï¼›è½»é‡ï¼›è½»é‡åŒ–ï¼›<br>  lightweight è½»é‡çº§ï¼›è½»èº«çš„ï¼›è½»é‡ï¼›è½»é‡åŒ–<br>  lightweight è½»å¡«æ–™ï¼›è½»è´¨æ€å’Œæ–™<br>  lightweight cover è½»å‹ä¸Šç›–ï¼›é¿é›·ä¿æŠ¤</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*mechanisms*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  me : cha : ni : sm : sï¼ˆcha è¯» ke çš„éŸ³ï¼Œè‹± /â€˜mekÉ™nÉªzÉ™mz/ ï¼‰<br>  n. æœºåˆ¶ï¼›[è®¡]æœºæ„ï¼ˆmechanismçš„å¤æ•°ï¼‰ï¼›æœºæ¢°ï¼›[æœº]æœºæ„å­¦<br>  ç½‘ç»œé‡Šä¹‰ å‘ç—…æœºåˆ¶ï¼›å‘ç”Ÿæœºåˆ¶ï¼›æœºåˆ¶ï¼›æœºæ„<br>  Mechanisms å‘ç—…æœºåˆ¶ï¼›å‘ç”Ÿæœºåˆ¶ï¼›æœºåˆ¶ï¼›æœºæ„<br>  interaction mechanisms äº’åŠ¨æœºåˆ¶ï¼›ä½œç”¨æœºåˆ¶<br>  resistant mechanisms è€è¯æœºåˆ¶ï¼›æŠ—ç—…æœºåˆ¶</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*often*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  o : f : ten ( è‹± /ËˆÉ’fn; ËˆÉ’ftÉ™n/  )<br>  adv. å¸¸å¸¸ï¼›æ—¶å¸¸ï¼›å¾€å¾€ï¼Œå¤§å¤š<br>  æ¯”è¾ƒçº§ more often æˆ– oftenerï¼›<br>  æœ€é«˜çº§ most often æˆ– oftenest<br>  ç½‘ç»œé‡Šä¹‰ ç»å¸¸ï¼›å¸¸å¸¸ï¼›æ—¶å¸¸ï¼›å¸¸æœ‰<br>  Often è¿›åœºï¼›å¸¸å¸¸ï¼›æ—¶å¸¸ï¼›å¸¸æœ‰<br>  more often æ›´ç»å¸¸ï¼›ç»å¸¸ï¼›æ›´å¤šçš„æ—¶å€™ï¼›æ›´å¤š<br>  OFT OFTen å¸¸å¸¸ï¼›å†ä¸‰</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*HTTP*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  H : T : T : P ( è‹± /ËŒeÉªtÊƒ tiË tiË ËˆpiË/  )<br>  abbr. è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼ˆHyper Text Transfer Protocolï¼‰<br>  ç½‘ç»œé‡Šä¹‰ è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼ˆHyper Text Transfer Protocolï¼‰ï¼›ç½‘ç«™ï¼›å¹³å°ï¼›è¶…æ–‡æœ¬ä¼ é€åè®®</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*resource*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  re : sou : r : ce ( è‹± /rÉªËˆsÉ”Ës; rÉªËˆzÉ”Ës/  )<br>  n. èµ„æºï¼Œè´¢åŠ›ï¼›åŠæ³•ï¼›æ™ºè°‹<br>  vi. å‘â€¦æä¾›èµ„é‡‘<br>  ç½‘ç»œé‡Šä¹‰ èµ„æºï¼›èµ„æºç±»å‹ï¼›è´¢åŠ›ï¼›åŠæ³•<br>  Resource èµ„æºï¼›èµ„æºç±»å‹ï¼›è´¢åŠ›ï¼›åŠæ³•<br>  human resource äººåŠ›èµ„æºï¼›æ¿€åŠ±ï¼›äººäº‹éƒ¨<br>  computational resource è®¡ç®—èµ„æº</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*API*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  A : P : I ( /ËŒeÉª piË ËˆaÉª/  )<br>  abbr. ç©ºæ°”æ±¡æŸ“æŒ‡æ•°ï¼ˆAir Pollution Indexï¼‰ï¼›åº”ç”¨ç¨‹åºç•Œé¢ï¼ˆApplication Program Interfaceï¼‰ï¼›ç²¾ç¡®ä½ç½®æŒ‡ç¤ºå™¨ï¼ˆAccurate Position Indicatorï¼‰ï¼›ç¾å›½çŸ³æ²¹å­¦ä¼šï¼ˆAmerican Petroleum Instituteï¼‰ï¼›è‡ªåŠ¨å‘éŸ³æ•™å­¦æœºï¼ˆAutomated Pronunciation Instructorï¼‰<br>  ç½‘ç»œé‡Šä¹‰ ç¾å›½çŸ³æ²¹åä¼šï¼›åº”ç”¨ç¨‹åºæ¥å£ï¼›ç¾å›½çŸ³æ²¹å­¦ä¼šï¼›åº”ç”¨ç¼–ç¨‹æ¥å£<br>  API ç¾å›½çŸ³æ²¹åä¼šï¼›åº”ç”¨ç¨‹åºæ¥å£ï¼›ç¾å›½çŸ³æ²¹å­¦ä¼šï¼›åº”ç”¨ç¼–ç¨‹æ¥å£<br>  Windows API ä½¿ç”¨ï¼›è°ƒç”¨ï¼›å…³äºè¿›ç¨‹æ“ä½œçš„ï¼›å…³äºçº¿ç¨‹æ“ä½œçš„<br>  Google API è°·æ­Œåº”ç”¨ç•Œé¢ï¼›åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ï¼›ç½‘å€äºŒç»´ç ç”Ÿæˆå‡½æ•°ï¼›åº”ç”¨ç¨‹åºæ¥å£</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*these*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  th : e : se ( è‹± /Ã°iËz/  )<br>  det. è¿™äº›ï¼ˆthisçš„å¤æ•°ï¼‰<br>  pron. è¿™äº›ï¼ˆthisçš„å¤æ•°ï¼‰<br>  adj. è¿™äº›çš„ï¼ˆthisçš„å¤æ•°ï¼‰<br>  ç½‘ç»œé‡Šä¹‰ è¿™äº›ï¼Œæ­¤ç­‰ï¼›å¤æ•°ï¼›è¿™äº›ä¸ª<br>  These è¿™äº›ï¼›æ­¤ç­‰ï¼›å¤æ•°ï¼›è¿™äº›ä¸ª<br>  Know these çŸ¥å…¶ç„¶ï¼›åˆ°çŸ¥å…¶ç„¶<br>  These payments è¥å…»è´¹</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*built*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  bu : il : t ( è‹± /bÉªlt/ )<br>  v. å»ºé€ ï¼Œå»ºç«‹ï¼›é€æ­¥å¢å¼ºï¼›æŠŠâ€¦åµŒå…¥ï¼ˆå¢™å£ã€ç‰©ä½“ç­‰ï¼‰ï¼ˆbuildçš„è¿‡å»å¼å’Œè¿‡å»åˆ†è¯ï¼‰<br>  adj. æœ‰â€¦ä½“æ ¼çš„ï¼›èº«æ®µä¼˜ç¾çš„ï¼›â€¦.å»ºæˆçš„<br>  ç½‘ç»œé‡Šä¹‰ å»ºèµ·ï¼›æ¯”ä¼˜ä¸½ï¼›å»ºæœ‰ï¼›å»ºå¥½<br>  Built å»ºèµ·ï¼›æ¯”ä¼˜ä¸½ï¼›å»ºæœ‰ï¼›å»ºå¥½<br>  Built NY æ¯”ä¼˜ä¸½<br>  BLT Built å»ºé€ ï¼›åˆ¶ä½œ<br>  built in å®‰è£…åœ¨é‡Œé¢çš„ï¼›è£…å…¥çš„ï¼›æœºå†…çš„<br>  built up ç»„åˆ<br>  built on ä»¥â€¦ä½œåŸºç¡€</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**<span class="keyword">around</span>**</span><br></pre></td></tr></table></figure><p>  a : roun : d ( è‹± /É™ËˆraÊŠnd/  )<br>  adv. åœ¨å››å‘¨ï¼›æœå¯¹ç«‹é¢ï¼›åˆ°å¤„ï¼›æ¼«æ— ç›®çš„çš„ï¼›åœ¨é™„è¿‘ï¼›å¤§çº¦ï¼›å›´ç»•ï¼›ä»¥åœ†å‘¨è®¡ç®—ï¼›ç°æœ‰ï¼›è½¬å¼¯<br>  prep. å›´ç»•ï¼›åœ¨é‚£è¾¹ï¼›ç»•ç€ï¼›åŒâ€¦ä¸€è‡´ï¼›åˆ°å¤„ï¼›ä»¥ï¼ˆå·²æåŠç‰©ï¼‰ä¸ºä¸­å¿ƒï¼›è¿‚å›<br>  ç½‘ç»œé‡Šä¹‰ å›´ç»•ï¼›å››å¤„ï¼›åœ¨å‘¨å›´ï¼›å¤§çº¦<br>  Around å›´ç»•ï¼›å››å¤„ï¼›åœ¨å‘¨å›´ï¼›å¤§çº¦ï¼›<br>  come around è‹é†’ï¼›é¡ºä¾¿æ¥è®¿ï¼›æ¥è®¿ï¼›å¤åŸ<br>  stick around åœ¨é™„è¿‘é€—ç•™æˆ–ç­‰å¾…ï¼›åœ¨é™„è¿‘ç­‰ç€ï¼›åœ¨é‚»è¿‘å‹¾ç•™æˆ–ç­‰å€™ï¼›é€—ç•™<br>  all round å‘¨å›´ï¼›åˆ°å¤„ï¼Œå››å¤„<br>  around here é™„è¿‘ï¼›åœ¨è¿™å‘¨å›´<br>  go around å››å¤„èµ°åŠ¨ï¼›ä¾›åº”ï¼›ï¼ˆæ¶ˆæ¯ï¼‰æµä¼ </p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*business*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  bu : si : ne : ss ( è‹± /ËˆbÉªznÉ™s/ )<br>  n. å•†ä¸šï¼Œäº¤æ˜“ï¼›ç”Ÿæ„ï¼›äº‹åŠ¡ï¼Œä¸šåŠ¡ï¼›èŒä¸šï¼Œè¡Œä¸šï¼›<br>  ç½‘ç»œé‡Šä¹‰ å•†ä¸šï¼›ç”Ÿæ„ï¼›ä¼ä¸šï¼›ä¸šåŠ¡<br>  Business å•†ä¸šï¼›ç”Ÿæ„ï¼›ä¼ä¸šï¼›ä¸šåŠ¡<br>  Business ä¸šåŠ¡<br>  business cycle å•†ä¸šå‘¨æœŸï¼›ç»æµå‘¨æœŸï¼›å•†ä¸šå‘¨æœŸï¼›æ™¯æ°”å¾ªç¯<br>  business card åç‰‡ï¼›å•†åŠ¡åç‰‡<br>  in business ç»å•†ï¼›åœ¨ç»è¥ï¼›åœ¨å•†ç•Œ<br>  business philosophy ç»è¥ç†å¿µï¼Œç»è¥å“²å­¦</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*capabilities*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  ca : pa : bi : li : ti : es ( è‹± /ËŒkeÉªpÉ™ËˆbÉªlÉ™tÉªs/  )<br>  n. èƒ½åŠ›ï¼ˆcapabilityçš„å¤æ•°ï¼‰ï¼›åŠŸèƒ½ï¼›æ€§èƒ½<br>  ç½‘ç»œé‡Šä¹‰ èƒ½åŠ›ï¼›åŠŸèƒ½ï¼›æƒé™ï¼›è´£ä»»<br>  capabilities èƒ½åŠ›ï¼›åŠŸèƒ½ï¼›æƒé™ï¼›è´£ä»»<br>  economic capabilities ç»æµå®åŠ›ï¼›ç»æµèƒ½åŠ›<br>  defense capabilities é˜²å«ä½œæˆ˜èƒ½åŠ›ï¼›é˜²åŠ¡èƒ½åŠ›ï¼›é˜²å«åŠŸèƒ½ï¼›<br>  process capability åŠ å·¥èƒ½åŠ›ï¼›å·¥åºèƒ½åŠ›<br>  design capability è®¾è®¡èƒ½åŠ›</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*independently*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  in : de : pen : den : t : ly ( è‹± /ËŒÉªndÉªËˆpendÉ™ntli/  )<br>  adv. ç‹¬ç«‹åœ°ï¼›è‡ªç«‹åœ°<br>  ç½‘ç»œé‡Šä¹‰ å„è‡ªåœ°ï¼›ç‹¬ç«‹åœ°ï¼›ç‹¬è‡ªåœ°ï¼›è‡ªç«‹åœ°<br>  independently å„è‡ªåœ°ï¼›ç‹¬ç«‹åœ°ï¼›ç‹¬è‡ªåœ°ï¼›è‡ªç«‹åœ°<br>  think independently ç‹¬ç«‹æ€è€ƒï¼›ç‹¬ç«‹çš„æ€è€ƒ<br>  living independently ç‹¬ç«‹ç”Ÿæ´»<br>  independently of ç‹¬ç«‹äºâ€¦ä¹‹å¤–ï¼›ä¸â€¦æ— å…³</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*deployable*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  de : p : lo : y : a : ble<br>  adj. å¯å¼€å±•çš„<br>  ç½‘ç»œé‡Šä¹‰ å¯å¼€å±•çš„ï¼›æ•£æ’­æ€§<br>  deployable å¯å¼€å±•æ€§çš„ï¼›æ•£æ’­æ€§<br>  Deployable Structures æŠ˜å ç»“æ„ï¼›å¯å±•ç»“æ„<br>  deployable joint è¿åŠ¨å…³èŠ‚</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*fully*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  fu : lly ( è‹± /ËˆfÊŠli/  )<br>  adv. å……åˆ†åœ°ï¼›å®Œå…¨åœ°ï¼›å½»åº•åœ°<br>  n. (Fully)äººåï¼›ï¼ˆæ³•ï¼‰è²åˆ©<br>  ç½‘ç»œé‡Šä¹‰ å®Œå…¨åœ°ï¼›å½»åº•åœ°ï¼›å……åˆ†åœ°ï¼›ååˆ†åœ°<br>  fully å®Œå…¨åœ°ï¼›å½»åº•åœ°ï¼›å……åˆ†åœ°ï¼›ååˆ†åœ°<br>  FULLY OPENING å…¨å¼€å£ï¼›å…¨å¯é½¿ï¼›é½é—­å£<br>  fully  secured è¶³é¢æ‹…ä¿ï¼›å…¨é¢æ‹…ä¿<br>  fully automatic å…¨è‡ªåŠ¨çš„<br>  fully integrated å®Œå…¨æ•´åˆ<br>  fully loaded æ»¡è½½</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**<span class="built_in">auto</span>mated**</span><br></pre></td></tr></table></figure><p>  au : to : ma : te : d ( è‹± /ËˆÉ”ËtÉ™ËŒmeÉªtÉªd/  )<br>  adj. è‡ªåŠ¨åŒ–çš„ï¼›æœºæ¢°åŒ–çš„<br>  v. è‡ªåŠ¨åŒ–ï¼ˆautomateçš„è¿‡å»åˆ†è¯ï¼‰ï¼›è‡ªåŠ¨æ“ä½œ<br>  ç½‘ç»œé‡Šä¹‰ è‡ªåŠ¨åŒ–çš„ï¼›è‡ªåŠ¨çš„ï¼›æœºæ¢°åŒ–çš„ï¼›è‡ªåŠ¨åŒ–<br>  automated è‡ªåŠ¨åŒ–çš„ï¼›è‡ªåŠ¨çš„ï¼›æœºæ¢°åŒ–çš„ï¼›è‡ªåŠ¨åŒ–<br>  automated design è‡ªåŠ¨è®¾è®¡ï¼›è‡ªåŠ¨åŒ–è®¾è®¡ï¼›è‡ªåŠ¨æƒ³è±¡<br>  Automated inspection è‡ªåŠ¨åŒ–æ£€éªŒï¼›è‡ªåŠ¨æ£€éªŒ<br>  automated machine è‡ªåŠ¨åŒ–æœºæ¢°ï¼›è‡ªåŠ¨åŒ–çš„æœºå™¨<br>  automated teller machine è‡ªåŠ¨æŸœå‘˜æœº<br>  automated welding è‡ªåŠ¨ç„Šæ¥</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*deployment*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  de : p : lo : y : men : t ( è‹± /dÉªËˆplÉ”ÉªmÉ™nt/ )<br>  n. è°ƒåº¦ï¼Œéƒ¨ç½²<br>  å¤æ•° deployments<br>  ç½‘ç»œé‡Šä¹‰ éƒ¨ç½²ï¼›å±•å¼€ï¼›å‘å¸ƒï¼›å¸ƒé˜²<br>  Deployment éƒ¨ç½²ï¼Œå±•å¼€ï¼›å‘å¸ƒï¼›å¸ƒé˜²<br>  Deployment Editors éƒ¨ç½²ç¼–è¾‘å™¨ï¼›å®‰æ’ç¼–çº‚å™¨<br>  Resources deployment èµ„æºé…ç½®<br>  disposition n.è°ƒåº¦ï¼Œéƒ¨ç½²</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*machinery*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  ma  chi : ne : ry ( è‹± /mÉ™ËˆÊƒiËnÉ™ri/  )<br>  n. æœºæ¢°ï¼›æœºå™¨ï¼›æœºæ„ï¼›æœºæ¢°è£…ç½®<br>  ç½‘ç»œé‡Šä¹‰ æœºæ¢°ï¼›æœºå™¨ï¼›æœºå…·<br>  machinery æœºæ¢°ï¼›æœºå™¨ï¼›æœºå…·<br>  packaging machinery åŒ…è£…æœºæ¢°ï¼›åŒ…è£…è®¾å¤‡ï¼›åŒ…è£…æœºå™¨ï¼›æ”¾å¤§å™¨<br>  Electrical Machinery ç”µæœºå­¦ï¼›ç”µåŠ›æœºæ¢°ï¼›ç”µæœºï¼›ç”µæœºé©±åŠ¨<br>  machinery and equipment æœºå™¨åŠè®¾å¤‡<br>  construction machinery å»ºç­‘æœºæ¢°ï¼›æ–½å·¥æœºæ¢°<br>  agricultural machinery å†œä¸šæœºæ¢°</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*there*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  the : re ( è‹± /Ã°eÉ™(r)/  )<br>  adv. åœ¨é‚£é‡Œï¼›åœ¨é‚£è¾¹ï¼›åœ¨é‚£ç‚¹ä¸Šï¼›<br>  int. ä½ ç§<br>  n. é‚£ä¸ªåœ°æ–¹<br>  ç½‘ç»œé‡Šä¹‰ é‚£é‡Œï¼›åœ¨é‚£é‡Œï¼›é‚£å„¿ï¼›é‚£<br>  There é‚£é‡Œï¼›åœ¨é‚£é‡Œï¼›é‚£å„¿ï¼›é‚£<br>  Always There æ°¸é©»ï¼›å®ˆå€™ä¸€ç”Ÿï¼›åˆ°çº¦å®šçš„é‚£æ—¶ï¼›æ€»åœ¨æˆ‘èº«æ—<br>  There be å¥å‹ï¼›çš„å¥å­ç»“æ„ï¼›å­˜åœ¨å¥ï¼›ç»“æ„<br>  out there åˆ°æˆ˜åœºï¼›åœ¨é‚£é‡Œ<br>  over there adv. åœ¨é‚£é‡Œ<br>  go there å»é‚£é‡Œ</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*bare*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  b : are ( è‹± /beÉ™(r)/ )<br>  adj. ç©ºçš„ï¼›èµ¤è£¸çš„ï¼›æ— é®è”½çš„<br>  vt. éœ²å‡ºï¼›ä½¿èµ¤è£¸<br>  n. (Bare)äººåï¼›ï¼ˆè‹±ï¼‰è´å°”<br>  æ¯”è¾ƒçº§ barer<br>  æœ€é«˜çº§ barest<br>  è¿‡å»å¼ bared<br>  è¿‡å»åˆ†è¯ bared<br>  ç°åœ¨åˆ†è¯ baring<br>  ç½‘ç»œé‡Šä¹‰ èµ¤è£¸çš„ï¼›å…‰å…‰ï¼›èµ¤è£¸ï¼›ä»…ä»…çš„<br>  bare èµ¤è£¸çš„ï¼›å…‰å…‰ï¼›è£¸éœ²ï¼›ä»…ä»…çš„<br>  bare mass è£¸è´¨é‡<br>  bare machine è£¸æœºï¼›ç¡¬ä»¶è®¡ç®—æœºï¼›è£¸æœº<br>  bare of vt. å‡ ä¹æ²¡æœ‰ï¼Œç¼ºä¹<br>  lay bare æ­å‘ï¼Œæš´éœ²ï¼›å…¬å¼€<br>  bare feet èµ¤è„šï¼›å…‰è„šï¼›å…‰ç€è„š</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*minimum*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  mi : ni : mum ( è‹± /ËˆmÉªnÉªmÉ™m/ )<br>  n. æœ€å°å€¼ï¼›æœ€ä½é™åº¦ï¼›æœ€å°åŒ–ï¼›æœ€å°é‡<br>  adj.æœ€å°çš„ï¼›æœ€ä½çš„<br>  å¤æ•° minimums æˆ– minima<br>  ç½‘ç»œé‡Šä¹‰ æœ€å°çš„ï¼›æœ€ä½ï¼›èµ·ç ï¼›æœ€å°é‡<br>  minimum æœ€å°çš„ï¼›æœ€ä½ï¼›èµ·ç ï¼›æœ€å°é‡<br>  minimum charge æœ€ä½è´¹ç”¨ï¼›æœ€ä½è¿è´¹ï¼›æœ€ä½æ”¶è´¹<br>  minimum balance æœ€å°åº“å­˜ä½™é‡ï¼›æœ€ä½ä½™é¢ï¼›å­˜æ¬¾é™åˆ¶ï¼›æŠŠè´¹ç”¨å‡åˆ°æœ€ä½é™åº¦</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**<span class="keyword">bare </span>minimum of**</span><br></pre></td></tr></table></figure><p>  æœ€ä½é™åº¦çš„<br>  ç½‘ç»œé‡Šä¹‰ Bare Minimum Of Expense æœ€ä½æ”¯å‡º</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*centralized*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  cen : tra : li : ze : d ( è‹± /â€˜sentrÉ™laÉªzd/  )<br>  adj. é›†ä¸­çš„ï¼›ä¸­å¤®é›†æƒçš„<br>  v. é›†ä¸­ï¼ˆcentralizeçš„è¿‡å»åˆ†è¯ï¼‰<br>  ç½‘ç»œé‡Šä¹‰ é›†ä¸­çš„ï¼Œä¸­å¤®é›†æƒçš„ï¼›ä¸€è‡´<br>  Centralized é›†ä¸­çš„ï¼›ä¸­å¤®é›†æƒçš„ï¼›ä¸€è‡´<br>  centralized control é›†ä¸­æ§åˆ¶ï¼›ä¸­å¤®æ§åˆ¶ï¼›é›†ä¸­æ§åˆ¶æ–¹å¼ï¼›ä¸­å¿ƒæ§åˆ¶<br>  Centralized Monitoring é›†ä¸­ç›‘æ§ï¼›ä¸­åŒ–ç›‘æŸ¥<br>  centralized management é›†ä¸­å¼ç®¡ç†ï¼›é›†æƒç®¡ç†<br>  centralized control é›†ä¸­æ§åˆ¶<br>  centralized processing é›†ä¸­å¼å¤„ç†</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*management*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  ma : na : ge : men : t ( è‹± /ËˆmÃ¦nÉªdÊ’mÉ™nt/  )<br>  n. ç®¡ç†ï¼›ç®¡ç†äººå‘˜ï¼›ç®¡ç†éƒ¨é—¨ï¼›æ“çºµï¼›ç»è¥æ‰‹æ®µ<br>  å¤æ•° managements<br>  ç½‘ç»œé‡Šä¹‰ ç®¡ç†ï¼›ç»è¥ï¼›ç®¡ç†å­¦ï¼›ç®¡ç†å±‚ï¼›<br>  Management ç®¡ç†ï¼›ç»è¥ï¼›ç®¡ç†å­¦ï¼›ç®¡ç†å±‚<br>  Management Accounting ç®¡ç†ä¼šè®¡ï¼›ç®¡ç†ä¼šè®¡å­¦ï¼›æ²»ç†ä¼šè®¡ï¼›ä¼šè®¡ç®¡ç†<br>  performance management ç»©æ•ˆç®¡ç†ï¼›ä¸šç»©ç®¡ç†ï¼›æ€§èƒ½ç®¡ç†<br>  management system ç®¡ç†ç³»ç»Ÿï¼›ç»è¥è´£ä»»åˆ¶<br>  quality management è´¨é‡ç®¡ç†<br>  project management é¡¹ç›®ç®¡ç†ï¼›ä¸“æ¡ˆç®¡ç†</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*written*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  wri : tten ( è‹± /ËˆrÉªtn/  )<br>  adj. ä¹¦é¢çš„ï¼Œæˆæ–‡çš„ï¼Œæ–‡å­—çš„<br>  v. å†™ï¼ˆwritençš„è¿‡å»åˆ†è¯ï¼‰<br>  ç½‘ç»œé‡Šä¹‰ å†™æˆï¼›å†™ç»™ï¼›ä¹¦é¢ï¼›æˆæ–‡<br>  Written å†™æˆï¼›å†™ç»™ï¼›ä¹¦é¢ï¼›æˆæ–‡<br>  written English ä¹¦é¢è‹±è¯­ï¼›ä¹¦é¢è¯­ï¼›ä¹¦é¢è¡¨è¾¾ï¼›è‹±è¯­ä¹¦é¢è¯­<br>  written notice ä¹¦é¢é€šçŸ¥ï¼›é¢é€šçŸ¥ï¼›ä¹¦é¢é€šçŸ¥<br>  written by ç”±â€¦æ‰€å†™<br>  written english ä¹¦é¢è‹±è¯­<br>  written consent ä¹¦é¢åŒæ„ï¼›åŒæ„ä¹¦</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*different*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  di : ffe : ren : t ( è‹± /ËˆdÉªfrÉ™nt/  )<br>  adj. ä¸åŒçš„ï¼›ä¸ªåˆ«çš„ï¼›ä¸ä¼—ä¸åŒçš„<br>  ç½‘ç»œé‡Šä¹‰ ä¸åŒï¼›å·®å¼‚ï¼›ä¸¤æ ·<br>  Different ä¸åŒï¼›å·®å¼‚ï¼›ä¸¤æ ·<br>  different from ä¸åŒäºï¼›ä¸¤å›äº‹ï¼›ä¸åŒï¼›åŒºåˆ«äº<br>  Different Seasons å››å­£å¥‡è°­ï¼›ä¸åŒçš„å­£èŠ‚ï¼›è‚–ç”³å…‹çš„æ•‘èµï¼›ä¸åŒå­£èŠ‚<br>  different from ä¸â€¦ä¸åŒï¼Œä¸åŒäº<br>  different kinds ä¸åŒçš„ç§ç±»<br>  in different ways ä»¥ä¸åŒæ–¹å¼ï¼›ç”¨ä¸åŒæ–¹æ³•ï¼›é€šè¿‡ä¸åŒçš„æ–¹å¼</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*programming*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  pro : g : ram : ming ( è‹± /ËˆprÉ™ÊŠÉ¡rÃ¦mÉªÅ‹/  )<br>  n. è®¾è®¡ï¼›è§„åˆ’ï¼›ç¼–åˆ¶ç¨‹åºï¼›[è®¡]ç¨‹åºç¼–åˆ¶<br>  ç½‘ç»œé‡Šä¹‰ ç¼–ç¨‹ï¼›ç¨‹åºè®¾è®¡ï¼›ç¼–ç¨‹ï¼›ç¨‹åºç¼–åˆ¶<br>  programming ç¼–ç¨‹ï¼›ç¨‹åºè®¾è®¡ï¼›ç¼–ç¨‹ï¼›ç¨‹åºç¼–åˆ¶<br>  Linear Programming çº¿æ€§è§„åˆ’ï¼›ç¬¬äºŒåä¹ç« ï¼›çº¿æ€§ç¨‹åºç¼–åˆ¶ï¼›çº¿æ€§è§„åˆ’æ³•<br>  generic programming æ³›å‹ï¼›æ³›å‹ç¼–ç¨‹ï¼›ç¨‹åºè®¾è®¡ï¼›ç±»å±ç¼–ç¨‹<br>  linear programming n. çº¿æ€§è§„åˆ’<br>  programming language ç¼–ç¨‹è¯­è¨€ï¼›ç¨‹åºè®¾è®¡è¯­è¨€<br>  dynamic programming åŠ¨æ€è§„åˆ’ï¼›åŠ¨æ€ç¨‹åºè®¾è®¡</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*languages*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  lan : g : ua : ge : s ( ç¾ /â€˜lÃ¦Å‹gwÉªdÊ’/ )<br>  n. è¯­ç³»ï¼Œè¯­ç§ï¼›è¯­è¨€æ–‡å­—ï¼ˆlanguageå¤æ•°ï¼‰<br>  ç½‘ç»œé‡Šä¹‰ è¯­æ–‡ï¼›è¯­è¨€ï¼›è¯­è¨€èƒ½åŠ›ï¼›è¯­è¨€å­¦<br>  Languages è¯­æ–‡ï¼›è¯­è¨€ï¼›è¯­è¨€èƒ½åŠ›ï¼›è¯­è¨€å­¦<br>  altaic languages é˜¿å°”æ³°è¯­ç³»ï¼›é˜¿å°”æ³°è¯­è¨€<br>  Uralic languages ä¹Œæ‹‰å°”è¯­ç³»<br>  modern languages ç°ä»£è¯­è¨€ï¼ˆmodern languageçš„å¤æ•°ï¼‰<br>  foreign languages school å¤–è¯­å­¦æ ¡<br>  romance languages ç½—æ›¼æ–¯è¯­ï¼ˆç”±æ‹‰ä¸è¯­æ¼”å˜è€Œæˆçš„è¯­è¨€ï¼‰</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**<span class="keyword">use</span>**</span><br></pre></td></tr></table></figure><p>  u : se ( è‹± /juËz/  )<br>  n. ä½¿ç”¨ï¼›ç”¨é€”ï¼›å‘æŒ¥<br>  vt. åˆ©ç”¨ï¼›è€—è´¹<br>  vi. ä½¿ç”¨ï¼Œè¿ç”¨<br>  n.(Use)äººåï¼›ï¼ˆå¾·ï¼‰ä¹Œæ³½<br>  è¿‡å»å¼ used<br>  è¿‡å»åˆ†è¯ used<br>  ç°åœ¨åˆ†è¯ using<br>  å¤æ•° uses<br>  ç¬¬ä¸‰äººç§°å•æ•° using<br>  ç½‘ç»œé‡Šä¹‰ ä½¿ç”¨ï¼›ç”¨é€”ï¼›åˆ©ç”¨ï¼›åº”ç”¨<br>  use ä½¿ç”¨ï¼›ç”¨é€”ï¼›åˆ©ç”¨ï¼›åº”ç”¨<br>  use up ç”¨å®Œï¼›ç”¨å…‰ï¼›è€—å°½<br>  Use Case ç”¨ä¾‹ï¼›ç”¨ä¾‹å›¾<br>  make use of ä½¿ç”¨ï¼›åˆ©ç”¨<br>  in use åœ¨ä½¿ç”¨ä¸­<br>  of use æœ‰ç”¨</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**<span class="class"><span class="keyword">data</span>**</span></span><br></pre></td></tr></table></figure><p>  da : ta ( è‹± /ËˆdeÉªtÉ™; ËˆdÉ‘ËtÉ™/  )<br>  n. æ•°æ®ï¼ˆdatumçš„å¤æ•°ï¼‰ï¼›èµ„æ–™<br>  n. (Data)äººåï¼›(æ—¥)é©®å¤ª (å§“)ï¼›(å°ã€è‘¡)è¾¾å¡”<br>  ç½‘ç»œé‡Šä¹‰ æ•°æ®ï¼›èµ„æ–™ï¼›æ•°æ®åŒºï¼›å‚è€ƒæ•°æ®<br>  data æ•°æ®ï¼›èµ„æ–™ï¼›æ•°æ®åŒºï¼›å‚è€ƒæ•°æ®<br>  Data Center æ•°æ®ä¸­å¿ƒï¼›èµ„æ–™ä¸­å¿ƒï¼›æ•°æ®äº¤äº’ä¸­å¿ƒ<br>  data collection æ•°æ®æ”¶é›†ï¼›æ•°æ®é‡‡é›†ï¼›æ•°æ®æœé›†ï¼›æœé›†èµ„æ–™<br>  data processing æ•°æ®å¤„ç†<br>  experimental data å®éªŒæ•°æ®ï¼›è¯•éªŒæ•°æ®<br>  data mining æ•°æ®æŒ–æ˜æŠ€æœ¯ï¼ˆå³æŒ‡ä»èµ„æ–™ä¸­å‘æ˜å’¨è¯¢æˆ–çŸ¥è¯†ï¼‰</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*storage*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  s : to : ra : ge ( è‹± /ËˆstÉ”ËrÉªdÊ’/  )<br>  n. å­˜å‚¨ï¼›ä»“åº“ï¼›è´®è—æ‰€<br>  å¤æ•° storages<br>  ç½‘ç»œé‡Šä¹‰ å­˜å‚¨ï¼›å‚¨å­˜ï¼›ä¿ç®¡ï¼›è´®è—ï¼›<br>  Storage å­˜å‚¨ï¼›å‚¨å­˜ï¼›ä¿ç®¡ï¼›è´®è—<br>  storage room è¡Œæä»“ï¼›å‚¨ç‰©å®¤ï¼›å‚¨è—å®¤ï¼›è´®è—å®¤<br>  cold storage å†·è—ï¼›å†·è—åº“ï¼›å†·åº“ï¼›å†·è—å…¬å¸<br>  data storage æ•°æ®å­˜å‚¨<br>  storage system å­˜å‚¨ç³»ç»Ÿï¼›å­˜å‚¨å™¨å­˜å‚¨ç³»ç»Ÿ<br>  energy storage è“„èƒ½ï¼›èƒ½é‡å‚¨å­˜ï¼›å‚¨èƒ½å™¨</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*<span class="strong">*technologies*</span><span class="strong">*</span></span><br></pre></td></tr></table></figure><p>  te : ch : no : lo : gi : es (  ç¾ /tÉ›kâ€™nÉ‘lÉ™dÊ’i/  )<br>  n. æŠ€æœ¯ï¼›ç§‘æŠ€ï¼ˆtechnologyçš„å¤æ•°ï¼‰<br>  ç½‘ç»œé‡Šä¹‰ å§“ï¼›ç§‘æŠ€<br>  Technologies å§“ï¼›ç§‘æŠ€<br>  Agilent Technologies å®‰æ·ä¼¦ç§‘æŠ€å…¬å¸ï¼›å®‰æ·ä¼¦ç§‘æŠ€æœ‰é™å…¬å¸ï¼›å®‰æ·ä¼¦<br>  United Technologies è”åˆæŠ€æœ¯ï¼›è”åˆæŠ€æœ¯å…¬å¸ï¼›è”åˆç§‘æŠ€ï¼›è”åˆç§‘æŠ€å…¬å¸<br>  united technologies è”åˆç§‘æŠ€ï¼ˆè´¢å¯Œ500å¼ºå…¬å¸ä¹‹ä¸€ï¼Œæ€»éƒ¨æ‰€åœ¨åœ°ç¾å›½ï¼Œä¸»è¦ç»è¥èˆªç©ºèˆªå¤©ï¼‰<br>  cleaner technologies å‡€åŒ–æŠ€æœ¯ï¼›æ¸…æ´æŠ€æœ¯<br>  lucent technologies ç¾å›½æœ—è®¯ç§‘æŠ€å…¬å¸ï¼ˆè´¢å¯Œ500å¼ºå…¬å¸ä¹‹ä¸€ï¼‰<br>```</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Microservices-Guide-å¾®æœåŠ¡æŒ‡å—è¯æ±‡å¯¼è¯»&quot;&gt;&lt;a href=&quot;#Microservices-Guide-å¾®æœåŠ¡æŒ‡å—è¯æ±‡å¯¼è¯»&quot; class=&quot;headerlink&quot; title=&quot;Microservices Guide å¾®æœåŠ¡æŒ‡å—è¯æ±‡å¯¼è¯»&quot;&gt;&lt;/a
      
    
    </summary>
    
    
      <category term="MICROSERVICES" scheme="https://fengshana.github.io/categories/MICROSERVICES/"/>
    
    
      <category term="MICROSERVICES" scheme="https://fengshana.github.io/tags/MICROSERVICES/"/>
    
      <category term="è¯æ±‡" scheme="https://fengshana.github.io/tags/%E8%AF%8D%E6%B1%87/"/>
    
  </entry>
  
  <entry>
    <title>MySqlç´¢å¼•åº•å±‚æ•°æ®ç»“æ„</title>
    <link href="https://fengshana.github.io/2020/05/27/%E3%80%90MYSQL%E3%80%91/%E3%80%90MYSQL%E3%80%91MySql%E7%B4%A2%E5%BC%95/"/>
    <id>https://fengshana.github.io/2020/05/27/%E3%80%90MYSQL%E3%80%91/%E3%80%90MYSQL%E3%80%91MySql%E7%B4%A2%E5%BC%95/</id>
    <published>2020-05-27T10:35:55.031Z</published>
    <updated>2020-06-05T17:56:34.125Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è§‚çœ‹ç¬”è®°ï¼š  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### ç´¢å¼•çš„æœ¬è´¨</span><br><span class="line"></span><br><span class="line">**ç´¢å¼•çš„æœ¬è´¨**</span><br><span class="line"></span><br><span class="line">![ç´¢å¼•](http:&#x2F;&#x2F;r.photo.store.qq.com&#x2F;psc?&#x2F;V13IdniL0W0T32&#x2F;TCfiP1YaPeRT4Jil9RANXwvSlPCJJI2vYZaT3H0rZCG38flqH5eE7TMAOK*DSM1BhWXXI4cugphYQTkM94HMJ9GHGpkBn3QA6a5u74EOK8M!&#x2F;r)</span><br><span class="line"></span><br><span class="line">* **ç´¢å¼•** æ˜¯ **å¸®åŠ©MySQL** **é«˜æ•ˆ è·å–æ•°æ®** çš„ **æ’å¥½åº** çš„ **æ•°æ®ç»“æ„**</span><br><span class="line">* **ç´¢å¼•å­˜å‚¨åœ¨æ–‡ä»¶é‡Œ**</span><br><span class="line">* **ç´¢å¼•ç»“æ„**</span><br><span class="line">  * **äºŒå‰æ ‘**</span><br><span class="line">  * **çº¢é»‘æ ‘**</span><br><span class="line">  * **HASH**</span><br><span class="line">  * **BTREE**</span><br><span class="line"></span><br><span class="line">&gt;**é—®é¢˜**ï¼šæœ‰æ²¡æœ‰åœ¨ç”Ÿäº§ç¯å¢ƒSQLæŸ¥è¯¢çš„éå¸¸æ…¢ï¼Œéœ€è¦ä¼˜åŒ–çš„ã€‚  </span><br><span class="line">**ç­”**ï¼šçœŸçš„æœ‰è¿‡ï¼Œå°±æ˜¯ä¸Šä¸€å®¶å…¬å¸åšçš„é‚£ä¸ªé¡¹ç›®å…³ç³»åˆ°å…¨å›½ï¼Œçœï¼Œå¸‚ï¼ŒåŒºï¼Œå¿è¿™ç§çš„ï¼Œæ¯æ¬¡ä¸€ç»Ÿè®¡å§å°±æ˜¯å…¨å›½çš„é‚£ç§ç»Ÿè®¡ï¼Œå°±æ˜¯è¯¥çœä¸‹æœ‰å¤šå°‘äººæ³¨å†Œäº†ï¼Œè¯¥å¸‚ä¸‹æœ‰å¤šå°‘äººæ³¨å†Œäº†.....è¿™ç§ï¼Œæ¯æ¬¡åŠ è½½å¤§åŠå¤©éƒ½æä¸èµ¢ï¼Œé‚£ä¸ªé¡µé¢éƒ½å‡ºä¸æ¥ã€‚  </span><br><span class="line">è¿™ä¸ªå±äºæ…¢æŸ¥è¯¢å—ï¼Ÿ  </span><br><span class="line">æˆ‘ä¹Ÿä¸æ˜¯å¾ˆæ¸…æ¥šè¯¶ã€‚åæ­£å°±æ˜¯æ•°æ®é‡è´¼å¤§ï¼Œç„¶åç”¨çš„Oracleæ•°æ®åº“ï¼Œå› ä¸ºè¿˜æœ‰å°±æ˜¯äº¤æ˜“é‡å¾ˆå¤§ã€‚  </span><br><span class="line"></span><br><span class="line">&gt;**é—®é¢˜**ï¼š é‡åˆ°è¿™ç§é—®é¢˜ç¬¬ä¸€æ—¶é—´æƒ³åˆ°çš„ä¼˜åŒ–æ˜¯ä»€ä¹ˆï¼Ÿ  </span><br><span class="line">**ç­”**ï¼šé¢ï¼Œæˆ‘å¥½åƒä¹Ÿæ²¡æœ‰åšä»€ä¹ˆä¼˜åŒ–ï¼Œé€šè¿‡ä¸»é”®æ¥è¿›è¡ŒæŸ¥è¯¢ï¼Œå°±æ˜¯äº¤æ˜“é‡ç‰¹åˆ«å¤§çš„æ—¶å€™ï¼Œç„¶åå»æŸ¥è¯¢çš„æ—¶å€™ï¼Œå°±æ˜¯ä½¿ç”¨çš„äº¤æ˜“è¡¨TRANS å½“ä¸­çš„ä¸»é”®å»è¿›è¡ŒæŸ¥è¯¢å¤§éƒ¨åˆ†æ˜¯ã€‚</span><br><span class="line">ç„¶åå°±æ˜¯å› ä¸ºæ˜¯äºŒæ¬¡å¼€å‘è¿™ä¸ªç³»ç»Ÿï¼Œæ‰€ä»¥åœ¨Oracleæ•°æ®åº“å½“ä¸­æ˜¯å­˜åœ¨ä¹‹å‰çš„å¼€å‘è€…æ‰€å†™çš„ç´¢å¼•çš„ã€‚</span><br><span class="line">ç„¶åå°±æ˜¯ä¸å»ä½¿ç”¨å¤–é”®ï¼Œå°±æ˜¯å¤–é”®å…³è”çš„å¤–é”®è¿™ç§ä¸å»è¿›è¡Œä½¿ç”¨ï¼Œè€Œæ˜¯æœ‰äº›è¡¨å½“ä¸­é¢æ€ä¹ˆè¯´å‘¢ï¼Œå°±æ˜¯æœ‰äº›è¡¨å½“ä¸­è®°å½•çš„å­—æ®µå­˜åœ¨ï¼Œè€Œå¦å¤–ä¸€å¼ è¡¨å½“ä¸­å› ä¸ºä¸å»è¿›è¡Œå…³è”æŸ¥è¯¢transè¡¨è¿™ç§æ•°æ®é‡å¤§çš„è¡¨å°±è‡ªå·±è¿™å¼ è¡¨ä¹Ÿä¼šè®°å½•ä¸€äº›æ•°æ®è¿™ç§ã€‚</span><br><span class="line">å°½é‡é€šè¿‡ä¸»é”®å»æŸ¥è¯¢ï¼Œå› ä¸ºé€šè¿‡å…¶ä»–çš„å»æŸ¥è¯¢ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²è¿™ç§çš„ç¢°åˆ°æœ‰äº›æ—¶å€™ä¼šå¾ˆæ…¢ã€‚</span><br><span class="line">æˆ–è€…æ˜¯è¿˜æœ‰å°±æ˜¯å†™é‚£ä¸ªæŸ¥è¯¢ï¼Œnavicatå½“ä¸­å†™ä¸ªæŸ¥è¯¢ç„¶åä¿å­˜ã€‚  </span><br><span class="line">æˆ‘æƒ³ä¸åˆ°å…¶ä»–çš„äº†ï¼Œå› ä¸ºæ²¡æœ‰æ€ä¹ˆç”¨è¿‡ç´¢å¼•ã€‚  </span><br><span class="line"></span><br><span class="line">**é¦–å…ˆæ£€æŸ¥ç´¢å¼•**ï¼›  </span><br><span class="line"></span><br><span class="line">1. æŸ¥çœ‹**SQL**å½“ä¸­çš„**where**å½“ä¸­çš„**æŸ¥è¯¢å­—æ®µ** **æ˜¯å¦æœ‰åŠ ç´¢å¼•**ï¼›  </span><br><span class="line">2. æˆ–è€…è¯´åŠ äº†ç´¢å¼• **æ˜¯å¦æ­£ç¡®ç´¢å¼•** å‘¢ï¼›  </span><br><span class="line">åªè¦SQLä¸å¤ªçƒ‚ï¼Œæ­£å¸¸çš„èµ°ç´¢å¼•ï¼Œæ•°æ®é‡å‡ ç™¾ä¸‡ä¸Šåƒä¸‡è¡Œçš„æ•°æ®è¡¨ï¼ŒæŸ¥è¯¢çš„é€Ÿåº¦ä¾ç„¶ä¼šå¾ˆå¿«ã€‚  </span><br><span class="line"></span><br><span class="line">&gt; **æ€è€ƒ**ï¼š ä¸€ä¸ªå‡ ç™¾ä¸‡ä¸Šåƒä¸‡æ•°æ®é‡çš„è¡¨ï¼Œåªè¦åŠ ä¸Šäº†ç´¢å¼•ï¼Œç„¶åæŸ¥è¯¢çš„æ¡ä»¶åˆæ˜¯èµ°çš„ç´¢å¼•ï¼Œå…³é”®çš„å­—æ®µï¼Œä¸ºä»€ä¹ˆæŸ¥æ‰¾çš„é€Ÿåº¦å°±èƒ½å¤Ÿæé«˜å¾ˆå¤šï¼Œæ€§èƒ½ä¼šé«˜ï¼Ÿ  </span><br><span class="line">**ç­”**ï¼šå› ä¸ºç´¢å¼•å°±ç›¸å½“äºæ˜¯ä¹¦çš„é¡µç ï¼Œæ¯”å¦‚æˆ‘è¦æŸ¥è¯¢æ–°åå­—å…¸å½“ä¸­çš„æŸä¸€ä¸ªå­—ï¼Œæ‰¾åˆ°å®ƒçš„ç´¢å¼•ï¼Œä¹Ÿå°±æ˜¯å®ƒçš„é¡µç ï¼Œä¸€ä¸‹å­å°±èƒ½æ‰¾åˆ°äº†ã€‚</span><br><span class="line">ä¸è¿‡è‡³äºå®ƒçš„åº•å±‚æ–¹é¢çš„åŸç†æˆ‘ä¸æ˜¯å¾ˆæ¸…æ¥šã€‚æ²¡æœ‰è¿‡è¿™æ–¹é¢çš„ç ”ç©¶ï¼Œæˆ‘ä¹Ÿåªæ˜¯å¬è¯´è¿‡æ˜¯é€šè¿‡b+ æ ‘å®ç°çš„ï¼Ÿ  </span><br><span class="line"></span><br><span class="line">**ç´¢å¼•çš„å®šä¹‰**ï¼š**ç´¢å¼•** æ˜¯ **å¸®åŠ©MySQL** **é«˜æ•ˆ è·å–æ•°æ®** çš„ **æ’å¥½åº** çš„ **æ•°æ®ç»“æ„**ã€‚  </span><br><span class="line">**ç´¢å¼•ç»“æ„**ï¼š  </span><br><span class="line"></span><br><span class="line">* **äºŒå‰æ ‘**</span><br><span class="line">* **çº¢é»‘æ ‘**</span><br><span class="line">* **HASH(å“ˆå¸Œè¡¨)**</span><br><span class="line">* **BTREEï¼ˆBæ ‘ï¼‰**</span><br><span class="line"></span><br><span class="line">**æ•°æ®è¡¨** æ˜¯ **å­˜å‚¨åœ¨ç£ç›˜æ–‡ä»¶** å½“ä¸­ï¼›  </span><br><span class="line">æ‰€è£…MySQLå½“ä¸­çš„dataç›®å½•ï¼Œç›®å½•ä¸‹ä¸ºæ•°æ®åº“ï¼›  </span><br><span class="line">**è¡¨æ•°æ®**å®é™…ä¸Šå°± **å­˜æ”¾åœ¨ç£ç›˜ä¸Š** äº†ï¼›  </span><br><span class="line">é‚£**ä»æ•°æ®è¡¨å½“ä¸­å»è¯»å–æ•°æ®çš„æ—¶å€™æŸ¥è¯¢æŸä¸€è¡Œæ•°æ®**çš„æ—¶å€™ï¼Œæ„å‘³ç€å°±éœ€è¦ä»**ç£ç›˜**ä¸Šå»**æŸ¥è¯¢**è¿™ä¸ªæ•°æ®è¡¨å½“ä¸­çš„æ•°æ®ã€‚  </span><br><span class="line">å¦‚æœè¯¥æ•°æ®**æ²¡æœ‰åŠ ç´¢å¼• åˆ™ ä»ç¬¬ä¸€è¡Œå¼€å§‹è¿›è¡ŒæŸ¥æ‰¾**ï¼›  </span><br><span class="line">select * from t where t.col2&#x3D;89;  </span><br><span class="line">å¦‚æœè¯¥è¡¨tæ²¡æœ‰åŠ ä»»ä½•ç´¢å¼•åˆ™éœ€è¦ä»è¯¥è¡¨**ç¬¬ä¸€è¡Œ**å¼€å§‹**éå†**ã€‚  </span><br><span class="line">**é€è¡ŒæŸ¥æ‰¾é€è¡Œæ¯”å¯¹**ã€‚  </span><br><span class="line">ç›´åˆ°æŸ¥æ‰¾åˆ°**næ¬¡**ç£ç›˜æŸ¥æ‰¾åˆ°æ•°æ®åŒ¹é…ä½ç½®ã€‚  </span><br><span class="line">å¦‚æœè¦æŸ¥æ‰¾çš„**æ•°æ®åœ¨æœ«å°¾**ï¼Œ**æ•°æ®é‡éå¸¸å¤§**çš„æƒ…å†µä¸‹ï¼Œæ¯æ¬¡ä»**è¡¨å¤´è¿›è¡ŒæŸ¥æ‰¾**ï¼Œ**æ€§èƒ½éå¸¸å·®**ã€‚  </span><br><span class="line">è¿™ä¹Ÿå°±æ˜¯ **å…¨è¡¨æ‰«æ**ã€‚  </span><br><span class="line"></span><br><span class="line">&gt; **é—®é¢˜**ï¼šæœ‰ä»€ä¹ˆåŠæ³•**ä¼˜åŒ–SQLæŸ¥è¯¢**ï¼Ÿ  </span><br><span class="line">&gt; * ç»™**å­—æ®µåŠ ç´¢å¼•**ã€‚</span><br><span class="line">ç»™col2å­—æ®µåŠ ä¸Šç´¢å¼•åï¼Œå³ä¾¿æ˜¯è¯¥è¡¨å½“ä¸­å­˜åœ¨æ•°æ®é‡ååˆ†å¤§ï¼ŒæŸ¥è¯¢èµ·æ¥çš„æ•ˆç‡ä¹Ÿä¼šå¾ˆé«˜ã€‚  </span><br><span class="line">è¿™ä¸ªåŸå› æ˜¯ä»€ä¹ˆï¼Ÿ  </span><br><span class="line">ç»™è¯¥å­—æ®µåŠ ä¸Šç´¢å¼•ä¹‹åï¼Œè¯¥å­—æ®µä½œä¸ºç´¢å¼•å­—æ®µä¹‹åï¼Œå®ƒåœ¨è¯¥è¡¨ä¸­çš„å­˜å‚¨ç»“æ„ï¼Œè¯¥å­—æ®µçš„å­˜å‚¨ç»“æ„å°±æœ‰ä¸€ç‚¹åŒºåˆ«ã€‚  </span><br><span class="line">**ç´¢å¼•æœ¬è´¨ä¸Šæ˜¯ä¸€ç§æ•°æ®ç»“æ„**ã€‚  </span><br><span class="line">æ‰€ä»¥å½“ç»™col2å­—æ®µåŠ ä¸Šç´¢å¼•ä¹‹åï¼Œé‚£ä¹ˆå°±ä¼šå°†è¯¥col2å­—æ®µåˆ—çš„æ•°æ®é€šè¿‡**ä»¥ä¸€ç§æ•°æ®ç»“æ„è¿›è¡Œå­˜å‚¨èµ·æ¥**ã€‚  </span><br><span class="line"></span><br><span class="line">#### äºŒå‰æ ‘</span><br><span class="line"></span><br><span class="line">**äºŒå‰æ ‘ï¼ˆBinary Search Treesï¼Œç®€å†™BSTï¼‰**ï¼š&#96;&#96;&#96;https:&#x2F;&#x2F;www.cs.usfca.edu&#x2F;~galles&#x2F;visualization&#x2F;BST.html&#96;&#96;&#96;  </span><br><span class="line"></span><br><span class="line">æ¯”æ–¹è¯´ï¼Œå¸¸è§çš„**æ•°æ®ç»“æ„**-**äºŒå‰æ ‘**ï¼Œ  </span><br><span class="line">å°†col2å­—æ®µè¯¥åˆ—çš„æ•°æ®æ”¾åˆ°äºŒå‰æ ‘å½“ä¸­æ¥ï¼Œ  </span><br><span class="line">è¯¥å­—æ®µcol2çš„åˆ—çš„æ•°æ®ï¼Œæ¯ä¸€ä¸ªæ•°æ®éƒ½æ”¾åˆ°äºŒå‰æ ‘å½“ä¸­å»ï¼›  </span><br><span class="line"></span><br><span class="line">è€Œ **äºŒå‰æ ‘çš„æ¯ä¸€ä¸ªç»“ç‚¹** æ˜¯ä¸€ä¸ª **key-value** çš„ä¸€ä¸ªå–å€¼ï¼›  </span><br><span class="line">ä¹Ÿå°±æ˜¯è¯´ **key** å…¶å®å³ä¸º **ç´¢å¼•å­—æ®µ** ï¼Œè€Œ **value** åˆ™ä¸º **ç®­å¤´çš„æŒ‡é’ˆ** ï¼›  </span><br><span class="line">**ç´¢å¼•å­—æ®µ**æ‰€å¯¹åº”çš„è¿™**ä¸€è¡Œçš„æ•°æ®**ï¼Œåœ¨**ç£ç›˜**ä¸Šçš„ä¸€ä¸ª**æ–‡ä»¶æŒ‡é’ˆ**ï¼›  </span><br><span class="line">å¦‚æœé€šè¿‡ä¸€ä¸ªåˆç†çš„æ–¹å¼ï¼Œæˆ–è€…è¯´æ˜¯ä¸€ä¸ªå¥½ä¸€ç‚¹çš„æ•°æ®ç»“æ„ï¼Œæ¥æ”¾ç´¢å¼•çš„è¿™ä¸ªå­—æ®µï¼Œä»¥åŠæ¯ä¸€ä¸ªç´¢å¼•å¯¹åº”çš„è¿™ä¸€è¡Œæ•°æ®ï¼Œ**ç£ç›˜æ–‡ä»¶æŒ‡é’ˆ**ï¼›  </span><br><span class="line">é‚£ä¹ˆå†å»çœ‹æŸ¥æ‰¾è¿™è¡Œæ•°æ®ã€‚  </span><br><span class="line"></span><br><span class="line">**æ•°æ®ç»“æ„-äºŒå‰æ ‘**å¸¸è¯†ï¼š  </span><br><span class="line"></span><br><span class="line">* **æ ¹èŠ‚ç‚¹ï¼ˆçˆ¶èŠ‚ç‚¹ï¼‰çš„å³å­©å­å–å€¼å¤§äºæ ¹èŠ‚ç‚¹ï¼ˆçˆ¶èŠ‚ç‚¹ï¼‰å–å€¼**ï¼›</span><br><span class="line">* **æ ¹èŠ‚ç‚¹ï¼ˆçˆ¶èŠ‚ç‚¹ï¼‰çš„å·¦å­©å­å–å€¼å°äºæ ¹èŠ‚ç‚¹ï¼ˆçˆ¶èŠ‚ç‚¹ï¼‰å–å€¼**ï¼›</span><br><span class="line">* **ä»å·¦åˆ°å³ä¾æ¬¡é€’å¢**ï¼›</span><br><span class="line"></span><br><span class="line">å¦‚æœè¦æŸ¥æ‰¾ select * from t where t.col2&#x3D;89è¿™ä¸€è¡Œæ•°æ®ï¼›  </span><br><span class="line">ç”¨**ç´¢å¼•å­—æ®µ**å»æŸ¥æ‰¾çš„è¯ï¼Œé‚£ä¹ˆ**å…ˆèµ°ç´¢å¼•**ï¼›  </span><br><span class="line">è€Œ**ç´¢å¼•**æ˜¯å½“å‰è¢«æ”¾åœ¨**äºŒå‰æ ‘**è¿™æ ·ä¸€ç§æ•°æ®ç»“æ„å½“ä¸­å»äº†ï¼›  </span><br><span class="line">é‚£ä¹ˆå†å»è¿›è¡ŒæŸ¥æ‰¾ï¼›  </span><br><span class="line">é‚£ä¹ˆè‚¯å®šæ˜¯ä»**æ ¹ç»“ç‚¹**å¼€å§‹è¿›è¡ŒæŸ¥æ‰¾ï¼›  </span><br><span class="line">é‚£ä¹ˆç¬¬ä¸€æ¬¡æŸ¥è¯¢ï¼Œä»ç£ç›˜ä¸Šè¿›è¡ŒæŸ¥è¯¢ç»“ç‚¹åå‘ç°34å’Œ89å¯¹ä¸ä¸Šï¼Œé”™äº†ï¼›  </span><br><span class="line">89æ˜¯å¤§äº34çš„ï¼›  </span><br><span class="line">æŒ‰ç…§**äºŒå‰æ ‘æ•°æ®ç»“æ„**çš„è¿™æ ·ä¸€ä¸ªç‰¹ç‚¹ã€ç‰¹æ€§ï¼›  </span><br><span class="line">æ‰¾åˆ°è¯¥**æ ¹ç»“ç‚¹çš„å³è¾¹çš„å­ç»“ç‚¹**ï¼Œä¸€æ‰¾å³å‘ç°å½“å‰å³è¾¹çš„å­ç»“ç‚¹å³ä¸ºå½“å‰æŸ¥è¯¢çš„ç»“ç‚¹ï¼›  </span><br><span class="line">ç„¶åé€šè¿‡**æ‰¾åˆ°çš„è¯¥ç»“ç‚¹**æ‰¾åˆ°**è¯¥ç»“ç‚¹æ‰€å¯¹åº”çš„value**ï¼›  </span><br><span class="line">è¯¥**value**æ”¾çš„å°±æ˜¯è¿™ä¸ª **ç´¢å¼•å­—æ®µ** **æ‰€å¯¹çš„é‚£ä¸€è¡Œ**çš„**æ•°æ®ç£ç›˜æ–‡ä»¶æŒ‡é’ˆ**ï¼›  </span><br><span class="line">é‚£ä¹ˆå°±å¯ä»¥å¾ˆå¿«æŸ¥æ‰¾å¾—åˆ°ï¼›  </span><br><span class="line"></span><br><span class="line">é€šè¿‡ä¸€ç§**åˆç†çš„æ•°æ®ç»“æ„**æ¥æ”¾åˆšåŠ çš„è¿™ä¸ªç´¢å¼•å­—æ®µï¼›é‚£ä¹ˆè¿™ä¸ª**æŸ¥æ‰¾çš„é€Ÿåº¦**å°±ä¼šå˜å¾—**å¿«**å¾ˆå¤šã€‚  </span><br><span class="line"></span><br><span class="line">**MySQLçš„åº•å±‚åŸç†å¹¶ä¸æ˜¯äºŒå‰æ ‘**ã€‚  </span><br><span class="line">**MySQLçš„åº•å±‚æ˜¯B+æ ‘**ï¼›  </span><br><span class="line">MySQLçš„æœ€ç»ˆåº•å±‚ä¸ºä»€ä¹ˆé€‰æ‹©B+æ ‘è€Œä¸é€‰æ‹©å…¶ä»–çš„æ•°æ®ç»“æ„ï¼Ÿ  </span><br><span class="line"></span><br><span class="line">é€šè¿‡ä¸€ç§**åˆç†çš„æ•°æ®ç»“æ„**æ¥æ”¾**ç´¢å¼•çš„å­—æ®µ**ï¼Œé‚£ä¹ˆ**æŸ¥æ‰¾çš„æ•ˆç‡**å°±å°†ä¼š**å¿«**å¾ˆå¤šï¼›  </span><br><span class="line">å°±**ä¸ç”¨ä¸€è¡Œä¸€è¡Œ**çš„å»**éå†**è¡¨ï¼Œå³**ä¸ç”¨å…¨è¡¨æ‰«æå¼** **æŸ¥è¯¢æŸä¸€è¡Œæ•°æ®** ï¼›</span><br><span class="line">è€Œæ˜¯å¯ä»¥å…ˆå¿«é€Ÿçš„**ä»ç´¢å¼•çš„æ•°æ®ç»“æ„å½“ä¸­** **å¿«é€Ÿçš„å®šä½åˆ°æŸä¸€ä¸ªç´¢å¼•**ï¼Œ</span><br><span class="line">å†æŠŠ**è¿™ä¸ªç´¢å¼•** **å¯¹åº”çš„é‚£ä¸€è¡Œæ•°æ®** çš„ **ç£ç›˜æ–‡ä»¶æŒ‡é’ˆ** ç»™æŸ¥è¯¢å‡ºæ¥ï¼Œ</span><br><span class="line">å°±èƒ½å¤Ÿ**å¿«é€Ÿçš„** ä»**ç£ç›˜ä¸Š** æ‰¾åˆ° **è¯¥è¡Œ** è¦ **æŸ¥è¯¢çš„æ•°æ®**ï¼›  </span><br><span class="line"></span><br><span class="line">**ç´¢å¼•å…·ä½“æ˜¯ä»€ä¹ˆæ ·çš„æ•°æ®ç»“æ„ï¼Ÿ**  </span><br><span class="line"></span><br><span class="line">MySQLå®˜æ–¹æ²¡æœ‰é€‰æ‹©äºŒå‰æ ‘ï¼Œè¯´æ˜**äºŒå‰æ ‘**åœ¨**æŸäº›åœºæ™¯**ä¸‹æ˜¯**å­˜åœ¨é—®é¢˜**çš„ï¼›  </span><br><span class="line"></span><br><span class="line">for example:  </span><br><span class="line"></span><br><span class="line">å‡è®¾è¡¨tï¼Œå°†**col1ä½œä¸ºç´¢å¼•å­—æ®µ**ï¼Œé‚£ä¹ˆSQLè¯­å¥å°±éœ€è¦å˜æˆï¼š  </span><br><span class="line">select * from t **where t.col1**&#x3D;6;æ¥è¿›è¡ŒæŸ¥æ‰¾ï¼›  </span><br><span class="line">ç°åœ¨å°†col1ä½œä¸ºä¸€ä¸ª**äºŒå‰æ ‘**ï¼›  </span><br><span class="line">å½“**tè¡¨åœ¨æ’å…¥æ•°æ®**çš„æ—¶å€™ï¼Œ**äºŒå‰æ ‘æ’å…¥æ•°æ®**çš„ä¸€ä¸ªå˜åŒ–è¿‡ç¨‹ï¼›  </span><br><span class="line">**äºŒå‰æ ‘**è¿™æ ·ä¸€ä¸ª**ç´¢å¼•ç»“æ„çš„å˜åŒ–**ï¼›  </span><br><span class="line">æ’å…¥ç¬¬ä¸€è¡Œæ•°æ®é¦–å…ˆä¼šå»**ç»´æŠ¤è¿™ä¸ªç´¢å¼•**ï¼Œç¬¬ä¸€åˆ—col1çš„æ•°æ®å‘ˆç°çš„**è§„å¾‹ä¸ºé¡ºåºé€’å¢ï¼Œé€’å¢**ï¼›  </span><br><span class="line">æ¯æ’å…¥ä¸€è¡Œæ•°æ®ä¼šå…ˆè¦å»**ç»´æŠ¤ç´¢å¼•çš„è¿™ä¸ªæ•°æ®ç»“æ„**ï¼›  </span><br><span class="line">**ç´¢å¼•**åœ¨**äºŒå‰æ ‘**å½“ä¸­å­˜åœ¨ä¸€ä¸ª**é€’å¢**çš„è§„å¾‹ï¼Œ**é¡ºåºé€’å¢**ï¼›  </span><br><span class="line">æ¯æ’å…¥ä¸€ä¸ªæ•°æ®ï¼Œé¦–å…ˆè¦**ç»´æŠ¤äºŒå‰æ ‘ï¼ˆBinary Search Treesï¼‰é€’å¢é¡ºåºçš„ä¸€ä¸ªå­—æ®µ**ï¼›  </span><br><span class="line">**äºŒå‰æ ‘**å¦‚æœæ˜¯**ç»´æŠ¤è¿™æ ·ä¸€ä¸ªé€’å¢é¡ºåºçš„å­—æ®µ**ä½œä¸ºç´¢å¼•ä¼šæ˜¯ä¸€ä¸ªä»€ä¹ˆæ ·çš„ä¸€ä¸ªæƒ…å†µï¼›  </span><br><span class="line"></span><br><span class="line">* ç´¢å¼•-BinarySearchTreesæ’å…¥é€’å¢æ•°æ®</span><br><span class="line">![ç´¢å¼•-BinarySearchTreesæ’å…¥é€’å¢æ•°æ®](.&#x2F;ã€MYSQLã€‘MySqlç´¢å¼•&#x2F;ç´¢å¼•-BinarySearchTreesæ’å…¥é€’å¢æ•°æ®.gif)</span><br><span class="line"></span><br><span class="line">&gt; å›½å¤–äºŒå‰æ ‘ï¼ˆå„ç§æ•°æ®ç»“æ„ï¼‰çš„ä¸€ä¸ªæ•™å­¦ç½‘ç«™ï¼ˆè§£æåŠ¨ç”»æ¼”ç¤ºï¼‰ï¼š</span><br><span class="line">&#96;&#96;&#96;https:&#x2F;&#x2F;www.cs.usfca.edu&#x2F;~galles&#x2F;visualization&#x2F;Algorithms.html</span><br></pre></td></tr></table></figure><p>æ’å…¥ç¬¬ä¸€è¡Œæ•°æ®ï¼Œå†æ’å…¥ç¬¬äºŒè¡Œæ•°æ®ï¼Œå…ˆè¿›è¡Œ<strong>ç»´æŠ¤</strong>è¿™ä¸ª<strong>ç´¢å¼•</strong>ï¼›<br>å¦‚æœ<strong>äºŒå‰æ ‘ç»´æŠ¤çš„æ˜¯è¿™ç§å•è¾¹å¢é•¿çš„è¿™ç§å­—æ®µ</strong>ï¼Œè€Œ<strong>äºŒå‰æ ‘æ­£å¥½ä½œä¸ºç´¢å¼•çš„åº•å±‚æ•°æ®ç»“æ„</strong>ï¼Œæ­¤æ—¶å°±ä¼šå‡ºç°é—®é¢˜ï¼›<br><strong>äºŒå‰æ ‘</strong>ä¹Ÿä¼šå˜æˆ<strong>å•è¾¹å¢é•¿</strong>ï¼›<br><strong>äºŒå‰æ ‘</strong>å¯¹äºè¿™ç§col1å­—æ®µæ˜¯<strong>å•è¾¹å¢é•¿</strong>çš„è¿™ç§æƒ…å†µæ˜¯ä¸ç¬¦åˆçš„ï¼›<br>è¿™ç§ç”¨äºŒå‰æ ‘å­˜å‚¨ç´¢å¼•å­—æ®µï¼Œå°±è·Ÿåœ¨æ•°æ®è¡¨ä¸­å»<strong>å…¨è¡¨æ‰«æ</strong>æ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œæ•ˆæœä¸€æ ·,æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼›<br><strong>äºŒå‰æ ‘</strong>è¿™ç§æ•°æ®ç»“æ„å¯¹äºç´¢å¼•çš„å­˜å‚¨ï¼Œ<strong>ç´¢å¼•å­—æ®µçš„å­˜å‚¨</strong>åœ¨æŸäº›æ–¹é¢æ˜¯<strong>å­˜åœ¨å±€é™</strong>çš„ï¼›  </p><ul><li>ç´¢å¼•-BinarySearchTreesæŸ¥è¯¢é€’å¢æ•°æ®<br><img src="/2020/05/27/%E3%80%90MYSQL%E3%80%91/%E3%80%90MYSQL%E3%80%91MySql%E7%B4%A2%E5%BC%95/%E7%B4%A2%E5%BC%95-BinarySearchTrees%E6%9F%A5%E8%AF%A2%E9%80%92%E5%A2%9E%E6%95%B0%E6%8D%AE.gif" alt="ç´¢å¼•-BinarySearchTreesæŸ¥è¯¢é€’å¢æ•°æ®"></li></ul><h4 id="çº¢é»‘æ ‘"><a href="#çº¢é»‘æ ‘" class="headerlink" title="çº¢é»‘æ ‘"></a>çº¢é»‘æ ‘</h4><p><strong>çº¢é»‘æ ‘</strong>ï¼š<code>https://www.cs.usfca.edu/~galles/visualization/RedBlack.html</code>  </p><p>é—®é¢˜ï¼šæ˜¯å¦å¬è¯´è¿‡<strong>çº¢é»‘æ ‘</strong>ï¼Ÿ<br>ç­”ï¼šå¬è¯´è¿‡ï¼Œä¸”jdk1.8å½“ä¸­HashMapå½“ä¸­é“¾è¡¨é•¿åº¦è¾¾åˆ°8ä¹‹åå°±ä¼šå°†æ•°æ®ç»“æ„é“¾è¡¨è½¬åŒ–æˆçº¢é»‘æ ‘è¿™ç§æ•°æ®ç»“æ„ï¼›  </p><p>äºŒå‰æ ‘ä¸è¡Œï¼Œåˆ™çœ‹çœ‹å…¶ä»–çš„æ›´å¥½çš„æ•°æ®ç»“æ„æ˜¯å¦èƒ½å¤Ÿæ›´å¥½çš„å­˜å‚¨ç´¢å¼•å­—æ®µ;<br>çº¢é»‘æ ‘ä¹Ÿæ˜¯ä¸€ç§å¸¸è§çš„æ•°æ®ç»“æ„ï¼›<br>jdkåœ¨1.8ä¹‹åï¼ŒHashMapåº•å±‚çš„é“¾è¡¨å®é™…ä¸Šå°±æ˜¯ç”¨çº¢é»‘æ ‘æ¥åšäº†ä¸€ä¸ªä¼˜åŒ–ï¼›  </p><p><strong>æ’å…¥é€’å¢æ•°æ® ä¼š è‡ªåŠ¨å¹³è¡¡</strong>ï¼›  </p><ul><li>ç´¢å¼•-RedBlackæ’å…¥é€’å¢æ•°æ®<br><img src="/2020/05/27/%E3%80%90MYSQL%E3%80%91/%E3%80%90MYSQL%E3%80%91MySql%E7%B4%A2%E5%BC%95/%E7%B4%A2%E5%BC%95-RedBlack%E6%8F%92%E5%85%A5%E9%80%92%E5%A2%9E%E6%95%B0%E6%8D%AE.gif" alt="ç´¢å¼•-RedBlackæ’å…¥é€’å¢æ•°æ®"></li></ul><p>æŸ¥è¯¢æ—¶ç›¸å¯¹äºäºŒå‰æ ‘æ¥è¯´è¦å°‘ä¸€ç‚¹ï¼›<br>ç”¨<strong>çº¢é»‘æ ‘</strong>æ¥å­˜å‚¨ç´¢å¼•å­—æ®µï¼Œç›¸å¯¹äºç”¨æ™®é€šçš„äºŒå‰æ ‘æ¥å­˜å‚¨æ¥è¯´ï¼Œæ€§èƒ½ç¨å¾®é«˜ä¸€ç‚¹ï¼›<br><strong>çº¢é»‘æ ‘</strong>é’ˆå¯¹äºè¿™ç§å•è¾¹å¢é•¿çš„è¿™ç§æƒ…å†µï¼Œåªè¦<strong>å•è¾¹å‡ºç°3ä¸ªè¿ç»­é€’å¢çš„ç»“ç‚¹</strong>ä¼šåšä¸€ä¸ª<strong>è‡ªåŠ¨å¹³è¡¡</strong>çš„å¤„ç†ï¼›<br>é‚£ä¹ˆå­˜å‚¨åŒæ ·çš„æ•°æ®çš„è¯ï¼Œæ•´ä½“çš„<strong>é«˜åº¦</strong>ç›¸å¯¹æ¥è¯´<strong>çº¢é»‘æ ‘</strong>è‚¯å®šè¦<strong>æ¯”äºŒå‰æ ‘è¦çŸ­</strong>ï¼›  </p><ul><li>ç´¢å¼•-RedBlackæŸ¥è¯¢é€’å¢æ•°æ®<br><img src="/2020/05/27/%E3%80%90MYSQL%E3%80%91/%E3%80%90MYSQL%E3%80%91MySql%E7%B4%A2%E5%BC%95/%E7%B4%A2%E5%BC%95-RedBlack%E6%9F%A5%E8%AF%A2%E9%80%92%E5%A2%9E%E6%95%B0%E6%8D%AE.gif" alt="ç´¢å¼•-RedBlackæŸ¥è¯¢é€’å¢æ•°æ®"></li></ul><p><strong>é—®é¢˜</strong>ï¼š<strong>äºŒå‰æ ‘ æ˜¯å¯ä»¥ è‡ªåŠ¨å¹³è¡¡</strong>çš„ï¼Œé‚£ä¹ˆæƒ³ä¸€æƒ³å¦‚æœç”¨äºŒå‰æ ‘æ¥åšç´¢å¼•å­—æ®µå­˜å‚¨çš„æ•°æ®ç»“æ„æœ‰æ²¡æœ‰ä»€ä¹ˆ<strong>å¼Šç«¯</strong>ï¼Ÿåœ¨å“ªäº›ä¸šåŠ¡åœºæ™¯å½“ä¸­å¯èƒ½åˆæœ‰ä¸€äº›<strong>å°é—®é¢˜</strong>ï¼Ÿ<br>ç­”ï¼šæˆ‘æƒ³ä¸å¤ªå‡ºæ¥è¯¶ã€‚  </p><ul><li><strong>çº¢é»‘æ ‘èŒƒå›´æŸ¥è¯¢</strong></li><li>å½“æ•°æ®é‡å°çš„æ—¶å€™æŸ¥è¯¢èµ·æ¥,æ•ˆç‡è¿˜åœ¨çº¿ä¸Šï¼›<br>å¦‚æœ<strong>å½“æ•°æ®é‡å¤§</strong>çš„è¯ï¼Œ<strong>çº¢é»‘æ ‘</strong>å°†<strong>ä¸æ–­çš„å¾€ä¸‹å¢é•¿</strong>ï¼›</li><li><em>æ ‘çš„é«˜åº¦*</em>æœ‰å¯èƒ½å˜æˆ<strong>2çš„næ¬¡æ–¹</strong>ï¼›<br>è¿™ä¸ª<strong>nå³ä¸ºæ ‘çš„é«˜åº¦</strong>ï¼›<br>æ¯ä¸ªç»“ç‚¹å³2ï¼Œè¿™ä¸ªæ ‘èƒ½å¤Ÿå­˜å¤šå°‘ç´¢å¼•å­—æ®µï¼Œå³2çš„næ¬¡æ–¹ï¼›</li><li>å¦‚æœè¯´è¦æŸ¥æ‰¾çš„nï¼Œè¦æŸ¥æ‰¾çš„é‚£ä¸€è¡Œçš„ç´¢å¼•å­—æ®µåˆšå¥½æ˜¯åœ¨æ ‘çš„å¶å­ç»“ç‚¹ä¸Šé¢ã€‚<br>ä¸€èˆ¬æ˜¯ä»<strong>æ ¹èŠ‚ç‚¹ä¸Šè¿›è¡Œéå†</strong>ï¼Œé‚£ä¹ˆ<strong>æŸ¥æ‰¾éå†çš„æ¬¡æ•°</strong>è‡³å°‘æ˜¯<strong>æ ‘çš„n</strong>ï¼Œ<strong>é«˜åº¦æ¬¡</strong>è¿™ä¹ˆå¤šï¼›<br>é‚£ä¹ˆä»ç£ç›˜ä¸Šè¦ç»è¿‡å‡ åæ¬¡ï¼Œä¸€ä¸ªç»“ç‚¹æŸ¥æ‰¾ä¸€æ¬¡ï¼ŒæŸ¥æ‰¾ä¸€æ¬¡æœ‰ä¸€ä¸ªä¸“ä¸šçš„æœ¯è¯­ï¼Œè·Ÿç£ç›˜æ‰“ä¸€æ¬¡äº¤é“ï¼Œå«åš<strong>ç£ç›˜IO</strong>ï¼Œè¿™æ ·çš„è¯é’ˆå¯¹<strong>ç£ç›˜IO</strong>æ¥è¯´æ€§èƒ½æ˜¯ä¸é«˜çš„ï¼›<br>æ•ˆç‡ä¸æ˜¯ç‰¹åˆ«é«˜ï¼›<br>å¯ä»¥è¯´æ•ˆç‡æ¯”è¾ƒä½äº†ï¼›<br>å¦‚æœè¿˜ç»å†å‡ åæ¬¡è¿™æ ·çš„<strong>ç£ç›˜IO</strong>ï¼Œæ€§èƒ½æ˜¯è‚¯å®šæ²¡æœ‰åŠæ³•æ¥å—çš„ï¼›</li></ul><p><strong>çº¢é»‘æ ‘</strong>è¿™ç§æ•°æ®ç»“æ„ï¼Œ<strong>ä¸€æ—¦è¡¨çš„æ•°æ®é‡ç‰¹åˆ«å¤§</strong>çš„æ—¶å€™ï¼Œ<strong>æŸ¥æ‰¾æ•°æ®çš„æ•ˆç‡</strong>ä¾ç„¶ä¼š<strong>å¾ˆæ…¢</strong>ï¼›<br>å› ä¸ºæŸ¥æ‰¾æ•°æ®å¯èƒ½å°±åœ¨å¶å­ç»“ç‚¹ä¸Šï¼›<br><strong>çº¢é»‘æ ‘</strong>åœ¨<strong>æ•°æ®é‡å¤§çš„æ—¶å€™</strong>ä¹Ÿæ˜¯å­˜åœ¨<strong>å¼Šç«¯</strong>çš„ï¼›  </p><p>çº¢é»‘æ ‘ä¸è¡Œï¼Œå¯ä»¥å¯¹å…¶åšä¸€ç‚¹ç‚¹æ”¹é€ ï¼›  </p><p>å³ä¾¿æ˜¯<strong>å¤§æ•°é‡æƒ…å†µ</strong>ä¸‹ï¼Œå‡ ç™¾ä¸‡ç”šè‡³æ˜¯ä¸Šåƒä¸‡çš„æ•°æ®é‡ä¸‹ï¼›<br>é€šè¿‡ä¸€ç§æ•°æ®ç»“æ„èƒ½å¤Ÿ<strong>å¿«é€Ÿçš„å®šä½</strong>åˆ°æ‰€éœ€è¦çš„é‚£ä¸ªæ•°æ®çš„ç´¢å¼•çš„å­—æ®µï¼›<br>ä»è€Œæ ¹æ®é‚£ä¸ªç´¢å¼•çš„å­—æ®µèƒ½å¤Ÿå¾—åˆ°ç»“ç‚¹å½“ä¸­çš„é‚£ä¸ªvalueå€¼ï¼Œä¹Ÿå°±æ˜¯<strong>ç´¢å¼•æ‰€åœ¨é‚£ä¸€è¡Œæ•°æ®çš„ç£ç›˜æ–‡ä»¶æŒ‡é’ˆ</strong>æ¥<strong>å®šä½åˆ°ç£ç›˜ä¸Šçš„æŸä¸€ä¸ªä½ç½®</strong>æŸ¥æ‰¾åˆ°è¿™ä¸€è¡Œæ•°æ®ï¼›  </p><p>å¯ä»¥å¯¹çº¢é»‘æ ‘è¿›è¡Œæ”¹é€ è¿›è¡Œä¼˜åŒ–ï¼›  </p><p><strong>çº¢é»‘æ ‘</strong>ä¹Ÿæ˜¯<strong>äºŒå‰æ ‘</strong>ï¼›å«åš<strong>äºŒå‰å¹³è¡¡æ ‘</strong>ï¼›<br>å› ä¸º<strong>çº¢é»‘æ ‘ä¼šè‡ªåŠ¨å¹³è¡¡</strong>ï¼›åœ¨çº¢é»‘æ ‘çš„åŸºç¡€ä¸Šåšä¸€ä¸‹æ”¹é€ ï¼Œä»è€Œè§£å†³åœ¨å¤§æ•°æ®é‡è¿™ç§æƒ…å†µä¸‹å‡ºç°çš„å¼Šç«¯<br>ï¼ˆå› ä¸º<strong>æ ‘çš„é«˜åº¦å¤ªé«˜</strong>ï¼Œä¹Ÿå°±æ˜¯æ ‘<strong>å­˜å‚¨å¤§æ•°æ®é‡çš„æƒ…å†µ</strong>ä¸‹ï¼Œ<strong>æ ‘çš„é«˜åº¦å¤ªé«˜</strong>ï¼Œ<strong>ç£ç›˜IO</strong>å°±å°†<strong>éšç€æ ‘çš„é«˜åº¦heightå¢é•¿è€Œå¢é•¿</strong>ï¼‰ï¼›  </p><p>é—®é¢˜ï¼š å¯¹çº¢é»‘æ ‘è¿›è¡Œæ”¹é€ ï¼Œè®©çº¢é»‘æ ‘æ•ˆç‡æ›´é«˜ä¸€ç‚¹ï¼Ÿ  </p><ul><li><strong>nå‰æ ‘</strong></li><li>åŸæ¥<strong>ç»“ç‚¹å­˜å‚¨åˆ°ç£ç›˜</strong>ä¸Šé¢ï¼Œä¹‹å‰<strong>ç»“ç‚¹å°±åªå­˜å‚¨ä¸€ä¸ªç´¢å¼•å­—æ®µ</strong>ï¼›<br>é‚£ä¹ˆå¯ä»¥å°†è¿™ä¸ª<strong>ç»“ç‚¹å¼„å¤§ä¸€ç‚¹</strong>ï¼Œä¹Ÿå°±æ˜¯å°†å®ƒçš„<strong>ç£ç›˜å­˜å‚¨ç©ºé—´åˆ†é…å¤§ä¸€ç‚¹</strong>ï¼ˆä¹Ÿå°±æ˜¯è®©è¿™ä¸ª<strong>ç»“ç‚¹ä¸Šå¤šå­˜å‚¨å‡ ä¸ªç´¢å¼•å­—æ®µ</strong>ï¼‰ï¼›<br>ä¸”<strong>æ¯ä¸€ä¸ªç´¢å¼•</strong>ä¹‹é—´<strong>éƒ½å¯ä»¥è¿›è¡Œåˆ†å‰</strong>ï¼Œ<strong>åˆ†å‰ä¸‹çš„ç´¢å¼•ç»“ç‚¹çš„ç£ç›˜å­˜å‚¨ç©ºé—´</strong>ä¹Ÿåˆ†é…å¤§ä¸€ç‚¹ï¼Œä¹Ÿå­˜å‚¨å¤šä¸ªç´¢å¼•å­—æ®µï¼Œæ¯ä¸€ä¸ªç»“ç‚¹éƒ½å¯ä»¥æœ‰å¤šä¸ªç»“ç‚¹ï¼ˆå¤šä¸ªç´¢å¼•å…ƒç´ ï¼‰ï¼›  </li></ul><p><strong>é—®é¢˜</strong>ï¼š è¿™æ ·çš„å­˜å‚¨ç»“æ„ï¼ŒåŒæ ·çš„å¤§æ•°æ®é‡çš„æƒ…å†µä¸‹ï¼Œè¿™æ ·æ”¹é€ çº¢é»‘æ ‘åçš„ç»“æ„å­˜å‚¨å¤§æ•°æ®é‡è®°å½•æ¯”æ”¹é€ å‰çš„çº¢é»‘æ ‘ï¼Œæ ‘çš„é«˜åº¦è¦å°å¾—å¤šå¾—å¤šï¼›  </p><p><strong>å‡å°</strong>äº†<strong>çº¢é»‘æ ‘</strong>çš„<strong>çºµå‘</strong>ï¼Œ<strong>çº¢é»‘æ ‘çš„é«˜åº¦</strong>ï¼Œè€Œ<strong>å¢é•¿</strong>äº†<strong>çº¢é»‘æ ‘</strong>çš„<strong>æ¨ªå‘</strong>ï¼›<br><strong>æ¨ªå‘è¶Šé•¿</strong>ï¼Œ<strong>å­˜å‚¨åŒæ ·å¤§çš„æ•°æ®é‡</strong>ï¼Œ<strong>æ ‘çš„é«˜åº¦å°±è¶ŠçŸ®</strong>ï¼›<br><strong>æ ‘çš„é«˜åº¦è¶ŠçŸ®</strong>ï¼ŒæŸ¥æ‰¾ä¸€è¡Œæ•°æ®ï¼Œä¹Ÿå°±æ˜¯æŸä¸€ç»“ç‚¹ä¸Šçš„æ•°æ®ï¼Œé‚£ä¹ˆå…¶<strong>æ•ˆç‡ä¹Ÿå°±è¶Šé«˜</strong>ï¼›  </p><p>å·²ç»æ…¢æ…¢æ¥è§¦åˆ°MySQLåº•å±‚çš„æ•°æ®ç»“æ„ï¼š<br>è¿™ç§æ”¹é€ å…¶å®å°±æ˜¯<strong>Bæ ‘</strong>  </p><ul><li>ç£ç›˜å­˜å–åŸç†<ul><li>å¯»é“æ—¶é—´ï¼ˆé€Ÿåº¦æ…¢ã€è´¹æ—¶ï¼‰</li><li>æ—‹è½¬æ—¶é—´ï¼ˆé€Ÿåº¦è¾ƒå¿«ï¼‰<br><img src="/2020/05/27/%E3%80%90MYSQL%E3%80%91/%E3%80%90MYSQL%E3%80%91MySql%E7%B4%A2%E5%BC%95/%E7%A3%81%E7%9B%98%E5%AD%98%E5%8F%96%E5%8E%9F%E7%90%86.png" alt="ç£ç›˜å­˜å–åŸç†"></li></ul></li></ul><p>æ¨ªå‘æŸ¥æ‰¾ä¸å°±æ…¢äº†å—ï¼Ÿ</p><h4 id="B-Tree"><a href="#B-Tree" class="headerlink" title="B-Tree"></a>B-Tree</h4><p><strong>B-Tree</strong></p><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANXx5xRm2O7Hw.CPoJY21PbGHy3.R9D2C3BHGRAwPaR*QEhgcUF1UMc2yymaSzxbgBOKNjFYrOEqnDAvX4*fMGPmY!/r" alt="ç´¢å¼•"></p><ul><li><strong>åº¦ï¼ˆDegreeï¼‰</strong>-<strong>ç»“ç‚¹çš„ æ•°æ®å­˜å‚¨ä¸ªæ•°</strong></li><li><strong>å¶å­ç»“ç‚¹ å…·æœ‰ ç›¸åŒçš„æ·±åº¦</strong></li><li><strong>å¶å­ç»“ç‚¹çš„ æŒ‡é’ˆ ä¸º ç©º</strong></li><li><strong>ç»“ç‚¹ä¸­çš„ æ•°æ®key ä»å·¦åˆ°å³ é€’å¢æ’åˆ—</strong></li></ul><p>åˆšåˆšè¯´åˆ°çº¢é»‘æ ‘ä¸è¡Œï¼Œå¯ä»¥åœ¨<strong>çº¢é»‘æ ‘çš„æ¨ªå‘ä¸Š</strong>åšæ–‡ç« ï¼›<br><strong>å­˜å‚¨åŒæ ·å¤§çš„æ•°æ®é‡</strong>ï¼Œ<strong>æ ‘çš„é«˜åº¦</strong>å°†ä¼šå¤§å¤§çš„<strong>å‡å°</strong>ï¼›<br>é‚£å°±å˜æˆäº†å¼•å…¥<strong>Bæ ‘</strong>ï¼›  </p><ul><li>ç´¢å¼•-<strong>BTree</strong>æ’å…¥é€’å¢æ•°æ®<br><img src="/2020/05/27/%E3%80%90MYSQL%E3%80%91/%E3%80%90MYSQL%E3%80%91MySql%E7%B4%A2%E5%BC%95/%E7%B4%A2%E5%BC%95-BTree%E6%8F%92%E5%85%A5%E9%80%92%E5%A2%9E%E6%95%B0%E6%8D%AE.gif" alt="ç´¢å¼•-BTreeæ’å…¥é€’å¢æ•°æ®"></li></ul><p><strong>ç»“ç‚¹å†… æ•°æ® æœ‰é™</strong>ï¼Œ<strong>ä¸èƒ½ æ— é™æ”¾å¤§</strong>ï¼›<br><strong>Bæ ‘</strong>æ¯”<strong>çº¢é»‘æ ‘</strong>æ¥è¯´æœ‰<strong>æ›´å¤§çš„ä¼˜ç‚¹</strong>ï¼›  </p><p><strong>é—®é¢˜</strong>ï¼šåœ¨<strong>æ¨ªå‘ä¸Š</strong>åšæ–‡ç« ï¼Œé‚£<strong>æ¨ªå‘æŸ¥æ‰¾ä¸å°±æ…¢äº†</strong>å—ï¼Ÿ  </p><p><strong>æ³¨æ„</strong>ï¼šä¸€ä¸ª<strong>ç»“ç‚¹çš„å¤§å°</strong> æ˜¯ <strong>æœ‰é™åˆ¶çš„</strong>ï¼›<br><strong>ç»“ç‚¹å½“ä¸­çš„ æ•°æ®é‡ æ˜¯ æœ‰é™åˆ¶çš„</strong>ï¼›<br><strong>ä¸å¯èƒ½ æ— é™å»¶é•¿ã€å¤§</strong>ï¼›<br>æ¯”å¦‚è¯´ç»™è¿™ä¸ªç»“ç‚¹è®¾ç½®å‡ kå¤§å°ï¼Œæˆ–è€…1Mbè¿™ä¹ˆå¤§ï¼›<br>å¦‚æœè¿™ä¸ªç»“ç‚¹å¤ªå¤§ï¼›<br>ä¸€ä¸ªç»“ç‚¹å¯¹åº”ç£ç›˜ä¸Šçš„ä¸€ä¸ªç£ç›˜æ–‡ä»¶åœ°å€ï¼Œå¯¹åº”ä¸€ä¸ªå¤§çš„ç£ç›˜æ–‡ä»¶åœ°å€ï¼›<br>MySQLè®¾è®¡çš„æ˜¯ï¼Œ<strong>å°½é‡</strong>çš„<strong>ä¸€æ¬¡ ç£ç›˜IO æŸ¥æ‰¾</strong>ï¼Œåœ¨è¿›è¡ŒæŸ¥æ‰¾çš„æ—¶å€™æ˜¯å¸Œæœ›ä¸€æ¬¡æ€§æŠŠè¿™ä¸ª<strong>ç»“ç‚¹</strong>æ”¾åˆ°<strong>å†…å­˜</strong>ï¼›<br>MySQL<strong>æŸ¥æ‰¾ä¸€æ¬¡</strong>ï¼Œè·Ÿ<strong>ç£ç›˜åšä¸€æ¬¡ç£ç›˜IOäº¤äº’</strong>çš„æ—¶å€™ï¼Œå®ƒä¼šæŠŠè¿™ä¸€ä¸ª<strong>æ¨ªå‘ç»“ç‚¹</strong> å…¨éƒ¨<strong>æ”¾åˆ°å†…å­˜</strong>å½“ä¸­ï¼›<br>åªè¦è¿™ä¸€ä¸ª<strong>ç»“ç‚¹çš„æ•°æ® éƒ½ æ”¾åˆ° å†…å­˜</strong>ä¹‹åï¼›<br>é‚£ä¹‹åå†åˆ°è¿™ä¸ªæ¨ªå‘ç»“ç‚¹å½“ä¸­å†è¿›è¡ŒæŸ¥æ‰¾æ•°æ®ï¼›<br>æ¯”æ–¹è¯´è¦æŸ¥æ‰¾77ï¼Œé‚£ä¹ˆåˆšåˆšè¯´ç»è¿‡äº†ä¸€æ¬¡ç£ç›˜IOä¹‹åï¼Œä¼šå°†è¿™ä¸€ä¸ª<strong>æ¨ªå‘ç»“ç‚¹ å½“ä¸­çš„ æ‰€æœ‰ç´¢å¼•å…ƒç´  éƒ½ æ”¾åˆ° å†…å­˜ å½“ä¸­å»</strong>ï¼Œé‚£ä¹ˆå†å»æŸ¥æ‰¾77ï¼Œå®é™…ä¸Šå°±æ˜¯ä»å†…å­˜å½“ä¸­å»è¿›è¡ŒæŸ¥æ‰¾è¿™ä¸ª77äº†ï¼›<br><strong>å†…å­˜</strong>å½“ä¸­æŸ¥æ‰¾<strong>æ€§èƒ½</strong>å°±éå¸¸<strong>å¿«</strong>äº†ï¼›<br><strong>å†…å­˜</strong>å½“ä¸­<strong>æŸ¥æ‰¾</strong>è·Ÿä¸€æ¬¡<strong>ç£ç›˜IO</strong>è¿›è¡Œ<strong>æŸ¥æ‰¾</strong>å®Œå…¨æ˜¯<strong>ä¸åŒçº§åˆ«</strong>çš„ï¼›<br>æ‰€ä»¥<strong>ä¸ç”¨æ‹…å¿ƒ æ¨ªå‘æŸ¥æ‰¾ æ˜¯å¦ ä¼šæ…¢</strong>ï¼›  </p><p><strong>é—®é¢˜</strong>ï¼šé‚£<strong>æ˜¯å¦ èƒ½ å°†è¡¨ä¸­çš„ æ‰€æœ‰è¡Œæ•°æ® éƒ½ æ”¾åœ¨ä¸€ä¸ª æ¨ªå‘ç»“ç‚¹ å½“ä¸­</strong>ï¼Œå°†è¿™ä¸ª<strong>æ¨ªå‘ç»“ç‚¹</strong>è®¾ç½®ä¸º<strong>æ— é™å¤§</strong>ï¼›å‡ ç™¾MBæˆ–è€…æ˜¯å‡ ä¸ªGçš„å¤§å°ç”¨ä»¥è¿™ä¸ªæ¨ªå‘ç»“ç‚¹åšå­˜å‚¨ç´¢å¼•å…ƒç´ ï¼Ÿ<br>é‚£ä¹ˆ<strong>ä¸€æ¬¡æŸ¥æ‰¾</strong>å³<strong>ä¸€æ¬¡ç£ç›˜IO</strong>å°†è¿™äº›<strong>æ•°æ®ä¸€æ¬¡æ€§</strong>æ”¾åˆ°<strong>å†…å­˜</strong>å½“ä¸­ï¼›<br>ä¹‹åå°±æ˜¯<strong>ä» å†…å­˜ å½“ä¸­ æŸ¥è¯¢ ç´¢å¼•æ•°æ®</strong>ï¼›é‚£å°±å¾ˆå¿«äº†ï¼Ÿ  </p><p>è¿™ä¸ª<strong>æ¨ªå‘ç»“ç‚¹ ä¸èƒ½ è®¾ç½®å¤ªå¤§</strong>ï¼›<br>å¦‚æœ<strong>è®¾ç½®å¤ªå¤§</strong>é‚£ä¹ˆ<strong>å¼Šç«¯å°†å­˜åœ¨æ›´å¤š</strong>ï¼›<br>é¦–å…ˆï¼›<br>æ¯”å¦‚è¯´å‡ ç™¾ä¸‡è¡Œä¸Šåƒä¸‡è¡Œçš„æ•°æ®çš„ç´¢å¼•æ€ä¹ˆè¯´ä¹Ÿè¦å‡ ç™¾MBï¼Œç”šè‡³1ã€2Gæ¥å­˜å‚¨ï¼›<br>ä¹Ÿè·Ÿ<strong>ç´¢å¼•çš„å­—æ®µç±»å‹</strong>æœ‰å…³ï¼Œæ¯”å¦‚è¯´<strong>Stringç±»å‹</strong>æˆ–è€…<strong>UUIDç±»å‹</strong>ç­‰å°±è‚¯å®šè¦å‡ ç™¾MBï¼›<br>é‚£ä¹ˆ<strong>ä¸€æ¬¡æŸ¥æ‰¾ å°± å…¨éƒ¨æ”¾åˆ° å†…å­˜</strong>çš„è¯ï¼›<br><strong>ä¸€æ¬¡ç£ç›˜IO</strong> å°± <strong>éœ€è¦ èŠ±è´¹ å¾ˆé•¿æ—¶é—´</strong>ï¼Œè€Œä¸”<strong>ä¸€æ¬¡ç£ç›˜IO è¿˜ä¸ä¸€å®š èƒ½å¤Ÿ å…¨éƒ¨ æ”¾åˆ° å†…å­˜ å½“ä¸­å»</strong>ï¼›<br><strong>ä¸€æ¬¡ç£ç›˜IO ä¹Ÿæ˜¯æœ‰ å­˜åœ¨ å¤§å°é™åˆ¶ çš„</strong>ï¼›<br>å°±ç®—<strong>ä¸€æ¬¡ç£ç›˜IO èƒ½å¤Ÿå°† è¯¥æ¨ªå‘ç»“ç‚¹ å½“ä¸­çš„ æ‰€æœ‰çš„ç´¢å¼•å…ƒç´  æ”¾åˆ° å†…å­˜ å½“ä¸­å»</strong>ï¼Œé‚£ä¹Ÿ<strong>éœ€è¦æ—¶é—´æ¥æ”¾</strong>è¿™å‡ ç™¾MBçš„ç´¢å¼•å…ƒç´ ï¼›<br>è€Œä¸”å¯ä»¥æ€è€ƒä¸€ä¸‹ï¼Œäº‹å…ˆå°±å°†è¿™å‡ ç™¾MBè®¾ç½®å‡ ä¸ªGçš„<strong>ç´¢å¼•å…ƒç´ ç›´æ¥æ”¾åˆ°å†…å­˜</strong>å½“ä¸­å»ï¼Œè€Œ<strong>çœŸæ­£å»æŸ¥æ‰¾æ•°æ®</strong>çš„æ—¶å€™<strong>å¯èƒ½ ä¹Ÿå°±æ˜¯ æŸ¥æ‰¾ æœ€å¸¸ç”¨çš„ 10% éƒ½ä¸åˆ°çš„ è¡Œæ•°æ®</strong>ï¼›<br>å¦‚æœè€æ˜¯å°†æ•´å¼ è¡¨çš„<strong>æ•°æ® å…¨éƒ¨éƒ½ ä¸€æ¬¡æ€§ æ”¾åˆ° å†…å­˜</strong>å½“ä¸­å»ï¼›<br>é‚£å°±å°†å¯¹è¿™ä¸ª<strong>å†…å­˜ çš„ æ¶ˆè€— å¤ªè¿‡äº æµªè´¹</strong>ï¼›<br><strong>å†…å­˜ çš„ èµ„æº</strong>æ˜¯å¾ˆ<strong>å®è´µ</strong>çš„ï¼›<br>æ‰€ä»¥è¯´è¿™å¯¹è¯¥<strong>å¼Šç«¯</strong>ï¼›<br>MySQLå¯¹äºè¿™ä¸€ä¸ª<strong>æ¨ªå‘ç»“ç‚¹</strong>æ˜¯<strong>ä¸ä¼šå°†å…¶è®¾ç½®è¿‡å¤§</strong>ï¼›<br>å°½é‡è®¾ç½®<strong>ä¸€ä¸ªåˆé€‚çš„å¤§å°</strong>ï¼›<br>è®©è¿™ä¸ªç»“ç‚¹ï¼Œé€šè¿‡<strong>ä¸€æ¬¡ç£ç›˜IO</strong>èƒ½å¤Ÿ<strong>å¿«é€Ÿ å…¨éƒ¨ å­˜å…¥ åˆ° å†…å­˜</strong>å½“ä¸­ï¼›  </p><p><strong>B-Tree</strong>åº”è¯¥å«åš<strong>å¤šå‰å¹³è¡¡æ ‘</strong>ï¼›<br><strong>B-Tree</strong>æœ‰ä¸€ä¸ªç‰¹ç‚¹ï¼šåœ¨ä¸­é—´æ¥çœ‹ä¸€æ ·ä¹Ÿ<strong>æ»¡è¶³äºŒå‰æ ‘çš„åŸåˆ™</strong>ï¼›  </p><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANX5q0FjtHgrmg9JO6KfRhTseVNI0ZlC7sOBVRXN8io620BWK0osf4XOQsJRaBrrA60171VhwueoMM9fAlldBY.Fs!/r" alt="ç´¢å¼•"></p><p>56<strong>å·¦è¾¹çš„æ‰€æœ‰å…ƒç´ </strong> éƒ½ <strong>å°äº</strong>56ç›¸å¯¹æ¥è¯´ <strong>å³è¾¹çš„å…ƒç´ </strong>ï¼›<br>è€Œ56<strong>å³è¾¹çš„ç´¢å¼•å…ƒç´ </strong>éƒ½æ˜¯ <strong>å¤§äº</strong>56 <strong>å·¦è¾¹çš„çˆ¶å…ƒç´ </strong>ï¼›<br>20å’Œ49éƒ½å°äº56ï¼›<br>è€Œ20å’Œ49éƒ½å¤§äº15ï¼›  </p><p>ç„¶å<strong>Bæ ‘</strong>è¿˜æœ‰ä¸€ä¸ªç‰¹ç‚¹å°±æ˜¯åœ¨è¿™ä¸€ä¸ªç»“ç‚¹å½“ä¸­ï¼Œè¿™ä¸€ä¸ª<strong>æ¨ªå‘ç»“ç‚¹</strong>å½“ä¸­<strong>ä»å·¦åˆ°å³</strong>å®ƒä¹Ÿ<strong>æ˜¯é€’å¢æ’åº</strong>çš„ï¼›<br>15å°äº56ï¼›<br>56å°äº77ï¼›<br>è¿™æ˜¯<strong>Bæ ‘</strong>çš„ä¸€ä¸ªç‰¹æ€§ï¼›<br>åŒæ—¶ä¹Ÿæ˜¯<strong>è¯¥æ•°æ®ç»“æ„çš„ä¸€ä¸ªç‰¹æ€§</strong>ï¼›  </p><p>ä¹Ÿå°±æ˜¯è¯´è¦ç”¨<strong>Bæ ‘</strong>æ¥ç»´æŠ¤è¿™ä¸ªæ•°æ®ç»“æ„æ—¶ï¼Œå®ƒä¼šæŒ‰ç…§è¿™ä¸ªç‰¹æ€§è¿›è¡Œåˆå§‹åŒ–å¥½ï¼›<br>éœ€è¦è¿›è¡Œ<strong>æŸ¥è¯¢</strong>æŸä¸€<strong>ç´¢å¼•å…ƒç´ </strong>æ—¶ä¹ŸåŒæ ·<strong>æŒ‰ç…§å…¶ç‰¹æ€§</strong>å»æŸ¥æ‰¾ï¼›<br>æ¯”æ–¹è¯´è¦è¿›è¡ŒæŸ¥æ‰¾49è¿™ä¸€ç´¢å¼•å…ƒç´ ï¼›</p><p>é‚£ä¹ˆMySQLçš„æŸ¥æ‰¾æ–¹å¼å³ä¸ºï¼šå…ˆå°†<strong>ç¬¬ä¸€ä¸ªç»“ç‚¹ æ¨ªå‘ç»“ç‚¹ æ ¹ç»“ç‚¹</strong>é€šè¿‡<strong>ç£ç›˜IO</strong>ä¹‹å<strong>æ”¾åˆ° å†…å­˜</strong>å½“ä¸­ï¼›<br>ç„¶ååˆ°<strong>å†…å­˜</strong>å½“ä¸­è¿›è¡Œå»<strong>æ¯”å¯¹</strong>ï¼›<br>å…ˆ<strong>æ¯”å¯¹</strong>15ä¸49ä¹‹é—´çš„<strong>å¤§å°</strong>ï¼›<br>49å¤§äº15ï¼Œæ¥ç€è¿›è¡Œæ¯”å¯¹49ä¸56ï¼›<br>åˆ™49å°äº56ï¼›<br>ç„¶åå†å»æŸ¥æ‰¾æ¯”å¯¹15å’Œ56ä¸­é—´çš„ç´¢å¼•å…ƒç´ ï¼›<br>15å’Œ56ä¸­é—´å­˜æ”¾çš„æ˜¯æŒ‡é’ˆï¼Œ<strong>æŒ‡é’ˆ å­˜æ”¾çš„æ˜¯ ä¸‹ä¸€ä¸ªç´¢å¼•å…ƒç´ </strong>ï¼Œä¹Ÿå°±æ˜¯<strong>ä¸‹ä¸€ä¸ªç»“ç‚¹ æ‰€å¯¹åº”çš„ ç£ç›˜æŒ‡é’ˆ</strong>æ•´ä¸ªæŸ¥è¯¢å‡ºæ¥ï¼›<br>å³<strong>è¯¥æŒ‡é’ˆ æ‰€å¯¹åº”çš„ ç»“ç‚¹æ•°æ® å…¨éƒ¨æ”¾å…¥åˆ° å†…å­˜</strong> å½“ä¸­ï¼›<br>ç„¶åæ”¾åˆ°<strong>å†…å­˜</strong>å½“ä¸­å»è¿›è¡Œ<strong>æ¯”å¯¹å¤§å°</strong>ï¼›<br>ç„¶åæ¥ä¸‹æ¥49ä¸20è¿›è¡Œæ¯”å¯¹ï¼Œ49å¤§äº20ï¼›<br>é‚£ä¹ˆæ¥ç€49ä¸49è¿›è¡Œæ¯”å¯¹ï¼›<br>å°±åˆšå¥½ç›¸ç­‰ï¼›<br>åˆšå¥½æ‰¾åˆ°è¯¥ç´¢å¼•å…ƒç´ äº†ï¼›<br>æ‰¾åˆ°è¯¥ç´¢å¼•å…ƒç´ ä¹‹åï¼Œåˆ™<strong>æ¯ä¸€ä¸ªç´¢å¼•</strong>å½“ä¸­å­˜æ”¾çš„ä¸º<strong>key-value</strong>ï¼›<br><strong>value</strong>å½“ä¸­å³<strong>å­˜å‚¨ç€ è¯¥ç´¢å¼• è¿™ä¸€è¡Œæ•°æ® æ‰€åœ¨çš„ç£ç›˜æ–‡ä»¶ å½“ä¸­çš„ æŒ‡é’ˆ</strong>ï¼›<br>é‚£ä¹ˆæ‹¿åˆ°è¿™ä¸ªdataä¹‹åï¼›<br><strong>ç£ç›˜æ–‡ä»¶æŒ‡é’ˆ</strong>å°±èƒ½å¤Ÿå¿«é€Ÿçš„æ‰¾åˆ°<strong>ç£ç›˜æ–‡ä»¶æ•°æ®</strong>ï¼›<br>å³<strong>èšä¼—ç´¢å¼•</strong>ï¼›  </p><p><strong>MySQLçœŸæ­£çš„åº•å±‚ç´¢å¼•</strong>å¹¶<strong>ä¸æ˜¯ç”¨Bæ ‘</strong>æ¥è¿›è¡Œå®ç°ï¼›<br>è€Œæ˜¯ä½¿ç”¨çš„ä¸€ç§<strong>å˜ç§çš„Bæ ‘</strong>ï¼Œç§°ä¹‹ä¸º<strong>B+æ ‘</strong>ï¼›  </p><h4 id="B-Tree-B-Treeå˜ç§"><a href="#B-Tree-B-Treeå˜ç§" class="headerlink" title="B+Tree(B-Treeå˜ç§)"></a>B+Tree(B-Treeå˜ç§)</h4><p><strong>B+Tree(B-Treeå˜ç§)</strong></p><ul><li><strong>éå¶å­ç»“ç‚¹ ä¸å­˜å‚¨ dataï¼Œåªå­˜å‚¨ keyï¼Œå¯ä»¥ å¢å¤§ åº¦</strong>ï¼›</li><li><strong>å¶å­ç»“ç‚¹ ä¸å­˜å‚¨ æŒ‡é’ˆ</strong>ï¼›</li><li><strong>é¡ºåºè®¿é—® æŒ‡é’ˆï¼Œæé«˜ åŒºé—´ è®¿é—®æ€§èƒ½</strong>ï¼›</li></ul><p>ä»€ä¹ˆå«åš<strong>B+æ ‘</strong>ï¼Œ<strong>B+æ ‘</strong>æ˜¯<strong>Bæ ‘</strong>çš„ä¸€ä¸ª<strong>å˜ç§</strong>ï¼›  </p><p><strong>B+æ ‘</strong> ä¸ <strong>Bæ ‘</strong> çš„ <strong>åŒºåˆ«</strong>ï¼š<br><strong>B+æ ‘</strong>ï¼šæ‰€æœ‰çš„<strong>data</strong>éƒ½<strong>æ”¾åˆ°</strong>äº†<strong>å¶å­ç»“ç‚¹</strong>ä¸Šï¼›<br>è€Œ<strong>éå¶å­ç»“ç‚¹ æ²¡æœ‰</strong>äº†<strong>data</strong>ï¼›<br><strong>B+æ ‘</strong>çš„<strong>å¶å­ç»“ç‚¹</strong>ä¸Šéƒ½æœ‰ä¸€ä¸ª<strong>å³æŒ‡é’ˆ</strong>ï¼›  </p><p><strong>é—®é¢˜</strong>ï¼šä¸ºä»€ä¹ˆ<strong>Bæ ‘</strong>å½“ä¸­<strong>éå¶å­ç»“ç‚¹</strong>ä¸Šçš„<strong>dataå…ƒç´ </strong>éƒ½<strong>ç§»åˆ°</strong>äº†<strong>å¶å­ç»“ç‚¹</strong>ä¸Šå»äº†ï¼›<br><strong>Bæ ‘</strong>å½“ä¸­æ¯ä¸€ä¸ª<strong>å¶å­ç»“ç‚¹</strong>å¹¶<strong>ä¸é‡å¤</strong>ï¼›<br>è€Œ<strong>B+æ ‘</strong>å½“ä¸­ä¸€äº›<strong>å…³é”®çš„ç´¢å¼•</strong>åšäº†<strong>å†—ä½™</strong>ï¼›<br>ä¸å…‰æ˜¯åœ¨<strong>å¶å­ç»“ç‚¹</strong>ä¸Šï¼Œ<strong>éå¶å­ç»“ç‚¹</strong>ä¸Šä¹Ÿåšäº†<strong>å†—ä½™</strong>ï¼›  </p><p><strong>éå¶å­ç»“ç‚¹</strong>ä¸Šä¸ºä»€ä¹ˆ<strong>æ²¡æœ‰dataå…ƒç´ </strong>äº†ï¼Ÿ<br>è¿™ä¹ˆä¸€å­˜çš„è¯ï¼ˆå¶å­ç»“ç‚¹ä¸Šå­˜dataå…ƒç´ ï¼Œéå¶å­ç»“ç‚¹ä¸å­˜dataå…ƒç´ ï¼‰ï¼›<br>é‚£ä¹ˆå°±æ„å‘³ç€æ•´ä¸ª<strong>B+æ ‘</strong>çš„<strong>å¶å­ç»“ç‚¹</strong>å½“ä¸­ï¼›<br>å°±æœ‰äº†æ•°æ®è¡¨çš„<strong>å®Œæ•´çš„ æ‰€æœ‰è¡Œçš„ ç´¢å¼•</strong>ï¼›<br>å› ä¸ºæŠŠ<strong>æ¯ä¸€è¡Œçš„ data éƒ½å¾€ å¶å­ç»“ç‚¹ ä¸Šç§»åŠ¨</strong>ï¼›<br>é‚£ä¹ˆ<strong>æ¯ä¸€è¡Œæ•°æ®</strong>éƒ½å­˜åœ¨æœ‰ä¸€ä¸ª<strong>data çš„ ç£ç›˜æ–‡ä»¶æŒ‡é’ˆ</strong>ï¼›<br>é‚£ä¹Ÿå°±æ„å‘³ç€ï¼›<strong>æ‰€æœ‰çš„è¡Œæ•°æ®</strong>åº”è¯¥åœ¨<strong>å¶å­ç»“ç‚¹</strong>éƒ½æœ‰ä¸€ä»½<strong>å®Œæ•´</strong>ï¼›<br>åªä¸è¿‡æŸä¸€äº›å…³é”®çš„ç´¢å¼•çš„å…ƒç´ ï¼›<br>åœ¨<strong>éå¶å­ç»“ç‚¹ä¸Šåš</strong>äº†ä¸€ä¸ª<strong>å†—ä½™</strong>ï¼›<br>15ã€20ã€49åšäº†å†—ä½™ï¼›<br><strong>æ–¹ä¾¿éå†æ•°æ®</strong>ï¼›<br><strong>ä¸€æ¬¡ç£ç›˜IO å– æ›´å¤šçš„ k</strong>ï¼›  </p><p>å…¶ä¸­<strong>å¸¸è§çš„æ•°æ®ç»“æ„</strong>åœ¨<strong>ä¸åŒåœºæ™¯ä¸‹</strong>çš„<strong>åŒºåˆ«</strong>  </p><p>MySQLå®é™…ä¸Šå¸Œæœ›çš„æ˜¯è¿™ä¸€ä¸ª<strong>ç»“ç‚¹çš„å¤§å°</strong>æ˜¯æœ‰ä¸€ä¸ª<strong>é€‚å½“çš„å¤§å°</strong>ï¼Œ<strong>ä¸èƒ½è®¾ç½®å¤ªå¤§</strong>ï¼›<br>ä¹Ÿå°±æ˜¯è¯´è¿™ä¸€ä¸ª<strong>ç»“ç‚¹çš„å¤§å°</strong>æ˜¯<strong>å­˜åœ¨æœ‰é™åˆ¶</strong>çš„ï¼›<br>æ¯ä¸€ä¸ª<strong>ç»“ç‚¹</strong>å½“ä¸­èƒ½å¤Ÿ<strong>å­˜å‚¨æ›´å°çš„å…ƒç´ </strong>ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿå°±æ„å‘³ç€ï¼›<br>ä¸€ä¸ª<strong>å¤§ç»“ç‚¹</strong>å½“ä¸­é‡Œé¢èƒ½å¤Ÿ<strong>å­˜å‚¨ æ›´å¤šçš„ ç´¢å¼•çš„ key</strong>ï¼›<br>ä¹Ÿå°±æ˜¯è¯´èƒ½å¤Ÿå­˜å‚¨æ›´å¤šçš„ç´¢å¼•å­—æ®µï¼›<br>ä¹Ÿå°±æ„å‘³ç€è¿™ä¸€ä¸ªç»“ç‚¹åœ¨å¤§å°ç›¸åŒçš„æƒ…å†µä¸‹ï¼›<br>æ¯”æ–¹è¯´ï¼Œ<strong>é»˜è®¤ MySQL æŠŠè¿™ä¸ª ç»“ç‚¹çš„å¤§å° è®¾ç½®ä¸º 16k</strong>ï¼›<br>åœ¨è¿™ä¸€ä¸ª<strong>å¤§ç»“ç‚¹</strong>ï¼Œä¸€ä¸ª<strong>å¤§å°å›ºå®šçš„æƒ…å†µ</strong>ä¸‹é¢ï¼›<br>è¿™ä¸€ä¸ª<strong>å¤§ç»“ç‚¹</strong>å½“ä¸­çš„æ¯ä¸€ä¸ª<strong>å°ç»“ç‚¹</strong>å¦‚æœæŠŠ<strong>dataå…ƒç´ </strong>ç§»åŠ¨åˆ°<strong>å¶å­ç»“ç‚¹</strong>ä¸Šå»ï¼›<br>æ˜¯ä¸æ˜¯ä¹Ÿå°±æ„å‘³ç€æ•´ä¸ªè¿™ä¸€ä¸ª<strong>å¤§ç»“ç‚¹</strong>å¯ä»¥<strong>æ¨ªå‘</strong>å¯ä»¥<strong>å­˜å‚¨ æ›´å¤šçš„ ç´¢å¼•å…ƒç´ </strong>ï¼›  </p><p>é‚£ä¹ˆå¦‚æœ<strong>æ¨ªå‘</strong>å¯ä»¥<strong>å­˜å‚¨ æ›´å¤šçš„ ç´¢å¼•å…ƒç´ </strong>ï¼Œé‚£ä¹Ÿå°±æ„å‘³ç€è¿™ä¸ª<strong>æ¨ªå‘ç»“ç‚¹ å‘ä¸‹çš„åˆ†å‰ ä¹Ÿå°± è¶Šå¤š</strong>ï¼›<strong>åˆ†å‰ åˆ†å¾—æ›´å¤š</strong>ï¼Œä¹Ÿå°±è¯´æ˜ï¼Œ<strong>å­˜å‚¨ åŒæ ·å¤§çš„ æ•°æ®é‡ï¼Œæ ‘çš„é«˜åº¦ ä¹Ÿå°± æ›´å°</strong>äº†ï¼›é‚£ä¹ˆ <strong>å¶å­ç»“ç‚¹ ä¹Ÿå°± æ›´å¤§</strong>äº†ï¼›  </p><p>ä¸ºä»€ä¹ˆè¦å°†<strong>dataç§»åŠ¨åˆ°å¶å­ç»“ç‚¹</strong>ä¸Šå»çš„åŸå› å°±åœ¨äºï¼š<strong>éå¶å­ç»“ç‚¹</strong>å½“ä¸­ä¹Ÿå°±å¯ä»¥<strong>æ¨ªå‘å­˜æ”¾æ›´å¤šçš„ç´¢å¼•å…ƒç´ </strong>ï¼›ä»è€Œ<strong>æ ‘çš„é«˜åº¦</strong>ä¹Ÿå°±æ•ˆç‡ï¼Œ<strong>æŸ¥æ‰¾çš„æ•ˆç‡ä¹Ÿå°±æé«˜</strong>äº†ä¸Šæ¥ï¼›  </p><p><strong>MySQL</strong> <strong>é»˜è®¤</strong>æŠŠ<strong>ç»“ç‚¹çš„å¤§å°</strong> <strong>è®¾ç½®</strong>ä¸º <strong>16k</strong>ï¼›  </p><p><strong>SHOW GLOBAL STATUS like â€˜Innodb_page_sizeâ€™;</strong>  </p><table><tr><th>Variable_name</th><th>Value</th></tr><tr><td>Innodb_page_size</td><td>16384</td></tr></table><p>è¯¥sqlè¯­å¥æŸ¥å‡ºæ¥çš„å€¼å®é™…æ˜¯ä¸Šå°±æ˜¯<strong>MySQLåº•å±‚ å­˜å‚¨ ç´¢å¼•å­—æ®µ</strong>ï¼Œ<strong>B+æ ‘</strong>çš„è¿™ä¸ª<strong>å¤§ç»“ç‚¹çš„å¤§å°</strong>ï¼›<br>å½“ç„¶ä¹Ÿå¯ä»¥å»è¿›è¡Œä¿®æ”¹è¯¥å€¼ï¼›<br>ä½†æ˜¯ä¸€èˆ¬å¹¶ä¸æ¨èå»ä¿®æ”¹è¯¥å€¼ï¼›<br><strong>16384ä¸ªå­—èŠ‚</strong>ï¼›<br>å®é™…ä¸Šä¹Ÿå°±ç›¸å½“äºæ˜¯<strong>16kæ•°æ®</strong>ï¼›<br>ä¹Ÿå°±æ˜¯<strong>16kçš„å¤§å°</strong>ï¼›<br>è¿™ä¸ªå¤§å°åœ¨<strong>ç£ç›˜ä¸Š</strong>ä¹Ÿå°±æ˜¯<strong>åˆ†é…çš„ 16k çš„ä¸€ä¸ª ç£ç›˜å¤§å°</strong>ï¼›  </p><p><strong>æ€è€ƒ</strong>ï¼šåˆšåˆšå°†<strong>dataå…ƒç´  æ”¾åˆ° å¶å­ç»“ç‚¹</strong>ä¸Šé¢å»äº†ï¼›<br>ç°åœ¨ç”»çš„æ ‘çš„é«˜åº¦ä¸º3ï¼›<br>æ€è€ƒç°åœ¨<strong>é«˜åº¦ä¸º3</strong>çš„è¯¥æ ‘<strong>ä¸€å…±å¯ä»¥å­˜å‚¨å¤šå°‘ç´¢å¼•å­—æ®µ</strong>ï¼Ÿ  </p><p>å‡è®¾è¯¥ç´¢å¼•å­—æ®µçš„å­—æ®µç±»å‹ä¸º<strong>bigint</strong>ï¼›<br><strong>è¡¨çš„ä¸»é”®/ç´¢å¼•çš„ç±»å‹</strong>ä¸€èˆ¬ä¸º<strong>bigint</strong>ï¼›<br><strong>bigint</strong>åœ¨<strong>MySQL</strong>çš„<strong>åº•å±‚çš„å­˜å‚¨å¤§å°</strong>å¤§æ¦‚ä¸º<strong>8ä¸ªå­—èŠ‚byte</strong>ï¼›  </p><p><strong>å¤§ç»“ç‚¹</strong>å½“ä¸­é™¤äº†<strong>ç´¢å¼•å­—æ®µ</strong> <strong>å æ® n*8 ä¸ªå­—èŠ‚</strong>å¤–ï¼Œè¿˜å­˜åœ¨æœ‰<strong>æŒ‡é’ˆ</strong>ï¼›<br><strong>æŒ‡é’ˆ</strong>åœ¨<strong>MySQLåº•å±‚æºç </strong>ä½¿ç”¨çš„æ˜¯<strong>6ä¸ªå­—èŠ‚byte</strong>æ¥è¿›è¡Œ<strong>å­˜å‚¨</strong>è¿™ä¸ª<strong>æŒ‡é’ˆ</strong>ï¼›<br>è¿™ä¸ª<strong>æŒ‡é’ˆ</strong>è¯´ç™½äº†å°±æ˜¯ <strong>ä¸‹ä¸ªç»“ç‚¹ åœ¨ ç£ç›˜æ–‡ä»¶ ä¸Šçš„ ä¸€ä¸ªåœ°å€</strong>ï¼›  </p><p>ä¹Ÿå°±æ˜¯è¯´è¿™ä¸ª<strong>å¤§ç»“ç‚¹</strong>å½“ä¸­å­˜å‚¨äº†è¿™æ ·ä¸€ä¸ª<strong>å°çš„ç´¢å¼•</strong>ï¼Œä»¥åŠ<strong>ç´¢å¼•æ—è¾¹çš„æŒ‡é’ˆ</strong>ï¼›<br>å·®ä¸å¤šä¹Ÿå°±æ˜¯ <strong>8Byte+6Byte=14Byteï¼ˆä¸€ä¸ªç´¢å¼•+ä¸€ä¸ªæŒ‡é’ˆï¼‰</strong>ï¼›<br>è¿™ä¸€ä¸ª<strong>å¤§ç»“ç‚¹16k</strong>å¤§æ¦‚èƒ½å¤Ÿ<strong>å­˜å‚¨å¤šå°‘ä¸ªç´¢å¼•</strong>ï¼›<br><strong>å…¬å¼ = 16384Byte / ( 8Byte + 6Byte = 14Byte ) = 1,170.285714285714</strong><br>ä¸€ä¸ª<strong>å¤§çš„ç»“ç‚¹</strong>å¯å­˜å‚¨çš„ç´¢å¼•æ•°çº¦ä¸º<strong>1170ä¸ª</strong>ï¼›ä¹Ÿå°±æ˜¯å¤§æ¦‚<strong>1k</strong>çš„æ ·å­ï¼›  </p><p>é‚£ä¹ˆç¬¬äºŒä¸ªç»“ç‚¹ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œ<strong>å­˜å‚¨ 1170 ä¸ªç´¢å¼•æ•°</strong>ï¼›  </p><p>å†è¯´åˆ°<strong>å¶å­ç»“ç‚¹</strong>ï¼›<br>æ‰€æœ‰çš„<strong>dataå…ƒç´  éƒ½æ”¾åˆ° å¶å­ç»“ç‚¹</strong>ï¼›<br>é‚£ä¹ˆ<strong>å¶å­ç»“ç‚¹ å°±ä¼š å˜å¤§</strong>ï¼›<br><strong>æ¯ä¸€ä¸ªå°ç»“ç‚¹</strong>å°±<strong>éƒ½ä¼šå˜å¤§</strong>äº†ç›¸æ¯”ä¹‹å‰æ²¡æœ‰æ”¾dataå…ƒç´ ä¹‹å‰å˜å¤§äº†ï¼›  </p><p>å‡è®¾ä¸€ä¸‹ï¼›<br>å‡è®¾è¿™ä¸ª<strong>å¶å­ç»“ç‚¹</strong>å½“ä¸­çš„<strong>ä¸€ä¸ªå°å¶å­ç»“ç‚¹</strong>ï¼Œä¹Ÿå°±æ˜¯å¯¹åº”çš„è¿™ä¸€è¡Œç´¢å¼•ä»¥åŠè¯¥ç´¢å¼•æ‰€åœ¨çš„è¡Œçš„é‚£ä¸ª<strong>ç£ç›˜æ–‡ä»¶æ–‡ä»¶æŒ‡é’ˆ</strong>æˆ–è€…è¯´<strong>è¿™ä¸€è¡Œçš„å…¶ä»–æ•°æ®</strong>å°±<strong>å­˜å‚¨</strong>åˆ°è¿™ä¸ª<strong>å°ç»“ç‚¹</strong>å½“ä¸­ï¼›<br>å‡è®¾è¿™ä¸ª<strong>å°ç»“ç‚¹</strong>å°±å¤§ä¸€ç‚¹ï¼Œå°±<strong>å­˜å‚¨1kçš„æ•°æ®</strong>ï¼›<br>é‚£ä¹ˆè¿™ä¸€ä¸ªå­˜å‚¨è¯¥å°ç»“ç‚¹çš„å¤§ç»“ç‚¹åŒæ ·æ˜¯<strong>å­˜å‚¨16kçš„æ•°æ®</strong>ï¼›<br>é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯¥<strong>ç»“ç‚¹</strong>æ‰€èƒ½å¤Ÿ<strong>å­˜å‚¨çš„ç´¢å¼•å…ƒç´  ä¸º 16ä¸ª</strong>ï¼›<br>æ•´ä¸ª<strong>å¶å­ç»“ç‚¹</strong>å½“ä¸­å¯ä»¥å®¹çº³å¤šå°‘çš„<strong>ç´¢å¼•å…ƒç´ </strong>ï¼ˆå­˜å‚¨çš„æ‰€æœ‰çš„ç´¢å¼•çš„æ•°å€¼ï¼‰ï¼Ÿ<br><strong>å…¬å¼ï¼šï¼ˆ æ ¹ç»“ç‚¹ä¸Š çš„ 1170 è¿™ä¸€å±‚ ï¼‰1170 * 1170 * 16 = 21,902,400â€¬</strong><br>ç®—å‡ºæ¥çš„è¯¥å€¼å®é™…ä¸Šå°±æ˜¯è¯¥<strong>å¶å­ç»“ç‚¹</strong>ä¸Šæ‰€æœ‰<strong>å¯ä»¥å­˜å‚¨çš„ ç´¢å¼•å…ƒç´ çš„ æ€»å’Œ</strong>ï¼›  </p><p><strong>éå¶å­ç»“ç‚¹ çš„ æ‰€æœ‰çš„ ç´¢å¼•å…ƒç´  * æ¯ä¸€ä¸ªå¶å­ç»“ç‚¹ å¯ä»¥å­˜å‚¨çš„ å¤šå°‘ä¸ª ç´¢å¼•è¡Œæ•°æ®</strong>  </p><p>è¿™ä¸ªç»“æœç®—å‡ºæ¥å·®ä¸å¤šç­‰äºä¸¤åƒå¤šä¸‡ï¼›<br>ä¸¤åƒå¤šä¸‡æ‰€ç®—å‡ºæ¥çš„ä¸œè¥¿ï¼›<br>ä¹Ÿå°±æ„å‘³ç€è¯¥<strong>å¶å­ç»“ç‚¹ èƒ½å¤Ÿæ”¾çš„ æ€»ç´¢å¼•å…ƒç´  ä¸ªæ•°ï¼ˆå°ç´¢å¼•å…ƒç´ +dataå…ƒç´ ï¼‰</strong>å¤§æ¦‚æ˜¯ä¸¤åƒå¤šä¸‡ï¼›ï¼ˆä¹Ÿå°±ç›¸å½“äºæ˜¯ä¸¤åƒå¤šä¸‡æ¡/è¡Œæ•°æ®ï¼‰ï¼›  </p><p>ä½¿ç”¨<strong>B+æ ‘</strong>è¿™ä¹ˆä¸€æ”¹é€ ä¹‹åï¼›<br>å‘ç°<strong>åŒæ ·æ ‘çš„é«˜åº¦</strong>ï¼›<br>é«˜åº¦ä¸º3ï¼›<br>è¯¥<strong>æ ‘</strong>å°±èƒ½å¤Ÿå­˜å‚¨ä¸¤åƒå¤šä¸‡æ¡ä¸ªç´¢å¼•ï¼Œä¹Ÿå°±è¯´æ˜å¯ä»¥æ”¯æ’‘ä¸¤åƒä¸‡è¡Œçš„è¡¨ï¼›<br>å°†è¿™ä¸¤åƒå¤šä¸‡è¡Œæ•°æ®çš„è¡¨å½“ä¸­çš„ä¸€å­—æ®µä½œä¸ºç´¢å¼•å­˜å‚¨åˆ°è¯¥æ•°æ®ç»“æ„å½“ä¸­ï¼Œé‚£ä¹ˆåŒæ ·é«˜åº¦ä¸º3ï¼Œheightä¸º3ï¼ŒæŸ¥æ‰¾ä¸€ä¸ªå…ƒç´ æ¯”æ–¹è¯´æŸ¥æ‰¾50ï¼›<br>é‚£ä¹ˆä»<strong>æ ¹ç»“ç‚¹ å»è¿›è¡Œ åŒ¹é… å¯¹æ¯”</strong>ï¼›<br>ç»è¿‡<strong>é¡ºåºæŸ¥æ‰¾</strong>ï¼›<br>50ä¸çˆ¶èŠ‚ç‚¹/æ ¹ç»“ç‚¹å½“ä¸­çš„15-56å¯¹æ¯”ï¼ŒæŸ¥æ‰¾ä¸­é—´çš„æ•°å€¼å³è¯¥æ ¹ç»“ç‚¹çš„å·¦èŠ‚ç‚¹ï¼›<br>ä¹Ÿå°±æ˜¯å†è·Ÿ15-28-49è¿›è¡Œæ¯”è¾ƒï¼Œå¾—åˆ°50å†å»ä¸è¯¥ç»“ç‚¹çš„ä¸‹ä¸€ç»“ç‚¹æ¯”è¾ƒå³49-50ï¼›<br>æœ€å¤šç»è¿‡ä¸‰æ¬¡<strong>ç£ç›˜IO</strong>ï¼›<br>å°±èƒ½å¤Ÿæ‰¾åˆ°ç´¢è¦æŸ¥æ‰¾å¾—åˆ°çš„å…ƒç´ 50ï¼›<br><strong>æ€§èƒ½ååˆ†é«˜</strong>ï¼›  </p><p>è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆä¸Šåƒä¸‡è¡Œæ•°æ®ï¼›åªè¦<strong>ç´¢å¼•å­—æ®µ</strong>å»ºçš„æ¯”è¾ƒçš„<strong>åˆç†ã€åˆé€‚</strong>ï¼›<br>é‚£ä¹ˆå…¶<strong>ç£ç›˜æŸ¥æ‰¾æ¬¡æ•°</strong>æ˜¯éå¸¸<strong>å°‘</strong>çš„ï¼›  </p><p>ç”¨<strong>B+æ ‘</strong>æ¥è¯´ï¼›å¸¸è§çš„æ•°æ®è¡¨ï¼Œ<strong>æ ‘çš„é«˜åº¦</strong>ä¸€èˆ¬å°±æ§åˆ¶åœ¨<strong>2~4</strong>ä¹‹é—´ï¼›<br>ä¸ç®¡å¦‚ä½•æŸ¥è¯¢ï¼›å³ä½¿æ˜¯<strong>æŸ¥è¯¢åˆ° å¶å­ç»“ç‚¹ çš„ é€Ÿåº¦</strong>ä¹Ÿæ˜¯ååˆ†<strong>å¿«</strong>çš„ï¼›<br>åªéœ€è¦ç»è¿‡å‡ æ¬¡<strong>ç£ç›˜IO</strong>æŸ¥æ‰¾ï¼›  </p><h4 id="HASHè¡¨"><a href="#HASHè¡¨" class="headerlink" title="HASHè¡¨"></a>HASHè¡¨</h4><p><strong>MySQL</strong>çš„<strong>ç´¢å¼•å­—æ®µ</strong>å½“ä¸­å­˜åœ¨æœ‰<strong>ç´¢å¼•æ–¹æ³•</strong>ï¼›<br>ç‚¹å‡»ä¸‹æ‹‰æ¡†è¿›è¡Œé€‰æ‹©ç´¢å¼•æ–¹æ³•ï¼ˆå­˜åœ¨æœ‰ä¸¤ç§å®ç°ï¼šä¸€ç§æ˜¯<strong>BTREE</strong>ï¼›ä¸€ç§æ˜¯<strong>HASH</strong>ï¼‰<br><strong>HASH</strong> ä¹Ÿæ˜¯å®˜æ–¹çš„ä¸€ç§å®ç°ï¼›ä½†æ˜¯ä½¿ç”¨çš„ä¸å¤šï¼›<br>90%ä»¥ä¸Šçš„åœºæ™¯éƒ½æ˜¯ä½¿ç”¨çš„<strong>Bæ ‘</strong>ï¼›<br>ä¸ºä»€ä¹ˆ<strong>ä¸ç”¨ HASHè¡¨ çš„åŸå› </strong>ï¼š<br><strong>HASHè¡¨ å­˜å‚¨ ç´¢å¼• çš„åŸç†</strong>ï¼š<br>æ¯”æ–¹è¯´å°†col1ä½œä¸ºç´¢å¼•å­—æ®µï¼›select * from t where t.col1=4;<br>é€šè¿‡ä¸€ä¸ª<strong>hashç®—æ³•</strong>ï¼Œhashï¼ˆ4ï¼‰ï¼›<br>å¯¹è¯¥4å–äº†ä¸€ä¸ª<strong>HASH</strong>ï¼›<br>å¾—åˆ°çš„è¯¥ç»“æœï¼Œé‚£ä¹ˆè¯¥ç»“æœå°±è·Ÿæ‰€æŸ¥è¯¢çš„where t.col1(4)è¿™ä¸€è¡Œ<strong>æ•°æ®æ‰€åœ¨ç£ç›˜æ–‡ä»¶</strong>æ˜¯æœ‰ä¸€ä¸ª<strong>æ˜ å°„å…³ç³»</strong>çš„ï¼›<br>è¿™å°±æ˜¯<strong>HASHè¡¨</strong>çš„ä¸€ä¸ª<strong>å­˜å‚¨ç»“æ„</strong>ï¼›<br><strong>HASH</strong>å®é™…ä¸Šå°±æ˜¯ä¸€ç§<strong>ç®—æ³•</strong>ï¼›<br>æ¯”è¯´MD5ï¼›MD5å°±æ˜¯ä¸€ç§HASHç®—æ³•ï¼›<br><strong>HASH</strong>å°±æ˜¯å°†<strong>ç´¢å¼•åˆ—</strong> é€šè¿‡ä¸€ç§<strong>HASHç®—æ³•</strong> å°† <strong>ç´¢å¼•åˆ—çš„å€¼ å­˜æ”¾åˆ° HASH è¿™ä¸€ æ•°æ®ç»“æ„ å½“ä¸­å»</strong>ï¼›<br>é‚£ä¹ˆselect * from t where t.col1=6;è¿›è¡ŒæŸ¥æ‰¾è¯¥t.col1=6çš„æ•°æ®è¡Œï¼›<br>çš„HASHæŸ¥æ‰¾å³ä¸ºï¼šå¯¹è¯¥col1=6ï¼›<br>è¯¥6çš„è¯¥<strong>å–å€¼</strong>åšä¸€æ¬¡<strong>HASHç®—æ³• è¿ç®— å¾—åˆ° å®ƒçš„ç»“æœ hash(6)</strong>ï¼›<br>æ ¹æ®è¿™ä¸ªç»“æœï¼›åªéœ€è¦åš<strong>ä¸€æ¬¡æ˜ å°„</strong>å°±èƒ½å¤Ÿ<strong>å¿«é€Ÿçš„å®šä½</strong>åˆ°<strong>è¿™ä¸€è¡Œ æ•°æ® æ‰€åœ¨çš„ æ–‡ä»¶ç£ç›˜æŒ‡é’ˆ</strong>ï¼›<br>é‚£ä¹ˆå³ä¾¿æ˜¯åƒä¸‡çº§åˆ«çš„æ•°æ®ä¹Ÿåªéœ€è¦é€šè¿‡<strong>hash() ä¸€æ¬¡HASHç»“æœ</strong> è¿›è¡Œ <strong>è®¡ç®— å®šä½ å¾—åˆ° ç´¢å¼• æ‰€åœ¨è¡Œ æ•°æ®çš„ æ–‡ä»¶ç£ç›˜æŒ‡é’ˆ</strong> ä¹Ÿæ˜¯èƒ½å¤Ÿå¿«é€Ÿçš„æŸ¥æ‰¾å¾—åˆ°çš„ï¼›<br>æ„Ÿè§‰<strong>HASH</strong>è¡¨æ€§èƒ½æ›´é«˜ï¼Œæ¯”<strong>B+æ ‘</strong>æ•ˆç‡æ›´é«˜ï¼›<br><strong>B+æ ‘</strong>è¿˜è¦ç»è¿‡ä¸¤ä¸‰æ¬¡çš„æ ‘çš„ä¸€ä¸ª<strong>éå†</strong>ï¼›<br>è€Œ<strong>HASH</strong>è¡¨çš„æŸ¥æ‰¾æ„Ÿè§‰æ›´å¿«ï¼›<br>åªéœ€è¦æœ‰è¿™ä¸ªç´¢å¼•å­—æ®µï¼Œèµ°ç´¢å¼•ï¼Œç»è¿‡MYSQLåº•å±‚å®šä¹‰å¥½ç´¢å¼•æ–¹æ³•ä¸º<strong>HASHç®—æ³•</strong>ï¼Œ<strong>åªéœ€è¦ ä¸€æ¬¡HASH è®¡ç®—ç»“æœ å°±èƒ½å¤Ÿæ‹¿åˆ° è¯¥æŸ¥æ‰¾è¡Œ æ•°æ®çš„ æ‰€åœ¨ æ–‡ä»¶ç£ç›˜æŒ‡é’ˆ</strong>ï¼›æ„Ÿè§‰æ€§èƒ½å¾ˆå¿«ï¼›<br>ç”šè‡³åœ¨æ•°æ®é‡æ›´å¤§çš„è¡¨å½“ä¸­è¿›è¡ŒæŸ¥æ‰¾è¡¨å°¾çš„æ•°æ®ï¼Œä¹Ÿåªéœ€è¦ç»è¿‡ä¸€æ¬¡<strong>HASHè®¡ç®—</strong>å°±èƒ½æ‰¾åˆ°<strong>è¯¥è¡Œ æ•°æ® æ‰€åœ¨çš„ ç£ç›˜æ–‡ä»¶æŒ‡é’ˆ</strong>ï¼›  </p><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANXzV2Z6K9IOXoYW6kFdX*NnL.fv6XCleV5BjrQCN4Bw3HvJfkZCF6LFsSX26xC5WuUZwgbGD9vBaj2.Lec10r*m8!/r" alt="ç´¢å¼•"></p><blockquote><p>é‚£ä¹ˆ<strong>ä¸ºä»€ä¹ˆ MySQL ä¸€èˆ¬ç”¨ Bæ ‘ è€Œä¸ç”¨ HASHè¡¨</strong> å‘¢ï¼Ÿ  </p></blockquote><p><strong>ï¼ˆ1ï¼‰</strong> <strong>èŒƒå›´æŸ¥æ‰¾å¤ªæ…¢</strong>ï¼›<br>      æ¯”å¦‚è¯´select * from t where t.col1&gt;6;<br>      é‚£ä¹ˆå½“è¿™ç§æƒ…å†µä¸‹ï¼›<br>      å¦‚æœcol1<strong>å¤§äº</strong>çš„æ•°å€¼ï¼Œæç«¯æ¥æƒ³çš„è¯ï¼Œä¹Ÿå°±ç›¸å½“äºæ˜¯<strong>å…¨è¡¨æ‰«æ</strong>äº†ï¼›  </p><p><strong>ï¼ˆ2ï¼‰</strong> <strong>HASH</strong>åªç”¨äº<strong>èŒƒå›´æŸ¥æ‰¾å¾ˆå°‘çš„æƒ…å†µ</strong>ä¸‹æ‰è¿›è¡Œä½¿ç”¨ï¼›<br>      é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ç´¢å¼•ä½¿ç”¨HASHæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼›<br>      è€Œæ­£å¸¸æƒ…å†µä¸‹ä¸€èˆ¬éƒ½ä¼šè¦ä½¿ç”¨å¾—åˆ°<strong>èŒƒå›´æŸ¥æ‰¾</strong> ,<br>      æ‰€ä»¥è¿™ä¸ªæ—¶å€™ä½¿ç”¨<strong>B Treeæ›´ä½³</strong>ï¼›  </p><p><strong>ï¼ˆ3ï¼‰</strong> å›åˆ°é—®é¢˜ï¼šä¸ºä»€ä¹ˆ<strong>InnoDB çš„ ä¸»é”®ç´¢å¼• çš„ å¶å­ç»“ç‚¹ ä¸Š å­˜åœ¨æœ‰ æŒ‡é’ˆï¼ˆå³æŒ‡é’ˆï¼‰</strong>ï¼Ÿ<br>      åœ¨<strong>ç»´æŠ¤B+æ ‘</strong>çš„æ—¶å€™ï¼Œæ¯”æ–¹è¯´<strong>å¶å­ç»“ç‚¹</strong>çš„<strong>æœ€åä¸€ä¸ªç»“ç‚¹</strong> <strong>æ»¡äº†</strong>ï¼Œé‚£ä¹ˆå°±éœ€è¦<strong>å¼€è¾Ÿ ä¸€ä¸ª æ–°çš„ ç»“ç‚¹ï¼ˆä¸‹ä¸€ä¸ªç»“ç‚¹ï¼‰</strong> æ¥è¿›è¡Œ<strong>å­˜å‚¨ æ–°çš„ ç´¢å¼•å…ƒç´ </strong>ï¼›<br>      é‚£ä¹ˆå°±å°†<strong>å‰é¢é‚£ä¸ªç»“ç‚¹</strong><br>      ï¼ˆä¹Ÿå°±æ˜¯ä¹‹å‰å¶å­ç»“ç‚¹çš„æœ€åä¸€ä¸ªç»“ç‚¹æ»¡äº†çš„é‚£ä¸ªç»“ç‚¹ï¼‰<br>      ä¸­é—´<strong>å¼€è¾Ÿ ä¸€ä¸ª å°å°çš„ å…ƒç´ ç©ºé—´</strong>ï¼›<br>      æŠŠ<strong>ä¸‹ä¸€ä¸ª æ–°å¼€è¾Ÿçš„ è¿™ä¸€ä¸ªç»“ç‚¹çš„ ç£ç›˜æ–‡ä»¶åœ°å€çš„ æŒ‡é’ˆ å­˜æ”¾åˆ° è¯¥æ–°å¼€è¾Ÿçš„ç»“ç‚¹çš„ ä¸Šä¸€ä¸ªç»“ç‚¹çš„ é‚£ä¸ª å°å…ƒç´ ç©ºé—´ å½“ä¸­å»</strong>ï¼›<br>      ä¹Ÿå°±è¯´ç™½äº†ï¼›<br>      è¯¥<strong>æ–°å¼€è¾Ÿçš„ç»“ç‚¹ çš„ ä¸Šä¸€ç»“ç‚¹ æœ‰ä¸€ä¸ª æŒ‡é’ˆ</strong>ï¼Œ<strong>æŒ‡å‘ äº† ä¸‹ä¸€ç»“ç‚¹</strong>ï¼Œä¹Ÿå°±æ˜¯<strong>è¯¥æ–°å¼€è¾Ÿçš„ ç»“ç‚¹ çš„ ç£ç›˜æ–‡ä»¶æŒ‡é’ˆ</strong>ï¼›<br>      é€šè¿‡æœ‰äº†è¿™ä¸ª<strong>æŒ‡é’ˆ</strong>ï¼›<br>      å†è”æƒ³<strong>HASH</strong>è¡¨çš„<strong>èŒƒå›´æŸ¥æ‰¾</strong>è¿›è¡Œæ€è€ƒï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯è¯´æ˜è¯¥æŒ‡é’ˆå°±èƒ½å¤Ÿå¸®å¿™è§£å†³å¾ˆå¤§çš„é—®é¢˜ï¼›<br>      æ¯”æ–¹è¯´ï¼šæŸ¥æ‰¾ç´¢å¼•å­—æ®µå–å€¼col1<strong>å¤§äº</strong>20å–å€¼çš„è®°å½•ï¼›<br>      ä»<strong>B+ æ ‘çš„ç´¢å¼•</strong>æ‰¾åˆ°è¯¥20çš„è¿™ä¸€ä¸ªå…ƒç´ ï¼›<br>      å› ä¸º<strong>æ•´ä¸ª å¶å­ç»“ç‚¹çš„ ç´¢å¼•å…ƒç´ </strong>éƒ½æ˜¯<strong>ä»å·¦åˆ°å³ ä¾æ¬¡ é€’å¢å½¢å¼</strong> çš„ï¼›<br>      é€šè¿‡è¿™ä¸ªï¼ˆå³ï¼‰æŒ‡é’ˆé¡ºè—¤æ‘¸ç“œçš„å½¢å¼<br>      ï¼ˆå…¶å®è¿™é‡Œå½¢æˆäº†ä¸€ä¸ª<strong>åŒå‘æŒ‡é’ˆ</strong>ï¼ŒæŸ¥è¯¢å³å°äº20çš„å…ƒç´ ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼›<strong>åŒå‘é“¾è¡¨</strong>ï¼‰ï¼Œ<br>      é€šè¿‡<strong>æŒ‡é’ˆ</strong>å°±èƒ½å¤Ÿæ‰¾åˆ°å¤§äº20ï¼Œä¹Ÿå°±æ˜¯20è¿™ä¸ªç´¢å¼•å…ƒç´ åé¢çš„<strong>æ‰€æœ‰ç´¢å¼•å…ƒç´ ç»“ç‚¹</strong>ï¼›<br>      æœ€åæ”¾åˆ°ä¸€ä¸ª<strong>å¤§çš„é›†åˆ</strong>å½“ä¸­å»ï¼›ä¹Ÿå°±æ˜¯è¿™æ¡sqlè¯­å¥æ‰€è¦è¿”å›çš„<strong>ç»“æœé›†åˆ</strong>ï¼›  </p><blockquote><p><strong>B+æ ‘</strong>çš„<strong>ä¸¤ä¸ªç‰¹æ€§</strong>ï¼š  </p></blockquote><p><strong>ï¼ˆ1ï¼‰</strong> ä¸ºäº†è®©<strong>éå¶å­ç»“ç‚¹</strong>èƒ½å¤Ÿ<strong>å­˜å‚¨æ›´å¤šçš„ç´¢å¼•</strong>ï¼›<br>          ä»è€Œ<strong>å¶å­ç»“ç‚¹ä¸Š</strong>é™¤äº†<strong>ç´¢å¼•å…ƒç´ </strong>è¿˜å­˜åœ¨æœ‰<strong>dataå…ƒç´ </strong>ï¼›  </p><p><strong>ï¼ˆ2ï¼‰</strong> åœ¨<strong>å¶å­ç»“ç‚¹ ç´¢å¼•å…ƒç´ </strong>ä¹‹é—´è¿˜å­˜åœ¨æœ‰ä¸€ä¸ª<strong>æŒ‡é’ˆ</strong> <strong>æŒ‡å‘ ä¸‹ä¸€ ç´¢å¼•å…ƒç´  ç»“ç‚¹ çš„ åœ°å€</strong>ï¼›<br>å­˜åœ¨æœ‰ä¸€ä¸ª<strong>åŒå‘ çš„ æŒ‡é’ˆ</strong>ï¼›<br>ä¹Ÿå°±æ˜¯ä¸ºäº†<strong>è§£å†³</strong>å¦‚ä½•<strong>é«˜æ•ˆçš„ è¿›è¡Œ èŒƒå›´æŸ¥æ‰¾</strong>çš„è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼›<br>æ‰€ä»¥<strong>é«˜æ•ˆçš„ èŒƒå›´æŸ¥æ‰¾</strong>ä¹Ÿæ˜¯<strong>å¯ä»¥</strong>è¿›è¡Œ<strong>èµ°ç´¢å¼•</strong>çš„ï¼›<br>åœ¨æŸç§æƒ…å†µä¸‹ï¼Œ<strong>èŒƒå›´æŸ¥æ‰¾</strong>ä¹Ÿæ˜¯<strong>å¯ä»¥èµ°ç´¢å¼•</strong>çš„ï¼›<br>ï¼ˆå› ä¸º<strong>å­˜åœ¨æŒ‡é’ˆ</strong>ï¼Œ<strong>å­˜åœ¨ é¡ºåºé€’å¢ é¡ºåºé€’å‡</strong> çš„è¿™æ ·ä¸€ä¸ªç»“æ„ï¼Œé‚£ä¹ˆåˆ™è‚¯å®šæ˜¯<strong>å¯ä»¥èµ° ç›¸å…³çš„ç´¢å¼•</strong> çš„ï¼‰  </p><h5 id="B-Treeç´¢å¼•çš„æ€§èƒ½åˆ†æ"><a href="#B-Treeç´¢å¼•çš„æ€§èƒ½åˆ†æ" class="headerlink" title="B+Treeç´¢å¼•çš„æ€§èƒ½åˆ†æ"></a>B+Treeç´¢å¼•çš„æ€§èƒ½åˆ†æ</h5><ul><li>ä¸€èˆ¬ä½¿ç”¨ <strong>ç£ç›˜I/Oæ¬¡æ•°</strong> è¯„ä»·<strong>ç´¢å¼•ç»“æ„çš„ä¼˜åŠ£</strong></li><li><strong>é¢„è¯»</strong>ï¼š<strong>ç£ç›˜</strong>ä¸€èˆ¬ä¼š<strong>é¡ºåºå‘å</strong> <strong>è¯»å–</strong> <strong>ä¸€å®šé•¿åº¦ çš„ æ•°æ®ï¼ˆé¡µçš„ æ•´æ•°å€ï¼‰ æ”¾å…¥ å†…å­˜</strong></li><li><strong>å±€éƒ¨æ€§åŸç†</strong>ï¼šå½“ä¸€ä¸ª<strong>æ•°æ®è¢«ç”¨åˆ°</strong>æ—¶ï¼Œå…¶<strong>é™„è¿‘çš„æ•°æ®</strong>ä¹Ÿ<strong>é€šå¸¸</strong>ä¼šé©¬ä¸Š<strong>è¢«ä½¿ç”¨</strong>ï¼›</li><li><strong>B+Treeç»“ç‚¹ çš„ å¤§å°</strong>è®¾ä¸ºç­‰äº<strong>ä¸€ä¸ªé¡µ</strong>ï¼Œæ¯æ¬¡<strong>æ–°å»ºç»“ç‚¹</strong>ç›´æ¥<strong>ç”³è¯· ä¸€ä¸ªé¡µ çš„ ç©ºé—´</strong>ï¼Œè¿™æ ·å°±ä¿è¯<strong>ä¸€ä¸ªç»“ç‚¹ ç‰©ç†ä¸Š ä¹Ÿå­˜å‚¨åœ¨ ä¸€ä¸ªé¡µ é‡Œ</strong>ï¼Œå°±å®ç°äº†<strong>ä¸€ä¸ªç»“ç‚¹ çš„ è½½å…¥ åªéœ€ ä¸€æ¬¡ I/O</strong>ã€‚</li><li><strong>B+Tree</strong>çš„<strong>åº¦d</strong>ä¸€èˆ¬ä¼šè¶…è¿‡100ï¼›å› æ­¤<strong>héå¸¸å°</strong>ï¼ˆ<strong>ä¸€èˆ¬ä¸º1~3ä¹‹é—´</strong>ï¼‰  </li><li>ä¸€èˆ¬<strong>æ“ä½œç³»ç»Ÿ</strong>çš„<strong>æœ€å° å­˜å‚¨å•å…ƒ ä¸º é¡µ</strong>ï¼Œ<strong>1é¡µ å¤§å°ä¸º 4k</strong>ï¼›  </li><li>æŸ¥çœ‹<strong>Mysql æ–‡ä»¶é¡µ å¤§å°ï¼ˆ16kï¼‰</strong>: <strong>SHOW GLOBAL STATUS like â€˜Innodb_page_sizeâ€™;</strong>  </li></ul><h5 id="ä¸ºä»€ä¹ˆMySQLé¡µæ–‡ä»¶é»˜è®¤ä¸º16k"><a href="#ä¸ºä»€ä¹ˆMySQLé¡µæ–‡ä»¶é»˜è®¤ä¸º16k" class="headerlink" title="ä¸ºä»€ä¹ˆMySQLé¡µæ–‡ä»¶é»˜è®¤ä¸º16k"></a>ä¸ºä»€ä¹ˆMySQLé¡µæ–‡ä»¶é»˜è®¤ä¸º16k</h5><p>å‡è®¾ä¸€è¡Œæ•°æ®å¤§å°ä¸º1kï¼›<br>é‚£ä¹ˆä¸€é¡µå°±èƒ½å¤Ÿå­˜16æ¡æ•°æ®ï¼›<br>ä¹Ÿå°±æ˜¯ä¸€ä¸ªå¶å­ç»“ç‚¹èƒ½å¤Ÿå­˜16æ¡æ•°æ®ï¼›<br>å†çœ‹éå¶å­ç»“ç‚¹ï¼Œå‡è®¾ä¸»é”®IDä¸ºbigintç±»å‹ï¼Œé‚£ä¹ˆé•¿åº¦ä¸º8Bï¼ŒæŒ‡é’ˆå¤§å°åœ¨InnoDBæºç ä¸­ä¸º6Bï¼Œä¸€å…±å°±æ˜¯14Bï¼Œé‚£ä¹ˆä¸€é¡µé‡Œå°±å¯ä»¥å­˜å‚¨16k/14=1170ä¸ªï¼ˆä¸»é”®+æŒ‡é’ˆï¼‰<br>é‚£ä¹ˆä¸€æ£µé«˜åº¦ä¸º2çš„B+æ ‘èƒ½å­˜å‚¨çš„æ•°æ®ä¸º1170<em>16=18720æ¡ï¼Œä¸€æ£µé«˜åº¦ä¸º3çš„B+æ ‘èƒ½å­˜å‚¨çš„æ•°æ®ä¸º1170</em>1170*16=21902400ï¼ˆåƒä¸‡çº§æ¡ï¼‰  </p><h3 id="ç´¢å¼•åº•å±‚æ•°æ®ç»“æ„ä¸ç®—æ³•"><a href="#ç´¢å¼•åº•å±‚æ•°æ®ç»“æ„ä¸ç®—æ³•" class="headerlink" title="ç´¢å¼•åº•å±‚æ•°æ®ç»“æ„ä¸ç®—æ³•"></a>ç´¢å¼•åº•å±‚æ•°æ®ç»“æ„ä¸ç®—æ³•</h3><h3 id="InnoDBä¸MyISAMç´¢å¼•åŒºåˆ«"><a href="#InnoDBä¸MyISAMç´¢å¼•åŒºåˆ«" class="headerlink" title="InnoDBä¸MyISAMç´¢å¼•åŒºåˆ«"></a>InnoDBä¸MyISAMç´¢å¼•åŒºåˆ«</h3><p><strong>InnoDBå½¢å®¹è¡¨</strong>è¿˜æ˜¯å½¢å®¹æ•°æ®åº“ï¼Ÿ<br><strong>InnoDBä»¥åŠMyISAMå­˜å‚¨å¼•æ“</strong>æ˜¯ç”¨æ¥<strong>å½¢å®¹æ•°æ®è¡¨</strong>çš„ï¼›  </p><p>å½“åœ¨è®¾è®¡è¡¨æ—¶ï¼Œåœ¨é€‰é¡¹å½“ä¸­æœ‰å¼•æ“é€‰é¡¹å­˜åœ¨æœ‰ï¼šARCHIVEã€BLACKHOLEã€CSVã€InnoDBã€MEMORYã€MRG MYISAMã€MyISAMã€PERFORMANCE SCHEMAâ€¦ç­‰ç­‰ï¼›  </p><p><strong>å­˜å‚¨å¼•æ“æ˜¯å½¢å®¹è¡¨</strong>çš„ï¼Œæœ€<strong>å¸¸è§çš„å­˜å‚¨å¼•æ“</strong>å³<strong>InnoDB</strong>ä»¥åŠ<strong>MyISAM</strong>è¿™ä¸¤ç§<strong>å­˜å‚¨å¼•æ“</strong>ï¼›<br><strong>ç”¨çš„æ¯”è¾ƒå¤šçš„ ä¸º InnoDB è¯¥ å­˜å‚¨å¼•æ“</strong>ï¼›  </p><p><strong>ä¸åŒè¡¨ ä¸åŒå­˜å‚¨å¼•æ“ åº•å±‚çš„æ•°æ®ç»“æ„ åŒºåˆ«</strong>ï¼š  </p><p>testæ•°æ®åº“å¯¹åº”éƒ½æ˜¯å­˜å‚¨åœ¨æœ¬åœ°ç£ç›˜ä¸Šçš„ï¼›<br>ä»¥æ•°æ®åº“åå‘½åçš„ç£ç›˜æ–‡ä»¶å¤¹ä¸‹ï¼›  </p><p><strong>è¡¨ = è¡¨ç»“æ„ + æ•°æ® + ç´¢å¼•</strong>  </p><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANX8IZB7poXY4Ed7**8BhOfVx.BLlNb39BqBwC.ebBPiVr7.bXbWAXqMbGapRUkOP8BwmJQWBxopXJj*htdZrocUE!/r" alt="ç´¢å¼•"></p><p><strong>InnoDB</strong>:<br>test.innodb.lock <strong>.frm</strong> - <strong>è¡¨ç»“æ„ç­‰ç›¸å…³ä¿¡æ¯å­˜å‚¨æ–‡ä»¶</strong><br>test.innodb.lock <strong>.ibd</strong> - <strong>è¡¨æ•°æ® + è¡¨ç´¢å¼•ç»“æ„</strong>  </p><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANX*r9r8zOgb4r0dv8mg9Q5qMyppmh2cPcvbiy6hMFV9ap4rR0IrTk.u5U5HvIcDcxnTh0*XJn4IhWeLwxBiXTkPg!/r" alt="ç´¢å¼•"></p><p><strong>InnoDB</strong>çš„è¡¨æœ‰ä¸€ä¸ª<strong>ä¸»é”®</strong>ï¼Œè¯¥<strong>ä¸»é”®è‡ªå¸¦ç´¢å¼•</strong>ï¼›<br><strong>ä¸»é”®ç´¢å¼•</strong>åœ¨<strong>InnoDBå­˜å‚¨å¼•æ“</strong>ä¸‹å¦‚ä½•å­˜å‚¨ï¼›<br>InnoDBçš„è¿™ç§æ–‡ä»¶å­˜å‚¨æ–¹å¼ï¼ŒMySQLå®˜æ–¹åœ¨å¼€å‘çš„æ—¶å€™ï¼Œ<br><strong>InnoDBå½“ä¸­çš„ä¸»é”®ç´¢å¼•</strong>ä»¥åŠ<strong>è¡¨å½“ä¸­çš„æ‰€æœ‰æ•°æ®</strong>å…¨éƒ¨å­˜å‚¨åŒä¸€ä¸ªæ–‡ä»¶ï¼Œ<br>å«åš<strong>åç¼€ä¸ºibdçš„æ–‡ä»¶</strong>å½“ä¸­ï¼›  </p><p><strong>InnoDBå­˜å‚¨æ–¹å¼</strong>å½“ä¸­çš„<strong>å¶å­ç»“ç‚¹å½“ä¸­çš„çš„dataå…ƒç´  æ‰€è¡¨ç¤ºçš„å†…å®¹</strong><br>ä¸<br><strong>MyISAMå­˜å‚¨æ–¹å¼</strong>å½“ä¸­<strong>å¶å­ç»“ç‚¹å½“ä¸­çš„dataå…ƒç´ </strong> æ‰€ <strong>è¡¨ç¤ºçš„å†…å®¹ä¸ä¸€è‡´</strong>ï¼›</p><p><strong>ç´¢å¼•ç»“æ„æœ‰ç‚¹åŒºåˆ«</strong>ï¼›</p><p><strong>MyISAM å¶å­ç»“ç‚¹çš„ dataå…ƒç´ </strong>å½“ä¸­æ‰€å­˜ä¸º<strong>ç´¢å¼• æ‰€åœ¨è¡Œçš„ è¡Œæ•°æ®çš„ ç£ç›˜æ–‡ä»¶æŒ‡é’ˆ</strong>ï¼›<br>ä½†æ˜¯å‘ç°<strong>InnoDBçš„ä¸»é”®ç´¢å¼•</strong>ï¼Œå®ƒçš„<strong>å¶å­ç»“ç‚¹ å½“ä¸­çš„ dataå…ƒç´ </strong>å½“ä¸­æ‰€ å­˜å‚¨çš„ ä¸º <strong>ç´¢å¼•æ‰€åœ¨è¡Œ çš„ å…¶ä»–æ‰€æœ‰åˆ—çš„ æ•°æ®</strong>ï¼›<br><strong>è¿™ä¸€è¡Œçš„ æ‰€æœ‰åˆ—æ•°æ® å…¨éƒ¨å­˜å‚¨åˆ° è¯¥dataå…ƒç´  å½“ä¸­å»</strong>ï¼›<br>ä¹Ÿå°±æ˜¯è¯´åœ¨<strong>InnoDB</strong>å½“ä¸­ï¼Œé€šè¿‡ä¸€æ¡sqlè¯­å¥ï¼Œå¸¦æœ‰whereæŸ¥è¯¢é€šè¿‡ç´¢å¼•è¿›è¡ŒæŸ¥è¯¢çš„sqlè¯­å¥ï¼›<br><strong>åªéœ€è¦æŸ¥æ‰¾ä¸€ä¸ªæ–‡ä»¶</strong>ï¼Œä»è¿™ä¸ª<strong>ibdæ–‡ä»¶</strong>å½“ä¸­<strong>ä¸€æ¬¡æ€§ å®šä½åˆ° ç´¢å¼•å…ƒç´ </strong>ï¼Œå¿«é€Ÿçš„å°±èƒ½æ ¹æ®dataå…ƒç´ ï¼Œè¿™ä¸ªç´¢å¼•æ‰€åœ¨è¡Œçš„å…¶ä»–çš„æ‰€æœ‰å­—æ®µï¼Œå°†è¯¥è¡Œçš„æ‰€æœ‰å­—æ®µè¿›è¡ŒæŸ¥è¯¢å‡ºæ¥<strong>æ”¾å…¥å†…å­˜</strong>å½“ä¸­å»ï¼›<br>å°±æŸ¥æ‰¾åˆ°äº†æ‰€éœ€è¦æŸ¥æ‰¾çš„å…ƒç´ ï¼›ç›¸å¯¹æ¥è¯´<strong>æ€§èƒ½</strong>åº”è¯¥è¦<strong>æ¯” MyISAMå­˜å‚¨å¼•æ“çš„ æ€§èƒ½</strong>ä¼š<strong>é«˜ä¸€ç‚¹</strong>ï¼›  </p><p><strong>InnoDBä¸MyISAMçš„åº•å±‚å­˜å‚¨</strong>æ˜¯ç¨å¾®æœ‰äº›<strong>åŒºåˆ«</strong>çš„ï¼›  </p><p><strong>MyISAM</strong>ï¼š<br>test.myisam <strong>.frm</strong> - è¯¥æ–‡ä»¶å­˜å‚¨å¯¹<strong>è¡¨çš„è¡¨ç»“æ„ä¸€äº›å®šä¹‰</strong>çš„ä¸€äº›æ•°æ®ï¼›<br>test.myisam <strong>.MYD</strong> - å®é™…ä¸Šå­˜å‚¨çš„ä¸º<strong>è¡¨çš„æ•°æ®</strong>ï¼Œ<strong>Dè‹±æ–‡å•è¯dataçš„ç®€å†™</strong>ï¼ˆè¯¥è¡¨å½“ä¸­æ‰€æœ‰çš„æ•°æ®è¡Œï¼‰ï¼›<br>test.myisam <strong>.MYI</strong> - è¯¥è¡¨<strong>æ‰€å¯¹åº”çš„ç´¢å¼•å­—æ®µå­˜å‚¨çš„ä½ç½®</strong>ï¼›  </p><p><strong>ä¸»é”®è‡ªå¸¦ä¸»é”®ç´¢å¼•</strong>ï¼›<br><strong>ç´¢å¼•</strong>ï¼Œå®ƒæ˜¯ä¸€ä¸ª<strong>æ•°æ®ç»“æ„</strong>ï¼Œ<strong>æ•°æ®ç»“æ„</strong>å®é™…ä¸Šå­˜å‚¨åœ¨<strong>MYIæ–‡ä»¶</strong>å½“ä¸­ï¼›<br><strong>Iå³ä¸ºIndexé¦–å­—æ¯çš„ç®€å†™</strong>ï¼›  </p><p><strong>MyISAMåº•å±‚</strong>ä¹Ÿä¸º<strong>B+æ ‘æ•°æ®ç»“æ„</strong>è¿›è¡Œ<strong>å­˜å‚¨</strong>ï¼›<br><strong>MyISAMç´¢å¼•åº•å±‚å­˜å‚¨</strong>ï¼Œå¦‚ä½•è¿›è¡Œå­˜å‚¨ï¼š  </p><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANX8sBSc*PWI*GgGhWe3pcWW625GV21FTGHFPkQrnPSFTCe3vCEKM3QCpTupcvYLjHH7f2N4y0qI7TTFDwZaL9fXc!/r" alt="ç´¢å¼•"></p><p>col1æ˜¯ä½œä¸ºè¡¨çš„<strong>ä¸»é”®ç´¢å¼•</strong>ï¼›<br>å› ä¸ºæ”¯æŒ<strong>äºŒå‰æŸ¥æ‰¾</strong>ï¼Œæ‰€ä»¥åƒ15ã€20ã€49è¿™ç§å¤„äºåœ¨ä¸­é—´çš„è¿™äº›ä¸ªæ•°æ®å°†è¢«ä½œä¸º<strong>å†—ä½™å­—æ®µ</strong>ï¼›<br>å°±æ›´å¯ä»¥<strong>åŒºåˆ†æŸ¥æ‰¾æ•°æ®</strong>ï¼›<br>åƒäºŒå‰æŠ˜åŠæŸ¥æ‰¾ç­‰ï¼›<br>ä¸€èˆ¬å–ä¸­é—´çš„å…ƒç´ ä½œä¸º<strong>å†—ä½™çš„ç´¢å¼•</strong>ï¼›<br><strong>å¿«é€Ÿçš„è¿‡æ»¤</strong>ä¸€äº›<strong>æ•°æ®</strong>ï¼›<br><strong>å‡å°‘æŸ¥æ‰¾æ¬¡æ•°</strong>ï¼›<br>å°†col1è¯¥å­—æ®µåˆ—å½“ä¸­çš„æ‰€æœ‰æ•°æ®æ”¾å…¥åˆ°æ•°æ®ç»“æ„å½“ä¸­å»ï¼›ç„¶åçœ‹ï¼›<br>åŸæ¥åœ¨å¶å­ç»“ç‚¹å½“ä¸­å­˜å‚¨çš„dataå…ƒç´ ï¼Œdataå…ƒç´ å­˜å‚¨çš„å³<strong>è¯¥ç´¢å¼• æ‰€åœ¨è¡Œçš„ è¡Œæ•°æ®çš„ ç£ç›˜æ–‡ä»¶æŒ‡é’ˆ</strong>ï¼›ï¼ˆåœ°å€æŒ‡é’ˆï¼Œ16è¿›åˆ¶çš„å€¼ï¼‰  </p><p>select * from t where t.col1=49;<br>col1<strong>ä¸»é”®ç´¢å¼•</strong>ï¼›<br><strong>MySQLåº•å±‚</strong>å®é™…ä¸Šå…ˆä¼šå»åˆ°<strong>MYIæ–‡ä»¶</strong>å½“ä¸­ï¼›<br>å› ä¸º<strong>ç´¢å¼•ï¼ˆæ•°æ®ç»“æ„ï¼‰</strong>å­˜å‚¨åœ¨<strong>MYIç´¢å¼•æ–‡ä»¶</strong>å½“ä¸­ï¼›<br>å…ˆæ‹¿col1=49åœ¨MYIæ–‡ä»¶å½“ä¸­å¿«é€Ÿåœ°å®šä½åˆ°ç»“ç‚¹ä¸º49çš„ç»“ç‚¹ï¼›<br>æ ¹æ®<strong>B+æ ‘çš„ç‰¹æ€§</strong>ï¼›<br>å…ˆ<strong>ä»æ ¹ç»“ç‚¹ å»è¿›è¡Œ å®šä½</strong>ï¼›<br>æ ¹ç»“ç‚¹å½“ä¸­çš„æ•°æ®é€šè¿‡<strong>ä¸€æ¬¡ç£ç›˜IO</strong>ï¼Œæ ¹ç»“ç‚¹å½“ä¸­çš„ç´¢å¼•å…ƒç´ å°†ä¼šè¢«<strong>æ”¾åˆ°å†…å­˜</strong>å½“ä¸­ï¼Œ49å°†ä¼šåœ¨<strong>å†…å­˜</strong>å½“ä¸­ä¸15-56-77ç›¸è¿›è¡Œ<strong>æ¯”è¾ƒ</strong>ï¼›<br>å¾—åˆ°49åœ¨15-56ä¹‹é—´ï¼›<br>49å°±å°†èµ°15ä¸56ä¸­é—´çš„å‘ä¸‹çš„æŒ‡é’ˆï¼Œå·¦èŠ‚ç‚¹ä¹Ÿå°±æ˜¯å­˜æ”¾æœ‰15-20-49è¿™ä¸‰ä¸ªç´¢å¼•å…ƒç´ çš„è¯¥ç»“ç‚¹ä¸­ï¼Œé‚£ä¹ˆæ­¤æ—¶å·¦èŠ‚ç‚¹å½“ä¸­çš„ç´¢å¼•å…ƒç´ å°†ä¼šè¿›è¡Œç¬¬äºŒæ¬¡ç£ç›˜IOçš„æ“ä½œï¼Œå°†<strong>å·¦èŠ‚ç‚¹å½“ä¸­çš„ç´¢å¼•å…ƒç´ æ”¾åˆ°å†…å­˜å½“ä¸­</strong>å»ï¼Œä¸æŸ¥è¯¢çš„æ•°æ®49ç›¸è¿›è¡Œ<strong>æ¯”è¾ƒ</strong>ï¼›<br>å¾—åˆ°49åœ¨åŒºé—´20-49ä¹‹é—´ï¼›<br>æœ€ååˆ°äº†<strong>å¶å­ç»“ç‚¹</strong>ï¼Œè¯¥å¶å­ç»“ç‚¹å½“ä¸­åŒ…æ‹¬ä¸¤ä¸ªå°ç»“ç‚¹49-50ä»¥åŠ2ä¸ªdataå…ƒç´ ï¼ˆæŒ‡é’ˆï¼‰ï¼Œé‚£ä¹ˆ<strong>ç¬¬ä¸‰æ¬¡ç£ç›˜IO</strong>æ—¶ï¼Œå°†49-50è¯¥å¶å­ç»“ç‚¹<strong>æ”¾åˆ°å†…å­˜å½“ä¸­å»</strong>ï¼Œ49å°±å°†ä¸49-50ç›¸è¿›è¡Œæ¯”è¾ƒå¾—åˆ°49ï¼Œè¯¥49å³ä¸ºè¦æŸ¥æ‰¾çš„å…ƒç´ ï¼›<br>49è¯¥å°ç»“ç‚¹å½“ä¸­æ‰€å¯¹åº”çš„dataå…ƒç´ æ‹¿å‡ºæ¥ï¼Œè¯¥dataå…ƒç´ å¯¹äº<strong>MyISAMå­˜å‚¨å¼•æ“</strong>æ¥è¯´<strong>dataå…ƒç´  å­˜å‚¨çš„æ˜¯ ä¸º è¯¥ç´¢å¼• æ‰€åœ¨è¡Œçš„ è¡Œæ•°æ®çš„ ç£ç›˜æ–‡ä»¶æŒ‡é’ˆ</strong>ï¼›<br>å½“æ‹¿åˆ°è·å–å¾—åˆ°è¯¥<strong>æŒ‡é’ˆ</strong>ä¹‹åå°±å°†åˆ°<strong>MYDæ–‡ä»¶</strong>å½“ä¸­è¿›è¡ŒæŸ¥è¯¢è·å–å¾—åˆ°ç›¸åº”æ•°æ®å€¼ï¼›  </p><p><strong>é¢è¯•é¢˜</strong>ï¼š<strong>èšé›†ç´¢å¼• or èšä¼—ç´¢å¼•</strong>  </p><blockquote><p><strong>ä»€ä¹ˆå«åšèšé›†ç´¢å¼•</strong>?  </p></blockquote><p><strong>èšé›†ç´¢å¼•</strong> <strong>å®šä¹‰</strong>ï¼š<strong>å¶ç»“ç‚¹ åŒ…å«äº† å®Œæ•´çš„ æ•°æ®è®°å½•</strong>ï¼›  </p><p><strong>InnoDBçš„ä¸»é”®ç´¢å¼•</strong>ï¼Œ<strong>ibd</strong>è¿™ä¸ªä¸»é”®ç´¢å¼•çš„è¿™ä¸ªæ–‡ä»¶ï¼›<strong>ä¸»é”®ç´¢å¼• å…¶å°±å«åš èšé›†ç´¢å¼•</strong>ï¼›<br>å› ä¸º<strong>InnoDBçš„ä¸»é”®ç´¢å¼•</strong>ï¼Œå®ƒæ˜¯è·Ÿå®ƒçš„<strong>æ–‡ä»¶æ•°æ®è¡Œ</strong>æ•´ä¸ªæ˜¯å­˜å‚¨åœ¨<strong>ä¸€ä¸ªæ–‡ä»¶å½“ä¸­ibdæ–‡ä»¶</strong>ï¼›<br><strong>ç´¢å¼• å’Œ æ•°æ® æ˜¯ èšé›†å­˜å‚¨ åœ¨ä¸€èµ· çš„</strong>ï¼›  </p><p><strong>æœ‰ èšé›†ç´¢å¼• å³ å­˜åœ¨ é èšé›†ç´¢å¼•</strong>ï¼›  </p><p><strong>MyISAMçš„ä¸»é”®ç´¢å¼•</strong> å°±ç§°ä½œæ˜¯ <strong>éèšé›†ç´¢å¼•</strong>ï¼›<br>å› ä¸º<strong>MyISAMçš„ä¸»é”®ç´¢å¼•</strong>å­˜å‚¨åœ¨<strong>MYIæ–‡ä»¶</strong>å½“ä¸­ï¼›è€Œ<strong>æ•°æ®</strong>å­˜å‚¨åœ¨<strong>MYDæ–‡ä»¶</strong>å½“ä¸­ï¼›<br>é‚£å¦‚æœéœ€è¦æŸ¥æ‰¾æ•°æ®ï¼Œæ¯æ¬¡éƒ½éœ€è¦<strong>ä¸¤ä¸ªæ–‡ä»¶çš„ä¸€åŒæŸ¥æ‰¾</strong>æ‰èƒ½æŸ¥æ‰¾å¾—åˆ°ï¼›<br><strong>æ•°æ®æ–‡ä»¶å’Œç´¢å¼•æ–‡ä»¶åˆ†å¼€å­˜å‚¨</strong>äº†ï¼›<br>æ‰€ä»¥ç§°<strong>MyISAMçš„ ä¸»é”®ç´¢å¼• ä¸º éèšé›†ç´¢å¼•</strong>ï¼›<strong>InnoDBçš„ä¸»é”®ç´¢å¼• ç§°ä¸º èšé›†ç´¢å¼•</strong>ï¼›  </p><p>å¸¸è§æ•°æ®ç»“æ„ç†è®ºï¼›  </p><p>ç»“åˆå…·ä½“çš„MySQLè¡¨æ¥çœ‹ä¸€ä¸‹ï¼›<br>ä¸åŒçš„è¡¨åº•å±‚å¦‚ä½•è¿›è¡Œå­˜å‚¨ï¼›<br>MySQLçš„è¡¨æ— éå°±æ˜¯MyISAMå­˜å‚¨å¼•æ“/InnoDBå­˜å‚¨å¼•æ“ï¼›<br>ä¸åŒçš„è¡¨å¯èƒ½æœ‰ä¸åŒçš„å­˜å‚¨å¼•æ“ï¼›  </p><p><strong>MyISAMç´¢å¼•</strong>å®ç°ï¼ˆ<strong>éèšé›†</strong>ï¼‰<br><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANX2tYjinQbFQFT5hJICKOua.p8u*tNGRGnBmzDnCDDuui9JbsxaFmbrmLTSu0V4thfYO9zIg6UNnWwUY*NxnoWlU!/r" alt="ç´¢å¼•"></p><ul><li><strong>MyISAMç´¢å¼•æ–‡ä»¶ å’Œ æ•°æ®æ–‡ä»¶</strong>æ˜¯<strong>åˆ†ç¦»</strong>çš„ï¼›</li></ul><p><strong>InnoDBç´¢å¼•</strong>å®ç°ï¼ˆ<strong>èšé›†</strong>ï¼‰</p><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANX*GhKIY3zUQdhemNpwYPZHMTx6WJ6HggRWyAqiDQHIGmxm2m2V7hUQmLQaYwj8CF*g.zfe8sCKjjxpzzRlDfl3I!/r" alt="ç´¢å¼•"></p><ul><li><strong>è¡¨æ•°æ®</strong>æœ¬èº«å°±æ˜¯æŒ‰ç…§<strong>B+Tree</strong>ç»„ç»‡çš„ä¸€ä¸ª<strong>ç´¢å¼•ç»“æ„æ–‡ä»¶</strong></li><li><strong>èšé›†ç´¢å¼•</strong>-<strong>å¶ç»“ç‚¹ åŒ…å«äº† å®Œæ•´çš„ æ•°æ®è®°å½•</strong></li><li>ä¸ºä»€ä¹ˆ<strong>InnoDBè¡¨å¿…é¡»è¦æœ‰ä¸»é”®</strong>ï¼Ÿå¹¶ä¸”<strong>æ¨èä½¿ç”¨ æ•´å‹çš„ è‡ªå¢ä¸»é”®</strong>?  <ul><li>ä¸ºä»€ä¹ˆå¿…é¡»è¦å»ºä¸»é”®ï¼ŒMySQLå®˜æ–¹å¯¹äº<strong>InnoDBçš„è¡¨</strong>ï¼Œå…¶æ•°æ®å°±éœ€è¦ç”¨ä¸€ä¸ª<strong>ç´¢å¼•B+æ ‘</strong>æ¥ç»„ç»‡ï¼›æ‰€ä»¥è‚¯å®šæ˜¯<strong>éœ€è¦ä¸»é”®</strong>çš„ï¼›<br>ï¼ˆä¹‹é—´å»ºäº†InnoDBçš„è¡¨ä½†æ˜¯æ²¡æœ‰å»ºç´¢å¼•ä¹Ÿå»ºæˆåŠŸäº†ï¼‰é’ˆå¯¹è¿™ç§æƒ…å†µï¼ŒMySQLä¼š<strong>è‡ªåŠ¨</strong>åœ¨<strong>åº•å±‚å»ºä¸€ä¸ªç´¢å¼•</strong>ï¼›<br>å¦‚æœè¡¨ä¸­<strong>æ²¡æœ‰å»ºç´¢å¼•</strong>ï¼Œ<strong>MySQL</strong>ä¼šåœ¨<strong>åº•å±‚</strong>æ‰¾ä¸€ä¸ª<strong>å”¯ä¸€èƒ½æ ‡è¯†</strong>è¿™ä¸€è¡Œæ•°æ®çš„å­—æ®µä½œä¸ºç´¢å¼•ï¼›<br>å¦‚æœæ‰¾ä¸åˆ°ï¼Œå®ƒä¼š<strong>é»˜è®¤</strong>ç»™è¡¨<strong>ç”Ÿæˆ</strong>ä¸€ä¸ªç±»ä¼¼åƒrow_idï¼Œä¸€ä¸ª<strong>éšè—åˆ—</strong>ä½œä¸º<strong>ä¸»é”®ç´¢å¼•ï¼Œä¸»é”®</strong>ï¼›<br>æ ¹æ®è¯¥è¡¨<strong>ä¸»é”®ç´¢å¼•</strong>æ¥<strong>ç»´æŠ¤</strong>æ•´å¼ è¡¨çš„<strong>æ•°æ®</strong>ï¼›</li><li><em>MySQlå®˜æ–¹*</em>è®¾è®¡çš„å°±æ˜¯è¦ç”¨ä¸€ä¸ª<strong>B+æ ‘çš„å­˜å‚¨ç»“æ„</strong>æ¥ç»„ç»‡ï¼›</li><li><em>B+æ ‘*</em>å…¶å®å°±æ˜¯è¯¥<strong>ç´¢å¼•ï¼Œç´¢å¼•ç»“æ„</strong>ï¼›<br>æ‰€ä»¥å¿…é¡»è¦æœ‰ä¸€ä¸ª<strong>ä¸»é”®ç´¢å¼•</strong>ï¼›<br>å³ä¾¿è¡¨ä¸­<strong>æ²¡æœ‰å»ºç«‹</strong>ï¼Œ<strong>MySQL</strong>ä¹Ÿä¼š<strong>é»˜è®¤ç”Ÿæˆä¸€ä¸ªéšè—çš„åˆ—/ä¸»é”®ç´¢å¼•</strong>ï¼›  </li><li><strong>ä¸»é”®</strong>å°½é‡ä¸º<strong>æ•´å‹è‡ªå¢</strong>ï¼›ä¸ºä»€ä¹ˆ<strong>ä¸»é”®å°½é‡ä¸ºæ•´å‹è‡ªå¢</strong>ï¼Ÿ<br>å‡è®¾ä¸»é”®<strong>ä¸è®¾ç½®ä¸ºæ•´å‹</strong>ï¼Œè®¾ç½®ä¸º<strong>UUIDç±»å‹</strong>ï¼Œ</li><li><em>UUIDä¸ä¸ºæ•´å‹ï¼Œè€Œæ˜¯å­—ç¬¦ä¸²ç±»å‹*</em>ï¼›<br>ä¸ºä»€ä¹ˆ<strong>ä¸æ¨èä½¿ç”¨ UUID</strong>ï¼Œè€Œ<strong>æ¨èä½¿ç”¨ æ•´å‹ å¹¶ä¸” è‡ªå¢ çš„ç±»å‹</strong>ï¼›<br>é¦–å…ˆç”¨UUIDï¼Œå®ƒæ˜¯<strong>å­—ç¬¦ä¸²ç±»å‹</strong>çš„ï¼Œè€Œä¸”æ˜¯å¾ˆé•¿ä¸€ä¸²ï¼Œå­—æ¯+æ•°å­—+å…¶ä»–ç¬¦å·ï¼›<br>è¿™æ ·<strong>å­˜åœ¨çš„å¼Šç«¯</strong>æœ‰ï¼š  </li><li><em>ï¼ˆ1ï¼‰*</em> ç›¸å¯¹äº<strong>æ•´å‹</strong>æ¥è¯´ï¼Œé¦–å…ˆï¼Œè¿™ä¸€é•¿ä¸²å­—ç¬¦ä¸²çš„<strong>å­˜å‚¨ç©ºé—´</strong>æ¯”æ•´å‹å¤§å¾—å¤šï¼ˆ<strong>å­—ç¬¦ä¸²é•¿åº¦ è¶Šé•¿ å ç”¨ ç©ºé—´ è¶Šå¤§</strong>ï¼›</li><li><em>ç´¢å¼• å­˜æ”¾åœ¨ ç£ç›˜ä¸Šé¢ï¼Œé‚£ä¹ˆä¹Ÿå°†ä¼š å ç”¨ ç£ç›˜å­˜å‚¨ç©ºé—´*</em>ï¼›<br>é‚£ä¹ˆUUID<strong>å­˜å‚¨ç£ç›˜ç©ºé—´</strong>æ˜¯è‚¯å®šä¼šè¦æ¯”æ•´å‹ç±»å‹å­—æ®µè¦<strong>å¤§å¾—å¤š</strong>ï¼‰ï¼›  </li><li><em>ï¼ˆ2ï¼‰*</em> è€Œä¸”ï¼Œ<strong>åº•å±‚B+æ ‘ç´¢å¼•</strong>å»è¿›è¡Œ<strong>æŸ¥æ‰¾</strong>çš„æ—¶å€™ï¼›æ˜¯éœ€è¦è¿›è¡Œç»“ç‚¹ä¹‹é—´<strong>æ¯”è¾ƒå¤§å°çš„</strong>ï¼›<br>ä¸€ä¸ªä¸€ä¸ªæ ¹æ®<strong>B+æ ‘</strong>ï¼ŒäºŒå‰ä¸€ä¸ªä¸ªè¿›è¡Œæ¯”è¾ƒå¤§å°æ‰¾å¯¹åº”çš„å…ƒç´ ï¼›<br>è€Œç»“ç‚¹å½“ä¸­å­˜å‚¨çš„éƒ½ä¸ºUUIDï¼Œ<strong>ä¸€ä¸ªä¸ªå»æ¯”è¾ƒå¤§å°</strong>çš„è¯ï¼›<br>å­—ç¬¦ä¸²æ¯”è¾ƒå¤§å°ï¼Œå­—ç¬¦ä¸²è·Ÿæ•°å­—è¿›è¡Œæ¯”è¾ƒï¼Œ<strong>ä¸€ä½ä¸€ä½</strong>è¿›è¡Œæ¯”è¾ƒ<strong>æ€§èƒ½å°†ä¼šéå¸¸çš„ä½</strong>ï¼›<br>å­—ç¬¦ä¸²å»è¿›è¡Œæ¯”è¾ƒå…ˆè¦<strong>è½¬æˆASCIIç å€¼ï¼ˆå›½æ ‡ç ï¼‰</strong> ï¼Œ<strong>æŒ‰ç…§ç è¡¨å½“ä¸­çš„é¡ºåº</strong>è¿›è¡Œ<strong>æ¯”è¾ƒå¤§å°</strong>ï¼›<br>è¿™ä¸ª<strong>æ€§èƒ½å°±éå¸¸ä½</strong>äº†ï¼›<br>ç›¸å¯¹äºæ•´å‹æ¥æ¯”è¾ƒï¼š<strong>æ•°å€¼</strong>ä¹‹é—´çš„<strong>æ¯”è¾ƒæ€§èƒ½</strong>è‚¯å®šæ˜¯<strong>é«˜çš„å¤š</strong>çš„ï¼›  </li><li><em>ï¼ˆ3ï¼‰*</em> ä¸ºä»€ä¹ˆ<strong>è¦ä½¿ç”¨è‡ªå¢çš„</strong>ï¼Ÿ</li><li><em>UUIDè‚¯å®šä¸æ˜¯è‡ªå¢ç±»å‹çš„*</em>ï¼›<br>æ­£å¸¸æƒ…å†µä¸‹å¦‚æœæ˜¯ä½¿ç”¨<strong>é¡ºåºè‡ªå¢</strong>ï¼š<strong>æ’å…¥çš„å…ƒç´ </strong>åŸºæœ¬ä¸Šæ˜¯<strong>å¾€åé¢è¿›è¡Œæ’å…¥çš„</strong>ï¼›</li><li><em>åé¢çš„ç»“ç‚¹ç©ºé—´æ»¡äº†*</em>ï¼Œç„¶åç»§ç»­<strong>å¾€åé¢å»å¼€è¾Ÿä¸€ä¸ªç©ºé—´ç»§ç»­æ”¾</strong>ï¼›<br>å¦‚æœç°åœ¨æ–°åŠ ä¸€ä¸ªå…ƒç´ ï¼›<strong>å¶å­ç»“ç‚¹ ä»å·¦åˆ°å³ éƒ½æ˜¯ ä¾æ¬¡é€’å¢çš„</strong>ï¼›<br>åœ¨<strong>æ¯ä¸€ä¸ªç»“ç‚¹</strong>å½“ä¸­<strong>æ¯ä¸€ä¸ªå…ƒç´ </strong>éƒ½æ˜¯<strong>ä¾æ¬¡é€’å¢</strong>ï¼Œ<strong>å·¦è¾¹å°äºå³è¾¹</strong>ï¼›</li><li><em>B+æ ‘*</em>å½“ä¸­çš„æ‰€æœ‰<strong>å¶å­ç»“ç‚¹ ä»å·¦åˆ°å³ éƒ½æ˜¯ ä¾æ¬¡é€’å¢</strong>çš„ï¼›<br>ç°åœ¨å°†ä¸€ä¸ªä¸æ˜¯è‡ªå¢çš„æ–°å…ƒç´ UUIDè¿›è¡Œæ’å…¥ï¼›<br>è€Œ<strong>æ’å…¥çš„ä½ç½®</strong>æ­£å¥½æ˜¯<strong>å¶å­ç»“ç‚¹ä¸­é—´çš„ä¸€ä¸ªä½ç½®</strong>ï¼Œè€Œå¹¶ä¸æ˜¯ç»“å°¾çš„ä½ç½®ï¼›<br>æ¯”å¦‚æ’å…¥åˆ°20ä¸30çš„å¶å­ç»“ç‚¹ä¸­é—´ï¼›<br>é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°†20å’Œ30æƒ³è±¡æˆUUIDç±»å‹çš„å­—ç¬¦ä¸²å†…å®¹ï¼›<br>å½“æ–°å…ƒç´ UUIDè¿›è¡Œæ’å…¥çš„æ—¶å€™å°±å°†ä¼šå½¢æˆ<strong>åˆ†è£‚</strong>çš„è¿™ç§æƒ…å†µï¼›<br>æœ‰å¯èƒ½å°±æ˜¯å°†20ä¸æ–°å…ƒç´ æ–°<strong>åˆ†è£‚å‡ºä¸€ä¸ªå¶å­ç»“ç‚¹</strong>ï¼Œ30<strong>å•ç‹¬åˆ†è£‚å‡ºå»ä¸€ä¸ªå¶å­ç»“ç‚¹</strong>ï¼›  </li><li><em>æ’å…¥çš„å…ƒç´ éœ€è¦è¿›è¡Œåˆ†è£‚ä¸€æ¬¡*</em>ï¼›ç„¶åè¿˜éœ€è¦<strong>å¹³è¡¡ä¸€æ¬¡</strong>ï¼›<br>ç›¸å¯¹äºè¿™ç§æ’å…¥æ–°å…ƒç´ ï¼Œæ’å…¥ä¸€ä¸ªå…ƒç´ æŒ‰<strong>é¡ºåºé€’å¢</strong>å¾€<strong>åé¢è¿›è¡Œä¸€ä¸ªä¸€ä¸ªé€’å¢çš„åŠ å…ƒç´ </strong>çš„è¿™ç§æƒ…å†µ<strong>æ•ˆç‡å°±è¦é«˜</strong>å¤šäº†ï¼›<br>è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆ <strong>B+ æ ‘</strong>æ¨èçš„<strong>ä¸»é”®ç´¢å¼•ä¸ºæ•´å‹å¹¶ä¸”è‡ªå¢ç±»å‹</strong>ï¼›<br>å› ä¸º<strong>è‡ªå¢</strong>å®ƒä¼š<strong>å°½å¯èƒ½çš„é¿å…</strong>ï¼š<strong>æ–°å¢çš„ è¯¥ç»“ç‚¹ æ’å…¥åˆ° å¶å­ç»“ç‚¹</strong>ä¸Šå»äº†ä¹‹åï¼Œä¼š<strong>å¯¼è‡´å¶å­ç»“ç‚¹ åŸæœ‰çš„ å·²ç»æ»¡äº†çš„ å¤§çš„ å¶å­ç»“ç‚¹ åšåˆ†è£‚ ä»¥åŠ è‡ªåŠ¨å¹³è¡¡</strong>ï¼›  </li><li><em>ï¼ˆ4ï¼‰*</em> <strong>æŒ‡é’ˆï¼ˆB+æ ‘çš„ å¶å­ç»“ç‚¹ä¸Šçš„ å³æŒ‡é’ˆï¼‰çš„ä½œç”¨</strong>ï¼šå¶å­ç»“ç‚¹å½“ä¸­æŸä¸€å¤§ç»“ç‚¹å¦‚å·²ç»å­˜æ»¡äº†16kçš„ç´¢å¼•å…ƒç´ ï¼›æŒ‰ç…§<strong>B+æ ‘</strong> <strong>ä»å·¦åˆ°å³ çš„ ä¾æ¬¡é€’å¢ çš„ é¡ºåº</strong>ï¼›<br>å‡è®¾å½“å‰è¯¥å­—æ®µ<strong>ä¸æ˜¯è‡ªå¢</strong>çš„ï¼›<br>ç°åœ¨æ¥äº†ä¸€ä¸ªæ–°çš„å…ƒç´ éœ€è¦è¿›è¡Œæ’å…¥æ•°æ®ï¼Œçœ‹åˆ°ç´¢å¼•çš„å€¼æ¯”æ–¹è¯´ä¸º25ï¼›<br>é‚£ä¹ˆæŒ‰é¡ºåºè¿™ä¸ªç´¢å¼•å€¼å°±åº”è¯¥æ’å…¥åˆ°å¶å­ç»“ç‚¹20-30çš„ä¸­é—´ï¼›<br>ä½†æ˜¯å½“å‰è¯¥å¶å­ç»“ç‚¹çš„å­˜å‚¨ç©ºé—´å¤§å°16kå·²ç»æ»¡äº†ï¼Œå·²ç»å­˜ä¸ä¸‹äº†ï¼›<br>é‚£ä¹ˆæ­¤æ—¶åœ¨è¿™ç§æƒ…å†µä¸‹ï¼š  </li><li><em>1&gt;*</em> <strong>å½“å‰å¶å­ç»“ç‚¹ çš„ å­˜å‚¨ç©ºé—´ å·²ç»æ»¡</strong>äº†  </li><li><em>2&gt;*</em> å½“å‰éœ€è¦<strong>æ–°æ’å…¥ ä¸€ä¸ªæ–°çš„ ç´¢å¼•å…ƒç´ </strong>ï¼Œè€Œè¯¥<strong>ç´¢å¼•å…ƒç´ çš„å¤§å°å–å€¼</strong>åº”è¯¥æ”¾åœ¨è¯¥<strong>å½“å‰å¶å­ç»“ç‚¹çš„ä¸­é—´</strong>ï¼›<br>é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±éœ€è¦è¿›è¡Œ<strong>å¶å­ç»“ç‚¹çš„åˆ†è£‚</strong>ï¼›</li><li><em>åˆ†è£‚æˆä¸¤ä¸ªç»“ç‚¹*</em>ï¼›<br>20ä¸25è¿™ä¸¤ä¸ªç´¢å¼•å…ƒç´ <strong>æˆä¸ºä¸€ä¸ªæ–°çš„å¶å­ç»“ç‚¹</strong>ï¼›<br>è€Œ30å°†è¢«<strong>åˆ†è£‚åˆ°å¦å¤–ä¸€ä¸ªå¶å­ç»“ç‚¹</strong>ä¸Šé¢å»ï¼›<br>è€Œå¦‚æœæ’å…¥çš„å…ƒç´ éƒ½æ˜¯é€’å¢ç±»å‹çš„å…ƒç´ çš„è¯åˆ™æ¯”å¦‚è¯´æ’å…¥æ–°å…ƒç´ 100ï¼›<br>é‚£ä¹ˆå°±è‚¯å®š<strong>ä¸å†éœ€è¦ å¾€ä¸­é—´ å» è¿›è¡Œ æ’å…¥</strong>ï¼›<br>éƒ½æ˜¯<strong>ç›´æ¥åœ¨åé¢ æ–°å¼€è¾Ÿä¸€å—ç©ºé—´ æ¥è¿›è¡Œ å­˜å‚¨ è¯¥æ–°å…ƒç´ </strong>100ï¼›  </li></ul></li></ul><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANX8fDAvL3g7DJ9HhnBQeGRqDvrpkZXABEIRyvGCl2wXfLlwUZMMrCWHUUoUCg2YMQdB8MP3ElixOLflsVbBIu18U!/r" alt="ç´¢å¼•"></p><ul><li>ä¸ºä»€ä¹ˆ<strong>éä¸»é”®ç´¢å¼•ç»“æ„ å¶å­ç»“ç‚¹ å­˜å‚¨çš„æ˜¯ ä¸»é”®å€¼</strong>ï¼Ÿï¼ˆ<strong>ä¸€è‡´æ€§ å’Œ èŠ‚çœå­˜å‚¨ç©ºé—´</strong>ï¼‰  </li></ul><h3 id="ç´¢å¼•æœ€å·¦å‰ç¼€åŸç†"><a href="#ç´¢å¼•æœ€å·¦å‰ç¼€åŸç†" class="headerlink" title="ç´¢å¼•æœ€å·¦å‰ç¼€åŸç†"></a>ç´¢å¼•æœ€å·¦å‰ç¼€åŸç†</h3><ul><li>è”åˆç´¢å¼•çš„åº•å±‚å­˜å‚¨ç»“æ„é•¿ä»€ä¹ˆæ ·?  </li></ul><p>(å­—æ®µ1ï¼Œå­—æ®µ2ï¼Œå­—æ®µ3)<br>æ¯”æ–¹è¯´å­—æ®µ1ã€å­—æ®µ2ã€å­—æ®µ3æ˜¯è”åˆç´¢å¼•ï¼›  </p><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANX50m84lF6rjqlgyWXpKCriCR9zfdJdu7YbMYTBq.e8Oj47TQyP3KTeZ1anErrKoy5mNBgGaDtLH9DbfHrrCBYYg!/r" alt="ç´¢å¼•"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;è§‚çœ‹ç¬”è®°ï¼š  &lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutt
      
    
    </summary>
    
    
      <category term="ç¬”è®°" scheme="https://fengshana.github.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="é¢è¯•" scheme="https://fengshana.github.io/tags/%E9%9D%A2%E8%AF%95/"/>
    
      <category term="çº¢é»‘æ ‘" scheme="https://fengshana.github.io/tags/%E7%BA%A2%E9%BB%91%E6%A0%91/"/>
    
      <category term="MySqlç´¢å¼•" scheme="https://fengshana.github.io/tags/MySql%E7%B4%A2%E5%BC%95/"/>
    
      <category term="B+æ ‘" scheme="https://fengshana.github.io/tags/B-%E6%A0%91/"/>
    
      <category term="Bæ ‘" scheme="https://fengshana.github.io/tags/B%E6%A0%91/"/>
    
      <category term="HASHè¡¨" scheme="https://fengshana.github.io/tags/HASH%E8%A1%A8/"/>
    
      <category term="äºŒå‰æ ‘" scheme="https://fengshana.github.io/tags/%E4%BA%8C%E5%8F%89%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>å…¨é¢æ·±å…¥è®²è§£MySQLæ•°æ®åº“ä¼˜åŒ–01</title>
    <link href="https://fengshana.github.io/2020/05/27/%E3%80%90MYSQL%E3%80%91/%E3%80%90MYSQL%E3%80%91%E5%85%A8%E9%9D%A2%E6%B7%B1%E5%85%A5%E8%AE%B2%E8%A7%A3MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%9601/"/>
    <id>https://fengshana.github.io/2020/05/27/%E3%80%90MYSQL%E3%80%91/%E3%80%90MYSQL%E3%80%91%E5%85%A8%E9%9D%A2%E6%B7%B1%E5%85%A5%E8%AE%B2%E8%A7%A3MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%9601/</id>
    <published>2020-05-27T10:35:55.031Z</published>
    <updated>2020-06-05T17:55:42.952Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è§‚çœ‹ç¬”è®°ï¼š<code>https://www.bilibili.com/video/BV1fJ41127Rj?from=search&amp;seid=13531213796559959972</code>  </p><p>æœ¬è¯¾ç¨‹ä½œä¸ºMySQLé«˜çº§è¯¾ç¨‹ï¼Œä¸»è¦è®²è§£äº†ï¼š  </p><ul><li><strong>MySQL</strong>ä¸­çš„<strong>è§†å›¾</strong>/<strong>å­˜å‚¨è¿‡ç¨‹</strong>/<strong>è§¦å‘å™¨</strong>/<strong>ç´¢å¼•</strong>ç­‰å¯¹è±¡çš„ä½¿ç”¨</li><li>å¸¸è§çš„<strong>SQL</strong>è¯­å¥<strong>ä¼˜åŒ–</strong>çš„æŠ€å·§</li><li><strong>åº”ç”¨ä¼˜åŒ–</strong></li><li><strong>æ•°æ®åº“ä¼˜åŒ–</strong></li><li><strong>æ•°æ®åº“æ—¥å¿—</strong></li></ul><p>ç­‰æ–¹é¢çš„çŸ¥è¯†ï¼Œå¹¶é€šè¿‡ç»¼åˆæ¡ˆä¾‹ï¼Œå¯¹è¯¾ç¨‹ä¸­çš„çŸ¥è¯†è¿›è¡Œä¸€ä¸ªæ•´åˆåº”ç”¨ã€‚  </p><p>æœ¬è¯¾ç¨‹æ—¨åœ¨é€šè¿‡MySQlé«˜çº§éƒ¨åˆ†å†…å®¹ï¼Œå¯ä»¥åœ¨æ»¡è¶³ç°æœ‰ä¸šåŠ¡éœ€æ±‚åŸºç¡€ä¸Šï¼Œå¯¹<strong>MySQLåº•å±‚çš„ä½“ç³»ç»“æ„</strong>ï¼ŒåŠ<strong>åº•å±‚çš„ä¼˜åŒ–</strong>æœ‰ä¸€ä¸ªæ·±å…¥çš„ç†è§£ï¼Œå¯¹<strong>ç³»ç»Ÿçš„æ•´ä½“æ€§èƒ½</strong>è¿›è¡Œæå‡ã€‚  </p><h2 id="è¯¾ç¨‹å†…å®¹ä»‹ç»"><a href="#è¯¾ç¨‹å†…å®¹ä»‹ç»" class="headerlink" title="è¯¾ç¨‹å†…å®¹ä»‹ç»"></a>è¯¾ç¨‹å†…å®¹ä»‹ç»</h2><blockquote><p>Mysqlé«˜çº§-day01</p></blockquote><p>MySQLé«˜çº§è¯¾ç¨‹ç®€ä»‹</p><ol><li>Linuxç³»ç»Ÿå®‰è£…MySQL</li><li><strong>ç´¢å¼•</strong></li><li><strong>è§†å›¾</strong></li><li><strong>å­˜å‚¨è¿‡ç¨‹</strong>å’Œ<strong>å‡½æ•°</strong></li><li><strong>è§¦å‘å™¨</strong></li></ol><h3 id="MySQLé«˜çº§è¯¾ç¨‹ç®€ä»‹"><a href="#MySQLé«˜çº§è¯¾ç¨‹ç®€ä»‹" class="headerlink" title="MySQLé«˜çº§è¯¾ç¨‹ç®€ä»‹"></a>MySQLé«˜çº§è¯¾ç¨‹ç®€ä»‹</h3><table>    <tr>      <th>åºå·</th>      <th>Day01</th>      <th>Day02</th>      <th>Day03</th>      <th>Day04</th>    </tr>    <tr>      <td>1</td>      <td>Linuxç³»ç»Ÿå®‰è£…MySQL</td>      <td>ä½“ç³»ç»“æ„</td>      <td>åº”ç”¨ä¼˜åŒ–</td>      <td>MySQLå¸¸ç”¨å·¥å…·</td>    </tr>    <tr>      <td>2</td>      <td>ç´¢å¼•</td>      <td>å­˜å‚¨å¼•æ“</td>      <td>æŸ¥è¯¢ç¼“å­˜ä¼˜åŒ–</td>      <td>MySQLæ—¥å¿—</td>    </tr>    <tr>      <td>3</td>      <td>è§†å›¾</td>      <td>ä¼˜åŒ–SQLæ­¥éª¤</td>      <td>å†…å­˜ç®¡ç†åŠä¼˜åŒ–</td>      <td>MySQlä¸»ä»å¤åˆ¶</td>    </tr>    <tr>      <td>4</td>      <td>å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°</td>      <td>ç´¢å¼•ä½¿ç”¨</td>      <td>MySQLé”é—®é¢˜</td>      <td>ç»¼åˆæ¡ˆä¾‹</td>    </tr>    <tr>      <td>5</td>      <td>è§¦å‘å™¨</td>      <td>SQLä¼˜åŒ–</td>      <td>å¸¸ç”¨SQLæŠ€å·§</td>      <td></td>    </tr></table><h2 id="Linuxä¸Šå®‰è£…MySQL"><a href="#Linuxä¸Šå®‰è£…MySQL" class="headerlink" title="Linuxä¸Šå®‰è£…MySQL"></a>Linuxä¸Šå®‰è£…MySQL</h2><h3 id="ä¸‹è½½Linuxå®‰è£…åŒ…"><a href="#ä¸‹è½½Linuxå®‰è£…åŒ…" class="headerlink" title="ä¸‹è½½Linuxå®‰è£…åŒ…"></a>ä¸‹è½½Linuxå®‰è£…åŒ…</h3><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">https:</span>/<span class="regexp">/dev.mysql.com/downloads</span><span class="regexp">/mysql/</span><span class="number">5.7</span>.html<span class="comment">#downloads</span></span><br></pre></td></tr></table></figure><h3 id="å®‰è£…MySQL"><a href="#å®‰è£…MySQL" class="headerlink" title="å®‰è£…MySQL"></a>å®‰è£…MySQL</h3><ol><li><strong>å¸è½½</strong>centosä¸­é¢„å®‰è£…çš„mysql</li></ol><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa | grep -i mysql # æŸ¥è¯¢æœåŠ¡å™¨å½“ä¸­mysqlçš„å®‰è£…åŒ…æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨åˆ™æ˜¾ç¤ºå‡ºå­˜åœ¨å®‰è£…åŒ…çš„åç§°</span><br><span class="line"></span><br><span class="line">rpm -e mysql-libs<span class="number">-5.1</span><span class="number">.71</span><span class="number">-1.e16</span>.x86_64 --nodeps # å¯¹å·²å­˜åœ¨çš„å®‰è£…åŒ…(mysql-libs<span class="number">-5.1</span><span class="number">.71</span><span class="number">-1.e16</span>.x86_64)è¿›è¡Œå¸è½½</span><br></pre></td></tr></table></figure><ol start="2"><li><strong>ä¸Šä¼ </strong>mysqlçš„å®‰è£…åŒ…</li></ol><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alt + p -------&gt;put E:/tset/MySQL<span class="number">-5.6</span><span class="number">.22</span><span class="number">-1.e16</span>.i686.rpm-bundle.tarï¼ˆMySQLå®‰è£…åŒ…çš„ç›®å½•ï¼‰</span><br><span class="line"></span><br><span class="line"># ä½¿ç”¨SecureCRTè¿œç¨‹è¿æ¥æœåŠ¡å™¨å·¥å…·ï¼Œalt+på‘½ä»¤è¿›å…¥sftpæ¨¡å¼ï¼›å†æ‰§è¡Œput ï¼ˆMySQLå®‰è£…åŒ…çš„ç›®å½•ï¼‰[ ä¸Šä¼  ]</span><br></pre></td></tr></table></figure><ol start="3"><li><strong>è§£å‹</strong>mysqlçš„å®‰è£…åŒ…</li></ol><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir mysql</span><br><span class="line"></span><br><span class="line">tar -xvf MySQL-<span class="number">5.6</span>.<span class="number">22</span>-<span class="number">1</span><span class="selector-class">.e16</span><span class="selector-class">.i686</span><span class="selector-class">.rpm-bundle</span><span class="selector-class">.tar</span> -c /root/mysql</span><br></pre></td></tr></table></figure><ol start="4"><li><strong>å®‰è£…</strong>ä¾èµ–åŒ…</li></ol><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># å®‰è£…ç¬¬ä¸‰æ–¹çš„ä¾èµ–åº“ï¼›yum -y åœ¨çº¿å®‰è£…éœ€è¿æ¥ç½‘ç»œ</span><br><span class="line">yum -y install libaio.so<span class="number">.1</span> libgc_s.so<span class="number">.1</span> libstdc++.so<span class="number">.6</span> libncurses.so<span class="number">.5</span> --setopt=protected_multilib=<span class="literal">false</span></span><br><span class="line"></span><br><span class="line">yum update listdc++<span class="number">-4.4</span><span class="number">.7</span><span class="number">-4.e16</span>.x86_64 # æ›´æ–°ç¬¬ä¸‰æ–¹ç±»åŒ…</span><br></pre></td></tr></table></figure><ol start="5"><li><strong>å®‰è£…</strong>mysql-client</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">rpm</span> <span class="selector-tag">-ivh</span> <span class="selector-tag">MySQL-client-5</span><span class="selector-class">.6</span><span class="selector-class">.22-1</span><span class="selector-class">.e16</span><span class="selector-class">.i686</span><span class="selector-class">.rpm</span></span><br></pre></td></tr></table></figure><ol start="6"><li><strong>å®‰è£…</strong>mysql-server</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">rpm</span> <span class="selector-tag">-ivh</span> <span class="selector-tag">MySQL-server-5</span><span class="selector-class">.6</span><span class="selector-class">.22-1</span><span class="selector-class">.e16</span><span class="selector-class">.i686</span><span class="selector-class">.rpm</span></span><br></pre></td></tr></table></figure><blockquote><p>Linux</p></blockquote><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ipconfig</span> <span class="comment"># æŸ¥çœ‹æœ¬æœºipåœ°å€ï¼Œå†…ç½‘åœ°å€</span></span><br></pre></td></tr></table></figure><h2 id="å¯åŠ¨åŠç™»å½•MySQL"><a href="#å¯åŠ¨åŠç™»å½•MySQL" class="headerlink" title="å¯åŠ¨åŠç™»å½•MySQL"></a>å¯åŠ¨åŠç™»å½•MySQL</h2><blockquote><p><strong>å¯åŠ¨mysql</strong>å‘½ä»¤</p></blockquote><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">service mysql status  # æŸ¥çœ‹mysqlæœåŠ¡çŠ¶æ€</span><br><span class="line">service mysql start   # å¯åŠ¨mysqlæœåŠ¡</span><br><span class="line">service mysql stop    # åœæ­¢mysqlæœåŠ¡</span><br></pre></td></tr></table></figure><blockquote><p><strong>ç™»å½•mysql</strong></p></blockquote><p>mysql å®‰è£…å®Œæˆä¹‹åï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª<strong>éšæœºå¯†ç </strong>ï¼Œå¹¶ä¸”ä¿å­˜åœ¨ä¸€ä¸ªå¯†ç æ–‡ä»¶ä¸­ï¼š/root/<strong>.mysql_secret</strong>ï¼›  </p><blockquote><p><strong>æŸ¥çœ‹</strong>éšæœºå¯†ç </p></blockquote><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat <span class="regexp">/root/</span>.mysql_secret</span><br></pre></td></tr></table></figure><blockquote><p><strong>ç™»å½•</strong>å‘½ä»¤</p></blockquote><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p</span><br><span class="line"><span class="meta"># -u æŒ‡çš„æ˜¯ç”¨æˆ·</span></span><br><span class="line"><span class="meta"># -p æŒ‡çš„æ˜¯è¯¥ç”¨æˆ·æ‰€å¯¹åº”çš„å¯†ç </span></span><br></pre></td></tr></table></figure><blockquote><p>ç™»å½•ä¹‹åï¼Œä¿®æ”¹å¯†ç å‘½ä»¤</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="keyword">password</span> = <span class="keyword">password</span>(<span class="string">'itcast'</span>);</span><br><span class="line"><span class="comment"># itcastå³æ˜æ–‡å¯†ç </span></span><br></pre></td></tr></table></figure><blockquote><p><strong>æˆæƒè¿œç¨‹è®¿é—®</strong></p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grant</span> <span class="keyword">all</span> <span class="keyword">privileges</span> <span class="keyword">on</span> *.* <span class="keyword">to</span> <span class="string">'root'</span>@<span class="string">'%'</span> <span class="keyword">identified</span> <span class="keyword">by</span> <span class="string">'itcast'</span>;</span><br><span class="line"><span class="keyword">flush</span> <span class="keyword">privileges</span>;</span><br></pre></td></tr></table></figure><blockquote><p><strong>é˜²ç«å¢™</strong></p></blockquote><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">service iptables status # æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€</span><br><span class="line">service iptables stop # å…³é—­é˜²ç«å¢™</span><br></pre></td></tr></table></figure><h2 id="ç´¢å¼•-æ¦‚è¿°"><a href="#ç´¢å¼•-æ¦‚è¿°" class="headerlink" title="ç´¢å¼• - æ¦‚è¿°"></a>ç´¢å¼• - æ¦‚è¿°</h2><p><strong>MySQLå®˜æ–¹</strong>å¯¹<strong>ç´¢å¼•</strong>çš„å®šä¹‰ä¸ºï¼š  </p><p><strong>ç´¢å¼•</strong>ï¼ˆ<strong>index</strong>ï¼‰æ˜¯ <strong>å¸®åŠ©</strong> MySQL <strong>é«˜æ•ˆ è·å–æ•°æ®</strong> çš„ <strong>æ•°æ®ç»“æ„</strong>ï¼ˆ<strong>æœ‰åº</strong>ï¼‰ã€‚  </p><p>åœ¨æ•°æ®ä¹‹å¤–ï¼Œ<strong>æ•°æ®åº“ç³»ç»Ÿ</strong> è¿˜ <strong>ç»´æŠ¤</strong>ç€ æ»¡è¶³ <strong>ç‰¹å®šæŸ¥æ‰¾</strong> <strong>ç®—æ³•</strong> çš„ <strong>æ•°æ®ç»“æ„</strong>ï¼Œ<br>è¿™äº› <strong>æ•°æ®ç»“æ„</strong> ä»¥ æŸç§æ–¹å¼ <strong>å¼•ç”¨</strong>ï¼ˆ<strong>æŒ‡å‘</strong>ï¼‰<strong>æ•°æ®</strong>ï¼Œ<br>è¿™æ ·å°±å¯ä»¥åœ¨è¿™äº› <strong>æ•°æ®ç»“æ„</strong> ä¸Šå®ç° <strong>é«˜çº§æŸ¥æ‰¾ç®—æ³•</strong>ï¼Œ<br>è¿™ç§ <strong>æ•°æ®ç»“æ„</strong> å°±æ˜¯ <strong>ç´¢å¼•</strong>ã€‚<br>å¦‚ä¸‹é¢çš„ç¤ºæ„å›¾æ‰€ç¤ºï¼š  </p><p>å·¦è¾¹æ˜¯æ•°æ®åº“ï¼Œä¸€å…±æœ‰ä¸¤åˆ—ä¸ƒæ¡è®°å½•ï¼Œæœ€å·¦è¾¹çš„æ˜¯æ•°æ®è®°å½•çš„ç‰©ç†åœ°å€<br>ï¼ˆæ³¨æ„ <strong>é€»è¾‘ä¸Š ç›¸é‚»çš„è®°å½•</strong> åœ¨<strong>ç£ç›˜ä¸Š</strong> ä¹Ÿ <strong>ä¸æ˜¯ä¸€å®šç‰©ç†ç›¸é‚»</strong> çš„ï¼‰ã€‚  </p><p>ä¸ºäº†<strong>åŠ å¿«Col2çš„æŸ¥æ‰¾</strong>ï¼Œå¯ä»¥<strong>ç»´æŠ¤</strong>å³è¾¹æ‰€ç¤ºçš„<strong>äºŒå‰æŸ¥æ‰¾æ ‘</strong>ï¼Œ<br>æ¯ä¸ª<strong>ç»“ç‚¹</strong>åˆ†åˆ«åŒ…å« <strong>ç´¢å¼•é”®å€¼</strong> å’Œä¸€ä¸ª <strong>æŒ‡å‘</strong> <strong>å¯¹åº”æ•°æ®è®°å½•</strong> <strong>ç‰©ç†åœ°å€</strong> çš„ <strong>æŒ‡é’ˆ</strong>ï¼Œ<br>è¿™æ ·å°±å¯ä»¥è¿ç”¨ <strong>äºŒå‰æŸ¥æ‰¾</strong> å¿«é€Ÿåå»åˆ°ç›¸åº”æ•°æ®ã€‚  </p><p>ä¸€èˆ¬æ¥è¯´ <strong>ç´¢å¼•æœ¬èº«ä¹Ÿå¾ˆå¤§</strong>ï¼Œ<br><strong>ä¸å¯èƒ½å…¨éƒ¨å­˜å‚¨åœ¨å†…å­˜</strong> ä¸­ï¼Œ<br>å› æ­¤ç´¢å¼•å¾€å¾€ä»¥ <strong>ç´¢å¼•æ–‡ä»¶</strong> çš„å½¢å¼ <strong>å­˜å‚¨åœ¨ç£ç›˜</strong> ä¸Šï¼Œ<br><strong>ç´¢å¼•</strong>æ˜¯æ•°æ®åº“ä¸­ç”¨æ¥ <strong>æä¾›æ€§èƒ½</strong> çš„æœ€å¸¸ç”¨çš„å·¥å…·ã€‚  </p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">mspaint</span> <span class="comment"># windowsæ‰“å¼€ç”»æ¿</span></span><br></pre></td></tr></table></figure><table>  <tr>    <td>ç‰©ç†åœ°å€</td>    <td>Col1</td>    <td>Col2</td>  </tr>  <tr>    <td>0x07</td>    <td>1</td>    <td>34</td>  </tr>  <tr>    <td>0x56</td>    <td>2</td>    <td>77</td>  </tr>  <tr>    <td>0x6A</td>    <td>3</td>    <td>5</td>  </tr>  <tr>    <td>0xF3</td>    <td>4</td>    <td>91</td>  </tr>  <tr>    <td>0x90</td>    <td>5</td>    <td>22</td>  </tr>  <tr>    <td>0x77</td>    <td>6</td>    <td>59</td>  </tr>  <tr>    <td>0xD1</td>    <td>7</td>    <td>3</td>  </tr></table><p>å½“å‰è¯¥ä¸ºä¸€å¼ æ•°æ®åº“è¡¨ï¼›<br>åœ¨æ•°æ®åº“è¡¨çš„å·¦ä¾§å±•ç¤ºçš„æ˜¯æ¯ä¸€æ¡è®°å½•çš„ä¸€ä¸ª<strong>ç‰©ç†åœ°å€</strong>ï¼›<br>å³ä¾§åˆ™æ˜¯ä¸¤åˆ—ï¼›<br>ä¸€åˆ—å­—æ®µCol1æ˜¯åºå·ï¼›<br>Col2å­—æ®µæ•°æ®å¯ä»¥è®¤ä¸ºå°±æ˜¯ä¸»é”®æ•°æ®ï¼›<br>æ•°æ®åº“è¡¨ç»“æ„æœ‰äº†ï¼Œæ¥ä¸‹æ¥æŸ¥è¯¢æ•°æ®ï¼›  </p><p><strong>ï¼ˆ1ï¼‰ç¬¬ä¸€ç§æƒ…å†µ</strong>ï¼š<br><strong>æŸ¥è¯¢ä¸»é”®Col2ä¸º34çš„æ•°æ®</strong>ï¼›<br>å› ä¸ºè¿™ä¸ªæ—¶å€™åªå­˜åœ¨è¡¨ï¼Œ<strong>æ²¡æœ‰è®¾ç½®ç´¢å¼•</strong>è¿™äº›æ–¹ä¾¿æŸ¥è¯¢çš„<strong>æ•°æ®ç»“æ„</strong>ï¼›<br>æ‰€ä»¥è¿™ä¸ªæ—¶å€™å°±ä¼šåœ¨è¡¨å½“ä¸­ <strong>è‡ªä¸Šè€Œä¸‹</strong> çš„è¿›è¡Œ <strong>éå†</strong>ï¼›<br>è¿™ä¸ªæ—¶å€™å°±ä¼šå»éå†åˆ°ç¬¬ä¸€ä¸ªï¼Œå‘ç°ç¬¬ä¸€ä¸ªçš„ä¸»é”®idï¼ŒCol2çš„å€¼å°±æ˜¯34ï¼›æ­¤æ—¶å³æ‹¿åˆ°æ•°æ®ï¼›<br>è¿™æ ·çš„è¯ <strong>åª</strong> éœ€è¦ <strong>æŸ¥è¯¢ä¸€æ¡è®°å½•</strong>ï¼›<br>è€Œä¸”<strong>æŸ¥è¯¢ç¬¬ä¸€æ¡è®°å½•å°±æ˜¯</strong>ï¼Œé‚£ä¹ˆè¿™æ ·çš„è¯<strong>æŸ¥è¯¢é€Ÿåº¦</strong>æ˜¯<strong>å¾ˆå¿«</strong>çš„ï¼›<br>è¿™åªæ˜¯ç¬¬ä¸€ç§æƒ…å†µï¼›  </p><p><strong>ï¼ˆ2ï¼‰ç¬¬äºŒç§æƒ…å†µ</strong>ï¼š<br><strong>æŸ¥è¯¢ä¸»é”®Col2 idä¸º91çš„è®°å½•è¡Œæ•°æ®</strong>ï¼›<br>é‚£ä¹ˆè¿˜æ˜¯éœ€è¦<strong>è‡ªä¸Šè€Œä¸‹</strong>ä»idä¸º34çš„è®°å½•è¡Œæ•°æ®å¼€å§‹<strong>éå†</strong>ï¼›<br>é‚£ä¹ˆç¬¬ä¸€æ¡è®°å½•ä¸æ˜¯ï¼›<br>ç¬¬äºŒæ¡è®°å½•ä¸æ˜¯ï¼›<br>ç¬¬ä¸‰æ¡è®°å½•ä¹Ÿä¸æ˜¯ï¼›<br>ç›´åˆ°ç¬¬å››æ¡è®°å½•çš„æ—¶å€™å‘ç°æ•°æ®è¡Œidæ˜¯91ï¼›<br>é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ä¹Ÿå°±æ˜¯éœ€è¦å»éå†åˆ—è¡¨4æ¬¡ï¼ŒæŸ¥è¯¢4æ¬¡æ‰èƒ½å¤Ÿå¾—åˆ°ç»“æœï¼›  </p><p><strong>ï¼ˆ3ï¼‰ç¬¬ä¸‰ç§æƒ…å†µ</strong>ï¼š<br><strong>æŸ¥è¯¢ä¸»é”®Col2 idä¸º3çš„è®°å½•è¡Œæ•°æ®</strong>ï¼›<br>è¿™ä¸ªæ—¶å€™å†æ¥çœ‹ï¼Œå¦‚æœè¯´éå†æŸ¥è¯¢çš„å…ƒç´ idæ˜¯3ï¼›<br>é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ä¾ç„¶æ˜¯ <strong>ä»ä¸Šå¾€ä¸‹</strong> è¿›è¡Œ<strong>éå†</strong>ï¼Œä¸€ç›´<strong>éå†åˆ°</strong>åˆ—è¡¨çš„<strong>æœ€åº•éƒ¨</strong>ï¼›<br>æ‰èƒ½å°†3æŸ¥æ‰¾å‡ºæ¥ï¼›é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±ç›¸å½“äºéœ€è¦è¿›è¡Œä¸€ä¸ª<strong>å…¨è¡¨æ‰«æ</strong>çš„è¿™æ ·ä¸€ä¸ªæ“ä½œï¼›<br>å¯¹äºå½“å‰è¯¥è¡¨å½“ä¸­åªæœ‰6ã€7æ¡æ•°æ®ï¼›<br>ä½†æ˜¯å¦‚æœåœ¨<strong>å®é™…å¼€å‘</strong>å½“ä¸­<strong>æ•°æ®é‡</strong>æ¯”è¾ƒ<strong>å¤§</strong>ï¼›<br>ä¸€å¼ è¡¨å½“ä¸­å­˜å‚¨äº†å‡ ç™¾ä¸‡ä¸Šåƒä¸‡çš„è®°å½•ï¼›<br>é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å¦‚æœåªæœ‰è¡¨ä¸­çš„è®°å½•ï¼Œè€Œæ²¡æœ‰ç´¢å¼•çš„è¯ï¼›<br>è¿™ä¸ªæ—¶å€™å°±ä¼šé€ æˆä¸€ç§ç°è±¡ï¼Œåœ¨æŸ¥æ‰¾çš„æ—¶å€™<strong>ä»ä¸Šå¾€ä¸‹</strong>è¿›è¡Œ<strong>æ•´è¡¨æ‰«æ</strong>ï¼Œæ‰€ä»¥è¿™ç§<strong>æŸ¥è¯¢æ•ˆç‡</strong>æ˜¯<strong>éå¸¸æ…¢</strong>çš„ï¼›  </p><p>ä»¥ä¸Šå°±æ˜¯ç¬¬ä¸€ç§æƒ…å†µï¼Œå³<strong>æ²¡æœ‰å»ºç«‹ç´¢å¼•</strong>çš„æƒ…å†µï¼›<br><strong>æŸ¥è¯¢æ•ˆç‡å¾ˆæ…¢</strong>ï¼›  </p><p>ä¸‹é¢åˆ†æ<strong>æœ‰äº†ç´¢å¼•</strong>ä¹‹åï¼Œåˆæ˜¯<strong>å¦‚ä½•</strong>è¿›è¡Œ<strong>æŸ¥æ‰¾</strong>çš„ï¼›<br>æ­¤æ—¶æœ‰äº†è¡¨ç»“æ„è¿˜éœ€è¦å¯¹è¡¨ç»“æ„å½“ä¸­çš„<strong>å­—æ®µè¿›è¡Œå»ºç«‹ç´¢å¼•</strong>ï¼›<br><strong>ç´¢å¼•å°±æ˜¯ä¸€ç§æ•°æ®ç»“æ„</strong>ï¼›<br>é‚£ä¹ˆæ­¤æ—¶å°±å¯ä»¥ä½¿ç”¨<strong>æ•°æ®ç»“æ„</strong>æ¥è¡¨ç¤ºè¿™ç§è¡¨å½“ä¸­çš„ç´¢å¼•ï¼›<br>è¿™é‡Œä½¿ç”¨ä¸€ç§ <strong>æ•°æ®ç»“æ„ äºŒå‰æ ‘</strong>ï¼›  </p><p>æ—¢ç„¶æ˜¯ <strong>äºŒå‰æ ‘</strong>ï¼›<br>é‚£ä¹ˆäºŒå‰æ ‘å½“ä¸­çš„ç¬¬ä¸€ä¸ªç»“ç‚¹ï¼Œä¹Ÿå°±æ˜¯34ï¼›<br>å³<strong>æ ¹èŠ‚ç‚¹</strong>ï¼›<br>34å³ä½œä¸ºå½“å‰è¯¥æ ‘çŠ¶ç»“æ„çš„<strong>æ ¹ç»“ç‚¹</strong>ï¼›  </p><p>æ¥ä¸‹æ¥ç¬¬äºŒè¡Œè®°å½•æ˜¯77ï¼›  </p><p>å¯¹äº<strong>äºŒå‰æ ‘</strong>æ¥è¯´ï¼Œ<strong>äºŒå‰æ ‘</strong>æœ‰ä¸€ä¸ªç‰¹ç‚¹ï¼›<br>å³å½“<strong>æ ¹ç»“ç‚¹å·²ç»å­˜åœ¨</strong>çš„æ—¶å€™ï¼Œ<strong>å†æ’å…¥ä¸‹ä¸€ä¸ªç»“ç‚¹</strong>ï¼›<br>åˆ™éœ€è¦å°† <strong>ä¸‹ä¸€ä¸ªç»“ç‚¹çš„æ•°å€¼</strong>ä¸<strong>æ ¹ç»“ç‚¹çš„æ•°å€¼</strong> è¿›è¡Œ <strong>æ¯”è¾ƒå¤§å°</strong>ï¼›<br>å¦‚æœ<strong>æ¯”æ ¹ç»“ç‚¹å°</strong>åˆ™æ”¾åœ¨<strong>å·¦è¾¹</strong>ï¼Œç§°ä¹‹ä¸ºç”Ÿæˆä¸€ä¸ª<strong>å·¦å­æ ‘</strong>ï¼›<br>å¦‚æœ<strong>æ¯”æ ¹ç»“ç‚¹å¤§</strong>åˆ™æ”¾åœ¨<strong>å³è¾¹</strong>ï¼Œç§°ä¹‹ä¸ºç”Ÿæˆä¸€ä¸ª<strong>å³å­æ ‘</strong>ï¼Œä½œä¸º<strong>å³å­æ ‘</strong>å­˜åœ¨ï¼›</p><p>è¿™ä¸ªæ—¶å€™77æ˜¯æ¯”34è¦å¤§çš„ï¼Œæ‰€ä»¥æ”¾åœ¨34çš„å³è¾¹ï¼Œå³77ä¸º34<strong>æ ¹ç»“ç‚¹</strong>çš„ä¸€ä¸ª<strong>å­èŠ‚ç‚¹</strong>ï¼›  </p><p>æ¥ä¸‹æ¥ç¬¬ä¸‰è¡Œæ˜¯5ï¼Œéœ€è¦å¯¹5ä¹Ÿè¦è¿›è¡Œæ’å…¥åˆ°äºŒå‰æ ‘è¯¥æ•°æ®ç»“æ„å½“ä¸­ï¼Œé‚£ä¹ˆæ­¤æ—¶ä¹Ÿæ˜¯éœ€è¦è¿›è¡Œä¸34æ ¹ç»“ç‚¹è¿›è¡Œæ¯”è¾ƒçš„ï¼›<br>æ­¤æ—¶5æ¯”34è¦å°ï¼›é‚£ä¹ˆåˆ™æ”¾åœ¨æ ¹ç»“ç‚¹34çš„å·¦è¾¹ï¼Œæ‰€ä»¥æ­¤æ—¶34æ ¹ç»“ç‚¹åˆæœ‰ä¸€ä¸ªå­èŠ‚ç‚¹5ï¼›  </p><p>å½“5æ’å…¥åˆ°äºŒå‰æ ‘ç»“æ„å½“ä¸­ä¹‹åï¼Œæ¥ç€ä¸‹ä¸€è¡Œè®°å½•91ï¼›<br>åˆ™é¦–å…ˆå°†91ä¸34æ ¹ç»“ç‚¹è¿›è¡Œæ¯”è¾ƒå¤§å°ï¼›<br>æ˜¾ç„¶91æ¯”34è¦å¤§ï¼Œåˆ™å¤„äºæ ¹ç»“ç‚¹34çš„å³è¾¹ï¼›  </p><p>å½“å‰ä½¿ç”¨çš„æ˜¯<strong>äºŒå‰æ ‘</strong>çš„è¿™ç§<strong>æ•°æ®ç»“æ„</strong>ï¼Œä¹Ÿå°±æ„å‘³ç€ <strong>æ¯ä¸€ä¸ªç»“ç‚¹</strong> <strong>æœ€å¤š</strong> éƒ½<strong>åªèƒ½æœ‰</strong> <strong>2ä¸ªåˆ†æ”¯</strong>ï¼›æ‰€ä»¥ç§°ä¹‹ä¸º<strong>äºŒå‰æ ‘</strong>ï¼›  </p><p>æ‰€ä»¥å½“æ­¤æ—¶34 <strong>æ ¹ç»“ç‚¹</strong> å·²ç»æœ‰äº†ä¸¤ä¸ªåˆ†æ”¯ä¹‹åï¼Œé‚£ä¹ˆæ­¤æ—¶91æ¯”34å¤§ï¼Œä½†æ˜¯34çš„å³è¾¹å·²ç»æœ‰å…ƒç´ 77äº†ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™91å°±éœ€è¦å»å’Œ77å»è¿›è¡Œæ¯”è¾ƒï¼›<br>77ä¸91è¿›è¡Œæ¯”è¾ƒï¼Œ91æ˜¾ç„¶è¦å¤§ï¼Œæ‰€ä»¥æ”¾åœ¨77çš„å³ä¾§ï¼Œä½œä¸º77çš„ä¸€ä¸ª<strong>å³å­èŠ‚ç‚¹</strong>å­˜åœ¨ï¼›  </p><p>æ¥ä¸‹æ¥æ˜¯ç¬¬5è¡Œè®°å½•æ•°æ®é›†22ï¼›22æ¯”34å°ï¼Œæ˜¾ç„¶è¦æ”¾åœ¨æ ¹ç»“ç‚¹çš„å·¦ä¾§ï¼›<br>ä½†æ˜¯<strong>æ ¹ç»“ç‚¹</strong>çš„<strong>å·¦ä¾§</strong>å·²ç»æœ‰<strong>å·¦å­èŠ‚ç‚¹</strong>ä¹Ÿå°±æ˜¯5ï¼›<br>é‚£ä¹ˆæ­¤æ—¶22å°±å»ä¸5è¿›è¡Œæ¯”è¾ƒï¼Œæ˜¾ç„¶22æ¯”5å¤§ï¼›ä¹Ÿå°±æ”¾åœ¨5çš„å³è¾¹ï¼›ç§°ä¸º5çš„<strong>å³å­ç»“ç‚¹</strong>ï¼›  </p><p>æœ€åè¿˜å‰©ä¸‹æœ€åä¸¤æ¡è®°å½•ï¼Œä¸€ä¸ªæ˜¯59ä¸€ä¸ªæ˜¯3ï¼›<br>å¿«é€Ÿè¿‡ä¸€ä¸‹ï¼›59é¦–å…ˆå’Œ34è¿™ä¸ªå…ƒç´ è¿›è¡Œæ¯”è¾ƒï¼›<br>æ˜¾ç„¶59æ¯”34å¤§éœ€è¦æ”¾åœ¨34çš„å³ä¾§ï¼›<br>ç„¶34å·²ç»æœ‰å³å­ç»“ç‚¹77äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™59å’Œ77è¿›è¡Œæ¯”è¾ƒï¼›<br>æ˜¾ç„¶77å¤§äº59ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±å°†59æ”¾ç½®åœ¨77çš„å·¦ä¾§ï¼Œå¶å­ç»“ç‚¹91çš„å·¦è¾¹ï¼Œæˆä¸º77çš„å·¦å­èŠ‚ç‚¹ï¼›  </p><p>åŒç†æœ€åä¸€ä¸ªå…ƒç´ ï¼Œ3ä¹Ÿæ˜¯åŒæ ·çš„æ–¹å¼ï¼›<br>3ä¸34è¿›è¡Œæ¯”è¾ƒï¼›æ˜¾ç„¶3æ¯”34è¦å°ï¼›<br>ç„¶æ­¤æ—¶34æ˜¯å­˜åœ¨æœ‰<strong>å·¦å­èŠ‚ç‚¹</strong>5çš„ï¼›<br>é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±å°†3ä¸5è¿›è¡Œæ¯”è¾ƒï¼›æ˜¾ç„¶3æ¯”5è¦å°ï¼›<br>é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ï¼›å°±æŠŠ3æ”¾åœ¨5çš„å·¦ä¾§ï¼›<br>æˆä¸º5çš„å·¦å­èŠ‚ç‚¹ï¼Œå¶å­ç»“ç‚¹22çš„å·¦ä¾§ï¼›  </p><p>æ­¤æ—¶åˆ°æ­¤ä¸ºæ­¢äºŒå‰æ ‘å·²ç»æ„å»ºå®Œæ¯•ï¼›äºŒå‰æ ‘æ„å»ºå®Œæ¯•ä¹‹åå†æ¥è¿›è¡Œåˆ†æï¼›<br>æ„å»ºäº†ä¸€æ£µäºŒå‰æ ‘ä¹‹åå°±èƒ½å¤Ÿæé«˜æŸ¥è¯¢æ•ˆç‡å—ï¼Ÿ  </p><p>ï¼ˆ<br>æˆ‘è®¤ä¸ºï¼›<br>åœ¨äºŒå‰æ ‘ä¸€å®šçš„æ·±åº¦ä¸‹ï¼ŒäºŒå‰æ ‘ä¾ç„¶ä¼šå­˜åœ¨æŸ¥è¯¢æ•ˆç‡æ…¢çš„æƒ…å†µï¼›<br>ï¼‰  </p><p>äºŒå‰æ ‘æ„å»ºå¥½äº†ä¹‹åï¼Œå†æ¥è¿›è¡Œæœç´¢ï¼›<br>å¦‚æœæŒ‰ç…§åˆšæ‰çš„æŸ¥è¯¢æƒ…å†µï¼›<br>å…ˆè¿›è¡Œæœç´¢34è¿™ä¸€æ•°å€¼ï¼›  </p><p>æœç´¢äºŒå‰æ ‘ï¼›é‚£ä¹ˆå°±éœ€è¦åˆ°ç´¢å¼•çš„ç»“æ„äºŒå‰æ ‘çš„æ•°æ®ç»“æ„å½“ä¸­æ¥è¿›è¡Œæœç´¢ï¼›<br>åœ¨è¿›è¡Œ<strong>äºŒå‰æ ‘æœç´¢</strong>çš„æ—¶å€™ï¼Œæ˜¯<strong>ä»æ ¹ç»“ç‚¹å¤„å¼€å§‹è¿›è¡ŒæŸ¥è¯¢åŒ¹é…æ•°å€¼</strong>ï¼›<br>å³æ ‘çŠ¶ç»“æ„å½“ä¸­æœ€é¡¶å±‚çš„è¿™ä¸€èŠ‚ç‚¹å³ä¸ºæ ¹ç»“ç‚¹ï¼›<br>æœ€åº•å±‚çš„ç»“ç‚¹ï¼Œå³3ã€22ã€59ã€91è¿™å››ä¸ªç»“ç‚¹ç§°ä¹‹ä¸º<strong>å¶å­ç»“ç‚¹</strong>ï¼›<br>é‚£ä¹ˆ<strong>äºŒå‰æ ‘çš„æœç´¢</strong>æ˜¯<strong>ä»æ ¹èŠ‚ç‚¹å¼€å§‹è¿›è¡Œæœç´¢çš„</strong>ï¼›  </p><p>èµ°æ ¹ç»“ç‚¹34ï¼›è¿™ä¸ªæ—¶å€™å°±å·²ç»å°†34æŸ¥è¯¢åˆ°äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç›´æ¥è¿›è¡Œè¿”å›å³å¯ï¼›<br>ä½†æ˜¯å¦‚æœè¿™ä¸€å—å½“ä¸­æŸ¥è¯¢çš„å¹¶ä¸æ˜¯34è€Œæ˜¯3ï¼›<br>é‚£ä¹ˆæ­¤æ—¶ä»ç„¶å…ˆä¼šå»æœç´¢æ ¹ç»“ç‚¹34ï¼Œå°†è¦æŸ¥è¯¢æœç´¢çš„å€¼3å»ä¸æ ¹èŠ‚ç‚¹34è¿›è¡Œæ¯”è¾ƒï¼›<br>å‘ç°3æ¯”æ ¹ç»“ç‚¹è¦å°ï¼›<br>æ‰€ä»¥æ­¤æ—¶å°±ä¼šå»æ ¹ç»“ç‚¹çš„å·¦ä¾§ï¼Œå³å·¦å­æ ‘å½“ä¸­å»è¿›è¡ŒæŸ¥æ‰¾3ï¼›  </p><p><strong>äºŒå‰æ ‘</strong>å½“ä¸­<strong>æ ¹ç»“ç‚¹çš„å·¦è¾¹</strong>çš„ç§°ä¹‹ä¸º<strong>å·¦å­æ ‘</strong>ï¼›<strong>å³è¾¹</strong>åˆ™ç§°ä¹‹ä¸º<strong>å³å­æ ‘</strong>ï¼›  </p><p>é‚£ä¹ˆåœ¨å·¦å­æ ‘å½“ä¸­é€šè¿‡3å»è·Ÿæ ¹ç»“ç‚¹çš„å·¦å­èŠ‚ç‚¹5è¿›è¡Œæ¯”è¾ƒï¼Œé‚£ä¹ˆæ­¤æ—¶5æ¯”3è¦å¤§ï¼›<br>æ‰€ä»¥ç´§æ¥ç€ï¼Œè®©3å»è·Ÿç»“ç‚¹5çš„å·¦å­èŠ‚ç‚¹3å»è¿›è¡Œæ¯”è¾ƒï¼›<br>æ‰€ä»¥åœ¨è¿™ä¸ªæ—¶å€™å°±æ‰¾åˆ°äº†3è¿™ä¸ªå…ƒç´ ï¼›<br>è€Œæ‰¾åˆ°äº†3ä¹‹åï¼ŒäºŒå‰æ ‘çš„è¿™ç§æ•°æ®ç»“æ„æ˜¯å¦‚ä½•å…³è”åˆ°è¡¨å½“ä¸­å…·ä½“è¡Œæ•°å½“ä¸­çš„å…·ä½“æ•°æ®çš„å‘¢ï¼Ÿ<br>è¿™ä¸ªæ—¶å€™å°±éœ€è¦çœ‹ç¬”è®°å½“ä¸­æåˆ°çš„ä¸€å¥è¯ï¼š  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åœ¨æ•°æ®ä¹‹å¤–ï¼Œæ•°æ®åº“ç³»ç»Ÿè¿˜ç»´æŠ¤ç€æ»¡è¶³ç‰¹å®šæŸ¥æ‰¾ç®—æ³•çš„æ•°æ®ç»“æ„ï¼Œè¿™äº›æ•°æ®ç»“æ„ä»¥æŸç§æ–¹å¼å¼•ç”¨ï¼ˆæŒ‡å‘ï¼‰æ•°æ®ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨è¿™äº›æ•°æ®ç»“æ„ä¸Šå®ç°é«˜çº§æŸ¥æ‰¾ç®—æ³•ï¼Œè¿™ç§æ•°æ®ç»“æ„å°±æ˜¯ç´¢å¼•ã€‚</span><br></pre></td></tr></table></figure><p>é‚£ä¹Ÿå°±æ„å‘³ç€ï¼ŒäºŒå‰æ ‘è¿™ç§æ•°æ®ç»“æ„å½“ä¸­çš„æ¯ä¸€ä¸ªç»“ç‚¹éƒ½æ˜¯éœ€è¦ <strong>æŒ‡å‘</strong>å…·ä½“è¡¨å½“ä¸­å…·ä½“è¡Œæ•°çš„å…·ä½“æ•°æ®ï¼›<br>é‚£ä¹ˆä»åˆšæ‰çš„æŸ¥è¯¢è§„å¾‹å½“ä¸­<strong>ä»ä¸Šè€Œä¸‹</strong>è¿›è¡ŒæŸ¥æ‰¾3ï¼Œåˆ™ä»æ ¹ç»“ç‚¹34åˆ°å·¦å­èŠ‚ç‚¹5ï¼Œå†ä»5åˆ°5çš„å·¦å­èŠ‚ç‚¹3æŸ¥æ‰¾åˆ°äº†3è¿™ä¸€å…ƒç´ çš„æŒ‡å‘/å¼•ç”¨å³å¯æ‰¾åˆ°åœ¨å…·ä½“æŸè¡¨å½“ä¸­çš„å…·ä½“æŸä¸€è¡Œçš„æ•°æ®ï¼›<br>é‚£ä¹ˆè¿™æ ·çš„è¯å°±æŸ¥æ‰¾åˆ°äº†æ•°æ®ï¼›  </p><table>  <tr>    <td>ç‰©ç†åœ°å€</td>    <td>Col1</td>    <td>Col2</td>  </tr>  <tr>    <td>0x07</td>    <td>1</td>    <td>34</td>  </tr>  <tr>    <td>0x56</td>    <td>2</td>    <td>77</td>  </tr>  <tr>    <td>0x6A</td>    <td>3</td>    <td>5</td>  </tr>  <tr>    <td>0xF3</td>    <td>4</td>    <td>91</td>  </tr>  <tr>    <td>0x90</td>    <td>5</td>    <td>22</td>  </tr>  <tr>    <td>0x77</td>    <td>6</td>    <td>59</td>  </tr>  <tr>    <td>0xD1</td>    <td>7</td>    <td>3</td>  </tr></table><blockquote><p><strong>åˆ†æ</strong>ï¼š<strong>æ²¡æœ‰å»ºç«‹ç´¢å¼•</strong> çš„è¡¨ä¸ <strong>å»ºç«‹äº†ç´¢å¼•</strong> çš„è¡¨å½“ä¸­ï¼Œå»ºç«‹äº†ç´¢å¼•ä¹‹å <strong>æ€§èƒ½</strong> çš„ä¸€ä¸ª <strong>æå‡</strong> ï¼›</p></blockquote><ul><li><p><strong>æ²¡æœ‰å»ºç«‹ç´¢å¼•</strong> çš„è¡¨ï¼š<br>åœ¨æ²¡æœ‰å»ºç«‹ç´¢å¼•çš„æƒ…å†µä¸‹ï¼Œå¦‚æœæ˜¯è¦è¿›è¡ŒæŸ¥è¯¢æ•°æ®å…ƒç´ 3ï¼›<br>é‚£ä¹ˆåˆ™éœ€è¦æŠŠæ•´å¼ è¡¨å½“ä¸­æ‰€æœ‰çš„æ•°æ®éƒ½éœ€è¦è¿›è¡Œ <strong>éå†</strong> ä¸€éå³ <strong>å…¨è¡¨æ‰«æ</strong> ï¼Œç›´åˆ°æ‰¾åˆ°3è¿™ä¸ªidæ•°æ®ï¼›  </p></li><li><p><strong>å»ºç«‹äº†ç´¢å¼•</strong> çš„è¡¨ï¼š<br>å¦‚æœæ˜¯åœ¨å»ºç«‹äº†ç´¢å¼•çš„è¿™ç§æƒ…å†µä¹‹ä¸‹ï¼›<br>é‚£ä¹ˆåŒæ ·è¿˜æ˜¯æŸ¥æ‰¾å…ƒç´ 3ï¼›<br>åªéœ€è¦æŸ¥æ‰¾ç¬¬ä¸€æ¬¡34ï¼›ç¬¬äºŒæ¬¡5ï¼›ç¬¬ä¸‰æ¬¡3å³å¯ï¼›ä¸‰æ¬¡å³å¯ï¼›<br>é‚£ä¹ˆè¿™æ ·çš„è¯è¿™ä¸ªæ—¶å€™é€šè¿‡ <strong>ç´¢å¼•</strong> ç”± <strong>äºŒå‰æ ‘</strong> è¿™ç§ <strong>æ•°æ®ç»“æ„</strong> å®ç°çš„è¯å°± <strong>ä¸å†éœ€è¦å»éå†æ•´å¼ è¡¨çš„æ•°æ®</strong> äº†ï¼›<br>é€šè¿‡ <strong>äºŒå‰æ ‘</strong> è¿™ç§ <strong>æ•°æ®ç»“æ„</strong> å°±å¯ä»¥ <strong>å¿«é€Ÿ</strong> çš„ <strong>å®šä½</strong> åˆ°3è¿™ä¸ªæŸ¥è¯¢çš„æ•°æ®å…ƒç´ ï¼›<br>é‚£ä¹ˆè¿™å°±æ˜¯<strong>ç´¢å¼•</strong>ï¼›<strong>ç´¢å¼•çš„ç›®çš„</strong> å³åœ¨äº <strong>å¿«é€Ÿ</strong> çš„æ¥ <strong>æŸ¥æ‰¾æ•°æ®</strong>ï¼›  </p></li></ul><h2 id="ç´¢å¼•-ä¼˜åŠ¿å’ŒåŠ£åŠ¿"><a href="#ç´¢å¼•-ä¼˜åŠ¿å’ŒåŠ£åŠ¿" class="headerlink" title="ç´¢å¼• - ä¼˜åŠ¿å’ŒåŠ£åŠ¿"></a>ç´¢å¼• - ä¼˜åŠ¿å’ŒåŠ£åŠ¿</h2><blockquote><p><strong>ä¼˜åŠ¿</strong><br>1ï¼‰ ç±»ä¼¼äºä¹¦ç±çš„ <strong>ç›®å½•ç´¢å¼•</strong> ï¼Œ <strong>æé«˜æ•°æ®æ£€ç´¢çš„æ•ˆç‡</strong> ï¼Œ <strong>é™ä½æ•°æ®åº“çš„IOæˆæœ¬</strong> ï¼›<br>2ï¼‰ é€šè¿‡ <strong>ç´¢å¼•åˆ—</strong> å¯¹ <strong>æ•°æ®</strong> è¿›è¡Œ <strong>æ’åº</strong> ï¼Œ <strong>é™ä½æ•°æ®æ’åºçš„æˆæœ¬</strong> ï¼Œ<strong>é™ä½CPUçš„æ¶ˆè€—</strong> ï¼›  </p></blockquote><blockquote><p><strong>åŠ£åŠ¿</strong><br>1ï¼‰å®é™…ä¸Šç´¢å¼•ä¹Ÿæ˜¯ä¸€å¼ è¡¨ï¼Œè¯¥è¡¨ä¸­ä¿å­˜äº†ä¸»é”®ä¸ç´¢å¼•å­—æ®µï¼Œå¹¶æŒ‡å‘å®ä½“ç±»çš„è®°å½•ï¼Œ <strong>ç´¢å¼•åˆ—</strong> ä¹Ÿæ˜¯è¦ <strong>å ç”¨ç©ºé—´</strong> çš„ï¼›ï¼ˆå¹¶ä¸æ”¾åœ¨å†…å­˜å½“ä¸­è€Œæ˜¯ <strong>æ”¾åœ¨ç£ç›˜å½“ä¸­</strong> ï¼Œ <strong>ç´¢å¼•å ç”¨ç£ç›˜ç©ºé—´</strong> ï¼‰<br>2ï¼‰è™½ç„¶ <strong>ç´¢å¼•</strong> <strong>å¤§å¤§æé«˜äº†æŸ¥è¯¢æ•ˆç‡</strong> ï¼ŒåŒæ—¶å´ä¹Ÿ <strong>é™ä½</strong> äº† <strong>æ›´æ–°è¡¨çš„é€Ÿåº¦</strong> ï¼Œå¦‚å¯¹è¡¨è¿›è¡Œ <strong>INSERTã€UPDATEã€DELETE</strong> ï¼ˆéƒ½éœ€è¦ <strong>å¯¹ç´¢å¼•è¿›è¡Œç»´æŠ¤</strong>ï¼Œä¹Ÿå°±æ˜¯ç›¸å…³å®ç°è¯¥ç´¢å¼•çš„æ•°æ®ç»“æ„å½“ä¸­å­˜å‚¨çš„æ•°æ®ä¹Ÿè¦è¿›è¡Œå˜åŠ¨ï¼‰ã€‚å› ä¸º <strong>æ›´æ–°è¡¨</strong> æ—¶ï¼ŒMySQLä¸ä»…è¦ <strong>ä¿å­˜æ•°æ®</strong> ï¼Œè¿˜è¦ <strong>ä¿å­˜</strong> ä¸€ä¸‹ <strong>ç´¢å¼•æ–‡ä»¶</strong> æ¯æ¬¡ <strong>æ›´æ–°æ·»åŠ </strong> äº† <strong>ç´¢å¼•åˆ—çš„å­—æ®µ</strong> ï¼Œéƒ½ä¼šå› ä¸ºæ›´æ–°æ‰€å¸¦æ¥çš„çš„ <strong>é”®å€¼å˜åŒ–</strong> åçš„ç´¢å¼•ä¿¡æ¯ã€‚ï¼ˆæ‰€ä»¥ <strong>ç´¢å¼•çš„å­—æ®µå¹¶ä¸æ˜¯è¶Šå¤šè¶Šå¥½ä¹Ÿä¼šå½±å“åˆ°æ€§èƒ½</strong> ï¼‰  </p></blockquote><h2 id="ç´¢å¼•-ç´¢å¼•ç»“æ„"><a href="#ç´¢å¼•-ç´¢å¼•ç»“æ„" class="headerlink" title="ç´¢å¼• - ç´¢å¼•ç»“æ„"></a>ç´¢å¼• - ç´¢å¼•ç»“æ„</h2><p><strong>ç´¢å¼•</strong> æ˜¯åœ¨<strong>MySQL</strong>çš„ <strong>å­˜å‚¨å¼•æ“</strong> å±‚ä¸­å®ç°çš„ï¼Œè€Œä¸æ˜¯åœ¨æœåŠ¡å™¨å±‚å®ç°çš„ã€‚  </p><p>æ‰€ä»¥æ¯ç§å­˜å‚¨å¼•æ“çš„ç´¢å¼•éƒ½ä¸ä¸€å®šå®Œå…¨ç›¸åŒï¼›ä¹Ÿä¸æ˜¯æ‰€æœ‰çš„å­˜å‚¨å¼•æ“éƒ½æ”¯æŒæ‰€æœ‰çš„ç´¢å¼•ç±»å‹ã€‚  </p><p>MySQLç›®å‰æä¾›äº†ä»¥ä¸‹4ä¸­ç´¢å¼•ï¼š  </p><ul><li><strong>BTREEç´¢å¼•</strong>ï¼šæœ€å¸¸è§çš„ç´¢å¼•ç±»å‹ï¼Œå¤§éƒ¨åˆ†ç´¢å¼•éƒ½æ”¯æŒ <strong>Bæ ‘ç´¢å¼•</strong> ï¼›</li><li><strong>HASHç´¢å¼•</strong>ï¼šåªæœ‰ <strong>Memoryå¼•æ“</strong> æ”¯æŒï¼Œ<br>ä½¿ç”¨åœºæ™¯ç®€å•ï¼ˆåˆšåˆšçœ‹äº†ä¸‹æˆ‘å½“å‰MySQLæ•°æ®åº“ç°åœ¨InnoDBä¹Ÿæ”¯æŒHASHå“¦ï¼‰ï¼›</li><li><strong>R-treeç´¢å¼•ï¼ˆç©ºé—´ç´¢å¼•ï¼‰</strong>ï¼š<strong>ç©ºé—´ç´¢å¼•</strong> æ˜¯ <strong>MyISAMå¼•æ“</strong> çš„ä¸€ä¸ª <strong>ç‰¹æ®Šç´¢å¼•ç±»å‹</strong> ï¼Œ<br>ä¸»è¦ç”¨äº <strong>åœ°ç†ç©ºé—´æ•°æ®ç±»å‹</strong> ï¼Œ<br>é€šå¸¸ä½¿ç”¨è¾ƒå°‘ï¼Œä¸åšç‰¹åˆ«ä»‹ç»ï¼›</li><li><strong>Full-textï¼ˆå…¨æ–‡ç´¢å¼•ï¼‰</strong>ï¼š<strong>å…¨æ–‡ç´¢å¼•</strong> ä¹Ÿæ˜¯ <strong>MyISAM</strong> çš„ä¸€ä¸ª <strong>ç‰¹æ®Šç´¢å¼•ç±»å‹</strong>ï¼Œ<br>ä¸»è¦ç”¨äº <strong>å…¨æ–‡ç´¢å¼•</strong> ï¼Œ</li><li><em>InnoDB*</em> ä» <strong>MySQL5.6</strong> ç‰ˆæœ¬å¼€å§‹æ”¯æŒ <strong>å…¨æ–‡ç´¢å¼•</strong> ï¼›  </li></ul><p>è¿™ä¸ªç»Ÿè®¡åº”è¯¥ä¹Ÿæœ‰äº›æ—¶å€™äº†ï¼›ä¸æ˜¯ä¸€å®šæ­£ç¡®çš„å“¦ï¼›<br>éœ€è¦ç»“åˆå½“å‰ä¸åŒç‰ˆæœ¬çš„MySQLæ¥è¯´æ˜ï¼›<br>æˆ‘è¿˜æ˜¯è´´ä¸€ä¸‹å§ï¼›  </p><h3 id="MyISAMã€InnoDBã€Memoryä¸‰ç§å­˜å‚¨å¼•æ“å¯¹å„ç§ç´¢å¼•ç±»å‹çš„æ”¯æŒ"><a href="#MyISAMã€InnoDBã€Memoryä¸‰ç§å­˜å‚¨å¼•æ“å¯¹å„ç§ç´¢å¼•ç±»å‹çš„æ”¯æŒ" class="headerlink" title="MyISAMã€InnoDBã€Memoryä¸‰ç§å­˜å‚¨å¼•æ“å¯¹å„ç§ç´¢å¼•ç±»å‹çš„æ”¯æŒ"></a>MyISAMã€InnoDBã€Memoryä¸‰ç§å­˜å‚¨å¼•æ“å¯¹å„ç§ç´¢å¼•ç±»å‹çš„æ”¯æŒ</h3><table>  <tr>    <th>ç´¢å¼•</th>    <th>InnoDBå¼•æ“</th>    <th>MyISAMå¼•æ“</th>    <th>Memoryå¼•æ“</th>  </tr>  <tr>    <td>BTREEç´¢å¼•</td>    <td>æ”¯æŒ</td>    <td>æ”¯æŒ</td>    <td>æ”¯æŒ</td>  </tr>  <tr>    <td>HASHç´¢å¼•</td>    <td>ä¸æ”¯æŒ</td>    <td>ä¸æ”¯æŒ</td>    <td>æ”¯æŒ</td>  </tr>  <tr>    <td>R-treeç´¢å¼•</td>    <td>ä¸æ”¯æŒ</td>    <td>æ”¯æŒ</td>    <td>ä¸æ”¯æŒ</td>  </tr>  <tr>    <td>Full-textç´¢å¼•</td>    <td>5.6ç‰ˆæœ¬ä¹‹åæ”¯æŒ</td>    <td>æ”¯æŒ</td>    <td>ä¸æ”¯æŒ</td>  </tr></table><p>å¹³å¸¸æ‰€è¯´çš„ç´¢å¼•ï¼Œå¦‚æœæ²¡æœ‰ç‰¹åˆ«æŒ‡æ˜ï¼Œéƒ½æ˜¯æŒ‡ <strong>B+æ ‘</strong> ï¼ˆ <strong>å¤šè·¯æœç´¢æ ‘</strong> ï¼Œå¹¶ä¸ä¸€å®šæ˜¯äºŒå‰çš„ï¼‰ç»“æ„ç»„ç»‡çš„ç´¢å¼•ã€‚<br>å…¶ä¸­ <strong>èšé›†ç´¢å¼•</strong>ã€ <strong>å¤åˆç´¢å¼•</strong> ã€ <strong>å‰ç¼€ç´¢å¼•</strong> ã€ <strong>å”¯ä¸€ç´¢å¼•</strong> é»˜è®¤éƒ½æ˜¯ä½¿ç”¨ <strong>B+treeæ ‘ç´¢å¼•</strong> ï¼Œç»Ÿç§°ä¸º <strong>ç´¢å¼•</strong> ã€‚  </p><h2 id="ç´¢å¼•-ç´¢å¼•ç»“æ„-BTREE"><a href="#ç´¢å¼•-ç´¢å¼•ç»“æ„-BTREE" class="headerlink" title="ç´¢å¼• - ç´¢å¼•ç»“æ„ - BTREE"></a>ç´¢å¼• - ç´¢å¼•ç»“æ„ - BTREE</h2><p><strong>BTree</strong> åˆå«åš <strong>å¤šè·¯å¹³è¡¡æœç´¢æ ‘</strong> ï¼Œä¸€æ£µ <strong>m</strong> å‰çš„ <strong>BTree</strong> ç‰¹æ€§å¦‚ä¸‹ï¼š  </p><ul><li><strong>æ ‘</strong> ä¸­æ¯ä¸ª <strong>ç»“ç‚¹</strong> <strong>æœ€å¤š</strong> åŒ…å« <strong>m</strong> ä¸ªå­©å­ï¼›</li><li><strong>é™¤æ ¹ç»“ç‚¹ä¸å¶å­ç»“ç‚¹</strong>å¤–ï¼Œ<br>æ¯ä¸ª <strong>ç»“ç‚¹</strong> <strong>è‡³å°‘</strong> æœ‰[ <strong>cell ( m / 2 )</strong> ]ï¼ˆcell<strong>å‘ä¸Šå–æ•´</strong>ï¼‰ä¸ª <strong>å­©å­</strong> ï¼›</li><li>è‹¥<strong>æ ¹ç»“ç‚¹ä¸æ˜¯å¶å­ç»“ç‚¹ï¼Œåˆ™è‡³å°‘æœ‰ä¸¤ä¸ªå­©å­</strong>ï¼›</li><li><strong>æ‰€æœ‰çš„å¶å­ç»“ç‚¹éƒ½åœ¨åŒä¸€å±‚</strong>ï¼›</li><li>æ¯ä¸ª<strong>éå¶å­ç»“ç‚¹</strong>ç”± <strong>n</strong> ä¸ª <strong>key</strong> ä¸ <strong>n + 1</strong> ä¸ª<strong>æŒ‡é’ˆ</strong>ç»„æˆï¼Œ<br>å…¶ä¸­ <strong>[cell ( m / 2 ) -1 ] &lt; = n &lt; =  m - 1</strong></li></ul><p>ï¼ˆå¯¹äº<strong>äºŒå‰æ ‘</strong>æ¥è¯´ï¼Œ<strong>æ ‘</strong>ä¸­çš„æ¯ä¸ª<strong>ç»“ç‚¹</strong> <strong>æœ€å¤šæœ‰2ä¸ªåˆ†æ”¯</strong> ï¼‰  </p><p>ä»¥5å‰BTreeä¸ºä¾‹ï¼ˆå½“å‰æ ¹ç»“ç‚¹ä¸‹æœ€å¤šæœ‰5ä¸ªåˆ†æ”¯ï¼Œå³æ¯ä¸ªç»“ç‚¹ä¸‹æœ€å¤šåŒ…å«5ä¸ªå­©å­ï¼‰ï¼Œkeyçš„æ•°é‡ï¼šå…¬å¼æ¨å¯¼[ cell ( m / 2 ) - 1 ] &lt; = n &lt; = m-1 ï¼›æ‰€ä»¥ 2 &lt; = n &lt; = 4ã€‚<br>å½“n&gt;4æ—¶ï¼Œä¸­é—´èŠ‚ç‚¹åˆ†è£‚åˆ°çˆ¶èŠ‚ç‚¹ï¼Œä¸¤è¾¹ç»“ç‚¹åˆ†è£‚ã€‚<br>æ’å…¥ C N G A H E K Q M F W L T Z D P R X Y S æ•°æ®ä¸ºä¾‹ï¼›<br>1ï¼‰æ’å…¥å‰4ä¸ªå­—æ¯C N G Aï¼›  </p><table border="1">  <tr>    <td>A</td>    <td>C</td>    <td>G</td>    <td>N</td>  </tr></table><p>ï¼ˆæŒ‰ç…§26ä¸ªå­—æ¯æ’é˜Ÿé¡ºåºï¼Œå­—æ¯Aåœ¨Cå‰ï¼ŒCæ’åœ¨Gå‰ï¼ŒGæ’åœ¨Nå‰çš„é¡ºåºè¿›è¡Œæ’åˆ—ï¼‰  </p><p>2ï¼‰æ’å…¥H ï¼Œn &gt; 4ï¼Œä¸­é—´å…ƒç´ Gå­—æ¯å‘ä¸Šåˆ†è£‚åˆ°æ–°çš„ç»“ç‚¹ï¼›  </p><table border="1">  <tr>    <td>A</td>    <td>C</td>    <td>G</td>    <td>H</td>    <td>N</td>  </tr></table><p>æ‰€ä»¥æ¼”å˜æˆä¸­é—´å…ƒç´ Gå­—æ¯å‘ä¸Šåˆ†è£‚åˆ°æ–°çš„ç»“ç‚¹ï¼Œå³Gåˆ†è£‚åˆ°çˆ¶èŠ‚ç‚¹ï¼›</p><table border="1"><tr>     <td colspan="5" style="text-align:center">G</td>  </tr>  <tr>    <td>A</td>    <td>C</td>    <td></td>    <td>H</td>    <td>N</td>  </tr></table><br><table border="1">  <tr>     <td></td>    <td></td>      <td></td>     <td colspan="2" style="text-align:center;background-color:lightblue;color:black;">G</td>     <td></td>     <td></td>    <td></td>  </tr>  <tr>     <td></td>    <td></td>     <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>    <td></td>     <td></td>    <td></td>  </tr>  <tr>    <td colspan="8"></td>  </tr>  <tr>    <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">A<span style="margin-left:5px;margin-right:5px;"></span> C</td>    <td></td>    <td></td>    <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">H<span style="margin-left:5px;margin-right:5px;"></span> N</td>  </tr>  <tr>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>    <td></td>    <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>  </tr></table><p>æ–°æ’å…¥çš„Hç»“ç‚¹ä¼šåœ¨å…ƒç´ Gä¹‹åï¼Œé‚£ä¹ˆæ’åºä¹Ÿå°±æ˜¯ A C G H N è¿™ä¸ªæ ·å­çš„ä¸€ä¸ªæ’åºï¼›é‚£ä¹ˆæ­¤æ—¶çš„ä¸­é—´çš„ç»“ç‚¹å°±æ˜¯Gå…ƒç´ äº†ï¼›é‚£ä¹ˆæŒ‰ç…§è§„åˆ™ï¼Œå½“n&gt;4æ—¶ï¼Œä¸­é—´èŠ‚ç‚¹åˆ†è£‚åˆ°çˆ¶èŠ‚ç‚¹ï¼›æ­¤æ—¶çš„Gå…ƒç´ ç»“ç‚¹å°±å°†ä¼šè¿›è¡Œä¸€æ¬¡åˆ†è£‚ï¼›åˆ†è£‚è‡³çˆ¶èŠ‚ç‚¹ï¼ˆHæ’å…¥è‡³BTreeåˆ™Gåˆ†è£‚è‡³çˆ¶èŠ‚ç‚¹ï¼‰ï¼›è€Œæ­¤æ—¶ä¸¤è¾¹ç»“ç‚¹è¿›è¡Œä¸€æ¬¡åˆ†è£‚ï¼›ä¹Ÿå°±æ˜¯åŸæœ¬çš„ä¸­é—´å…ƒç´ ä¸­é—´èŠ‚ç‚¹Gå·¦è¾¹çš„Aã€Cä»¥åŠå³è¾¹çš„ï¼ˆæ–°æ’å…¥çš„ï¼‰Hã€Nå°±å°†ä¼šè¢«åˆ†è£‚æˆçˆ¶èŠ‚ç‚¹Gçš„ä¸¤è¾¹ç»“ç‚¹ï¼›å·¦è¾¹çš„Aã€Cåˆ†è£‚è‡³çˆ¶èŠ‚ç‚¹Gçš„å·¦å­èŠ‚ç‚¹ï¼›å³è¾¹çš„Hã€Nåˆ†è£‚è‡³çˆ¶èŠ‚ç‚¹Gçš„å³å­ç»“ç‚¹ï¼›  </p><p>æ¥ä¸‹æ¥ç»§ç»­è¿›è¡Œæ’å…¥æ“ä½œï¼›æ’å…¥å…ƒç´ Eï¼›<br>æ’å…¥çš„Eé¦–å…ˆè¿›è¡Œè·Ÿæ ¹ç»“ç‚¹Gè¿›è¡Œæ¯”è¾ƒå‰åé¡ºåºï¼›æ¯”è¾ƒå®Œæˆä¹‹åï¼ŒEåº”è¯¥æ˜¯åœ¨æ ¹ç»“ç‚¹Gçš„æ’ä½åœ¨å‰çš„ï¼›æ‰€ä»¥åº”è¯¥è¢«æ”¾åœ¨æ ¹ç»“ç‚¹Gçš„å·¦ä¾§ï¼›ä¹Ÿå°±æ˜¯ç»“ç‚¹Aã€Cè¯¥ä¾§ï¼ŒAã€Cã€Eè¿™ä¸‰ä¸ªå…ƒç´ ä¹Ÿæ˜¯éœ€è¦è¿›è¡Œæ’å‡ºä¸€ä¸ªé¡ºåºæ¥çš„ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯Aã€Cã€Eè¿™æ ·çš„ä¸€ä¸ªé¡ºåºæ’åˆ—æ”¾ç½®ï¼›æ’å…¥çš„æ˜¯å·¦è¾¹ï¼›ç”±äºå·¦è¾¹å…ƒç´ æœªæ„æˆ5ä¸ªï¼Œæ‰€ä»¥ä¸åšä»»ä½•çš„ï¼ˆåˆ†è£‚ï¼‰å˜åŒ–ç­‰ï¼›  </p><p>æ¥ä¸‹æ¥å†ç»§ç»­æ’å…¥å…ƒç´ Kï¼›<br>åœ¨Kæ’å…¥å…ƒç´ çš„æ—¶å€™å°±éœ€è¦æ‹¿Gä¸Kå…ƒç´ çš„å‰åæ’ä½é¡ºåºè¿›è¡Œæ¯”è¾ƒï¼ŒKçš„æ’ä½é¡ºåºæ¯”Gå¤§ï¼Œæ‰€ä»¥æ’å…¥åˆ°æ ¹ç»“ç‚¹Gçš„å³ä¾§ï¼Œä¹Ÿå°±æ˜¯Hã€Næ‰€åœ¨è¯¥ä¾§ï¼›æ’å…¥çš„æ˜¯å³è¾¹ï¼Œå³æ’å…¥æ—¶ä¹Ÿéœ€è¦ä¸Hã€Nè¿™ä¸¤ä¸ªå…ƒç´ ç›¸è¿›è¡Œæ¯”è¾ƒæ’ä½é¡ºåºï¼Œä¹Ÿå°±æ˜¯Kå…ƒç´ æ’å…¥åˆ°Hã€Nè¿™ä¸¤ä¸ªå…ƒç´ çš„ä¸­é—´ï¼›é‚£ä¹ˆæ­¤æ—¶å³ä¾§çš„å…ƒç´ æœªæ„æˆ5ä¸ªæ‰€ä»¥ä¸ä½œä»»ä½•å˜åŒ–ï¼›  </p><p>æ¥ä¸‹æ¥ç»§ç»­æ’å…¥Qï¼›<br>æ’å…¥Qä¹Ÿæ˜¯éœ€è¦ä¸æ ¹èŠ‚ç‚¹Gç›¸è¿›è¡Œæ¯”è¾ƒæ’ä½é¡ºåºçš„ï¼›å¾—å‡ºQæ˜¯åœ¨Gä¹‹åï¼Œé‚£ä¹ˆå°±å°†Qæ”¾åœ¨Gæ ¹èŠ‚ç‚¹çš„å³ä¾§ï¼Œç„¶åå°†Qè¿›è¡Œä¸èŠ‚ç‚¹å…ƒç´ Hã€Kã€Nç›¸è¿›è¡Œæ¯”è¾ƒï¼›å¾—åˆ°æ’åˆ—é¡ºåºHã€Kã€Nã€Qè¿™æ ·ä¸€ä¸ªæ’åˆ—é¡ºåºï¼Œå½“ç„¶æ­¤æ—¶ä»ç„¶ä¸éœ€è¦åšå‡ºï¼ˆåˆ†è£‚ï¼‰å˜åŒ–ï¼›å› ä¸ºæ­¤æ—¶nå¹¶æ²¡æœ‰è¶…è¿‡4ï¼›åªæœ‰å½“nè¶…è¿‡4çš„æ—¶å€™æ‰ä¼šå‘ç”Ÿåˆ†è£‚çš„å˜åŒ–ï¼›åˆ†å‰å°äºç­‰äº4çš„æƒ…å†µä¸‹å¹¶ä¸åšä»»ä½•çš„åˆ†è£‚æ”¹å˜åªè¿›è¡Œç»“ç‚¹å…ƒç´ é—´çš„å¤§å°æ’ä½ï¼›  </p><p>åœ¨æ­¤ä¹‹å‰ä¸€ç›´åœ¨è¯´åˆ†è£‚ï¼›å½“å‰å·²ç»åˆ†è£‚è¿‡ä¸€æ¬¡ï¼›ä¹Ÿå°±æ˜¯Aã€Cã€Gã€Hã€Nçš„æ—¶å€™è¿›è¡Œå°†Gåˆ†è£‚è‡³çˆ¶èŠ‚ç‚¹ï¼›Aã€Cç»“ç‚¹ä¸Hã€Nç»“ç‚¹è¿›è¡Œä¸¤è¾¹ç»“ç‚¹çš„åˆ†è£‚ï¼›å¹¶ä¸”æ’å…¥äº†ä¸‰ä¸ªæ–°çš„å…ƒç´ Eã€Kã€Qï¼›  </p><p>æ­¤æ—¶éœ€è¦è¯´æ˜çš„æ˜¯ï¼š  </p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ¯ä¸ªéå¶å­ç»“ç‚¹ç”± n ä¸ª <span class="type">key</span> ä¸ n + <span class="number">1</span> ä¸ªæŒ‡é’ˆç»„æˆï¼Œå…¶ä¸­[ cell( m / <span class="number">2</span>) <span class="number">-1</span> ] &lt; = n &lt; = m<span class="number">-1</span></span><br></pre></td></tr></table></figure><p>n+1ä¸ªæŒ‡é’ˆå€¼çš„å°±æ˜¯æ¯ä¸ªç»“ç‚¹ä¸‹éƒ½æœ‰ä¸¤ä¸ªæ–¹å—ï¼Œè¿™ä¸¤ä¸ªæ–¹å—éƒ½æ˜¯æŒ‡é’ˆå­˜å‚¨åŒºåŸŸï¼›<br>æŒ‡é’ˆçš„å«ä¹‰ï¼šå½“è¿›è¡Œæ’å…¥ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œæ¯”å¦‚è¯´æ’å…¥å…ƒç´ Eï¼›å½“æ’å…¥Eå…ƒç´ çš„æ—¶å€™ä¼šè¿›è¡Œä¸æ ¹èŠ‚ç‚¹Gè¿›è¡Œä¸€ä¸ªå‰åé¡ºåºæ’ä½çš„ä¸€ä¸ªå¯¹æ¯”ï¼›å¦‚æœEæ¯”Gè¦å°ï¼›é‚£ä¹ˆEå…ƒç´ å°±éœ€è¦æ”¾åœ¨Gçš„å·¦ä¾§ï¼ŒæŒ‡å‘å·¦ä¾§ï¼›æˆä¸ºæ ¹ç»“ç‚¹å½“ä¸­çš„å·¦å­èŠ‚ç‚¹å½“ä¸­çš„ä¸€ä¸ªï¼›é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±ç”±Gç»“ç‚¹çš„å·¦æŒ‡é’ˆæŒ‡å‘å·¦å­èŠ‚ç‚¹çš„æ–¹å‘ï¼›é€šè¿‡å·¦è¾¹çš„è¿™ä¸ªæŒ‡é’ˆæŒ‡å‘å·¦è¾¹çš„è¿™ä¸ªæ•°æ®å—ï¼›å°äºGé‚£ä¹ˆè¿™ä¸ªæŒ‡é’ˆå°±æŒ‡å‘çš„æ˜¯å°äºGçš„è¿™ä¸ªæ•°æ®å—ï¼ˆä¹Ÿå°±æ˜¯å·¦ä¾§çš„å·¦å­ç»“ç‚¹ï¼‰ï¼›å¤§äºGé‚£ä¹ˆæŒ‡å‘çš„å°±æ˜¯å¤§äºGçš„è¿™ä¸ªæ•°æ®å—ï¼ˆä¹Ÿå°±æ˜¯å³ä¾§çš„å³å­ç»“ç‚¹ï¼‰ï¼›  </p><p>å³</p><table border="1">  <tr>    <td></td>     <td></td>     <td></td>    <td></td>     <td colspan="2" style="text-align:center;background-color:lightblue;color:black;">G</td>     <td></td>    <td></td>     <td></td>    <td></td>    <td></td>  </tr>  <tr>    <td></td>     <td></td>     <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>     <td></td>     <td></td>     <td></td>    <td></td>  </tr>  <tr>    <td colspan="11"></td>  </tr>  <tr>    <td colspan="4" style="text-align:center;background-color:lightblue;color:black;">A<span style="margin-left:5px;margin-right:5px;"></span> C<span style="margin-left:5px;margin-right:5px;"></span> E</td>    <td></td>    <td></td>    <td colspan="5" style="text-align:center;background-color:lightblue;color:black;">H<span style="margin-left:5px;margin-right:5px;"></span>  K<span style="margin-left:5px;margin-right:5px;"></span> N <span style="margin-left:5px;margin-right:5px;"></span> Q</td>  </tr>  <tr>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>    <td></td>    <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>  </tr></table><p>æ¥ä¸‹æ¥ç»§ç»­æ’å…¥Må…ƒç´ ï¼›Mä¸Gæ ¹ç»“ç‚¹ç›¸è¿›è¡Œæ¯”è¾ƒï¼Œåº”è¯¥æ˜¯å±äºåœ¨Gçš„åé¢çš„ï¼›æ‰€ä»¥åº”è¯¥æ’æ”¾åœ¨Gçš„å³ä¾§ï¼›é€šè¿‡Gçš„å³æŒ‡é’ˆæŒ‡å‘å³è¾¹çš„æ•°æ®å—ï¼›Mæ’å…¥è¿›æ¥ä¹‹åï¼Œåº”è¯¥è¦ä»‹äºKå’ŒNä¹‹é—´ï¼›ä¹Ÿå°±æ˜¯è¯´æ­¤æ—¶Gçš„å³å­ç»“ç‚¹å½“ä¸­çš„æ’åˆ—é¡ºåºä¸ºHã€Kã€Mã€Nã€Qè¿™æ ·ä¸€ä¸ªæ’åˆ—é¡ºåºï¼›è¿™ä¸ªæ—¶å€™å°±éœ€è¦å°†Mæ’å…¥åˆ°Kå’ŒNä¹‹é—´ï¼›ä½†æ˜¯å½“Mæ’å…¥åˆ°Kå’ŒNä¹‹é—´ä¹‹åï¼Œæ­¤æ—¶å³å­ç»“ç‚¹å½“ä¸­çš„å…ƒç´ å·²ç»è¶…è¿‡äº†4ä¸ªï¼Œå³5ä¸ªäº†ï¼›è¶…è¿‡4ä¸ªå…ƒç´ é‚£ä¹ˆæ­¤æ—¶å°±è¦å‘ç”Ÿåˆ†è£‚å˜åŒ–ï¼ŒMç»“ç‚¹åˆšå¥½æ˜¯ä¸­é—´èŠ‚ç‚¹ï¼›å³ä¼šè¦å‘ç”Ÿä¸­é—´èŠ‚ç‚¹ï¼ˆæ–°æ’å…¥çš„å…ƒç´ ï¼‰Mç»“ç‚¹å…ƒç´ æœ€ç»ˆéœ€è¦å‘ä¸Šåˆ†è£‚åˆ°Gçˆ¶èŠ‚ç‚¹å½“ä¸­å»ï¼Œä»¥åŠåŒæ—¶å·¦å³ä¸¤è¾¹çš„å…ƒç´ Hã€Kä»¥åŠHã€Qéœ€è¦åˆ†è£‚å˜åŒ–æˆä¸¤å—ï¼›  </p><p>é—®é¢˜ï¼šæ˜ç™½æ²¡æœ‰ï¼Ÿå°æœ‹å‹ï¼Ÿ<br>ç­”ï¼šæ˜ç™½äº†ï¼(à²¥_à²¥)  </p><p>ç»è¿‡åˆ†è£‚ä¹‹åå†æ¥çœ‹å…¶æŒ‡é’ˆï¼›é‚£ä¹ˆæ ¹ç»“ç‚¹å½“ä¸­çš„ä¸‰ä¸ªæŒ‡é’ˆåˆ†åˆ«æŒ‡çš„æ˜¯ï¼›ç¬¬ä¸€ä¸ªæŒ‡é’ˆæŒ‡çš„æ˜¯å°äºæ ¹èŠ‚ç‚¹å½“ä¸­çš„Gå…ƒç´ åˆ™æŒ‡é’ˆæŒ‡å‘å·¦ä¾§ç¬¬ä¸€ä¸ªæ•°æ®å…ƒç´ å—Aã€Cã€Eï¼›ç¬¬äºŒä¸ªæŒ‡é’ˆï¼Œåˆ™å› ä¸ºæ ¹èŠ‚ç‚¹å½“ä¸­å­˜åœ¨ä¸¤ä¸ªå…ƒç´ ï¼›æ‰€ä»¥ä¸­é—´è¿™ä¸ªç¬¬äºŒä¸ªæŒ‡é’ˆç”¨äºå¤§äºæ ¹èŠ‚ç‚¹å½“ä¸­çš„Gå…ƒç´ è€Œå°äºæ ¹èŠ‚ç‚¹å½“ä¸­çš„Må…ƒç´ åˆ™æŒ‡å‘ä¸­é—´çš„Hã€Kçš„è¿™ä¸ªæ•°æ®å—ï¼›æœ€åæ ¹èŠ‚ç‚¹å½“ä¸­çš„ç¬¬ä¸‰ä¸ªæŒ‡é’ˆç”¨äºå¤§äºæ ¹èŠ‚ç‚¹å½“ä¸­Må…ƒç´ çš„æŒ‡å‘ç¬¬ä¸‰ä¸ªæ•°æ®å…ƒç´ å—å³Nã€Qï¼›  </p><p>é—®é¢˜ï¼šæ˜ç™½ï¼Ÿå°æœ‹å‹ï¼Ÿ<br>ç­”ï¼šæ˜ç™½äº†ï¼o(ï¾ŸĞ”ï¾Ÿ)ã£ï¼  </p><p>å½“å‰ä¸ºæ’å…¥Mçš„æ•°æ®ç»“æ„ï¼›  </p><table border="1">  <tr>    <td></td>     <td></td>     <td></td>     <td></td>     <td></td>    <td></td>     <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">G<span style="margin-left:5px;margin-right:5px;"></span> M</td>     <td></td>    <td></td>     <td></td>    <td></td>    <td></td>  </tr>  <tr>    <td></td>    <td></td>    <td></td>     <td></td>     <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>    <td></td>     <td></td>     <td></td>     <td></td>  </tr>  <tr>    <td colspan="14"></td>  </tr>  <tr>    <td colspan="4" style="text-align:center;background-color:lightblue;color:black;">A<span style="margin-left:5px;margin-right:5px;"></span> C<span style="margin-left:5px;margin-right:5px;"></span> E</td>    <td></td>    <td></td>    <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">H<span style="margin-left:5px;margin-right:5px;"></span>  K    </td>    <td></td>    <td></td>      <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">    N <span style="margin-left:5px;margin-right:5px;"></span> Q</td>      </tr>  <tr>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>    <td></td>    <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>    <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>  </tr></table><p>å½“å‰Mæ’å…¥å®Œæˆä¹‹åï¼Œç»§ç»­æ’å…¥Fã€Wã€Lã€Tè¿™å››ä¸ªæ•°æ®å…ƒç´ ï¼›<br>é‚£ä¹ˆæ­¤æ—¶æ’å…¥Fã€Wã€Lã€Tè¿™å››ä¸ªæ•°æ®å…ƒç´ æ—¶æ˜¯ä¸éœ€è¦è¿›è¡Œåˆ†è£‚å˜åŒ–çš„ï¼›å› ä¸ºå½“è¿™å››ä¸ªå…ƒç´ æ’å…¥è¿›æ¥ä¹‹åï¼Œå„ä¸ªæ•°æ®å—å½“ä¸­çš„key ç»“ç‚¹éƒ½æ²¡æœ‰è¶…è¿‡4ï¼›æ‰€ä»¥æ˜¯ä¸éœ€è¦è¿›è¡Œåˆ†è£‚å˜åŒ–å¤„ç†çš„ï¼›  </p><table border="1">  <tr>    <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>    <td></td>     <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">G<span style="margin-left:5px;margin-right:5px;"></span> M</td>     <td></td>    <td></td>     <td></td>    <td></td>    <td></td>    <td></td>    <td></td>  </tr>  <tr>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>     <td></td>     <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>    <td></td>    <td></td>    <td></td>     <td></td>     <td></td>     <td></td>  </tr>  <tr>    <td colspan="18"></td>  </tr>  <tr>    <td colspan="5" style="text-align:center;background-color:lightblue;color:black;">A<span style="margin-left:5px;margin-right:5px;"></span> C<span style="margin-left:5px;margin-right:5px;"></span> E<span style="margin-left:5px;margin-right:5px;"></span> F</td>    <td></td>    <td></td>    <td colspan="4" style="text-align:center;background-color:lightblue;color:black;">H<span style="margin-left:5px;margin-right:5px;"></span>  K<span style="margin-left:5px;margin-right:5px;"></span> L    </td>    <td></td>    <td></td>      <td colspan="5" style="text-align:center;background-color:lightblue;color:black;">    N <span style="margin-left:5px;margin-right:5px;"></span> Q<span style="margin-left:5px;margin-right:5px;"></span> T<span style="margin-left:5px;margin-right:5px;"></span> W</td>      </tr>  <tr>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>    <td></td>    <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>    <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>  </tr></table><p>ä¸Šè¿°Fã€Wã€Lã€Tè¿™å››ä¸ªå…ƒç´ æ’å…¥å®Œæˆä¹‹åï¼Œæ¥ç€æ’å…¥å…ƒç´ Zï¼›<br>æ’å…¥Zçš„æ—¶å€™ï¼Œé¦–å…ˆä¼šè¿›è¡Œä¸æ ¹èŠ‚ç‚¹çš„Gå’ŒMç›¸è¿›è¡Œæ¯”è¾ƒï¼›Zå…ƒç´ æ¯”Gã€Méƒ½è¦å¤§ï¼›æ‰€ä»¥å°±ç”±æ ¹ç»“ç‚¹çš„ç¬¬ä¸‰ä¸ªæŒ‡é’ˆæŒ‡å‘ç¬¬ä¸‰ä¸ªæ•°æ®å—ï¼Œä¹Ÿå°±æ˜¯Nã€Qã€Tã€Wï¼›èµ°å‘ç¬¬ä¸‰ä¸ªæ•°æ®å—æ—¶åˆä¼šä¸ç¬¬ä¸‰ä¸ªæ•°æ®å—å½“ä¸­çš„å…ƒç´ ç›¸è¿›è¡Œæ¯”è¾ƒå¾—åˆ°å…¶å…ƒç´ æ’åˆ—é¡ºåºNã€Qã€Tã€Wã€Zè¿™æ ·ä¸€ä¸ªæ’åˆ—æ‘†æ”¾ä½ç½®ï¼›æ‰€ä»¥æ­¤æ—¶å°†Zæ’å…¥ç¬¬ä¸‰ä¸ªæ•°æ®å—å½“ä¸­çš„æœ€åä¸€ä¸ªä½ç½®ï¼Œå½“Zå…ƒç´ å‡ºç°åœ¨Wå…ƒç´ ä¹‹åçš„æ—¶å€™ï¼Œæ­¤æ—¶è§‚å¯Ÿç¬¬ä¸‰ä¸ªæ•°æ®åº“å—å½“ä¸­çš„å…ƒç´ ä¸ªæ•°å·²ç»è¶…è¿‡äº†4ï¼Œå³å·²ç»æˆä¸º5ä¸ªäº†ï¼Œé‚£ä¹ˆæ­¤æ—¶è¿™5ä¸ªå…ƒç´ å½“ä¸­ä¸­é—´å…ƒç´ éœ€è¦è¿›è¡Œå‘ä¸Šåˆ†è£‚ï¼Œåˆ†è£‚è‡³çˆ¶èŠ‚ç‚¹ï¼Œç„¶åå…¶å·¦å³ä¸¤è¾¹éœ€è¦åˆ†è£‚æˆä¸¤ä¸ªæ•°æ®å—ï¼›è¯¥ç¬¬ä¸‰ä¸ªæ•°æ®å—å½“ä¸­çš„ä¸­é—´å…ƒç´ ä¸ºTï¼›Tå…ƒç´ æ­¤æ—¶åº”å½“ç¬¦åˆæ¡ä»¶éœ€è¦åˆ†è£‚è‡³ä¸Šä¸€èŠ‚ç‚¹çˆ¶èŠ‚ç‚¹å½“ä¸­å»ï¼›ä»¥åŠTå…ƒç´ åœ¨åˆ†è£‚è‡³çˆ¶èŠ‚ç‚¹ä¹‹å‰åŸæ¥ä¸¤è¾¹çš„ç»“ç‚¹éœ€è¦è¿›è¡Œåˆ†è£‚æˆä¸¤å—ä¹Ÿå°±æ˜¯Nã€Qç»“ç‚¹ä»¥åŠWã€Zç»“ç‚¹è¿™ä¸¤å¤§å—è¿›è¡Œåˆ†è£‚å¼€æ¥ç§°ä¸ºå•ç‹¬çš„ç»“ç‚¹ï¼›</p><table border="1">  <tr>    <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>    <td></td>     <td colspan="4" style="text-align:center;background-color:lightblue;color:black;">G<span style="margin-left:5px;margin-right:5px;"></span> M<span style="margin-left:5px;margin-right:5px;"></span> T</td>     <td></td>    <td></td>     <td></td>    <td></td>    <td></td>    <td></td>    <td></td>  </tr>  <tr>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>     <td></td>     <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>    <td></td>    <td></td>    <td></td>     <td></td>     <td></td>     <td></td>  </tr>  <tr>    <td colspan="20"></td>  </tr>  <tr>    <td colspan="5" style="text-align:center;background-color:lightblue;color:black;">A<span style="margin-left:5px;margin-right:5px;"></span> C<span style="margin-left:5px;margin-right:5px;"></span> E<span style="margin-left:5px;margin-right:5px;"></span> F</td>    <td></td>    <td></td>    <td colspan="4" style="text-align:center;background-color:lightblue;color:black;">H<span style="margin-left:5px;margin-right:5px;"></span>  K<span style="margin-left:5px;margin-right:5px;"></span> L    </td>    <td></td>    <td></td>      <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">    N <span style="margin-left:5px;margin-right:5px;"></span> Q<span style="margin-left:5px;margin-right:5px;"></span>     </td>    <td></td><td colspan="3" style="text-align:center;background-color:lightblue;color:black;">    W<span style="margin-left:5px;margin-right:5px;"></span> Z</td>      </tr>  <tr>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>    <td></td>    <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>    <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>  </tr></table><p>å½“å…ƒç´ Zæ’å…¥å®Œæˆä¹‹åï¼Œæ¥ä¸‹æ¥è¿›è¡Œæ’å…¥å…ƒç´ Dï¼›<br>å…ƒç´ Då’Œæ ¹ç»“ç‚¹å½“ä¸­çš„Gã€Mã€Tç›¸æ¯”ï¼Œæ˜¾ç„¶æ˜¯éƒ½å°äºè¿™ä¸‰è€…çš„ï¼›æ‰€ä»¥ç”±æ ¹ç»“ç‚¹å½“ä¸­çš„ç¬¬ä¸€ä¸ªæŒ‡é’ˆè¿›è¡ŒæŒ‡å‘ç¬¬ä¸€ä¸ªæ•°æ®å—ï¼Œä¹Ÿå°±æ˜¯Aã€Cã€Eã€Fè¿™ä¸ªæ•°æ®å—å½“ä¸­æ¥ï¼›å¹¶ä¸”Då…ƒç´ éœ€è¦è¿›è¡Œä¸æ•°æ®å—å…ƒç´ å½“ä¸­çš„Aã€Cã€Eã€Fè¿™å››ä¸ªå…ƒç´ éœ€è¦è¿›è¡Œæ¯”è¾ƒæ’åºé¡ºåºå¤§å°ï¼›å³é€šè¿‡æ’åºé¡ºåºå¯å¾—Aã€Cã€Dã€Eã€Fï¼›æ’å…¥è¿›æ¥ä¹‹åï¼Œæ­¤æ—¶è¯¥æ•°æ®å—å½“ä¸­çš„keyå…ƒç´ å¤§äº4ä¸ªäº†ï¼Œå³å‡ºç°äº†5ä¸ªï¼›é‚£ä¹ˆæ­¤æ—¶å°±éœ€è¦å°†è¯¥æ•°æ®å—å…ƒç´ å½“ä¸­çš„é‚£ä¸ªä¸­é—´å…ƒç´ ï¼ˆDä½œä¸ºè¯¥æ•°æ®å—å½“ä¸­çš„ä¸­é—´å…ƒç´ å­˜åœ¨ï¼‰ï¼Œä¹Ÿå°±æ˜¯åˆšåˆšæ–°æ’å…¥çš„å…ƒç´ Dè¿›è¡Œå‘ä¸Šåˆ†è£‚è‡³çˆ¶èŠ‚ç‚¹Gã€Mã€Tå½“ä¸­å»ï¼Œä¸”åˆ†è£‚è‡³çˆ¶èŠ‚ç‚¹çš„å…ƒç´ Dä¹Ÿéœ€è¦ä¸Gã€Mã€Tè¿›è¡Œä¸€ä¸ªæ’åºï¼Œæ’åºå¾—åˆ°Dã€Gã€Mã€Tè¿™æ ·ä¸€ä¸ªæ’åˆ—é¡ºåºï¼›é‚£ä¹ˆæ­¤æ—¶åˆ†è£‚è‡³çˆ¶èŠ‚ç‚¹çš„å…ƒç´ Dçš„ä¸¤è¾¹çš„å…ƒç´ åŒæ ·ä¹Ÿéœ€è¦è¿›è¡Œåˆ†è£‚æˆä¸¤ä¸ªç»“ç‚¹ï¼›å³Aã€Cä¸Eã€Fè¿›è¡Œåˆ†è£‚å¼€æ¥ï¼›<br>æœ€ç»ˆå‡ºç°çš„æ•°æ®ç»“æ„ï¼š  </p><table border="1">  <tr>    <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>    <td></td>     <td colspan="5" style="text-align:center;background-color:lightblue;color:black;">D<span style="margin-left:5px;margin-right:5px;"></span> G<span style="margin-left:5px;margin-right:5px;"></span> M<span style="margin-left:5px;margin-right:5px;"></span> T</td>     <td></td>    <td></td>     <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>  </tr>  <tr>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>     <td></td>     <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>    <td></td>    <td></td>    <td></td>    <td></td>     <td></td>     <td></td>     <td></td>  </tr>  <tr>    <td colspan="22"></td>  </tr>  <tr>    <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">A<span style="margin-left:5px;margin-right:5px;"></span> C    </td>    <td></td>    <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">E<span style="margin-left:5px;margin-right:5px;"></span> F</td>    <td></td>    <td></td>    <td colspan="4" style="text-align:center;background-color:lightblue;color:black;">H<span style="margin-left:5px;margin-right:5px;"></span>  K<span style="margin-left:5px;margin-right:5px;"></span> L    </td>    <td></td>    <td></td>      <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">    N <span style="margin-left:5px;margin-right:5px;"></span> Q<span style="margin-left:5px;margin-right:5px;"></span>     </td>    <td></td><td colspan="3" style="text-align:center;background-color:lightblue;color:black;">    W<span style="margin-left:5px;margin-right:5px;"></span> Z</td>      </tr>  <tr>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>    <td></td>    <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>    <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>  </tr></table><p>å½“å…ƒç´ Dæ’å…¥å®Œæˆä¹‹åï¼Œæ¥ç€è¿›è¡Œæ’å…¥å…ƒç´ Pã€Rã€Xã€Yï¼›<br>æ’å…¥Pã€Rã€Xã€Yæ—¶å¹¶ä¸éœ€è¦è¿›è¡Œç›¸åº”çš„å˜åŒ–åˆ†è£‚ï¼›å› ä¸ºæ’å…¥åˆ°æ•°æ®å—å½“ä¸­å…ƒç´ keyå¹¶æ²¡æœ‰æ»¡è¶³ &gt; 4 çš„è¿™æ ·ä¸€ä¸ªæ¡ä»¶ï¼›æ‰€ä»¥å¹¶ä¸éœ€è¦åšå‡ºåˆ†è£‚ï¼›  </p><table border="1">  <tr>    <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>    <td></td>     <td colspan="5" style="text-align:center;background-color:lightblue;color:black;">D<span style="margin-left:5px;margin-right:5px;"></span> G<span style="margin-left:5px;margin-right:5px;"></span> M<span style="margin-left:5px;margin-right:5px;"></span> T</td>     <td></td>    <td></td>     <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>  </tr>  <tr>    <td></td>    <td></td>     <td></td>     <td></td>     <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>     <td></td>     <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>    <td></td>    <td></td>    <td></td>    <td></td>     <td></td>     <td></td>     <td></td>  </tr>  <tr>    <td colspan="26"></td>  </tr>  <tr>    <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">A<span style="margin-left:5px;margin-right:5px;"></span> C    </td>    <td></td>    <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">E<span style="margin-left:5px;margin-right:5px;"></span> F</td>    <td></td>    <td></td>    <td colspan="4" style="text-align:center;background-color:lightblue;color:black;">H<span style="margin-left:5px;margin-right:5px;"></span>  K<span style="margin-left:5px;margin-right:5px;"></span> L    </td>    <td></td>    <td></td>      <td colspan="5" style="text-align:center;background-color:lightblue;color:black;">    N<span style="margin-left:5px;margin-right:5px;"></span> P<span style="margin-left:5px;margin-right:5px;"></span> Q<span style="margin-left:5px;margin-right:5px;"></span> R</td>    <td></td><td colspan="5" style="text-align:center;background-color:lightblue;color:black;">    W<span style="margin-left:5px;margin-right:5px;"></span> X<span style="margin-left:5px;margin-right:5px;"></span> Y<span style="margin-left:5px;margin-right:5px;"></span> Z</td>      </tr>  <tr>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>    <td></td>    <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>    <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>  </tr></table><p>å½“æ’å…¥å…ƒç´ Pã€Rã€Xã€Yè¿™å››ä¸ªå…ƒç´ ä¹‹åï¼Œæ¥ä¸‹æ¥è¿›è¡Œæ’å…¥æœ€åä¸€ä¸ªå…ƒç´ Sï¼›<br>Sé¦–å…ˆå’Œæ ¹ç»“ç‚¹å½“ä¸­çš„æ˜¯ä¸ªå…ƒç´ Dã€Gã€Mã€Tè¿›è¡Œæ¯”è¾ƒï¼›æ˜¾ç„¶ä»‹äºMä¸Tä¹‹é—´ï¼›å³å¤§äºMè€Œå°äºTè¿™æ ·ä¸€ä¸ªèŒƒå›´ï¼›ä»è€Œä½¿å¾—æ ¹ç»“ç‚¹çš„ç¬¬å››ä¸ªæŒ‡é’ˆæŒ‡å‘ç¬¬å››ä¸ªæ•°æ®å—ï¼Œå³Nã€Pã€Qã€Rè¿™ä¸€ä¸ªæ•°æ®å—å½“ä¸­ï¼›è€Œå½“Sæ’å…¥åˆ°ç¬¬å››ä¸ªæ•°æ®å—å½“ä¸­é¦–å…ˆä¹Ÿæ˜¯éœ€è¦è¿›è¡Œæ¯”è¾ƒæ’åºé¡ºåºå¤§å°çš„ï¼›æœ‰é¡ºåºå¯å¾—ï¼›å¾—åˆ°é¡ºåºä¸ºNã€Pã€Qã€Rã€Sè¿™æ ·ä¸€ä¸ªé¡ºåºæ’åˆ—ï¼›å°†Sæ’å…¥åˆ°è¯¥æ•°æ®å—å½“ä¸­æ¥ï¼›æ­¤æ—¶ç¬¬å››ä¸ªæ•°æ®å—å½“ä¸­çš„å…ƒç´ ä¸ªæ•°å·²ç»è¾¾åˆ°äº†5ä¸ªï¼Œä¹Ÿå°±æ˜¯è¶…è¿‡äº†4ä¸ªå°±éœ€è¦è¿›è¡Œåˆ†è£‚äº†ï¼›é‚£ä¹ˆæ­¤æ—¶ï¼›è¯¥æ•°æ®å—å½“ä¸­çš„ä¸­é—´å…ƒç´ ä¸ºQï¼›ä¹Ÿå°±æ˜¯Qå…ƒç´ éœ€è¦è¿›è¡Œå‘ä¸Šåˆ†è£‚è‡³çˆ¶èŠ‚ç‚¹Dã€Gã€Mã€Tè¯¥æ•°æ®å—å½“ä¸­å»ï¼›ä»¥åŠQå…ƒç´ ä¸¤è¾¹çš„å…ƒç´ éœ€è¦è¿›è¡Œåˆ†è£‚ï¼Œä¹Ÿå°±æ˜¯Nã€Pä¸Rã€Sè¿™ä¸¤å—åˆ†è£‚å¼€æ¥ï¼›<br>ä½†æ˜¯Qå¦‚æœæ­¤æ—¶å‘ä¸Šè¿›è¡Œåˆ†è£‚ï¼Œè€Œæ­¤æ—¶çˆ¶èŠ‚ç‚¹å½“ä¸­çš„å…ƒç´ å¯¹å‘ä¸Šåˆ†è£‚æ¥çš„Qå…ƒç´ è¿›è¡Œæ’åºå¾—åˆ°Dã€Gã€Mã€Qã€Tï¼›çˆ¶èŠ‚ç‚¹æ’å…¥å…ƒç´ Qï¼›çˆ¶èŠ‚ç‚¹å½“ä¸­çš„å…ƒç´ ä¹Ÿè¾¾åˆ°äº†äº†5ä¸ªï¼›ä¹Ÿéœ€è¦è¿›è¡Œåˆ†è£‚ï¼›å…¶çˆ¶èŠ‚ç‚¹å½“ä¸­çš„ä¸­é—´å…ƒç´ ä¸ºMå…ƒç´ ï¼Œåˆ™æ­¤æ—¶Må…ƒç´ ç»§ç»­å‘ä¸Šè¿›è¡Œåˆ†è£‚ï¼Œåˆ™Mæ›´æ–°ç§°ä¸ºè¯¥BTreeçš„æ ¹èŠ‚ç‚¹ï¼›è€ŒMä¸¤è¾¹çš„å…ƒç´ ï¼Œå³Dã€Gä¸¤å…ƒç´ ä¸Qã€Tä¸¤å…ƒç´ åˆ™è¿™ä¸¤å—è¿›è¡Œåˆ†è£‚å¼€æ¥ï¼ŒDã€Gå—ç§°ä¸ºæ ¹ç»“ç‚¹Mçš„å·¦å­èŠ‚ç‚¹ï¼ŒQã€Tå—ç§°ä¸ºMæ ¹ç»“ç‚¹çš„å³å­ç»“ç‚¹ï¼›è¿™å°±æ˜¯æ‰€æåˆ°çš„äº”å‰BTreeç»“æ„çš„ä¸€ä¸ªæ¼”å˜è¿‡ç¨‹ï¼›</p><table border="1">  <tr>    <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>    <td></td>     <td colspan="2" style="text-align:center;background-color:lightblue;color:black;">M</td>     <td></td>    <td></td>     <td></td>    <td></td>    <td></td><td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>  </tr>  <tr>    <td></td>    <td></td>     <td></td>     <td></td>     <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>     <td></td>     <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>    <td></td>    <td></td>    <td></td>    <td></td><td></td>    <td></td>    <td></td>    <td></td>    <td></td>     <td></td>     <td></td>     <td></td>  </tr>  <tr>    <td colspan="28"></td>  </tr>  <tr>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">D<span style="margin-left:5px;margin-right:5px;"></span>  G    </td>    <td></td>    <td></td>      <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">    Q <span style="margin-left:5px;margin-right:5px;"></span> T</td>         <td></td>    <td></td>    <td></td>    <td></td>    <td></td><td></td>    <td></td>    <td></td>    <td></td>    <td></td>  </tr>  <tr>      <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>    <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>      <td></td>    <td></td>    <td></td>    <td></td>    <td></td><td></td>    <td></td>    <td></td>    <td></td>    <td></td>  </tr>  <tr>    <td colspan="28"></td>  </tr>  <tr>    <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">A<span style="margin-left:5px;margin-right:5px;"></span> C    </td>    <td></td>    <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">E<span style="margin-left:5px;margin-right:5px;"></span> F</td>    <td></td>    <td></td>    <td colspan="4" style="text-align:center;background-color:lightblue;color:black;">H<span style="margin-left:5px;margin-right:5px;"></span>  K<span style="margin-left:5px;margin-right:5px;"></span> L    </td>    <td></td>    <td></td>      <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">    N<span style="margin-left:5px;margin-right:5px;"></span> P</td>    <td></td>    <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">R<span style="margin-left:5px;margin-right:5px;"></span> S</td>    <td></td><td colspan="5" style="text-align:center;background-color:lightblue;color:black;">    W<span style="margin-left:5px;margin-right:5px;"></span> X<span style="margin-left:5px;margin-right:5px;"></span> Y<span style="margin-left:5px;margin-right:5px;"></span> Z</td>      </tr>  <tr>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>    <td></td>    <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>    <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>      <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>  </tr></table><p>äº†è§£äº†äº”å‰BTreeæ•°æ®ç»“æ„çš„ä¸€ä¸ªæ¼”å˜è¿‡ç¨‹ä¹‹åå›è¿‡å¤´æ¥å†çœ‹ï¼›ä¸€æ£µmå‰çš„BTreeç‰¹æ€§ï¼›<br>å¦‚æœæ˜¯ä¸€ä¸ªäº”å‰çš„BTreeï¼›<br>åˆ™ï¼š  </p><ul><li>æ ‘ä¸­æ¯ä¸ªç»“ç‚¹æœ€å¤šåŒ…å«mä¸ªå­©å­ï¼›å³æ ‘ä¸­æ¯ä¸ªç»“ç‚¹æœ€å¤šåŒ…å«5ä¸ªå­©å­ï¼›ä¸èƒ½å¤šäº5ä¸ªï¼Œå³ä¸èƒ½å¤šäºmä¸ªï¼›  </li></ul><blockquote><p>ä¸¾ä¾‹</p></blockquote><table border="1">  <tr>    <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>    <td></td>     <td colspan="5" style="text-align:center;background-color:lightblue;color:black;">D<span style="margin-left:5px;margin-right:5px;"></span> G<span style="margin-left:5px;margin-right:5px;"></span> M<span style="margin-left:5px;margin-right:5px;"></span> T</td>     <td></td>    <td></td>     <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>  </tr>  <tr>    <td></td>    <td></td>     <td></td>     <td></td>     <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>     <td></td>     <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>    <td></td>    <td></td>    <td></td>    <td></td>     <td></td>     <td></td>     <td></td>  </tr>  <tr>    <td colspan="26"></td>  </tr>  <tr>    <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">A<span style="margin-left:5px;margin-right:5px;"></span> C    </td>    <td></td>    <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">E<span style="margin-left:5px;margin-right:5px;"></span> F</td>    <td></td>    <td></td>    <td colspan="4" style="text-align:center;background-color:lightblue;color:black;">H<span style="margin-left:5px;margin-right:5px;"></span>  K<span style="margin-left:5px;margin-right:5px;"></span> L    </td>    <td></td>    <td></td>      <td colspan="5" style="text-align:center;background-color:lightblue;color:black;">    N<span style="margin-left:5px;margin-right:5px;"></span> P<span style="margin-left:5px;margin-right:5px;"></span> Q<span style="margin-left:5px;margin-right:5px;"></span> R</td>    <td></td><td colspan="5" style="text-align:center;background-color:lightblue;color:black;">    W<span style="margin-left:5px;margin-right:5px;"></span> X<span style="margin-left:5px;margin-right:5px;"></span> Y<span style="margin-left:5px;margin-right:5px;"></span> Z</td>      </tr>  <tr>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>    <td></td>    <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>    <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>  </tr></table><ul><li>é™¤æ ¹ç»“ç‚¹ä¸å¶å­ç»“ç‚¹å¤–ï¼Œæ¯ä¸ªç»“ç‚¹è‡³å°‘æœ‰ [ cell( m / 2 )]ä¸ªå­©å­ï¼›å³æ¯ä¸ªç»“ç‚¹è‡³å°‘æœ‰5/2=3ï¼ˆå‘ä¸Šå–æ•´ï¼‰ä¸ªå­©å­ï¼›Mä¸ºæ ¹èŠ‚ç‚¹ï¼›ACå—ã€EFå—ã€HKLå—ã€NPå—ã€RSå—ã€WXYZå—ä¸ºå¶å­ç»“ç‚¹ï¼›æ‰€ä»¥ä»…å‰©DGå—ä¸QTå—éå¶å­ç»“ç‚¹ä¹Ÿéæ ¹èŠ‚ç‚¹ï¼›è¿™ä¸¤å—åˆ†åˆ«æœ‰ä¸‰ä¸ªå­—èŠ‚ç‚¹ï¼ŒDGå—çš„å­©å­å³ACå—ã€EFå—ã€HKLå—ï¼›QTå—çš„å­©å­å³NPå—ã€RSå—ã€WXYZå—ï¼›  </li></ul><blockquote><p>ä¸¾ä¾‹</p></blockquote><table border="1">  <tr>    <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>    <td></td>     <td colspan="2" style="text-align:center;background-color:lightblue;color:black;">M</td>     <td></td>    <td></td>     <td></td>    <td></td>    <td></td><td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>  </tr>  <tr>    <td></td>    <td></td>     <td></td>     <td></td>     <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>     <td></td>     <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>    <td></td>    <td></td>    <td></td>    <td></td><td></td>    <td></td>    <td></td>    <td></td>    <td></td>     <td></td>     <td></td>     <td></td>  </tr>  <tr>    <td colspan="28"></td>  </tr>  <tr>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">D<span style="margin-left:5px;margin-right:5px;"></span>  G    </td>    <td></td>    <td></td>      <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">    Q <span style="margin-left:5px;margin-right:5px;"></span> T</td>         <td></td>    <td></td>    <td></td>    <td></td>    <td></td><td></td>    <td></td>    <td></td>    <td></td>    <td></td>  </tr>  <tr>      <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>    <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>      <td></td>    <td></td>    <td></td>    <td></td>    <td></td><td></td>    <td></td>    <td></td>    <td></td>    <td></td>  </tr>  <tr>    <td colspan="28"></td>  </tr>  <tr>    <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">A<span style="margin-left:5px;margin-right:5px;"></span> C    </td>    <td></td>    <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">E<span style="margin-left:5px;margin-right:5px;"></span> F</td>    <td></td>    <td></td>    <td colspan="4" style="text-align:center;background-color:lightblue;color:black;">H<span style="margin-left:5px;margin-right:5px;"></span>  K<span style="margin-left:5px;margin-right:5px;"></span> L    </td>    <td></td>    <td></td>      <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">    N<span style="margin-left:5px;margin-right:5px;"></span> P</td>    <td></td>    <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">R<span style="margin-left:5px;margin-right:5px;"></span> S</td>    <td></td><td colspan="5" style="text-align:center;background-color:lightblue;color:black;">    W<span style="margin-left:5px;margin-right:5px;"></span> X<span style="margin-left:5px;margin-right:5px;"></span> Y<span style="margin-left:5px;margin-right:5px;"></span> Z</td>      </tr>  <tr>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>    <td></td>    <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>    <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>      <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>  </tr></table><ul><li>è‹¥æ ¹ç»“ç‚¹ä¸æ˜¯å¶å­ç»“ç‚¹ï¼Œåˆ™è‡³å°‘æœ‰ä¸¤ä¸ªå­©å­ï¼›</li></ul><blockquote><p>ä¸¾ä¾‹</p></blockquote><table border="1">  <tr>    <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>    <td></td>     <td colspan="2" style="text-align:center;background-color:lightblue;color:black;">M</td>     <td></td>    <td></td>     <td></td>    <td></td>    <td></td><td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>  </tr>  <tr>    <td></td>    <td></td>     <td></td>     <td></td>     <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>     <td></td>     <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>    <td></td>    <td></td>    <td></td>    <td></td><td></td>    <td></td>    <td></td>    <td></td>    <td></td>     <td></td>     <td></td>     <td></td>  </tr>  <tr>    <td colspan="28"></td>  </tr>  <tr>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">D<span style="margin-left:5px;margin-right:5px;"></span>  G    </td>    <td></td>    <td></td>      <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">    Q <span style="margin-left:5px;margin-right:5px;"></span> T</td>         <td></td>    <td></td>    <td></td>    <td></td>    <td></td><td></td>    <td></td>    <td></td>    <td></td>    <td></td>  </tr>  <tr>      <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>    <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>      <td></td>    <td></td>    <td></td>    <td></td>    <td></td><td></td>    <td></td>    <td></td>    <td></td>    <td></td>  </tr>  <tr>    <td colspan="28"></td>  </tr>  <tr>    <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">A<span style="margin-left:5px;margin-right:5px;"></span> C    </td>    <td></td>    <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">E<span style="margin-left:5px;margin-right:5px;"></span> F</td>    <td></td>    <td></td>    <td colspan="4" style="text-align:center;background-color:lightblue;color:black;">H<span style="margin-left:5px;margin-right:5px;"></span>  K<span style="margin-left:5px;margin-right:5px;"></span> L    </td>    <td></td>    <td></td>      <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">    N<span style="margin-left:5px;margin-right:5px;"></span> P</td>    <td></td>    <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">R<span style="margin-left:5px;margin-right:5px;"></span> S</td>    <td></td><td colspan="5" style="text-align:center;background-color:lightblue;color:black;">    W<span style="margin-left:5px;margin-right:5px;"></span> X<span style="margin-left:5px;margin-right:5px;"></span> Y<span style="margin-left:5px;margin-right:5px;"></span> Z</td>      </tr>  <tr>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>    <td></td>    <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>    <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>      <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>  </tr></table><ul><li>æ‰€æœ‰çš„å¶å­ç»“ç‚¹éƒ½åœ¨åŒä¸€å±‚ï¼›</li></ul><blockquote><p>ä¸¾ä¾‹</p></blockquote><table border="1">  <tr>    <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>    <td></td>     <td colspan="2" style="text-align:center;background-color:lightblue;color:black;">M</td>     <td></td>    <td></td>     <td></td>    <td></td>    <td></td><td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>  </tr>  <tr>    <td></td>    <td></td>     <td></td>     <td></td>     <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>     <td></td>     <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>    <td></td>    <td></td>    <td></td>    <td></td><td></td>    <td></td>    <td></td>    <td></td>    <td></td>     <td></td>     <td></td>     <td></td>  </tr>  <tr>    <td colspan="28"></td>  </tr>  <tr>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">D<span style="margin-left:5px;margin-right:5px;"></span>  G    </td>    <td></td>    <td></td>      <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">    Q <span style="margin-left:5px;margin-right:5px;"></span> T</td>         <td></td>    <td></td>    <td></td>    <td></td>    <td></td><td></td>    <td></td>    <td></td>    <td></td>    <td></td>  </tr>  <tr>      <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>    <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>      <td></td>    <td></td>    <td></td>    <td></td>    <td></td><td></td>    <td></td>    <td></td>    <td></td>    <td></td>  </tr>  <tr>    <td colspan="28"></td>  </tr>  <tr>    <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">A<span style="margin-left:5px;margin-right:5px;"></span> C    </td>    <td></td>    <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">E<span style="margin-left:5px;margin-right:5px;"></span> F</td>    <td></td>    <td></td>    <td colspan="4" style="text-align:center;background-color:lightblue;color:black;">H<span style="margin-left:5px;margin-right:5px;"></span>  K<span style="margin-left:5px;margin-right:5px;"></span> L    </td>    <td></td>    <td></td>      <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">    N<span style="margin-left:5px;margin-right:5px;"></span> P</td>    <td></td>    <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">R<span style="margin-left:5px;margin-right:5px;"></span> S</td>    <td></td><td colspan="5" style="text-align:center;background-color:lightblue;color:black;">    W<span style="margin-left:5px;margin-right:5px;"></span> X<span style="margin-left:5px;margin-right:5px;"></span> Y<span style="margin-left:5px;margin-right:5px;"></span> Z</td>      </tr>  <tr>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>    <td></td>    <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>    <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>      <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>  </tr></table><ul><li>æ¯ä¸ªéå¶å­ç»“ç‚¹ç”±nä¸ªkeyä¸n+1ä¸ªæŒ‡é’ˆç»„æˆï¼›å…¶ä¸­[ cell( m / 2)-1] &lt; = n &lt; = m - 1ï¼›å³</li></ul><p>keyå³æŒ‡çš„æ¯ä¸€ä¸ªç»“ç‚¹å½“ä¸­çš„å…ƒç´ ï¼›æŒ‡é’ˆå³ç”¨æ¥æŒ‡å‘æ•°æ®å—</p><table border="1">  <tr>    <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>     <td></td>    <td></td>     <td colspan="3" style="text-align:center;background-color:lightblue;color:black;">G<span style="margin-left:5px;margin-right:5px;"></span> M</td>     <td></td>    <td></td>     <td></td>    <td></td>    <td></td>    <td></td>    <td></td>  </tr>  <tr>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>     <td></td>     <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>    <td></td>    <td></td>    <td></td>     <td></td>     <td></td>     <td></td>  </tr>  <tr>    <td colspan="18"></td>  </tr>  <tr>    <td colspan="5" style="text-align:center;background-color:lightblue;color:black;">A<span style="margin-left:5px;margin-right:5px;"></span> C<span style="margin-left:5px;margin-right:5px;"></span> E<span style="margin-left:5px;margin-right:5px;"></span> F</td>    <td></td>    <td></td>    <td colspan="4" style="text-align:center;background-color:lightblue;color:black;">H<span style="margin-left:5px;margin-right:5px;"></span>  K<span style="margin-left:5px;margin-right:5px;"></span> L    </td>    <td></td>    <td></td>      <td colspan="5" style="text-align:center;background-color:lightblue;color:black;">    N <span style="margin-left:5px;margin-right:5px;"></span> Q<span style="margin-left:5px;margin-right:5px;"></span> T<span style="margin-left:5px;margin-right:5px;"></span> W</td>      </tr>  <tr>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td></td>    <td></td>    <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>    <td></td>    <td></td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>     <td style="background-color:lightgreen;color:black;">æŒ‡é’ˆ</td>  </tr></table><p>åˆ°æ­¤å·²ç»æåˆ°äº†ä¸¤ç§æ•°æ®ç»“æ„ï¼Œä¸€ç§æ˜¯äºŒå‰æ ‘ï¼›ä¸€ç§æ˜¯BTreeï¼›è¿™ä¸¤ä¸ªæ•°æ®ç»“æ„å¯ä»¥æ‹¿è¿‡æ¥ç›¸äº’æ¯”è¾ƒä¸€ä¸‹ä¼˜åŠ£ï¼›  </p><p>BTreeæ•°æ®ç»“æ„ç›¸å¯¹äºäºŒå‰æ ‘ç›¸æ¯”ï¼›å­˜åœ¨æœ‰å¤šä¸ªåˆ†æ”¯ï¼›è€ŒäºŒå‰æ ‘ä¸€ä¸ªç»“ç‚¹ä»…ä»…åªå­˜åœ¨æœ‰ä¸¤ä¸ªç»“ç‚¹ï¼›é‚£ä¹ˆå¯¹äºç›¸åŒæ•°æ®é‡æ¥è¯´ï¼ŒäºŒå‰æ ‘çš„æ•°æ®å±‚æ¬¡ï¼Œä¹Ÿå°±æ˜¯äºŒå‰æ ‘çš„æ·±åº¦è¦æ›´é«˜ä¸€äº›ï¼›ä¸€æ—¦å±‚æ¬¡æ›´æ·±ä¹Ÿå°±æ„å‘³ç€æŸ¥æ‰¾æ•°æ®çš„æ—¶å€™ï¼›ç£ç›˜çš„IOçš„æ¬¡æ•°ä¹Ÿå°±æ›´å¤šï¼›ä»è€Œå¯¼è‡´æŸ¥è¯¢çš„æ•ˆç‡ä¹Ÿå°±æ¯”è¾ƒä½ï¼›<br>åˆ°æ­¤ï¼Œè¯¥BTreeæ ‘å°±å·²ç»æ„å»ºå®Œæˆäº†ï¼ŒBTREEæ ‘å’ŒäºŒå‰æ ‘ç›¸æ¯”ï¼ŒæŸ¥è¯¢æ•°æ®çš„æ•ˆç‡æ›´é«˜ï¼Œå› ä¸ºå¯¹äºç›¸åŒçš„æ•°æ®é‡æ¥è¯´ï¼ŒBTREEçš„å±‚æ¬¡ç»“æ„ç›¸æ¯”äºŒå‰æ ‘å°ï¼Œå› æ­¤æœç´¢é€Ÿåº¦æ›´å¿«ï¼›  </p><h2 id="ç´¢å¼•-ç´¢å¼•ç»“æ„-B-TREE"><a href="#ç´¢å¼•-ç´¢å¼•ç»“æ„-B-TREE" class="headerlink" title="ç´¢å¼• - ç´¢å¼•ç»“æ„ - B+TREE"></a>ç´¢å¼• - ç´¢å¼•ç»“æ„ - B+TREE</h2><p>B+Treeä¸ºBTreeçš„å˜ç§ï¼ŒB+Treeä¸BTreeçš„åŒºåˆ«ä¸ºï¼š<br>1ï¼‰ nå‰B+Treeæœ€å¤šå«æœ‰nä¸ªkeyï¼Œè€ŒBTreeæœ€å¤šå«æœ‰n-1ä¸ªkeyï¼›<br>2ï¼‰ B+Treeçš„å¶å­ç»“ç‚¹ä¿å­˜æ‰€æœ‰çš„keyä¿¡æ¯ï¼Œä¾ç…§keyå¤§å°é¡ºåºæ’åˆ—ï¼›<br>3ï¼‰ æ‰€æœ‰çš„éå¶å­ç»“ç‚¹éƒ½å¯ä»¥çœ‹åšæ˜¯keyçš„ç´¢å¼•éƒ¨åˆ†ï¼›  </p><p>æ²¡æœ‰å­èŠ‚ç‚¹çš„ç»“ç‚¹ç§°ä¹‹ä¸ºå¶å­ç»“ç‚¹ï¼›å¶å­ç»“ç‚¹å½“ä¸­åŒ…å«äº†æ‰€æœ‰keyçš„ä¿¡æ¯ï¼›å¶å­ç»“ç‚¹å½“ä¸­çš„keyæ‰æ˜¯å®Œæ•´çš„åŒ…å«äº†æ‰€æœ‰çš„keyçš„ä¿¡æ¯ï¼›åŒ…å«äº†æ‰€æœ‰çš„æ•°æ®ä¿¡æ¯ï¼›æ ¹ç»“ç‚¹å½“ä¸­ä»¥åŠéå¶å­ç»“ç‚¹å½“ä¸­çš„keyèµ·åˆ°çš„æ˜¯ä¸€ä¸ªç´¢å¼•çš„ä½œç”¨ï¼›ç´¢å¼•å°±æ˜¯ä¸ºäº†æŸ¥æ‰¾åˆ°å¶å­ç»“ç‚¹å½“ä¸­çš„keyï¼›è€Œä¸”å¯¹äºB+æ ‘æ¥è¯´æ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯å­˜å‚¨åœ¨å¶å­ç»“ç‚¹ä¸Šé¢äº†ï¼›éå¶å­ç»“ç‚¹æ˜¯ä¸å­˜åœ¨æ•°æ®ä¿¡æ¯çš„ï¼›Bæ ‘å½“ä¸­çš„æ‰€æœ‰æ•°æ®æ˜¯è·Ÿç»“ç‚¹æŒ‚é’©çš„ï¼›B+æ ‘å½“ä¸­æ‰€æœ‰çš„keyå­˜å‚¨åœ¨å¶å­ç»“ç‚¹æ‰€æœ‰çš„æ•°æ®ä¹Ÿéƒ½å­˜å‚¨åœ¨å¶å­ç»“ç‚¹ä¸Šäº†ï¼›<br>è¿™ä¹Ÿæ˜¯B+æ ‘ä¸Bæ ‘çš„ä¸€ä¸ªåŒºåˆ«ï¼›  </p><p>B+Treeç›¸å¯¹äºBTreeçš„ä¸€ä¸ªä¼˜åŠ¿ï¼š<br>ç”±äºB+Treeåªæœ‰å¶å­ç»“ç‚¹ä¿å­˜keyä¿¡æ¯ï¼ŒæŸ¥è¯¢ä»»ä½•keyéƒ½è¦ä»rootèµ°åˆ°å¶å­ï¼ˆéå¶å­ç»“ç‚¹ä¸Šçš„keyéƒ½æ˜¯èµ·åˆ°ä¸€ä¸ªç´¢å¼•çš„ä½œç”¨å¹¶æ²¡æœ‰æ•°æ®ï¼Œå¶å­ç»“ç‚¹ä¸Šçš„keyæ‰å…³è”ç€ç›¸å…³çš„æ•°æ®ä¿¡æ¯ï¼‰ï¼Œæ‰€ä»¥B+Treeçš„æŸ¥è¯¢æ•ˆç‡æ›´åŠ ç¨³å®šï¼›  </p><h2 id="ç´¢å¼•-ç´¢å¼•ç»“æ„-MySQLä¸­çš„B-Tree"><a href="#ç´¢å¼•-ç´¢å¼•ç»“æ„-MySQLä¸­çš„B-Tree" class="headerlink" title="ç´¢å¼• - ç´¢å¼•ç»“æ„ - MySQLä¸­çš„B+Tree"></a>ç´¢å¼• - ç´¢å¼•ç»“æ„ - MySQLä¸­çš„B+Tree</h2><p>MySQLç´¢å¼•æ•°æ®ç»“æ„å¯¹ç»å…¸çš„B+Treeè¿›è¡Œäº†ä¼˜åŒ–ã€‚<br>åœ¨åŸB+Treeçš„åŸºç¡€ä¸Šï¼Œå¢åŠ ä¸€ä¸ªæŒ‡å‘ç›¸é‚»å¶å­ç»“ç‚¹çš„é“¾è¡¨æŒ‡é’ˆï¼Œå°±å½¢æˆäº†å¸¦æœ‰é¡ºåºæŒ‡é’ˆçš„B+Treeï¼Œæé«˜åŒºé—´è®¿é—®çš„æ€§èƒ½ï¼›<br>é—®é¢˜ï¼šä¸ºä»€ä¹ˆè¦å¢åŠ è¿™æ ·ä¸€ä¸ªæŒ‡é’ˆï¼Ÿ<br>ç­”ï¼šæ–¹ä¾¿è¿›è¡ŒæŸ¥è¯¢ï¼›  </p><blockquote><p>å¢åŠ è¯¥æŒ‡é’ˆçš„åŸå› åœ¨äºï¼šæ–¹ä¾¿è¿›è¡ŒèŒƒå›´æœç´¢ï¼›  </p></blockquote><p>ä¸¾ä¾‹ï¼šå¦‚æœæƒ³è¦è¿›è¡Œæœç´¢idä¸º9~15çš„æ•°æ®ï¼›ç”±äºæœ‰è¯¥æŒ‡é’ˆç›¸è¿æ‰€ä»¥ä»9ä¸€ç›´æŸ¥è¯¢é“¾è¡¨ä¸‹ä¸€ç»“ç‚¹åˆ°15å³å¯ï¼›<br>æ‰€ä»¥è¯¥é“¾è¡¨æŒ‡é’ˆçš„ä½œç”¨ä¸»è¦æ˜¯ç”¨æ¥æé«˜åŒºé—´è®¿é—®çš„æ€§èƒ½ï¼›  </p><h2 id="ç´¢å¼•-ç´¢å¼•åˆ†ç±»"><a href="#ç´¢å¼•-ç´¢å¼•åˆ†ç±»" class="headerlink" title="ç´¢å¼• - ç´¢å¼•åˆ†ç±»"></a>ç´¢å¼• - ç´¢å¼•åˆ†ç±»</h2><p>1ï¼‰ å•å€¼ç´¢å¼•ï¼šå³ä¸€ä¸ªç´¢å¼•å€¼åŒ…å«å•ä¸ªåˆ—ï¼Œä¸€ä¸ªè¡¨å¯ä»¥æœ‰å¤šä¸ªå•åˆ—ç´¢å¼•(ä¸€ä¸ªç´¢å¼•å½“ä¸­åªåŒ…å«ä¸€ä¸ªåˆ—ï¼›æ¯”å¦‚ç°åœ¨éœ€è¦å¯¹æŸä¸€å¼ è¡¨å½“ä¸­å»ºç«‹ç´¢å¼•ï¼›è¯¥è¡¨å½“ä¸­æœ‰å¤šä¸ªå­—æ®µnameã€genderã€ageã€help_category_idç­‰å­—æ®µï¼Œä½†æ˜¯åªé’ˆå¯¹nameè¯¥å­—æ®µè¯¥åˆ—è¿›è¡Œå»ºç«‹ç´¢å¼•ï¼›help_category_idä¹Ÿå¯ä»¥å»ºç«‹ä¸ªç´¢å¼•ï¼›åˆ™å½“å‰å­˜åœ¨ä¸¤ä¸ªç´¢å¼•ï¼Œä½†æ˜¯æ¯ä¸ªç´¢å¼•åªå¯¹åº”äº†ç›¸å¯¹åº”çš„ä¸€åˆ—ï¼›è¿™ä¸ªå«åšå•åˆ—ç´¢å¼•æˆ–è€…æ˜¯å•å€¼ç´¢å¼•ï¼›ä¸€ä¸ªè¡¨å½“ä¸­å¯ä»¥åŒ…å«æœ‰å¤šä¸ªå•åˆ—ç´¢å¼•)<br>2ï¼‰ å”¯ä¸€ç´¢å¼•ï¼šç´¢å¼•åˆ—çš„å€¼å¿…é¡»å”¯ä¸€ï¼Œä½†å…è®¸æœ‰ç©ºå€¼ï¼›ï¼ˆå½“å‰è¡¨å½“ä¸­æŸä¸€ä¸ªå­—æ®µæˆ–è€…æ˜¯æŸä¸€åˆ—å½“ä¸­å…¶å€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼›ä¹Ÿå°±æ˜¯è¯´å¦‚æœå­˜åœ¨æœ‰åˆ—å½“ä¸­çš„å€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼›é‚£ä¹ˆå¿…è¦æƒ…å†µä¸‹å°±å¯ä»¥é’ˆå¯¹è¯¥åˆ—å»ºç«‹ä¸€ä¸ªå”¯ä¸€ç´¢å¼•ï¼Œåœ¨å”¯ä¸€ç´¢å¼•çš„è¯¥åˆ—å½“ä¸­å…è®¸åŒ…æ‹¬æœ‰å¤šä¸ªNULLå€¼ï¼›ï¼‰<br>3ï¼‰ å¤åˆç´¢å¼•ï¼šå³ä¸€ä¸ªç´¢å¼•åŒ…å«å¤šä¸ªåˆ—ï¼ˆæ¯”å¦‚ï¼šç»å¸¸åœ¨æŸ¥è¯¢å½“ä¸­éœ€è¦å¯¹nameå­—æ®µä»¥åŠparent_category_idæˆ–è€…æ˜¯è¯´ageå­—æ®µè¿›è¡Œè”åˆæŸ¥è¯¢ï¼Œé‚£ä¹ˆæ­¤æ—¶å¯ä»¥å°†nameå­—æ®µä»¥åŠageå­—æ®µç»„åˆèµ·æ¥å»ºç«‹ä¸€ä¸ªå¤åˆç´¢å¼•ï¼Œå³ä¸€ä¸ªç´¢å¼•å½“ä¸­åŒ…å«äº†ä¸¤ä¸ªåˆ—æˆ–è€…è¯´å¤šä¸ªåˆ—ï¼›é‚£ä¹ˆè¿™ç§ç´¢å¼•ç§°ä¹‹ä¸ºå¤åˆç´¢å¼•ï¼‰ï¼›  </p><h2 id="ç´¢å¼•-ç´¢å¼•è¯­æ³•"><a href="#ç´¢å¼•-ç´¢å¼•è¯­æ³•" class="headerlink" title="ç´¢å¼• - ç´¢å¼•è¯­æ³•"></a>ç´¢å¼• - ç´¢å¼•è¯­æ³•</h2><p>ç´¢å¼•åœ¨åˆ›å»ºè¡¨çš„æ—¶å€™ï¼Œå¯ä»¥åŒæ—¶åˆ›å»ºï¼Œä¹Ÿå¯ä»¥éšæ—¶å¢åŠ æ–°çš„ç´¢å¼•ï¼›<br>å‡†å¤‡ç¯å¢ƒï¼š  </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> demo_01 <span class="keyword">default</span> charset=utf8mb4;</span><br><span class="line"></span><br><span class="line">use demo_01;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">'city'</span>(</span><br><span class="line">    <span class="string">'city_id'</span> <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT;</span><br><span class="line">    <span class="string">'city_name'</span> <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>;</span><br><span class="line">    <span class="string">'country_id'</span> <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>;</span><br><span class="line">    <span class="keyword">PRIMARY KEY</span> (<span class="string">'city_id'</span>)</span><br><span class="line">)ENGINE=InnoDB <span class="keyword">DEFAULT</span> CHARSET=utf8;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">'country'</span>(</span><br><span class="line">    <span class="string">'country_id'</span> <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT;</span><br><span class="line">    <span class="string">'country_name'</span> <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>;</span><br><span class="line">    <span class="keyword">PRIMARY KEY</span> (<span class="string">'country_id'</span>)</span><br><span class="line">)ENGINE=InnoDB <span class="keyword">DEFAULT</span> CHARSET=utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">'city'</span>(<span class="string">'city_id'</span>,<span class="string">'city_name'</span>,<span class="string">'country_id'</span>) <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">'è¥¿å®‰'</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">'city'</span>(<span class="string">'city_id'</span>,<span class="string">'city_name'</span>,<span class="string">'country_id'</span>) <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">'NewYork'</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">'city'</span>(<span class="string">'city_id'</span>,<span class="string">'city_name'</span>,<span class="string">'country_id'</span>) <span class="keyword">values</span>(<span class="number">3</span>,<span class="string">'åŒ—äº¬'</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">'city'</span>(<span class="string">'city_id'</span>,<span class="string">'city_name'</span>,<span class="string">'country_id'</span>) <span class="keyword">values</span>(<span class="number">4</span>,<span class="string">'ä¸Šæµ·'</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">'country'</span>(<span class="string">'country_id'</span>,<span class="string">'country_name'</span>) <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">'China'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">'country'</span>(<span class="string">'country_id'</span>,<span class="string">'country_name'</span>) <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">'America'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">'country'</span>(<span class="string">'country_id'</span>,<span class="string">'country_name'</span>) <span class="keyword">values</span>(<span class="number">3</span>,<span class="string">'Japan'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">'country'</span>(<span class="string">'country_id'</span>,<span class="string">'country_name'</span>) <span class="keyword">values</span>(<span class="number">4</span>,<span class="string">'UK'</span>);</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºç´¢å¼•"><a href="#åˆ›å»ºç´¢å¼•" class="headerlink" title="åˆ›å»ºç´¢å¼•"></a>åˆ›å»ºç´¢å¼•</h3><p>è¯­æ³•ï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [ <span class="keyword">UNIQUE</span> | <span class="keyword">FULL</span> <span class="built_in">TEXT</span> |SPATIAL] <span class="keyword">INDEX</span> index_name</span><br><span class="line">[ <span class="keyword">using</span> index_type ]</span><br><span class="line"><span class="keyword">ON</span> tb1_name(index_col_name, .... )</span><br><span class="line"></span><br><span class="line">index_col_name : column_name[ ( <span class="keyword">length</span> ) ] [ <span class="keyword">ASC</span> | <span class="keyword">DESC</span> ]</span><br></pre></td></tr></table></figure><p>ç´¢å¼•çš„ç±»å‹ï¼šUNIQUEå”¯ä¸€ç´¢å¼•ã€FULLTEXTå…¨æ–‡ç´¢å¼•ã€SPATIALï¼›ç´¢å¼•ç±»å‹å¯é€‰ï¼›å¯ä»¥ä¸è¿›è¡ŒæŒ‡å®šï¼›<br>index_nameï¼šç´¢å¼•çš„åç§°ï¼›<br>using index_typeï¼šç´¢å¼•æ‰€ä½¿ç”¨çš„å“ªä¸€ä¸ªç±»å‹ï¼›å¦‚æœä¸æŒ‡å®šï¼›åˆ™ä½¿ç”¨ï¼Œé»˜è®¤çš„ç´¢å¼•ç±»å‹å³B+æ ‘ç´¢å¼•ç±»å‹ï¼›<br>ON tb1_name(index_col_name, â€¦.)ï¼šè¿›è¡ŒæŒ‡å®šå¯¹å“ªä¸€å¼ è¡¨çš„å“ªå‡ ä¸ªå­—æ®µåˆ›å»ºç´¢å¼•ï¼›  </p><p>åœ¨MySQLå½“ä¸­ï¼Œå¦‚æœå½“å‰è¯¥å­—æ®µæ˜¯ä¸»é”®çš„è¯ï¼›åˆ™é»˜è®¤è¯¥å­—æ®µé»˜è®¤æœ‰ä¸€ä¸ªç´¢å¼•å«åšä¸»é”®ç´¢å¼•ï¼›  </p><p>æ‰€ä»¥æ­¤æ—¶åœ¨cityè¡¨å½“ä¸­å¯¹city_idå­—æ®µçš„ç´¢å¼•ä¸å¿…å†è¿›è¡Œåˆ›å»ºï¼›å¯ä»¥åœ¨city_nameå­—æ®µä¸Šåˆ›å»ºç´¢å¼•ï¼›  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> index_city_name <span class="keyword">on</span> city(city_name);<span class="comment">#æ­¤æ—¶åœ¨city_nameå­—æ®µä¸Šåˆ›å»ºçš„è¯¥ç´¢å¼•ä¸ºæ™®é€šç´¢å¼•ï¼›</span></span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼šä¸ºcityè¡¨ä¸­çš„city_name å­—æ®µåˆ›å»ºç´¢å¼•ï¼š  </p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> idx_city_name <span class="keyword">on</span> city(city_name);</span><br></pre></td></tr></table></figure><h3 id="æŸ¥çœ‹ç´¢å¼•"><a href="#æŸ¥çœ‹ç´¢å¼•" class="headerlink" title="æŸ¥çœ‹ç´¢å¼•"></a>æŸ¥çœ‹ç´¢å¼•</h3><p>è¯­æ³•ï¼š  </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">index</span> <span class="keyword">from</span> <span class="built_in">table_name</span>; #<span class="built_in">table_name</span>ï¼Œç´¢å¼•æ‰€å»ºç«‹åœ¨è¯¥å­—æ®µï¼Œè¯¥å­—æ®µæ‰€å¤„çš„è¡¨çš„åç§°</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼šæŸ¥çœ‹cityè¡¨ä¸­çš„ç´¢å¼•ä¿¡æ¯ï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">index</span> <span class="keyword">from</span> city\G; <span class="comment">#\Gæ ¼å¼åŒ–</span></span><br></pre></td></tr></table></figure><p>åœ¨MySQLå½“ä¸­ä¼šé»˜è®¤å¯¹ä¸»é”®city_idå­—æ®µåˆ›å»ºä¸€ä¸ªç´¢å¼•å°±ç§°ä½œæ˜¯ä¸»é”®ç´¢å¼•key_nameï¼šprimaryï¼›<br>è€Œåˆšåˆšå¯¹city_nameåˆ›å»ºçš„ç´¢å¼•åˆ™ä¸ºkey_nameï¼šidx_city_nameï¼›<br>ä¸»é”®ç´¢å¼•primaryä»¥åŠåˆšåˆšæ²¡æœ‰æŒ‡å®šç´¢å¼•ç±»å‹çš„idx_city_nameçš„ç´¢å¼•ç±»å‹éƒ½æ˜¯BTREEç±»å‹ï¼›å³B+Treeç´¢å¼•ï¼ŒBTreeç´¢å¼•ï¼›</p><h3 id="åˆ é™¤ç´¢å¼•"><a href="#åˆ é™¤ç´¢å¼•" class="headerlink" title="åˆ é™¤ç´¢å¼•"></a>åˆ é™¤ç´¢å¼•</h3><p>è¯­æ³•ï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">INDEX</span> index_name <span class="keyword">ON</span> tb1_name;</span><br><span class="line"><span class="comment"># index_nameç´¢å¼•çš„åç§°</span></span><br><span class="line"><span class="comment"># è¯¥index_nameç´¢å¼•æ‰€å…·ä½“åœ¨çš„è¡¨çš„åç§°</span></span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼šæƒ³è¦åˆ é™¤cityè¡¨ä¸Šçš„ç´¢å¼•[ idx_city_name ]ï¼Œå¯ä»¥æ“ä½œå¦‚ä¸‹ï¼š  </p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">index</span> idx_city_name <span class="keyword">on</span> city;</span><br></pre></td></tr></table></figure><p>åˆ é™¤ä¹‹åå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥è¿›è¡ŒæŸ¥çœ‹åˆ é™¤çš„ç´¢å¼•æ˜¯å¦ä»ç„¶å­˜åœ¨ï¼›</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">index</span> <span class="keyword">from</span> <span class="built_in">table_name</span>\G;</span><br></pre></td></tr></table></figure><h3 id="ALTERæŒ‡ä»¤"><a href="#ALTERæŒ‡ä»¤" class="headerlink" title="ALTERæŒ‡ä»¤"></a>ALTERæŒ‡ä»¤</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># alter ä¿®æ”¹</span></span><br><span class="line"><span class="comment"># è¯¥è¯­å¥æ·»åŠ ä¸€ä¸ªä¸»é”®ï¼Œè¿™æ„å‘³ç€ç´¢å¼•å€¼å¿…é¡»å”¯ä¸€ï¼Œä¸”ä¸èƒ½ä¸ºNULLï¼›</span></span><br><span class="line">1. <span class="keyword">alter</span> <span class="keyword">table</span> tb_name <span class="keyword">add</span> primary <span class="keyword">key</span>(column_list);</span><br><span class="line"></span><br><span class="line"><span class="comment"># unique å”¯ä¸€çš„</span></span><br><span class="line"><span class="comment"># è¿™æ¡è¯­å¥åˆ›å»ºç´¢å¼•çš„å€¼å¿…é¡»æ˜¯å”¯ä¸€çš„ï¼ˆé™¤äº†NULLæ„å¤–ï¼ŒNULLå¯èƒ½ä¼šå‡ºç°å¤šæ¬¡ï¼‰</span></span><br><span class="line"><span class="comment"># Non_unique:0 #Nonä¸ï¼Œuniqueå”¯ä¸€ï¼›0ï¼šå¦å®šï¼›åŒé‡å¦å®šç­‰äºè‚¯å®šï¼›å³å”¯ä¸€</span></span><br><span class="line"><span class="comment"># å½“åˆ›å»ºæ™®é€šç´¢å¼•æ—¶å…¶Non_unique:1ï¼›å³ä¸å”¯ä¸€ï¼›  </span></span><br><span class="line">2. <span class="keyword">alter</span> <span class="keyword">table</span> tb_name <span class="keyword">add</span> <span class="keyword">unique</span> index_name(column_list);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ æ™®é€šç´¢å¼•ï¼Œç´¢å¼•å€¼å¯ä»¥å‡ºç°å¤šæ¬¡</span></span><br><span class="line">3. <span class="keyword">alter</span> <span class="keyword">table</span> tb_name <span class="keyword">add</span> <span class="keyword">index</span> index_name(column_list);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯¥è¯­å¥æŒ‡å®šäº†ç´¢å¼•ä¸ºFULLTEXTï¼Œç”¨äºå…¨æ–‡ç´¢å¼•</span></span><br><span class="line">4. <span class="keyword">alter</span> <span class="keyword">table</span> tb_name <span class="keyword">add</span> fulltext index_name(column_list);</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼šæ·»åŠ å”¯ä¸€ç´¢å¼•  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> city <span class="keyword">add</span>  <span class="keyword">unique</span>  idx_city_name(city_name);</span><br></pre></td></tr></table></figure><h2 id="ç´¢å¼•-ç´¢å¼•è®¾è®¡åŸåˆ™"><a href="#ç´¢å¼•-ç´¢å¼•è®¾è®¡åŸåˆ™" class="headerlink" title="ç´¢å¼• - ç´¢å¼•è®¾è®¡åŸåˆ™"></a>ç´¢å¼• - ç´¢å¼•è®¾è®¡åŸåˆ™</h2><p>ç´¢å¼•çš„è®¾è®¡å¯ä»¥éµå¾ªä¸€äº›å·²æœ‰çš„åŸåˆ™ï¼Œåˆ›å»ºç´¢å¼•çš„æ—¶å€™è¯·å°½é‡è€ƒè™‘ç¬¦åˆè¿™äº›åŸåˆ™ï¼Œä¾¿äºæå‡ç´¢å¼•çš„ä½¿ç”¨æ•ˆç‡ï¼Œæ›´é«˜æ•ˆçš„ä½¿ç”¨ç´¢å¼•ï¼›  </p><ul><li>å¯¹æŸ¥è¯¢é¢‘æ¬¡è¾ƒé«˜ï¼Œä¸”æ•°æ®é‡æ¯”è¾ƒå¤§çš„è¡¨å»ºç«‹ç´¢å¼•ï¼›</li><li>ç´¢å¼•å­—æ®µçš„é€‰æ‹©ï¼Œæœ€ä½³å€™é€‰åˆ—åº”å½“ä»whereå­å¥çš„æ¡ä»¶ä¸­æå–ï¼ˆå³æŸ¥è¯¢æ¡ä»¶å½“ä¸­çš„å­—æ®µï¼‰ï¼Œå¦‚æœwhereå­å¥ä¸­çš„ç»„åˆæ¯”è¾ƒå¤šï¼Œé‚£ä¹ˆåº”å½“æŒ‘é€‰æœ€å¸¸ç”¨ã€è¿‡æ»¤æ•ˆæœæœ€å¥½çš„åˆ—çš„ç»„åˆã€‚</li><li>ä½¿ç”¨å”¯ä¸€ç´¢å¼•ï¼ŒåŒºåˆ†åº¦è¶Šé«˜ï¼Œä½¿ç”¨ç´¢å¼•çš„æ•ˆç‡è¶Šé«˜ï¼›</li><li>ç´¢å¼•å¯ä»¥æœ‰æ•ˆçš„æå‡æŸ¥è¯¢æ•°æ®çš„æ•ˆç‡ï¼Œä½†æ˜¯ç´¢å¼•æ•°é‡ä¸æ˜¯å¤šå¤šç›Šå–„ï¼›ç´¢å¼•è¶Šå¤šï¼Œç»´æŠ¤ç´¢å¼•çš„ä»£ä»·è‡ªç„¶ä¹Ÿå°±æ°´æ¶¨èˆ¹é«˜ã€‚å¯¹äºæ’å…¥ã€æ›´æ–°ã€åˆ é™¤ç­‰DMLæ“ä½œæ¯”è¾ƒé¢‘ç¹çš„è¡¨æ¥è¯´ï¼Œç´¢å¼•è¿‡å¤šï¼Œä¼šå¼•å…¥ç›¸å½“é«˜çš„ç»´æŠ¤ä»£ä»·ï¼ˆç»´æŠ¤ç´¢å¼•çš„æ•°æ®ç»“æ„ï¼‰ï¼Œé™ä½DMLæ“ä½œçš„æ•ˆç‡ï¼Œå¢åŠ å“åº”æ“ä½œçš„æ—¶é—´æ¶ˆè€—ï¼›å¦å¤–ç´¢å¼•è¿‡å¤šçš„è¯ï¼ŒMySQLä¹Ÿä¼šçŠ¯é€‰æ‹©å›°éš¾ç—…ï¼Œè™½ç„¶æœ€ç»ˆä»ç„¶ä¼šæ‰¾åˆ°ä¸€ä¸ªå¯ç”¨çš„ç´¢å¼•ï¼Œä½†æ˜¯æ— ç–‘æé«˜äº†é€‰æ‹©çš„ä»£ä»·ï¼›</li><li>ä½¿ç”¨çŸ­ç´¢å¼•ï¼Œç´¢å¼•åˆ›å»ºä¹‹åä¹Ÿæ˜¯ä½¿ç”¨ç¡¬ç›˜æ¥å­˜å‚¨çš„ï¼Œå› æ­¤æå‡ç´¢å¼•è®¿é—®çš„I/Oæ•ˆç‡ï¼Œä¹Ÿå¯ä»¥æå‡æ€»ä½“çš„è®¿é—®æ•ˆç‡ã€‚å‡å¦‚æ„æˆç´¢å¼•çš„å­—æ®µæ€»é•¿åº¦æ¯”è¾ƒçŸ­ï¼Œé‚£ä¹ˆåœ¨ç»™å®šå¤§å°çš„å­˜å‚¨å—å†…å¯ä»¥å­˜å‚¨æ›´å¤šçš„ç´¢å¼•å€¼ï¼Œä¹¡éŸ³çš„å¯ä»¥æœ‰æ•ˆåœ°æå‡MySQLè®¿é—®ç´¢å¼•çš„I/Oæ•ˆç‡ã€‚</li><li>åˆ©ç”¨æœ€å·¦å‰ç¼€ï¼ŒNä¸ªåˆ—ç»„åˆè€Œæˆçš„ç»„åˆç´¢å¼•ï¼Œé‚£ä¹ˆç›¸å½“äºæ˜¯åˆ›å»ºäº†Nä¸ªç´¢å¼•ï¼Œå¦‚æœæŸ¥è¯¢æ—¶whereå­å¥ä¸­ä½¿ç”¨äº†ç»„æˆè¯¥ç´¢å¼•çš„å‰å‡ ä¸ªå­—æ®µï¼Œé‚£ä¹ˆè¿™æ¡æŸ¥è¯¢SQLå¯ä»¥åˆ©ç”¨ç»„åˆç´¢å¼•æ¥æå‡æ€§èƒ½ï¼›  </li></ul><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">åˆ›å»ºå¤åˆç´¢å¼•ï¼š</span><br><span class="line"></span><br><span class="line">CREATE <span class="built_in">INDEX</span> idx_name_email_status ON tb_seller(<span class="keyword">NAME</span>,email,<span class="keyword">STATUS</span>);</span><br><span class="line"></span><br><span class="line">å°±ç›¸å½“äº</span><br><span class="line">      å¯¹<span class="keyword">name</span> åˆ›å»ºäº†ç´¢å¼•ï¼›</span><br><span class="line">      å¯¹<span class="keyword">name</span> , email åˆ›å»ºäº†ç´¢å¼•ï¼›</span><br><span class="line">      å¯¹<span class="keyword">name</span> , email , <span class="keyword">status</span> åˆ›å»ºäº†ç´¢å¼•ï¼›</span><br><span class="line">åªéœ€è¦åˆ›å»ºè¿™ä¹ˆä¸€ä¸ªç´¢å¼•ï¼Œåœ¨æŸ¥è¯¢<span class="keyword">name</span>å•ä¸ªå­—æ®µçš„æ—¶å€™å°±å°†ä¼šèµ°ç´¢å¼•ï¼›åœ¨æŸ¥è¯¢<span class="keyword">name</span>ï¼Œemailè¿™ä¸¤ä¸ªå­—æ®µçš„æ—¶å€™ä¹Ÿä¼šèµ°ç´¢å¼•ï¼›åœ¨æŸ¥è¯¢<span class="keyword">name</span>,email,<span class="keyword">status</span>è¿™ä¸‰ä¸ªå­—æ®µçš„æ—¶å€™ä¹Ÿä¼šèµ°ç´¢å¼•ï¼›  </span><br><span class="line">æœ€å·¦ç´¢å¼•ï¼šæœ€å·¦æŒ‡çš„æ˜¯å¤åˆç´¢å¼•å½“ä¸­çš„ç¬¬ä¸€ä¸ªå­—æ®µï¼Œåªè¦æŸ¥è¯¢çš„æ—¶å€™åŒ…å«ç¬¬ä¸€ä¸ªå­—æ®µï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±ä¼šèµ°ç´¢å¼•ï¼›</span><br></pre></td></tr></table></figure><h2 id="è§†å›¾-åˆ›å»ºåŠä¿®æ”¹è§†å›¾"><a href="#è§†å›¾-åˆ›å»ºåŠä¿®æ”¹è§†å›¾" class="headerlink" title="è§†å›¾ - åˆ›å»ºåŠä¿®æ”¹è§†å›¾"></a>è§†å›¾ - åˆ›å»ºåŠä¿®æ”¹è§†å›¾</h2><p>è§†å›¾ï¼ˆViewï¼‰æ˜¯ä¸€ç§è™šæ‹Ÿå­˜åœ¨çš„è¡¨ã€‚<br>è§†å›¾å¹¶ä¸åœ¨æ•°æ®åº“ä¸­å®é™…å­˜åœ¨ï¼Œè¡Œå’Œåˆ—æ•°æ®æ¥è‡ªå®šä¹‰è§†å›¾çš„æŸ¥è¯¢ä¸­ä½¿ç”¨çš„è¡¨ï¼Œå¹¶ä¸”æ˜¯åœ¨ä½¿ç”¨è§†å›¾æ—¶åŠ¨æ€ç”Ÿæˆçš„ã€‚<br>é€šä¿—çš„è®²ï¼Œè§†å›¾å°±æ˜¯ä¸€æ¡SELECTè¯­å¥æ‰§è¡Œåè¿”å›çš„ç»“æœé›†ã€‚<br>æ‰€ä»¥åœ¨åˆ›å»ºè§†å›¾çš„æ—¶å€™ï¼Œä¸»è¦çš„å·¥ä½œå°±è½åœ¨åˆ›å»ºè¿™æ¡SQLæŸ¥è¯¢è¯­å¥ä¸Šã€‚  </p><p>è§†å›¾ç›¸å¯¹äºæ™®é€šè¡¨çš„åˆæ˜¯ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ é¡¹ï¼š  </p><ul><li>ç®€å•ï¼šä½¿ç”¨è§†å›¾çš„ç”¨æˆ·å®Œå…¨ä¸éœ€è¦å…³å¿ƒåé¢å¯¹åº”è¡¨çš„ç»“æ„ã€å…³è”æ¡ä»¶å’Œç­›é€‰æ¡ä»¶ï¼Œå¯¹ç”¨æˆ·æ¥è¯´å·²ç»æ˜¯è¿‡æ»¤å¥½çš„ç¬¦åˆæ¡ä»¶çš„ç»“æœé›†ã€‚  </li><li>å®‰å…¨ï¼šä½¿ç”¨è§†å›¾çš„ç”¨æˆ·åªèƒ½è®¿é—®ä»–ä»¬è¢«å…è®¸æŸ¥è¯¢çš„ç»“æœå–œï¼Œå¯¹è¡¨çš„æƒé™ç®¡ç†å¹¶ä¸èƒ½å…ˆçŸ¥é“æŸä¸ªè¡ŒæŸä¸ªåˆ—ï¼Œä½†æ˜¯é€šè¿‡è§†å›¾å°±å¯ä»¥ç®€å•çš„å®ç°ï¼›</li><li>æ•°æ®ç‹¬ç«‹ï¼šä¸€æ—¦è§†å›¾çš„ç»“æ„ç¡®å®šäº†ï¼Œå¯ä»¥å±è”½è¡¨ç»“æ„å˜åŒ–å¯¹ç”¨æˆ·çš„å½±å“ï¼Œæºè¡¨å¢åŠ åˆ—å¯¹è§†å›¾æ²¡æœ‰å½±å“ï¼›æºè¡¨ä¿®æ”¹åˆ—åï¼Œåˆ™å¯ä»¥é€šè¿‡ä¿®æ”¹è§†å›¾æ¥è§£å†³ï¼Œä¸ä¼šé€ æˆå¯¹è®¿é—®è€…çš„å½±å“ï¼›</li></ul><h3 id="åˆ›å»ºæˆ–è€…ä¿®æ”¹è§†å›¾"><a href="#åˆ›å»ºæˆ–è€…ä¿®æ”¹è§†å›¾" class="headerlink" title="åˆ›å»ºæˆ–è€…ä¿®æ”¹è§†å›¾"></a>åˆ›å»ºæˆ–è€…ä¿®æ”¹è§†å›¾</h3><blockquote><p>åˆ›å»ºè§†å›¾çš„è¯­æ³•ä¸º</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [ <span class="keyword">OR</span> <span class="keyword">REPLACE</span>] [ ALGORITHM = &#123; UNDEFINED | <span class="keyword">MERGE</span> | TEMPTABLE &#125; ]</span><br><span class="line"></span><br><span class="line"><span class="keyword">VIEW</span> view_name [ (column_list) ]</span><br><span class="line"></span><br><span class="line"><span class="keyword">AS</span> select_statement</span><br><span class="line"></span><br><span class="line">[ <span class="keyword">WITH</span> [<span class="keyword">CASCADED</span> | <span class="keyword">LOCAL</span> ] <span class="keyword">CHECK</span> <span class="keyword">OPTION</span> ]</span><br></pre></td></tr></table></figure><blockquote><p>ä¿®æ”¹è§†å›¾çš„è¯­æ³•</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> [ ALGORITHM = &#123; UNDEFINED | <span class="keyword">MERGE</span> | TEMPTABLE &#125; ]</span><br><span class="line"></span><br><span class="line"><span class="keyword">VIEW</span> view_name [ (column_list) ]</span><br><span class="line"></span><br><span class="line"><span class="keyword">AS</span> select_statement</span><br><span class="line"></span><br><span class="line">[ WITE [ <span class="keyword">CASCADED</span> | <span class="keyword">LOCAL</span> ] <span class="keyword">CHECK</span> <span class="keyword">OPTION</span> ]</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">é€‰é¡¹ï¼š</span><br><span class="line">    <span class="keyword">WITH</span> [ <span class="keyword">CASCADED</span> | <span class="keyword">LOCAL</span>] <span class="keyword">CHECK</span> <span class="keyword">OPTION</span> å†³å®šäº†æ˜¯å¦å…è®¸æ›´æ–°æ•°æ®ä½¿è®°å½•ä¸åœ¨æ»¡è¶³è§†å›¾çš„æ¡ä»¶ï¼›</span><br><span class="line">    <span class="keyword">LOCAL</span> åªè¦æ»¡è¶³æœ¬è§†å›¾çš„æ¡ä»¶å°±å¯ä»¥æ›´æ–°</span><br><span class="line">    <span class="keyword">CASCADED</span> å¿…é¡»æ»¡è¶³æ‰€æœ‰é’ˆå¯¹è¯¥è§†å›¾çš„æ‰€æœ‰è§†å›¾çš„æ¡ä»¶æ‰å¯ä»¥æ›´æ–°ï¼ˆé»˜è®¤å€¼ï¼‰</span><br><span class="line"></span><br><span class="line">    <span class="keyword">CREATE</span> [ <span class="keyword">OR</span> <span class="keyword">REPLACE</span>] åˆ›å»ºæˆ–è€…æ˜¯æ›¿æ¢</span><br><span class="line">    <span class="keyword">AS</span> select_statement select_statementå³<span class="keyword">select</span>è¯­å¥</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼šåœ¨è§†å›¾å½“ä¸­å±•ç¤ºå›½å®¶ä»¥åŠå…¶ç›¸å…³åŸå¸‚çš„ä¿¡æ¯</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span>; <span class="comment"># æ˜¾ç¤ºåœ¨è¯¥æ•°æ®åº“ä¸‹æ‰€æœ‰çš„è¡¨</span></span><br><span class="line">desc table_name; <span class="comment"># æ˜¾ç¤ºè¯¥table_nameå½“ä¸­çš„è¡¨ç»“æ„</span></span><br><span class="line">desc city;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> city c,country t <span class="keyword">where</span> c.country_id=t.country_id;</span><br><span class="line"><span class="keyword">select</span> c.*,t.country_name <span class="keyword">from</span> city c,country t <span class="keyword">where</span> c.country_id=t.country_id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> view_city_country <span class="keyword">as</span> <span class="keyword">select</span> c.*,t.country_name <span class="keyword">from</span> city c,country t <span class="keyword">where</span> c.country_id=t.country_id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> view_city_country;<span class="comment"># æŸ¥è¯¢è§†å›¾ä¸è¡¨æ“ä½œä¸€è‡´</span></span><br><span class="line"><span class="keyword">update</span> view_city_country <span class="keyword">set</span> city_name=<span class="string">'è¥¿å®‰å¸‚'</span> <span class="keyword">where</span> city_id=<span class="number">1</span>;<span class="comment">#ä¿®æ”¹è§†å›¾ä¸è¡¨æ“ä½œä¸€è‡´</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> city; <span class="comment"># è¿™ä¸ªæ—¶å€™åŸºç¡€è¡¨å½“ä¸­çš„æ•°æ®ä¹Ÿä¼šè¢«æ›´æ–°æ‰ï¼›ä¹Ÿå°±æ˜¯è¯´æ­¤æ—¶çš„è§†å›¾ä¿®æ”¹æ“ä½œæ˜¯ä¼šå½±å“åˆ°åŸºç¡€è¡¨å½“ä¸­çš„æ•°æ®ï¼›  </span></span><br><span class="line">è™½ç„¶è§†å›¾èƒ½å¤Ÿåšåˆ°æ›´æ–°ï¼Œä½†æ˜¯å¹¶ä¸å»ºè®®å»æ›´æ–°æ•°æ®ï¼›å› ä¸ºè§†å›¾å°±æ˜¯ç”¨æ¥ç®€åŒ–æŸ¥è¯¢æ“ä½œçš„ï¼Œä¸å»ºè®®æ›´æ–°è§†å›¾ï¼›</span><br></pre></td></tr></table></figure><h2 id="è§†å›¾-æŸ¥çœ‹åŠåˆ é™¤è§†å›¾"><a href="#è§†å›¾-æŸ¥çœ‹åŠåˆ é™¤è§†å›¾" class="headerlink" title="è§†å›¾ - æŸ¥çœ‹åŠåˆ é™¤è§†å›¾"></a>è§†å›¾ - æŸ¥çœ‹åŠåˆ é™¤è§†å›¾</h2><h3 id="æŸ¥çœ‹è§†å›¾"><a href="#æŸ¥çœ‹è§†å›¾" class="headerlink" title="æŸ¥çœ‹è§†å›¾"></a>æŸ¥çœ‹è§†å›¾</h3><p>ä»MySQL5.1ç‰ˆæœ¬å¼€å§‹ï¼Œä½¿ç”¨SHOW TABLESå‘½ä»¤çš„æ—¶å€™ä¸ä»…ä¼šæ˜¾ç¤ºè¡¨çš„åå­—ï¼ŒåŒæ—¶ä¹Ÿä¼šæ˜¾ç¤ºè§†å›¾çš„åå­—ï¼Œè€Œä¸å­˜åœ¨å•ç‹¬æ˜¾ç¤ºè§†å›¾çš„SHOW VIEWSå‘½ä»¤ã€‚  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span>;<span class="comment"># æ˜¾ç¤ºè¡¨ä»¥åŠè§†å›¾çš„åç§°</span></span><br></pre></td></tr></table></figure><p>åŒæ ·ï¼Œåœ¨ä½¿ç”¨SHOW TABLE STATUSå‘½ä»¤çš„æ—¶å€™ï¼Œä¸ä½†å¯ä»¥æ˜¾ç¤ºè¡¨çš„ä¿¡æ¯ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥æ˜¾ç¤ºè§†å›¾çš„ä¿¡æ¯ï¼›</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">table</span> <span class="keyword">status</span>; <span class="comment"># æ˜¾ç¤ºè¡¨ä»¥åŠè§†å›¾çš„ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">table</span> <span class="keyword">status</span> <span class="keyword">like</span> <span class="string">'city_country_view'</span>\G; <span class="comment"># ç¤ºä¾‹æŸ¥çœ‹è§†å›¾city_country_view</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">view</span> view_city_country; <span class="comment"># æŸ¥çœ‹åˆ›å»ºè§†å›¾æ—¶æ‰€ä½¿ç”¨çš„çš„SQLè¯­å¥æ˜¯ä»€ä¹ˆ</span></span><br></pre></td></tr></table></figure><h3 id="åˆ é™¤è§†å›¾"><a href="#åˆ é™¤è§†å›¾" class="headerlink" title="åˆ é™¤è§†å›¾"></a>åˆ é™¤è§†å›¾</h3><p>è¯­æ³•ï¼š  </p><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">DROP</span> <span class="meta">VIEW</span> [ <span class="meta">IF</span> EXISTS ] view_name [, view_name ] ... [ <span class="meta">RESTRICT</span> | <span class="meta">CASCADE</span> ]</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼Œåˆ é™¤è§†å›¾city_country_view:  </p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> city_country_view;# or <span class="keyword">DROP</span> <span class="keyword">VIEW</span> <span class="keyword">if</span> <span class="keyword">exists</span> city_country_view;</span><br></pre></td></tr></table></figure><h2 id="å­˜å‚¨è¿‡ç¨‹-æ¦‚è¿°"><a href="#å­˜å‚¨è¿‡ç¨‹-æ¦‚è¿°" class="headerlink" title="å­˜å‚¨è¿‡ç¨‹ - æ¦‚è¿°"></a>å­˜å‚¨è¿‡ç¨‹ - æ¦‚è¿°</h2><p>å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°æ˜¯å®ç°ç»è¿‡ç¼–è¯‘å¹¶å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„ä¸€æ®µSQLè¯­å¥çš„é›†åˆï¼Œè°ƒç”¨å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°å¯ä»¥ç®€åŒ–åº”ç”¨å¼€å‘äººå‘˜çš„å¾ˆå¤šå·¥ä½œï¼Œå‡å°‘æ•°æ®åœ¨æ•°æ®åº“å’Œåº”ç”¨æœåŠ¡å™¨ä¹‹é—´çš„ä¼ è¾“ï¼Œå¯¹äºæé«˜æ•°æ®å¤„ç†çš„æ•ˆç‡æ—¶æœ‰å¥½å¤„çš„ã€‚<br>å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°çš„åŒºåˆ«åœ¨äºå‡½æ•°å¿…é¡»æœ‰è¿”å›å€¼ï¼Œè€Œå­˜å‚¨è¿‡ç¨‹æ²¡æœ‰ï¼›<br>å‡½æ•°ï¼šæ˜¯ä¸€ä¸ªæœ‰è¿”å›å€¼çš„è¿‡ç¨‹ï¼›<br>å­˜å‚¨è¿‡ç¨‹ï¼šæ˜¯ä¸€ä¸ªæ²¡æœ‰è¿”å›å€¼çš„å‡½æ•°ï¼›</p><h2 id="å­˜å‚¨è¿‡ç¨‹-åˆ›å»ºè°ƒç”¨æŸ¥è¯¢åˆ é™¤è¯­æ³•"><a href="#å­˜å‚¨è¿‡ç¨‹-åˆ›å»ºè°ƒç”¨æŸ¥è¯¢åˆ é™¤è¯­æ³•" class="headerlink" title="å­˜å‚¨è¿‡ç¨‹ - åˆ›å»ºè°ƒç”¨æŸ¥è¯¢åˆ é™¤è¯­æ³•"></a>å­˜å‚¨è¿‡ç¨‹ - åˆ›å»ºè°ƒç”¨æŸ¥è¯¢åˆ é™¤è¯­æ³•</h2><h3 id="åˆ›å»ºå­˜å‚¨è¿‡ç¨‹"><a href="#åˆ›å»ºå­˜å‚¨è¿‡ç¨‹" class="headerlink" title="åˆ›å»ºå­˜å‚¨è¿‡ç¨‹"></a>åˆ›å»ºå­˜å‚¨è¿‡ç¨‹</h3><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="function"><span class="keyword">PROCEDURE</span> <span class="title">procedure_name</span> <span class="params">( [proc_parameter[,.....]])</span></span></span><br><span class="line"><span class="function"><span class="title">begin</span></span></span><br><span class="line"><span class="function">    -- <span class="title">SQL</span>è¯­å¥</span></span><br><span class="line"><span class="function"><span class="title">end</span>;</span></span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š  </p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">delimiter $</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="function"><span class="keyword">procedure</span> <span class="title">pro_test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="title">begin</span></span></span><br><span class="line"><span class="function">    <span class="title">select</span> '<span class="title">Hello</span> <span class="title">MySQL</span>';</span></span><br><span class="line"><span class="keyword">end</span>$</span><br><span class="line"></span><br><span class="line">delimiter ;</span><br></pre></td></tr></table></figure><h4 id="çŸ¥è¯†å°è´´å£«"><a href="#çŸ¥è¯†å°è´´å£«" class="headerlink" title="çŸ¥è¯†å°è´´å£«"></a>çŸ¥è¯†å°è´´å£«</h4><p>DELEMITER<br>    è¯¥å…³é”®å­—ç”¨æ¥å£°æ˜SQLè¯­å¥çš„åˆ†éš”ç¬¦ï¼Œå‘Šè¯‰MySQLè§£é‡Šå™¨ï¼Œæ”¹çŸ­å‘½ä»¤æ˜¯å¦å·²ç»ç»“æŸäº†ï¼Œmysqlæ˜¯å¦å¯ä»¥æ‰§è¡Œäº†ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œdelimiteræ˜¯åˆ†å·;<br>    åœ¨å‘½ä»¤è¡Œå®¢æˆ·ç«¯ä¸­ï¼Œå¦‚æœä¸€è¡Œå‘½ä»¤ä»¥åˆ†å·ç»“æŸï¼Œé‚£ä¹ˆå›è½¦åï¼Œmysqlå°†ä¼šæ‰§è¡Œè¯¥å‘½ä»¤ï¼›</p><h3 id="è°ƒç”¨å­˜å‚¨è¿‡ç¨‹"><a href="#è°ƒç”¨å­˜å‚¨è¿‡ç¨‹" class="headerlink" title="è°ƒç”¨å­˜å‚¨è¿‡ç¨‹"></a>è°ƒç”¨å­˜å‚¨è¿‡ç¨‹</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">call</span> procedure_name();</span><br></pre></td></tr></table></figure><h3 id="æŸ¥çœ‹å­˜å‚¨è¿‡ç¨‹"><a href="#æŸ¥çœ‹å­˜å‚¨è¿‡ç¨‹" class="headerlink" title="æŸ¥çœ‹å­˜å‚¨è¿‡ç¨‹"></a>æŸ¥çœ‹å­˜å‚¨è¿‡ç¨‹</h3><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-- æŸ¥è¯¢db_name æ•°æ®åº“ä¸­çš„æ‰€æœ‰çš„å­˜å‚¨è¿‡ç¨‹</span><br><span class="line"><span class="keyword">select</span> name <span class="keyword">from</span> mysql.proc <span class="keyword">where</span> db=<span class="string">'db_name'</span>;</span><br><span class="line"><span class="keyword">select</span> name <span class="keyword">from</span> mysql.proc <span class="keyword">where</span> db=<span class="string">'demo_01'</span>$ #ç¤ºä¾‹</span><br><span class="line"></span><br><span class="line">-- æŸ¥è¯¢å­˜å‚¨è¿‡ç¨‹çš„çŠ¶æ€ä¿¡æ¯</span><br><span class="line">show <span class="function"><span class="keyword">procedure</span> <span class="title">status</span>;</span></span><br><span class="line">show <span class="function"><span class="keyword">procedure</span> <span class="title">status</span>$ # ç¤ºä¾‹</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">-- æŸ¥è¯¢æŸä¸ªå­˜å‚¨è¿‡ç¨‹çš„å®šä¹‰</span></span><br><span class="line"><span class="function"><span class="title">show</span> <span class="title">create</span> <span class="title">procedure</span> <span class="title">test</span>.<span class="title">pro_test1</span> \<span class="title">G</span>;</span></span><br><span class="line">show <span class="keyword">create</span> <span class="function"><span class="keyword">procedure</span> <span class="title">pro_test</span>\<span class="title">G</span>$ #ç¤ºä¾‹</span></span><br></pre></td></tr></table></figure><h3 id="åˆ é™¤å­˜å‚¨è¿‡ç¨‹"><a href="#åˆ é™¤å­˜å‚¨è¿‡ç¨‹" class="headerlink" title="åˆ é™¤å­˜å‚¨è¿‡ç¨‹"></a>åˆ é™¤å­˜å‚¨è¿‡ç¨‹</h3><figure class="highlight cal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DROP <span class="function"><span class="keyword">PROCEDURE</span> [ <span class="title">IF</span> <span class="title">EXISTS</span> ] <span class="title">sp_name</span>;</span></span><br><span class="line"></span><br><span class="line">drop <span class="function"><span class="keyword">procedure</span> <span class="title">pro_test1</span>$ # ç¤ºä¾‹</span></span><br></pre></td></tr></table></figure><h2 id="å­˜å‚¨è¿‡ç¨‹-è¯­æ³•-å˜é‡"><a href="#å­˜å‚¨è¿‡ç¨‹-è¯­æ³•-å˜é‡" class="headerlink" title="å­˜å‚¨è¿‡ç¨‹ - è¯­æ³• - å˜é‡"></a>å­˜å‚¨è¿‡ç¨‹ - è¯­æ³• - å˜é‡</h2><p>å­˜å‚¨è¿‡ç¨‹æ˜¯å¯ä»¥ç¼–ç¨‹çš„ï¼Œæ„å‘³ç€å¯ä»¥ä½¿ç”¨å˜é‡ï¼Œè¡¨è¾¾å¼ï¼Œæ§åˆ¶ç»“æ„ï¼Œæ¥å®Œæˆæ¯”è¾ƒå¤æ‚çš„åŠŸèƒ½ã€‚(ä½¿å¾—SQLå…·æœ‰è¿‡ç¨‹åŒ–è¯­è¨€çš„å¤„ç†èƒ½åŠ›)  </p><h3 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h3><ul><li>DECLARE</li></ul><p>é€šè¿‡DECLAREå¯ä»¥å®šä¹‰ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œè¯¥å˜é‡çš„ä½œç”¨è¿”å›åªèƒ½åœ¨BEGINâ€¦ENDå—ä¸­ã€‚  </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DECLARE var_name[ <span class="built_in">..</span>. ]<span class="built_in"> type </span>[DEFAULT value]</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š  </p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">delimiter $</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="function"><span class="keyword">procedure</span> <span class="title">pro_test2</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="title">begin</span></span></span><br><span class="line"><span class="function">    <span class="title">declare</span> <span class="title">num</span> <span class="title">int</span> <span class="title">default</span> 5;</span></span><br><span class="line">    <span class="keyword">select</span> num+ <span class="number">10</span>;</span><br><span class="line"><span class="keyword">end</span>$</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="function"><span class="keyword">procedure</span> <span class="title">pro_test1</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="title">begin</span></span></span><br><span class="line"><span class="function">    <span class="title">declare</span> <span class="title">num</span> <span class="title">int</span> <span class="title">default</span> 10;</span></span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">concat</span>(<span class="string">'numçš„å€¼ä¸º'</span>,num);</span><br><span class="line"><span class="keyword">end</span>$</span><br><span class="line"></span><br><span class="line">call pro_test1()$</span><br><span class="line">call pro_test2()$</span><br><span class="line"></span><br><span class="line">delimiter $</span><br></pre></td></tr></table></figure><ul><li>SET</li></ul><p>ç›´æ¥èµ‹å€¼ä½¿ç”¨SETï¼Œå¯ä»¥èµ‹å¸¸é‡æˆ–è€…èµ‹è¡¨è¾¾å¼ï¼Œå…·ä½“è¯­æ³•å¦‚ä¸‹ï¼š  </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">SET</span> var_name = expr [ , <span class="attribute">var_name</span>=expr ] <span class="built_in">..</span><span class="built_in">..</span></span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š  </p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="function"><span class="keyword">PROCEDURE</span> <span class="title">pro_test3</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="title">BEGIN</span></span></span><br><span class="line"><span class="function">    <span class="title">DECLARE</span> <span class="title">NAME</span> <span class="title">VARCHAR</span><span class="params">(20)</span>;</span></span><br><span class="line">    <span class="keyword">SET</span> NAME = <span class="string">'MYSQL'</span>;</span><br><span class="line">    <span class="keyword">SELECT</span> NAME ;</span><br><span class="line"><span class="keyword">END</span>$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="function"><span class="keyword">PROCEDURE</span> <span class="title">pro_demo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="title">begin</span></span></span><br><span class="line"><span class="function">    <span class="title">declare</span> <span class="title">num</span> <span class="title">int</span> <span class="title">default</span> 0;</span></span><br><span class="line">    <span class="keyword">set</span> num = num +<span class="number">10</span>;</span><br><span class="line">    <span class="keyword">select</span> num;</span><br><span class="line"><span class="keyword">end</span>$</span><br><span class="line"></span><br><span class="line">call pro_test3()$</span><br><span class="line">call pro_demo()$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥é€šè¿‡ selectâ€¦.into æ–¹å¼è¿›è¡Œèµ‹å€¼æ“ä½œï¼›</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> pro_test5()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">DECLARE</span> countnum <span class="built_in">int</span>;</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">into</span> countnum <span class="keyword">from</span> city;</span><br><span class="line">    <span class="keyword">select</span> countnum;</span><br><span class="line"><span class="keyword">END</span>$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> PPROCEDURE pro_demo()</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">declare</span> <span class="keyword">num</span> <span class="built_in">int</span>;</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">into</span> <span class="keyword">num</span> <span class="keyword">from</span> city;</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">concat</span>(<span class="string">'cityè¡¨ä¸­çš„è®°å½•æ•°ä¸º'</span>,<span class="keyword">num</span>);</span><br><span class="line"><span class="keyword">end</span>$</span><br><span class="line"></span><br><span class="line"><span class="keyword">call</span> pro_test5()$</span><br><span class="line"><span class="keyword">call</span> pro_demo()$</span><br><span class="line"></span><br><span class="line">DELIMITER $</span><br></pre></td></tr></table></figure><h2 id="å­˜å‚¨è¿‡ç¨‹-è¯­æ³•-ifåˆ¤æ–­"><a href="#å­˜å‚¨è¿‡ç¨‹-è¯­æ³•-ifåˆ¤æ–­" class="headerlink" title="å­˜å‚¨è¿‡ç¨‹ - è¯­æ³• - ifåˆ¤æ–­"></a>å­˜å‚¨è¿‡ç¨‹ - è¯­æ³• - ifåˆ¤æ–­</h2><h3 id="ifæ¡ä»¶åˆ¤æ–­"><a href="#ifæ¡ä»¶åˆ¤æ–­" class="headerlink" title="ifæ¡ä»¶åˆ¤æ–­"></a>ifæ¡ä»¶åˆ¤æ–­</h3><p>è¯­æ³•ç»“æ„ï¼š  </p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> search_condition then statement_list</span><br><span class="line">      [ <span class="keyword">elseif</span> search_condition then statement_list ] ...</span><br><span class="line">      [ <span class="keyword">else</span> statementlist ]</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">if</span>;</span><br></pre></td></tr></table></figure><p>éœ€æ±‚ï¼š  </p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æ ¹æ®å®šä¹‰çš„èº«é«˜å˜é‡ï¼Œåˆ¤å®šå½“å‰èº«é«˜çš„æ‰€å±çš„èº«æç±»å‹</span><br><span class="line"></span><br><span class="line"><span class="number">180</span>åŠä»¥ä¸Š----------ã€‹èº«æé«˜æŒ‘</span><br><span class="line"><span class="number">170</span> ~ <span class="number">180</span>----------ã€‹æ ‡å‡†èº«æ</span><br><span class="line"><span class="number">170</span>ä¸€ä¸‹------------ã€‹ä¸€èˆ¬èº«æ</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">delimiter &amp;</span><br><span class="line">create procedure pro_test4()</span><br><span class="line">begin</span><br><span class="line">    declare height int<span class="built_in"> default </span>175;</span><br><span class="line">    declare description varchar(50)<span class="built_in"> default </span><span class="string">''</span>;</span><br><span class="line">    <span class="keyword">if</span> hegith &gt;= 180 then</span><br><span class="line">      <span class="builtin-name">set</span> <span class="attribute">description</span>=<span class="string">'èº«æé«˜æŒ‘'</span>;</span><br><span class="line">    elseif height &gt;=170 <span class="keyword">and</span> height &lt; 180 then</span><br><span class="line">      <span class="builtin-name">set</span> <span class="attribute">description</span>=<span class="string">'æ ‡å‡†èº«æ'</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      <span class="builtin-name">set</span> <span class="attribute">description</span>=<span class="string">'ä¸€èˆ¬èº«æ'</span>;</span><br><span class="line">    end <span class="keyword">if</span>;</span><br><span class="line">    select concat(<span class="string">'èº«é«˜'</span>,height,<span class="string">'å¯¹åº”çš„èº«æç±»å‹ä¸º'</span>,description);</span><br><span class="line">end$</span><br><span class="line"></span><br><span class="line">call pro_test()$</span><br><span class="line"></span><br><span class="line">delimiter ;</span><br></pre></td></tr></table></figure><h2 id="å­˜å‚¨è¿‡ç¨‹-è¯­æ³•-è¾“å…¥å‚æ•°"><a href="#å­˜å‚¨è¿‡ç¨‹-è¯­æ³•-è¾“å…¥å‚æ•°" class="headerlink" title="å­˜å‚¨è¿‡ç¨‹ - è¯­æ³• - è¾“å…¥å‚æ•°"></a>å­˜å‚¨è¿‡ç¨‹ - è¯­æ³• - è¾“å…¥å‚æ•°</h2><p><strong>ä¼ é€’å‚æ•°</strong></p><p>è¯­æ³•æ ¼å¼ï¼š  </p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="function"><span class="keyword">procedure</span> <span class="title">procedure_name</span><span class="params">([ <span class="keyword">in</span> / <span class="keyword">out</span> / inout ]å‚æ•°åç§° å‚æ•°ç±»å‹)</span></span></span><br><span class="line"><span class="function">...</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"># <span class="title">IN</span> è¯¥å‚æ•°å¯ä»¥ä½œä¸ºè¾“å…¥ï¼Œä¹Ÿå°±æ˜¯éœ€è¦è°ƒç”¨æ–¹ä¼ å…¥å€¼ï¼Œé»˜è®¤</span></span><br><span class="line"><span class="function"># <span class="title">OUT</span> è¯¥å‚æ•°ä½œä¸ºè¾“å‡ºï¼Œä¹Ÿå°±æ˜¯è¯¥å‚æ•°å¯ä»¥ä½œä¸ºè¿”å›å€¼</span></span><br><span class="line"><span class="function"># <span class="title">INOUT</span> æ—¢å¯ä»¥ä½œä¸ºè¾“å…¥å‚æ•°ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºè¾“å‡ºå‚æ•°</span></span><br></pre></td></tr></table></figure><p><strong>IN - è¾“å…¥</strong></p><p>éœ€æ±‚ï¼š  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ ¹æ®å®šä¹‰çš„èº«é«˜å˜é‡ï¼Œåˆ¤å®šå½“å‰èº«é«˜çš„æ‰€å±çš„èº«æç±»å‹</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š  </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">delimiter $</span><br><span class="line"></span><br><span class="line">create procedure pro_test5(<span class="keyword">in</span> height int)</span><br><span class="line">begin</span><br><span class="line">    declare description varchar(50)<span class="built_in"> default </span><span class="string">''</span>;</span><br><span class="line">    <span class="keyword">if</span> hegith &gt;= 180 then</span><br><span class="line">      <span class="builtin-name">set</span> <span class="attribute">description</span>=<span class="string">'èº«æé«˜æŒ‘'</span>;</span><br><span class="line">    elseif height &gt;=170 <span class="keyword">and</span> height &lt; 180 then</span><br><span class="line">      <span class="builtin-name">set</span> <span class="attribute">description</span>=<span class="string">'æ ‡å‡†èº«æ'</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      <span class="builtin-name">set</span> <span class="attribute">description</span>=<span class="string">'ä¸€èˆ¬èº«æ'</span>;</span><br><span class="line">    end <span class="keyword">if</span>;</span><br><span class="line">    select concat(<span class="string">'èº«é«˜'</span>,height,<span class="string">'å¯¹åº”çš„èº«æç±»å‹ä¸º'</span>,description);</span><br><span class="line">end$</span><br><span class="line"></span><br><span class="line">call pro_test5(198)$</span><br><span class="line">call pro_test5(178)$</span><br><span class="line">call pro_test5(158)$</span><br><span class="line"></span><br><span class="line">delimiter ;</span><br></pre></td></tr></table></figure><h2 id="å­˜å‚¨è¿‡ç¨‹-è¯­æ³•-è¾“å‡ºå‚æ•°"><a href="#å­˜å‚¨è¿‡ç¨‹-è¯­æ³•-è¾“å‡ºå‚æ•°" class="headerlink" title="å­˜å‚¨è¿‡ç¨‹ - è¯­æ³• - è¾“å‡ºå‚æ•°"></a>å­˜å‚¨è¿‡ç¨‹ - è¯­æ³• - è¾“å‡ºå‚æ•°</h2><p>éœ€æ±‚ï¼š  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ ¹æ®ä¼ å…¥çš„èº«é«˜å˜é‡ï¼Œè·å–å½“å‰èº«é«˜çš„æ‰€å±çš„èº«æç±»å‹</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š  </p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="function"><span class="keyword">procedure</span> <span class="title">pro_test5</span><span class="params">(<span class="keyword">in</span> height int ,<span class="keyword">out</span> description varchar(10)</span>)</span></span><br><span class="line"><span class="function"><span class="title">begin</span></span></span><br><span class="line"><span class="function">    <span class="title">if</span> <span class="title">height</span> &gt;=180 <span class="title">then</span></span></span><br><span class="line"><span class="function">        <span class="title">set</span> <span class="title">description</span>='èº«æé«˜æŒ‘';</span></span><br><span class="line">    elseif height &gt;= <span class="number">170</span> <span class="keyword">and</span> height &lt; <span class="number">180</span> <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">set</span> description=<span class="string">'èº«ææ ‡å‡†'</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">set</span> description=<span class="string">'ä¸€èˆ¬èº«æ'</span>;</span><br><span class="line">    <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line"><span class="keyword">end</span>$</span><br><span class="line"></span><br><span class="line">call pro_test5(<span class="number">188</span>,@description)$</span><br><span class="line"># @description ä»£è¡¨ç”¨æˆ·çš„å˜é‡ï¼›ç”¨æˆ·çš„ä¼šè¯å˜é‡</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> @description$ # æŸ¥è¯¢ç”¨æˆ·ä¼šè¯å˜é‡å–å€¼</span><br><span class="line"></span><br><span class="line">delimiter ;</span><br></pre></td></tr></table></figure><p><strong>å°çŸ¥è¯†</strong><br>@descriptionï¼šè¿™ç§å˜é‡è¦åœ¨å˜é‡åç§°å‰é¢åŠ ä¸Šâ€œ@â€ç¬¦å·ï¼Œå«åšç”¨æˆ·ä¼šè¯å˜é‡ï¼Œä»£è¡¨æ•´ä¸ªä¼šè¯è¿‡ç¨‹å®ƒéƒ½æ˜¯æœ‰ä½œç”¨çš„ï¼Œè¿™ä¸ªç±»ä¼¼äºå…¨å±€å˜é‡ä¸€æ ·ã€‚<br>@@global.sort_buffer_size:è¿™ç§åœ¨å˜é‡å‰åŠ ä¸Šâ€œ@@â€ï¼Œå«åšç³»ç»Ÿå˜é‡ï¼›  </p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">set</span> <span class="variable">@name</span>=<span class="string">'itcast'</span>$</span><br><span class="line"></span><br><span class="line"><span class="literal">select</span> <span class="variable">@name</span>$</span><br></pre></td></tr></table></figure><h2 id="å­˜å‚¨è¿‡ç¨‹-è¯­æ³•-caseç»“æ„"><a href="#å­˜å‚¨è¿‡ç¨‹-è¯­æ³•-caseç»“æ„" class="headerlink" title="å­˜å‚¨è¿‡ç¨‹ - è¯­æ³• - caseç»“æ„"></a>å­˜å‚¨è¿‡ç¨‹ - è¯­æ³• - caseç»“æ„</h2><p>è¯­æ³•ç»“æ„ï¼š  </p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">æ–¹å¼ä¸€ï¼š  </span><br><span class="line"><span class="keyword">CASE</span> case_value <span class="meta"># case_value æ¡ä»¶</span></span><br><span class="line">    <span class="keyword">WHEN</span> when_value <span class="keyword">THEN</span> statement_list <span class="meta"># statement_list SQLè¯­å¥</span></span><br><span class="line">    [ <span class="keyword">WHEN</span> when_value <span class="keyword">THEN</span> statement_list ] ...</span><br><span class="line">    [ <span class="keyword">ELSE</span> statement_list ]</span><br><span class="line"><span class="keyword">END</span> <span class="keyword">CASE</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">æ–¹æ‹¾äºŒï¼š  </span><br><span class="line"><span class="keyword">CASE</span></span><br><span class="line">    <span class="keyword">WHEN</span> search_condition <span class="keyword">THEN</span> statement_list <span class="meta"># search_condition æ¡ä»¶è¡¨è¾¾å¼ï¼›å¦‚æœè¯¥è¡¨è¾¾å¼ä¸ºçœŸåªæ‰§è¡ŒTHENåçš„statement_list SQLè¯­å¥</span></span><br><span class="line">    [ <span class="keyword">WHEN</span> search_condition <span class="keyword">THEN</span> statement_list ] ...</span><br><span class="line">    [ <span class="keyword">ELSE</span> statement_list ]</span><br><span class="line"><span class="keyword">END</span> <span class="keyword">CASE</span>;</span><br></pre></td></tr></table></figure><p>éœ€æ±‚ï¼š  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç»™å®šä¸€ä¸ªæœˆä»½ï¼Œç„¶åè®¡ç®—å‡ºæ‰€åœ¨çš„å­£åº¦</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š  </p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">delimiter $</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="function"><span class="keyword">procedure</span> <span class="title">pro_test7</span><span class="params">( mon int)</span></span></span><br><span class="line"><span class="function"><span class="title">begin</span></span></span><br><span class="line"><span class="function">    <span class="title">declare</span> <span class="title">result</span> <span class="title">varchar</span><span class="params">(10)</span>;</span></span><br><span class="line">    <span class="keyword">case</span></span><br><span class="line">      when mou&gt;=<span class="number">1</span> <span class="keyword">and</span> mon &lt;=<span class="number">2</span> <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">set</span> <span class="keyword">result</span>=<span class="string">'ç¬¬ä¸€å­£åº¦'</span>;</span><br><span class="line">      when mou&gt;=<span class="number">4</span> <span class="keyword">and</span> mon &lt;=<span class="number">6</span> <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">set</span> <span class="keyword">result</span>=<span class="string">'ç¬¬äºŒå­£åº¦'</span>;</span><br><span class="line">      when mou&gt;=<span class="number">7</span> <span class="keyword">and</span> mon &lt;=<span class="number">9</span> <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">set</span> <span class="keyword">result</span>=<span class="string">'ç¬¬ä¸‰å­£åº¦'</span>;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">set</span> <span class="keyword">result</span>=<span class="string">'ç¬¬å››å­£åº¦'</span>;</span><br><span class="line">    <span class="keyword">end</span> <span class="keyword">case</span>;</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">concat</span>(<span class="string">'ä¼ é€’çš„æœˆä»½ä¸º'</span>,mon,<span class="string">'ï¼Œ è®¡ç®—å‡ºçš„ç»“æœä¸ºï¼š'</span>,<span class="keyword">result</span>) <span class="keyword">as</span> content;</span><br><span class="line"><span class="keyword">end</span>$</span><br><span class="line"></span><br><span class="line">call pro_test7(<span class="number">7</span>)$</span><br><span class="line">call pro_test7(<span class="number">2</span>)$</span><br><span class="line">call pro_test7(<span class="number">11</span>)$</span><br><span class="line">call pro_test7(<span class="number">9</span>)$</span><br><span class="line"></span><br><span class="line">delimiter ;</span><br></pre></td></tr></table></figure><h2 id="å­˜å‚¨è¿‡ç¨‹-è¯­æ³•-whileå¾ªç¯"><a href="#å­˜å‚¨è¿‡ç¨‹-è¯­æ³•-whileå¾ªç¯" class="headerlink" title="å­˜å‚¨è¿‡ç¨‹ - è¯­æ³• - whileå¾ªç¯"></a>å­˜å‚¨è¿‡ç¨‹ - è¯­æ³• - whileå¾ªç¯</h2><p>è¯­æ³•ç»“æ„ï¼š  </p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> search_condition <span class="keyword">do</span> <span class="comment"># search_condition æ¡ä»¶æˆç«‹æ‰§è¡Œå¾ªç¯ï¼›æ¡ä»¶ä¸æˆç«‹åˆ™è·³å‡ºå¾ªç¯</span></span><br><span class="line">    statement_list</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">while</span>;</span><br></pre></td></tr></table></figure><p>éœ€æ±‚ï¼š  </p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è®¡ç®—ä»<span class="number">1</span>åŠ åˆ°nçš„å€¼</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹:  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">delimiter $</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> pro_test8(n <span class="built_in">int</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">declare</span> total <span class="built_in">int</span> <span class="keyword">default</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">declare</span> <span class="keyword">start</span> <span class="built_in">int</span> <span class="keyword">default</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    while <span class="keyword">start</span> &lt;= n <span class="keyword">do</span></span><br><span class="line">        <span class="keyword">set</span> total=total+<span class="keyword">start</span>;</span><br><span class="line">        <span class="keyword">start</span>=<span class="keyword">start</span>+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">end</span> <span class="keyword">while</span>;</span><br><span class="line">    <span class="keyword">select</span> total;</span><br><span class="line"><span class="keyword">end</span>$</span><br><span class="line"></span><br><span class="line"><span class="keyword">call</span> pro_test8(<span class="number">3</span>)$</span><br><span class="line"><span class="keyword">call</span> pro_test8(<span class="number">6</span>)$</span><br><span class="line"><span class="keyword">call</span> pro_test8(<span class="number">100</span>)$</span><br><span class="line"></span><br><span class="line">delimiter ;</span><br></pre></td></tr></table></figure><h2 id="å­˜å‚¨è¿‡ç¨‹-è¯­æ³•-repeatå¾ªç¯"><a href="#å­˜å‚¨è¿‡ç¨‹-è¯­æ³•-repeatå¾ªç¯" class="headerlink" title="å­˜å‚¨è¿‡ç¨‹ - è¯­æ³• - repeatå¾ªç¯"></a>å­˜å‚¨è¿‡ç¨‹ - è¯­æ³• - repeatå¾ªç¯</h2><p>æœ‰æ¡ä»¶çš„å¾ªç¯æ§åˆ¶è¯­å¥ï¼Œå½“æ»¡è¶³æ¡ä»¶çš„æ—¶å€™é€€å‡ºå¾ªç¯ã€‚<br>whileæ˜¯æ»¡è¶³æ¡ä»¶æ‰æ‰§è¡Œï¼Œrepeatæ˜¯æ»¡è¶³æ¡ä»¶å°±é€€å‡ºå¾ªç¯ã€‚  </p><p>è¯­æ³•ç»“æ„ï¼š  </p><figure class="highlight cal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">REPEAT</span></span><br><span class="line">    statement_list</span><br><span class="line"></span><br><span class="line">    <span class="keyword">UNTIL</span> search_condition</span><br><span class="line"><span class="keyword">END</span> <span class="keyword">REPEAT</span>;</span><br></pre></td></tr></table></figure><p>éœ€æ±‚ï¼š  </p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è®¡ç®—ä»<span class="number">1</span>åŠ åˆ°nçš„å€¼</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š  </p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">delimiter $</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="function"><span class="keyword">procedure</span> <span class="title">pro_test9</span><span class="params">(n int)</span></span></span><br><span class="line"><span class="function"><span class="title">begin</span></span></span><br><span class="line"><span class="function">    <span class="title">declare</span> <span class="title">total</span> <span class="title">int</span> <span class="title">default</span> 0;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">repeat</span></span><br><span class="line">        <span class="keyword">set</span> total=total+n;</span><br><span class="line">        <span class="keyword">set</span> n=n-<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">until</span> n=<span class="number">0</span> # æ­¤å¤„ä¸åŠ åˆ†å·ï¼›åŠ åˆ†å·æŠ¥é”™ï¼›æ»¡è¶³å½“å‰æ¡ä»¶åˆ™è·³å‡ºå¾ªç¯</span><br><span class="line">    <span class="keyword">end</span> <span class="keyword">repeat</span>;</span><br><span class="line">    <span class="keyword">select</span> total;</span><br><span class="line"><span class="keyword">end</span>$</span><br><span class="line"></span><br><span class="line">call pro_test10(<span class="number">50</span>)$</span><br><span class="line"></span><br><span class="line">delimiter ;</span><br></pre></td></tr></table></figure><h2 id="å­˜å‚¨è¿‡ç¨‹-è¯­æ³•-loopå¾ªç¯"><a href="#å­˜å‚¨è¿‡ç¨‹-è¯­æ³•-loopå¾ªç¯" class="headerlink" title="å­˜å‚¨è¿‡ç¨‹ - è¯­æ³• - loopå¾ªç¯"></a>å­˜å‚¨è¿‡ç¨‹ - è¯­æ³• - loopå¾ªç¯</h2><h3 id="loopè¯­å¥"><a href="#loopè¯­å¥" class="headerlink" title="loopè¯­å¥"></a>loopè¯­å¥</h3><p>LOOPå®ç°ç®€å•çš„å¾ªç¯ï¼Œé€€å‡ºå¾ªç¯çš„æ¡ä»¶éœ€è¦ä½¿ç”¨å…¶ä»–çš„è¯­å¥å®šä¹‰ï¼Œé€šå¸¸å¯ä»¥ä½¿ç”¨LEAVEè¯­å¥å®ç°ï¼Œå…·ä½“è¯­æ³•å¦‚ä¸‹ï¼š  </p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[ begin_label: ] <span class="keyword">LOOP</span></span><br><span class="line">    statement_list</span><br><span class="line"><span class="keyword">END</span> <span class="keyword">LOOP</span> [ end_label ]</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸åœ¨ statement_list ä¸­å¢åŠ é€€å‡ºå¾ªç¯çš„è¯­å¥ï¼Œé‚£ä¹ˆLOOPè¯­å¥å¯ä»¥ç”¨æ¥å®ç°ç®€å•çš„æ­»å¾ªç¯</p><h3 id="leaveè¯­å¥"><a href="#leaveè¯­å¥" class="headerlink" title="leaveè¯­å¥"></a>leaveè¯­å¥</h3><p>ç”¨æ¥ä»æ ‡æ³¨çš„æµç¨‹æ„é€ ä¸­é€€å‡ºï¼Œé€šå¸¸å’ŒBEGINâ€¦.ENDæˆ–è€…å¾ªç¯ä¸€èµ·ä½¿ç”¨ã€‚<br>ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨LOOPå’ŒLEAVEçš„ç®€å•ä¾‹å­ï¼Œé€€å‡ºå¾ªç¯ï¼›</p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">delimiter $</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="function"><span class="keyword">PROCEDURE</span> <span class="title">pro_test10</span><span class="params">(n int)</span></span></span><br><span class="line"><span class="function"><span class="title">BEGIN</span></span></span><br><span class="line"><span class="function">    <span class="title">declare</span> <span class="title">total</span> <span class="title">int</span> <span class="title">default</span> 0;</span></span><br><span class="line"></span><br><span class="line">    ins:<span class="keyword">LOOP</span></span><br><span class="line">        <span class="keyword">IF</span> n &lt;= <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">          leave ins;</span><br><span class="line">        <span class="keyword">ELSE</span></span><br><span class="line">          <span class="keyword">SET</span> total=total+n;</span><br><span class="line">          <span class="keyword">SET</span> n=n-<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">LOOP</span> ins;</span><br><span class="line">    <span class="keyword">select</span> total;</span><br><span class="line"><span class="keyword">END</span>$</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="function"><span class="keyword">procedure</span> <span class="title">pro_test10</span><span class="params">(n int)</span></span></span><br><span class="line"><span class="function"><span class="title">begin</span></span></span><br><span class="line"><span class="function">    <span class="title">declare</span> <span class="title">total</span> <span class="title">int</span> <span class="title">default</span> 0;</span></span><br><span class="line"></span><br><span class="line">    c:<span class="keyword">loop</span></span><br><span class="line">        <span class="keyword">set</span> total=total+n;</span><br><span class="line">        <span class="keyword">set</span> n=n-<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> n&lt;<span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">            leave c; # æ»¡è¶³æ¡ä»¶è·³å‡ºå¾ªç¯</span><br><span class="line">        <span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line">    <span class="keyword">end</span> <span class="keyword">loop</span> c;</span><br><span class="line">    <span class="keyword">select</span> total;</span><br><span class="line"><span class="keyword">end</span>$</span><br><span class="line"></span><br><span class="line">call pro_test10(<span class="number">100</span>)$</span><br><span class="line">call pro_test10(<span class="number">99</span>)$</span><br><span class="line">call pro_test10(<span class="number">3</span>)$</span><br><span class="line"></span><br><span class="line">delimiter ;</span><br></pre></td></tr></table></figure><h2 id="å­˜å‚¨è¿‡ç¨‹-è¯­æ³•-æ¸¸æ ‡ä»‹ç»"><a href="#å­˜å‚¨è¿‡ç¨‹-è¯­æ³•-æ¸¸æ ‡ä»‹ç»" class="headerlink" title="å­˜å‚¨è¿‡ç¨‹ - è¯­æ³• - æ¸¸æ ‡ä»‹ç»"></a>å­˜å‚¨è¿‡ç¨‹ - è¯­æ³• - æ¸¸æ ‡ä»‹ç»</h2><p>æ¸¸æ ‡æ˜¯ç”¨æ¥å­˜å‚¨æŸ¥è¯¢ç»“æœé›†çš„æ•°æ®ç±»å‹ï¼Œå”‰å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°ä¸­å¯ä»¥ä½¿ç”¨å…‰æ ‡å¯¹ç»“æœé›†è¿›è¡Œå¾ªç¯çš„å¤„ç†ã€‚<br>å…‰æ ‡çš„ä½¿ç”¨åŒ…æ‹¬å…‰æ ‡çš„å£°æ˜ã€OPENã€FETCHå’ŒCLOSEã€‚  </p><h2 id="å­˜å‚¨è¿‡ç¨‹-è¯­æ³•-æ¸¸æ ‡åŸºæœ¬æ“ä½œ"><a href="#å­˜å‚¨è¿‡ç¨‹-è¯­æ³•-æ¸¸æ ‡åŸºæœ¬æ“ä½œ" class="headerlink" title="å­˜å‚¨è¿‡ç¨‹ - è¯­æ³• - æ¸¸æ ‡åŸºæœ¬æ“ä½œ"></a>å­˜å‚¨è¿‡ç¨‹ - è¯­æ³• - æ¸¸æ ‡åŸºæœ¬æ“ä½œ</h2><p>å…¶è¯­æ³•åˆ†åˆ«å¦‚ä¸‹ï¼š  </p><p>å£°æ˜å…‰æ ‡ï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> cursor_name <span class="keyword">CURSOR</span> <span class="keyword">for</span> select_statement;</span><br></pre></td></tr></table></figure><p>OPENå…‰æ ‡ï¼š  </p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OPEN cursor_name<span class="comment">;</span></span><br></pre></td></tr></table></figure><p>FETCHå…‰æ ‡ï¼š</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FETCH cursor_name INTO var_name [ , var_name ] <span class="string">...</span> <span class="comment"># æ¯æŠ“å–ä¸€æ¬¡ï¼Œå³è·å–ç»“æœé›†å½“ä¸­æ¯ä¸€è¡Œæ•°æ®ï¼›è°ƒç”¨ä¸€æ¬¡æŒ‡é’ˆå¾€ä¸‹æŒ‡å‘ä¸€æ¬¡ï¼›è°ƒç”¨ä¸€æ¬¡æŒ‡é’ˆå¾€ä¸‹æŒ‡å‘ä¸€æ¬¡ï¼›å½“æŒ‡é’ˆæŒ‡åˆ°æœ€åæ²¡æœ‰æ•°æ®çš„é‚£ä¸€è¡Œæ—¶ï¼Œå³æ­¤æ—¶å°±åº”è¯¥é€€å‡ºæ¸¸æ ‡äº†ï¼›</span></span><br></pre></td></tr></table></figure><p>CLOSEå…‰æ ‡ï¼š  </p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CLOSE cursor_name<span class="comment">;</span></span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š<br>åˆå§‹åŒ–è„šæœ¬:  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp(</span><br><span class="line">  <span class="keyword">id</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">not</span> <span class="literal">null</span> auto_increment,</span><br><span class="line">  <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">50</span>) <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">comment</span> <span class="string">'å§“å'</span>,</span><br><span class="line">  age <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">comment</span> <span class="string">'å¹´é¾„'</span>,</span><br><span class="line">  salary <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">comment</span> <span class="string">'è–ªæ°´'</span>,</span><br><span class="line">  primary <span class="keyword">key</span>(<span class="string">'id'</span>)</span><br><span class="line">)<span class="keyword">engine</span>=<span class="keyword">innodb</span> <span class="keyword">default</span> <span class="keyword">charset</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp(<span class="keyword">id</span>,<span class="keyword">name</span>,age,salary) <span class="keyword">values</span> (<span class="literal">null</span>,<span class="string">'é‡‘æ¯›ç‹®ç‹'</span>,<span class="number">55</span>,<span class="number">3800</span>),(<span class="literal">null</span>,<span class="string">'ç™½çœ‰é¹°ç‹'</span>,<span class="number">60</span>,<span class="number">4400</span>),(<span class="literal">null</span>,<span class="string">'é’ç¿¼è ç‹'</span>,<span class="number">38</span>,<span class="number">2800</span>),(<span class="literal">null</span>,<span class="string">'ç´ è¡«é¾™ç‹'</span>,<span class="number">42</span>,<span class="number">1800</span>);</span><br></pre></td></tr></table></figure><p>éœ€æ±‚ï¼š  </p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- æŸ¥è¯¢empè¡¨ä¸­æ•°æ®ï¼Œå¹¶é€è¡Œè·å–è¿›è¡Œæ˜¾ç¤º</span></span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š  </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delimiter</span> $</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> pro_test11()</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">declare</span> e_id <span class="type">int</span>(<span class="number">11</span>);</span><br><span class="line">    <span class="keyword">declare</span> e_name <span class="type">varchar</span>(<span class="number">50</span>);</span><br><span class="line">    decalre e_age <span class="type">int</span>(<span class="number">11</span>);</span><br><span class="line">    <span class="keyword">declare</span> e_salary <span class="type">int</span>(<span class="number">11</span>);</span><br><span class="line">    <span class="keyword">declare</span> emp_result <span class="keyword">cursor</span> fro <span class="keyword">select</span> * <span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">open</span> emp_result;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">fetch</span> emp_result <span class="keyword">into</span> e_id,e_naem,e_age,e_salary;</span><br><span class="line">    <span class="keyword">select</span> concat(<span class="string">'idä¸ºï¼š'</span> , e_id,<span class="string">', åå­—ä¸º: '</span> , e_name , <span class="string">', å¹´é¾„ä¸ºï¼š'</span> , e_age , <span class="string">', è–ªèµ„ä¸ºï¼š'</span> , e_salary);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">fetch</span> emp_result <span class="keyword">into</span> e_id,e_naem,e_age,e_salary;</span><br><span class="line">    <span class="keyword">select</span> concat(<span class="string">'idä¸ºï¼š'</span> , e_id,<span class="string">', åå­—ä¸º: '</span> , e_name , <span class="string">', å¹´é¾„ä¸ºï¼š'</span> , e_age , <span class="string">', è–ªèµ„ä¸ºï¼š'</span> , e_salary);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">fetch</span> emp_result <span class="keyword">into</span> e_id,e_naem,e_age,e_salary;</span><br><span class="line">    <span class="keyword">select</span> concat(<span class="string">'idä¸ºï¼š'</span> , e_id,<span class="string">', åå­—ä¸º: '</span> , e_name , <span class="string">', å¹´é¾„ä¸ºï¼š'</span> , e_age , <span class="string">', è–ªèµ„ä¸ºï¼š'</span> , e_salary);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">fetch</span> emp_result <span class="keyword">into</span> e_id,e_naem,e_age,e_salary;</span><br><span class="line">    <span class="keyword">select</span> concat(<span class="string">'idä¸ºï¼š'</span> , e_id,<span class="string">', åå­—ä¸º: '</span> , e_name , <span class="string">', å¹´é¾„ä¸ºï¼š'</span> , e_age , <span class="string">', è–ªèµ„ä¸ºï¼š'</span> , e_salary);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">fetch</span> emp_result <span class="keyword">into</span> e_id,e_naem,e_age,e_salary;</span><br><span class="line">    <span class="keyword">select</span> concat(<span class="string">'idä¸ºï¼š'</span> , e_id,<span class="string">', åå­—ä¸º: '</span> , e_name , <span class="string">', å¹´é¾„ä¸ºï¼š'</span> , e_age , <span class="string">', è–ªèµ„ä¸ºï¼š'</span> , e_salary);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">close</span> emp_result;</span><br><span class="line"><span class="keyword">end</span>$</span><br><span class="line"></span><br><span class="line"># empè¡¨å½“ä¸­åªæœ‰å››æ¡æ•°æ®ï¼Œå¦‚æœ<span class="keyword">fetch</span>çš„æ¬¡æ•°å¤§äºè¡¨å½“ä¸­çš„æ•°æ®ï¼Œé‚£ä¹ˆ<span class="keyword">fetch</span>è¡¨ä¸­æ€»è¡Œæ•°ä¾ç„¶å¯ä»¥æ‰“å°å‡ºæ¥ï¼Œä¸€æ—¦<span class="keyword">fetch</span>å¤§äºè¡¨ä¸­çš„æ€»è¡Œæ•°åˆ™è¿›è¡ŒæŠ¥é”™ï¼›</span><br><span class="line"></span><br><span class="line"># é€šè¿‡<span class="keyword">fetch</span>ä¸€è¡Œä¸€è¡Œè¿›è¡ŒæŠ“å–è®°å½•ç¼–å†™çš„æ•ˆç‡ååˆ†ä½ï¼›</span><br><span class="line"></span><br><span class="line"><span class="keyword">call</span> pro_test11();</span><br><span class="line"><span class="keyword">delimiter</span> ;</span><br></pre></td></tr></table></figure><h2 id="å­˜å‚¨è¿‡ç¨‹-è¯­æ³•-å¾ªç¯è·å–æ¸¸æ ‡"><a href="#å­˜å‚¨è¿‡ç¨‹-è¯­æ³•-å¾ªç¯è·å–æ¸¸æ ‡" class="headerlink" title="å­˜å‚¨è¿‡ç¨‹ - è¯­æ³• - å¾ªç¯è·å–æ¸¸æ ‡"></a>å­˜å‚¨è¿‡ç¨‹ - è¯­æ³• - å¾ªç¯è·å–æ¸¸æ ‡</h2><blockquote><p>å¾ªç¯å½“ä¸­ï¼Œæ¸¸æ ‡çš„fetché€€å‡ºåˆ¤æ–­</p></blockquote><p>1ï¼‰ count(*) into num;  num â€“<br>2ï¼‰ mysqlå­˜åœ¨æœºåˆ¶ï¼Œå˜é‡ï¼Œé€šè¿‡æ”¹å˜è¯¥å˜é‡å–å€¼çŠ¶æ€åŠé€€å‡ºfetch  </p><p>ç¤ºä¾‹ï¼š  </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delimiter</span> $</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> pro_test12()</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">declare</span> e_id <span class="type">int</span>(<span class="number">11</span>);</span><br><span class="line">    decalre e_name <span class="type">varchar</span>(<span class="number">50</span>);</span><br><span class="line">    decalre e_age <span class="type">int</span>(<span class="number">11</span>);</span><br><span class="line">    decalre e_salary <span class="type">int</span>(<span class="number">11</span>);</span><br><span class="line">    <span class="keyword">declare</span> has_data <span class="type">int</span> <span class="keyword">default</span> <span class="number">1</span>;#å½“has_dataä¸º<span class="number">1</span>æ—¶è¡¨ç¤ºè¿˜æœ‰æ•°æ®ï¼›å½“has_dataä¸º<span class="number">0</span>æ—¶è¡¨ç¤ºæ²¡æœ‰æ•°æ®</span><br><span class="line"></span><br><span class="line">    <span class="keyword">declare</span> emp_result <span class="keyword">cursor</span> <span class="keyword">for</span> <span class="keyword">select</span> * <span class="keyword">from</span> emp;</span><br><span class="line">    <span class="keyword">DECLARE</span> <span class="keyword">EXIT</span> <span class="keyword">HANDLER</span> <span class="keyword">FOR</span> <span class="keyword">NOT</span> <span class="built_in">FOUND</span> <span class="keyword">set</span> has_data=<span class="number">0</span>;#é€€å‡ºå½“å‰æ¸¸æ ‡æŒ‡å‘ç¨‹åºå¹¶è®¾ç½®has_dataä¸º<span class="number">0</span>ï¼›æ­¤ä¸ºmysqlæä¾›çš„ä¸€ç§æœºåˆ¶ï¼›åŒæ—¶è¯¥å¥è¯éœ€è¦å£°æ˜åœ¨å£°æ˜æ¸¸æ ‡çš„ä¸‹æ–¹ï¼›å½“æ¸¸æ ‡è¿›è¡Œ<span class="keyword">fetch</span>è·å–ä¸åˆ°æ•°æ®çš„æ—¶å€™ï¼Œæ­¤æ—¶ä¼šè¿›è¡Œè§¦å‘ï¼›</span><br><span class="line"></span><br><span class="line">    <span class="keyword">open</span> emp_reuslt;</span><br><span class="line"></span><br><span class="line">    repeat</span><br><span class="line">        <span class="keyword">fetch</span> emp_result <span class="keyword">into</span> e_id,e_name,e_age,e_salary;</span><br><span class="line">        <span class="keyword">select</span> concat(<span class="string">'idä¸ºï¼š'</span> , e_id,<span class="string">', åå­—ä¸º: '</span> , e_name , <span class="string">', å¹´é¾„ä¸ºï¼š'</span> , e_age , <span class="string">', è–ªèµ„ä¸ºï¼š'</span> , e_salary);</span><br><span class="line">        <span class="keyword">until</span> has_data=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">end</span> repeat;</span><br><span class="line">    <span class="keyword">close</span> emp_result;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">call</span> pro_test12()$</span><br><span class="line"></span><br><span class="line"><span class="keyword">delimiter</span> ;</span><br></pre></td></tr></table></figure><h2 id="å­˜å‚¨å‡½æ•°"><a href="#å­˜å‚¨å‡½æ•°" class="headerlink" title="å­˜å‚¨å‡½æ•°"></a>å­˜å‚¨å‡½æ•°</h2><p>è¯­æ³•ç»“æ„ï¼š  </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE FUNCTION function_name([ param<span class="built_in"> type </span><span class="built_in">..</span>. ])</span><br><span class="line">RETURNS type</span><br><span class="line">BEGIN</span><br><span class="line">    <span class="built_in">..</span><span class="built_in">..</span>.</span><br><span class="line">END;</span><br></pre></td></tr></table></figure><p>æ¡ˆä¾‹ï¼š<br>å®šä¹‰ä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹ï¼Œè¯·æ±‚æ»¡è¶³æ¡ä»¶çš„æ€»è®°å½•æ•°ï¼š  </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delimiter</span> $</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">function</span> count_city(countryId <span class="type">int</span>)</span><br><span class="line"><span class="keyword">returns</span> <span class="type">int</span> # æ­¤å¤„ä¸éœ€è¦åˆ†å·</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">declare</span> cnum <span class="type">int</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">select</span> count(*) <span class="keyword">into</span> cnum <span class="keyword">from</span> city <span class="keyword">where</span> country_id = countryId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> cnum;</span><br><span class="line"><span class="keyword">end</span>$</span><br><span class="line"></span><br><span class="line"><span class="keyword">delimiter</span> ;</span><br><span class="line"></span><br><span class="line"># å­˜å‚¨è¿‡ç¨‹è™½ç„¶æ²¡æœ‰è¿”å›å€¼ï¼›ä½†æ˜¯ä¾ç„¶å¯ä»¥è¿”å›ç»“æœï¼›å› ä¸ºå…¶å‚æ•°åˆ—è¡¨å½“ä¸­æœ‰<span class="keyword">in</span>ã€<span class="keyword">out</span>ï¼ˆè¿”å›å€¼ï¼‰ã€<span class="keyword">inout</span>ï¼›å­˜å‚¨å‡½æ•°èƒ½åšçš„äº‹æƒ…ï¼›å­˜å‚¨è¿‡ç¨‹ä¹Ÿå¯ä»¥åšï¼›</span><br></pre></td></tr></table></figure><blockquote><p>è°ƒç”¨å­˜å‚¨å‡½æ•°å‘½ä»¤</p></blockquote><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> count_city(<span class="number">1</span>)$</span><br><span class="line"><span class="keyword">select</span> count_city(<span class="number">2</span>)$</span><br></pre></td></tr></table></figure><blockquote><p>åˆ é™¤å­˜å‚¨å‡½æ•°å‘½ä»¤</p></blockquote><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop <span class="keyword">function</span> <span class="title">count_city$</span></span><br></pre></td></tr></table></figure><h2 id="è§¦å‘å™¨-ä»‹ç»"><a href="#è§¦å‘å™¨-ä»‹ç»" class="headerlink" title="è§¦å‘å™¨ - ä»‹ç»"></a>è§¦å‘å™¨ - ä»‹ç»</h2><p>è§¦å‘å™¨æ˜¯ä¸è¡¨æœ‰å…³çš„æ•°æ®åº“å¯¹è±¡ï¼ŒæŒ‡çš„æ˜¯åœ¨insertã€updateã€deleteä¹‹å‰æˆ–è€…ä¹‹åï¼Œè§¦å‘å¹¶æ‰§è¡Œè§¦å‘å™¨ä¸­å®šä¹‰çš„SQLè¯­å¥é›†åˆï¼Œè§¦å‘å™¨çš„è¿™ç§ç‰¹æ€§å¯ä»¥ååŠ©åº”ç”¨åœ¨æ•°æ®åº“ç«¯ç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§ï¼Œæ—¥å¿—è®°å½•ï¼Œæ•°æ®æ ¡éªŒç­‰æ“ä½œï¼›  </p><p>ä½¿ç”¨åˆ«åOLDå’ŒNEWæ¥å¼•ç”¨è§¦å‘å™¨ä¸­å‘ç”Ÿå˜åŒ–çš„è®°å½•å†…å®¹ï¼Œè¿™ä¸å…¶ä»–çš„æ•°æ®åº“æ˜¯ç›¸ä¼¼çš„ã€‚<br>ç°åœ¨è§¦å‘å™¨è¿˜åªæ”¯æŒè¡Œçº§è§¦å‘ï¼Œä¸æ”¯æŒè¯­å¥çº§è§¦å‘ã€‚  </p><table>  <tr>    <th>è§¦å‘å™¨ç±»å‹</th>    <th>NEWå’ŒOLDçš„ä½¿ç”¨</th>  </tr>  <tr>    <td>INSERTå‹è§¦å‘å™¨</td>    <td>NEWè¡¨ç¤ºå°†è¦æˆ–è€…å·²ç»æ–°å¢çš„æ•°æ®</td>  </tr>  <tr>    <td>UPDATEå‹è§¦å‘å™¨</td>    <td>OLDè¡¨ç¤ºä¿®æ”¹ä¹‹å‰çš„æ•°æ®ï¼ŒNEWè¡¨ç¤ºå°†è¦æˆ–è€…å·²ç»ä¿®æ”¹åçš„æ•°æ®</td>  </tr>  <tr>    <td>DELETEå‹è§¦å‘å™¨</td>    <td>OLDè¡¨ç¤ºå°†è¦æˆ–è€…å·²ç»åˆ é™¤çš„æ•°æ®</td>  </tr></table><h2 id="è§¦å‘å™¨-åˆ›å»ºåŠåº”ç”¨"><a href="#è§¦å‘å™¨-åˆ›å»ºåŠåº”ç”¨" class="headerlink" title="è§¦å‘å™¨ - åˆ›å»ºåŠåº”ç”¨"></a>è§¦å‘å™¨ - åˆ›å»ºåŠåº”ç”¨</h2><h3 id="åˆ›å»ºè§¦å‘å™¨"><a href="#åˆ›å»ºè§¦å‘å™¨" class="headerlink" title="åˆ›å»ºè§¦å‘å™¨"></a>åˆ›å»ºè§¦å‘å™¨</h3><p>è¯­æ³•ç»“æ„ï¼š  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> trigger_name</span><br><span class="line"></span><br><span class="line"><span class="keyword">before</span>/<span class="keyword">after</span> <span class="keyword">insert</span>/<span class="keyword">update</span>/<span class="keyword">delete</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># before åœ¨...ä¹‹å‰/after åœ¨...ä¹‹å</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">on</span> tb1_name</span><br><span class="line"></span><br><span class="line">[ <span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span> ] <span class="comment">-- å½“å‰æ“ä½œçš„æ˜¯ä¸€ä¸ªè¡Œçº§è§¦å‘å™¨;oracleæ•°æ®åº“å½“ä¸­æ—¢æœ‰è¡Œçº§è§¦å‘å™¨ä¹Ÿæœ‰è¯­å¥çº§çš„è§¦å‘å™¨ï¼›è€Œmysqlæ•°æ®åº“å½“ä¸­åªæ”¯æŒè¡Œçº§è§¦å‘å™¨ç°è¿˜ä¸æ”¯æŒè¯­å¥çº§è§¦å‘å™¨</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  trigger_stmt;<span class="comment">--è§¦å‘çš„å†…å®¹</span></span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure><p>éœ€æ±‚ï¼š  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é€šè¿‡è§¦å‘å™¨è®°å½• empè¡¨çš„æ•°æ®å˜æ›´æ—¥å¿—ï¼ŒåŒ…å«æ–°å¢ã€ä¿®æ”¹ã€åˆ é™¤ï¼›</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š  </p><p>é¦–å…ˆåˆ›å»ºä¸€å¼ æ—¥å¿—è¡¨:  </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp_logs(</span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">not</span> <span class="literal">null</span> auto_increment,</span><br><span class="line">    operation <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">comment</span> <span class="string">'æ“ä½œç±»å‹ï¼Œinsert/update/delete'</span>,</span><br><span class="line">    operate_time datatime <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">comment</span> <span class="string">'æ“ä½œæ—¶é—´'</span>,</span><br><span class="line">    operate_id <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">comment</span> <span class="string">'æ“ä½œè¡¨çš„id'</span>,</span><br><span class="line">    operate_params <span class="built_in">varchar</span>(<span class="number">500</span>) <span class="keyword">comment</span> <span class="string">'æ“ä½œå‚æ•°'</span>,</span><br><span class="line">    primary <span class="keyword">key</span>(<span class="string">'id'</span>)</span><br><span class="line">)<span class="keyword">engine</span>=<span class="keyword">innodb</span> <span class="keyword">default</span> <span class="keyword">charset</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span>$</span><br></pre></td></tr></table></figure><p>åˆ›å»ºinsertæ€§è§¦å‘å™¨ï¼Œå®Œæˆæ’å…¥æ•°æ®æ—¶çš„æ—¥å¿—è®°å½•ï¼›  </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELIMITER</span> $</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">trigger</span> emp_logs_insert_trigger</span><br><span class="line"><span class="keyword">after</span> <span class="keyword">insert</span></span><br><span class="line"><span class="keyword">on</span> emp</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">insert</span> <span class="keyword">into</span> emp_logs(id,operation,operate_time,operate_id,operate_params) <span class="keyword">values</span>(</span><br><span class="line">      <span class="keyword">null</span>,<span class="string">'insert'</span>,now(),<span class="built_in">new</span>.id,concat( <span class="string">'æ’å…¥å ( idï¼š'</span>, <span class="built_in">new</span>.id , <span class="string">', name: '</span> , <span class="built_in">new</span>.name , <span class="string">' ,  age: '</span> ,  <span class="built_in">new</span>.age , <span class="string">' , salary: '</span> , <span class="built_in">new</span>.salary , <span class="string">')'</span>)</span><br><span class="line">    );</span><br><span class="line">    # æ­¤å¤„çš„<span class="built_in">new</span>.idå³æ–°æ’å…¥empè¡¨ä¸­æ•°æ®çš„è®°å½•çš„idï¼Œå³empå½“ä¸­çš„idå­—æ®µï¼›</span><br><span class="line"><span class="keyword">end</span>$</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp(id,<span class="type">name</span>,age,salary) <span class="keyword">values</span>(<span class="keyword">null</span>,<span class="string">'å…‰æ˜å·¦ä½¿'</span>,<span class="number">30</span>,<span class="number">3500</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp$</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp_logs$</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp(id,<span class="type">name</span>,age,salary) <span class="keyword">values</span>(<span class="keyword">null</span>,<span class="string">'å…‰æ˜å³ä½¿'</span>,<span class="number">35</span>,<span class="number">3800</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">trigger</span> emp_logs_update_trigger</span><br><span class="line"><span class="keyword">after</span> <span class="keyword">update</span></span><br><span class="line"><span class="keyword">on</span> emp</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">insert</span> <span class="keyword">into</span> emp_logs(id,operation,operate_time,operate_id,operate_params) <span class="keyword">values</span>(</span><br><span class="line">      <span class="keyword">null</span>,<span class="string">'update'</span>,now(),<span class="built_in">new</span>.id,</span><br><span class="line">      concat( </span><br><span class="line">        <span class="string">'ä¿®æ”¹å‰ ( idï¼š'</span>, <span class="built_in">old</span>.id ,</span><br><span class="line">        <span class="string">',name: '</span> , <span class="built_in">old</span>.name ,</span><br><span class="line">        <span class="string">',age: '</span> ,  <span class="built_in">old</span>.age ,</span><br><span class="line">        <span class="string">',salary: '</span> , <span class="built_in">old</span>.salary ,</span><br><span class="line">        <span class="string">') ä¿®æ”¹å( idï¼š'</span>, <span class="built_in">new</span>.id ,</span><br><span class="line">        <span class="string">',name: '</span> , <span class="built_in">new</span>.name ,</span><br><span class="line">        <span class="string">',age: '</span> ,  <span class="built_in">new</span>.age ,</span><br><span class="line">        <span class="string">',salary: '</span> , <span class="built_in">new</span>.salary ,</span><br><span class="line">        <span class="string">')'</span>  </span><br><span class="line">        )</span><br><span class="line">    );</span><br><span class="line">    # æ­¤å¤„çš„<span class="built_in">new</span>.idå³æ–°æ’å…¥empè¡¨ä¸­æ•°æ®çš„è®°å½•çš„idï¼Œå³empå½“ä¸­çš„idå­—æ®µï¼›</span><br><span class="line"><span class="keyword">end</span>$</span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> emp <span class="keyword">set</span> age=<span class="number">39</span> <span class="keyword">where</span> id=<span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp$</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp_logs$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">trigger</span> emp_logs_delete_trigger</span><br><span class="line"><span class="keyword">after</span> <span class="keyword">delete</span></span><br><span class="line"><span class="keyword">on</span> emp</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">insert</span> <span class="keyword">into</span> emp_logs(id,operation,operate_time,operate_id,operate_params) <span class="keyword">values</span>(</span><br><span class="line">      <span class="keyword">null</span>,<span class="string">'delete'</span>,now(),<span class="built_in">old</span>.id,</span><br><span class="line">      concat(</span><br><span class="line">        <span class="string">'åˆ é™¤å‰( idï¼š'</span>, <span class="built_in">old</span>.id ,</span><br><span class="line">        <span class="string">',name: '</span> , <span class="built_in">old</span>.name ,</span><br><span class="line">        <span class="string">',age: '</span> ,  <span class="built_in">old</span>.age ,</span><br><span class="line">        <span class="string">',salary: '</span> , <span class="built_in">old</span>.salary ,</span><br><span class="line">        <span class="string">')'</span>  </span><br><span class="line">        )</span><br><span class="line">    );</span><br><span class="line"><span class="keyword">end</span>$</span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> emp <span class="keyword">where</span> id=<span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp$</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp_logs$</span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> emp <span class="keyword">where</span> id=<span class="number">5</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp$</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp_logs$</span><br><span class="line"></span><br><span class="line"><span class="keyword">DELIMITER</span> ;</span><br></pre></td></tr></table></figure><h2 id="è§¦å‘å™¨-æŸ¥çœ‹åŠåˆ é™¤"><a href="#è§¦å‘å™¨-æŸ¥çœ‹åŠåˆ é™¤" class="headerlink" title="è§¦å‘å™¨ - æŸ¥çœ‹åŠåˆ é™¤"></a>è§¦å‘å™¨ - æŸ¥çœ‹åŠåˆ é™¤</h2><h3 id="åˆ é™¤è§¦å‘å™¨"><a href="#åˆ é™¤è§¦å‘å™¨" class="headerlink" title="åˆ é™¤è§¦å‘å™¨"></a>åˆ é™¤è§¦å‘å™¨</h3><p>è¯­æ³•ç»“æ„ï¼š  </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">trigger</span> [ <span class="built_in">schema_name</span>.] trigger_name</span><br></pre></td></tr></table></figure><p>å¦‚æœæ²¡æœ‰æŒ‡å®šschema_nameï¼Œé»˜è®¤ä¸ºå½“å‰æ•°æ®åº“ã€‚</p><h3 id="æŸ¥çœ‹è§¦å‘å™¨"><a href="#æŸ¥çœ‹è§¦å‘å™¨" class="headerlink" title="æŸ¥çœ‹è§¦å‘å™¨"></a>æŸ¥çœ‹è§¦å‘å™¨</h3><p>å¯ä»¥é€šè¿‡æ‰§è¡ŒSHOW TRIGGERS å‘½ä»¤æŸ¥çœ‹è§¦å‘å™¨çš„çŠ¶æ€ã€è¯­æ³•ç­‰ä¿¡æ¯ã€‚<br>è¯­æ³•ç»“æ„ï¼š  </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> triggers;</span><br><span class="line"></span><br><span class="line"># Event è§¦å‘å™¨ç›‘å¬çš„äº‹ä»¶ <span class="keyword">INSERT</span>/<span class="keyword">UPDATE</span>/<span class="keyword">DELETE</span></span><br><span class="line"># <span class="keyword">Table</span> å¯¹äºå“ªä¸€å¼ è¡¨ç›‘å¬çš„è§¦å‘å™¨</span><br><span class="line"># <span class="keyword">Timing</span> è§¦å‘å™¨æ˜¯å‰ç½®è§¦å‘<span class="keyword">BEFORE</span>è¿˜æ˜¯åç½®è§¦å‘<span class="keyword">AFTER</span></span><br><span class="line"># <span class="keyword">Statement</span> è§¦å‘å™¨å®šä¹‰</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;è§‚çœ‹ç¬”è®°ï¼š&lt;code&gt;https://www.bilibili.com/video/BV1fJ41127Rj?from=search&amp;amp
      
    
    </summary>
    
    
      <category term="ç¬”è®°" scheme="https://fengshana.github.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="ç¬”è®°" scheme="https://fengshana.github.io/tags/%E7%AC%94%E8%AE%B0/"/>
    
      <category term="MySQL" scheme="https://fengshana.github.io/tags/MySQL/"/>
    
      <category term="æ•°æ®åº“ä¼˜åŒ–" scheme="https://fengshana.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>Gitå·¥ä½œæµå­¦ä¹ ç¬”è®°</title>
    <link href="https://fengshana.github.io/2020/05/27/%E3%80%90GIT%E3%80%91/%E3%80%90GIT%E3%80%91Git%E5%B7%A5%E4%BD%9C%E6%B5%81%E5%AD%A6%E4%B9%A0/"/>
    <id>https://fengshana.github.io/2020/05/27/%E3%80%90GIT%E3%80%91/%E3%80%90GIT%E3%80%91Git%E5%B7%A5%E4%BD%9C%E6%B5%81%E5%AD%A6%E4%B9%A0/</id>
    <published>2020-05-27T10:34:59.148Z</published>
    <updated>2020-06-05T17:45:56.316Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Gitå·¥ä½œæµæŒ‡å—-åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ"><a href="#Gitå·¥ä½œæµæŒ‡å—-åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ" class="headerlink" title="Gitå·¥ä½œæµæŒ‡å— åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ"></a>Gitå·¥ä½œæµæŒ‡å— åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</h2><p>è§‚çœ‹ç¬”è®°ï¼š<code>https://www.bilibili.com/video/BV1dW411U7ER?p=1</code><br>è€å¸ˆç¬”è®°ï¼š <code>http://www.funtl.com/zh/git/</code>  </p><h2 id="Gitç®€ä»‹"><a href="#Gitç®€ä»‹" class="headerlink" title="Gitç®€ä»‹"></a>Gitç®€ä»‹</h2><ul><li>ä»€ä¹ˆæ˜¯<strong>ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</strong></li><li>ä»€ä¹ˆæ˜¯<strong>Git</strong></li><li>å¦‚ä½•<strong>å®‰è£…Git</strong></li></ul><h3 id="ä»€ä¹ˆæ˜¯ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ"><a href="#ä»€ä¹ˆæ˜¯ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ"></a>ä»€ä¹ˆæ˜¯ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</h3><h4 id="ä¸ºä»€ä¹ˆéœ€è¦ç‰ˆæœ¬æ§åˆ¶"><a href="#ä¸ºä»€ä¹ˆéœ€è¦ç‰ˆæœ¬æ§åˆ¶" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦ç‰ˆæœ¬æ§åˆ¶"></a>ä¸ºä»€ä¹ˆéœ€è¦ç‰ˆæœ¬æ§åˆ¶</h4><p>åœ¨è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæ¯å¤©éƒ½ä¼šäº§ç”Ÿæ–°çš„ä»£ç ï¼Œ<strong>ä»£ç åˆå¹¶</strong>çš„è¿‡ç¨‹ä¸­å¯èƒ½ä¼šå‡ºç°å¦‚ä¸‹<strong>é—®é¢˜</strong>ï¼š  </p><ul><li><strong>ä»£ç è¦†ç›–æˆ–ä¸¢å¤±</strong>ï¼›</li><li>ä»£ç å†™çš„ä¸ç†æƒ³ï¼Œå¸Œæœ›<strong>è¿˜åŸ</strong>ä¹‹å‰çš„<strong>ç‰ˆæœ¬</strong>ï¼›</li><li>å¸Œæœ›çŸ¥é“ä¸ä¹‹å‰<strong>ç‰ˆæœ¬çš„å·®åˆ«</strong>ï¼›</li><li>æ˜¯<strong>è°</strong>ä¿®æ”¹äº†ä»£ç ä»¥åŠ<strong>ä¸ºä»€ä¹ˆ</strong>ä¿®æ”¹ï¼›</li><li><strong>å‘ç‰ˆ</strong>æ—¶å¸Œæœ›åˆ†æˆ<strong>ä¸åŒçš„ç‰ˆæœ¬</strong>ï¼ˆæµ‹è¯•ç‰ˆæœ¬ã€å‘è¡Œç‰ˆæœ¬ç­‰ï¼‰ï¼›</li></ul><p>å› æ­¤ï¼Œå¸Œæœ›æœ‰ä¸€ç§<strong>æœºåˆ¶</strong>ï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬ï¼š  </p><ul><li>å¯ä»¥<strong>éšæ—¶å›æ»š</strong>åˆ°ä¹‹å‰çš„<strong>ç‰ˆæœ¬</strong>ï¼›</li><li>ååŒå¼€å‘æ—¶ï¼Œ<strong>ä¸ä¼šè¦†ç›–</strong>åˆ«äººçš„ä»£ç ï¼›</li><li>ç•™ä¸‹<strong>ä¿®æ”¹è®°å½•</strong>ï¼Œä»¥ä¾¿éšæ—¶æŸ¥çœ‹ï¼›</li><li><strong>å‘ç‰ˆ</strong>æ—¶å¯ä»¥æ–¹ä¾¿çš„ç®¡ç†<strong>ä¸åŒçš„ç‰ˆæœ¬</strong>ï¼›</li></ul><h4 id="ä»€ä¹ˆæ˜¯ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ-1"><a href="#ä»€ä¹ˆæ˜¯ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ-1" class="headerlink" title="ä»€ä¹ˆæ˜¯ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ"></a>ä»€ä¹ˆæ˜¯ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</h4><p>ä¸€ä¸ªæ ‡å‡†çš„<strong>ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</strong> <strong>Version Control Systemï¼ˆVCSï¼‰</strong>ï¼Œé€šå¸¸éœ€è¦æœ‰ä»¥ä¸‹åŠŸèƒ½ï¼š  </p><ul><li>èƒ½å¤Ÿ<strong>åˆ›å»ºRepository</strong>ï¼ˆ<strong>ä»“åº“</strong>ï¼‰ï¼Œç”¨æ¥<strong>ä¿å­˜ä»£ç </strong>ï¼›</li><li>ååŒå¼€å‘æ—¶ï¼Œæ–¹ä¾¿å°†<strong>ä»£ç åˆ†å‘</strong>ç»™å›¢é˜Ÿæˆå‘˜ï¼›</li><li><strong>è®°å½•</strong>æ¯æ¬¡<strong>ä¿®æ”¹</strong>ä»£ç çš„å†…å®¹ã€æ—¶é—´ã€åŸå› ç­‰<strong>ä¿¡æ¯</strong>ï¼›</li><li>èƒ½å¤Ÿ<strong>åˆ›å»ºBranchï¼ˆåˆ†æ”¯ï¼‰</strong>ï¼Œå¯ä»¥æ ¹æ®<strong>ä¸åŒçš„åœºæ™¯</strong>è¿›è¡Œ<strong>å¼€å‘</strong>ï¼›</li><li>èƒ½å¤Ÿ<strong>åˆ›å»ºTagï¼ˆæ ‡ç­¾ï¼‰</strong>ï¼Œ<strong>å»ºç«‹</strong>é¡¹ç›®<strong>é‡Œç¨‹ç¢‘</strong>ï¼›</li></ul><h4 id="ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„å‘å±•å²"><a href="#ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„å‘å±•å²" class="headerlink" title="ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„å‘å±•å²"></a>ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„å‘å±•å²</h4><p><strong>ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</strong>å‘å±•è‡³ä»Šæœ‰å‡ ç§<strong>ä¸åŒçš„æ¨¡å¼</strong>ï¼š  </p><h5 id="Local-VCS"><a href="#Local-VCS" class="headerlink" title="Local VCS"></a>Local VCS</h5><p><strong>æœ¬åœ°</strong>ä½¿ç”¨ <strong>å¤åˆ¶/ç²˜è´´</strong> çš„æ–¹å¼è¿›è¡Œç®¡ç†ï¼Œ<strong>ç¼ºç‚¹</strong>æ˜¯<strong>æ— æ³•ååŒå¼€å‘</strong></p><h5 id="Gentralized-VCSï¼ˆLockï¼Œæ‚²è§‚é”ï¼‰"><a href="#Gentralized-VCSï¼ˆLockï¼Œæ‚²è§‚é”ï¼‰" class="headerlink" title="Gentralized VCSï¼ˆLockï¼Œæ‚²è§‚é”ï¼‰"></a>Gentralized VCSï¼ˆLockï¼Œæ‚²è§‚é”ï¼‰</h5><p><strong>ä¸­å¤®é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</strong>å›¢é˜Ÿå…±ç”¨ä»“åº“ï¼Œå½“æŸäººéœ€è¦ç¼–è¾‘æ–‡ä»¶æ—¶ï¼Œ<strong>è¿›è¡Œé”å®šï¼Œä»¥å…å…¶ä»–äººåŒæ—¶ç¼–è¾‘æ—¶é€ æˆå†²çª</strong>ï¼Œä½†ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Œ<strong>å…¶ä»–äººéœ€è¦æ’é˜Ÿæ‰èƒ½ç¼–è¾‘æ–‡ä»¶ï¼Œå¦‚æœæœ‰äººç¼–è¾‘äº†å¾ˆä¹…æˆ–æ˜¯å¿˜è®°è§£é”ä¼šé€ æˆå…¶ä»–äººé•¿æ—¶é—´ç­‰å¾…</strong>çš„æƒ…å†µï¼›  </p><p>å¦‚ä½•ç†è§£æ‚²è§‚é”ï¼šæ€»æœ‰åˆæ°‘æƒ³å®³æœ•ã€‚<br>æˆ‘è¦æ˜¯é¢è¯•è¿™ä¹ˆç­”ï¼Œä¼šæ€ä¹ˆæ ·ï¼Ÿ  </p><h5 id="Gentralized-VCSï¼ˆMergeï¼Œä¹è§‚é”ï¼‰"><a href="#Gentralized-VCSï¼ˆMergeï¼Œä¹è§‚é”ï¼‰" class="headerlink" title="Gentralized VCSï¼ˆMergeï¼Œä¹è§‚é”ï¼‰"></a>Gentralized VCSï¼ˆMergeï¼Œä¹è§‚é”ï¼‰</h5><p><strong>ä¸­å¤®é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</strong>å›¢é˜Ÿå…±ç”¨ä»“åº“ï¼Œ<strong>ä¸é‡‡ç”¨æ‚²è§‚é”æ–¹å¼æ¥é¿å…å†²çª</strong>ï¼Œè€Œæ˜¯æ—¶å€™å‘ç°å¦‚æœåˆ«äººä¹Ÿä¿®æ”¹ç›¸åŒæ–‡ä»¶ï¼ˆå†²çªï¼‰ï¼Œå†<strong>è¿›è¡Œæ‰‹åŠ¨ä¿®æ”¹è§£å†³</strong>ã€‚  </p><p>æœ‰å¾ˆå¤šVCSå±äºè¿™ç§ç±»å‹ï¼Œå¦‚ï¼šCVSã€<strong>Subversion</strong>ã€Perforceç­‰ï¼›  </p><p><strong>ä¸­å¤®é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</strong>çš„å…±åŒé—®é¢˜æ˜¯ï¼Œåš<strong>ä»»ä½•æ“ä½œéƒ½éœ€è¦å’ŒæœåŠ¡å™¨åŒæ­¥</strong>ï¼Œå¦‚æœ<strong>æœåŠ¡å™¨å®•æœºåˆ™ä¼šé€ æˆæ— æ³•ç»§ç»­å·¥ä½œçš„çª˜è¿«</strong>ï¼›  </p><p>å¦‚ä½•ç†è§£ä¹è§‚é”ï¼šå¤©ç½‘æ¢æ¢ç–è€Œä¸æ¼ã€‚<br>æˆ‘æƒ³ç»™è‡ªå·±ä¸¤é”¤å­ï¼›  </p><h5 id="Distributed-VCS"><a href="#Distributed-VCS" class="headerlink" title="Distributed VCS"></a>Distributed VCS</h5><p><strong>åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</strong>ï¼Œ<strong>æœ¬åœ°</strong>ä¹Ÿ<strong>æ‹¥æœ‰å®Œæ•´çš„ä»£ç ä»“åº“</strong>ï¼Œå°±ä¸ä¼šå‡ºç°ä¸Šè¿°é›†ä¸­å¼ç®¡ç†çš„é—®é¢˜ï¼Œå³ä½¿<strong>æ²¡æœ‰ç½‘ç»œï¼Œä¾ç„¶å¯ä»¥commitå’Œçœ‹log</strong>ï¼Œä¹Ÿ<strong>æ— éœ€æ‹…å¿ƒæœåŠ¡å™¨åŒæ­¥</strong>é—®é¢˜ï¼›  </p><p>å¦‚ï¼š<strong>Git</strong>ã€Mercurialã€Bazaarç­‰å°±å±äº<strong>åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</strong>ã€‚<strong>ç¼ºç‚¹</strong>æ˜¯<strong>åŠŸèƒ½æ¯”è¾ƒå¤æ‚</strong>ï¼Œä¸Šæ‰‹éœ€è¦ä¸€å®šçš„å­¦ä¹ æ—¶é—´ï¼›  </p><p>ï¼ˆ<strong>åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</strong>éƒ½æœ‰ä¸€ä¸ª<strong>æœ¬åœ°åŒ–</strong>çš„è¿™æ ·ä¸€ä¸ªæ¦‚å¿µï¼›<strong>åŒºå—é“¾ç³»ç»Ÿ</strong>ä¹Ÿèƒ½ç§°ä¹‹ä¸ºä¸€ä¸ª<strong>åˆ†å¸ƒå¼ç³»ç»Ÿ</strong>ï¼‰  </p><h2 id="Gitå·¥ä½œæµ"><a href="#Gitå·¥ä½œæµ" class="headerlink" title="Gitå·¥ä½œæµ"></a>Gitå·¥ä½œæµ</h2><p><strong>Gitå·¥ä½œæµ</strong>ï¼š<strong>ä»£ç ç®¡ç†</strong>çš„<strong>å·¥ä½œæµç¨‹ã€æ–¹å¼</strong>  </p><ul><li><strong>Gitå·¥ä½œæµ</strong>ç®€ä»‹</li><li><strong>é›†ä¸­å¼å·¥ä½œæµ</strong></li><li><strong>åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµ</strong></li><li><strong>GitFlowå·¥ä½œæµ</strong></li><li><strong>Forkingå·¥ä½œæµ</strong></li><li><strong>Pull Requests</strong></li></ul><h3 id="Gitå·¥ä½œæµç®€ä»‹"><a href="#Gitå·¥ä½œæµç®€ä»‹" class="headerlink" title="Gitå·¥ä½œæµç®€ä»‹"></a>Gitå·¥ä½œæµç®€ä»‹</h3><p>å·¥ä½œæµæœ‰å„å¼å„æ ·çš„ç”¨æ³•ï¼Œä½†ä¹Ÿæ­£å› æ­¤ä½¿å¾—åœ¨å®é™…å·¥ä½œä¸­å¦‚ä½•ä¸Šæ‰‹ä½¿ç”¨å¢åŠ äº†éš¾åº¦ã€‚  </p><p>è¿™ç¯‡æŒ‡å—é€šè¿‡æ€»è§ˆå…¬å¸å›¢é˜Ÿä¸­æœ€å¸¸ç”¨çš„é›†ä¸­Gitå·¥ä½œæµè®©å¤§å®¶å¯ä»¥ä¸Šæ‰‹ä½¿ç”¨ï¼›  </p><p>åœ¨é˜…è¯»çš„è¿‡ç¨‹ä¸­è¯·è®°ä½ï¼Œæœ¬æ–‡ä¸­çš„é›†ä¸­å·¥ä½œæµæ˜¯ä½œä¸ºæ–¹æ¡ˆæŒ‡å¯¼è€Œä¸æ˜¯æ¡ä¾‹è§„å®šï¼Œåœ¨å±•ç¤ºäº†å„ç§å·¥ä½œæµå¯èƒ½çš„ç”¨æ³•åï¼Œå¯ä»¥ä»ä¸åŒçš„å·¥ä½œæµä¸­æŒ‘é€‰æˆ–æ‰åˆå‡ºä¸€ä¸ªæ»¡è¶³è‡ªå·±éœ€æ±‚çš„å·¥ä½œæµï¼›  </p><h4 id="é›†ä¸­å¼å·¥ä½œæµ"><a href="#é›†ä¸­å¼å·¥ä½œæµ" class="headerlink" title="é›†ä¸­å¼å·¥ä½œæµ"></a>é›†ä¸­å¼å·¥ä½œæµ</h4><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANXyIW2ezMoDhUXO*s5pTGue2N753CPNKcE42sPIP6l3d0rpu2DZjcGmC.Kga3cDUruqQwuWnPoetw.KevCfGSm5U!/r" alt="é›†ä¸­å¼å·¥ä½œæµ"></p><p>å¦‚æœå¼€å‘å›¢é˜Ÿæˆå‘˜å·²ç»å¾ˆç†Ÿ<strong>Subversion</strong>ï¼Œ<strong>é›†ä¸­å¼å·¥ä½œæµ</strong>è®©ä½ æ— éœ€å»é€‚åº”ä¸€ä¸ªå…¨æ–°æµç¨‹å°±å¯ä»¥ä½“éªŒGitå¸¦æ¥çš„æ”¶ç›Šã€‚  </p><p>è¿™ä¸ªå·¥ä½œæµä¹Ÿå¯ä»¥ä½œä¸ºå‘æ›´Gité£æ ¼å·¥ä½œæµè¿ç§»çš„å‹å¥½è¿‡æ¸¡ã€‚  </p><p>ï¼ˆä¸ªäººã€ä¸‰äº”ä¸ªäººçš„å°å›¢é˜Ÿï¼‰  </p><h4 id="åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµ"><a href="#åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµ" class="headerlink" title="åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµ"></a>åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµ</h4><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANX.QLkS1nyIjv6HHWnbV4dX7srariw7MEQpLi1gOAxL3ou18PqhQZr1mrBrEaIbVs5JuQWzjNbAd8lfxuJK8OGPM!/r" alt="åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµ"></p><p><strong>åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµ</strong>ä»¥<strong>é›†ä¸­å¼å·¥ä½œæµ</strong>ä¸º<strong>åŸºç¡€</strong>ï¼Œä¸åŒçš„æ˜¯ä¸º<strong>å„ä¸ªæ–°åŠŸèƒ½</strong>åˆ†é…<strong>ä¸€ä¸ªä¸“é—¨çš„åˆ†æ”¯</strong>æ¥å¼€å‘ã€‚  </p><p>è¿™æ ·å¯ä»¥åœ¨æŠŠæ–°åŠŸèƒ½ç»§æ‰¿åˆ°æ­£å¼é¡¹ç›®å‰ï¼Œç”¨<strong>Pull  Requests</strong>çš„æ–¹å¼<strong>è®¨è®ºå˜æ›´</strong>ï¼›  </p><p>ï¼ˆè¾¾åˆ°çº¦12ä¸ªäººçš„å›¢é˜Ÿï¼‰  </p><h4 id="Git-Flowå·¥ä½œæµ"><a href="#Git-Flowå·¥ä½œæµ" class="headerlink" title="Git Flowå·¥ä½œæµ"></a>Git Flowå·¥ä½œæµ</h4><p><strong>Git Flowå·¥ä½œæµ</strong>é€šè¿‡ä¸º<strong>åŠŸèƒ½å¼€å‘</strong>ã€<strong>å‘å¸ƒå‡†å¤‡</strong>å’Œ<strong>ç»´æŠ¤åˆ†é…ç‹¬ç«‹çš„åˆ†æ”¯</strong>ï¼Œè®©<strong>å‘å¸ƒè¿­ä»£</strong>è¿‡ç¨‹<strong>æ›´é¡ºç•…</strong>ã€‚  </p><p>ä¸¥æ ¼çš„åˆ†æ”¯æ¨¡å‹ä¹Ÿä¸ºå¤§å‹é¡¹ç›®æä¾›äº†ä¸€äº›éå¸¸å¿…è¦çš„ç»“æ„ã€‚  </p><p>ï¼ˆæ•´ä¸ªå…¬å¸ï¼Œè¿™ä¹ˆä¸€ä¸ªå›¢é˜Ÿçš„è§„æ¨¡ï¼‰  </p><h4 id="Forkingå·¥ä½œæµ"><a href="#Forkingå·¥ä½œæµ" class="headerlink" title="Forkingå·¥ä½œæµ"></a>Forkingå·¥ä½œæµ</h4><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANX7NQkdqkFQWuuELLHKCcql5ABKaPDZFUejww*HH9qtsi8qr7IlATkqBkQ9PV1LJ9rT6faqWzcfgS3pJZnzLSzVg!/r" alt="Forkingå·¥ä½œæµ"></p><p>Forkingå·¥ä½œæµæ˜¯åˆ†å¸ƒå¼å·¥ä½œæµï¼Œå……åˆ†åˆ©ç”¨äº†Gitåœ¨åˆ†æ”¯å’Œå…‹éš†ä¸Šçš„ä¼˜åŠ¿ã€‚  </p><p>å¯ä»¥å®‰å…¨å¯é åœ°ç®¡ç†å¤§å›¢é˜Ÿçš„å¼€å‘è€…ï¼ˆdeveloperï¼‰ï¼Œå¹¶èƒ½æ¥å—ä¸ä¿¡ä»»è´¡çŒ®è€…ï¼ˆcontributorï¼‰çš„æäº¤ã€‚  </p><p>ï¼ˆè·¨å›½åˆä½œã€‚è·¨å›½å›¢é˜Ÿçš„ä½¿ç”¨ï¼Œä¸€èˆ¬ç”¨äºForkingå·¥ä½œæµï¼‰  </p><h4 id="Pull-Requests"><a href="#Pull-Requests" class="headerlink" title="Pull Requests"></a>Pull Requests</h4><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANXzYbgZ.02.6Smac50apszMyWGwg89uQEVJSVU01e69u2Dts1al5lueZ4HgBrr.WyV.0GtO*ZTdT3LpQtilbX2Vk!/r" alt="Pull Requests"></p><p><strong>åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµ</strong>ã€<strong>GitFlowå·¥ä½œæµ</strong>ã€<strong>Forkingå·¥ä½œæµ</strong>éƒ½ä¼šç©¿æ’ä¸€ä¸ª<strong>Pull Requests</strong>çš„ä¸€ä¸ªä¸œè¥¿ã€‚  </p><p><strong>Pull Requests</strong>é€šå¸¸ç§°ä¸º<strong>è¯·æ±‚åˆå¹¶</strong>ï¼ˆ<strong>Merge Pull Requests</strong>ï¼‰ï¼›  </p><p><strong>Pull Requests</strong>è®©å¼€å‘è€…æ›´<strong>æ–¹ä¾¿åœ°è¿›è¡Œåä½œ</strong>çš„åŠŸèƒ½ï¼Œæä¾›äº†å‹å¥½çš„Webç•Œé¢å¯ä»¥åœ¨æè®®çš„ä¿®æ”¹åˆå¹¶åˆ°æ­£å¼é¡¹ç›®ä¹‹å‰å¯¹ä¿®æ”¹è¿›è¡Œè®¨è®ºã€‚  </p><p>ï¼ˆç›¸å½“äºä¸€ä¸ªè¯„è®ºç³»ç»Ÿï¼‰ï¼›</p><h3 id="é›†ä¸­å¼å·¥ä½œæµ-1"><a href="#é›†ä¸­å¼å·¥ä½œæµ-1" class="headerlink" title="é›†ä¸­å¼å·¥ä½œæµ"></a>é›†ä¸­å¼å·¥ä½œæµ</h3><p>è½¬åˆ°<strong>åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</strong>çœ‹èµ·æ¥åƒä¸ªä»¤äººç”Ÿç•çš„ä»»åŠ¡ï¼Œä½†ä¸æ”¹å˜å·²ç”¨çš„å·¥ä½œæµä½ ä¹Ÿå¯ä»¥ç”¨ä¸ŠGitå¸¦æ¥çš„æ”¶ç›Šã€‚  </p><p>å›¢é˜Ÿå¯ä»¥ç”¨å’ŒSubversionå®Œå…¨ä¸å˜çš„æ–¹å¼æ¥å¼€å‘é¡¹ç›®ã€‚  </p><p>ä½†ä½¿ç”¨GitåŠ å¼ºå¼€å‘çš„å·¥ä½œæµï¼Œ<strong>Gitæ¯”SVNæœ‰å‡ ä¸ªä¼˜åŠ¿</strong>ã€‚  </p><p><strong>ï¼ˆ1ï¼‰</strong> é¦–å…ˆï¼Œæ¯ä¸ªå¼€å‘è€…å¯ä»¥æœ‰å±äºè‡ªå·±çš„æ•´ä¸ª<strong>å·¥ç¨‹çš„æœ¬åœ°æ‹·è´</strong>ã€‚éš”ç¦»çš„ç¯å¢ƒè®©å„ä¸ªå¼€å‘è€…çš„å·¥ä½œå’Œé¡¹ç›®çš„å…¶ä»–éƒ¨åˆ†ï¼ˆä¿®æ”¹ï¼‰ç‹¬ç«‹å¼€æ¥â€”â€”-å³è‡ªç”±åœ°æäº¤åˆ°è‡ªå·±çš„æœ¬åœ°ä»“åº“ï¼Œå…ˆå®Œå…¨å¿½ç•¥ä¸Šæ¸¸çš„å¼€å‘ï¼Œç›´åˆ°æ–¹ä¾¿çš„æ—¶å€™å†æŠŠä¿®æ”¹åé¦ˆä¸Šå»ã€‚  </p><p><strong>ï¼ˆ2ï¼‰</strong> å…¶æ¬¡ï¼Œ<strong>Git</strong>æä¾›äº†<strong>å¼ºå£®çš„åˆ†æ”¯å’Œåˆå¹¶æ¨¡å‹</strong>ã€‚ä¸åƒSVNï¼ŒGitçš„åˆ†æ”¯è®¾è®¡æˆå¯ä»¥ä½œä¸ºä¸€ç§ç”¨æ¥åœ¨ä»“åº“ä¹‹é—´é›†æˆä»£ç å’Œåˆ†äº«ä¿®æ”¹çš„ <strong>ã€å¤±è´¥å®‰å…¨ã€‘</strong> çš„<strong>æœºåˆ¶</strong>ã€‚  </p><h4 id="å·¥ä½œæ–¹å¼"><a href="#å·¥ä½œæ–¹å¼" class="headerlink" title="å·¥ä½œæ–¹å¼"></a>å·¥ä½œæ–¹å¼</h4><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANX58rubGqwbukXS4rvP.hcw8vVDFpcMEKyanOzFC60vYY7EfnKsFaNa8DYFcGkpbCkTOCu8b0QXObUxn8ABvZn4U!/r" alt="å·¥ä½œæ–¹å¼"></p><p>åƒ<strong>Subversion</strong>ä¸€æ ·ï¼Œ<strong>é›†ä¸­å¼å·¥ä½œæµ</strong>ä»¥<strong>ä¸­å¤®ä»“åº“</strong>ä½œä¸ºé¡¹ç›®<strong>æ‰€æœ‰ä¿®æ”¹çš„å•ç‚¹å®ä½“</strong>ã€‚  </p><p>ç›¸æ¯”SVNç¼ºçœçš„å¼€å‘åˆ†æ”¯trunkï¼ŒGitå«åšmasterï¼Œæ‰€æœ‰ä¿®æ”¹æäº¤åˆ°è¿™ä¸ªåˆ†æ”¯ä¸Šã€‚  </p><p>è¯¥å·¥ä½œæµåªç”¨åˆ°masterè¿™ä¸€ä¸ªåˆ†æ”¯ã€‚  </p><p>å¼€å‘è€…å¼€å§‹å…ˆå…‹éš†ä¸­å¤®ä»“åº“ã€‚  </p><p>åœ¨è‡ªå·±çš„é¡¹ç›®æ‹·è´ä¸­ï¼ŒåƒSVNä¸€æ ·çš„ç¼–è¾‘æ–‡ä»¶å’Œæäº¤ä¿®æ”¹ï¼›  </p><p>ä½†ä¿®æ”¹æ˜¯å­˜åœ¨æœ¬åœ°çš„ï¼Œå’Œä¸­å¤®ä»“åº“å®Œå…¨éš”ç¦»çš„ï¼›  </p><p>å¼€å‘è€…å¯ä»¥æŠŠå’Œä¸Šæ¸¸çš„åŒæ­¥å»¶ååˆ°ä¸€ä¸ªæ–¹ä¾¿æ—¶é—´ç‚¹ï¼›  </p><p>è¦å‘å¸ƒä¿®æ”¹åˆ°æ­£å¼é¡¹ç›®ä¸­ï¼Œå¼€å‘è€…è¦æŠŠæœ¬åœ°masteråˆ†æ”¯çš„ä¿®æ”¹ã€æ¨ï¼ˆpushï¼‰ã€‘åˆ°ä¸­å¤®ä»“åº“ä¸­ã€‚  </p><p>è¿™ç›¸å½“äºsvn  commitæ“ä½œï¼Œä½†pushæ“ä½œä¼šæŠŠæ‰€æœ‰è¿˜ä¸åœ¨ä¸­å¤®ä»“åº“çš„æœ¬åœ°æäº¤éƒ½æ¨ä¸Šå»ã€‚  </p><h4 id="è§£å†³å†²çª"><a href="#è§£å†³å†²çª" class="headerlink" title="è§£å†³å†²çª"></a>è§£å†³å†²çª</h4><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANX7NAq94egRJ5nBPO8Co87th*P0cTdtAGYXp43mklxBxvhd73.i5d8Lm58WdsFYNrarV7XZaiqfrmkd3gUFAFW0o!/r" alt="è§£å†³å†²çª"></p><p>ä¸­å¤®ä»“åº“ä»£è¡¨äº†æ­£å¼é¡¹ç›®ï¼Œæ‰€ä»¥æäº¤å†å²åº”è¯¥è¢«å°Šé‡ä¸”æ˜¯ç¨³å®šä¸å˜çš„ã€‚  </p><p>å¦‚æœå¼€å‘è€…æœ¬åœ°çš„æäº¤å†å²å’Œä¸­å¤®ä»“åº“æœ‰åˆ†æ­§ï¼ŒGitä¼šæ‹’ç»pushæäº¤å¦åˆ™ä¼šè¦†ç›–å·²ç»åœ¨ä¸­å¤®åº“çš„æ­£å¼æäº¤ã€‚  </p><p>åœ¨å¼€å‘è€…æäº¤è‡ªå·±åŠŸèƒ½ä¿®æ”¹åˆ°ä¸­å¤®åº“å‰ï¼Œéœ€è¦å…ˆfetchåœ¨ä¸­å¤®åº“çš„æ–°å¢æäº¤ï¼Œrebaseè‡ªå·±æäº¤åˆ°ä¸­å¤®åº“æäº¤å†å²ä¹‹ä¸Šã€‚  </p><p>è¿™æ ·åšçš„æ„æ€æ˜¯åœ¨è¯´ï¼Œã€æˆ‘è¦æŠŠè‡ªå·±çš„ä¿®æ”¹åŠ åˆ°åˆ«äººå·²ç»å®Œæˆçš„ä¿®æ”¹ä¸Šã€‚ã€‘æœ€ç»ˆçš„ç»“æœæ˜¯ä¸€ä¸ªå®Œç¾çš„çº¿æ€§å†å²ï¼Œå°±åƒä»¥å‰çš„SVNçš„å·¥ä½œæµä¸­ä¸€æ ·ï¼›  </p><p>å¦‚æœæœ¬åœ°ä¿®æ”¹å’Œä¸Šæ¸¸æäº¤æœ‰å†²çªï¼ŒGitä¼šæš‚åœrebaseè¿‡ç¨‹ï¼Œç»™ä½ æ‰‹åŠ¨è§£å†³å†²çªçš„æœºä¼šã€‚  </p><p>Gitè§£å†³åˆå¹¶å†²çªï¼Œç”¨å’Œç”Ÿæˆæäº¤ä¸€æ ·çš„git  statuså’Œgit addå‘½ä»¤ï¼Œå¾ˆä¸€è‡´æ–¹ä¾¿ã€‚  </p><p>è¿˜æœ‰ä¸€ç‚¹ï¼Œå¦‚æœè§£å†³å†²çªæ—¶é‡åˆ°éº»çƒ¦ï¼ŒGitå¯ä»¥å¾ˆç®€å•ä¸­æ­¢æ•´ä¸ªrebaseæ“ä½œï¼Œé‡æ¥ä¸€æ¬¡ï¼ˆæˆ–è€…è®©åˆ«äººæ¥å¸®åŠ©è§£å†³ï¼‰ã€‚  </p><h4 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><p>ä¸€èµ·é€æ­¥åˆ†è§£æ¥çœ‹çœ‹ä¸€ä¸ªå¸¸è§çš„å°å›¢é˜Ÿå¦‚ä½•ç”¨è¿™ä¸ªå·¥ä½œæµæ¥åä½œçš„ã€‚  </p><p>æœ‰ä¸¤ä¸ªå¼€å‘è€…å°æ˜å’Œå°çº¢ï¼Œçœ‹ä»–ä»¬æ˜¯å¦‚ä½•å¼€å‘è‡ªå·±çš„åŠŸèƒ½å¹¶æäº¤åˆ°ä¸­å¤®ä»“åº“ä¸Šçš„ã€‚  </p><h5 id="æœ‰äººå…ˆåˆå§‹åŒ–å¥½ä¸­å¤®ä»“åº“"><a href="#æœ‰äººå…ˆåˆå§‹åŒ–å¥½ä¸­å¤®ä»“åº“" class="headerlink" title="æœ‰äººå…ˆåˆå§‹åŒ–å¥½ä¸­å¤®ä»“åº“"></a>æœ‰äººå…ˆåˆå§‹åŒ–å¥½ä¸­å¤®ä»“åº“</h5><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANX9UbT3uXKi44e*o.QOIDNJOk403REJAlPsZkIyST70GEweXbAbks3cFR7TqiVMFHAtTg9MXSvYT6HSyIH1eLii4!/r" alt="æœ‰äººå…ˆåˆå§‹åŒ–å¥½ä¸­å¤®ä»“åº“"></p><p>ç¬¬ä¸€æ­¥ï¼Œæœ‰äººåœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºå¥½ä¸­å¤®ä»“åº“ã€‚  </p><p>å¦‚æœæ˜¯æ–°é¡¹ç›®ï¼Œå¯ä»¥åˆå§‹åŒ–ä¸€ä¸ªç©ºä»“åº“ï¼›å¦åˆ™è¦å¯¼å…¥å·²æœ‰çš„Gitæˆ–SVNä»“åº“ã€‚  </p><p>ä¸­å¤®ä»“åº“åº”è¯¥æ˜¯ä¸ªè£¸ä»“åº“ï¼ˆbare repositoryï¼‰ï¼Œå³æ²¡æœ‰å·¥ä½œç›®å½•ï¼ˆworking directoryï¼‰çš„ä»“åº“ã€‚  </p><h5 id="æ‰€æœ‰äººå…‹éš†ä¸­å¤®ä»“åº“"><a href="#æ‰€æœ‰äººå…‹éš†ä¸­å¤®ä»“åº“" class="headerlink" title="æ‰€æœ‰äººå…‹éš†ä¸­å¤®ä»“åº“"></a>æ‰€æœ‰äººå…‹éš†ä¸­å¤®ä»“åº“</h5><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANX8lXRlkamDF*h*SxpL42PuUsH4aIULseTwL66K.p5pWkVzGz*Bh8Nih.I7qaVf43t7zoP8GGUp44vHNS*NRccIY!/r" alt="æ‰€æœ‰äººå…‹éš†ä¸­å¤®ä»“åº“"></p><p>ä¸‹ä¸€æ­¥ï¼Œå„ä¸ªå¼€å‘è€…åˆ›å»ºæ•´ä¸ªé¡¹ç›®çš„æœ¬åœ°æ‹·è´ã€‚  </p><p>é€šè¿‡git cloneå‘½ä»¤å®Œæˆã€‚  </p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span>  <span class="title">https</span>://github.com/path/to/repo.git</span><br></pre></td></tr></table></figure><p>åŸºäºåç»­ä¼šæŒç»­å’Œå…‹éš†çš„ä»“åº“åšäº¤äº’çš„å‡è®¾ï¼Œå…‹éš†ä»“åº“æ—¶Gitä¼šè‡ªåŠ¨æ·»åŠ è¿œç¨‹åˆ«åoriginæŒ‡å›ã€çˆ¶ã€‘ä»“åº“ã€‚  </p><p>githubå³gitçš„ä¸­å¤®ä»“åº“ï¼›ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿæœ‰ä¸€ä¸ªç‰ˆæœ¬ä»“åº“ã€‚  </p><p>githubä¸Špublicå³å¼€æºï¼Œå…¬å¼€çš„æ„æ€ï¼Œä»£ç å¼€æºã€‚  </p><p>å¦‚æœæ˜¯ç§æœ‰privateåˆ™éœ€è¦è¿›è¡ŒCreditCard ä¿¡ç”¨å¡æ”¯ä»˜ç›¸åº”çš„é‡‘é¢ï¼›æ”¶è´¹ï¼›  </p><h5 id="å°æ˜å¼€å‘åŠŸèƒ½"><a href="#å°æ˜å¼€å‘åŠŸèƒ½" class="headerlink" title="å°æ˜å¼€å‘åŠŸèƒ½"></a>å°æ˜å¼€å‘åŠŸèƒ½</h5><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANX3cSXX6681Ge8WeUymk3FFjspNtDVB3t7XeHuVufMD05ZhJzX9OyWJDCYAlloD65QJLNRkDaLpYfFLKjESAA0SM!/r" alt="å°æ˜å¼€å‘åŠŸèƒ½"></p><p>åœ¨å°æ˜çš„æœ¬åœ°ä»“åº“ä¸­ï¼Œä»–ä½¿ç”¨æ ‡å‡†çš„Gitè¿‡ç¨‹å¼€å‘åŠŸèƒ½ï¼šç¼–è¾‘ã€æš‚å­˜ï¼ˆStageï¼‰å’Œæäº¤ã€‚  </p><p>å¦‚æœä½ ä¸ç†Ÿæ‚‰æš‚å­˜åŒºï¼ˆStageing Areaï¼‰ï¼Œè¿™é‡Œè¯´æ˜ä¸€ä¸‹ï¼šæš‚å­˜åŒºçš„ç”¨æ¥å‡†å¤‡ä¸€ä¸ªæäº¤ï¼Œä½†å¯ä»¥ä¸ç”¨æŠŠå·¥ä½œç›®å½•ä¸­æ‰€æœ‰çš„ä¿®æ”¹å†…å®¹éƒ½åŒ…å«è¿›æ¥ã€‚  </p><p>è¿™æ ·å¯ä»¥åˆ›å»ºä¸€ä¸ªé«˜åº¦èšç„¦çš„æäº¤ï¼Œå°½ç®¡æœ¬åœ°ä¿®æ”¹å¾ˆå¤šå†…å®¹ã€‚  </p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git status <span class="comment"># æŸ¥çœ‹æœ¬åœ°ä»“åº“çš„ä¿®æ”¹çŠ¶æ€</span></span><br><span class="line">git <span class="keyword">add</span><span class="bash"> <span class="comment"># æš‚å­˜æ–‡ä»¶</span></span></span><br><span class="line">git commit <span class="comment"># æäº¤æ–‡ä»¶</span></span><br></pre></td></tr></table></figure><p>è¯·è®°ä½ï¼Œå› ä¸ºè¿™äº›å‘½ä»¤ç”Ÿæˆçš„æ˜¯æœ¬åœ°æäº¤ï¼Œå°æ˜å¯ä»¥æŒ‰è‡ªå·±éœ€æ±‚åå¤æ“ä½œå¤šæ¬¡ï¼Œè€Œä¸ç”¨æ‹…å¿ƒä¸­å¤®ä»“åº“æœ‰äº†ä»€ä¹ˆæ“ä½œã€‚  </p><p>å¯¹éœ€è¦å¤šä¸ªæ›´ç®€å•æ›´åŸå­åˆ†å—çš„å¤§åŠŸèƒ½ï¼Œè¿™ä¸ªåšæ³•æ˜¯å¾ˆæœ‰ç”¨çš„ï¼›  </p><h5 id="å°çº¢å¼€å‘åŠŸèƒ½"><a href="#å°çº¢å¼€å‘åŠŸèƒ½" class="headerlink" title="å°çº¢å¼€å‘åŠŸèƒ½"></a>å°çº¢å¼€å‘åŠŸèƒ½</h5><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANX3AhXN0w*Kh7FwIloQiq3PMOUwp*anqXsBqPo.yaxL1hWnR.kZm*XseG5RhBNtuoS8.PVSKuKSdHEw1x7MixOxA!/r" alt="å°çº¢å¼€å‘åŠŸèƒ½"></p><p>ä¸æ­¤åŒæ—¶ï¼Œå°çº¢åœ¨è‡ªå·±çš„æœ¬åœ°ä»“åº“ä¸­ç”¨ç›¸åŒçš„ç¼–è¾‘ã€æš‚å­˜å’Œæäº¤è¿‡ç¨‹å¼€å‘åŠŸèƒ½ã€‚  </p><p>å’Œå°æ˜ä¸€æ ·ï¼Œå¥¹ä¹Ÿä¸å…³å¿ƒä¸­å¤®ä»“åº“æœ‰æ²¡æœ‰æ–°æäº¤ï¼›å½“ç„¶æ›´ä¸å…³å¿ƒå°æ˜åœ¨ä»–çš„æœ¬åœ°ä»“åº“ä¸­çš„æ“ä½œï¼Œå› ä¸ºæ‰€æœ‰æœ¬åœ°ä»“åº“éƒ½æ˜¯ç§æœ‰çš„ã€‚  </p><h5 id="å°æ˜å‘å¸ƒåŠŸèƒ½"><a href="#å°æ˜å‘å¸ƒåŠŸèƒ½" class="headerlink" title="å°æ˜å‘å¸ƒåŠŸèƒ½"></a>å°æ˜å‘å¸ƒåŠŸèƒ½</h5><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANX2DDMKOOXZiA6a0j82260kNXKGqba7MbMMt5OmvuzTfK3A*Lxszb8CTdFEjjZXvIDOZez3cKxhQHt2dZMB.G9S4!/r" alt="å°æ˜å‘å¸ƒåŠŸèƒ½"></p><p>ä¸€æ—¦å°æ˜å®Œæˆäº†ä»–çš„åŠŸèƒ½å¼€å‘ï¼Œä¼šå‘å¸ƒä»–çš„æœ¬åœ°æäº¤åˆ°ä¸­å¤®ä»“åº“ä¸­ï¼Œè¿™æ ·å…¶ä»–å›¢é˜Ÿæˆå‘˜å¯ä»¥çœ‹åˆ°ä»–çš„ä¿®æ”¹ã€‚  </p><p>ä»–å¯ä»¥ç”¨ä¸‹é¢çš„git push  å‘½ä»¤ï¼š  </p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">push</span> <span class="built_in">origin</span> master</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œoriginæ˜¯å°æ˜å…‹éš†ä»“åº“æ—¶Gitåˆ›å»ºçš„è¿œç¨‹ä¸­å¤®ä»“åº“åˆ«åã€‚  </p><p>masterå‚æ•°å‘Šè¯‰Gitæ¨é€çš„åˆ†æ”¯ã€‚  </p><p>ç”±äºä¸­å¤®ä»“åº“è‡ªä»å°æ˜å…‹éš†ä»¥æ¥è¿˜æ²¡æœ‰è¢«æ›´æ–°è¿‡ï¼Œæ‰€ä»¥pushæ“ä½œä¸ä¼šæœ‰å†²çªï¼ŒæˆåŠŸå®Œæˆã€‚  </p><h5 id="å°çº¢è¯•ç€å‘å¸ƒåŠŸèƒ½"><a href="#å°çº¢è¯•ç€å‘å¸ƒåŠŸèƒ½" class="headerlink" title="å°çº¢è¯•ç€å‘å¸ƒåŠŸèƒ½"></a>å°çº¢è¯•ç€å‘å¸ƒåŠŸèƒ½</h5><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANX49Hssuuk2yHbmsbkSdUuOtLRbTxRlP3xEORKm5txDWaExKbZyYnyzyBD0oDqcjETeUWkabVFxZpo*3gs9yQWHs!/r" alt="å°çº¢è¯•ç€å‘å¸ƒåŠŸèƒ½"></p><p>ä¸€èµ·æ¥çœ‹çœ‹åœ¨å°æ˜å‘å¸ƒä¿®æ”¹åï¼Œå°çº¢pushä¿®æ”¹ä¼šæ€ä¹ˆæ ·ï¼Ÿ  </p><p>å¥¹ä½¿ç”¨å®Œå…¨ä¸€æ ·çš„pushå‘½ä»¤ï¼š  </p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">push</span> <span class="built_in">origin</span> master</span><br></pre></td></tr></table></figure><p>ä½†å¥¹çš„æœ¬åœ°å†å²å·²ç»å’Œä¸­å¤®ä»“åº“æœ‰åˆ†æ­§äº†ï¼ŒGitæ‹’ç»æ“ä½œå¹¶ç»™å‡ºä¸‹é¢å¾ˆé•¿çš„å‡ºé”™æ¶ˆæ¯ï¼š  </p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">error: failed <span class="keyword">to</span> push some refs <span class="keyword">to</span> <span class="string">'/path/to/repo.git'</span></span><br><span class="line">hin<span class="variable">t:</span> Updates were rejected because the tip of your current branch <span class="keyword">is</span> behind</span><br><span class="line">hin<span class="variable">t:</span> its remote counterpart. Merge the remote <span class="keyword">changes</span>(<span class="keyword">e</span>.g. <span class="string">'git pull'</span>)</span><br><span class="line">hin<span class="variable">t:</span> before pushing again.</span><br><span class="line">hin<span class="variable">t:</span> See the <span class="string">'Note about fast-forwards'</span> in <span class="string">'git push --help'</span> <span class="keyword">for</span> details.</span><br><span class="line">....</span><br></pre></td></tr></table></figure><p>è¿™é¿å…äº†å°çº¢è¦†å†™æ­£å¼çš„æäº¤ã€‚  </p><p>å¥¹è¦å…ˆpullå°æ˜çš„æ›´æ–°åˆ°å¥¹æœ¬åœ°ä»“åº“åˆå¹¶ä¸Šå¥¹çš„æœ¬åœ°ä¿®æ”¹åï¼Œå†é‡è¯•ã€‚  </p><h5 id="å°çº¢åœ¨å°æ˜çš„æäº¤ä¹‹ä¸Šrebase"><a href="#å°çº¢åœ¨å°æ˜çš„æäº¤ä¹‹ä¸Šrebase" class="headerlink" title="å°çº¢åœ¨å°æ˜çš„æäº¤ä¹‹ä¸Šrebase"></a>å°çº¢åœ¨å°æ˜çš„æäº¤ä¹‹ä¸Šrebase</h5><p>å°çº¢ç”¨git pull åˆå¹¶ä¸Šæ¸¸çš„ä¿®æ”¹åˆ°è‡ªå·±çš„ä»“åº“ä¸­ã€‚  </p><p>è¿™æ¡å‘½ä»¤ç±»ä¼¼svn update â€”â€”-æ‹‰å–æ‰€æœ‰ä¸Šæ¸¸æäº¤å‘½ä»¤åˆ°å°çº¢çš„æœ¬åœ°ä»“åº“ï¼Œå¹¶å°è¯•å’Œå¥¹æœ¬åœ°ä¿®æ”¹åˆå¹¶ã€‚  </p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull <span class="comment">--rebase origin master</span></span><br></pre></td></tr></table></figure><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANXyi6Y8l5sb1aRwQRlb0CiRDNdgM9NZtfk5D41PvfJEccriZP3FT6WnQ4PWKvEqz*e7LpBOfcXui.l9nUXAPUgd4!/r" alt="images"></p><p>â€“rebase é€‰é¡¹å‘Šè¯‰GitæŠŠå°çº¢çš„æäº¤ç§»åˆ°åŒæ­¥äº†ä¸­å¤®ä»“åº“ä¿®æ”¹åçš„masteråˆ†æ”¯çš„é¡¶éƒ¨ï¼›  </p><p>å¦‚æœå¿˜äº†åŠ è¿™ä¸ªé€‰é¡¹ï¼Œpullæ“ä½œä»ç„¶å¯ä»¥å®Œæˆï¼Œä½†æ¯æ¬¡pullæ“ä½œè¦åŒæ­¥ä¸­å¤®ä»“åº“åˆ«äººä¿®æ”¹æ—¶ï¼Œæäº¤å†å²ä¼šä»¥ä¸€ä¸ªå¤šä½™çš„ã€åˆå¹¶æäº¤ã€‘ç»“å°¾ã€‚  </p><p>å¯¹äºé›†ä¸­å¼å·¥ä½œæµï¼Œæœ€å¥½æ˜¯ä½¿ç”¨rebaseè€Œä¸æ˜¯ç”Ÿæˆä¸€ä¸ªåˆå¹¶æäº¤ã€‚  </p><h5 id="å°çº¢è§£å†³åˆå¹¶å†²çª"><a href="#å°çº¢è§£å†³åˆå¹¶å†²çª" class="headerlink" title="å°çº¢è§£å†³åˆå¹¶å†²çª"></a>å°çº¢è§£å†³åˆå¹¶å†²çª</h5><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANX7FxPBYYYsKKPOWXqC*0rCPhZKJRqU86pJwCJIVi3g31ZcpHEH2b76upvPK6lrEAQ9UWa9VqeFjlEC4dX2PAHTw!/r" alt="å°çº¢è§£å†³åˆå¹¶å†²çª"></p><p>rebaseæ“ä½œè¿‡ç¨‹æ˜¯æŠŠæœ¬åœ°æäº¤ä¸€æ¬¡ä¸€ä¸ªåœ°è¿ç§»åˆ°æ›´æ–°äº†çš„ä¸­å¤®ä»“åº“masteråˆ†æ”¯ä¹‹ä¸Šï¼Œè¿™æ„å‘³ç€å¯èƒ½è¦è§£å†³åœ¨è¿ç§»æŸä¸ªæäº¤æ—¶å‡ºç°çš„åˆå¹¶å†²çªï¼Œè€Œä¸æ˜¯è§£å†³åŒ…å«äº†æ‰€æœ‰æäº¤çš„å¤§å‹åˆå¹¶æ—¶æ‰€å‡ºç°çš„å†²çªã€‚  </p><p>è¿™æ ·çš„æ–¹å¼è®©ä½ å°½å¯èƒ½ä¿æŒæ¯ä¸ªæäº¤çš„èšç„¦å’Œé¡¹ç›®å†å²çš„æ•´æ´ã€‚  </p><p>åè¿‡æ¥ï¼Œç®€åŒ–äº†å“ªé‡Œå¼•å…¥Bugçš„åˆ†æï¼Œå¦‚æœæœ‰å¿…è¦ï¼Œå›æ»šä¿®æ”¹ä¹Ÿå¯ä»¥åšåˆ°å¯¹é¡¹ç›®å½±å“æœ€å°ã€‚  </p><p>å¦‚æœå°çº¢å’Œå°æ˜çš„åŠŸèƒ½æ˜¯ç›¸å…³çš„ï¼Œä¸å¤§å¯èƒ½åœ¨rebaseè¿‡ç¨‹ä¸­æœ‰å†²çªã€‚  </p><p>å¦‚æœæœ‰ï¼ŒGitåœ¨åˆå¹¶æœ‰å†²çªçš„æäº¤å‡ºæš‚åœrebaseè¿‡ç¨‹ï¼Œè¾“å‡ºä¸‹é¢çš„ä¿¡æ¯å¹¶å¸¦ä¸Šç›¸å…³çš„æŒ‡ä»¤ï¼š  </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CONFLICT</span> (content): Merge <span class="keyword">conflict</span> <span class="keyword">in</span></span><br></pre></td></tr></table></figure><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANX5fiCqpawh2bvFoyuusAOSGHKu5sc59EGgvKP1aVmHVmey3BEhEwMSvuvtOXh1oSZU1zNvf5QV2G*SN2a1sgwiA!/r" alt="images"></p><p>Git å¾ˆèµçš„ä¸€ç‚¹æ˜¯ï¼Œä»»ä½•äººå¯ä»¥è§£å†³ä»–è‡ªå·±çš„å†²çªã€‚  </p><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå°çº¢å¯ä»¥ç®€å•çš„è¿è¡Œ git status å‘½ä»¤æ¥æŸ¥çœ‹å“ªé‡Œæœ‰é—®é¢˜ã€‚  </p><p>å†²çªæ–‡ä»¶åˆ—åœ¨ Unmerged pathsï¼ˆæœªåˆå¹¶è·¯å¾„ï¼‰ä¸€èŠ‚ä¸­ï¼š  </p><figure class="highlight leaf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Unmerged pathsï¼š</span><br><span class="line"><span class="function"><span class="keyword">#</span><span class="params">(<span class="variable">use</span> <span class="string">"git reset HEAD &lt;some-file&gt;..."</span> <span class="variable">to</span> <span class="variable">unstage</span>)</span></span></span><br><span class="line"><span class="function"><span class="keyword">#</span><span class="params">(<span class="variable">use</span> <span class="string">"git add/rm &lt;some-file&gt;..."</span> <span class="variable">as</span> <span class="variable">appropriate</span> <span class="variable">to</span> <span class="variable">mark</span> <span class="variable">resolution</span>)</span></span></span><br><span class="line">#</span><br><span class="line"># both modified:&lt;some-file&gt;</span><br></pre></td></tr></table></figure><p>æ¥ç€å°çº¢ç¼–è¾‘è¿™äº›æ–‡ä»¶ã€‚  </p><p>ä¿®æ”¹å®Œæˆåï¼Œç”¨è€å¥—è·¯æš‚å­˜è¿™äº›æ–‡ä»¶ï¼Œå¹¶è®©git rebase å®Œæˆå‰©ä¸‹çš„äº‹æƒ…ï¼š  </p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">add</span></span><br><span class="line"><span class="bash">git rebase --<span class="built_in">continue</span></span></span><br></pre></td></tr></table></figure><p>è¦åšçš„å°±è¿™äº›äº†ã€‚  </p><p>Gitä¼šç»§ç»­ä¸€ä¸ªä¸€ä¸ªçš„åˆå¹¶åé¢çš„æäº¤ï¼Œå¦‚å…¶ä»–çš„æäº¤æœ‰å†²çªå°±é‡å¤è¿™ä¸ªè¿‡ç¨‹ã€‚  </p><p>å¦‚æœä½ ç¢°åˆ°äº†å†²çªï¼Œä½†æ˜¯å‘ç°æä¸å®šï¼Œä¸è¦æƒŠæ…Œã€‚  </p><p>åªè¦æ‰§è¡Œä¸‹é¢è¿™æ¡å‘½ä»¤ï¼Œå°±å¯ä»¥å›åˆ°ä½ æ‰§è¡Œgit pull â€“rebaseå‘½ä»¤å‰çš„æ ·å­ï¼š  </p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rebase <span class="comment">--abort</span></span><br></pre></td></tr></table></figure><h5 id="å°çº¢æˆåŠŸå‘å¸ƒåŠŸèƒ½"><a href="#å°çº¢æˆåŠŸå‘å¸ƒåŠŸèƒ½" class="headerlink" title="å°çº¢æˆåŠŸå‘å¸ƒåŠŸèƒ½"></a>å°çº¢æˆåŠŸå‘å¸ƒåŠŸèƒ½</h5><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANX0kBnWeNL8ejRYU6ro4.2u6jfdf4WmDKrAtmoAnmJ9TQ4sDBTQl0i3xlqRsJMoYZns72c0lo3zm5ObKWH4CoUG0!/r" alt="å°çº¢æˆåŠŸå‘å¸ƒåŠŸèƒ½"></p><p>å°çº¢å®Œæˆå’Œä¸­å¤®ä»“åº“çš„åŒæ­¥ä¹‹åï¼Œå°±èƒ½æˆåŠŸå‘å¸ƒå¥¹çš„ä¿®æ”¹äº†ã€‚  </p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">push</span> <span class="built_in">origin</span> master</span><br></pre></td></tr></table></figure><h5 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h5><p>å¦‚ä½ æ‰€è§ï¼Œä»…ä»…ä½¿ç”¨å‡ ä¸ªGitå‘½ä»¤ï¼Œå°±å¯ä»¥æ¨¡æ‹Ÿå‡ºä¼ ç»ŸSubversionå¼€å‘ç¯å¢ƒã€‚  </p><p>å¯¹äºè¦ä»SVNè¿ç§»è¿‡æ¥çš„å›¢é˜Ÿæ¥è¯´è¿™å¤ªå¥½äº†ï¼Œä½†æ˜¯æ²¡æœ‰å‘æŒ¥å‡ºGitåˆ†å¸ƒå¼æœ¬è´¨çš„ä¼˜åŠ¿ã€‚  </p><p>å¦‚æœä½ çš„å›¢é˜Ÿé€‚åº”äº†é›†ä¸­å¼å·¥ä½œæµï¼Œä½†æƒ³è¦æ›´æµç•…çš„åä½œæ•ˆæœï¼Œç»å¯¹å€¼å¾—æ¢ç´¢ä¸€ä¸‹åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµçš„æ”¶ç›Šã€‚  </p><p>é€šè¿‡ä¸ºä¸€ä¸ªåŠŸèƒ½åˆ†é…ä¸€ä¸ªä¸“é—¨çš„åˆ†æ”¯ï¼Œèƒ½å¤Ÿåšåˆ°ä¸€ä¸ªæ–°å¢åŠŸèƒ½é›†æˆåˆ°æ­£å¼é¡¹ç›®ä¹‹å‰å¯¹æ–°åŠŸèƒ½è¿›è¡Œæ·±å…¥è®¨è®ºã€‚  </p><h3 id="åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµ-1"><a href="#åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµ-1" class="headerlink" title="åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµ"></a>åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµ</h3><p>ä¸€æ—¦ç©è½¬äº†é›†ä¸­å¼å·¥ä½œæµï¼Œåœ¨å¼€å‘è¿‡ç¨‹ä¸­å¯ä»¥å¾ˆç®€å•åœ°åŠ ä¸ŠåŠŸèƒ½åˆ†æ”¯ï¼Œç”¨æ¥é¼“åŠ±å¼€å‘è€…ä¹‹é—´åä½œå’Œç®€åŒ–äº¤æµã€‚  </p><p>åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµèƒŒåçš„æ ¸å¿ƒæ€è·¯æ˜¯æ‰€æœ‰çš„åŠŸèƒ½å¼€å‘åº”è¯¥åœ¨ä¸€ä¸ªä¸“é—¨çš„åˆ†æ”¯ï¼Œè€Œä¸æ˜¯åœ¨masteråˆ†æ”¯ä¸Šã€‚  </p><p>è¿™ä¸ªéš”ç¦»å¯ä»¥æ–¹ä¾¿å¤šä¸ªå¼€å‘è€…åœ¨å„è‡ªçš„åŠŸèƒ½ä¸Šå¼€å‘è€Œä¸ä¼šå¼„ä¹±ä¸»å¹²ä»£ç ã€‚  </p><p>å¦å¤–ï¼Œä¹Ÿä¿è¯äº†masteråˆ†æ”¯çš„ä»£ç ä¸€å®šä¸ä¼šæ˜¯æœ‰é—®é¢˜çš„ï¼Œæå¤§æœ‰åˆ©äºé›†æˆç¯å¢ƒã€‚  </p><p>åŠŸèƒ½å¼€å‘éš”ç¦»ä¹Ÿè®©pull  requestså·¥ä½œæµæˆä¸ºå¯èƒ½ï¼Œ pull requestså·¥ä½œæµèƒ½ä¸ºæ¯ä¸€ä¸ªåˆ†æ”¯å‘èµ·ä¸€ä¸ªè®¨è®ºï¼Œåœ¨åˆ†æ”¯åˆå…¥æ­£å¼é¡¹ç›®ä¹‹å‰ï¼Œç»™å…¶å®ƒå¼€å‘è€…æœ‰è¡¨ç¤ºèµåŒçš„æœºä¼šã€‚  </p><p>å¦å¤–ï¼Œå¦‚æœä½ åœ¨åŠŸèƒ½å¼€å‘ä¸­æœ‰é—®é¢˜å¡å‡ºäº†ï¼Œå¯ä»¥å¼€ä¸€ä¸ªpull Requestsæ¥å‘åŒå­¦ä»¬å¾æ±‚å»ºè®®ã€‚  </p><p>è¿™äº›åšæ³•çš„é‡ç‚¹å°±æ˜¯ï¼Œpull Requestsè®©å›¢é˜Ÿæˆå‘˜ä¹‹é—´äº’ç›¸è¯„è®ºå·¥ä½œå˜æˆéå¸¸æ–¹ä¾¿ï¼  </p><h4 id="å·¥ä½œæ–¹å¼-1"><a href="#å·¥ä½œæ–¹å¼-1" class="headerlink" title="å·¥ä½œæ–¹å¼"></a>å·¥ä½œæ–¹å¼</h4><p>åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµä»ç„¶ç”¨ä¸­å¤®ä»“åº“ï¼Œå¹¶ä¸”masteråˆ†æ”¯è¿˜æ˜¯ä»£è¡¨äº†æ­£å¼é¡¹ç›®çš„å†å²ã€‚  </p><p>ä½†ä¸æ˜¯ç›´æ¥æäº¤æœ¬åœ°å†å²åˆ°å„è‡ªçš„æœ¬åœ°masteråˆ†æ”¯ï¼Œå¼€å‘è€…æ¯æ¬¡åœ¨å¼€å§‹æ–°åŠŸèƒ½å‰å…ˆåˆ›å»ºä¸€ä¸ªæ–°åˆ†æ”¯ã€‚  </p><p>åŠŸèƒ½åˆ†æ”¯åº”è¯¥æœ‰ä¸ªæè¿°æ€§çš„åå­—ï¼Œæ¯”å¦‚ animated-menu-items æˆ–è€…  issue-#1061ï¼Œè¿™æ ·å¯ä»¥è®©åˆ†æ”¯æœ‰ä¸ªæ¸…æ¥šä¸”é«˜èšç„¦çš„ç”¨é€”ã€‚  </p><p>åœ¨masteråˆ†æ”¯å’ŒåŠŸèƒ½åˆ†æ”¯ä¹‹é—´ï¼ŒGitæ˜¯æ²¡æœ‰æŠ€æœ¯ä¸Šçš„åŒºåˆ«ï¼Œæ‰€ä»¥å¼€å‘è€…å¯ä»¥ç”¨å’Œé›†ä¸­å¼å·¥ä½œæµå®Œå…¨ä¸€æ ·çš„æ–¹å¼ç¼–è¾‘ã€æš‚å­˜å’Œæäº¤ä¿®æ”¹åˆ°åŠŸèƒ½åˆ†æ”¯ä¸Šã€‚  </p><p>å¦å¤–ï¼ŒåŠŸèƒ½åˆ†æ”¯ä¹Ÿå¯ä»¥ï¼ˆä¸”åº”è¯¥ï¼‰pushåˆ°ä¸­å¤®ä»“åº“ä¸­ã€‚  </p><p>è¿™æ ·ä¸ä¿®æ”¹æ­£æ˜¯ä»£ç å°±å¯ä»¥å’Œå…¶ä»–å¼€å‘è€…åˆ†äº«æäº¤çš„åŠŸèƒ½ã€‚  </p><p>ç”±äºmasterä»…æœ‰çš„ä¸€ä¸ªã€ç‰¹æ®Šã€‘åˆ†æ”¯ï¼Œåœ¨ä¸­å¤®ä»“åº“ä¸Šå­˜åœ¨å¤šä¸ªåŠŸèƒ½åˆ†æ”¯ä¸ä¼šæœ‰ä»»ä½•é—®é¢˜ã€‚  </p><p>å½“ç„¶è¿™æ ·åšä¹Ÿå¯ä»¥å¾ˆæ–¹ä¾¿åœ°å¤‡ä»½å„è‡ªçš„æœ¬åœ°æäº¤ã€‚  </p><h4 id="Pull-Requests-1"><a href="#Pull-Requests-1" class="headerlink" title="Pull Requests"></a>Pull Requests</h4><p>åŠŸèƒ½åˆ†æ”¯é™¤äº†å¯ä»¥éš”ç¦»åŠŸèƒ½çš„å¼€å‘ï¼Œä¹Ÿä½¿å¾—é€šè¿‡ Pull Requestsè®¨è®ºå˜æ›´ç§°ä¸ºå¯èƒ½ã€‚  </p><p>ä¸€æ—¦æŸä¸ªå¼€å‘å®Œæˆä¸€ä¸ªåŠŸèƒ½ï¼Œä¸æ˜¯ç«‹å³åˆå¹¶åˆ°masterï¼Œè€Œæ˜¯pushåˆ°ä¸­å¤®ä»“åº“çš„åŠŸèƒ½åˆ†æ”¯ä¸Šå¹¶å‘èµ·ä¸€ä¸ªPull Requestsçš„è¯·æ±‚å»åˆå¹¶å¹¶ä¿®æ”¹åˆ°masterã€‚  </p><p>åœ¨ä¿®æ”¹æˆä¸ºä¸»å¹²ä»£ç ä¹‹å‰ï¼Œè¿™è®©å…¶ä»–çš„å¼€å‘è€…æœ‰æœºä¼šå…ˆå»Reviewå˜æ›´ã€‚  </p><p>Code Reviewæ˜¯Pull Requestsçš„ä¸€ä¸ªé‡è¦çš„æ”¶ç›Šã€‚  </p><p>ä½†æ˜¯pull Requestsç›®çš„æ˜¯è®¨è®ºä»£ç ä¸€ä¸ªé€šç”¨æ–¹å¼ã€‚  </p><p>ä½ å¯ä»¥æŠŠPull  Requestsä½œä¸ºä¸“é—¨ç»™æŸä¸ªåˆ†æ”¯çš„è®¨è®ºã€‚  </p><p>è¿™æ„å‘³ç€å¯ä»¥åœ¨æ›´æ—©çš„å¼€å‘è¿‡ç¨‹ä¸­å°±å¯ä»¥è¿›è¡ŒCode Reviewã€‚  </p><p>æ¯”å¦‚ï¼Œä¸€ä¸ªå¼€å‘è€…å¼€å‘åŠŸèƒ½éœ€è¦å¸®åŠ©æ—¶ï¼Œè¦åšçš„å°±æ˜¯å‘èµ·ä¸€ä¸ªPull Requestsï¼Œç›¸å…³çš„äººå°±ä¼šè‡ªåŠ¨æ”¶åˆ°é€šçŸ¥ï¼Œåœ¨ç›¸å…³çš„æäº¤æ—è¾¹èƒ½çœ‹åˆ°éœ€è¦å¸®åŠ©è§£å†³çš„é—®é¢˜ã€‚  </p><p>ä¸€æ—¦Pull  Requestsè¢«æ¥å—äº†ï¼Œå‘å¸ƒåŠŸèƒ½è¦åšçš„å°±å’Œé›†ä¸­å¼å·¥ä½œæµå°±å¾ˆåƒäº†ã€‚  </p><p>ï¼ˆ1ï¼‰é¦–å…ˆï¼Œç¡®å®šæœ¬åœ°çš„masteråˆ†æ”¯å’Œä¸Šæ¸¸çš„masteråˆ†æ”¯æ˜¯åŒæ­¥çš„ã€‚  </p><p>ï¼ˆ2ï¼‰ç„¶ååˆå¹¶åŠŸèƒ½åˆ†æ”¯åˆ°æœ¬åœ°masteråˆ†æ”¯ï¼Œå¹¶pushå·²ç»æ›´æ–°çš„æœ¬åœ°masteråˆ†æ”¯åˆ°ä¸­å¤®ä»“åº“ã€‚</p><h4 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><p>ä¸‹é¢çš„ç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•æŠŠPull Requestsä½œä¸ºCode Reviewçš„æ–¹å¼ï¼Œä½†æ³¨æ„Pull Requestså¯ä»¥ç”¨äºå¾ˆå¤šå…¶ä»–çš„ç›®çš„ã€‚  </p><h5 id="å°çº¢å¼€å§‹å¼€å‘ä¸€ä¸ªæ–°åŠŸèƒ½"><a href="#å°çº¢å¼€å§‹å¼€å‘ä¸€ä¸ªæ–°åŠŸèƒ½" class="headerlink" title="å°çº¢å¼€å§‹å¼€å‘ä¸€ä¸ªæ–°åŠŸèƒ½"></a>å°çº¢å¼€å§‹å¼€å‘ä¸€ä¸ªæ–°åŠŸèƒ½</h5><p>åœ¨å¼€å§‹å¼€å‘åŠŸèƒ½ä¹‹å‰ï¼Œå°çº¢éœ€è¦ä¸€ä¸ªç‹¬ç«‹çš„åˆ†æ”¯ã€‚  </p><p>ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ–°å»ºä¸€ä¸ªåˆ†æ”¯ã€‚  </p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">git</span> checkout -<span class="keyword">b </span><span class="keyword">marys-feature </span>master</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå‘½ä»¤æ£€å‡ºä¸€ä¸ªåŸºäºmasteråä¸ºmarys-featureçš„åˆ†æ”¯ï¼ŒGitçš„-bé€‰é¡¹è¡¨ç¤ºå¦‚æœåˆ†æ”¯è¿˜ä¸å­˜åœ¨åˆ™æ–°å»ºåˆ†æ”¯ã€‚  </p><p>è¿™ä¸ªæ–°åˆ†æ”¯ä¸Šï¼Œå°çº¢æŒ‰ç…§è€å¥—è·¯ç¼–è¾‘ã€æš‚å­˜å’Œæäº¤ä¿®æ”¹ï¼ŒæŒ‰éœ€è¦æäº¤ä»¥å®ç°åŠŸèƒ½ï¼š  </p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">git</span>  <span class="string">status</span></span><br><span class="line"><span class="attr">git</span> <span class="string">add</span></span><br><span class="line"><span class="attr">git</span> <span class="string">commit</span></span><br></pre></td></tr></table></figure><h5 id="å°çº¢è¦å»åƒä¸ªåˆé¥­"><a href="#å°çº¢è¦å»åƒä¸ªåˆé¥­" class="headerlink" title="å°çº¢è¦å»åƒä¸ªåˆé¥­"></a>å°çº¢è¦å»åƒä¸ªåˆé¥­</h5><p>ï¼ˆä¸¤ä¸ªäººã€å¤šä¸ªäººåŒæ—¶å¼€å‘ï¼Œç§°ä¹‹ä¸ºååŒå¼€å‘ï¼‰  </p><p>ä»“åº“ï¼šgithubã€ç äº‘ã€ç å¸‚ã€gitlab  </p><p>review ä»£ç å®¡æ ¸ï¼›  </p><p>æ—©ä¸Šå°çº¢ä¸ºæ–°åŠŸèƒ½æ·»åŠ äº†ä¸€äº›æäº¤ã€‚  </p><p>å»åƒåˆé¥­å‰ï¼ŒpushåŠŸèƒ½åˆ†æ”¯åˆ°ä¸­å¤®ä»“åº“æ˜¯å¾ˆå¥½çš„åšæ³•ï¼Œè¿™æ ·å¯ä»¥æ–¹ä¾¿åœ°å¤‡ä»½ï¼Œå¦‚æœå’Œå…¶ä»–å¼€å‘åä½œï¼Œä¹Ÿè®©ä»–ä»¬å¯ä»¥çœ‹åˆ°å°çº¢çš„æäº¤ã€‚  </p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">push</span> -u <span class="built_in">origin</span> marys-<span class="built_in">feature</span></span><br></pre></td></tr></table></figure><p>è¿™æ¡å‘½ä»¤  push marys-feature åˆ†æ”¯åˆ°ä¸­å¤®ä»“åº“ï¼ˆoriginï¼‰ï¼Œ-ué€‰é¡¹è®¾ç½®æœ¬åœ°åˆ†æ”¯å»è·Ÿè¸ªè¿œç¨‹å¯¹åº”çš„åˆ†æ”¯ã€‚  </p><p>è®¾ç½®å¥½è·Ÿè¸ªçš„åˆ†æ”¯åï¼Œå°çº¢å°±å¯ä»¥ä½¿ç”¨git push å‘½ä»¤çœå»æŒ‡å®šæ¨é€åˆ†æ”¯çš„å‚æ•°ã€‚  </p><h5 id="å°çº¢å®ŒæˆåŠŸèƒ½å¼€å‘"><a href="#å°çº¢å®ŒæˆåŠŸèƒ½å¼€å‘" class="headerlink" title="å°çº¢å®ŒæˆåŠŸèƒ½å¼€å‘"></a>å°çº¢å®ŒæˆåŠŸèƒ½å¼€å‘</h5><p>å°çº¢åƒå®Œåˆé¥­å›æ¥ï¼Œå®Œæˆæ•´ä¸ªåŠŸèƒ½çš„å¼€å‘ã€‚  </p><p>åœ¨åˆå¹¶åˆ°masterä¹‹å‰ï¼Œå¥¹å‘èµ·ä¸€ä¸ªPull Requestsè®©å›¢é˜Ÿçš„å…¶ä»–äººçŸ¥é“åŠŸèƒ½å·²ç»å®Œæˆã€‚  </p><p>ä½†æ˜¯é¦–å…ˆï¼Œå¥¹è¦ç¡®è®¤ä¸­å¤®ä»“åº“ä¸­å·²ç»æœ‰å¥¹æœ€è¿‘çš„æäº¤ã€‚  </p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">push</span></span><br></pre></td></tr></table></figure><p>ç„¶åï¼Œåœ¨å¥¹çš„Git GUIå®¢æˆ·ç«¯ä¸­å‘èµ·Pull Requestï¼Œè¯·æ±‚åˆå¹¶marys-featureåˆ°masterï¼Œå›¢é˜Ÿæˆå‘˜ä¼šè‡ªåŠ¨æ”¶åˆ°é€šçŸ¥ã€‚  </p><p>Pull Requestå¾ˆé…·çš„æ˜¯å¯ä»¥åœ¨ç›¸å…³çš„æäº¤æ—è¾¹æ˜¾ç¤ºè¯„æ³¨ï¼Œæ‰€ä»¥ä½ å¯ä»¥å¾ˆå¯¹æŸä¸ªå˜æ›´é›†æé—®ã€‚  </p><h5 id="å°é»‘æ”¶åˆ°Pull-Request"><a href="#å°é»‘æ”¶åˆ°Pull-Request" class="headerlink" title="å°é»‘æ”¶åˆ°Pull  Request"></a>å°é»‘æ”¶åˆ°Pull  Request</h5><p>å°é»‘æ”¶åˆ°Pull Requeståä¼šæŸ¥çœ‹marys-featureçš„ä¿®æ”¹ã€‚  </p><p>å†³å®šåœ¨åˆå¹¶åˆ°æ­£å¼é¡¹ç›®å‰æ˜¯å¦è¦åšäº›ä¿®æ”¹ï¼Œä¸”é€šè¿‡Pull Requestå’Œå°çº¢æ¥å›çš„è®¨è®ºã€‚  </p><h5 id="å°çº¢å†åšä¿®æ”¹"><a href="#å°çº¢å†åšä¿®æ”¹" class="headerlink" title="å°çº¢å†åšä¿®æ”¹"></a>å°çº¢å†åšä¿®æ”¹</h5><p>è¦åœ¨åšä¿®æ”¹ï¼Œå°çº¢ç”¨å’ŒåŠŸèƒ½ç¬¬ä¸€ä¸ªè¿­ä»£å®Œå…¨ä¸€æ ·çš„è¿‡ç¨‹ã€‚  </p><p>ç¼–è¾‘ã€æš‚å­˜ã€æäº¤å¹¶pushæ›´æ–°åˆ°ä¸­å¤®ä»“åº“ã€‚  </p><p>å°çº¢è¿™äº›æ´»åŠ¨éƒ½ä¼šæ˜¾ç¤ºåœ¨Pull Requestä¸Šï¼Œå°é»‘å¯ä»¥æ–­ç»­åšè¯„æ³¨ã€‚  </p><p>å¦‚æœå°é»‘æœ‰éœ€è¦ï¼Œä¹Ÿå¯ä»¥æŠŠmarys-featureåˆ†æ”¯æ‹‰åˆ°æœ¬åœ°ï¼Œè‡ªå·±æ¥ä¿®æ”¹ï¼Œä»–åŠ çš„æäº¤ä¹Ÿä¼šä¸€æ ·æ˜¾ç¤ºåœ¨Pull Requestä¸Šã€‚  </p><h5 id="å°çº¢å‘å¸ƒå¥¹çš„åŠŸèƒ½"><a href="#å°çº¢å‘å¸ƒå¥¹çš„åŠŸèƒ½" class="headerlink" title="å°çº¢å‘å¸ƒå¥¹çš„åŠŸèƒ½"></a>å°çº¢å‘å¸ƒå¥¹çš„åŠŸèƒ½</h5><p>ä¸€æ—¦å°é»‘å¯ä»¥æ¥å—Pull Requestï¼Œå°±å¯ä»¥åˆå¹¶åŠŸèƒ½åˆ°ç¨³å®šé¡¹ç›®ä»£ç ä¸­ï¼ˆå¯ä»¥ç”±å°é»‘æˆ–è€…æ˜¯å°çº¢æ¥åšè¿™ä¸ªæ“ä½œï¼‰ï¼š  </p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">git</span> <span class="string">checkout master</span></span><br><span class="line"><span class="attr">git</span> <span class="string">pull</span></span><br><span class="line"><span class="attr">git</span> <span class="string">pull origin marys-feature</span></span><br><span class="line"><span class="attr">git</span> <span class="string">push</span></span><br></pre></td></tr></table></figure><p>æ— è®ºè°æ¥åšåˆå¹¶ï¼Œé¦–å…ˆè¦æ£€å‡ºmasteråˆ†æ”¯å¹¶ç¡®è®¤å®ƒæ˜¯æœ€æ–°çš„ã€‚  </p><p>ç„¶åæ‰§è¡Œ git pull origin marys-feature åˆå¹¶ marys-feature åˆ†æ”¯åˆ°å·²ç»å’Œè¿œç¨‹ä¸€ç›´çš„æœ¬åœ° masteråˆ†æ”¯ã€‚  </p><p>ä½ å¯ä»¥ä½¿ç”¨ç®€å• git merge marys-featureå‘½ä»¤ï¼Œä½†æ˜¯å‰é¢çš„å‘½ä»¤å¯ä»¥ä¿è¯æ€»æ˜¯æœ€æ–°çš„æ–°åŠŸèƒ½åˆ†æ”¯ã€‚  </p><p>æœ€åæ›´æ–°çš„masteråˆ†æ”¯è¦é‡æ–°pushå›åˆ°originã€‚  </p><p>è¿™ä¸ªè¿‡ç¨‹å¸¸å¸¸ä¼šç”Ÿæˆä¸€ä¸ªå’Œå¹¶æäº¤ã€‚  </p><p>æœ‰äº›å¼€å‘è€…å–œæ¬¢æœ‰åˆå¹¶æäº¤ã€‚  </p><p>å› ä¸ºå®ƒåƒä¸€ä¸ªæ–°åŠŸèƒ½å’ŒåŸæ¥ä»£ç åŸºçº¿çš„è¿é€šç¬¦ã€‚  </p><p>ä½†å¦‚æœä½ åçˆ±çº¿æ€§çš„æäº¤å†å²ï¼Œå¯ä»¥åœ¨æ‰§è¡Œåˆå¹¶rebaseæ–°åŠŸèƒ½åˆ°masteråˆ†æ”¯çš„é¡¶éƒ¨ï¼Œè¿™æ ·ç”Ÿæˆä¸€ä¸ªå¿«è¿›ï¼ˆfast-forwardï¼‰çš„åˆå¹¶ã€‚  </p><p>ä¸€äº›GUIå®¢æˆ·ç«¯åªè¦ç‚¹ä¸€ä¸‹ã€æ¥å—ã€‘æŒ‰é’®æ‰§è¡Œå¥½ä¸Šé¢çš„å‘½ä»¤æ¥è‡ªåŠ¨åŒ–Pull Requestæ¥å—è¿‡ç¨‹ã€‚  </p><p>å¦‚æœä½ çš„ä¸èƒ½è¿™æ ·ï¼Œè‡³å°‘åœ¨åŠŸèƒ½åˆå¹¶åˆ°masteråˆ†å­åè‡ªåŠ¨å…³é—­Pull Requestã€‚  </p><h5 id="ä¸æ­¤åŒæ—¶ï¼Œå°æ˜åœ¨åšå’Œå°çº¢ä¸€æ ·çš„äº‹æƒ…"><a href="#ä¸æ­¤åŒæ—¶ï¼Œå°æ˜åœ¨åšå’Œå°çº¢ä¸€æ ·çš„äº‹æƒ…" class="headerlink" title="ä¸æ­¤åŒæ—¶ï¼Œå°æ˜åœ¨åšå’Œå°çº¢ä¸€æ ·çš„äº‹æƒ…"></a>ä¸æ­¤åŒæ—¶ï¼Œå°æ˜åœ¨åšå’Œå°çº¢ä¸€æ ·çš„äº‹æƒ…</h5><p>å½“å°çº¢å’Œå°é»‘åœ¨marys-featureä¸Šå·¥ä½œå¹¶è®¨è®ºå¥¹çš„Pull  Requestçš„æ—¶å€™ï¼Œå°æ˜åœ¨è‡ªå·±çš„åŠŸèƒ½åˆ†æ”¯ä¸Šåšå®Œå…¨ä¸€æ ·çš„äº‹æƒ…ã€‚  </p><p>é€šè¿‡éš”ç¦»åŠŸèƒ½èƒ½åˆ°ç‹¬ç«‹çš„åˆ†æ”¯ä¸Šï¼Œæ¯ä¸ªäººéƒ½å¯ä»¥è‡ªä¸»çš„å·¥ä½œï¼Œå½“ç„¶å¿…è¦çš„æ—¶å€™åœ¨å¼€å‘è€…ä¹‹é—´åˆ†äº«å˜æ›´è¿˜æ˜¯æ¯”è¾ƒç¹ççš„ã€‚  </p><h4 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>åˆ°äº†è¿™é‡Œï¼Œä½†æ„¿ä½ å‘ç°äº†åŠŸèƒ½åˆ†æ”¯å¯ä»¥å¾ˆç›´æ¥åœ°åœ¨é›†ä¸­å¼å·¥ä½œæµçš„ä»…æœ‰çš„masteråˆ†æ”¯ä¸Šå®Œæˆå¤šåŠŸèƒ½çš„å¼€å‘ã€‚  </p><p>å¦å¤–ï¼ŒåŠŸèƒ½åˆ†æ”¯è¿˜ä½¿ç”¨äº†Pull Requestï¼Œä½¿å¾—å¯ä»¥åœ¨ä½ çš„ç‰ˆæœ¬æ§åˆ¶GUIå®¢æˆ·ç«¯ä¸­è®¨è®ºæŸä¸ªæäº¤ã€‚  </p><p>åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµæ˜¯å¼€å‘é¡¹ç›®å¼‚å¸¸çµæ´»çš„æ–¹å¼ã€‚  </p><p>é—®é¢˜æ˜¯ï¼Œæœ‰æ—¶å€™å¤ªçµæ´»äº†ã€‚  </p><p>å¯¹äºå¤§å‹å›¢é˜Ÿï¼Œå¸¸å¸¸éœ€è¦ç»™ä¸åŒåˆ†æ”¯åˆ†é…ä¸€ä¸ªæ›´å…·ä½“çš„è§’è‰²ã€‚  </p><p>GitFlowå·¥ä½œæµæ˜¯ç®¡ç†åŠŸèƒ½å¼€å‘ã€å‘å¸ƒå‡†å¤‡å’Œç»´æŠ¤çš„å¸¸ç”¨æ¨¡å¼ã€‚  </p><h3 id="GitFlowå·¥ä½œæµ"><a href="#GitFlowå·¥ä½œæµ" class="headerlink" title="GitFlowå·¥ä½œæµ"></a>GitFlowå·¥ä½œæµ</h3><p>åœ¨å®é™…å¼€å‘å½“ä¸­ï¼Œå¯èƒ½é€šå¸¸ä½¿ç”¨GitFlowå·¥ä½œæµã€‚  </p><p>GitFlowå·¥ä½œæµå®šä¹‰äº†ä¸€ä¸ªå›´ç»•é¡¹ç›®å‘å¸ƒçš„ä¸¥æ ¼åˆ†æ”¯æ¨¡å‹ã€‚  </p><p>è™½ç„¶æ¯”åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµå¤æ‚å‡ åˆ†ï¼Œä½†æ˜¯æä¾›äº†ä¸€ä¸ªç”¨äºå¥å£®çš„ç”¨äºç®¡ç†å¤§å‹é¡¹ç›®çš„æ¡†æ¶ã€‚  </p><p>GitFlowå·¥ä½œæµæ²¡æœ‰ç”¨è¶…å‡ºåŠŸèƒ½åˆ†æ”¯å·¥ä½œæµçš„æ¦‚å¿µå’Œå‘½ä»¤ã€‚  </p><p>è€Œæ˜¯ä¸ºä¸åŒçš„åˆ†æ”¯åˆ†é…äº†ä¸€ä¸ªå¾ˆæ˜ç¡®çš„è§’è‰²ï¼Œå¹¶å®šä¹‰åˆ†æ”¯ä¹‹é—´å¦‚ä½•äº¤äº’å’Œä»€ä¹ˆæ—¶å€™è¿›è¡Œäº¤äº’ã€‚  </p><p>é™¤äº†ä½¿ç”¨åŠŸèƒ½åˆ†æ”¯ï¼Œåœ¨åšå‡†å¤‡ã€ç»´æŠ¤å’Œè®°å½•å‘å¸ƒä¹Ÿæ˜¯ç”¨å„è‡ªçš„åˆ†æ”¯ã€‚  </p><p>å½“ç„¶ä½ å¯ä»¥ç”¨ä¸ŠåŠŸèƒ½åˆ†æ”¯å·¥ä½œæµæ‰€æœ‰çš„å¥½å¤„ï¼šPull Requestã€éš”ç¦»å®éªŒæ€§å¼€å‘å’Œæ›´é«˜æ•ˆçš„å·¥ä½œã€‚  </p><h4 id="å·¥ä½œæ–¹å¼-2"><a href="#å·¥ä½œæ–¹å¼-2" class="headerlink" title="å·¥ä½œæ–¹å¼"></a>å·¥ä½œæ–¹å¼</h4><p>GitFlowå·¥ä½œæµä»ç„¶ç”¨ä¸­å¤®ä»“åº“ä½œä¸ºæ‰€æœ‰å¼€å‘è€…çš„äº¤äº’ä¸­å¿ƒã€‚  </p><p>å’Œå…¶ä»–å·¥ä½œæµä¸€æ ·ï¼Œå¼€å‘è€…åœ¨æœ¬åœ°å·¥ä½œå¹¶pushåˆ†å­åˆ°ä¸­å¤®åˆ†æ”¯å»ã€‚  </p><h5 id="å†å²åˆ†æ”¯"><a href="#å†å²åˆ†æ”¯" class="headerlink" title="å†å²åˆ†æ”¯"></a>å†å²åˆ†æ”¯</h5><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANX0DucqArpSZN8V1mN.Djx7WchltIFUxePFkxo0wF6tL9hJ92GPpyK1meBHYC6jQnh92Uk6*6zENCWbjq21uqLsI!/r" alt="å†å²åˆ†æ”¯"></p><p>ç›¸å¯¹ä½¿ç”¨ä»…æœ‰çš„ä¸€ä¸ªmasteråˆ†æ”¯ï¼ŒGitFlowå·¥ä½œæµä½¿ç”¨ä¸¤ä¸ªåˆ†æ”¯æ¥è®°å½•é¡¹ç›®çš„å†å²ã€‚  </p><p>masteråˆ†æ”¯å­˜å‚¨äº†æ­£å¼å‘å¸ƒçš„å†å²ï¼Œè€Œdevelopåˆ†æ”¯ä½œä¸ºåŠŸèƒ½çš„é›†æˆåˆ†æ”¯ï¼Œè¿™æ ·ä¹Ÿæ–¹ä¾¿masteråˆ†æ”¯ä¸Šçš„æ‰€æœ‰æäº¤åˆ†é…ä¸€ä¸ªç‰ˆæœ¬å·ã€‚  </p><p>å‰©ä¸‹è¦è¯´æ˜çš„é—®é¢˜å°±æ˜¯å›´ç»•è¿™ä¸¤ä¸ªåˆ†æ”¯çš„åŒºåˆ«å±•å¼€ã€‚  </p><h5 id="åŠŸèƒ½åˆ†æ”¯"><a href="#åŠŸèƒ½åˆ†æ”¯" class="headerlink" title="åŠŸèƒ½åˆ†æ”¯"></a>åŠŸèƒ½åˆ†æ”¯</h5><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANX4suzD8O2OoWbYPwQ150IFWgQS3qSKoLWdglLxIjfri4eWAHC*W6m9OYJM0vFH4CxIhXiOdTBQYoWLsUJ3d8M.k!/r" alt="åŠŸèƒ½åˆ†æ”¯"></p><p>æ¯ä¸ªæ–°åŠŸèƒ½ä½äºä¸€ä¸ªè‡ªå·±çš„åˆ†æ”¯ï¼Œè¿™æ ·å¯ä»¥pushåˆ°ä¸­å¤®ä»“åº“ä»¥å¤‡ä»½å’Œåä½œã€‚  </p><p>ä½†æ˜¯åŠŸèƒ½åˆ†æ”¯ä¸æ˜¯ä»masteråˆ†æ”¯ä¸Šæ‹‰å‡ºæ–°åˆ†æ”¯ï¼Œè€Œæ˜¯ä½¿ç”¨developåˆ†æ”¯ä½œä¸ºçˆ¶åˆ†æ”¯ã€‚  </p><p>å½“æ–°åŠŸèƒ½å®Œæˆæ—¶ï¼Œåˆå¹¶ä¼šdevelopåˆ†æ”¯ã€‚  </p><p>æ–°åŠŸèƒ½æäº¤åº”è¯¥ä»ä¸ç›´æ¥ä¸masteråˆ†æ”¯äº¤äº’ã€‚  </p><p>å¼€æºè½¯ä»¶åŸºæœ¬ä¸Šæ˜¯ä½¿ç”¨GitFlowæ¥åšä»£ç ç‰ˆæœ¬ç®¡ç†çš„æ§åˆ¶ã€‚  </p><p>æ³¨æ„ï¼Œä»å„ç§å«ä¹‰å’Œç›®çš„ä¸Šæ¥çœ‹ï¼ŒåŠŸèƒ½åˆ†æ”¯åŠ ä¸Šdevelopåˆ†æ”¯å°±æ˜¯åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµçš„ç”¨æ³•ã€‚  </p><p>ä½†æ˜¯GitFlowå·¥ä½œæµæ²¡æœ‰åœ¨è¿™é‡Œæ­¢æ­¥ã€‚  </p><h5 id="å‘å¸ƒåˆ†æ”¯"><a href="#å‘å¸ƒåˆ†æ”¯" class="headerlink" title="å‘å¸ƒåˆ†æ”¯"></a>å‘å¸ƒåˆ†æ”¯</h5><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANX1K5y5ivKrS*rhk3l.NtQVVaNHmKMdlqKelqYaRENh70*1X*IrEmFCJIhfs5U7wXELfZbYI1tihPDOGBwBPqt6E!/r" alt="å‘å¸ƒåˆ†æ”¯"></p><p>ä¸€æ—¦developåˆ†æ”¯ä¸Šæœ‰äº†åšä¸€æ¬¡å‘å¸ƒï¼ˆæˆ–è€…è¯´å¿«åˆ°äº†æ—¢å®šçš„å‘å¸ƒæ—¥ï¼‰çš„è¶³å¤ŸåŠŸèƒ½ï¼Œå°±ä»developåˆ†æ”¯ä¸Šforkä¸€ä¸ªå‘å¸ƒåˆ†æ”¯ã€‚  </p><p>æ–°å»ºçš„åˆ†æ”¯ç”¨äºå¼€å§‹å‘å¸ƒå¾ªç¯ï¼Œæ‰€ä»¥ä»è¿™ä¸ªæ—¶é—´ç‚¹å¼€å§‹ä¹‹åæ–°çš„åŠŸèƒ½ä¸èƒ½å†åŠ åˆ°è¿™ä¸ªåˆ†æ”¯ä¸Šâ€”â€”-è¿™ä¸ªåˆ†æ”¯åªåº”è¯¥å«Bugä¿®å¤ã€æ–‡æ¡£ç”Ÿæˆæˆ–å…¶ä»–é¢å‘å‘å¸ƒä»»åŠ¡ã€‚  </p><p>ä¸€æ—¦å¯¹å¤–å‘å¸ƒçš„å·¥ä½œéƒ½å®Œæˆäº†ï¼Œå‘å¸ƒåˆ†æ”¯åˆå¹¶åˆ°masteråˆ†æ”¯å¹¶é£é…ä¸€ä¸ªç‰ˆæœ¬å·æ‰“å¥½Tagã€‚  </p><p>å¦å¤–ï¼Œè¿™äº›æ–°å»ºå‘éƒ¨åˆ†ä¹‹ä»¥æ¥åšçš„ä¿®æ”¹è¦åˆå¹¶å›developåˆ†æ”¯ã€‚  </p><p>ä½¿ç”¨ä¸€ä¸ªç”¨äºå‘å¸ƒå‡†å¤‡çš„ä¸“é—¨åˆ†æ”¯ï¼Œä½¿å¾—ä¸€ä¸ªå›¢é˜Ÿå¯ä»¥åœ¨å®Œå–„å½“å‰çš„å‘å¸ƒç‰ˆæœ¬çš„åŒæ—¶ï¼Œå¦ä¸€ä¸ªå›¢é˜Ÿå¯ä»¥ç»§ç»­å¼€å‘ä¸‹ä¸ªç‰ˆæœ¬çš„åŠŸèƒ½ã€‚  </p><p>è¿™ä¹Ÿæ‰“é€ å®šä¹‰è‰¯å¥½çš„å¼€å‘é˜¶æ®µï¼ˆæ¯”å¦‚ï¼Œå¯ä»¥å¾ˆè½»æ¾çš„è¯´ï¼Œã€è¿™å‘¨æˆ‘ä»¬è¦åšå‡†å¤‡å‘å¸ƒç‰ˆæœ¬4.0ã€‘ï¼Œå¹¶ä¸”åœ¨ä»“åº“çš„ç›®å½•ç»“æ„ä¸­å¯ä»¥å®é™…çœ‹åˆ°ï¼‰  </p><p>å¸¸ç”¨çš„åˆ†æ”¯çº¦å®šï¼š  </p><ul><li>ç”¨äºæ–°å»ºå‘å¸ƒåˆ†æ”¯çš„åˆ†æ”¯ï¼šdevelop</li><li>ç”¨äºåˆå¹¶çš„åˆ†æ”¯ï¼šmaster</li><li>åˆ†æ”¯å‘½åï¼šrelease- æˆ– release/</li></ul><h5 id="ç»´æŠ¤åˆ†æ”¯"><a href="#ç»´æŠ¤åˆ†æ”¯" class="headerlink" title="ç»´æŠ¤åˆ†æ”¯"></a>ç»´æŠ¤åˆ†æ”¯</h5><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANX8qfvx9q8UhYcwpU4tSoxZoCzp2TGnchoEgJnBAd**ejGrSWx7H1n1RbZFVAdVlD7v3kEO6EHjpPFNMCD9pabTQ!/r" alt="ç»´æŠ¤åˆ†æ”¯"></p><p>ç»´æŠ¤åˆ†æ”¯æˆ–è€…è¯´æ˜¯çƒ­ä¿®å¤ï¼ˆhotfixï¼‰åˆ†æ”¯ç”¨äºç”Ÿæˆå¿«é€Ÿç»™äº§å“å‘å¸ƒç‰ˆæœ¬ï¼ˆproduction releaseï¼‰æ‰“è¡¥ä¸ï¼Œè¿™æ˜¯å”¯ä¸€å¯ä»¥ä»masteråˆ†æ”¯forkå‡ºæ¥çš„åˆ†æ”¯ã€‚  </p><p>ä¿®å¤å®Œæˆï¼Œä¿®æ”¹åº”è¯¥é©¬ä¸Šåˆå¹¶å›masteråˆ†æ”¯å’Œdevelopåˆ†æ”¯ï¼ˆå½“å‰çš„å‘éƒ¨åˆ†æ”¯ï¼‰ï¼Œmasteråˆ†æ”¯åº”è¯¥ç”¨æ–°çš„ç‰ˆæœ¬å·æ‰“å¥½Tagã€‚  </p><p>ä¸ºäº†Bugä¿®å¤ä½¿ç”¨ä¸“é—¨åˆ†æ”¯ï¼Œè®©å›¢é˜Ÿå¯ä»¥å¤„ç†é—®é¢˜è€Œä¸ç”¨æ‰“æ–­å…¶ä»–å·¥ä½œæˆ–è€…æ˜¯ç­‰å¾…ä¸‹ä¸€ä¸ªå‘å¸ƒå¾ªç¯ã€‚  </p><p>ä½ å¯ä»¥æŠŠç»´æŠ¤åˆ†æ”¯æƒ³æˆæ˜¯ä¸€ä¸ªç›´æ¥åœ¨masteråˆ†æ”¯ä¸Šå¤„ç†çš„ä¸´æ—¶å‘å¸ƒã€‚  </p><p>å³hotfixï¼Œç»´æŠ¤çš„æ˜¯v1.0.0â€”&gt;v1.0.1è¿™ç§ï¼›<br>ç¬¬ä¸‰ä½æ•°ä¿®æ”¹çš„æ˜¯Bugï¼ˆhotfixç»´æŠ¤ç‰ˆæœ¬ç¬¬ä¸‰ä½æ•°ï¼‰ï¼›ç¬¬äºŒä½æ•°ä¿®æ”¹çš„æ˜¯åŠŸèƒ½ï¼ˆåŠŸèƒ½åˆ†æ”¯ç»´æŠ¤çš„æ˜¯ç‰ˆæœ¬çš„ç¬¬äºŒä½æ•°ï¼‰ï¼›ç¬¬ä¸€ä½ä¸ºå¤§æ¶æ„æ”¹å˜çš„æ—¶å€™è¿›è¡Œä¿®æ”¹ï¼ˆç»´æŠ¤ç‰ˆæœ¬çš„ç¬¬ä¸€ä½æ•°ï¼‰ï¼›  </p><p>GitFlowä»è¿™ç‚¹ä¸Šå°±å¯ä»¥ä¸è¯­ä¹‰åŒ–è§„èŒƒç‰µæ‰¯ä¸Šè”ç³»ï¼›  </p><h4 id="ç¤ºä¾‹-2"><a href="#ç¤ºä¾‹-2" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><p>ä¸‹é¢çš„ç¤ºä¾‹æ¼”ç¤ºæœ¬å·¥ä½œæµå¦‚ä½•ç”¨äºç®¡ç†å•ä¸ªå‘å¸ƒå¾ªç¯ã€‚  </p><p>å‡è®¾ä½ å·²ç»åˆ›å»ºäº†ä¸€ä¸ªä¸­å¤®ä»“åº“ã€‚  </p><h5 id="åˆ›å»ºå¼€å‘åˆ†æ”¯"><a href="#åˆ›å»ºå¼€å‘åˆ†æ”¯" class="headerlink" title="åˆ›å»ºå¼€å‘åˆ†æ”¯"></a>åˆ›å»ºå¼€å‘åˆ†æ”¯</h5><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANX4Xsg92Awirp0bThQ4n*YW8UWB.U5*XFBFsn5hkNOcst0hBz.q1uwuu*KDADM.W9naZBQq8eKQyo4iLkzk28e1g!/r" alt="åˆ›å»ºå¼€å‘åˆ†æ”¯"></p><p>ç¬¬ä¸€æ­¥ä¸ºmasteråˆ†æ”¯é…å¥—ä¸€ä¸ªdevelopåˆ†æ”¯ã€‚  </p><p>ç®€å•æ¥åšå¯ä»¥æœ¬åœ°åˆ›å»ºä¸€ä¸ªç©ºçš„developåˆ†æ”¯ï¼Œpushåˆ°æœåŠ¡å™¨ä¸Šï¼š  </p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">git</span> <span class="keyword">branch </span>develop</span><br><span class="line"><span class="symbol">git</span> <span class="keyword">push </span>-u origin master</span><br></pre></td></tr></table></figure><p>ä»¥åè¿™ä¸ªåˆ†æ”¯å°†ä¼šåŒ…å«äº†é¡¹ç›®çš„å…¨éƒ¨å†å²ã€‚  </p><p>è€Œmasteråˆ†æ”¯å°†åªåŒ…å«éƒ¨åˆ†å†å²ã€‚  </p><p>å…¶ä»–å¼€å‘è€…è¿™æ—¶åº”è¯¥å…‹éš†ä¸­å¤®ä»“åº“ï¼Œå»ºå¥½developåˆ†æ”¯çš„è·Ÿè¸ªåˆ†æ”¯ï¼š  </p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">ssh</span>://user@host/path/to/repo.git</span><br><span class="line">git checkout -b develop origin/develop</span><br></pre></td></tr></table></figure><p>ç°åœ¨æ¯ä¸ªå¼€å‘éƒ½æœ‰äº†è¿™äº›å†å²åˆ†æ”¯çš„æœ¬åœ°æ‹·è´ã€‚  </p><h5 id="å°çº¢å’Œå°æ˜å¼€å§‹å¼€å‘æ–°åŠŸèƒ½"><a href="#å°çº¢å’Œå°æ˜å¼€å§‹å¼€å‘æ–°åŠŸèƒ½" class="headerlink" title="å°çº¢å’Œå°æ˜å¼€å§‹å¼€å‘æ–°åŠŸèƒ½"></a>å°çº¢å’Œå°æ˜å¼€å§‹å¼€å‘æ–°åŠŸèƒ½</h5><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANX2X16EiSaoizI9a2HRgo6HRlddb*dD0yGRzorFtrKInoqDMveDkX4.ujU1ZgrgxXoZf1vY83YLzd6Dl2YO5SDUc!/r" alt="å°çº¢å’Œå°æ˜å¼€å§‹å¼€å‘æ–°åŠŸèƒ½"></p><p>è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œå°çº¢å’Œå°æ˜å¼€å§‹å„è‡ªçš„åŠŸèƒ½å¼€å‘ã€‚  </p><p>ä»–ä»¬éœ€è¦ä¸ºå„è‡ªçš„åŠŸèƒ½åˆ›å»ºç›¸åº”çš„åˆ†æ”¯ã€‚  </p><p>æ–°åˆ†æ”¯ä¸æ˜¯åŸºäºmasteråˆ†æ”¯ï¼Œè€Œæ˜¯åº”è¯¥åŸºäºdevelopåˆ†æ”¯ï¼š  </p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b <span class="built_in">some</span>-<span class="built_in">feature</span> develop</span><br></pre></td></tr></table></figure><p>ä»–ä»¬ç”¨è€å¥—è·¯æ·»åŠ æäº¤åˆ°å„è‡ªåŠŸèƒ½åˆ†æ”¯ä¸Šï¼šç¼–è¾‘ã€æš‚å­˜ã€æäº¤ï¼›  </p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">git</span> <span class="string">status</span></span><br><span class="line"><span class="attr">git</span> <span class="string">add</span></span><br><span class="line"><span class="attr">git</span> <span class="string">commit</span></span><br></pre></td></tr></table></figure><h5 id="å°çº¢å®ŒæˆåŠŸèƒ½å¼€å‘-1"><a href="#å°çº¢å®ŒæˆåŠŸèƒ½å¼€å‘-1" class="headerlink" title="å°çº¢å®ŒæˆåŠŸèƒ½å¼€å‘"></a>å°çº¢å®ŒæˆåŠŸèƒ½å¼€å‘</h5><p>æ·»åŠ äº†æäº¤åï¼Œå°çº¢è§‰å¾—å¥¹çš„åŠŸèƒ½OKäº†ã€‚  </p><p>å¦‚æœå›¢é˜Ÿä½¿ç”¨Pull Requestsï¼Œè¿™æ—¶å€™å¯ä»¥å‘èµ·ä¸€ä¸ªç”¨äºåˆå¹¶åˆ°developåˆ†æ”¯ã€‚  </p><p>å¦åˆ™å¥¹å¯ä»¥ç›´æ¥åˆå¹¶åˆ°å¥¹æœ¬åœ°çš„developåˆ†ä¹‹åpushåˆ°ä¸­å¤®ä»“åº“ï¼š  </p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git pull <span class="built_in">origin</span> develop</span><br><span class="line">git checkout develop</span><br><span class="line">git merge <span class="built_in">some</span>-<span class="built_in">feature</span></span><br><span class="line">git <span class="built_in">push</span></span><br><span class="line">git branch -d <span class="built_in">some</span>-<span class="built_in">feature</span></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€æ¡å‘½ä»¤åœ¨åˆå¹¶åŠŸèƒ½å‰ç¡®ä¿developåˆ†æ”¯æ˜¯æœ€æ–°çš„ã€‚  </p><p>æ³¨æ„ï¼ŒåŠŸèƒ½ç»ä¸åº”è¯¥ç›´æ¥åˆå¹¶åˆ°masteråˆ†æ”¯ã€‚  </p><p>å†²çªè§£å†³æ–¹æ³•å’Œé›†ä¸­å¼å·¥ä½œæµä¸€æ ·ã€‚  </p><h5 id="å°çº¢å¼€å§‹å‡†å¤‡å‘å¸ƒ"><a href="#å°çº¢å¼€å§‹å‡†å¤‡å‘å¸ƒ" class="headerlink" title="å°çº¢å¼€å§‹å‡†å¤‡å‘å¸ƒ"></a>å°çº¢å¼€å§‹å‡†å¤‡å‘å¸ƒ</h5><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANXxm6aYd1gMGOxylETc6cDcj7kTwBnGuyoyzYDL7pNxxvtXeo*D5bCxnVfWE*k.cQe8O4lhgkHo2zR.IIDII1kmA!/r" alt="å°çº¢å¼€å§‹å‡†å¤‡å‘å¸ƒ"></p><p>è¿™ä¸ªæ—¶å€™å°æ˜æ­£åœ¨å®ç°ä»–çš„åŠŸèƒ½ã€‚  </p><p>å°çº¢å¼€å§‹å‡†å¤‡å¥¹çš„ç¬¬ä¸€ä¸ªé¡¹ç›®æ­£å¼å‘å¸ƒï¼ˆå‘å¸ƒåˆ†æ”¯ä¹Ÿå«é¢„å‘å¸ƒåˆ†æ”¯ï¼Œé¢„å‘å¸ƒåˆ†æ”¯åŸºäºdevelopï¼Œåªæœ‰é¢„å‘å¸ƒç‰ˆæœ¬åˆ†æ”¯æ‰èƒ½å¤Ÿå»åˆå¹¶åˆ°masteråˆ†æ”¯ï¼Œè€Œé¢„å‘å¸ƒç‰ˆæœ¬æ˜¯ç»è¿‡æµ‹è¯•äººå‘˜æµ‹è¯•ä¹‹åçš„æ²¡æœ‰é—®é¢˜çš„ä¸€ä¸ªç‰ˆæœ¬ï¼›masteråˆ†æ”¯ä»£ç å¿…é¡»å¯ä»¥æ‰§è¡Œï¼Œæ²¡æœ‰è¢«æ±¡æŸ“ï¼‰ã€‚  </p><p>åƒåŠŸèƒ½å¼€å‘ä¸€æ ·ï¼Œå¥¹ç”¨ä¸€ä¸ªæ–°çš„åˆ†æ”¯æ¥åšå‘å¸ƒå‡†å¤‡ã€‚  </p><p>è¿™ä¸€æ­¥ä¹Ÿç¡®å®šäº†å‘å¸ƒçš„ç‰ˆæœ¬å·ï¼š  </p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b release<span class="number">-0.1</span> develop</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªåˆ†æ”¯æ˜¯æ¸…ç†åˆ†æ”¯ã€æ‰§è¡Œæ‰€æœ‰æµ‹è¯•ã€æ›´æ–°æ–‡æ¡£å’Œå…¶ä»–ä¸ºä¸‹ä¸ªå‘å¸ƒåšå‡†å¤‡æ“ä½œçš„åœ°æ–¹ï¼Œåƒæ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºæ”¹å–„å‘å¸ƒçš„åŠŸèƒ½åˆ†æ”¯ã€‚  </p><p>åªè¦å°çº¢åˆ›å»ºçš„è¿™ä¸ªåˆ†æ”¯pushåˆ°ä¸­å¤®ä»“åº“ï¼Œè¿™ä¸ªå‘å¸ƒå°±æ˜¯åŠŸèƒ½å†»ç»“çš„ã€‚  </p><p>ä»»ä½•ä¸åœ¨developåˆ†æ”¯ä¸­çš„æ–°åŠŸèƒ½éƒ½æ¨åˆ°ä¸‹ä¸€ä¸ªå‘å¸ƒå¾ªç¯ä¸­ã€‚  </p><h5 id="å°çº¢å®Œæˆå‘å¸ƒ"><a href="#å°çº¢å®Œæˆå‘å¸ƒ" class="headerlink" title="å°çº¢å®Œæˆå‘å¸ƒ"></a>å°çº¢å®Œæˆå‘å¸ƒ</h5><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANXx2fdZ*.CxsTwPMg235DDXkchbPbk7hNVec6.FIcmcf72k0vjzhdQvVlYt8u8ao*65n3gyQAyN5GOxndJKhwiNk!/r" alt="å°çº¢å®Œæˆå‘å¸ƒ"></p><p>ä¸€æ—¦å‡†å¤‡å¥½äº†å¯¹å¤–å‘å¸ƒï¼Œå°çº¢åˆå¹¶ä¿®æ”¹åˆ°masteråˆ†æ”¯å’Œdevelopåˆ†æ”¯ä¸Šï¼Œåˆ é™¤å‘å¸ƒåˆ†æ”¯ã€‚  </p><p>åˆå¹¶å›developåˆ†æ”¯å¾ˆé‡è¦ï¼Œå› ä¸ºåœ¨å‘å¸ƒåˆ†æ”¯ä¸­å·²ç»æäº¤çš„æ›´æ–°éœ€è¦åœ¨åé¢çš„æ–°åŠŸèƒ½ä¸­ä¹Ÿè¦æ˜¯å¯ç”¨çš„ã€‚  </p><p>å¦å¤–ï¼Œå¦‚æœå°çº¢çš„å›¢é˜Ÿè¦æ±‚Code  Reviewï¼Œè¿™æ˜¯ä¸€ä¸ªå‘èµ·Pull Requestçš„ç†æƒ³æ—¶æœºã€‚  </p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">git</span> <span class="string">checkout master</span></span><br><span class="line"><span class="attr">git</span> <span class="string">merge release-0.1</span></span><br><span class="line"><span class="attr">git</span> <span class="string">push</span></span><br><span class="line"><span class="attr">git</span> <span class="string">checkout develop</span></span><br><span class="line"><span class="attr">git</span> <span class="string">merge release-0.1</span></span><br><span class="line"><span class="attr">git</span> <span class="string">push</span></span><br><span class="line"><span class="attr">git</span> <span class="string">branch -d release-0.1</span></span><br></pre></td></tr></table></figure><p>å‘å¸ƒåˆ†æ”¯æ˜¯ä½œä¸ºåŠŸèƒ½å¼€å‘ï¼ˆdevelopåˆ†æ”¯ï¼‰å’Œå¯¹å¤–å‘å¸ƒï¼ˆmasteråˆ†æ”¯ï¼‰é—´çš„ç¼“å†²ã€‚  </p><p>åªè¦æœ‰åˆå¹¶åˆ°masteråˆ†æ”¯ï¼Œå°±åº”è¯¥æ‰“å¥½Tagä»¥æ–¹ä¾¿è·Ÿè¸ªã€‚  </p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">tag</span> <span class="title">-a</span> <span class="number">0.1</span> -m <span class="string">"Initial public release"</span> <span class="literal">master</span></span><br><span class="line">git push --tags</span><br></pre></td></tr></table></figure><p>Gitæœ‰æä¾›å„ç§é’©å­ï¼ˆhookï¼‰ï¼Œå³ä»“åº“æœ‰æ—¶é—´å‘ç”Ÿæ—¶è§¦å‘æ‰§è¡Œçš„è„šæœ¬ã€‚  </p><p>å¯ä»¥é…ç½®ä¸€ä¸ªé’©å­ï¼Œåœ¨ä½ pushä¸­å¤®ä»“åº“çš„masteråˆ†æ”¯æ—¶ï¼Œè‡ªåŠ¨æ„å»ºå¥½å¯¹å¤–å‘å¸ƒã€‚  </p><h5 id="æœ€ç»ˆç”¨æˆ·å‘ç°Bug"><a href="#æœ€ç»ˆç”¨æˆ·å‘ç°Bug" class="headerlink" title="æœ€ç»ˆç”¨æˆ·å‘ç°Bug"></a>æœ€ç»ˆç”¨æˆ·å‘ç°Bug</h5><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANXzsQH1hJotlrx1khR6EZ0dUlyxkaf9L1Yi66Fs6sohYE0UTifJNygNHa*okiIgZc5dg2qSXBW*VyQGtiyMr0yo8!/r" alt="æœ€ç»ˆç”¨æˆ·å‘ç°Bug"></p><p>å¯¹å¤–å‘å¸ƒåï¼Œå°çº¢å›å»å’Œå°æ˜ä¸€èµ·åšä¸‹ä¸ªå‘å¸ƒçš„æ–°åŠŸèƒ½å¼€å‘ï¼Œç›´åˆ°æœ‰æœ€ç»ˆç”¨æˆ·å¼€äº†ä¸€ä¸ªTicketæŠ±æ€¨å½“å‰ç‰ˆæœ¬çš„ä¸€ä¸ªBugã€‚  </p><p>ä¸ºäº†å¤„ç†Bugï¼Œå°çº¢ï¼ˆæˆ–è€…å°æ˜ï¼‰ä»masteråˆ†æ”¯ä¸Šæ¥å»äº†ä¸€ä¸ªç»´æŠ¤åˆ†æ”¯ï¼ˆhotfixï¼‰ï¼Œæäº¤ä¿®æ”¹ä»¥è§£å†³é—®é¢˜ï¼Œç„¶åç›´æ¥åˆå¹¶å›masteråˆ†æ”¯ï¼š  </p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b issue-<span class="comment">#001 master</span></span><br><span class="line"><span class="comment"># Fix the bug</span></span><br><span class="line">git checkout <span class="literal">master</span></span><br><span class="line">git merge issue-<span class="comment">#001</span></span><br><span class="line">git push</span><br></pre></td></tr></table></figure><p>å°±åƒå‘å¸ƒåˆ†æ”¯ï¼Œç»´æŠ¤åˆ†æ”¯ä¸­æ–°åŠ è¿™äº›é‡è¦ä¿®æ”¹éœ€è¦åŒ…å«åˆ°developåˆ†æ”¯ä¸­ï¼Œæ‰€ä»¥å°çº¢è¦æ‰§è¡Œä¸€ä¸ªåˆå¹¶æ“ä½œï¼Œç„¶åå°±å¯ä»¥å®‰å…¨åœ°åˆ é™¤è¿™ä¸ªåˆ†æ”¯äº†ï¼š  </p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">git</span> <span class="string">checkout develop</span></span><br><span class="line"><span class="attr">git</span> <span class="string">merge issue-#001</span></span><br><span class="line"><span class="attr">git</span> <span class="string">push</span></span><br><span class="line"><span class="attr">git</span> <span class="string">branch -d issue-#001</span></span><br></pre></td></tr></table></figure><h4 id="æ€»ç»“-2"><a href="#æ€»ç»“-2" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>åˆ°äº†è¿™é‡Œï¼Œä½†æ„¿ä½ å¯¹é›†ä¸­å¼å·¥ä½œæµã€åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµå’ŒGitFlowå·¥ä½œæµå·²ç»æ„Ÿè§‰å¾ˆèˆ’é€‚äº†ã€‚  </p><p>ä½ åº”è¯¥ä¹Ÿç‰¢å›ºçš„æŒæ¡äº†æœ¬åœ°ä»“åº“çš„æ½œèƒ½ï¼Œpush/pullæ¨¡å¼å’ŒGitå¥å£®çš„åˆ†æ”¯å’Œåˆå¹¶æ¨¡å‹ã€‚  </p><p>è®°ä½ï¼Œè¿™é‡Œæ¼”ç¤ºçš„å·¥ä½œæµåªæ˜¯å¯èƒ½ç”¨æ³•çš„ä¾‹å­ï¼Œè€Œä¸æ˜¯åœ¨å®é™…å·¥ä½œä¸­ä½¿ç”¨Gitä¸å¯è¿é€†çš„æ¡ä¾‹ã€‚  </p><p>æ‰€ä»¥ä¸è¦ç•æƒ§æŒ‰è‡ªå·±éœ€è¦å¯¹å·¥ä½œæµçš„ç”¨æ³•åšå–èˆï¼Œä¸å˜çš„ç›®æ ‡å°±æ˜¯è®©Gitä¸ºä½ æ‰€ç”¨ã€‚  </p><p>ï¼ˆåœ¨æ•´ä¸ªGitFlowå·¥ä½œæµå½“ä¸­ï¼Œåªä¼šå»è¿›è¡Œçœç•¥åŠŸèƒ½åˆ†æ”¯Featureï¼ŒMasterã€HotFixã€Releaseã€Developæ˜¯å¿…ä¸å¯å°‘çš„åˆ†æ”¯ï¼Œä»¥ä¾¿æ§åˆ¶æ¯ä¸€æ¬¡ç‰ˆæœ¬çš„è¿­ä»£ï¼‰  </p><h3 id="Forkingå·¥ä½œæµ-1"><a href="#Forkingå·¥ä½œæµ-1" class="headerlink" title="Forkingå·¥ä½œæµ"></a>Forkingå·¥ä½œæµ</h3><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANX2qjPC0eDN.Xf29HcBYoAsTtpBFvJhu8qPVkh5cv575QWLsHx3q8JbFYK3X5cts.Zn43gkCjc7OzyBcDFaNdl.g!/r" alt="Forkingå·¥ä½œæµ"></p><p>Forkingå·¥ä½œæµå’Œå‰é¢è®¨è®ºçš„å‡ ç§å·¥ä½œæµæœ‰æ ¹æœ¬çš„ä¸åŒã€‚  </p><p>è¿™ç§å·¥ä½œæµä¸æ˜¯é€‚ç”¨å•ä¸ªæœåŠ¡å™¨ç«¯ä»“åº“ä½œä¸ºã€ä¸­å¤®ã€‘ä»£ç åŸºçº¿ï¼Œè€Œè®©å„ä¸ªå¼€å‘è€…éƒ½æœ‰ä¸€ä¸ªæœåŠ¡ç«¯ä»“åº“ã€‚  </p><p>è¿™æ„å‘³ç€å„ä¸ªä»£ç è´¡çŒ®è€…æœ‰2ä¸ªGitä»“åº“è€Œä¸æ˜¯1ä¸ªï¼šä¸€ä¸ªæœ¬åœ°ç§æœ‰çš„ï¼Œå¦ä¸€ä¸ªæœåŠ¡ç«¯å…¬å¼€çš„ã€‚  </p><p>Forkingå·¥ä½œæµçš„ä¸€ä¸ªä¸»è¦ä¼˜åŠ¿æ˜¯ï¼Œè´¡çŒ®çš„ä»£ç å¯ä»¥è¢«é›†æˆï¼Œè€Œä¸éœ€è¦æ‰€æœ‰äººéƒ½èƒ½pushä»£ç åˆ°ä»…æœ‰çš„ä¸­å¤®ä»“åº“ä¸­ã€‚  </p><p>å¼€å‘è€…pushåˆ°è‡ªå·±çš„æœåŠ¡ç«¯ä»“åº“ï¼Œè€Œåªæœ‰é¡¹ç›®ç»´æŠ¤è€…æ‰èƒ½pushåˆ°æ­£å¼ä»“åº“ã€‚  </p><p>è¿™æ ·é¡¹ç›®ç»´æŠ¤è€…å¯ä»¥æ¥å—ä»»ä½•å¼€å‘è€…çš„æäº¤ï¼Œä½†æ— éœ€ç»™ä»–æ­£å¼ä»£ç åº“çš„å†™æƒé™ã€‚  </p><p>æ•ˆæœå°±æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„å·¥ä½œæµï¼Œèƒ½ä¸ºå¤§å‹ã€è‡ªå‘æ€§çš„å›¢é˜Ÿï¼ˆåŒ…æ‹¬äº†ä¸å—ä¿¡çš„ç¬¬ä¸‰æ–¹ï¼‰æä¾›çµæ´»çš„æ–¹å¼æ¥å®‰å…¨çš„å†™ä½œã€‚  </p><p>ä¹Ÿè®©è¿™ä¸ªå·¥ä½œæµç§°ä¸ºå¼€æºé¡¹ç›®çš„ç†æƒ³å·¥ä½œæµã€‚  </p><h4 id="å·¥ä½œæ–¹å¼-3"><a href="#å·¥ä½œæ–¹å¼-3" class="headerlink" title="å·¥ä½œæ–¹å¼"></a>å·¥ä½œæ–¹å¼</h4><p>å’Œå…¶ä»–çš„Gitå·¥ä½œæµä¸€æ ·ï¼ŒForkingå·¥ä½œæµè¦å…ˆæœ‰ä¸€ä¸ªå…¬å¼€çš„æ­£å¼ä»“åº“å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸Šï¼Œä½†ä¸€ä¸ªæ–°çš„å¼€å‘è€…æƒ³è¦åœ¨é¡¹ç›®ä¸Šå·¥ä½œæ—¶ï¼Œä¸æ˜¯ç›´æ¥ä»æ­£å¼ä»“åº“å…‹éš†ï¼Œè€Œæ˜¯forkæ­£å¼é¡¹ç›®åœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºä¸€ä¸ªæ‹·è´ã€‚  </p><p>è¿™ä¸ªä»“åº“æ‹·è´ä½œä¸ºä»–äººå…¬å¼€ä»“åº“â€”â€“å…¶ä»–å¼€å‘è€…ä¸å…è®¸pushåˆ°è¿™ä¸ªä»“åº“ï¼Œä½†å¯ä»¥pullåˆ°ä¿®æ”¹ï¼ˆåé¢å¾ˆå¿«å°±ä¼šçœ‹åˆ°è¿™ç‚¹å¾ˆé‡è¦ï¼‰ã€‚  </p><p>åœ¨åˆ›å»ºäº†è‡ªå·±æœåŠ¡ç«¯æ‹·è´ä¹‹åï¼Œå’Œä¹‹å‰çš„å·¥ä½œæµä¸€æ ·ï¼Œå¼€å‘è€…æ‰§è¡Œgit cloneå‘½ä»¤å…‹éš†ä»“åº“åˆ°æœ¬åœ°æœºå™¨ä¸Šï¼Œä½œä¸ºç§æœ‰çš„å¼€å‘ç¯å¢ƒã€‚  </p><p>è¦æäº¤æœ¬åœ°ä¿®æ”¹æ—¶ï¼Œpushæäº¤åˆ°è‡ªå·±å…¬å¼€ä»“åº“ä¸­â€”â€”-è€Œä¸æ˜¯æ­£å¼ä»“åº“ä¸­ã€‚  </p><p>ç„¶åï¼Œç»™æ­£å¼ä»“åº“å‘èµ·ä¸€ä¸ªpull requestï¼Œè®©é¡¹ç›®ç»´æŠ¤è€…çŸ¥é“æœ‰æ›´æ–°å·²ç»å‡†å¤‡å¥½å¯ä»¥é›†æˆäº†ã€‚  </p><p>å¯¹äºè´¡çŒ®çš„ä»£ç ï¼Œpull requestä¹Ÿå¯ä»¥å¾ˆæ–¹ä¾¿åœ°ä½œä¸ºä¸€ä¸ªè®¨è®ºçš„åœ°æ–¹ã€‚  </p><p>ä¸ºäº†é›†æˆåŠŸèƒ½åˆ°æ­£å¼ä»£ç åº“ï¼Œç»´æŠ¤è€…pullè´¡çŒ®è€…çš„å˜æ›´åˆ°è‡ªå·±çš„æœ¬åœ°ä»“åº“ä¸­ï¼Œæ£€æŸ¥å˜æ›´ä»¥ç¡®ä¿ä¸ä¼šè®©é¡¹ç›®å‡ºé”™ï¼Œåˆå¹¶å˜æ›´åˆ°è‡ªå·±æœ¬åœ°çš„masteråˆ†æ”¯ï¼Œç„¶åpush masteråˆ†æ”¯åˆ°æœåŠ¡å™¨çš„æ­£å¼ä»“åº“ä¸­ã€‚  </p><p>åˆ°æ­¤ï¼Œè´¡çŒ®çš„æäº¤æˆä¸ºäº†é¡¹ç›®çš„ä¸€éƒ¨åˆ†ï¼Œå…¶ä»–çš„å¼€å‘è€…åº”è¯¥æ‰§è¡Œpullæ“ä½œä¸æ­£å¼ä»“åº“åŒæ­¥è‡ªå·±æœ¬åœ°ä»“åº“ã€‚  </p><h5 id="æ­£å¼ä»“åº“"><a href="#æ­£å¼ä»“åº“" class="headerlink" title="æ­£å¼ä»“åº“"></a>æ­£å¼ä»“åº“</h5><p>åœ¨Forkingå·¥ä½œæµä¸­ï¼Œã€å®˜æ–¹ã€‘ä»“åº“çš„å«æ³•åªæ˜¯ä¸€ä¸ªçº¦å®šï¼Œç†è§£è¿™ç‚¹å¾ˆé‡è¦ã€‚  </p><p>ä»æŠ€æœ¯ä¸Šæ¥çœ‹ï¼Œå„ä¸ªå¼€å‘è€…ä»“åº“å’Œæ­£å¼ä»“åº“åœ¨Gitå¡é‚£é‡Œæ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚  </p><p>äº‹å®ä¸Šï¼Œè®©æ­£å¼ä»“åº“ä¹‹æ‰€ä»¥æ­£å¼çš„å”¯ä¸€åŸå› æ˜¯ä»–æ˜¯é¡¹ç›®ç»´æŠ¤è€…çš„å…¬å¼€ä»“åº“ã€‚  </p><h5 id="Forkingå·¥ä½œæµçš„åˆ†æ”¯ä½¿ç”¨æ–¹å¼"><a href="#Forkingå·¥ä½œæµçš„åˆ†æ”¯ä½¿ç”¨æ–¹å¼" class="headerlink" title="Forkingå·¥ä½œæµçš„åˆ†æ”¯ä½¿ç”¨æ–¹å¼"></a>Forkingå·¥ä½œæµçš„åˆ†æ”¯ä½¿ç”¨æ–¹å¼</h5><p>æ‰€æœ‰çš„ä¸ªäººå…¬å¼€ä»“åº“å®é™…å•†åªæ˜¯ä¸ºäº†æ–¹ä¾¿å’Œå…¶ä»–çš„å¼€å‘è€…å…±äº«åˆ†æ”¯ã€‚  </p><p>å„ä¸ªå¼€å‘è€…åº”è¯¥ç”¨åˆ†æ”¯éš”ç¦»å„ä¸ªåŠŸèƒ½ï¼Œå°±åƒåŠŸèƒ½åˆ†æ”¯å·¥ä½œæµå’ŒGitFlowå·¥ä½œæµä¸€æ ·ã€‚  </p><p>å”¯ä¸€çš„åŒºåˆ«æ˜¯è¿™äº›åˆ†æ”¯è¢«å…±äº«äº†ã€‚  </p><p>åœ¨Forkingå·¥ä½œæµä¸­è¿™äº›åˆ†æ”¯ä¼šè¢«pullåˆ°å¦ä¸€ä¸ªå¼€å‘è€…çš„æœ¬åœ°ä»“åº“ä¸­ï¼Œè€Œåœ¨åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµå’ŒGitFlowå·¥ä½œæµä¸­æ˜¯ç›´æ¥è¢«pushåˆ°æ­£å¼ä»“åº“å½“ä¸­ã€‚  </p><h4 id="ç¤ºä¾‹-3"><a href="#ç¤ºä¾‹-3" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><h5 id="é¡¹ç›®ç»´æŠ¤è€…åˆå§‹åŒ–æ­£å¼ä»“åº“"><a href="#é¡¹ç›®ç»´æŠ¤è€…åˆå§‹åŒ–æ­£å¼ä»“åº“" class="headerlink" title="é¡¹ç›®ç»´æŠ¤è€…åˆå§‹åŒ–æ­£å¼ä»“åº“"></a>é¡¹ç›®ç»´æŠ¤è€…åˆå§‹åŒ–æ­£å¼ä»“åº“</h5><p>å’Œä»»ä½•ä½¿ç”¨Gité¡¹ç›®ä¸€æ ·ï¼Œç¬¬ä¸€æ­¥è¿˜æ˜¯åˆ›å»ºåœ¨æœåŠ¡å™¨ä¸Šä¸€ä¸ªæ­£å¼ä»“åº“ï¼Œè®©æ‰€æœ‰å›¢é˜Ÿæˆå‘˜éƒ½å¯ä»¥è®¿é—®åˆ°ã€‚  </p><p>é€šå¸¸è¿™ä¸ªä»“åº“ä¹Ÿä¼šä½œä¸ºé¡¹ç›®ç»´æŠ¤è€…çš„å…¬å¼€ä»“åº“ã€‚  </p><p>å…¬å¼€ä»“åº“åº”è¯¥æ˜¯è£¸ä»“åº“ï¼Œä¸ç®¡æ˜¯ä¸æ˜¯æ­£å¼ä»£ç åº“ã€‚  </p><p>æ‰€ä»¥é¡¹ç›®ç»´æŠ¤è€…ä¼šè¿è¡Œåƒä¸‹é¢çš„å‘½ä»¤æ¥æ­å»ºæ­£å¼ä»“åº“ï¼š  </p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh user<span class="symbol">@host</span></span><br><span class="line">git init --bare /path/<span class="keyword">to</span>/repo.git</span><br></pre></td></tr></table></figure><p>Bitbucketå’ŒStashæä¾›äº†ä¸€ä¸ªæ–¹ä¾¿çš„GUIå®¢æˆ·ç«¯å·²å®Œæˆä¸Šé¢å‘½ä»¤è¡Œåšçš„äº‹ã€‚  </p><p>è¿™ä¸ªæ­å»ºä¸­å¤®ä»“åº“çš„è¿‡ç¨‹å’Œå‰é¢æåˆ°çš„å·¥ä½œæµå®Œå…¨ä¸€æ ·ã€‚  </p><p>å¦‚æœæœ‰ç°å­˜çš„ä»£ç åº“ï¼Œç»´æŠ¤è€…ä¹Ÿè¦pushåˆ°è¿™ä¸ªä»“åº“ä¸­ã€‚  </p><h5 id="å¼€å‘è€…forkæ­£å¼ä»“åº“"><a href="#å¼€å‘è€…forkæ­£å¼ä»“åº“" class="headerlink" title="å¼€å‘è€…forkæ­£å¼ä»“åº“"></a>å¼€å‘è€…forkæ­£å¼ä»“åº“</h5><p>å…¶ä»–æ‰€æœ‰çš„å¼€å‘éœ€è¦forkæ­£å¼ä»“åº“ã€‚  </p><p>å¯ä»¥ç”¨git cloneå‘½ä»¤ç”¨SSHåè®®è¿é€šåˆ°æœåŠ¡å™¨ï¼Œæ‹·è´ä»“åº“åˆ°æœåŠ¡å™¨å¦ä¸€ä¸ªä½ç½®â€”â€“æ˜¯çš„ï¼Œforkæ“ä½œåŸºæœ¬ä¸Šå°±åªæ˜¯ä¸€ä¸ªæœåŠ¡ç«¯çš„å…‹éš†ã€‚  </p><p>Bitbucketå’ŒStashä¸Šå¯ä»¥ç‚¹ä¸€ä¸‹æŒ‰é’®å°±è®©å¼€å‘è€…å®Œæˆä»“åº“çš„forkæ“ä½œã€‚  </p><p>è¿™ä¸€æ­¥å®Œæˆåï¼Œæ¯ä¸ªå¼€å‘éƒ½åœ¨æœåŠ¡ç«¯æœ‰ä¸€ä¸ªè‡ªå·±çš„ä»“åº“ã€‚  </p><p>å’Œæ­£å¼ä»“åº“ä¸€æ ·ï¼Œè¿™äº›ä»“åº“åº”è¯¥æ˜¯è£¸ä»“åº“ã€‚  </p><h5 id="å¼€å‘è€…å…‹éš†è‡ªå·±forkå‡ºæ¥çš„ä»“åº“"><a href="#å¼€å‘è€…å…‹éš†è‡ªå·±forkå‡ºæ¥çš„ä»“åº“" class="headerlink" title="å¼€å‘è€…å…‹éš†è‡ªå·±forkå‡ºæ¥çš„ä»“åº“"></a>å¼€å‘è€…å…‹éš†è‡ªå·±forkå‡ºæ¥çš„ä»“åº“</h5><p>ä¸‹ä¸€æ­¥ï¼Œå„ä¸ªå¼€å‘è€…è¦å…‹éš†è‡ªå·±çš„å…¬å¼€ä»“åº“ï¼Œç”¨ç†Ÿæ‚‰çš„git cloneå‘½ä»¤ã€‚  </p><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œå‡å®šç”¨Bitbucketæ‰˜ç®¡äº†ä»“åº“ã€‚  </p><p>è®°ä½ï¼Œå¦‚æœè¿™æ ·çš„è¯å„ä¸ªå¼€å‘è€…éœ€è¦æœ‰å„è‡ªçš„Bitbucketè´¦å·ï¼Œä½¿ç”¨ä¸‹é¢å‘½ä»¤å…‹éš†æœåŠ¡ç«¯è‡ªå·±çš„ä»“åº“ã€‚  </p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">https</span>://user@bitbucket.org/user/repo.git</span><br></pre></td></tr></table></figure><p>ç›¸æ¯”å‰é¢ä»‹ç»çš„å·¥ä½œæµåªç”¨äº†ä¸€ä¸ªoriginè¿œç¨‹åˆ«åæŒ‡å‘ä¸­å¤®ä»“åº“ï¼ŒForkingå·¥ä½œæµéœ€è¦2ä¸ªè¿œç¨‹åˆ«åâ€”â€”-ä¸€ä¸ªæŒ‡å‘æ­£å¼ä»“åº“ï¼Œå¦ä¸€ä¸ªæŒ‡å‘å¼€å‘è€…è‡ªå·±çš„æœåŠ¡ç«¯ä»“åº“ã€‚  </p><p>åˆ«åçš„åå­—å¯ä»¥ä»»æ„å‘½åï¼Œå¸¸è§çš„çº¦å®šæ˜¯ä½¿ç”¨originä½œä¸ºè¿œç¨‹å…‹éš†çš„ä»“åº“çš„åˆ«åï¼ˆè¿™ä¸ªåˆ«åä¼šåœ¨è¿è¡Œgit cloneè‡ªåŠ¨åˆ›å»ºï¼‰ï¼Œupstreamï¼ˆä¸Šæ¸¸ï¼‰ä½œä¸ºæ­£å¼ä»“åº“çš„åˆ«åã€‚  </p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote <span class="keyword">add</span> upstream https://bitbucket<span class="meta">.org</span>/maintainer/repo</span><br></pre></td></tr></table></figure><p>éœ€è¦è‡ªå·±ç”¨ä¸Šé¢çš„å‘½ä»¤åˆ›å»ºupstreamåˆ«åã€‚  </p><p>è¿™æ ·å¯ä»¥ç®€å•åœ°ä¿æŒæœ¬åœ°ä»“åº“å’Œæ­£å¼ä»“åº“çš„åŒæ­¥æ›´æ–°ã€‚  </p><p>æ³¨æ„ï¼Œå¦‚æœä¸Šæ¸¸ä»“åº“éœ€è¦è®¤è¯ï¼ˆæ¯”å¦‚ä¸æ˜¯å¼€æºçš„ï¼‰ï¼Œä½ éœ€è¦æä¾›ç”¨æˆ·ï¼š  </p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote <span class="keyword">add</span> upstream https://user@bitbucket<span class="meta">.org</span>/maintainer/repo</span><br></pre></td></tr></table></figure><p>è¿™æ—¶åœ¨å…‹éš†å’Œpullæ­£å¼ä»“åº“æ—¶ï¼Œéœ€è¦æä¾›ç”¨æˆ·çš„å¯†ç ã€‚  </p><h5 id="å¼€å‘è€…å¼€å‘è‡ªå·±çš„åŠŸèƒ½"><a href="#å¼€å‘è€…å¼€å‘è‡ªå·±çš„åŠŸèƒ½" class="headerlink" title="å¼€å‘è€…å¼€å‘è‡ªå·±çš„åŠŸèƒ½"></a>å¼€å‘è€…å¼€å‘è‡ªå·±çš„åŠŸèƒ½</h5><p>åœ¨åˆšå…‹éš†çš„æœ¬åœ°ä»“åº“ä¸­ï¼Œå¼€å‘è€…å¯ä»¥å‘å…¶ä»–å·¥ä½œæµä¸€æ ·çš„ç¼–è¾‘ä»£ç ã€æäº¤ä¿®æ”¹å’Œæ–°å»ºåˆ†æ”¯ï¼š  </p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b <span class="built_in">some</span>-<span class="built_in">feature</span></span><br><span class="line">// Edit <span class="built_in">some</span> code</span><br><span class="line">git commit -a -m <span class="string">"Add first draft of some feature"</span></span><br></pre></td></tr></table></figure><p>æ‰€æœ‰çš„ä¿®æ”¹éƒ½æ˜¯ç§æœ‰çš„ç›´åˆ°pushåˆ°è‡ªå·±å…¬å¼€ä»“åº“ä¸­ã€‚  </p><p>å¦‚æœæ­£å¼é¡¹ç›®å·²ç»å‘å‰èµ°äº†ï¼Œå¯ä»¥ç”¨git pullå‘½ä»¤è·å¾—æ–°çš„æäº¤ï¼š  </p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull upstream <span class="literal">master</span></span><br></pre></td></tr></table></figure><p>ç”±äºå¼€å‘è€…åº”è¯¥éƒ½åœ¨ä¸“é—¨çš„åŠŸèƒ½åˆ†æ”¯ä¸Šå·¥ä½œï¼Œpullæ“ä½œç»“æœä¼šéƒ½æ˜¯å¿«è¿›åˆå¹¶ã€‚  </p><h5 id="å¼€å‘è€…å‘å¸ƒè‡ªå·±çš„åŠŸèƒ½"><a href="#å¼€å‘è€…å‘å¸ƒè‡ªå·±çš„åŠŸèƒ½" class="headerlink" title="å¼€å‘è€…å‘å¸ƒè‡ªå·±çš„åŠŸèƒ½"></a>å¼€å‘è€…å‘å¸ƒè‡ªå·±çš„åŠŸèƒ½</h5><p>ä¸€æ—¦å¼€å‘è€…å‡†å¤‡å¥½äº†åˆ†äº«æ–°åŠŸèƒ½ï¼Œéœ€è¦åšä¸¤ä»¶äº‹ã€‚  </p><p>ï¼ˆ1ï¼‰é¦–å…ˆï¼Œé€šè¿‡pushä»–çš„è´¡çŒ®ä»£ç åˆ°è‡ªå·±çš„å…¬å¼€ä»“åº“ä¸­ï¼Œè®©å…¶ä»–çš„å¼€å‘è€…éƒ½å¯ä»¥è®¿é—®åˆ°ã€‚ä»–çš„originè¿œç¨‹åˆ«ååº”è¯¥å·²ç»æœ‰äº†ï¼Œæ‰€æœ‰è¦åšçš„å°±æ˜¯ï¼š  </p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">push</span> <span class="built_in">origin</span>  <span class="built_in">feature</span>-branch</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå’Œä¹‹å‰çš„å·¥ä½œæµçš„å·®å¼‚æ˜¯ï¼Œoriginè¿œç¨‹åˆ«åæŒ‡å‘å¼€å‘è€…è‡ªå·±çš„æœåŠ¡ç«¯ä»“åº“ï¼Œè€Œä¸æ˜¯æ­£å¼ä»“åº“ã€‚  </p><p>ï¼ˆ2ï¼‰ç¬¬äºŒä»¶äº‹ï¼Œå¼€å‘è€…è¦é€šçŸ¥é¡¹ç›®ç»´æŠ¤è€…ï¼Œæƒ³è¦åˆå¹¶ä»–çš„æ–°åŠŸèƒ½åˆ°æ­£å¼åº“ä¸­ã€‚Bitbucketå’ŒStashæä¾›äº†Pull RequestæŒ‰é’®ï¼Œå¼¹å‡ºä¸ªè¡¨å•è®©ä½ æŒ‡å®šå“ªä¸ªåˆ†æ”¯è¦åˆå¹¶åˆ°æ­£å¼ä»“åº“ã€‚ä¸€èˆ¬ä½ ä¼šæƒ³é›†æˆä½ çš„åŠŸèƒ½åˆ†æ”¯åˆ°ä¸Šæ¸¸è¿œç¨‹ä»“åº“çš„masteråˆ†æ”¯ä¸­ã€‚  </p><h5 id="é¡¹ç›®ç»´æŠ¤è€…é›†æˆå¼€å‘è€…çš„åŠŸèƒ½"><a href="#é¡¹ç›®ç»´æŠ¤è€…é›†æˆå¼€å‘è€…çš„åŠŸèƒ½" class="headerlink" title="é¡¹ç›®ç»´æŠ¤è€…é›†æˆå¼€å‘è€…çš„åŠŸèƒ½"></a>é¡¹ç›®ç»´æŠ¤è€…é›†æˆå¼€å‘è€…çš„åŠŸèƒ½</h5><p>å½“é¡¹ç›®ç»´æŠ¤è€…æ”¶åˆ°pull requestæ—¶ï¼Œä»–è¦åšçš„æ˜¯å†³å®šæ˜¯å¦é›†æˆå®ƒåˆ°æ­£å¼ä»£ç åº“ä¸­ã€‚  </p><p>æœ‰ä¸¤ç§æ–¹å¼æ¥åšï¼š  </p><ul><li>ç›´æ¥åœ¨pull requestä¸­æŸ¥çœ‹ä»£ç </li><li>pullä»£ç åˆ°ä»–è‡ªå·±çš„æœ¬åœ°ä»“åº“ï¼Œå†æ‰‹åŠ¨åˆå¹¶</li></ul><p>ç¬¬ä¸€ç§åšæ³•æ›´ç®€å•ï¼Œç»´æŠ¤è€…å¯ä»¥åœ¨GUIä¸­æŸ¥çœ‹å˜æ›´çš„å·®å¼‚ï¼Œåšè¯„æ³¨å’Œæ‰§è¡Œåˆå¹¶ã€‚  </p><p>ä½†å¦‚æœå‡ºç°äº†åˆå¹¶å†²çªï¼Œéœ€è¦ç¬¬äºŒç§åšæ³•æ¥è§£å†³ã€‚  </p><p>è¿™ç§æƒ…å†µä¸‹ï¼Œç»´æŠ¤è€…éœ€è¦ä»å¼€å‘è€…çš„æœåŠ¡ç«¯ä»“åº“ä¸­fetchåŠŸèƒ½åˆ†æ”¯ï¼Œåˆå¹¶åˆ°ä»–æœ¬åœ°çš„masteråˆ†æ”¯ï¼Œè§£å†³å†²çªï¼š  </p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git fetch https:<span class="regexp">//</span>bitbucket.org<span class="regexp">/user/</span>repo feature-branch</span><br><span class="line"><span class="regexp">//</span>æŸ¥çœ‹å˜æ›´</span><br><span class="line">git checkout master</span><br><span class="line">git merge FETCH_HEAD</span><br></pre></td></tr></table></figure><p>å˜æ›´é›†æˆåˆ°æœ¬åœ°çš„masteråˆ†æ”¯åï¼Œç»´æŠ¤è€…è¦pushå˜æ›´åˆ°æœåŠ¡å™¨ä¸Šçš„æ­£å¼ä»“åº“ï¼Œè¿™æ ·å…¶ä»–çš„å¼€å‘è€…éƒ½èƒ½è®¿é—®åˆ°ï¼š  </p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">push</span> <span class="built_in">origin</span> master</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œç»´æŠ¤è€…çš„originæ˜¯æŒ‡å‘ä»–è‡ªå·±å…¬å¼€ä»“åº“çš„ï¼Œå³æ˜¯é¡¹ç›®çš„æ­£å¼ä»£ç åº“ã€‚  </p><p>åˆ°æ­¤ï¼Œå¼€å‘è€…çš„è´¡çŒ®å®Œå…¨é›†æˆåˆ°äº†é¡¹ç›®ä¸­ã€‚  </p><h5 id="å¼€å‘è€…å’Œæ­£å¼ä»“åº“åšåŒæ­¥"><a href="#å¼€å‘è€…å’Œæ­£å¼ä»“åº“åšåŒæ­¥" class="headerlink" title="å¼€å‘è€…å’Œæ­£å¼ä»“åº“åšåŒæ­¥"></a>å¼€å‘è€…å’Œæ­£å¼ä»“åº“åšåŒæ­¥</h5><p>ç”±äºæ­£å¼ä»£ç åº“å¾€å‰èµ°äº†ï¼Œå…¶ä»–çš„å¼€å‘éœ€è¦å’Œæ­£å¼ä»“åº“åšåŒæ­¥ï¼š  </p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull upstream <span class="literal">master</span></span><br></pre></td></tr></table></figure><h4 id="æ€»ç»“-3"><a href="#æ€»ç»“-3" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>å¦‚æœä½ ä¹‹å‰æ˜¯ä½¿ç”¨SVNï¼ŒForkingå·¥ä½œæµå¯èƒ½çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªæ¿€è¿›çš„èŒƒå¼åˆ‡æ¢ï¼ˆparadigm shiftï¼‰ã€‚  </p><p>ä½†æ˜¯ä¸è¦å®³æ€•ï¼Œè¿™ä¸ªå·¥ä½œæµå®é™…ä¸Šå°±æ˜¯åœ¨åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµä¹‹ä¸Šå¼•å…¥äº†å¦ä¸€ä¸ªæŠ½è±¡å±‚ã€‚  </p><p>ä¸æ˜¯ç›´æ¥é€šè¿‡å•ä¸ªä¸­å¤®ä»“åº“æ¥åˆ†äº«åˆ†æ”¯ï¼Œè€Œæ˜¯æŠŠè´¡çŒ®ä»£ç å‘å¸ƒåˆ°å¼€å‘è€…è‡ªå·±çš„æœåŠ¡ç«¯ä»“åº“ä¸­ã€‚  </p><p>ç¤ºä¾‹ä¸­è§£é‡Šäº†ï¼Œä¸€ä¸ªè´¡çŒ®å¦‚ä½•ä»ä¸€ä¸ªå¼€å‘è€…æµåˆ°æ­£å¼çš„masteråˆ†æ”¯ä¸­ï¼Œä½†æ˜¯åŒæ ·çš„æ–¹æ³•å¯ä»¥æŠŠè´¡çŒ®é›†ä¸­åˆ°ä»»æ„ä¸€ä¸ªä»“åº“ä¸­ã€‚  </p><p>æ¯”å¦‚ï¼Œå¦‚æœå›¢é˜Ÿçš„å‡ ä¸ªäººåä½œå®ç°ä¸€ä¸ªåŠŸèƒ½ï¼Œå¯ä»¥åœ¨å¼€å‘ä¹‹é—´ç”¨ç›¸åŒçš„æ–¹æ³•åˆ†äº«å˜æ›´ï¼Œå®Œå…¨ä¸æ¶‰åŠæ­£å¼ä»“åº“ã€‚  </p><p>è¿™ä½¿å¾—Forkingå·¥ä½œæµå¯¹äºæ¾æ•£ç»„ç»‡çš„å›¢é˜Ÿæ¥è¯´æ˜¯ä¸ªéå¸¸å¼ºå¤§çš„å·¥å…·ã€‚  </p><p>ä»»ä¸€å¼€å‘è€…å¯ä»¥æ–¹ä¾¿åœ°å’Œå¦ä¸€å¼€å‘è€…åˆ†äº«å˜æ›´ï¼Œä»»ä½•åˆ†æ”¯éƒ½èƒ½æœ‰æ•ˆåœ°åˆå¹¶åˆ°æ­£å¼ä»£ç åº“ä¸­ã€‚  </p><h3 id="Pull-Requests-2"><a href="#Pull-Requests-2" class="headerlink" title="Pull Requests"></a>Pull Requests</h3><p>Pull Requests æ˜¯Bitbucketä¸Šæ–¹ä¾¿å¼€å‘è€…ä¹‹é—´åä½œçš„åŠŸèƒ½ã€‚  </p><p>æä¾›äº†ä¸€ä¸ªç”¨æˆ·å‹å¥½çš„Webç•Œé¢ï¼Œåœ¨é›†æˆæäº¤çš„å˜æ›´åˆ°æ­£å¼å‘ç›®å‰å¯ä»¥å¯¹å˜æ›´è¿›è¡Œè®¨è®ºã€‚  </p><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANX1zLLMp65VmnavK5XDJUKS6zYUJDvvIJN*Lt1FNUoIJG0DkTCKRNuOGToGtjWmjIrVLu*fSpHVogAtzO4DgCm80!/r" alt="images"></p><p>å¼€å‘è€…å‘å›¢é˜Ÿæˆå‘˜é€šçŸ¥åŠŸèƒ½å¼€å‘å·²ç»å®Œæˆï¼Œpull Requestsæ˜¯æœ€ç®€å•çš„ç”¨æ³•ã€‚  </p><p>å¼€å‘è€…å®ŒæˆåŠŸèƒ½å¼€å‘åï¼Œé€šè¿‡Bitbucketè´¦å·å‘èµ·ä¸€ä¸ªpull Requestã€‚è¿™æ ·è®©æ¶‰åŠè¿™ä¸ªåŠŸèƒ½çš„æ‰€æœ‰äººçŸ¥é“ï¼Œè¦å»åšCode Reviewå’Œåˆå¹¶åˆ°masteråˆ†æ”¯ã€‚  </p><p>ä½†æ˜¯ï¼ŒPull  Requestè¿œä¸æ­¢ä¸€ä¸ªç®€å•çš„é€šçŸ¥ï¼Œè€Œæ˜¯ä¸ºè®¨è®ºæäº¤çš„åŠŸèƒ½çš„ä¸€ä¸ªä¸“é—¨è®ºå›ã€‚  </p><p>å¦‚æœå˜æ›´æœ‰ä»»ä½•é—®é¢˜ï¼Œå›¢é˜Ÿæˆå‘˜åé¦ˆåœ¨Pull Requestä¸­ï¼Œç”šè‡³pullæ–°çš„æäº¤å¾®è°ƒåŠŸèƒ½ã€‚  </p><p>æ‰€æœ‰çš„è¿™äº›æ´»åŠ¨éƒ½ç›´æ¥è·Ÿè¸ªåœ¨Pull Requestä¸­ã€‚  </p><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANX7SLIJSUYxrmcZpwuXYsQB1Ya2zpcBawWJ7atpdZcoSsGWSrxt3XnkjpSfeaAffmHrs3SyEpgZCaBKHAdN3ReSA!/r" alt="images"></p><p>ç›¸æ¯”å…¶ä»–çš„åä½œæ¨¡å‹ï¼Œè¿™ç§åˆ†äº«æäº¤çš„å½¢å¼æœ‰åŠ©äºæ‰“é€ ä¸€ä¸ªæ›´æµç•…çš„å·¥ä½œæµã€‚  </p><p>SVNå’ŒGitéƒ½èƒ½é€šè¿‡ä¸€ä¸ªç®€å•çš„è„šæœ¬æ”¶åˆ°é€šçŸ¥é‚®ä»¶ï¼›  </p><p>ä½†æ˜¯ï¼Œè®¨è®ºå˜æ›´æ—¶ï¼Œå¼€å‘è€…é€šå¸¸åªèƒ½å»å›å¤é‚®ä»¶ã€‚  </p><p>è¿™æ ·åšä¼šå˜å¾—æ‚ä¹±ï¼Œå°¤å…¶è¿˜è¦æ¶‰åŠåé¢çš„å‡ ä¸ªæäº¤æ—¶ã€‚  </p><p>Pull Requestså§æ‰€æœ‰ç›¸å…³åŠŸèƒ½æ•´åˆåˆ°ä¸€ä¸ªå’ŒBitbucketä»“åº“ç•Œé¢é›†æˆçš„ç”¨æˆ·å‹å¥½Webç•Œé¢ä¸­ã€‚  </p><h4 id="è§£æPull-Request"><a href="#è§£æPull-Request" class="headerlink" title="è§£æPull Request"></a>è§£æPull Request</h4><p>å½“è…°å‘èµ·ä¸€ä¸ªpull Requestï¼Œä½ æ‰€è¦åšçš„å°±æ˜¯è¯·æ±‚ï¼ˆRequestï¼‰å¦ä¸€ä¸ªå¼€å‘è€…ï¼ˆæ¯”å¦‚é¡¹ç›®çš„ç»´æŠ¤è€…ï¼‰ï¼Œæ¥pullä½ ä»“åº“ä¸­ä¸€ä¸ªåˆ†æ”¯åˆ°ä»–çš„ä»“åº“ä¸­ã€‚  </p><p>è¿™æ„å‘³ç€ä½ è¦æä¾›4ä¸ªä¿¡æ¯ï¼ˆæºä»“åº“ã€æºåˆ†æ”¯ã€ç›®çš„ä»“åº“ã€ç›®çš„åˆ†æ”¯ï¼‰ï¼Œä»¥å‘èµ·Pull Requestã€‚  </p><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANX7SLIJSUYxrmcZpwuXYsQB1Ya2zpcBawWJ7atpdZcoSsGWSrxt3XnkjpSfeaAffmHrs3SyEpgZCaBKHAdN3ReSA!/r" alt="images"></p><h4 id="å·¥ä½œæ–¹å¼-4"><a href="#å·¥ä½œæ–¹å¼-4" class="headerlink" title="å·¥ä½œæ–¹å¼"></a>å·¥ä½œæ–¹å¼</h4><p>Pull Requestå¯ä»¥å’ŒåŠŸèƒ½åˆ†æ”¯å·¥ä½œæµã€GitFlowå·¥ä½œæµæˆ–Forkingå·¥ä½œæµä¸€èµ·ä½¿ç”¨ã€‚  </p><p>ä½†Pull Requestè¦æ±‚è¦ä¹ˆåˆ†æ”¯ä¸åŒï¼Œè¦ä¹ˆä»“åº“ä¸åŒï¼Œæ‰€ä»¥ä¸èƒ½ç”¨äºé›†ä¸­å¼å·¥ä½œæµã€‚  </p><p>åœ¨ä¸åŒçš„å·¥ä½œæµä¸­ä½¿ç”¨pull  Requestä¼šæœ‰ä¸€äº›ä¸åŒï¼Œä½†åŸºæœ¬çš„è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼š  </p><ul><li>å¼€å‘è€…åœ¨æœ¬åœ°ä»“åº“æ–°å»ºä¸€ä¸ªä¸“é—¨çš„åˆ†æ”¯å¼€å‘åŠŸèƒ½ï¼›</li><li>å¼€å‘è€…pushåˆ†æ”¯ä¿®æ”¹åˆ°å…¬å¼€çš„Bitbucketä»“åº“ä¸­ï¼›</li><li>å¼€å‘è€…é€šè¿‡Bitbucketå‘èµ·ä¸€ä¸ªPull Requestï¼›</li><li>å›¢é˜Ÿçš„å…¶ä»–æˆå‘˜review codeï¼Œè®¨è®ºå¹¶ä¿®æ”¹ï¼›</li><li>é¡¹ç›®ç»´æŠ¤è€…åˆå¹¶åŠŸèƒ½åˆ°å®˜æ–¹ä»“åº“ä¸­å¹¶å…³é—­Pull Requestï¼›</li></ul><h4 id="åœ¨åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµä¸­ä½¿ç”¨Pull-Request"><a href="#åœ¨åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµä¸­ä½¿ç”¨Pull-Request" class="headerlink" title="åœ¨åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµä¸­ä½¿ç”¨Pull Request"></a>åœ¨åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµä¸­ä½¿ç”¨Pull Request</h4><p>åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµç”¨ä¸€ä¸ªå…±äº«çš„Bitbucketä»“åº“æ¥ç®¡ç†åä½œï¼Œå¼€å‘è€…åœ¨ä¸“é—¨çš„åˆ†æ”¯ä¸Šå¼€å‘åŠŸèƒ½ã€‚  </p><p>ä½†ä¸æ˜¯ç«‹å³åˆå¹¶åˆ°masteråˆ†æ”¯ä¸Šï¼Œè€Œæ˜¯åœ¨åˆå¹¶åˆ°ä¸»ä»£ç ä¹‹å‰å¼€å‘è¿™åº”è¯¥å¼€ä¸€ä¸ªPull Requestå‘èµ·åŠŸèƒ½çš„è®¨è®ºã€‚  </p><p>åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµåªæœ‰ä¸€ä¸ªå…¬å¼€çš„ä»“åº“ï¼Œæ‰€ä»¥Pull Requestçš„ç›®çš„ä»“åº“å’Œæºä»“åº“æ€»æ˜¯åŒä¸€ä¸ªã€‚  </p><p>é€šå¸¸å¼€å‘è€…ä¼šæŒ‡å®šä»–çš„åŠŸèƒ½åˆ†æ”¯ä½œä¸ºæºåˆ†æ”¯ï¼Œmasteråˆ†æ”¯ä½œä¸ºç›®çš„åˆ†æ”¯ã€‚  </p><p>æ”¶åˆ°Pull Requeståï¼Œé¡¹ç›®ç»´æŠ¤è€…è¦å†³å®šå¦‚ä½•åšã€‚  </p><p>å¦‚æœåŠŸèƒ½æ²¡é—®é¢˜ï¼Œå°±ç®€å•åœ°åˆå¹¶åˆ°masteråˆ†æ”¯ï¼Œå…³é—­Pull Requestã€‚  </p><p>ä½†å¦‚æœæäº¤çš„å˜æ›´æœ‰é—®é¢˜ï¼Œä»–å¯ä»¥åœ¨Pull Requestä¸­åé¦ˆï¼Œä¹‹åçš„æ–°åŠ çš„è¯„è®ºä¹Ÿä¼šè¯„è®ºä¹‹åæ¥ç€æ˜¾ç¤ºå‡ºæ¥ã€‚  </p><p>åœ¨åŠŸèƒ½è¿˜æ²¡æœ‰å®Œå…¨å¼€å‘å®Œçš„æ—¶å€™ï¼Œä¹Ÿå¯èƒ½å‘èµ·ä¸€ä¸ªpull Requestã€‚  </p><p>æ¯”å¦‚å¼€å‘è€…åœ¨å®ç°æŸä¸ªéœ€æ±‚æ—¶é‡åˆ°äº†éº»çƒ¦ã€‚  </p><p>ä»–å¯ä»¥å‘ä¸€ä¸ªåŒ…å«æ­£åœ¨è¿›è¡Œå·¥ä½œçš„Pull Requestã€‚  </p><p>å…¶ä»–çš„å¼€å‘è€…å¯ä»¥åœ¨Pull Requestæä¾›å»ºè®®ï¼Œæˆ–è€…ç”šè‡³ç›´æ¥æ·»åŠ æäº¤æ¥è§£å†³é—®é¢˜ã€‚  </p><h4 id="åœ¨GitFlowå·¥ä½œæµä¸­ä½¿ç”¨Pull-Request"><a href="#åœ¨GitFlowå·¥ä½œæµä¸­ä½¿ç”¨Pull-Request" class="headerlink" title="åœ¨GitFlowå·¥ä½œæµä¸­ä½¿ç”¨Pull Request"></a>åœ¨GitFlowå·¥ä½œæµä¸­ä½¿ç”¨Pull Request</h4><p>GitFlowå·¥ä½œæµå’ŒåŠŸèƒ½åˆ†æ”¯å·¥ä½œæµç±»ä¼¼ï¼Œå•å›´ç»•é¡¹ç›®å‘å¸ƒå®šä¹‰ä¸€ä¸ªä¸¥æ ¼çš„åˆ†æ”¯æ¨¡å‹ã€‚  </p><p>åœ¨GitFlowå·¥ä½œæµä¸­ä½¿ç”¨Pull Requestè®©å¼€å‘è€…åœ¨å‘å¸ƒåˆ†æ”¯æˆ–è€…æ˜¯ç»´æŠ¤åˆ†æ”¯ä¸Šå·¥ä½œæ—¶ï¼Œå¯ä»¥æœ‰ä¸ªæ–¹ä¾¿çš„åœ°æ–¹å¯¹å…³äºå‘å¸ƒåˆ†æ”¯æˆ–è€…æ˜¯ç»´æŠ¤åˆ†æ”¯çš„é—®é¢˜è¿›è¡Œäº¤æµã€‚  </p><p>GitFlowå·¥ä½œæµä¸­Pull Requestçš„ä½¿ç”¨è¿‡ç¨‹å’Œä¸Šä¸€èŠ‚ä¸­å®Œå…¨ä¸€è‡´ï¼šå½“ä¸€ä¸ªåŠŸèƒ½ã€å‘å¸ƒæˆ–è€…æ˜¯çƒ­ä¿®å¤åˆ†æ”¯éœ€è¦Reviewæ—¶ï¼Œå¼€å‘è€…ç®€å•å‘èµ·ä¸€ä¸ªPull Requestï¼Œå›¢é˜Ÿçš„å…¶ä»–æˆå‘˜ä¼šé€šè¿‡Bitbucketæ”¶åˆ°é€šçŸ¥ã€‚  </p><p>æ–°åŠŸèƒ½ä¸€èˆ¬åˆå¹¶åˆ°developåˆ†æ”¯ï¼Œè€Œå‘å¸ƒå’Œçƒ­ä¿®å¤åˆ™è¦åŒæ—¶åˆå¹¶åˆ°developåˆ†æ”¯å’Œmasteråˆ†æ”¯ä¸Šã€‚  </p><p>Pull Requestå¯èƒ½ç”¨ä½œæ‰€æœ‰åˆå¹¶çš„æ­£å¼ç®¡ç†ã€‚  </p><h4 id="åœ¨Forkingå·¥ä½œæµä¸­ä½¿ç”¨Pull-Request"><a href="#åœ¨Forkingå·¥ä½œæµä¸­ä½¿ç”¨Pull-Request" class="headerlink" title="åœ¨Forkingå·¥ä½œæµä¸­ä½¿ç”¨Pull Request"></a>åœ¨Forkingå·¥ä½œæµä¸­ä½¿ç”¨Pull Request</h4><p>åœ¨Forkingå·¥ä½œæµä¸­ï¼Œå¼€å‘è€…pushå®Œæˆçš„åŠŸèƒ½åˆ°ä»–è‡ªå·±çš„ä»“åº“ä¸­ï¼Œè€Œä¸æ˜¯å…±äº«ä»“åº“ã€‚  </p><p>ç„¶åï¼Œä»–å‘ä¸€ä¸ªPull  Requestï¼Œè®©é¡¹ç›®ç»´æŠ¤è€…çŸ¥é“ä»–çš„åŠŸèƒ½å·²ç»å¯ä»¥Reviewäº†ã€‚  </p><p>åœ¨è¿™ä¸ªå·¥ä½œæµï¼ŒPull Requestçš„é€šçŸ¥åŠŸèƒ½éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºé¡¹ç›®ç»´æŠ¤è€…ä¸å¯èƒ½çŸ¥é“å…¶ä»–å¼€å‘è€…åœ¨ä»–ä»¬è‡ªå·±çš„ä»“åº“æ·»åŠ äº†æäº¤ã€‚  </p><p>ç”±äºå„ä¸ªå¼€å‘è€…æœ‰è‡ªå·±çš„å…¬å¼€ä»“åº“ï¼ŒPull Requestçš„æºä»“åº“å’Œç›®æ ‡ä»“åº“ä¸æ˜¯åŒä¸€ä¸ªã€‚  </p><p>æºä»“åº“æ˜¯å¼€å‘è€…çš„å…¬å¼€ä»“åº“ï¼Œæºåˆ†æ”¯æ˜¯åŒ…å«äº†ä¿®æ”¹çš„åˆ†æ”¯ã€‚  </p><p>å¦‚æœå¼€å‘è€…è¦åˆå¹¶ä¿®æ”¹åˆ°æ­£å¼ä»£ç åº“ä¸­ï¼Œé‚£ä¹ˆç›®æ ‡ä»“åº“æ˜¯æ­£å¼ä»“åº“ï¼Œç›®æ ‡åˆ†æ”¯æ˜¯masteråˆ†æ”¯ã€‚  </p><p>Pull Requestä¹Ÿå¯ä»¥ç”¨äºæ­£å¼é¡¹ç›®ä¹‹å¤–çš„å…¶ä»–å¼€å‘è€…ä¹‹é—´çš„åä½œã€‚  </p><p>æ¯”å¦‚ï¼Œå¦‚æœä¸€ä¸ªå¼€å‘è€…å’Œä¸€ä¸ªå›¢é˜Ÿæˆå‘˜ä¸€èµ·å¼€å‘ä¸€ä¸ªåŠŸèƒ½ï¼Œä»–ä»¬å¯ä»¥å‘èµ·ä¸€ä¸ªPull Requestï¼Œç”¨å›¢é˜Ÿæˆå‘˜çš„Bitbucketä»“åº“ä½œä¸ºç›®æ ‡ï¼Œè€Œä¸æ˜¯æ­£å¼é¡¹ç›®çš„ä»“åº“ã€‚  </p><p>ç„¶åä½¿ç”¨ç›¸åŒçš„åŠŸèƒ½åˆ†æ”¯ä½œä¸ºæºå’Œç›®æ ‡åˆ†æ”¯ã€‚  </p><p>2ä¸ªå¼€å‘è€…ä¹‹é—´å¯ä»¥åœ¨Pull Requestä¸­è®¨è®ºå’Œå¼€å‘åŠŸèƒ½ã€‚  </p><p>å®Œæˆå¼€å‘åï¼Œä»–ä»¬å¯ä»¥å‘èµ·å¦ä¸€ä¸ªPull  Requestï¼Œè¯·æ±‚åˆå¹¶åŠŸèƒ½åˆ°æ­£å¼çš„masteråˆ†æ”¯ã€‚  </p><p>åœ¨Forkingå·¥ä½œæµä¸­ï¼Œè¿™æ ·çš„çµæ´»æ€§ç§°ä¸ºä¸€ä¸ªå¼ºæœ‰åŠ›çš„åä½œå·¥å…·ã€‚  </p><h4 id="ç¤ºä¾‹-4"><a href="#ç¤ºä¾‹-4" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><p>ä¸‹é¢çš„ç¤ºä¾‹æ¼”ç¤ºäº†Pull Requestå¦‚ä½•åœ¨Forkingå·¥ä½œæµä¸­ä½¿ç”¨ã€‚  </p><p>ä¹ŸåŒæ ·é€‚ç”¨äºå°å›¢é˜Ÿçš„å¼€å‘åä½œå’Œç¬¬ä¸‰æ–¹å¼€å‘è€…å‘å¼€æºé¡¹ç›®çš„è´¡çŒ®ã€‚  </p><p>åœ¨ç¤ºä¾‹ä¸­ï¼Œå°çº¢æ˜¯ä¸ªå¼€å‘ï¼Œå°æ˜æ˜¯é¡¹ç›®ç»´æŠ¤è€…ã€‚  </p><p>ä»–ä»¬å„è‡ªæœ‰ä¸€ä¸ªå…¬å¼€çš„Bitbucketä»“åº“ï¼Œè€Œå°æ˜çš„ä»“åº“åŒ…å«äº†æ­£å¼å·¥ç¨‹ã€‚  </p><h5 id="å°çº¢forkæ­£å¼é¡¹ç›®"><a href="#å°çº¢forkæ­£å¼é¡¹ç›®" class="headerlink" title="å°çº¢forkæ­£å¼é¡¹ç›®"></a>å°çº¢forkæ­£å¼é¡¹ç›®</h5><p>å°çº¢å…ˆè¦forkå°æ˜çš„Bitbucketä»“åº“ï¼Œå¼€å§‹é¡¹ç›®çš„å¼€å‘ã€‚  </p><p>å¥¹ç™»å½•Bitbucketï¼Œæµè§ˆåˆ°å°æ˜çš„ä»“åº“é¡µé¢ï¼Œç‚¹forkæŒ‰é’®ã€‚  </p><p>ç„¶åä¸ºforkå‡ºæ¥çš„ä»“åº“å¡«å†™åå­—å’Œæè¿°ï¼Œè¿™æ ·å°çº¢å°±æœ‰äº†æœåŠ¡ç«¯çš„é¡¹ç›®æ‹·è´äº†ã€‚  </p><h5 id="å°çº¢å…‹éš†å¥¹çš„Bitbucketä»“åº“"><a href="#å°çº¢å…‹éš†å¥¹çš„Bitbucketä»“åº“" class="headerlink" title="å°çº¢å…‹éš†å¥¹çš„Bitbucketä»“åº“"></a>å°çº¢å…‹éš†å¥¹çš„Bitbucketä»“åº“</h5><p>ä¸‹ä¸€æ­¥ï¼Œå°çº¢å…‹éš†è‡ªå·±åˆšæ‰forkå‡ºæ¥çš„Bitbucketä»“åº“ï¼Œä»¥åœ¨æœ¬æœºä¸Šå‡†å¤‡å‡ºå·¥ä½œæ‹·è´ã€‚  </p><p>å‘½ä»¤å¦‚ä¸‹ï¼š  </p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">https</span>://user@bitbucket.org/user/repo.git</span><br></pre></td></tr></table></figure><p>è¯·è®°ä½ï¼Œgit clone ä¼šè‡ªåŠ¨åˆ›å»ºoriginè¿œç¨‹åˆ«åï¼Œæ˜¯æŒ‡å‘å°çº¢forkå‡ºæ¥çš„ä»“åº“ã€‚  </p><h5 id="å°çº¢å¼€å‘æ–°åŠŸèƒ½"><a href="#å°çº¢å¼€å‘æ–°åŠŸèƒ½" class="headerlink" title="å°çº¢å¼€å‘æ–°åŠŸèƒ½"></a>å°çº¢å¼€å‘æ–°åŠŸèƒ½</h5><p>åœ¨å¼€å§‹æ”¹ä»£ç å‰ï¼Œå°çº¢è¦ä¸ºæ–°åŠŸèƒ½æ–°å»ºä¸€ä¸ªæ–°åˆ†æ”¯ã€‚  </p><p>å¥¹ä¼šç”¨è¿™ä¸ªåˆ†æ”¯ä½œä¸ºPull Requestçš„æºåˆ†æ”¯ã€‚  </p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b <span class="built_in">some</span>-<span class="built_in">feature</span></span><br></pre></td></tr></table></figure><h5 id="ç¼–è¾‘ä»£ç "><a href="#ç¼–è¾‘ä»£ç " class="headerlink" title="ç¼–è¾‘ä»£ç "></a>ç¼–è¾‘ä»£ç </h5><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -<span class="keyword">a</span> -m <span class="string">"Add first draft of some feature"</span></span><br></pre></td></tr></table></figure><p>åœ¨æ–°åŠŸèƒ½åˆ†æ”¯ä¸Šï¼Œå°çº¢æŒ‰ç…§éœ€è¦æ·»åŠ æäº¤ã€‚  </p><p>ç”šè‡³å¦‚æœå°çº¢è§‰å¾—åŠŸèƒ½åˆ†æ”¯ä¸Šçš„æäº¤å†å²å¤ªä¹±äº†ï¼Œå¥¹å¯ä»¥ç”¨äº¤äº’å¼rebaseæ¥åˆ é™¤æˆ–è€…å‹åˆ¶æäº¤ã€‚  </p><p>å¯¹äºå¤§å‹é¡¹ç›®ï¼Œæ•´ç†åŠŸèƒ½åˆ†æ”¯çš„å†å²å¯ä»¥è®©é¡¹ç›®ç»´æŠ¤è€…æ›´å®¹æ˜“çœ‹å‡ºåœ¨pull Requestä¸­åšäº†ä»€ä¹ˆå†…å®¹ã€‚  </p><h5 id="å°çº¢pushåŠŸèƒ½åˆ°å¥¹çš„Bitbucketä»“åº“ä¸­"><a href="#å°çº¢pushåŠŸèƒ½åˆ°å¥¹çš„Bitbucketä»“åº“ä¸­" class="headerlink" title="å°çº¢pushåŠŸèƒ½åˆ°å¥¹çš„Bitbucketä»“åº“ä¸­"></a>å°çº¢pushåŠŸèƒ½åˆ°å¥¹çš„Bitbucketä»“åº“ä¸­</h5><p>å°çº¢å®ŒæˆåŠŸèƒ½åï¼ŒpushåŠŸèƒ½åˆ°å¥¹è‡ªå·±çš„Bitbucketä»“åº“ä¸­ï¼ˆä¸æ˜¯æ­£æ˜¯ä»“åº“ï¼‰ï¼Œç”¨ä¸‹é¢ç®€å•çš„å‘½ä»¤ã€‚  </p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">push</span> <span class="built_in">origin</span> <span class="built_in">some</span>-branch</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å¥¹çš„å˜æ›´å¯ä»¥è®©é¡¹ç›®ç»´æŠ¤è€…çœ‹åˆ°äº†ï¼ˆåè€…ä»»ä½•æƒ³è¦çœ‹çš„åä½œè€…ï¼‰  </p><h5 id="å°çº¢å‘èµ·Pull-Request"><a href="#å°çº¢å‘èµ·Pull-Request" class="headerlink" title="å°çº¢å‘èµ·Pull Request"></a>å°çº¢å‘èµ·Pull Request</h5><p>Bitbucketä¸Šæœ‰äº†å¥¹çš„åŠŸèƒ½åˆ†æ”¯åï¼Œå°çº¢å¯ä»¥ç”¨å¥¹çš„Bitbucketè´¦å·æµè§ˆåˆ°å¥¹forkå‡ºæ¥çš„ä»“åº“é¡µé¢ï¼Œç‚¹å³ä¸Šè§’çš„[ Pull Request ]æŒ‰é’®ï¼Œå‘èµ·ä¸€ä¸ªPull Requestã€‚  </p><p>å¼¹å‡ºçš„è¡¨å•è‡ªåŠ¨è®¾ç½®å°çº¢çš„ä»“åº“ä¸ºæºä»“åº“ï¼Œè¯¢é—®å°çº¢ä»¥æŒ‡å®šæºåˆ†æ”¯ã€ç›®æ ‡ä»“åº“å’Œç›®æ ‡åˆ†æ”¯ã€‚  </p><p>å°çº¢æƒ³è¦åˆå¹¶åŠŸèƒ½åˆ°æ­£å¼ä»“åº“ï¼Œæ‰€ä»¥æºåˆ†æ”¯æ˜¯å¥¹çš„åŠŸèƒ½åˆ†æ”¯ï¼Œç›®æ ‡ä»“åº“æ˜¯å°æ˜çš„å…¬å¼€ä»“åº“ï¼Œè€Œç›®æ ‡åˆ†æ”¯æ˜¯masteråˆ†æ”¯ã€‚  </p><p>å¦å¤–ï¼Œå°çº¢éœ€è¦æä¾›Pull Requestçš„æ ‡é¢˜å’Œæè¿°ä¿¡æ¯ã€‚  </p><p>å¦‚æœéœ€è¦å°æ˜ä»¥å¤–çš„äººå®¡æ ¸æ‰¹å‡†diamanteï¼Œå¥¹å¯ä»¥æŠŠè¿™äº›äººå¡«åœ¨[ Reviewers ]æ–‡æœ¬æ¡†ä¸­ã€‚  </p><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANX4eBUNEH.PnD8cXLFX3FNQ1TY28uOV3j2Ic*FLo6qk1HERoVGDzy.ccPi6KWHQ1Ha7aF4qrprhr6a71aswRPe1s!/r" alt="images"></p><p>åˆ›å»ºå¥½äº†Pull Requestï¼Œé€šçŸ¥ä¼šé€šè¿‡Bitbucketç³»ç»Ÿæ¶ˆæ¯æˆ–è€…é‚®ä»¶ï¼ˆå¯é€‰ï¼‰å‘ç»™å°æ˜ã€‚  </p><h5 id="å°æ˜-review-Pull-Request"><a href="#å°æ˜-review-Pull-Request" class="headerlink" title="å°æ˜ review Pull Request"></a>å°æ˜ review Pull Request</h5><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANXz.TEdJt9fHfFvRXR*aihUCZBZl8OSFD1T7r*7GIRRSRDePO5EI5YO0pxG7Qo02eHht0.LfxlnFiUPPKgPzRY4U!/r" alt="images"></p><p>åœ¨å°æ˜çš„Bitbucketä»“åº“é¡µé¢çš„[ Pull Request ]Tabå¯ä»¥çœ‹åˆ°æ‰€æœ‰äººå‘èµ·çš„Pull Requestã€‚  </p><p>ç‚¹å‡»å°çº¢çš„Pull Requestä¼šæ˜¾ç¤ºPull Requestçš„æè¿°ã€åŠŸèƒ½çš„æäº¤å†å²å’Œæ¯ä¸ªå˜æ›´çš„å·®å¼‚ï¼ˆdiffï¼‰ã€‚  </p><p>å¦‚æœå°æ˜æƒ³è¦åˆå¹¶åˆ°é¡¹ç›®ä¸­ï¼Œåªè¦ç‚¹ä¸€ä¸‹[ Merge ]æŒ‰é’®ï¼Œå°±å¯ä»¥åŒæ„Pull Requestå¹¶åˆå¹¶åˆ°masteråˆ†æ”¯ã€‚  </p><p>ä½†å¦‚æœåƒè¿™ä¸ªç¤ºä¾‹ä¸­ä¸€æ ·ï¼Œå°æ˜å‘ç°äº†åœ¨å°çº¢çš„ä»£ç ä¸­çš„ä¸€ä¸ªå°Bugï¼Œè¦åœ¨å°çº¢åˆå¹¶å‰ä¿®å¤ã€‚  </p><p>å°æ˜å¯ä»¥åœ¨æ•´ä¸ªPull Requestä¸ŠåŠ ä¸Šè¯„æ³¨ï¼Œæˆ–è€…æ˜¯é€‰æ‹©å†å²ä¸­çš„æŸä¸ªæäº¤åŠ ä¸Šè¯„æ³¨ã€‚  </p><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANXywJcEdXUnF5drr2Tn8vpOshxucsOMz.iW9qg*vXiM80CBz6VcPZTn4e7NC2txFi9Xf.oe9HyW39vilYdBhizv0!/r" alt="images"></p><h5 id="å°çº¢è¡¥åŠ æäº¤"><a href="#å°çº¢è¡¥åŠ æäº¤" class="headerlink" title="å°çº¢è¡¥åŠ æäº¤"></a>å°çº¢è¡¥åŠ æäº¤</h5><p>å¦‚æœå°çº¢å¯¹åé¦ˆæœ‰ä»»ä½•ç–‘é—®ï¼Œå¯ä»¥åœ¨Pull Requestä¸­å“åº”ï¼ŒæŠŠPull Requestå½“åšæ˜¯å¥¹åŠŸèƒ½è®¨è®ºçš„è®ºå›ã€‚  </p><p>å°çº¢åœ¨å¥¹çš„åŠŸèƒ½åˆ†æ”¯æ–°åŠ æäº¤ä»¥è§£å†³ä»£ç é—®é¢˜ï¼Œå¹¶pushåˆ°å¥¹çš„Bitbucketä»“åº“ä¸­ï¼Œå°±åƒå‰ä¸€è½®ä¸­çš„åšé¥­ä¸€æ ·ã€‚  </p><p>è¿™äº›æäº¤ä¼šè¿›å…¥åˆ°Pull Requestï¼Œå°æ˜åœ¨åŸæ¥çš„è¯„æ³¨æ—è¾¹å¯ä»¥å†æ¬¡Review å˜æ›´ã€‚  </p><h5 id="å°æ˜æ¥å—Pull-Request"><a href="#å°æ˜æ¥å—Pull-Request" class="headerlink" title="å°æ˜æ¥å—Pull Request"></a>å°æ˜æ¥å—Pull Request</h5><p>æœ€ç»ˆï¼Œå°æ˜æ¥å—å˜æ›´ï¼Œåˆå¹¶åŠŸèƒ½åˆ†æ”¯åˆ°masteråˆ†æ”¯ï¼Œå¹¶å…³é—­Pull Requestã€‚  </p><p>è‡³æ­¤ï¼ŒåŠŸèƒ½é›†æˆåˆ°é¡¹ç›®ä¸­ï¼Œå…¶ä»–çš„é¡¹ç›®å¼€å‘è€…å¯ä»¥ç”¨æ ‡å‡†çš„git pullå‘½ä»¤pullè¿™äº›å˜æ›´åˆ°è‡ªå·±çš„æœ¬åœ°ä»“åº“ä¸­ã€‚  </p><h4 id="æ€»ç»“-4"><a href="#æ€»ç»“-4" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>åˆ°äº†è¿™é‡Œï¼Œä½ åº”è¯¥æœ‰äº†æ‰€æœ‰éœ€è¦çš„å·¥å…·æ¥é›†æˆPull Requeståˆ°ä½ è‡ªå·±çš„å·¥ä½œæµã€‚  </p><p>è¯·è®°ä½ï¼ŒPull Requestå¹¶ä¸æ˜¯ä¸ºäº†æ›¿ä»£ä»»ä½•åŸºäºGitçš„åä½œå·¥ä½œæµï¼Œè€Œæ˜¯å®ƒä»¬çš„ä¸€ä¸ªä¾¿åˆ©çš„è¡¥å……ï¼Œè®©å›¢é˜Ÿæˆå‘˜é—´çš„åä½œæ›´åŠ è½»æ¾æ–¹ä¾¿ã€‚  </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Gitå·¥ä½œæµæŒ‡å—-åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ&quot;&gt;&lt;a href=&quot;#Gitå·¥ä½œæµæŒ‡å—-åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ&quot; class=&quot;headerlink&quot; title=&quot;Gitå·¥ä½œæµæŒ‡å— åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ&quot;&gt;&lt;/a&gt;Gitå·¥ä½œæµæŒ‡å— åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ&lt;/h2&gt;&lt;p&gt;è§‚çœ‹ç¬”è®°ï¼š&lt;
      
    
    </summary>
    
    
      <category term="ç¬”è®°" scheme="https://fengshana.github.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="ç¬”è®°" scheme="https://fengshana.github.io/tags/%E7%AC%94%E8%AE%B0/"/>
    
      <category term="Gitå·¥ä½œæµ" scheme="https://fengshana.github.io/tags/Git%E5%B7%A5%E4%BD%9C%E6%B5%81/"/>
    
  </entry>
  
  <entry>
    <title>å‰ç«¯é¡µé¢åŒè‰²çƒ3</title>
    <link href="https://fengshana.github.io/2020/05/27/%E3%80%90%E5%91%A8%E5%BD%A4%E5%BD%A4%E3%80%91/%E3%80%90%E5%91%A8%E5%BD%A4%E5%BD%A4%E3%80%91%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E6%94%B9%E8%BF%9B3/"/>
    <id>https://fengshana.github.io/2020/05/27/%E3%80%90%E5%91%A8%E5%BD%A4%E5%BD%A4%E3%80%91/%E3%80%90%E5%91%A8%E5%BD%A4%E5%BD%A4%E3%80%91%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E6%94%B9%E8%BF%9B3/</id>
    <published>2020-05-27T10:34:19.831Z</published>
    <updated>2020-06-05T17:58:23.170Z</updated>
    
    <content type="html"><![CDATA[<h2 id="éœ€æ±‚å†…å®¹"><a href="#éœ€æ±‚å†…å®¹" class="headerlink" title="éœ€æ±‚å†…å®¹"></a>éœ€æ±‚å†…å®¹</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">1. åˆ†é¡µåŠ ä¸ªé¡µç </span><br><span class="line">2. è¿™ä¸ª10å‡ºè¿‡äº†å¾ˆå¤šæœŸçš„ï¼Œæœ€è¿‘çš„è¿™ä¸€æœŸ130ï¼Œ4.10ï¼Œåˆ°ä»Šå¤©æœ€æ–°çš„ä¸€æœŸä¸ç®¡æ•°å€¼å¤šå°‘ï¼Œä¸ºæ­¢å·²ç»å¤šå°‘æœŸæ²¡å‡ºäº†ï¼Œæ±‚å·®å€¼</span><br><span class="line">3. æŠŠæœç´¢çš„æ•°å­—åŠ ä¸ªçº¢è‰²ä¹Ÿè¡Œ</span><br><span class="line"></span><br><span class="line">### æ•ˆæœå›¾</span><br><span class="line"></span><br><span class="line">![image](http:&#x2F;&#x2F;r.photo.store.qq.com&#x2F;psc?&#x2F;V13IdniL0W0T32&#x2F;TCfiP1YaPeRT4Jil9RANX0OntByQ9RopVFKqFo2EAAP.w*ru3lHqrrQXKPPvOiJcpxdOfhwHYah.is4YlEKT.jSTullaIqHR6PMItPvTZnk!&#x2F;r)</span><br><span class="line">![image](http:&#x2F;&#x2F;r.photo.store.qq.com&#x2F;psc?&#x2F;V13IdniL0W0T32&#x2F;TCfiP1YaPeRT4Jil9RANX6NdBhxBRYBUy.T6WIURM8FztiZEk0bzwnUWuk2wwu0zeYpSbcbz.bcVfsU6GZo8tyfIU60tglNtx0E4zdfuFgM!&#x2F;r)</span><br><span class="line">![image](http:&#x2F;&#x2F;r.photo.store.qq.com&#x2F;psc?&#x2F;V13IdniL0W0T32&#x2F;TCfiP1YaPeRT4Jil9RANX.hsLuSnbnm1WocRcndLv9YK0y2Ojuh2G*eAAF14QcltwhNkZ.r8foxuxlNiqT.LK0X4HY7fncWH*Ik9RrigLc8!&#x2F;r)</span><br><span class="line"></span><br><span class="line">### æ¥è§¦dockerå¹¶éƒ¨ç½²é¡¹ç›®</span><br><span class="line"></span><br><span class="line">è¿™è¾¹æ˜¯å°†é¡¹ç›®æ‰“åŒ…æˆjaråŒ…éƒ¨ç½²linuxç¯å¢ƒå½“ä¸­çš„dockerå®¹å™¨å†…</span><br><span class="line"></span><br><span class="line">å‚è€ƒBlogï¼š</span><br><span class="line">* &#96;&#96;&#96;https:&#x2F;&#x2F;www.jianshu.com&#x2F;p&#x2F;397929dbc27d</span><br></pre></td></tr></table></figure><p>ç›¸å…³å‘½ä»¤ï¼š</p><p>docker ps -a<br>docker images<br>docker stop é•œåƒçš„åç§°<br>docker start é•œåƒçš„åç§°</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">432 </span> cd ../logs/</span><br><span class="line"><span class="symbol">433 </span> tail -<span class="number">300</span>f access.<span class="keyword">log</span></span><br><span class="line"><span class="symbol">434 </span> ../sbin/nginx -s quit</span><br><span class="line"><span class="symbol">435 </span> ../sbin/nginx -s <span class="keyword">stop</span></span><br><span class="line"><span class="symbol">436 </span> cd ../conf</span><br><span class="line"><span class="symbol">437 </span> vim nginx.conf</span><br><span class="line"><span class="symbol">438 </span> ../sbin/nginx -s reload</span><br><span class="line"><span class="symbol">439 </span> /<span class="keyword">usr</span>/local/nginx/sbin/nginx -c /<span class="keyword">usr</span>/local/nginx/conf/nginx.conf</span><br><span class="line"><span class="symbol">440 </span> ../sbin/nginx -s reload</span><br><span class="line"><span class="symbol">441 </span> vim nginx.conf</span><br><span class="line"><span class="symbol">442 </span> ../sbin/nginx -s reload</span><br><span class="line"><span class="symbol">443 </span> vim nginx.conf</span><br><span class="line"><span class="symbol">444 </span> ../sbin/nginx  -s reload</span><br><span class="line"><span class="symbol">445 </span> vim nginx.conf</span><br><span class="line"><span class="symbol">446 </span> cd </span><br><span class="line"><span class="symbol">447 </span> ll</span><br><span class="line"><span class="symbol">448 </span> cd apache-tomcat-<span class="number">8.5.51</span>/</span><br><span class="line"><span class="symbol">449 </span> ll</span><br><span class="line"><span class="symbol">450 </span> ccd logs/</span><br><span class="line"><span class="symbol">451 </span> ll</span><br><span class="line"><span class="symbol">452 </span> cd logs/</span><br><span class="line"><span class="symbol">453 </span> ll</span><br><span class="line"><span class="symbol">454 </span> cd ..</span><br><span class="line"><span class="symbol">455 </span> ll</span><br><span class="line"><span class="symbol">456 </span> cd ..</span><br><span class="line"><span class="symbol">457 </span> ll</span><br><span class="line"><span class="symbol">458 </span> more install.sh </span><br><span class="line"><span class="symbol">459 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">460 </span> cd /<span class="keyword">usr</span>/local/nginx/</span><br><span class="line"><span class="symbol">461 </span> ll</span><br><span class="line"><span class="symbol">462 </span> cd conf</span><br><span class="line"><span class="symbol">463 </span> more nginx.conf</span><br><span class="line"><span class="symbol">464 </span> vim nginx.conf</span><br><span class="line"><span class="symbol">465 </span> ../sbin/nginx -s reload</span><br><span class="line"><span class="symbol">466 </span> ll</span><br><span class="line"><span class="symbol">467 </span> ps -ef |grep  java</span><br><span class="line"><span class="symbol">468 </span> <span class="keyword">kill</span> -<span class="number">9</span> <span class="number">23983</span></span><br><span class="line"><span class="symbol">469 </span> ll</span><br><span class="line"><span class="symbol">470 </span> <span class="keyword">kill</span> -<span class="number">9</span> <span class="number">23983</span></span><br><span class="line"><span class="symbol">471 </span> ps -ef |grep  java</span><br><span class="line"><span class="symbol">472 </span> <span class="keyword">kill</span> -<span class="number">9</span> <span class="number">703</span></span><br><span class="line"><span class="symbol">473 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">474 </span> ll</span><br><span class="line"><span class="symbol">475 </span> <span class="keyword">mkdir</span> docker</span><br><span class="line"><span class="symbol">476 </span> ll</span><br><span class="line"><span class="symbol">477 </span> cd docker/</span><br><span class="line"><span class="symbol">478 </span> ll</span><br><span class="line"><span class="symbol">479 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">480 </span> cd ..</span><br><span class="line"><span class="symbol">481 </span> ll</span><br><span class="line"><span class="symbol">482 </span> cp Mamai-<span class="number">1.0</span>-SNAPSHOT.jar docker/</span><br><span class="line"><span class="symbol">483 </span> ll</span><br><span class="line"><span class="symbol">484 </span> cd docker/</span><br><span class="line"><span class="symbol">485 </span> ll</span><br><span class="line"><span class="symbol">486 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">487 </span> pwd</span><br><span class="line"><span class="symbol">488 </span> ll</span><br><span class="line"><span class="symbol">489 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">490 </span> docker build -t springbootdemo4docker .</span><br><span class="line"><span class="symbol">491 </span> docker images</span><br><span class="line"><span class="symbol">492 </span> docker <span class="keyword">run</span> -d -p <span class="number">8080</span>:<span class="number">8080</span> springbootdemo4docker</span><br><span class="line"><span class="symbol">493 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">494 </span> ps -ef |grep java</span><br><span class="line"><span class="symbol">495 </span> docker logs --tail <span class="number">300</span> -f demo</span><br><span class="line"><span class="symbol">496 </span> docker ps</span><br><span class="line"><span class="symbol">497 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">498 </span> netstat -na</span><br><span class="line"><span class="symbol">499 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">500 </span> ps -ef|grep java</span><br><span class="line"><span class="symbol">501 </span> ll</span><br><span class="line"><span class="symbol">502 </span> more Dockerfile </span><br><span class="line"><span class="symbol">503 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">504 </span> docker-compose exec java bash</span><br><span class="line"><span class="symbol">505 </span> cd /<span class="keyword">usr</span>/local/bin/</span><br><span class="line"><span class="symbol">506 </span> docker-compose exec java bash</span><br><span class="line"><span class="symbol">507 </span> ll</span><br><span class="line"><span class="symbol">508 </span> netstat -lnp|grep <span class="number">8080</span></span><br><span class="line"><span class="symbol">509 </span> ll</span><br><span class="line"><span class="symbol">510 </span> cd /<span class="keyword">usr</span>/local/nginx/conf</span><br><span class="line"><span class="symbol">511 </span> vim nginx.conf</span><br><span class="line"><span class="symbol">512 </span> ../sbin/nginx -s reload</span><br><span class="line"><span class="symbol">513 </span> vim nginx.conf</span><br><span class="line"><span class="symbol">514 </span> ../sbin/nginx -s reload</span><br><span class="line"><span class="symbol">515 </span> ll</span><br><span class="line"><span class="symbol">516 </span> cd apache-tomcat-<span class="number">8.5.51</span>/</span><br><span class="line"><span class="symbol">517 </span> ll</span><br><span class="line"><span class="symbol">518 </span> cd ..</span><br><span class="line"><span class="symbol">519 </span> ll</span><br><span class="line"><span class="symbol">520 </span> rm -rf apache-tomcat-<span class="number">8.5.51</span>/</span><br><span class="line"><span class="symbol">521 </span> ll</span><br><span class="line"><span class="symbol">522 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">523 </span> ll</span><br><span class="line"><span class="symbol">524 </span> wget https://mirrors.cnnic.cn/apache/tomcat/tomcat-<span class="number">9</span>/v9.<span class="number">0.7</span>/bin/apache-tomcat-<span class="number">9.0.7.</span>tar.gz</span><br><span class="line"><span class="symbol">525 </span> wget https://archive.apache.org/dist/tomcat/tomcat-<span class="number">8</span>/v8.<span class="number">0.23</span>/bin/apache-tomcat-<span class="number">8.0.23.</span>tar.gz</span><br><span class="line"><span class="symbol">526 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">527 </span> ll</span><br><span class="line"><span class="symbol">528 </span> tar -zxvf apache-tomcat-<span class="number">8.0.23.</span>tar.gz </span><br><span class="line"><span class="symbol">529 </span> ll</span><br><span class="line"><span class="symbol">530 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">531 </span> ll</span><br><span class="line"><span class="symbol">532 </span> cd apache-tomcat-<span class="number">8.0.23</span></span><br><span class="line"><span class="symbol">533 </span> ll</span><br><span class="line"><span class="symbol">534 </span> cd webapps/</span><br><span class="line"><span class="symbol">535 </span> ll</span><br><span class="line"><span class="symbol">536 </span> rm -rf docs/</span><br><span class="line"><span class="symbol">537 </span> rm -rf examples/</span><br><span class="line"><span class="symbol">538 </span> rm -rf host-manager/</span><br><span class="line"><span class="symbol">539 </span> rm -rf manager/</span><br><span class="line"><span class="symbol">540 </span> rm -rf ROOT/</span><br><span class="line"><span class="symbol">541 </span> ll</span><br><span class="line"><span class="symbol">542 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">543 </span> ll</span><br><span class="line"><span class="symbol">544 </span> cd ..</span><br><span class="line"><span class="symbol">545 </span> ll</span><br><span class="line"><span class="symbol">546 </span> cd work/</span><br><span class="line"><span class="symbol">547 </span> ll</span><br><span class="line"><span class="symbol">548 </span> cd ..</span><br><span class="line"><span class="symbol">549 </span> cd conf/</span><br><span class="line"><span class="symbol">550 </span> ll</span><br><span class="line"><span class="symbol">551 </span> vim server.xml </span><br><span class="line"><span class="symbol">552 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">553 </span> cd ..</span><br><span class="line"><span class="symbol">554 </span> cd webapps/</span><br><span class="line"><span class="symbol">555 </span> ll</span><br><span class="line"><span class="symbol">556 </span> pwd</span><br><span class="line"><span class="symbol">557 </span> cd ..</span><br><span class="line"><span class="symbol">558 </span> cd conf/</span><br><span class="line"><span class="symbol">559 </span> vim server.xml </span><br><span class="line"><span class="symbol">560 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">561 </span> ll</span><br><span class="line"><span class="symbol">562 </span> cd ..</span><br><span class="line"><span class="symbol">563 </span> ll</span><br><span class="line"><span class="symbol">564 </span> cd bin</span><br><span class="line"><span class="symbol">565 </span> ./startup.sh </span><br><span class="line"><span class="symbol">566 </span> cd ..</span><br><span class="line"><span class="symbol">567 </span> cd logs/</span><br><span class="line"><span class="symbol">568 </span> ll</span><br><span class="line"><span class="symbol">569 </span> ls</span><br><span class="line"><span class="symbol">570 </span> cd ..</span><br><span class="line"><span class="symbol">571 </span> ls</span><br><span class="line"><span class="symbol">572 </span> cd server</span><br><span class="line"><span class="symbol">573 </span> cd www</span><br><span class="line"><span class="symbol">574 </span> cd server</span><br><span class="line"><span class="symbol">575 </span> ls</span><br><span class="line"><span class="symbol">576 </span> cd tomcat</span><br><span class="line"><span class="symbol">577 </span> ls</span><br><span class="line"><span class="symbol">578 </span> cd bin</span><br><span class="line"><span class="symbol">579 </span> ls</span><br><span class="line"><span class="symbol">580 </span> cd apache-tomcat-<span class="number">8.5.12</span>/</span><br><span class="line"><span class="symbol">581 </span> ls</span><br><span class="line"><span class="symbol">582 </span> cd bin</span><br><span class="line"><span class="symbol">583 </span> ./startup.sh</span><br><span class="line"><span class="symbol">584 </span> ls</span><br><span class="line"><span class="symbol">585 </span> ./startup.sh</span><br><span class="line"><span class="symbol">586 </span> ./shutdown.sh</span><br><span class="line"><span class="symbol">587 </span> ./startup.sh</span><br><span class="line"><span class="symbol">588 </span> ll</span><br><span class="line"><span class="symbol">589 </span> cd apache-tomcat-<span class="number">8.0.23</span></span><br><span class="line"><span class="symbol">590 </span> ll</span><br><span class="line"><span class="symbol">591 </span> cd webapps/</span><br><span class="line"><span class="symbol">592 </span> ll</span><br><span class="line"><span class="symbol">593 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">594 </span> cd ..</span><br><span class="line"><span class="symbol">595 </span> cd webapps/</span><br><span class="line"><span class="symbol">596 </span> ll</span><br><span class="line"><span class="symbol">597 </span> cd myProject</span><br><span class="line"><span class="symbol">598 </span> ll</span><br><span class="line"><span class="symbol">599 </span> cd WEB-INF/</span><br><span class="line"><span class="symbol">600 </span> ll</span><br><span class="line"><span class="symbol">601 </span> cd classes/</span><br><span class="line"><span class="symbol">602 </span> ll</span><br><span class="line"><span class="symbol">603 </span> more application.properties </span><br><span class="line"><span class="symbol">604 </span> cd ..</span><br><span class="line"><span class="symbol">605 </span> ll</span><br><span class="line"><span class="symbol">606 </span> cd ..</span><br><span class="line"><span class="symbol">607 </span> ll</span><br><span class="line"><span class="symbol">608 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">609 </span> cd META-INF/</span><br><span class="line"><span class="symbol">610 </span> ll</span><br><span class="line"><span class="symbol">611 </span> cd ..</span><br><span class="line"><span class="symbol">612 </span> ll</span><br><span class="line"><span class="symbol">613 </span> cd WEB-INF/</span><br><span class="line"><span class="symbol">614 </span> ll</span><br><span class="line"><span class="symbol">615 </span> cd classes/</span><br><span class="line"><span class="symbol">616 </span> ll</span><br><span class="line"><span class="symbol">617 </span> cd templates/</span><br><span class="line"><span class="symbol">618 </span> ll</span><br><span class="line"><span class="symbol">619 </span> cd ..</span><br><span class="line"><span class="symbol">620 </span> ll</span><br><span class="line"><span class="symbol">621 </span> cd classes/</span><br><span class="line"><span class="symbol">622 </span> ll</span><br><span class="line"><span class="symbol">623 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">624 </span> ll</span><br><span class="line"><span class="symbol">625 </span> more application.properties </span><br><span class="line"><span class="symbol">626 </span> ll</span><br><span class="line"><span class="symbol">627 </span> cd templates/</span><br><span class="line"><span class="symbol">628 </span> ll</span><br><span class="line"><span class="symbol">629 </span> cd js/</span><br><span class="line"><span class="symbol">630 </span> ll</span><br><span class="line"><span class="symbol">631 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">632 </span> vim <span class="keyword">common</span>.js </span><br><span class="line"><span class="symbol">633 </span> cd .</span><br><span class="line"><span class="symbol">634 </span> cd ..</span><br><span class="line"><span class="symbol">635 </span> cd conf/</span><br><span class="line"><span class="symbol">636 </span> more server.xml </span><br><span class="line"><span class="symbol">637 </span> cd ..</span><br><span class="line"><span class="symbol">638 </span> cd webapps/</span><br><span class="line"><span class="symbol">639 </span> ll</span><br><span class="line"><span class="symbol">640 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">641 </span> cd myProject</span><br><span class="line"><span class="symbol">642 </span> ll</span><br><span class="line"><span class="symbol">643 </span> cd WEB-INF/</span><br><span class="line"><span class="symbol">644 </span> ll</span><br><span class="line"><span class="symbol">645 </span> cd ca</span><br><span class="line"><span class="symbol">646 </span> cd classes/</span><br><span class="line"><span class="symbol">647 </span> ll</span><br><span class="line"><span class="symbol">648 </span> cd templates/</span><br><span class="line"><span class="symbol">649 </span> ll</span><br><span class="line"><span class="symbol">650 </span> cd js/</span><br><span class="line"><span class="symbol">651 </span> ll</span><br><span class="line"><span class="symbol">652 </span> vim <span class="keyword">common</span>.js </span><br><span class="line"><span class="symbol">653 </span> ps -ef |grep java</span><br><span class="line"><span class="symbol">654 </span> netstat -lnp|grep <span class="number">8082</span></span><br><span class="line"><span class="symbol">655 </span> systemctl status firewalld</span><br><span class="line"><span class="symbol">656 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">657 </span> firewall-cmd --zone=public --add-port=<span class="number">80</span>/tcp --permanent</span><br><span class="line"><span class="symbol">658 </span> firewall-cmd --zone=public --add-port=<span class="number">8082</span>/tcp --permanent</span><br><span class="line"><span class="symbol">659 </span> firewall-cmd --reload</span><br><span class="line"><span class="symbol">660 </span> firewall-cmd --zone=public --query-port=<span class="number">8082</span>/tcp</span><br><span class="line"><span class="symbol">661 </span> history </span><br><span class="line"><span class="symbol">662 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">663 </span> ll</span><br><span class="line"><span class="symbol">664 </span> cd ..</span><br><span class="line"><span class="symbol">665 </span> cd bin/</span><br><span class="line"><span class="symbol">666 </span> ./shutdown.sh </span><br><span class="line"><span class="symbol">667 </span> netstat -lnp|grep <span class="number">8080</span></span><br><span class="line"><span class="symbol">668 </span> netstat -lnp|grep <span class="number">8082</span></span><br><span class="line"><span class="symbol">669 </span> <span class="keyword">kill</span> -<span class="number">9</span> <span class="number">1109</span></span><br><span class="line"><span class="symbol">670 </span> netstat -lnp|grep <span class="number">8080</span></span><br><span class="line"><span class="symbol">671 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">672 </span> cd ..</span><br><span class="line"><span class="symbol">673 </span> cd conf/</span><br><span class="line"><span class="symbol">674 </span> ll</span><br><span class="line"><span class="symbol">675 </span> vim server.xml </span><br><span class="line"><span class="symbol">676 </span> cd ..</span><br><span class="line"><span class="symbol">677 </span> cd bin/</span><br><span class="line"><span class="symbol">678 </span> ./startup.sh </span><br><span class="line"><span class="symbol">679 </span> netstat -lnp|grep <span class="number">8080</span></span><br><span class="line"><span class="symbol">680 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">681 </span> ll</span><br><span class="line"><span class="symbol">682 </span> cd ../logs/</span><br><span class="line"><span class="symbol">683 </span> more catalina.<span class="keyword">out</span> </span><br><span class="line"><span class="symbol">684 </span> cd ../webapps/</span><br><span class="line"><span class="symbol">685 </span> cd myProject</span><br><span class="line"><span class="symbol">686 </span> ll</span><br><span class="line"><span class="symbol">687 </span> cd WEB-INF/</span><br><span class="line"><span class="symbol">688 </span> ll</span><br><span class="line"><span class="symbol">689 </span> cd classes/</span><br><span class="line"><span class="symbol">690 </span> ll</span><br><span class="line"><span class="symbol">691 </span> cd templates/</span><br><span class="line"><span class="symbol">692 </span> ll</span><br><span class="line"><span class="symbol">693 </span> cd js/</span><br><span class="line"><span class="symbol">694 </span> ll</span><br><span class="line"><span class="symbol">695 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">696 </span> ll</span><br><span class="line"><span class="symbol">697 </span> vim <span class="keyword">common</span>.js </span><br><span class="line"><span class="symbol">698 </span> cd ..</span><br><span class="line"><span class="symbol">699 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">700 </span> ll</span><br><span class="line"><span class="symbol">701 </span> cd ..</span><br><span class="line"><span class="symbol">702 </span> cd bin/</span><br><span class="line"><span class="symbol">703 </span> ./shutdown.sh </span><br><span class="line"><span class="symbol">704 </span> ll</span><br><span class="line"><span class="symbol">705 </span> cd apache-tomcat-<span class="number">8.0.23</span></span><br><span class="line"><span class="symbol">706 </span> ll</span><br><span class="line"><span class="symbol">707 </span> cd webapps/</span><br><span class="line"><span class="symbol">708 </span> ll</span><br><span class="line"><span class="symbol">709 </span> rm -rf myProject</span><br><span class="line"><span class="symbol">710 </span> rm -rf myProject.war </span><br><span class="line"><span class="symbol">711 </span> cd ..</span><br><span class="line"><span class="symbol">712 </span> cd work/</span><br><span class="line"><span class="symbol">713 </span> ll</span><br><span class="line"><span class="symbol">714 </span> cd Catalina/</span><br><span class="line"><span class="symbol">715 </span> ll</span><br><span class="line"><span class="symbol">716 </span> cd localhost/</span><br><span class="line"><span class="symbol">717 </span> ll</span><br><span class="line"><span class="symbol">718 </span> rm -rf myProject/</span><br><span class="line"><span class="symbol">719 </span> ll</span><br><span class="line"><span class="symbol">720 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">721 </span> cd ../../../</span><br><span class="line"><span class="symbol">722 </span> ll</span><br><span class="line"><span class="symbol">723 </span> cd ..</span><br><span class="line"><span class="symbol">724 </span> cd </span><br><span class="line"><span class="symbol">725 </span> ll</span><br><span class="line"><span class="symbol">726 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">727 </span> history </span><br><span class="line"><span class="symbol">728 </span> ll</span><br><span class="line"><span class="symbol">729 </span> cd docker/</span><br><span class="line"><span class="symbol">730 </span> ll</span><br><span class="line"><span class="symbol">731 </span> docker <span class="keyword">run</span> -d -p <span class="number">8080</span>:<span class="number">8080</span> springbootdemo4docker</span><br><span class="line"><span class="symbol">732 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">733 </span>  docker build -t springbootdemo4docker .</span><br><span class="line"><span class="symbol">734 </span> ll</span><br><span class="line"><span class="symbol">735 </span> more Dockerfile </span><br><span class="line"><span class="symbol">736 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">737 </span> ll</span><br><span class="line"><span class="symbol">738 </span> docker build -t springbootdemo5docker .</span><br><span class="line"><span class="symbol">739 </span> docker build -t springbootdemo4docker .</span><br><span class="line"><span class="symbol">740 </span> service docker restart</span><br><span class="line"><span class="symbol">741 </span> docker build -t springbootdemo5docker .</span><br><span class="line"><span class="symbol">742 </span> docker images</span><br><span class="line"><span class="symbol">743 </span> docker <span class="keyword">run</span> -d -p <span class="number">8080</span>:<span class="number">8080</span> springbootdemo5docker</span><br><span class="line"><span class="symbol">744 </span> docker rmi <span class="number">05</span>c655fd2bd6</span><br><span class="line"><span class="symbol">745 </span> ps -ef |grep java</span><br><span class="line"><span class="symbol">746 </span> <span class="keyword">kill</span> -<span class="number">9</span> <span class="number">2632</span></span><br><span class="line"><span class="symbol">747 </span> <span class="keyword">kill</span> -<span class="number">9</span> <span class="number">2874</span></span><br><span class="line"><span class="symbol">748 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">749 </span> cd ..</span><br><span class="line"><span class="symbol">750 </span> ll</span><br><span class="line"><span class="symbol">751 </span> pwd</span><br><span class="line"><span class="symbol">752 </span> ll</span><br><span class="line"><span class="symbol">753 </span> rm -rf Mamai-<span class="number">1.0</span>-SNAPSHOT.jar </span><br><span class="line"><span class="symbol">754 </span> ll</span><br><span class="line"><span class="symbol">755 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">756 </span> pwd</span><br><span class="line"><span class="symbol">757 </span> ll</span><br><span class="line"><span class="symbol">758 </span> cd docker/</span><br><span class="line"><span class="symbol">759 </span> ll</span><br><span class="line"><span class="symbol">760 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">761 </span> ll</span><br><span class="line"><span class="symbol">762 </span> rm -rf Mamai-<span class="number">1.0</span>-SNAPSHOT.jar </span><br><span class="line"><span class="symbol">763 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">764 </span> cp ../Mamai-<span class="number">1.0</span>-SNAPSHOT.jar  Mamai-<span class="number">1.0</span>-SNAPSHOT.jar</span><br><span class="line"><span class="symbol">765 </span> ll</span><br><span class="line"><span class="symbol">766 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">767 </span> rm -rf Mamai-<span class="number">1.0</span>-SNAPSHOT.jar </span><br><span class="line"><span class="symbol">768 </span> cd ..</span><br><span class="line"><span class="symbol">769 </span> ll</span><br><span class="line"><span class="symbol">770 </span> cear</span><br><span class="line"><span class="symbol">771 </span> rm -rf Mamai-<span class="number">1.0</span>-SNAPSHOT.jar </span><br><span class="line"><span class="symbol">772 </span> ll</span><br><span class="line"><span class="symbol">773 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">774 </span> ll</span><br><span class="line"><span class="symbol">775 </span> tail -<span class="number">300</span>f tempMaima.txt </span><br><span class="line"><span class="symbol">776 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">777 </span> ll</span><br><span class="line"><span class="symbol">778 </span> cp Mamai-<span class="number">1.0</span>-SNAPSHOT.jar ./docker/</span><br><span class="line"><span class="symbol">779 </span> ll</span><br><span class="line"><span class="symbol">780 </span> cd docker/</span><br><span class="line"><span class="symbol">781 </span> ll</span><br><span class="line"><span class="symbol">782 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">783 </span> docker images</span><br><span class="line"><span class="symbol">784 </span> docker start <span class="number">05</span>c655fd2bd6</span><br><span class="line"><span class="symbol">785 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">786 </span> docker build -t springbootdemo6docker .</span><br><span class="line"><span class="symbol">787 </span> docker images</span><br><span class="line"><span class="symbol">788 </span> docker <span class="keyword">run</span> -d -p <span class="number">8080</span>:<span class="number">8080</span> springbootdemo6docker</span><br><span class="line"><span class="symbol">789 </span> docker images</span><br><span class="line"><span class="symbol">790 </span> ll</span><br><span class="line"><span class="symbol">791 </span> cd ..</span><br><span class="line"><span class="symbol">792 </span> ll</span><br><span class="line"><span class="symbol">793 </span> tail -<span class="number">300</span>f tempMaima.txt </span><br><span class="line"><span class="symbol">794 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">795 </span> ll</span><br><span class="line"><span class="symbol">796 </span> cd docker/</span><br><span class="line"><span class="symbol">797 </span> docker images</span><br><span class="line"><span class="symbol">798 </span> docker rmi05c655fd2bd6</span><br><span class="line"><span class="symbol">799 </span> docker rmi <span class="number">05</span>c655fd2bd6</span><br><span class="line"><span class="symbol">800 </span> docker rmi springbootdemo4docker:latest </span><br><span class="line"><span class="symbol">801 </span> docker rmi -f <span class="number">05</span>c655fd2bd6</span><br><span class="line"><span class="symbol">802 </span> docker rmi springbootdemo5docker:latest</span><br><span class="line"><span class="symbol">803 </span> docker rmi -f <span class="number">05</span>c655fd2bd6</span><br><span class="line"><span class="symbol">804 </span> docker images</span><br><span class="line"><span class="symbol">805 </span> ls</span><br><span class="line"><span class="symbol">806 </span> Mamai-<span class="number">1.0</span>-SNAPSHOT.jar.sh <span class="keyword">stop</span></span><br><span class="line"><span class="symbol">807 </span> Mamai-<span class="number">1.0</span>-SNAPSHOT <span class="keyword">stop</span></span><br><span class="line"><span class="symbol">808 </span> Mamai-<span class="number">1.0</span>-SNAPSHOT.jar <span class="keyword">stop</span></span><br><span class="line"><span class="symbol">809 </span> top</span><br><span class="line"><span class="symbol">810 </span> ls</span><br><span class="line"><span class="symbol">811 </span> java -jar Mamai-<span class="number">1.0</span>-SNAPSHOT.jar </span><br><span class="line"><span class="symbol">812 </span> ls</span><br><span class="line"><span class="symbol">813 </span> ps -ef</span><br><span class="line"><span class="symbol">814 </span> ls</span><br><span class="line"><span class="symbol">815 </span> java -jar Mamai-<span class="number">1.0</span>-SNAPSHOT.jar</span><br><span class="line"><span class="symbol">816 </span> ls</span><br><span class="line"><span class="symbol">817 </span> java -jar Mamai-<span class="number">1.0</span>-SNAPSHOT.jar</span><br><span class="line"><span class="symbol">818 </span> ls</span><br><span class="line"><span class="symbol">819 </span> java -jar Mamai-<span class="number">1.0</span>-SNAPSHOT.jar</span><br><span class="line"><span class="symbol">820 </span> ll</span><br><span class="line"><span class="symbol">821 </span> tail -<span class="number">300</span>f tempMaima.txt </span><br><span class="line"><span class="symbol">822 </span> netstat -lnp|grep <span class="number">8080</span></span><br><span class="line"><span class="symbol">823 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">824 </span> docker ps</span><br><span class="line"><span class="symbol">825 </span> ll</span><br><span class="line"><span class="symbol">826 </span> cd docker/</span><br><span class="line"><span class="symbol">827 </span> ll</span><br><span class="line"><span class="symbol">828 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">829 </span> docker ps</span><br><span class="line"><span class="symbol">830 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">831 </span> ps -ef |grep java</span><br><span class="line"><span class="symbol">832 </span> ps -ef |grep <span class="number">8080</span></span><br><span class="line"><span class="symbol">833 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">834 </span> history </span><br><span class="line"><span class="symbol">835 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">836 </span> cd /</span><br><span class="line"><span class="symbol">837 </span> ll</span><br><span class="line"><span class="symbol">838 </span> cd www/</span><br><span class="line"><span class="symbol">839 </span> ll</span><br><span class="line"><span class="symbol">840 </span> cd server/</span><br><span class="line"><span class="symbol">841 </span> ll</span><br><span class="line"><span class="symbol">842 </span> cd nginx/</span><br><span class="line"><span class="symbol">843 </span> ll</span><br><span class="line"><span class="symbol">844 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">845 </span> ll</span><br><span class="line"><span class="symbol">846 </span> cd bin</span><br><span class="line"><span class="symbol">847 </span> ll</span><br><span class="line"><span class="symbol">848 </span> cd sbin/</span><br><span class="line"><span class="symbol">849 </span> ll</span><br><span class="line"><span class="symbol">850 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">851 </span> ll</span><br><span class="line"><span class="symbol">852 </span> cd .</span><br><span class="line"><span class="symbol">853 </span> cd ..</span><br><span class="line"><span class="symbol">854 </span> cd conf/</span><br><span class="line"><span class="symbol">855 </span> ll</span><br><span class="line"><span class="symbol">856 </span> cd ..</span><br><span class="line"><span class="symbol">857 </span> cd sbin</span><br><span class="line"><span class="symbol">858 </span> ./nginx -c ../conf/nginx.conf</span><br><span class="line"><span class="symbol">859 </span> cd ../conf/</span><br><span class="line"><span class="symbol">860 </span> ll</span><br><span class="line"><span class="symbol">861 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">862 </span> ../sbin/nginx -c nginx.conf</span><br><span class="line"><span class="symbol">863 </span> pwd</span><br><span class="line"><span class="symbol">864 </span> tail -<span class="number">300</span>f nginx.conf</span><br><span class="line"><span class="symbol">865 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">866 </span> cd ..</span><br><span class="line"><span class="symbol">867 </span> cd sbin/</span><br><span class="line"><span class="symbol">868 </span> ./nginx  -s reload</span><br><span class="line"><span class="symbol">869 </span> ll</span><br><span class="line"><span class="symbol">870 </span> cd ..</span><br><span class="line"><span class="symbol">871 </span> ll</span><br><span class="line"><span class="symbol">872 </span> cd logs/</span><br><span class="line"><span class="symbol">873 </span> l</span><br><span class="line"><span class="symbol">874 </span> ll</span><br><span class="line"><span class="symbol">875 </span> tail -<span class="number">300</span>f <span class="keyword">error</span>.<span class="keyword">log</span> </span><br><span class="line"><span class="symbol">876 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">877 </span> cd ..</span><br><span class="line"><span class="symbol">878 </span> ll</span><br><span class="line"><span class="symbol">879 </span> cd ..</span><br><span class="line"><span class="symbol">880 </span> cd </span><br><span class="line"><span class="symbol">881 </span> docker images</span><br><span class="line"><span class="symbol">882 </span> docker image ls</span><br><span class="line"><span class="symbol">883 </span> systemctl daemon-reload</span><br><span class="line"><span class="symbol">884 </span> docker images</span><br><span class="line"><span class="symbol">885 </span> service docker status</span><br><span class="line"><span class="symbol">886 </span> service docker start</span><br><span class="line"><span class="symbol">887 </span> systemctl  docker start</span><br><span class="line"><span class="symbol">888 </span> systemctl docker status</span><br><span class="line"><span class="symbol">889 </span> systemctl restart docker</span><br><span class="line"><span class="symbol">890 </span> systemctl status docker</span><br><span class="line"><span class="symbol">891 </span> docker ps</span><br><span class="line"><span class="symbol">892 </span> docker images</span><br><span class="line"><span class="symbol">893 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">894 </span> docker images</span><br><span class="line"><span class="symbol">895 </span> docker ps -a</span><br><span class="line"><span class="symbol">896 </span> history </span><br><span class="line"><span class="symbol">897 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">898 </span> docker images</span><br><span class="line"><span class="symbol">899 </span> docker ps</span><br><span class="line"><span class="symbol">900 </span> docker ps -a</span><br><span class="line"><span class="symbol">901 </span> docker start gifted_hamilton</span><br><span class="line"><span class="symbol">902 </span> docker ps</span><br><span class="line"><span class="symbol">903 </span> ll</span><br><span class="line"><span class="symbol">904 </span> tail -<span class="number">300</span>f tempMaima.txt </span><br><span class="line"><span class="symbol">905 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">906 </span> history </span><br><span class="line"><span class="symbol">907 </span> ll</span><br><span class="line"><span class="symbol">908 </span> docker ps -a</span><br><span class="line"><span class="symbol">909 </span> docker <span class="keyword">stop</span> gifted_hamilton</span><br><span class="line"><span class="symbol">910 </span> pwd</span><br><span class="line"><span class="symbol">911 </span> ll</span><br><span class="line"><span class="symbol">912 </span> cd docker/</span><br><span class="line"><span class="symbol">913 </span> l</span><br><span class="line"><span class="symbol">914 </span> ll</span><br><span class="line"><span class="symbol">915 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">916 </span> ll</span><br><span class="line"><span class="symbol">917 </span> rm -rf Mamai-<span class="number">1.0</span>-SNAPSHOT.jar </span><br><span class="line"><span class="symbol">918 </span> ll</span><br><span class="line"><span class="symbol">919 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">920 </span> pwd</span><br><span class="line"><span class="symbol">921 </span> docker ps -a</span><br><span class="line"><span class="symbol">922 </span> ll</span><br><span class="line"><span class="symbol">923 </span> docker start gifted_hamilton</span><br><span class="line"><span class="symbol">924 </span> docker ps -a</span><br><span class="line"><span class="symbol">925 </span> ps -ef |grep java</span><br><span class="line"><span class="symbol">926 </span> ll</span><br><span class="line"><span class="symbol">927 </span> docker ps -a</span><br><span class="line"><span class="symbol">928 </span> docker <span class="keyword">stop</span> gifted_hamilton</span><br><span class="line"><span class="symbol">929 </span> cd docker/</span><br><span class="line"><span class="symbol">930 </span> ll</span><br><span class="line"><span class="symbol">931 </span> rm -rf Mamai-<span class="number">1.0</span>-SNAPSHOT.jar </span><br><span class="line"><span class="symbol">932 </span> ll</span><br><span class="line"><span class="symbol">933 </span> pwd</span><br><span class="line"><span class="symbol">934 </span> ll</span><br><span class="line"><span class="symbol">935 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">936 </span> docker ps -a</span><br><span class="line"><span class="symbol">937 </span> docker start gifted_hamilton</span><br><span class="line"><span class="symbol">938 </span> docker ps -a</span><br><span class="line"><span class="symbol">939 </span> docker <span class="keyword">stop</span> gifted_hamilton</span><br><span class="line"><span class="symbol">940 </span> docker ps -a</span><br><span class="line"><span class="symbol">941 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">942 </span> docker ps -a</span><br><span class="line"><span class="symbol">943 </span> docker rm gifted_hamilton</span><br><span class="line"><span class="symbol">944 </span> docker ps -a</span><br><span class="line"><span class="symbol">945 </span> docker images</span><br><span class="line"><span class="symbol">946 </span> docker rmi springbootdemo6docker</span><br><span class="line"><span class="symbol">947 </span> docker iamges</span><br><span class="line"><span class="symbol">948 </span> docker images</span><br><span class="line"><span class="symbol">949 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">950 </span> ll</span><br><span class="line"><span class="symbol">951 </span> more Dockerfile </span><br><span class="line"><span class="symbol">952 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">953 </span> docker build -t mamai .</span><br><span class="line"><span class="symbol">954 </span> docker images</span><br><span class="line"><span class="symbol">955 </span> cd ..</span><br><span class="line"><span class="symbol">956 </span> ll</span><br><span class="line"><span class="symbol">957 </span> cd docker/</span><br><span class="line"><span class="symbol">958 </span> ll</span><br><span class="line"><span class="symbol">959 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">960 </span> more Dockerfile </span><br><span class="line"><span class="symbol">961 </span> docker <span class="keyword">run</span> -d -p <span class="number">8080</span>:<span class="number">8080</span> mamai</span><br><span class="line"><span class="symbol">962 </span> docker ps -a</span><br><span class="line"><span class="symbol">963 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">964 </span> ll</span><br><span class="line"><span class="symbol">965 </span> cd .</span><br><span class="line"><span class="symbol">966 </span> c d..</span><br><span class="line"><span class="symbol">967 </span> cd ..</span><br><span class="line"><span class="symbol">968 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">969 </span> ll</span><br><span class="line"><span class="symbol">970 </span> rm -rf Ma</span><br><span class="line"><span class="symbol">971 </span> rm -rf Mamai-<span class="number">1.0</span>-SNAPSHOT.jar </span><br><span class="line"><span class="symbol">972 </span> ll</span><br><span class="line"><span class="symbol">973 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">974 </span> ll</span><br><span class="line"><span class="symbol">975 </span> rm -rf apache-tomcat-<span class="number">8.0.23</span></span><br><span class="line"><span class="symbol">976 </span> rm -rf apache-tomcat-<span class="number">8.0.23.</span>tar.gz </span><br><span class="line"><span class="symbol">977 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">978 </span> ll</span><br><span class="line"><span class="symbol">979 </span> more install.sh </span><br><span class="line"><span class="symbol">980 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">981 </span> docker ps -a</span><br><span class="line"><span class="symbol">982 </span> docker <span class="keyword">stop</span> agitated_brown</span><br><span class="line"><span class="symbol">983 </span> ll</span><br><span class="line"><span class="symbol">984 </span> cd docker/</span><br><span class="line"><span class="symbol">985 </span> ll</span><br><span class="line"><span class="symbol">986 </span> rm -rf Mamai-<span class="number">1.0</span>-SNAPSHOT.jar </span><br><span class="line"><span class="symbol">987 </span> ll</span><br><span class="line"><span class="symbol">988 </span> docker  images</span><br><span class="line"><span class="symbol">989 </span> docker ps -a</span><br><span class="line"><span class="symbol">990 </span> docker start agitated_brown</span><br><span class="line"><span class="symbol">991 </span> docker ps -a</span><br><span class="line"><span class="symbol">992 </span> top</span><br><span class="line"><span class="symbol">993 </span> df -h</span><br><span class="line"><span class="symbol">994 </span> top</span><br><span class="line"><span class="symbol">995 </span> ll</span><br><span class="line"><span class="symbol">996 </span> cd docker/</span><br><span class="line"><span class="symbol">997 </span> ll</span><br><span class="line"><span class="symbol">998 </span> more Dockerfile </span><br><span class="line"><span class="symbol">999 </span> history</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;éœ€æ±‚å†…å®¹&quot;&gt;&lt;a href=&quot;#éœ€æ±‚å†…å®¹&quot; class=&quot;headerlink&quot; title=&quot;éœ€æ±‚å†…å®¹&quot;&gt;&lt;/a&gt;éœ€æ±‚å†…å®¹&lt;/h2&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pr
      
    
    </summary>
    
    
      <category term="å‰ç«¯" scheme="https://fengshana.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="javaScript" scheme="https://fengshana.github.io/tags/javaScript/"/>
    
      <category term="docker" scheme="https://fengshana.github.io/tags/docker/"/>
    
      <category term="å‰ç«¯" scheme="https://fengshana.github.io/tags/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="åŒè‰²çƒ" scheme="https://fengshana.github.io/tags/%E5%8F%8C%E8%89%B2%E7%90%83/"/>
    
  </entry>
  
  <entry>
    <title>æ·±å…¥ç†è§£javaè™šæ‹Ÿæœº-çº¿ç¨‹å®‰å…¨ä¸é”ä¼˜åŒ–</title>
    <link href="https://fengshana.github.io/2020/05/26/%E3%80%90%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JAVA%E8%99%9A%E6%8B%9F%E6%9C%BA%E3%80%91/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JAVA%E8%99%9A%E6%8B%9F%E6%9C%BA13/"/>
    <id>https://fengshana.github.io/2020/05/26/%E3%80%90%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JAVA%E8%99%9A%E6%8B%9F%E6%9C%BA%E3%80%91/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JAVA%E8%99%9A%E6%8B%9F%E6%9C%BA13/</id>
    <published>2020-05-26T14:41:37.497Z</published>
    <updated>2020-06-05T18:26:39.099Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ·±å…¥javaè™šæ‹Ÿæœº-ç¬¬äº”éƒ¨åˆ†-é«˜æ•ˆå¹¶å‘"><a href="#æ·±å…¥javaè™šæ‹Ÿæœº-ç¬¬äº”éƒ¨åˆ†-é«˜æ•ˆå¹¶å‘" class="headerlink" title="æ·±å…¥javaè™šæ‹Ÿæœº-ç¬¬äº”éƒ¨åˆ†-é«˜æ•ˆå¹¶å‘"></a>æ·±å…¥javaè™šæ‹Ÿæœº-ç¬¬äº”éƒ¨åˆ†-é«˜æ•ˆå¹¶å‘</h2><h3 id="ç¬¬13ç« -çº¿ç¨‹å®‰å…¨ä¸é”ä¼˜åŒ–"><a href="#ç¬¬13ç« -çº¿ç¨‹å®‰å…¨ä¸é”ä¼˜åŒ–" class="headerlink" title="ç¬¬13ç«  çº¿ç¨‹å®‰å…¨ä¸é”ä¼˜åŒ–"></a>ç¬¬13ç«  çº¿ç¨‹å®‰å…¨ä¸é”ä¼˜åŒ–</h3><p>å¹¶å‘å¤„ç† çš„ å¹¿æ³›åº”ç”¨ æ˜¯ä½¿å¾— Amdah1å®šå¾‹ ä»£æ›¿ æ‘©å°”å®šå¾‹ æˆä¸º è®¡ç®—æœºæ€§èƒ½å‘å±•æºåŠ¨åŠ› çš„æ ¹æœ¬åŸå› ï¼Œä¹Ÿæ˜¯äººç±» â€œå‹æ¦¨â€ è®¡ç®—æœºè¿ç®—èƒ½åŠ› çš„ æœ€æœ‰åŠ›æ­¦å™¨ã€‚</p><h4 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h4><p>åœ¨ è½¯ä»¶ä¸šå‘å±• çš„ åˆæœŸï¼Œç¨‹åºç¼–å†™ éƒ½æ˜¯ä»¥ ç®—æ³• ä¸ºæ ¸å¿ƒçš„ï¼Œ<br>ç¨‹åºå‘˜ä¼šæŠŠ æ•°æ® å’Œ è¿‡ç¨‹ åˆ†åˆ«ä½œä¸º ç‹¬ç«‹çš„éƒ¨åˆ† æ¥è€ƒè™‘ï¼Œ<br>æ•°æ® ä»£è¡¨ é—®é¢˜ç©ºé—´ ä¸­çš„ å®¢ä½“ï¼Œç¨‹åºä»£ç  åˆ™ç”¨äº å¤„ç†è¿™äº›æ•°æ®ï¼Œ<br>è¿™ç§ æ€ç»´æ–¹å¼ ç›´æ¥ç«™åœ¨ è®¡ç®—æœºçš„è§’åº¦ å» æŠ½è±¡é—®é¢˜å’Œè§£å†³é—®é¢˜ï¼Œ<br>ç§°ä¸º é¢å‘è¿‡ç¨‹ çš„ ç¼–ç¨‹æ€æƒ³ã€‚</p><p>ä¸æ­¤åŒæ—¶ï¼Œ<br>é¢å‘å¯¹è±¡ çš„ ç¼–ç¨‹æ€æƒ³ æ˜¯ç«™åœ¨ ç°å®ä¸–ç•Œçš„è§’åº¦ å» æŠ½è±¡å’Œè§£å†³é—®é¢˜ï¼Œ<br>å®ƒæŠŠ æ•°æ®å’Œè¡Œä¸º éƒ½çœ‹åšæ˜¯ å¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œ<br>è¿™æ ·å¯ä»¥è®©ç¨‹åºå‘˜èƒ½ä»¥ ç¬¦åˆç°å®ä¸–ç•Œçš„ æ€ç»´æ–¹å¼ æ¥ ç¼–å†™å’Œç»„ç»‡ç¨‹åºã€‚</p><p>é¢å‘è¿‡ç¨‹ çš„ ç¼–ç¨‹æ€æƒ³ æå¤§åœ° æå‡äº† ç°ä»£è½¯ä»¶å¼€å‘ çš„ ç”Ÿäº§æ•ˆç‡ å’Œ è½¯ä»¶å¯ä»¥è¾¾åˆ°çš„è§„æ¨¡ï¼Œ<br>ä½†æ˜¯ ç°å®ä¸–ç•Œä¸è®¡ç®—æœºä¸–ç•Œ ä¹‹é—´ä¸å¯é¿å…åœ° å­˜åœ¨ä¸€äº›å·®å¼‚ã€‚</p><p>ä¾‹å¦‚ï¼Œäººä»¬å¾ˆéš¾æƒ³è±¡ç°å®ä¸­çš„ å¯¹è±¡ åœ¨ä¸€é¡¹å·¥ä½œè¿›è¡ŒæœŸé—´ï¼Œä¼šè¢«ä¸åœåœ°ä¸­æ–­å’Œåˆ‡æ¢ï¼Œå¯¹è±¡çš„å±æ€§ï¼ˆæ•°æ®ï¼‰å¯èƒ½ä¼šåœ¨ ä¸­æ–­æœŸé—´ è¢«ä¿®æ”¹å’Œå˜â€œè„â€ï¼Œ<br>è€Œè¿™äº›äº‹ä»¶ åœ¨è®¡ç®—æœºä¸–ç•Œä¸­ åˆ™æ˜¯å¾ˆæ­£å¸¸çš„äº‹æƒ…ã€‚</p><p>æœ‰æ—¶å€™ï¼Œè‰¯å¥½çš„è®¾è®¡åŸåˆ™ ä¸å¾—ä¸å‘ç°å®åšå‡ºä¸€äº›è®©æ­¥ï¼Œæˆ‘ä»¬å¿…é¡»è®© ç¨‹åº åœ¨è®¡ç®—æœºä¸­ æ­£ç¡®æ— è¯¯åœ°è¿è¡Œï¼Œ<br>ç„¶åå†è€ƒè™‘å¦‚ä½•å°† ä»£ç ç»„ç»‡å¾—æ›´å¥½ï¼Œè®© ç¨‹åº è¿è¡Œå¾— æ›´å¿«ã€‚</p><p>å¯¹äºè¿™éƒ¨åˆ†çš„ä¸»é¢˜â€œé«˜æ•ˆå¹¶å‘â€æ¥è®²ï¼Œé¦–å…ˆéœ€è¦ä¿è¯ å¹¶å‘çš„æ­£ç¡®æ€§ï¼Œç„¶ååœ¨æ­¤åŸºç¡€ä¸Šå®ç° é«˜æ•ˆã€‚</p><p>æœ¬ç« å…ˆä» å¦‚ä½•ä¿è¯å¹¶å‘çš„æ­£ç¡®æ€§ å’Œ å¦‚ä½•å®ç°çº¿ç¨‹å®‰å…¨è®²èµ·ã€‚</p><h4 id="çº¿ç¨‹å®‰å…¨"><a href="#çº¿ç¨‹å®‰å…¨" class="headerlink" title="çº¿ç¨‹å®‰å…¨"></a>çº¿ç¨‹å®‰å…¨</h4><p>â€œçº¿ç¨‹å®‰å…¨â€  è¿™ä¸ªåç§°ï¼Œç›¸ä¿¡ç¨æœ‰ç»éªŒçš„ç¨‹åºå‘˜éƒ½ä¼šå¬è¯´è¿‡ï¼Œç”šè‡³åœ¨ ä»£ç ç¼–å†™ å’Œ èµ°æŸ¥çš„æ—¶å€™ å¯èƒ½è¿˜ä¼šå°†ä¼šæŒ‚åœ¨å˜´è¾¹ï¼Œ<br>ä½†æ˜¯å¦‚ä½•æ‰¾åˆ°ä¸€ä¸ªä¸å¤ªæ‹—å£çš„æ¦‚å¿µ æ¥å®šä¹‰ çº¿ç¨‹å®‰å…¨ å´ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹æƒ…ï¼Œ<br>ç¬”è€…å°è¯•åœ¨Googleä¸­æœç´¢å®ƒçš„æ¦‚å¿µï¼Œæ‰¾åˆ°çš„æ˜¯ç±»ä¼¼äº â€œå¦‚æœä¸€ä¸ªå¯¹è±¡å¯ä»¥å®‰å…¨åœ°è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶ä½¿ç”¨ï¼Œé‚£å®ƒå°±æ˜¯çº¿ç¨‹å®‰å…¨çš„â€è¿™æ ·çš„å®šä¹‰â€”â€”å¹¶ä¸èƒ½è¯´å®ƒä¸æ­£ç¡®ï¼Œä½†æ˜¯äººä»¬æ— æ³•ä»ä¸­è·å–åˆ°ä»»ä½•æœ‰ç”¨çš„ä¿¡æ¯ã€‚</p><p>ï¼ˆåƒæˆ‘è¿™ç§å°ç™½ï¼Œä¹Ÿåªæ˜¯ï¼Œå¬è¿‡ï¼Œæˆ‘å¯æ²¡æœ‰è¯´è¿‡ğŸ˜¶ğŸ˜¶ğŸ˜¶ï¼‰</p><p>ç¬”è€…è®¤ä¸ºã€ŠJava Concurrency In Practiceã€‹ çš„ä½œè€… Brian Goetz å¯¹ â€œçº¿ç¨‹å®‰å…¨â€ æœ‰ä¸€ä¸ªæ¯”è¾ƒæ°å½“çš„å®šä¹‰ï¼š<br>â€œå½“ å¤šä¸ªçº¿ç¨‹ è®¿é—® ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœä¸ç”¨è€ƒè™‘è¿™äº› çº¿ç¨‹ åœ¨ è¿è¡Œæ—¶ç¯å¢ƒ ä¸‹çš„ è°ƒåº¦ å’Œ äº¤æ›¿æ‰§è¡Œï¼Œä¹Ÿä¸éœ€è¦è¿›è¡Œ é¢å¤–çš„åŒæ­¥ï¼Œæˆ–è€…åœ¨ è°ƒç”¨æ–¹ è¿›è¡Œä»»ä½•å…¶ä»–çš„ åè°ƒæ“ä½œï¼Œè°ƒç”¨è¿™ä¸ª å¯¹è±¡çš„è¡Œä¸º éƒ½å¯ä»¥è·å¾— æ­£ç¡®çš„ç»“æœï¼Œé‚£ è¿™ä¸ªå¯¹è±¡ æ˜¯ çº¿ç¨‹å®‰å…¨ çš„â€ã€‚</p><p>è¿™ä¸ªå®šä¹‰æ¯”è¾ƒ ä¸¥è°¨ï¼Œå®ƒè¦æ±‚ çº¿ç¨‹å®‰å…¨ çš„ä»£ç  éƒ½å¿…é¡»å…·å¤‡ä¸€ä¸ªç‰¹å¾ï¼š<br>ä»£ç æœ¬èº« å°è£… äº†æ‰€æœ‰å¿…è¦çš„ æ­£ç¡®æ€§ä¿éšœæ‰‹æ®µï¼ˆå¦‚äº’æ–¥åŒæ­¥ç­‰ï¼‰ï¼Œ<br>ä»¤ è°ƒç”¨è€… æ— éœ€å…³å¿ƒ å¤šçº¿ç¨‹ çš„é—®é¢˜ï¼Œæ›´æ— é¡»è‡ªå·±é‡‡å– ä»»ä½•æªæ–½ æ¥ ä¿è¯å¤šçº¿ç¨‹çš„æ­£ç¡®è°ƒç”¨ã€‚</p><p>è¿™ç‚¹å¬èµ·æ¥ç®€å•ï¼Œä½†å…¶å®å¹¶ä¸å®¹æ˜“åšåˆ°ï¼Œåœ¨å¤§å¤šæ•°åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬éƒ½ä¼šå°†è¿™ä¸ªå®šä¹‰å¼±åŒ–ä¸€äº›ï¼Œå¦‚æœæŠŠâ€è°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„è¡Œä¸ºâ€œé™å®šä¸ºâ€å•æ¬¡è°ƒç”¨â€œï¼Œ<br>è¿™ä¸ªå®šä¹‰çš„å…¶ä»–æè¿°ä¹Ÿèƒ½å¤Ÿæˆç«‹çš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç§°å®ƒæ˜¯ çº¿ç¨‹å®‰å…¨ äº†ï¼Œä¸ºä»€ä¹ˆè¦ å¼±åŒ– è¿™ä¸ªå®šä¹‰ï¼Œç°åœ¨æš‚ä¸”æ”¾ä¸‹ï¼Œç¨åå†è¯¦ç»†æ¢è®¨ã€‚</p><h5 id="Javaè¯­è¨€ä¸­çš„çº¿ç¨‹å®‰å…¨"><a href="#Javaè¯­è¨€ä¸­çš„çº¿ç¨‹å®‰å…¨" class="headerlink" title="Javaè¯­è¨€ä¸­çš„çº¿ç¨‹å®‰å…¨"></a>Javaè¯­è¨€ä¸­çš„çº¿ç¨‹å®‰å…¨</h5><p>æˆ‘ä»¬å·²ç»æœ‰äº† çº¿ç¨‹å®‰å…¨ çš„ä¸€ä¸ª æŠ½è±¡å®šä¹‰ï¼Œ<br>é‚£æ¥ä¸‹æ¥å°±è®¨è®ºä¸€ä¸‹åœ¨ javaè¯­è¨€ ä¸­ï¼Œçº¿ç¨‹å®‰å…¨ å…·ä½“æ˜¯å¦‚ä½•ä½“ç°çš„ï¼Ÿ<br>æœ‰å“ªäº›æ“ä½œæ˜¯ çº¿ç¨‹å®‰å…¨ çš„ï¼Ÿ<br>æˆ‘ä»¬è¿™é‡Œè®¨è®ºçš„ çº¿ç¨‹å®‰å…¨ï¼Œå°± é™å®šä¸ å¤šä¸ªçº¿ç¨‹ä¹‹é—´ å­˜åœ¨ å…±äº«æ•°æ®è®¿é—® è¿™ä¸ª å‰æï¼Œ<br>å› ä¸ºå¦‚æœä¸€æ®µä»£ç  æ ¹æœ¬ä¸ä¼š ä¸å…¶ä»–çº¿ç¨‹å…±äº«æ•°æ®ï¼Œé‚£ä¹ˆä» çº¿ç¨‹å®‰å…¨ çš„ è§’åº¦ æ¥çœ‹ï¼Œç¨‹åºæ˜¯ ä¸²è¡Œæ‰§è¡Œ è¿˜æ˜¯ å¤šçº¿ç¨‹æ‰§è¡Œ å¯¹å®ƒæ¥è¯´æ˜¯å®Œå…¨æ²¡æœ‰åŒºåˆ«çš„ã€‚</p><p>ä¸ºäº†æ›´åŠ  æ·±å…¥åœ° ç†è§£ çº¿ç¨‹å®‰å…¨ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä¸æŠŠ çº¿ç¨‹å®‰å…¨ å½“åšä¸€ä¸ªéçœŸå³å‡ çš„ äºŒå…ƒæ’ä»–é¡¹ æ¥çœ‹å¾…ï¼Œ<br>æŒ‰ç…§ çº¿ç¨‹å®‰å…¨ çš„ â€œå®‰å…¨ç¨‹åº¦â€ ç”±å¼ºè‡³å¼±æ¥æ’åºï¼Œæˆ‘ä»¬å¯ä»¥å°†Javaè¯­è¨€ä¸­å„ç§æ“ä½œå…±äº«çš„æ•°æ®åˆ†ä¸ºä»¥ä¸‹5ç±»ï¼š<br>ä¸å¯å˜ã€ç»å¯¹çº¿ç¨‹å®‰å…¨ã€ç›¸å¯¹çº¿ç¨‹å®‰å…¨ã€çº¿ç¨‹å…¼å®¹å’Œçº¿ç¨‹å¯¹ç«‹ã€‚</p><blockquote><p>è¿™ç§åˆ’åˆ†æ–¹æ³•ä¹Ÿæ˜¯ Brian Goetzåœ¨IBM developWorkersä¸Šå‘è¡¨çš„ä¸€ç¯‡è®ºæ–‡ä¸­æå‡ºçš„ï¼Œ<br>è¿™é‡Œå†™ â€œæˆ‘ä»¬â€  çº¯ç²¹æ˜¯ç¬”è€…ä¸‹ç¬”è¡Œæ–‡ä¸­çš„è¯­è¨€ç”¨æ³•ã€‚</p></blockquote><h6 id="1-ä¸å¯å˜"><a href="#1-ä¸å¯å˜" class="headerlink" title="1.ä¸å¯å˜"></a>1.ä¸å¯å˜</h6><p>åœ¨Javaè¯­è¨€ä¸­ï¼ˆç‰¹æŒ‡JDK1.5ä»¥åï¼Œå³ Javaå†…å­˜æ¨¡å‹ è¢« ä¿®æ­£ä»¥åçš„ Javaè¯­è¨€ï¼‰ï¼Œ<br>ä¸å¯å˜ï¼ˆImmutableï¼‰ çš„ å¯¹è±¡ ä¸€å®šæ˜¯ çº¿ç¨‹å®‰å…¨çš„ï¼Œ<br>æ— è®ºæ˜¯ å¯¹è±¡çš„æ–¹æ³• è¿˜æ˜¯ æ–¹æ³•çš„è°ƒç”¨è€…ï¼Œéƒ½ä¸éœ€è¦å†é‡‡å– ä»»ä½•çš„çº¿ç¨‹å®‰å…¨ä¿éšœæªæ–½ï¼Œ</p><p>åœ¨12ç« æˆ‘ä»¬è°ˆåˆ° finalå…³é”®å­— å¸¦æ¥çš„ å¯è§æ€§ æ—¶æ›¾ç»æåˆ°è¿‡è¿™ä¸€ç‚¹ï¼Œ<br>åªè¦ä¸€ä¸ª ä¸å¯å˜çš„å¯¹è±¡ è¢«æ­£ç¡®åœ° æ„å»ºå‡ºæ¥ï¼ˆæ²¡æœ‰å‘ç”Ÿ this å¼•ç”¨é€ƒé€¸ çš„æƒ…å†µï¼‰ï¼Œ<br>é‚£å…¶å¤–éƒ¨çš„ å¯è§çŠ¶æ€ æ°¸è¿œä¹Ÿä¸ä¼šæ”¹å˜ï¼Œ<br>æ°¸è¿œä¹Ÿä¸ä¼šçœ‹åˆ°å®ƒåœ¨ å¤šä¸ªçº¿ç¨‹ä¹‹ä¸­ å¤„äº ä¸ä¸€è‡´ çš„çŠ¶æ€ã€‚</p><p>â€œä¸å¯å˜â€ å¸¦æ¥çš„ å®‰å…¨æ€§ æ˜¯ æœ€ç®€å•å’Œæœ€çº¯ç²¹çš„ã€‚</p><p>Javaè¯­è¨€ä¸­ï¼Œå¦‚æœ å…±äº«æ•°æ® æ˜¯ä¸€ä¸ªåŸºæœ¬æ•°æ®ç±»å‹ï¼Œé‚£ä¹ˆåªè¦åœ¨ å®šä¹‰æ—¶ ä½¿ç”¨ finalå…³é”®å­— ä¿®é¥°å®ƒ å°±å¯ä»¥ä¿è¯å®ƒæ˜¯ ä¸å¯å˜çš„ã€‚</p><p>å¦‚æœ å…±äº«æ•°æ® æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£å°±éœ€è¦ä¿è¯ å¯¹è±¡çš„è¡Œä¸º ä¸ä¼šå¯¹å…¶ çŠ¶æ€ äº§ç”Ÿä»»ä½•å½±å“ æ‰è¡Œï¼Œ</p><p>å¦‚æœè¯»è€…è¿˜æ²¡æƒ³æ˜ç™½è¿™å¥è¯ï¼Œä¸å¦¨æƒ³ä¸€æƒ³ java.lang.String ç±»çš„å¯¹è±¡ï¼Œå®ƒæ˜¯ä¸€ä¸ªå…¸å‹çš„ ä¸å¯å˜å¯¹è±¡ï¼Œ<br>æˆ‘ä»¬è°ƒç”¨å®ƒçš„ substring()ã€replace()å’Œconcat() è¿™äº›æ–¹æ³•éƒ½ ä¸ä¼šå½±å“å®ƒ åŸæ¥çš„å€¼ï¼Œåªä¼šè¿”å›ä¸€ä¸ªæ–°æ„é€ çš„å­—ç¬¦ä¸²å¯¹è±¡ã€‚</p><p>ä¿è¯å¯¹è±¡è¡Œä¸º ä¸å½±å“ è‡ªå·±çŠ¶æ€çš„é€”å¾„ æœ‰å¾ˆå¤šç§ï¼Œ<br>å…¶ä¸­æœ€ç®€å•çš„å°±æ˜¯æŠŠå¯¹è±¡ä¸­ å¸¦æœ‰çŠ¶æ€çš„å˜é‡ éƒ½å£°æ˜ä¸º finalï¼Œ<br>è¿™æ ·åœ¨ æ„é€ å‡½æ•° ç»“æŸä¹‹åï¼Œå®ƒå°±æ˜¯ ä¸å¯å˜çš„ï¼Œ<br>ä¾‹å¦‚ä»£ç æ¸…å•13-1ä¸­java.lang.Integer æ„é€ å‡½æ•°æ‰€ç¤ºçš„ï¼Œ<br>å®ƒé€šè¿‡å°† å†…éƒ¨çŠ¶æ€å˜é‡ value å®šä¹‰ä¸º final æ¥ä¿éšœ çŠ¶æ€ä¸å˜ã€‚</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">                                ä»£ç æ¸…å• 13-1 JDKä¸­Integerç±»çš„æ„é€ å‡½æ•°</span></span><br><span class="line">----------------------------------------------------------------------------------------------</span><br><span class="line">/*<span class="strong">*</span></span><br><span class="line"><span class="strong">  *</span> The value of the &lt;code&gt;Integer&lt;/code&gt;.</span><br><span class="line"><span class="code">  * @serial</span></span><br><span class="line"><span class="code">  */</span></span><br><span class="line"><span class="code">  private final int value;</span></span><br><span class="line"></span><br><span class="line"><span class="code">  /**</span></span><br><span class="line"><span class="code">    * Constructs newly allocated &lt;code&gt;Integer&lt;/code&gt; object that</span></span><br><span class="line"><span class="code">    * represents the specified &lt;code&gt;int&lt;/code&gt; value.</span></span><br><span class="line"><span class="code">    *</span></span><br><span class="line"><span class="code">    * @param value the value to be represented by the &lt;code&gt;Integer&lt;/code&gt; object.</span></span><br><span class="line"><span class="code">    *</span></span><br><span class="line"><span class="code">    */</span></span><br><span class="line"><span class="code">    public Integer(int value)&#123;</span></span><br><span class="line"><span class="code">      this.value=value;</span></span><br><span class="line"><span class="code">    &#125;</span></span><br><span class="line">----------------------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure><p>åœ¨ Java API ä¸­ ç¬¦åˆ ä¸å¯å˜è¦æ±‚ çš„ç±»å‹ï¼Œ<br>é™¤äº†ä¸Šé¢æåˆ°çš„ String ä¹‹å¤–ï¼Œ<br>å¸¸ç”¨çš„è¿˜æœ‰ æšä¸¾ç±»å‹ï¼Œä»¥åŠ java.lang.Numberçš„éƒ¨åˆ†å­ç±»ï¼Œ<br>å¦‚Longå’ŒDoubleç­‰æ•°å€¼åŒ…è£…ç±»å‹ï¼ŒBigIntegerå’ŒBigDecimalç­‰å¤§æ•°æ®ç±»å‹ï¼›</p><p>ä½†åŒä¸º Number çš„ å­ç±»å‹ çš„ åŸå­ç±» AtomicInteger å’Œ AtomicLong åˆ™å¹¶éä¸å¯å˜çš„ï¼Œ<br>è¯»è€…ä¸å¦¨çœ‹çœ‹è¿™ä¸¤ä¸ªåŸå­ç±»çš„æºç ï¼Œæƒ³ä¸€æƒ³ä¸ºä»€ä¹ˆã€‚</p><p>(emmï¼ŒåŸå› æ˜¯ä¸æ˜¯é‚£ä¸ªvalueæ²¡æœ‰è¢«æ ‡ä¸ºfinalï¼ŸIntegerç±»å½“ä¸­çš„valueè¢«æ ‡è®°ä¸ºfinaläº†ï¼Œè€ŒAtomicIntegerä»¥åŠAtomicLongé‡Œé¢çš„valueéƒ½æ²¡æœ‰è¢«æ ‡è®°ä¸ºfinal)</p><p>AtomicIntegerç±»ä»£ç ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br></pre></td><td class="code"><pre><span class="line">                                ä»£ç æ¸…å• AtomicIntegerç±»</span><br><span class="line">----------------------------------------------------------------------------------------------</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Written by Doug Lea with assistance from members of JCP JSR-166</span></span><br><span class="line"><span class="comment"> * Expert Group and released to the public domain, as explained at</span></span><br><span class="line"><span class="comment"> * http://creativecommons.org/publicdomain/zero/1.0/</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">package java.util.concurrent.atomic;</span><br><span class="line"><span class="keyword">import</span> java.util.function.IntUnaryOperator;</span><br><span class="line"><span class="keyword">import</span> java.util.function.IntBinaryOperator;</span><br><span class="line"><span class="keyword">import</span> sun.misc.Unsafe;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>An &#123;@code int&#125; value that may be updated atomically.  See </span>the</span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>&#123;@link java.util.concurrent.atomic&#125; package specification for</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>description of </span>the<span class="markdown"> properties of atomic variables. An</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>&#123;@code AtomicInteger&#125; is used in applications </span>such<span class="markdown"> as atomically</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>incremented counters, and cannot be used as </span>a<span class="markdown"> replacement for </span>an</span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>&#123;@link java.lang.Integer&#125;. However, this class does extend</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>&#123;@code Number&#125; to allow uniform access by tools and utilities that</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>deal with numerically-based classes.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"> *</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>@since 1.5</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet"> * </span>@author Doug Lea</span></span></span><br><span class="line"><span class="comment"><span class="markdown">*/</span></span></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">AtomicInteger</span> <span class="keyword">extends</span> <span class="title">Number</span> <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    private <span class="keyword">static</span> <span class="keyword">final</span> long serialVersionUID = <span class="number">6214790243416807050</span>L;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// setup to use Unsafe.compareAndSwapInt for updates</span></span><br><span class="line">    private <span class="keyword">static</span> <span class="keyword">final</span> Unsafe unsafe = Unsafe.getUnsafe();</span><br><span class="line">    private <span class="keyword">static</span> <span class="keyword">final</span> long valueOffset;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            valueOffset = unsafe.objectFieldOffset</span><br><span class="line">                (AtomicInteger<span class="class">.<span class="keyword">class</span>.<span class="title">getDeclaredField</span>("<span class="title">value</span>"));</span></span><br><span class="line"><span class="class">        &#125; <span class="title">catch</span> (<span class="title">Exception</span> <span class="title">ex</span>) </span>&#123; <span class="keyword">throw</span> <span class="keyword">new</span> Error(ex); &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private volatile <span class="built_in">int</span> value;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>Creates </span>a<span class="markdown"> new AtomicInteger with </span>the<span class="markdown"> given initial value.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@param initialValue </span>the<span class="markdown"> initial value</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    public AtomicInteger(<span class="built_in">int</span> initialValue) &#123;</span><br><span class="line">        value = initialValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>Creates </span>a<span class="markdown"> new AtomicInteger with initial value &#123;@code 0&#125;.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    public AtomicInteger() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>Gets </span>the<span class="markdown"> current value.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@return </span>the<span class="markdown"> current value</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    public <span class="keyword">final</span> <span class="built_in">int</span> <span class="keyword">get</span>() &#123;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>Sets to </span>the<span class="markdown"> given value.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@param newValue </span>the<span class="markdown"> new value</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    public <span class="keyword">final</span> <span class="keyword">void</span> <span class="keyword">set</span>(<span class="built_in">int</span> newValue) &#123;</span><br><span class="line">        value = newValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>Eventually sets to </span>the<span class="markdown"> given value.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@param newValue </span>the<span class="markdown"> new value</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@since 1.6</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    public <span class="keyword">final</span> <span class="keyword">void</span> lazySet(<span class="built_in">int</span> newValue) &#123;</span><br><span class="line">        unsafe.putOrderedInt(<span class="keyword">this</span>, valueOffset, newValue);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>Atomically sets to </span>the<span class="markdown"> given value and returns </span>the<span class="markdown"> old value.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@param newValue </span>the<span class="markdown"> new value</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@return </span>the<span class="markdown"> previous value</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    public <span class="keyword">final</span> <span class="built_in">int</span> getAndSet(<span class="built_in">int</span> newValue) &#123;</span><br><span class="line">        <span class="keyword">return</span> unsafe.getAndSetInt(<span class="keyword">this</span>, valueOffset, newValue);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>Atomically sets </span>the<span class="markdown"> value to </span>the<span class="markdown"> given updated value</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>if </span>the<span class="markdown"> current value &#123;@code ==&#125; </span>the<span class="markdown"> expected value.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@param expect </span>the<span class="markdown"> expected value</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@param update </span>the<span class="markdown"> new value</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@return &#123;@code true&#125; if successful. False return indicates that</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span></span>the<span class="markdown"> actual value was not equal to </span>the<span class="markdown"> expected value.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    public <span class="keyword">final</span> boolean compareAndSet(<span class="built_in">int</span> expect, <span class="built_in">int</span> update) &#123;</span><br><span class="line">        <span class="keyword">return</span> unsafe.compareAndSwapInt(<span class="keyword">this</span>, valueOffset, expect, update);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>Atomically sets </span>the<span class="markdown"> value to </span>the<span class="markdown"> given updated value</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>if </span>the<span class="markdown"> current value &#123;@code ==&#125; </span>the<span class="markdown"> expected value.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span><span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><span class="xml"><span class="tag">&lt;</span></span></span>a<span class="markdown"><span class="xml"> href="package-summary.html#weakCompareAndSet"&gt;</span>May fail</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>spuriously and does not provide ordering guarantees<span class="xml"><span class="tag">&lt;/</span></span></span>a<span class="markdown"><span class="xml">&gt;</span>, </span>so<span class="markdown"> is</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>only rarely </span>an<span class="markdown"> appropriate alternative to &#123;@code compareAndSet&#125;.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@param expect </span>the<span class="markdown"> expected value</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@param update </span>the<span class="markdown"> new value</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@return &#123;@code true&#125; if successful</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    public <span class="keyword">final</span> boolean weakCompareAndSet(<span class="built_in">int</span> expect, <span class="built_in">int</span> update) &#123;</span><br><span class="line">        <span class="keyword">return</span> unsafe.compareAndSwapInt(<span class="keyword">this</span>, valueOffset, expect, update);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>Atomically increments by one </span>the<span class="markdown"> current value.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@return </span>the<span class="markdown"> previous value</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    public <span class="keyword">final</span> <span class="built_in">int</span> getAndIncrement() &#123;</span><br><span class="line">        <span class="keyword">return</span> unsafe.getAndAddInt(<span class="keyword">this</span>, valueOffset, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>Atomically decrements by one </span>the<span class="markdown"> current value.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@return </span>the<span class="markdown"> previous value</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    public <span class="keyword">final</span> <span class="built_in">int</span> getAndDecrement() &#123;</span><br><span class="line">        <span class="keyword">return</span> unsafe.getAndAddInt(<span class="keyword">this</span>, valueOffset, <span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>Atomically adds </span>the<span class="markdown"> given value to </span>the<span class="markdown"> current value.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@param delta </span>the<span class="markdown"> value to add</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@return </span>the<span class="markdown"> previous value</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    public <span class="keyword">final</span> <span class="built_in">int</span> getAndAdd(<span class="built_in">int</span> delta) &#123;</span><br><span class="line">        <span class="keyword">return</span> unsafe.getAndAddInt(<span class="keyword">this</span>, valueOffset, delta);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>Atomically increments by one </span>the<span class="markdown"> current value.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@return </span>the<span class="markdown"> updated value</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    public <span class="keyword">final</span> <span class="built_in">int</span> incrementAndGet() &#123;</span><br><span class="line">        <span class="keyword">return</span> unsafe.getAndAddInt(<span class="keyword">this</span>, valueOffset, <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>Atomically decrements by one </span>the<span class="markdown"> current value.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@return </span>the<span class="markdown"> updated value</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    public <span class="keyword">final</span> <span class="built_in">int</span> decrementAndGet() &#123;</span><br><span class="line">        <span class="keyword">return</span> unsafe.getAndAddInt(<span class="keyword">this</span>, valueOffset, <span class="number">-1</span>) - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>Atomically adds </span>the<span class="markdown"> given value to </span>the<span class="markdown"> current value.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@param delta </span>the<span class="markdown"> value to add</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@return </span>the<span class="markdown"> updated value</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    public <span class="keyword">final</span> <span class="built_in">int</span> addAndGet(<span class="built_in">int</span> delta) &#123;</span><br><span class="line">        <span class="keyword">return</span> unsafe.getAndAddInt(<span class="keyword">this</span>, valueOffset, delta) + delta;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>Atomically updates </span>the<span class="markdown"> current value with </span>the<span class="markdown"> results of</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>applying </span>the<span class="markdown"> given function, returning </span>the<span class="markdown"> previous value. The</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>function </span>should<span class="markdown"> be side-effect-free, since it may be re-applied</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>when attempted updates fail due to contention among threads.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@param updateFunction </span>a<span class="markdown"> side-effect-free function</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@return </span>the<span class="markdown"> previous value</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@since 1.8</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    public <span class="keyword">final</span> <span class="built_in">int</span> getAndUpdate(IntUnaryOperator updateFunction) &#123;</span><br><span class="line">        <span class="built_in">int</span> prev, next;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            prev = <span class="keyword">get</span>();</span><br><span class="line">            next = updateFunction.applyAsInt(prev);</span><br><span class="line">        &#125; <span class="keyword">while</span> (!compareAndSet(prev, next));</span><br><span class="line">        <span class="keyword">return</span> prev;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>Atomically updates </span>the<span class="markdown"> current value with </span>the<span class="markdown"> results of</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>applying </span>the<span class="markdown"> given function, returning </span>the<span class="markdown"> updated value. The</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>function </span>should<span class="markdown"> be side-effect-free, since it may be re-applied</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>when attempted updates fail due to contention among threads.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@param updateFunction </span>a<span class="markdown"> side-effect-free function</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@return </span>the<span class="markdown"> updated value</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@since 1.8</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    public <span class="keyword">final</span> <span class="built_in">int</span> updateAndGet(IntUnaryOperator updateFunction) &#123;</span><br><span class="line">        <span class="built_in">int</span> prev, next;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            prev = <span class="keyword">get</span>();</span><br><span class="line">            next = updateFunction.applyAsInt(prev);</span><br><span class="line">        &#125; <span class="keyword">while</span> (!compareAndSet(prev, next));</span><br><span class="line">        <span class="keyword">return</span> next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>Atomically updates </span>the<span class="markdown"> current value with </span>the<span class="markdown"> results of</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>applying </span>the<span class="markdown"> given function to </span>the<span class="markdown"> current and given values,</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>returning </span>the<span class="markdown"> previous value. The function </span>should<span class="markdown"> be</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>side-effect-free, since it may be re-applied when attempted</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>updates fail due to contention among threads.  The function</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>is applied with </span>the<span class="markdown"> current value as its first argument,</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>and </span>the<span class="markdown"> given update as </span>the<span class="markdown"> second argument.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@param x </span>the<span class="markdown"> update value</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@param accumulatorFunction </span>a<span class="markdown"> side-effect-free function of two arguments</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@return </span>the<span class="markdown"> previous value</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@since 1.8</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    public <span class="keyword">final</span> <span class="built_in">int</span> getAndAccumulate(<span class="built_in">int</span> x,</span><br><span class="line">                                      IntBinaryOperator accumulatorFunction) &#123;</span><br><span class="line">        <span class="built_in">int</span> prev, next;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            prev = <span class="keyword">get</span>();</span><br><span class="line">            next = accumulatorFunction.applyAsInt(prev, x);</span><br><span class="line">        &#125; <span class="keyword">while</span> (!compareAndSet(prev, next));</span><br><span class="line">        <span class="keyword">return</span> prev;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>Atomically updates </span>the<span class="markdown"> current value with </span>the<span class="markdown"> results of</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>applying </span>the<span class="markdown"> given function to </span>the<span class="markdown"> current and given values,</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>returning </span>the<span class="markdown"> updated value. The function </span>should<span class="markdown"> be</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>side-effect-free, since it may be re-applied when attempted</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>updates fail due to contention among threads.  The function</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>is applied with </span>the<span class="markdown"> current value as its first argument,</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>and </span>the<span class="markdown"> given update as </span>the<span class="markdown"> second argument.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@param x </span>the<span class="markdown"> update value</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@param accumulatorFunction </span>a<span class="markdown"> side-effect-free function of two arguments</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@return </span>the<span class="markdown"> updated value</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@since 1.8</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    public <span class="keyword">final</span> <span class="built_in">int</span> accumulateAndGet(<span class="built_in">int</span> x,</span><br><span class="line">                                      IntBinaryOperator accumulatorFunction) &#123;</span><br><span class="line">        <span class="built_in">int</span> prev, next;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            prev = <span class="keyword">get</span>();</span><br><span class="line">            next = accumulatorFunction.applyAsInt(prev, x);</span><br><span class="line">        &#125; <span class="keyword">while</span> (!compareAndSet(prev, next));</span><br><span class="line">        <span class="keyword">return</span> next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>Returns </span>the<span class="markdown"> String representation of </span>the<span class="markdown"> current value.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@return </span>the<span class="markdown"> String representation of </span>the<span class="markdown"> current value</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    public <span class="built_in">String</span> toString() &#123;</span><br><span class="line">        <span class="keyword">return</span> Integer.toString(<span class="keyword">get</span>());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>Returns </span>the<span class="markdown"> value of this &#123;@code AtomicInteger&#125; as </span>an<span class="markdown"> &#123;@code int&#125;.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    public <span class="built_in">int</span> intValue() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">get</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>Returns </span>the<span class="markdown"> value of this &#123;@code AtomicInteger&#125; as </span>a<span class="markdown"> &#123;@code long&#125;</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>after </span>a<span class="markdown"> widening primitive conversion.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@jls 5.1.2 Widening Primitive Conversions</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    public long longValue() &#123;</span><br><span class="line">        <span class="keyword">return</span> (long)<span class="keyword">get</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>Returns </span>the<span class="markdown"> value of this &#123;@code AtomicInteger&#125; as </span>a<span class="markdown"> &#123;@code float&#125;</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>after </span>a<span class="markdown"> widening primitive conversion.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@jls 5.1.2 Widening Primitive Conversions</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    public float floatValue() &#123;</span><br><span class="line">        <span class="keyword">return</span> (float)<span class="keyword">get</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>Returns </span>the<span class="markdown"> value of this &#123;@code AtomicInteger&#125; as </span>a<span class="markdown"> &#123;@code double&#125;</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>after </span>a<span class="markdown"> widening primitive conversion.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">     * </span>@jls 5.1.2 Widening Primitive Conversions</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">     */</span></span></span></span><br><span class="line">    public <span class="built_in">double</span> doubleValue() &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">double</span>)<span class="keyword">get</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">----------------------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure><p>AtomicLongç±»ä»£ç ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br></pre></td><td class="code"><pre><span class="line">                                ä»£ç æ¸…å• AtomicLongç±»</span><br><span class="line">----------------------------------------------------------------------------------------------</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Written by Doug Lea with assistance from members of JCP JSR-166</span></span><br><span class="line"><span class="comment"> * Expert Group and released to the public domain, as explained at</span></span><br><span class="line"><span class="comment"> * http://creativecommons.org/publicdomain/zero/1.0/</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> java.util.concurrent.atomic;</span><br><span class="line"><span class="keyword">import</span> java.util.function.LongUnaryOperator;</span><br><span class="line"><span class="keyword">import</span> java.util.function.LongBinaryOperator;</span><br><span class="line"><span class="keyword">import</span> sun.misc.Unsafe;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * A &#123;<span class="doctag">@code</span> long&#125; value that may be updated atomically.  See the</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@link</span> java.util.concurrent.atomic&#125; package specification for</span></span><br><span class="line"><span class="comment"> * description of the properties of atomic variables. An</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@code</span> AtomicLong&#125; is used in applications such as atomically</span></span><br><span class="line"><span class="comment"> * incremented sequence numbers, and cannot be used as a replacement</span></span><br><span class="line"><span class="comment"> * for a &#123;<span class="doctag">@link</span> java.lang.Long&#125;. However, this class does extend</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@code</span> Number&#125; to allow uniform access by tools and utilities that</span></span><br><span class="line"><span class="comment"> * deal with numerically-based classes.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.5</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Doug Lea</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AtomicLong</span> <span class="keyword">extends</span> <span class="title">Number</span> <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span> &#123;</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1927816293512124184</span>L;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// setup to use Unsafe.compareAndSwapLong for updates</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Unsafe unsafe = Unsafe.getUnsafe();</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> valueOffset;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Records whether the underlying JVM supports lockless</span></span><br><span class="line"><span class="comment">     * compareAndSwap for longs. While the Unsafe.compareAndSwapLong</span></span><br><span class="line"><span class="comment">     * method works in either case, some constructions should be</span></span><br><span class="line"><span class="comment">     * handled at Java level to avoid locking user-visible locks.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">boolean</span> VM_SUPPORTS_LONG_CAS = VMSupportsCS8();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns whether underlying JVM supports lockless CompareAndSet</span></span><br><span class="line"><span class="comment">     * for longs. Called only once and cached in VM_SUPPORTS_LONG_CAS.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> native <span class="keyword">boolean</span> VMSupportsCS8();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            valueOffset = unsafe.objectFieldOffset</span><br><span class="line">                (AtomicLong<span class="class">.<span class="keyword">class</span>.<span class="title">getDeclaredField</span>("<span class="title">value</span>"));</span></span><br><span class="line"><span class="class">        &#125; <span class="title">catch</span> (<span class="title">Exception</span> <span class="title">ex</span>) &#123;</span> <span class="keyword">throw</span> <span class="keyword">new</span> Error(ex); &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">long</span> value;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Creates a new AtomicLong with the given initial value.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> initialValue the initial value</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> AtomicLong(<span class="keyword">long</span> initialValue) &#123;</span><br><span class="line">        value = initialValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Creates a new AtomicLong with initial value &#123;<span class="doctag">@code</span> 0&#125;.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> AtomicLong() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Gets the current value.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the current value</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">long</span> get() &#123;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sets to the given value.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> newValue the new value</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> set(<span class="keyword">long</span> newValue) &#123;</span><br><span class="line">        value = newValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Eventually sets to the given value.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> newValue the new value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 1.6</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> lazySet(<span class="keyword">long</span> newValue) &#123;</span><br><span class="line">        unsafe.putOrderedLong(<span class="keyword">this</span>, valueOffset, newValue);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Atomically sets to the given value and returns the old value.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> newValue the new value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the previous value</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">long</span> getAndSet(<span class="keyword">long</span> newValue) &#123;</span><br><span class="line">        <span class="keyword">return</span> unsafe.getAndSetLong(<span class="keyword">this</span>, valueOffset, newValue);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Atomically sets the value to the given updated value</span></span><br><span class="line"><span class="comment">     * if the current value &#123;<span class="doctag">@code</span> ==&#125; the expected value.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> expect the expected value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> update the new value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if successful. False return indicates that</span></span><br><span class="line"><span class="comment">     * the actual value was not equal to the expected value.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> compareAndSet(<span class="keyword">long</span> expect, <span class="keyword">long</span> update) &#123;</span><br><span class="line">        <span class="keyword">return</span> unsafe.compareAndSwapLong(<span class="keyword">this</span>, valueOffset, expect, update);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Atomically sets the value to the given updated value</span></span><br><span class="line"><span class="comment">     * if the current value &#123;<span class="doctag">@code</span> ==&#125; the expected value.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;&lt;a href="package-summary.html#weakCompareAndSet"&gt;May fail</span></span><br><span class="line"><span class="comment">     * spuriously and does not provide ordering guarantees&lt;/a&gt;, so is</span></span><br><span class="line"><span class="comment">     * only rarely an appropriate alternative to &#123;<span class="doctag">@code</span> compareAndSet&#125;.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> expect the expected value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> update the new value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if successful</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> weakCompareAndSet(<span class="keyword">long</span> expect, <span class="keyword">long</span> update) &#123;</span><br><span class="line">        <span class="keyword">return</span> unsafe.compareAndSwapLong(<span class="keyword">this</span>, valueOffset, expect, update);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Atomically increments by one the current value.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the previous value</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">long</span> getAndIncrement() &#123;</span><br><span class="line">        <span class="keyword">return</span> unsafe.getAndAddLong(<span class="keyword">this</span>, valueOffset, <span class="number">1</span>L);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Atomically decrements by one the current value.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the previous value</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">long</span> getAndDecrement() &#123;</span><br><span class="line">        <span class="keyword">return</span> unsafe.getAndAddLong(<span class="keyword">this</span>, valueOffset, <span class="number">-1</span>L);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Atomically adds the given value to the current value.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> delta the value to add</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the previous value</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">long</span> getAndAdd(<span class="keyword">long</span> delta) &#123;</span><br><span class="line">        <span class="keyword">return</span> unsafe.getAndAddLong(<span class="keyword">this</span>, valueOffset, delta);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Atomically increments by one the current value.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the updated value</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">long</span> incrementAndGet() &#123;</span><br><span class="line">        <span class="keyword">return</span> unsafe.getAndAddLong(<span class="keyword">this</span>, valueOffset, <span class="number">1</span>L) + <span class="number">1</span>L;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Atomically decrements by one the current value.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the updated value</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">long</span> decrementAndGet() &#123;</span><br><span class="line">        <span class="keyword">return</span> unsafe.getAndAddLong(<span class="keyword">this</span>, valueOffset, <span class="number">-1</span>L) - <span class="number">1</span>L;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Atomically adds the given value to the current value.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> delta the value to add</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the updated value</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">long</span> addAndGet(<span class="keyword">long</span> delta) &#123;</span><br><span class="line">        <span class="keyword">return</span> unsafe.getAndAddLong(<span class="keyword">this</span>, valueOffset, delta) + delta;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Atomically updates the current value with the results of</span></span><br><span class="line"><span class="comment">     * applying the given function, returning the previous value. The</span></span><br><span class="line"><span class="comment">     * function should be side-effect-free, since it may be re-applied</span></span><br><span class="line"><span class="comment">     * when attempted updates fail due to contention among threads.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> updateFunction a side-effect-free function</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the previous value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 1.8</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">long</span> getAndUpdate(LongUnaryOperator updateFunction) &#123;</span><br><span class="line">        <span class="keyword">long</span> prev, next;</span><br><span class="line">        do &#123;</span><br><span class="line">            prev = get();</span><br><span class="line">            next = updateFunction.applyAsLong(prev);</span><br><span class="line">        &#125; <span class="keyword">while</span> (!compareAndSet(prev, next));</span><br><span class="line">        <span class="keyword">return</span> prev;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Atomically updates the current value with the results of</span></span><br><span class="line"><span class="comment">     * applying the given function, returning the updated value. The</span></span><br><span class="line"><span class="comment">     * function should be side-effect-free, since it may be re-applied</span></span><br><span class="line"><span class="comment">     * when attempted updates fail due to contention among threads.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> updateFunction a side-effect-free function</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the updated value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 1.8</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">long</span> updateAndGet(LongUnaryOperator updateFunction) &#123;</span><br><span class="line">        <span class="keyword">long</span> prev, next;</span><br><span class="line">        do &#123;</span><br><span class="line">            prev = get();</span><br><span class="line">            next = updateFunction.applyAsLong(prev);</span><br><span class="line">        &#125; <span class="keyword">while</span> (!compareAndSet(prev, next));</span><br><span class="line">        <span class="keyword">return</span> next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Atomically updates the current value with the results of</span></span><br><span class="line"><span class="comment">     * applying the given function to the current and given values,</span></span><br><span class="line"><span class="comment">     * returning the previous value. The function should be</span></span><br><span class="line"><span class="comment">     * side-effect-free, since it may be re-applied when attempted</span></span><br><span class="line"><span class="comment">     * updates fail due to contention among threads.  The function</span></span><br><span class="line"><span class="comment">     * is applied with the current value as its first argument,</span></span><br><span class="line"><span class="comment">     * and the given update as the second argument.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> x the update value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> accumulatorFunction a side-effect-free function of two arguments</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the previous value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 1.8</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">long</span> getAndAccumulate(<span class="keyword">long</span> x,</span><br><span class="line">                                       LongBinaryOperator accumulatorFunction) &#123;</span><br><span class="line">        <span class="keyword">long</span> prev, next;</span><br><span class="line">        do &#123;</span><br><span class="line">            prev = get();</span><br><span class="line">            next = accumulatorFunction.applyAsLong(prev, x);</span><br><span class="line">        &#125; <span class="keyword">while</span> (!compareAndSet(prev, next));</span><br><span class="line">        <span class="keyword">return</span> prev;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Atomically updates the current value with the results of</span></span><br><span class="line"><span class="comment">     * applying the given function to the current and given values,</span></span><br><span class="line"><span class="comment">     * returning the updated value. The function should be</span></span><br><span class="line"><span class="comment">     * side-effect-free, since it may be re-applied when attempted</span></span><br><span class="line"><span class="comment">     * updates fail due to contention among threads.  The function</span></span><br><span class="line"><span class="comment">     * is applied with the current value as its first argument,</span></span><br><span class="line"><span class="comment">     * and the given update as the second argument.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> x the update value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> accumulatorFunction a side-effect-free function of two arguments</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the updated value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 1.8</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">long</span> accumulateAndGet(<span class="keyword">long</span> x,</span><br><span class="line">                                       LongBinaryOperator accumulatorFunction) &#123;</span><br><span class="line">        <span class="keyword">long</span> prev, next;</span><br><span class="line">        do &#123;</span><br><span class="line">            prev = get();</span><br><span class="line">            next = accumulatorFunction.applyAsLong(prev, x);</span><br><span class="line">        &#125; <span class="keyword">while</span> (!compareAndSet(prev, next));</span><br><span class="line">        <span class="keyword">return</span> next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the String representation of the current value.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the String representation of the current value</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String toString() &#123;</span><br><span class="line">        <span class="keyword">return</span> Long.toString(get());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the value of this &#123;<span class="doctag">@code</span> AtomicLong&#125; as an &#123;<span class="doctag">@code</span> int&#125;</span></span><br><span class="line"><span class="comment">     * after a narrowing primitive conversion.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@jls</span> 5.1.3 Narrowing Primitive Conversions</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> intValue() &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">int</span>)get();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the value of this &#123;<span class="doctag">@code</span> AtomicLong&#125; as a &#123;<span class="doctag">@code</span> long&#125;.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">long</span> longValue() &#123;</span><br><span class="line">        <span class="keyword">return</span> get();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the value of this &#123;<span class="doctag">@code</span> AtomicLong&#125; as a &#123;<span class="doctag">@code</span> float&#125;</span></span><br><span class="line"><span class="comment">     * after a widening primitive conversion.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@jls</span> 5.1.2 Widening Primitive Conversions</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">float</span> floatValue() &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">float</span>)get();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the value of this &#123;<span class="doctag">@code</span> AtomicLong&#125; as a &#123;<span class="doctag">@code</span> double&#125;</span></span><br><span class="line"><span class="comment">     * after a widening primitive conversion.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@jls</span> 5.1.2 Widening Primitive Conversions</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">double</span> doubleValue() &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">double</span>)get();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">----------------------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure><h6 id="2-ç»å¯¹çº¿ç¨‹å®‰å…¨"><a href="#2-ç»å¯¹çº¿ç¨‹å®‰å…¨" class="headerlink" title="2.ç»å¯¹çº¿ç¨‹å®‰å…¨"></a>2.ç»å¯¹çº¿ç¨‹å®‰å…¨</h6><p>ç»å¯¹çš„ çº¿ç¨‹å®‰å…¨ å®Œå…¨æ»¡è¶³ Brian Goetz ç»™å‡ºçš„ çº¿ç¨‹å®‰å…¨ çš„å®šä¹‰ï¼Œ<br>è¿™ä¸ª å®šä¹‰ å…¶å®æ˜¯å¾ˆ ä¸¥æ ¼çš„ï¼Œ<br>ä¸€ä¸ªç±» è¦è¾¾åˆ° â€œä¸ç®¡ è¿è¡Œæ—¶ç¯å¢ƒ å¦‚ä½•ï¼Œ è°ƒç”¨è€… éƒ½ä¸éœ€è¦ ä»»ä½•é¢å¤–çš„ åŒæ­¥æªæ–½â€ é€šå¸¸éœ€è¦ä»˜å‡ºå¾ˆå¤§çš„ï¼Œç”šè‡³æœ‰æ—¶å€™æ˜¯ä¸åˆ‡å®é™…çš„ä»£ä»·ã€‚</p><p>åœ¨ Java APIä¸­ æ ‡æ³¨è‡ªå·±æ˜¯ çº¿ç¨‹å®‰å…¨çš„ç±»ï¼Œå¤§å¤šæ•°éƒ½ä¸æ˜¯ ç»å¯¹çš„çº¿ç¨‹å®‰å…¨ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ Java APIä¸­ ä¸€ä¸ªä¸æ˜¯ â€œç»å¯¹çº¿ç¨‹å®‰å…¨â€ çš„çº¿ç¨‹å®‰å…¨ç±» æ¥çœ‹çœ‹è¿™é‡Œçš„ â€œç»å¯¹â€ æ˜¯ä»€ä¹ˆæ„æ€ã€‚</p><p>å¦‚æœè¯´ java.util.Vector æ˜¯ä¸€ä¸ª çº¿ç¨‹å®‰å…¨ çš„ å®¹å™¨ï¼Œ<br>ç›¸ä¿¡æ‰€æœ‰çš„Javaç¨‹åºå‘˜å¯¹æ­¤éƒ½ä¸ä¼šæœ‰å¼‚è®®ï¼Œå› ä¸ºå®ƒçš„ add()ã€get()å’Œsize() è¿™ç±»æ–¹æ³•éƒ½æ˜¯è¢« synchronized ä¿®é¥°çš„ï¼Œ<br>å°½ç®¡è¿™æ · æ•ˆç‡å¾ˆä½ï¼Œä½†ç¡®å®æ˜¯ å®‰å…¨çš„ã€‚</p><p>ä½†æ˜¯ï¼Œå³ä½¿å®ƒ æ‰€æœ‰çš„æ–¹æ³• éƒ½è¢« ä¿®é¥°æˆ åŒæ­¥ï¼Œä¹Ÿä¸æ„å‘³ç€ è°ƒç”¨å®ƒçš„æ—¶å€™æ°¸è¿œéƒ½ä¸éœ€è¦ åŒæ­¥æ‰‹æ®µäº†ï¼Œ<br>è¯·çœ‹ä¸€ä¸‹ä»£ç æ¸…å•13-2ä¸­çš„æµ‹è¯•ä»£ç ã€‚</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">                                ä»£ç æ¸…å• <span class="number">13</span><span class="number">-2</span> å¯¹Vectorçº¿ç¨‹å®‰å…¨çš„æµ‹è¯•</span><br><span class="line">----------------------------------------------------------------------------------------------</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> Vector&lt;Integer&gt; <span class="built_in">vector</span> = <span class="keyword">new</span> Vector&lt;Integer&gt;();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(<span class="keyword">String</span>[] args)</span></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">    <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)&#123;</span><br><span class="line">      <span class="built_in">vector</span>.add(i);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Thread removeThread = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable()&#123;</span><br><span class="line">    @Override</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="built_in">run</span>()&#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">vector</span>.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">        <span class="built_in">vector</span>.<span class="built_in">remove</span>(i);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  Thread printThread = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable()&#123;</span><br><span class="line">    @Override</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="built_in">run</span>()&#123;</span><br><span class="line">      <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">vector</span>.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">        System.out.<span class="built_in">println</span>((<span class="built_in">vector</span>.<span class="built_in">get</span>(i)));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  removeThread.start();</span><br><span class="line">  printThread.start();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//ä¸è¦åŒæ—¶äº§ç”Ÿè¿‡å¤šçš„çº¿ç¨‹ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ“ä½œç³»ç»Ÿå‡æ­»</span></span><br><span class="line">  <span class="keyword">while</span>(Thread.activeCount() &gt; <span class="number">20</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">----------------------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Exception <span class="keyword">in</span> thread <span class="string">"Thread-132"</span> java.lang.ArrayIndexOutOfBoundsException:</span><br><span class="line">Array index out <span class="keyword">of</span> range:<span class="number">17</span></span><br><span class="line">  at java.util.<span class="module-access"><span class="module"><span class="identifier">Vector</span>.</span></span>remove(<span class="module-access"><span class="module"><span class="identifier">Vector</span>.</span></span>java:<span class="number">777</span>)</span><br><span class="line">  at org.fenixsoft.mulithread.<span class="module-access"><span class="module"><span class="identifier">VectorTest$1</span>.</span></span>run(<span class="module-access"><span class="module"><span class="identifier">VectorTest</span>.</span></span>java:<span class="number">21</span>)</span><br><span class="line">  at java.lang.<span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>run(<span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>java:<span class="number">662</span>)</span><br></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾ï¼Œå°½ç®¡è¿™é‡Œä½¿ç”¨åˆ°çš„ Vectorçš„get()ã€remove()å’Œsize() æ–¹æ³•éƒ½æ˜¯ åŒæ­¥çš„ï¼Œ<br>ä½†æ˜¯åœ¨ å¤šçº¿ç¨‹ çš„ç¯å¢ƒä¸‹ï¼Œå¦‚æœä¸åœ¨ æ–¹æ³•è°ƒç”¨ç«¯ åšé¢å¤–çš„åŒæ­¥æªæ–½ çš„è¯ï¼Œ<br>ä½¿ç”¨è¿™æ®µä»£ç  ä»ç„¶æ˜¯ä¸å®‰å…¨çš„ï¼Œå› ä¸ºå¦‚æœå¦ä¸€ä¸ªçº¿ç¨‹ æ°å¥½åœ¨é”™è¯¯çš„æ—¶é—´é‡Œ åˆ é™¤äº†ä¸€ä¸ªå…ƒç´ ï¼Œ<br>å¯¼è‡´åºå· i å·²ç»ä¸å†å¯ç”¨çš„è¯ï¼Œ<br>å†ç”¨ i è®¿é—®æ•°ç»„å°±ä¼š æŠ›å‡ºä¸€ä¸ªArrayIndexOutOfBoundsException</p><p>å¦‚æœè¦ä¿è¯è¿™æ®µä»£ç èƒ½æ­£ç¡®æ‰§è¡Œä¸‹å»ï¼Œæˆ‘ä»¬ä¸å¾—ä¸æŠŠ removeThreadå’ŒprintThread çš„å®šä¹‰æ”¹æˆå¦‚ä»£ç æ¸…å•13-3æ‰€ç¤ºçš„æ ·å­ã€‚</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">                                ä»£ç æ¸…å• <span class="number">13</span><span class="number">-3</span> å¿…é¡»åŠ å…¥åŒæ­¥ ä»¥ä¿è¯Vectorè®¿é—®çš„çº¿ç¨‹å®‰å…¨æ€§</span><br><span class="line">----------------------------------------------------------------------------------------------</span><br><span class="line">Thread removeThread = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable()&#123;</span><br><span class="line">  @Override</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="built_in">run</span>()&#123;</span><br><span class="line">    synchronized(<span class="built_in">vector</span>)&#123;</span><br><span class="line">      <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">vector</span>.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">        <span class="built_in">vector</span>.<span class="built_in">remove</span>(i);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">Thread printThread = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable()&#123;</span><br><span class="line">  @Override</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="built_in">run</span>()&#123;</span><br><span class="line">    synchronized(<span class="built_in">vector</span>)&#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">vector</span>.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">        System.out.<span class="built_in">println</span>((<span class="built_in">vector</span>.<span class="built_in">get</span>(i)));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">----------------------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure><h6 id="3-ç›¸å¯¹çº¿ç¨‹å®‰å…¨"><a href="#3-ç›¸å¯¹çº¿ç¨‹å®‰å…¨" class="headerlink" title="3.ç›¸å¯¹çº¿ç¨‹å®‰å…¨"></a>3.ç›¸å¯¹çº¿ç¨‹å®‰å…¨</h6><p>ç›¸å¯¹çš„ çº¿ç¨‹å®‰å…¨ å°±æ˜¯æˆ‘ä»¬ é€šå¸¸æ„ä¹‰ä¸Š æ‰€è®²çš„ çº¿ç¨‹å®‰å…¨ï¼Œ<br>å®ƒéœ€è¦ ä¿è¯ å¯¹è¿™ä¸ªå¯¹è±¡ å•ç‹¬çš„æ“ä½œ æ˜¯ çº¿ç¨‹å®‰å…¨çš„ï¼Œ<br>æˆ‘ä»¬åœ¨ è°ƒç”¨çš„æ—¶å€™ ä¸éœ€è¦åš é¢å¤–çš„ä¿éšœæªæ–½ï¼Œä½†æ˜¯å¯¹äºä¸€äº› ç‰¹å®šé¡ºåº çš„ è¿ç»­è°ƒç”¨ï¼Œ<br>å°±å¯èƒ½éœ€è¦åœ¨ è°ƒç”¨ç«¯ ä½¿ç”¨ é¢å¤–çš„åŒæ­¥æ‰‹æ®µ æ¥ä¿è¯ è°ƒç”¨çš„æ­£ç¡®æ€§ã€‚</p><p>ä¸Šé¢ä»£ç æ¸…å•13-2å’Œä»£ç æ¸…å•13-3å°±æ˜¯ ç›¸å¯¹çº¿ç¨‹å®‰å…¨çš„ æ˜æ˜¾çš„ æ¡ˆä¾‹ã€‚</p><p>åœ¨Javaè¯­è¨€ä¸­ï¼Œå¤§éƒ¨åˆ†çš„ çº¿ç¨‹å®‰å…¨ç±» éƒ½å±äºè¿™ç§ç±»å‹ï¼Œä¾‹å¦‚ Vectorã€HashTableã€Collectionsçš„synchronizedCollection() æ–¹æ³•åŒ…è£…çš„é›†åˆ ç­‰ã€‚</p><h6 id="4-çº¿ç¨‹å…¼å®¹"><a href="#4-çº¿ç¨‹å…¼å®¹" class="headerlink" title="4.çº¿ç¨‹å…¼å®¹"></a>4.çº¿ç¨‹å…¼å®¹</h6><p>çº¿ç¨‹å…¼å®¹ æ˜¯æŒ‡ å¯¹è±¡æœ¬èº« å¹¶ä¸æ˜¯ çº¿ç¨‹å®‰å…¨çš„ï¼Œ<br>ä½†æ˜¯å¯ä»¥é€šè¿‡åœ¨ è°ƒç”¨ç«¯ æ­£ç¡®åœ° ä½¿ç”¨ åŒæ­¥æ‰‹æ®µ æ¥ä¿è¯å¯¹è±¡ åœ¨å¹¶å‘ç¯å¢ƒä¸­ å¯ä»¥å®‰å…¨åœ°ä½¿ç”¨ï¼Œ<br>æˆ‘ä»¬å¹³å¸¸è¯´ ä¸€ä¸ªç±»ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œç»å¤§å¤šæ•°æ—¶å€™æŒ‡çš„æ˜¯è¿™ä¸€ç§æƒ…å†µã€‚</p><p>Java APIä¸­å¤§éƒ¨åˆ†çš„ç±» éƒ½æ˜¯å±äº çº¿ç¨‹å…¼å®¹çš„ï¼Œå¦‚ä¸å‰é¢çš„ Vectorå’ŒHashTable ç›¸å¯¹åº”çš„é›†åˆç±» ArrayListå’ŒHashMap ç­‰ã€‚</p><h6 id="5-çº¿ç¨‹å¯¹ç«‹"><a href="#5-çº¿ç¨‹å¯¹ç«‹" class="headerlink" title="5.çº¿ç¨‹å¯¹ç«‹"></a>5.çº¿ç¨‹å¯¹ç«‹</h6><p>çº¿ç¨‹å¯¹ç«‹ æ˜¯æŒ‡æ— è®º è°ƒç”¨ç«¯ æ˜¯å¦é‡‡å–äº† åŒæ­¥æªæ–½ï¼Œ<br>éƒ½æ— æ³•åœ¨ å¤šçº¿ç¨‹ç¯å¢ƒä¸­ å¹¶å‘ä½¿ç”¨çš„ä»£ç ã€‚</p><p>ç”±äºJavaè¯­è¨€å¤©ç”Ÿå°±å…·å¤‡ å¤šçº¿ç¨‹ç‰¹æ€§ï¼Œçº¿ç¨‹å¯¹ç«‹ è¿™ç§ æ’æ–¥å¤šçº¿ç¨‹çš„ä»£ç  æ—¶å¾ˆå°‘å‡ºç°çš„ï¼Œè€Œä¸”é€šå¸¸éƒ½æ˜¯ æœ‰å®³çš„ï¼Œåº”å½“å°½é‡é¿å…ã€‚</p><p>ä¸€ä¸ªçº¿ç¨‹å¯¹ç«‹ çš„ä¾‹å­æ˜¯ Thread ç±»çš„ suspend() å’Œ resume() æ–¹æ³•ï¼Œ<br>å¦‚æœæœ‰ä¸¤ä¸ªçº¿ç¨‹ åŒæ—¶æŒæœ‰ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡ï¼Œä¸€ä¸ªå°è¯•å»ä¸­æ–­çº¿ç¨‹ï¼Œå¦ä¸€ä¸ªå°è¯•å»æ¢å¤çº¿ç¨‹ï¼Œ<br>å¦‚æœå¹¶å‘è¿›è¡Œçš„è¯ï¼Œæ— è®ºè°ƒç”¨æ—¶ æ˜¯å¦è¿›è¡Œäº†åŒæ­¥ï¼Œç›®æ ‡çº¿ç¨‹éƒ½æ˜¯å­˜åœ¨ æ­»é”é£é™© çš„ï¼Œ<br>å¦‚æœ suspend() ä¸­æ–­çš„çº¿ç¨‹ å°±æ˜¯ å³å°†è¦æ‰§è¡Œ resume() çš„é‚£ä¸ªçº¿ç¨‹ï¼Œé‚£å°±è‚¯å®šè¦äº§ç”Ÿ æ­»é” äº†ã€‚</p><p>ä¹Ÿæ­£æ˜¯ç”±äºè¿™ä¸ªåŸå› ï¼Œ suspend() å’Œ resume() æ–¹æ³•å·²ç»è¢« JDK å£°æ˜åºŸå¼ƒï¼ˆ@Deprecatedï¼‰äº†ã€‚</p><p>å¸¸è§çš„ çº¿ç¨‹å¯¹ç«‹ çš„æ“ä½œè¿˜æœ‰ System.setIn()ã€System.setOut() å’Œ System.runFinalizersOnExit()ç­‰ã€‚</p><h5 id="çº¿ç¨‹å®‰å…¨çš„å®ç°æ–¹æ³•"><a href="#çº¿ç¨‹å®‰å…¨çš„å®ç°æ–¹æ³•" class="headerlink" title="çº¿ç¨‹å®‰å…¨çš„å®ç°æ–¹æ³•"></a>çº¿ç¨‹å®‰å…¨çš„å®ç°æ–¹æ³•</h5><p>äº†è§£äº† ä»€ä¹ˆæ˜¯çº¿ç¨‹å®‰å…¨ ä¹‹åï¼Œç´§æ¥ç€çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯æˆ‘ä»¬åº”è¯¥ å¦‚ä½•å®ç°çº¿ç¨‹å®‰å…¨ï¼Œ<br>è¿™å¬èµ·æ¥ä¼¼ä¹æ˜¯ä¸€ä»¶ç”±ä»£ç å¦‚ä½•ç¼–å†™æ¥å†³å®šçš„äº‹æƒ…ï¼Œç¡®å®ï¼Œå¦‚ä½•å®ç°çº¿ç¨‹å®‰å…¨ ä¸ ä»£ç ç¼–å†™ æœ‰å¾ˆå¤§çš„å…³ç³»ï¼Œ<br>ä½† è™šæ‹Ÿæœº æä¾›çš„ åŒæ­¥å’Œé”æœºåˆ¶ ä¹Ÿèµ·åˆ°äº†éå¸¸é‡è¦çš„ä½œç”¨ã€‚</p><p>æœ¬èŠ‚ä¸­ï¼Œä»£ç ç¼–å†™å¦‚ä½•å®ç°çº¿ç¨‹å®‰å…¨ å’Œ è™šæ‹Ÿæœºå¦‚ä½•å®ç°åŒæ­¥ä¸é” è¿™ä¸¤è€…éƒ½ä¼šæœ‰æ‰€æ¶‰åŠï¼Œç›¸å¯¹è€Œè¨€æ›´åé‡åè€…ä¸€äº›ï¼Œ<br>åªè¦è¯»è€…äº†è§£äº† è™šæ‹Ÿæœºçº¿ç¨‹å®‰å…¨æ‰‹æ®µ çš„è¿ä½œè¿‡ç¨‹ï¼Œè‡ªå·±å»æ€è€ƒä»£ç å¦‚ä½•ç¼–å†™å¹¶ä¸æ˜¯ä¸€ä»¶å›°éš¾çš„äº‹æƒ…ã€‚</p><p>ï¼ˆå‘¨å¤§å¤§ï¼Œä½ æ˜¯è®¤çœŸçš„å—ï¼ŸğŸ˜­ğŸ˜­ğŸ˜­ è¯´å‡ºè¿™å¥è¯çš„æ—¶å€™ï¼Œè€ƒè™‘è¿‡åƒæˆ‘è¿™ç§å°ç™½çš„æ„Ÿå—å—ï¼ŸğŸ™ƒğŸ™ƒğŸ™ƒï¼‰</p><h6 id="1-äº’æ–¥åŒæ­¥"><a href="#1-äº’æ–¥åŒæ­¥" class="headerlink" title="1.äº’æ–¥åŒæ­¥"></a>1.äº’æ–¥åŒæ­¥</h6><p>äº’æ–¥åŒæ­¥ï¼ˆMutual Exclusion &amp; Synchronizationï¼‰ æ˜¯å¸¸è§çš„ä¸€ç§ å¹¶å‘æ­£ç¡®æ€§ä¿éšœæ‰‹æ®µã€‚</p><p>åŒæ­¥ æ˜¯æŒ‡åœ¨ å¤šä¸ªçº¿ç¨‹ å¹¶å‘è®¿é—® å…±äº«æ•°æ®æ—¶ï¼Œä¿è¯ å…±äº«æ•°æ® åœ¨åŒä¸€ä¸ªæ—¶åˆ» åªè¢«ä¸€ä¸ªï¼ˆæˆ–è€…æ˜¯ä¸€äº›ï¼Œä½¿ç”¨ä¿¡å·é‡çš„æ—¶å€™ï¼‰çº¿ç¨‹ä½¿ç”¨ã€‚</p><p>è€Œ äº’æ–¥ æ˜¯ å®ç°åŒæ­¥ çš„ ä¸€ç§æ‰‹æ®µï¼Œ<br>ä¸´ç•ŒåŒºï¼ˆCritical Sectionï¼‰ã€äº’æ–¥é‡ï¼ˆMutexï¼‰å’Œä¿¡å·é‡ï¼ˆSemaphoreï¼‰éƒ½æ˜¯ä¸»è¦çš„ äº’æ–¥å®ç°æ–¹å¼ã€‚</p><p>å› æ­¤ï¼Œåœ¨è¿™4ä¸ªå­—é‡Œé¢ï¼Œäº’æ–¥ æ˜¯ å› ï¼Œ åŒæ­¥ æ˜¯ æœï¼›äº’æ–¥ æ˜¯ æ–¹æ³•ï¼ŒåŒæ­¥ æ˜¯ ç›®çš„ã€‚</p><p>åœ¨ Java ä¸­ï¼Œæœ€åŸºæœ¬çš„ åŒæ­¥äº’æ–¥ æ‰‹æ®µå°±æ˜¯ synchronizedå…³é”®å­—ï¼Œ<br>synchronizedå…³é”®å­— ç»è¿‡ ç¼–è¯‘ ä¹‹åï¼Œ ä¼šåœ¨ åŒæ­¥å— çš„å‰å åˆ†åˆ«å½¢æˆ monitorenterå’Œmonitorexit è¿™ä¸¤ä¸ªå­—èŠ‚ç æŒ‡ä»¤ï¼Œ<br>è¿™ä¸¤ä¸ªå­—èŠ‚ç  éƒ½éœ€è¦ä¸€ä¸ª reference ç±»å‹çš„å‚æ•°æ¥æŒ‡æ˜è¦ é”å®šå’Œè§£é” çš„å¯¹è±¡ã€‚</p><p>å¦‚æœJavaç¨‹åºä¸­çš„ synchronizedæ˜ç¡®æŒ‡å®šäº† å¯¹è±¡å‚æ•°ï¼Œé‚£å°±æ˜¯ è¿™ä¸ªå¯¹è±¡çš„referenceï¼›<br>å¦‚æœæ²¡æœ‰æ˜ç¡®æŒ‡å®šï¼Œé‚£å°±æ ¹æ® synchronized ä¿®é¥°çš„æ˜¯å®ä¾‹æ–¹æ³•è¿˜æ˜¯ç±»æ–¹æ³•ï¼Œå»å–å¯¹åº”çš„ å¯¹è±¡å®ä¾‹ æˆ– Classå¯¹è±¡ æ¥ä½œä¸º é”å¯¹è±¡ã€‚</p><p>æ ¹æ® è™šæ‹Ÿæœºè§„èŒƒ çš„è¦æ±‚ï¼Œ<br>åœ¨ æ‰§è¡Œ monitorenter æŒ‡ä»¤æ—¶ï¼Œ<br>é¦–å…ˆ è¦å°è¯• è·å– å¯¹è±¡çš„é”ã€‚</p><p>å¦‚æœ è¿™ä¸ªå¯¹è±¡ æ²¡è¢« é”å®šï¼Œ<br>æˆ–è€… å½“å‰çº¿ç¨‹ å·²ç»æ‹¥æœ‰äº† é‚£ä¸ªå¯¹è±¡çš„é”ï¼Œ<br>æŠŠ é” çš„ è®¡æ•°å™¨ åŠ 1ï¼Œ<br>ç›¸åº”çš„ï¼Œ<br>åœ¨ æ‰§è¡Œ monitorexit æŒ‡ä»¤æ—¶ ä¼šå°† é”è®¡æ•°å™¨ å‡1ï¼Œ<br>å½“è®¡æ•°å™¨ä¸º0æ—¶ï¼Œé” å°± é‡Šæ”¾ã€‚</p><p>å¦‚æœ è·å– å¯¹è±¡é” å¤±è´¥ï¼Œé‚£ å½“å‰çº¿ç¨‹ å°±è¦ é˜»å¡ç­‰å¾…ï¼Œç›´åˆ° å¯¹è±¡é” è¢« å¦å¤–ä¸€ä¸ªçº¿ç¨‹ é‡Šæ”¾ä¸ºæ­¢ã€‚</p><p>åœ¨ è™šæ‹Ÿæœºè§„èŒƒ å¯¹ monitorenterå’Œmonitorexit çš„è¡Œä¸ºæè¿°ä¸­ï¼Œæœ‰ä¸¤ç‚¹æ˜¯éœ€è¦ç‰¹åˆ«æ³¨æ„çš„ã€‚</p><p>é¦–å…ˆï¼ŒsynchronizedåŒæ­¥å— å¯¹ åŒä¸€æ¡çº¿ç¨‹ æ¥è¯´ æ˜¯å¯é‡å…¥çš„ï¼Œä¸ä¼šå‡ºç° è‡ªå·±æŠŠè‡ªå·± é”æ­»çš„é—®é¢˜ã€‚</p><p>å…¶æ¬¡ï¼ŒåŒæ­¥å— åœ¨ å·²è¿›å…¥çš„çº¿ç¨‹ æ‰§è¡Œå®Œä¹‹å‰ï¼Œä¼š é˜»å¡ åé¢å…¶ä»–çº¿ç¨‹çš„è¿›å…¥ã€‚</p><p>ç¬¬12ç« è®²è¿‡ï¼ŒJavaçš„çº¿ç¨‹ æ˜¯æ˜ å°„åˆ° æ“ä½œç³»ç»Ÿ çš„ åŸç”Ÿçº¿ç¨‹ ä¹‹ä¸Šçš„ï¼Œå¦‚æœè¦ é˜»å¡æˆ–å”¤é†’ ä¸€ä¸ªçº¿ç¨‹ï¼Œéƒ½éœ€è¦ æ“ä½œç³»ç»Ÿæ¥å¸®å¿™å®Œæˆï¼Œ<br>è¿™å°±éœ€è¦ä» ç”¨æˆ·æ€ è½¬æ¢åˆ° æ ¸å¿ƒæ€ ä¸­ï¼Œå› æ­¤ çŠ¶æ€è½¬æ¢ éœ€è¦è€—è´¹ å¾ˆå¤šçš„å¤„ç†å™¨æ—¶é—´ã€‚</p><p>å¯¹äº ä»£ç ç®€å•çš„ åŒæ­¥å—ï¼ˆå¦‚è¢« synchronizedä¿®é¥°çš„ getter() æˆ– setter() æ–¹æ³•ï¼‰ï¼Œ<br>çŠ¶æ€è½¬æ¢ æ¶ˆè€—çš„æ—¶é—´ æœ‰å¯èƒ½æ¯” ç”¨æˆ·ä»£ç  æ‰§è¡Œçš„æ—¶é—´ è¿˜è¦é•¿ã€‚</p><p>æ‰€ä»¥ synchronized æ˜¯Javaè¯­è¨€ä¸­ä¸€ä¸ª é‡é‡çº§ï¼ˆHeavyweightï¼‰çš„æ“ä½œï¼Œæœ‰ç»éªŒçš„ç¨‹åºå‘˜éƒ½ä¼šåœ¨ ç¡®å®å¿…è¦ çš„æƒ…å†µä¸‹ æ‰ä½¿ç”¨è¿™ç§æ“ä½œã€‚</p><p>è€Œ è™šæ‹Ÿæœºæœ¬èº« ä¹Ÿä¼šè¿›è¡Œä¸€äº› ä¼˜åŒ–ï¼Œ<br>è­¬å¦‚åœ¨é€šçŸ¥ æ“ä½œç³»ç»Ÿé˜»å¡çº¿ç¨‹ ä¹‹å‰ åŠ å…¥ä¸€æ®µ è‡ªæ—‹ç­‰å¾…è¿‡ç¨‹ï¼Œé¿å…é¢‘ç¹åœ° åˆ‡å…¥åˆ° æ ¸å¿ƒæ€ ä¹‹ä¸­ã€‚</p><p>é™¤äº† synchronized ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ java.util.concurrent(ä¸‹æ–‡ç§°J.U.C) åŒ…ä¸­çš„ é‡å…¥é”ï¼ˆReentrantLockï¼‰ æ¥ å®ç°åŒæ­¥ï¼Œ<br>åœ¨åŸºæœ¬ç”¨æ³•ä¸Šï¼Œ ReentrantLockä¸synchronized å¾ˆç›¸ä¼¼ï¼Œ<br>å®ƒä»¬éƒ½å…·å¤‡ä¸€æ ·çš„ çº¿ç¨‹é‡å…¥ç‰¹æ€§ï¼Œåªæ˜¯ä»£ç å†™æ³•ä¸Šæœ‰ç‚¹åŒºåˆ«ï¼Œ<br>ä¸€ä¸ªè¡¨ç°ä¸º APIå±‚é¢çš„ äº’æ–¥é”ï¼ˆ lock()å’Œunlock()æ–¹æ³• é…åˆ try/finallyè¯­å¥å— æ¥å®Œæˆï¼‰ï¼Œ<br>å¦ä¸€ä¸ªè¡¨ç°ä¸º åŸç”Ÿè¯­æ³•å±‚é¢çš„äº’æ–¥é”ã€‚</p><p>ä¸è¿‡ï¼Œç›¸æ¯” synchronizedï¼ŒReentrantLock å¢åŠ äº†ä¸€äº› é«˜çº§åŠŸèƒ½ï¼Œ<br>ä¸»è¦æœ‰ä»¥ä¸‹3é¡¹ï¼š<br>ç­‰å¾…å¯ä¸­æ–­ã€å¯å®ç°å…¬å¹³é”ã€ä»¥åŠ é”å¯ä»¥ç»‘å®šå¤šä¸ªæ¡ä»¶ã€‚</p><p>ç­‰å¾…å¯ä¸­æ–­ æ˜¯æŒ‡ å½“æŒæœ‰é”çš„çº¿ç¨‹ é•¿æœŸä¸é‡Šæ”¾é” çš„æ—¶å€™ï¼Œæ­£åœ¨ ç­‰å¾…çš„çº¿ç¨‹ å¯ä»¥é€‰æ‹©æ”¾å¼ƒç­‰å¾…ï¼Œæ”¹ä¸ºå¤„ç†å…¶ä»–äº‹æƒ…ï¼Œå¯ä¸­æ–­ç‰¹æ€§ å¯¹å¤„ç†æ‰§è¡Œæ—¶é—´éå¸¸é•¿çš„ åŒæ­¥å— å¾ˆæœ‰å¸®åŠ©ã€‚</p><p>å…¬å¹³é” æ˜¯æŒ‡ å¤šä¸ªçº¿ç¨‹ åœ¨ç­‰å¾… åŒä¸€ä¸ªé” æ—¶ï¼Œå¿…é¡»æŒ‰ç…§ ç”³è¯·é” çš„æ—¶é—´é¡ºåº æ¥ä¾æ¬¡ è·å¾—é”ï¼›<br>è€Œ éå…¬å¹³é” åˆ™ä¸ä¿è¯ è¿™ä¸€ç‚¹ï¼Œ<br>åœ¨ é” è¢«é‡Šæ”¾æ—¶ï¼Œä»»ä½•ä¸€ä¸ª ç­‰å¾…é”çš„çº¿ç¨‹ éƒ½æœ‰æœºä¼š è·å¾—é”ã€‚<br>synchronized ä¸­ çš„ é” æ˜¯éå…¬å¹³çš„ï¼ŒReentrantLock é»˜è®¤æƒ…å†µä¸‹  ä¹Ÿæ˜¯éå…¬å¹³çš„ï¼Œä½†å¯ä»¥é€šè¿‡ å¸¦å¸ƒå°”å€¼ çš„ æ„é€ å‡½æ•° è¦æ±‚ä½¿ç”¨ å…¬å¹³é”ã€‚</p><p>é”ç»‘å®šå¤šä¸ªæ¡ä»¶ æ˜¯æŒ‡ ä¸€ä¸ªReentrantLockå¯¹è±¡ å¯ä»¥åŒæ—¶ ç»‘å®šå¤šä¸ªConditionå¯¹è±¡ï¼Œ<br>è€Œåœ¨ synchronizedä¸­ï¼Œ é”å¯¹è±¡ çš„ wait()å’Œnotify()æˆ–notifyAll()æ–¹æ³• å¯ä»¥å®ç°ä¸€ä¸ª éšå«çš„æ¡ä»¶ï¼Œ<br>å¦‚æœè¦å’Œ å¤šäºä¸€ä¸ªçš„æ¡ä»¶å…³è”çš„æ—¶å€™ï¼Œ å°±ä¸å¾—ä¸ é¢å¤–åœ°æ·»åŠ ä¸€ä¸ªé”ï¼Œ<br>è€Œ ReentrantLock åˆ™æ— éœ€è¿™æ ·åšï¼Œåªéœ€è¦ å¤šæ¬¡è°ƒç”¨ newCondition()æ–¹æ³• å³å¯ã€‚</p><p>å¦‚æœéœ€è¦ä½¿ç”¨ä¸Šè¿°åŠŸèƒ½ï¼Œé€‰ç”¨ ReentrantLock æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼Œ<br>é‚£å¦‚æœ æ˜¯åŸºäº æ€§èƒ½è€ƒè™‘å‘¢ï¼Ÿ<br>å…³äº synchronizedå’ŒReentrantLock çš„ æ€§èƒ½é—®é¢˜ï¼Œ<br>Brian Goetzå¯¹è¿™ä¸¤ç§é”åœ¨ JDK1.5ä¸å•æ ¸å¤„ç†å™¨ï¼Œä»¥åŠ JDK1.5ä¸åŒXeonå¤„ç†å™¨ ç¯å¢ƒä¸‹åšäº†ä¸€ç»„ ååé‡å¯¹æ¯”çš„å®éªŒï¼Œå®éªŒç»“æœå¦‚å›¾13-1å’Œå›¾13-2æ‰€ç¤ºã€‚</p><blockquote><p>æœ¬ä¾‹ä¸­çš„æ•°æ®åŠå›¾ç‰‡æ¥æºäº Brian Goetz ä¸º IBM developerWorks æ’°å†™çš„è®ºæ–‡ï¼šã€ŠJava theory and practice:More flexible, scalable locking in JDK5.0ã€‹ï¼Œ<br>åŸæ–‡åœ°å€æ˜¯ï¼š<code>http://www.ibm.com/developerworks/java/library/j-jtp10264/?S_TACT= 105AGX53&amp;S_CMP=cn-a-j</code>ã€‚</p></blockquote><p>ï¼ˆè¯¥é“¾æ¥æœ‰æ•ˆï¼Œä½†æ˜¯ï¼Œæˆ‘çœ‹çš„å¾ˆæ˜¯è‰°éš¾ğŸ˜­ğŸ˜­ğŸ˜­ğŸ˜­æ•‘æ•‘è¿™è‹¦å‘½çš„å­©å­å§ï¼Œå°±åƒå½“åˆæ¥å…¥paypalæ”¯ä»˜ğŸ™ƒğŸ™ƒğŸ™ƒğŸ™ƒï¼‰</p><p>ä»å›¾13-1å’Œå›¾13-2å¯ä»¥çœ‹å‡ºï¼Œ<br>å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ synchronizedçš„ååé‡ä¸‹é™å¾— éå¸¸ä¸¥é‡ï¼Œ<br>è€Œ ReentrantLock åˆ™èƒ½åŸºæœ¬ä¿æŒåœ¨åŒä¸€ä¸ª æ¯”è¾ƒç¨³å®šçš„æ°´å¹³ ä¸Šã€‚</p><p>ä¸å…¶è¯´ ReentrantLock æ€§èƒ½å¥½ï¼Œè¿˜ä¸å¦‚è¯´ synchronized è¿˜æœ‰éå¸¸å¤§çš„ä¼˜åŒ–ä½™åœ°ã€‚</p><p>åç»­çš„æŠ€æœ¯å‘å±•ä¹Ÿè¯æ˜äº†è¿™ä¸€ç‚¹ï¼ŒJDK1.6ä¸­åŠ å…¥äº†å¾ˆå¤šé’ˆå¯¹ é”çš„ä¼˜åŒ–æªæ–½ï¼ˆ13.3èŠ‚æˆ‘ä»¬å°±ä¼šè®²è§£è¿™äº› ä¼˜åŒ–æªæ–½ï¼‰ï¼Œ<br>JDK1.6å‘å¸ƒä¹‹åï¼Œäººä»¬å°±å‘ç° synchronizedä¸ReentrantLock çš„ æ€§èƒ½ åŸºæœ¬ä¸Šæ˜¯ å®Œå…¨æŒå¹³ äº†ã€‚</p><p>å› æ­¤ï¼Œå¦‚æœè¯»è€…çš„ç¨‹åº æ˜¯ä½¿ç”¨ JDK1.6 æˆ–ä»¥ä¸Š éƒ¨ç½² çš„è¯ï¼Œ<br>æ€§èƒ½å› ç´  å°±ä¸å†æ˜¯ é€‰æ‹©ReentrantLock çš„ç†ç”±äº†ï¼Œ<br>è™šæ‹Ÿæœº åœ¨ æœªæ¥çš„æ€§èƒ½æ”¹è¿›ä¸­ è‚¯å®šä¹Ÿä¼šæ›´åŠ åå‘äº åŸç”Ÿçš„synchronizedï¼Œ<br>æ‰€ä»¥è¿˜æ˜¯æå€¡åœ¨ synchronized èƒ½å®ç°éœ€æ±‚çš„æƒ…å†µä¸‹ï¼Œä¼˜å…ˆè€ƒè™‘ä½¿ç”¨ synchronized æ¥è¿›è¡Œ åŒæ­¥ã€‚</p><h6 id="2-éé˜»å¡åŒæ­¥"><a href="#2-éé˜»å¡åŒæ­¥" class="headerlink" title="2.éé˜»å¡åŒæ­¥"></a>2.éé˜»å¡åŒæ­¥</h6><p>äº’æ–¥åŒæ­¥ æœ€ä¸»è¦çš„é—®é¢˜ å°±æ˜¯ è¿›è¡Œçº¿ç¨‹ é˜»å¡å’Œå”¤é†’ æ‰€å¸¦æ¥çš„çš„ æ€§èƒ½é—®é¢˜ï¼Œ<br>å› æ­¤è¿™ç§ åŒæ­¥ä¹Ÿç§°ä¸º é˜»å¡åŒæ­¥ï¼ˆBlocking Synchronizationï¼‰ã€‚</p><p>ä» å¤„ç†é—®é¢˜çš„æ–¹å¼ ä¸Šè¯´ï¼Œ<br>äº’æ–¥åŒæ­¥ å±äºä¸€ç§ æ‚²è§‚çš„ å¹¶å‘ç­–ç•¥ï¼Œæ€»æ˜¯è®¤ä¸º åªè¦ä¸å»åš æ­£ç¡®çš„ åŒæ­¥æªæ–½ï¼ˆä¾‹å¦‚åŠ é”ï¼‰ï¼Œé‚£å°±è‚¯å®šä¼šå‡ºç°é—®é¢˜ï¼Œ<br>æ— è®º å…±äº«æ•°æ® æ˜¯å¦çœŸçš„ä¼šå‡ºç°ç«äº‰ï¼Œå®ƒéƒ½è¦ è¿›è¡ŒåŠ é”<br>ï¼ˆè¿™é‡Œè®¨è®ºçš„æ˜¯ æ¦‚å¿µæ¨¡å‹ï¼Œå®é™…ä¸Š è™šæ‹Ÿæœº ä¼šä¼˜åŒ–å¾ˆå¤§ä¸€éƒ¨åˆ† ä¸å¿…è¦çš„ åŠ é”ï¼‰ã€<br>ç”¨æˆ·æ€å’Œå¿ƒæ€è½¬æ¢ã€ç»´æŠ¤é”è®¡æ•°å™¨ å’Œ æ£€æŸ¥ æ˜¯å¦æœ‰ è¢«é˜»å¡çš„çº¿ç¨‹ éœ€è¦å”¤é†’ ç­‰æ“ä½œã€‚</p><p>ï¼ˆè¿™ä¹Ÿå°±æ˜¯æ‰€è°“çš„ æ€»æœ‰åˆæ°‘æƒ³å®³æœ• äº†ï¼‰</p><p>éšç€ ç¡¬ä»¶æŒ‡ä»¤é›† çš„å‘å±•ï¼Œæˆ‘ä»¬æœ‰äº†å¦å¤–ä¸€ä¸ªé€‰æ‹©ï¼šåŸºäº å†²çªæ£€æµ‹ çš„ ä¹è§‚å¹¶å‘ç­–ç•¥ï¼Œ<br>é€šä¿—åœ°è¯´ï¼Œå°±æ˜¯å…ˆè¿›è¡Œæ“ä½œï¼Œ<br>å¦‚æœæ²¡æœ‰å…¶ä»–çº¿ç¨‹ äº‰ç”¨å…±äº«æ•°æ®ï¼Œé‚£æ“ä½œå°±æˆåŠŸäº†ï¼›<br>å¦‚æœ å…±äº«æ•°æ® æœ‰äº‰ç”¨ï¼Œäº§ç”Ÿäº† å†²çªï¼Œé‚£å°±å†é‡‡å–å…¶ä»–çš„ è¡¥å¿æªæ–½ï¼ˆæœ€å¸¸è§çš„è¡¥å¿æªæ–½å°±æ˜¯ ä¸æ–­åœ°é‡è¯•ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢ï¼‰ï¼Œ<br>è¿™ç§ ä¹è§‚çš„å¹¶å‘ç­–ç•¥ çš„è®¸å¤šå®ç° éƒ½ä¸éœ€è¦æŠŠ çº¿ç¨‹æŒ‚èµ·ï¼Œå› æ­¤è¿™ç§ åŒæ­¥æ“ä½œ ç§°ä¸º éé˜»å¡åŒæ­¥ï¼ˆNon-Blocking Synchronizationï¼‰ã€‚</p><p>ä¸ºä»€ä¹ˆç¬”è€…è¯´ä½¿ç”¨ ä¹è§‚å¹¶å‘ç­–ç•¥ éœ€è¦ â€œç¡¬ä»¶æŒ‡ä»¤é›†çš„å‘å±•â€ æ‰èƒ½è¿›è¡Œå‘¢ï¼Ÿ</p><p>å› ä¸ºæˆ‘ä»¬éœ€è¦ æ“ä½œå’Œå†²çªæ£€æµ‹ è¿™ä¸¤ä¸ªæ­¥éª¤ å…·å¤‡ åŸå­æ€§ï¼Œé ä»€ä¹ˆæ¥ä¿è¯å‘¢ï¼Ÿ</p><p>å¦‚æœè¿™é‡Œ å†ä½¿ç”¨ äº’æ–¥åŒæ­¥ æ¥ä¿è¯å°±å¤±å»æ„ä¹‰äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½é  ç¡¬ä»¶ æ¥å®Œæˆè¿™ä»¶äº‹æƒ…ï¼Œ<br>ç¡¬ä»¶ ä¿è¯ä¸€ä¸ªä» è¯­ä¹‰ ä¸Šçœ‹èµ·æ¥éœ€è¦å¤šæ¬¡æ“ä½œçš„æ€§èƒ½ åªé€šè¿‡ ä¸€æ¡å¤„ç†å™¨æŒ‡ä»¤ å°±èƒ½å®Œæˆï¼Œè¿™ç±»æŒ‡ä»¤å¸¸ç”¨çš„æœ‰ï¼š</p><p>(æˆ‘å¤§æ¦‚ä¸€è¾ˆå­ä¹Ÿç”¨ä¸åˆ°è¿™äº›ä¸ªä¸œè¥¿)</p><ul><li>æµ‹è¯•å¹¶è®¾ç½®ï¼ˆTest-and-Setï¼‰</li><li>è·å–å¹¶å¢åŠ ï¼ˆFetch-and-Incrementï¼‰</li><li>äº¤æ¢ï¼ˆSwapï¼‰</li><li>æ¯”è¾ƒå¹¶äº¤æ¢ï¼ˆCompare-and-Swapï¼Œä¸‹æ–‡ç§° CASï¼‰</li><li>åŠ è½½é“¾æ¥/æ¡ä»¶å­˜å‚¨ï¼ˆLoad-Linked/Store-Conditionalï¼Œä¸‹æ–‡ç§°LL/SCï¼‰</li></ul><p>(ä½†æ˜¯è¿˜æ˜¯å¾—åŠªåŠ›å»è¯•è¯•ã€‚ä¸æ€•ä¸€ä¸‡å°±æ€•ä¸‡ä¸€ã€‚)</p><p>å…¶ä¸­ï¼Œå‰é¢çš„3æ¡ æ˜¯20ä¸–çºªå°±å·²ç»å­˜åœ¨äº å¤§å¤šæ•°æŒ‡ä»¤é›†ä¹‹ä¸­çš„ å¤„ç†å™¨æŒ‡ä»¤ï¼Œ</p><p>åé¢çš„ä¸¤æ¡æ˜¯ ç°ä»£å¤„ç†å™¨ æ–°å¢çš„ï¼Œè€Œä¸”è¿™ä¸¤æ¡æŒ‡ä»¤çš„ ç›®çš„å’ŒåŠŸèƒ½ æ˜¯ç±»ä¼¼çš„ã€‚</p><p>åœ¨ IA64ã€x86 æŒ‡ä»¤é›† ä¸­æœ‰ cmpxchgæŒ‡ä»¤ å®Œæˆ CASåŠŸèƒ½ï¼Œ<br>åœ¨ sparc-TSO ä¹Ÿæœ‰ casaæŒ‡ä»¤ å®ç°ï¼Œè€Œåœ¨ ARM å’Œ PowerPC æ¶æ„ä¸‹ï¼Œåˆ™éœ€è¦ä½¿ç”¨ ä¸€å¯¹ ldrex/strex æŒ‡ä»¤ æ¥å®Œæˆ LL/SC çš„åŠŸèƒ½ã€‚</p><p>CASæŒ‡ä»¤ éœ€è¦æœ‰3ä¸ªæ“ä½œæ•°ï¼Œåˆ†åˆ«æ˜¯ å†…å­˜ä½ç½®ï¼ˆåœ¨Javaä¸­å¯ä»¥ç®€å•ç†è§£ä¸º å˜é‡çš„å†…å­˜åœ°å€ï¼Œç”¨Vè¡¨ç¤ºï¼‰ã€æ—§çš„é¢„æœŸå€¼ï¼ˆç”¨Aè¡¨ç¤ºï¼‰å’Œæ–°å€¼ï¼ˆç”¨Bè¡¨ç¤ºï¼‰ã€‚</p><p>CASæŒ‡ä»¤ æ‰§è¡Œæ—¶ï¼Œå½“ä¸”ä»…å½“ V ç¬¦åˆ æ—§é¢„æœŸå€¼A æ—¶ï¼Œå¤„ç†å™¨ ç”¨ æ–°å€¼B æ›´æ–° Vçš„å€¼ï¼Œå¦åˆ™å®ƒå°±ä¸æ‰§è¡Œæ›´æ–°ï¼Œ<br>ä½†æ˜¯æ— è®º æ˜¯å¦æ›´æ–°äº† Vçš„å€¼ï¼Œéƒ½ä¼šè¿”å› Vçš„æ—§å€¼ï¼Œä¸Šè¿°çš„å¤„ç†è¿‡ç¨‹æ˜¯ä¸€ä¸ª åŸå­æ“ä½œã€‚</p><p>åœ¨ JDK1.5 ä¹‹åï¼ŒJavaç¨‹åº ä¸­æ‰å¯ä»¥ä½¿ç”¨ CAS æ“ä½œï¼Œ<br>è¯¥æ“ä½œç”± sun.misc.Unsafeç±» é‡Œé¢çš„ compareAndSwapInt() å’Œ compareAndSwapLong() ç­‰å‡ ä¸ªæ–¹æ³•åŒ…è£…æä¾›ï¼Œ<br>è™šæ‹Ÿæœº åœ¨ å†…éƒ¨ å¯¹è¿™äº›æ–¹æ³•åšäº†ç‰¹æ®Šå¤„ç†ï¼Œ<br>å³æ—¶ç¼–è¯‘å‡ºæ¥çš„ç»“æœ å°±æ˜¯ä¸€æ¡ å¹³å°ç›¸å…³çš„ å¤„ç†å™¨CASæŒ‡ä»¤ï¼Œæ²¡æœ‰æ–¹æ³•è°ƒç”¨çš„è¿‡ç¨‹ï¼Œæˆ–è€…å¯ä»¥è®¤ä¸ºæ˜¯æ— æ¡ä»¶ å†…è” è¿›å»äº†ã€‚</p><blockquote><p>è¿™ç§è¢« è™šæ‹Ÿæœº ç‰¹æ®Šå¤„ç† çš„æ–¹æ³•ç§°ä¸º å›ºæœ‰å‡½æ•°ï¼ˆIntrinsicsï¼‰ï¼Œç±»ä¼¼çš„ å›ºæœ‰å‡½æ•° è¿˜æœ‰Math.sin()ç­‰ã€‚</p></blockquote><p>ç”±äº Unsafeç±» ä¸æ˜¯æä¾›ç»™ ç”¨æˆ·ç¨‹åº è°ƒç”¨çš„ç±»ï¼ˆUnsafe.getUnsafe()çš„ä»£ç ä¸­ é™åˆ¶äº†åªæœ‰ å¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆBootstrap ClassLoaderï¼‰ åŠ è½½çš„Class æ‰èƒ½è®¿é—®å®ƒï¼‰ï¼Œ<br>å› æ­¤ï¼Œå¦‚æœä¸é‡‡ç”¨ åå°„æ‰‹æ®µ ï¼Œ æˆ‘ä»¬åªèƒ½é€šè¿‡å…¶ä»–çš„ Java APIæ¥é—´æ¥ä½¿ç”¨å®ƒï¼Œå¦‚ J.U.CåŒ… é‡Œé¢çš„ æ•´æ•°åŸå­ç±»ï¼Œå…¶ä¸­çš„ compareAndSet()å’ŒgetAndIncrement() ç­‰æ–¹æ³•éƒ½æ˜¯ç”¨äº† Unsafeç±» çš„ CASæ“ä½œã€‚</p><p>æˆ‘ä»¬ä¸å¦¨æ‹¿ä¸€æ®µåœ¨ç¬¬12ç« ä¸­æ²¡æœ‰è§£å†³çš„é—®é¢˜ä»£ç æ¥çœ‹çœ‹ å¦‚ä½•ä½¿ç”¨CASæ“ä½œæ¥é¿å…é˜»å¡åŒæ­¥ ï¼Œä»£ç å¦‚ä»£ç æ¸…å•12-1æ‰€ç¤ºã€‚</p><p>æˆ‘ä»¬æ›¾ç»é€šè¿‡è¿™æ®µ20ä¸ªçº¿ç¨‹ è‡ªå¢10000æ¬¡ çš„ä»£ç æ¥è¯æ˜ volatileå˜é‡ä¸å…·å¤‡åŸå­æ€§ï¼Œé‚£ä¹ˆå¦‚ä½•æ‰èƒ½è®©å®ƒ å…·å¤‡åŸå­æ€§ å‘¢ï¼Ÿ</p><p>æŠŠ â€œrace++â€æ“ä½œæˆ–increase() æ–¹æ³•ç”¨ åŒæ­¥å— åŒ…è£¹èµ·æ¥å½“ç„¶æ˜¯ä¸€ä¸ªåŠæ³•ï¼Œä½†æ˜¯å¦‚æœæ”¹æˆå¦‚ä»£ç æ¸…å•13-4æ‰€ç¤ºçš„ä»£ç ï¼Œé‚£æ•ˆç‡å°†ä¼šæé«˜è®¸å¤šã€‚</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">                                ä»£ç æ¸…å• <span class="number">13</span><span class="number">-4</span> Atomicçš„åŸå­è‡ªå¢è¿ç®—</span><br><span class="line">----------------------------------------------------------------------------------------------</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * Atomic å˜é‡è‡ªå¢è¿ç®—æµ‹è¯•</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * @author zzm</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AtomicTest</span>&#123;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> AtomicInteger race = <span class="keyword">new</span> AtomicInteger();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">increase</span><span class="params">()</span></span>&#123;</span><br><span class="line">      race.incrementAndGet();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> THREADS_COUNT = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(<span class="keyword">String</span>[] args)</span> throws Exception</span>&#123;</span><br><span class="line">      Thread[] threads = <span class="keyword">new</span> Thread[THREADS_COUNT];</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; THREADS_COUNT; i++)&#123;</span><br><span class="line">        threads[i] = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable()&#123;</span><br><span class="line">          @Override</span><br><span class="line">          <span class="keyword">public</span> <span class="keyword">void</span> <span class="built_in">run</span>()&#123;</span><br><span class="line">            <span class="keyword">for</span>( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; THREADS_COUNT; i++)&#123;</span><br><span class="line">              increase();</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        threads[i].start();</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">while</span>(Thread.activeCount() &gt; <span class="number">1</span>)</span><br><span class="line">          thread.<span class="built_in">yield</span>();</span><br><span class="line"></span><br><span class="line">      System.out.<span class="built_in">println</span>(race);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">----------------------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p>200000</p><p>ä½¿ç”¨ AtomicInteger ä»£æ›¿ int åï¼Œç¨‹åºè¾“å‡ºäº†æ­£ç¡®çš„ç»“æœï¼Œ<br>ä¸€åˆ‡éƒ½è¦å½’åŠŸäº incrementAndGet()æ–¹æ³• çš„ åŸå­æ€§ã€‚<br>å®ƒçš„å®ç° å…¶å®éå¸¸ ç®€å•ï¼Œå¦‚ä»£ç æ¸…å•13-5æ‰€ç¤ºã€‚</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">                                ä»£ç æ¸…å• 13-5 incrementAndGet()æ–¹æ³•çš„JDKæºç </span></span><br><span class="line">----------------------------------------------------------------------------------------------</span><br><span class="line">/*<span class="strong">*</span></span><br><span class="line"><span class="strong">  *</span> Atomically  increment by one the current value.</span><br><span class="line"><span class="code">  * @return the updated value</span></span><br><span class="line"><span class="code">  */</span></span><br><span class="line"><span class="code">  public final int incrementAndGet()&#123;</span></span><br><span class="line"><span class="code">    for(;;)&#123;</span></span><br><span class="line"><span class="code">      int current = get();</span></span><br><span class="line"><span class="code">      int next = current + 1;</span></span><br><span class="line"><span class="code">      if(compareAndSet(current, next))&#123;</span></span><br><span class="line"><span class="code">        return next;</span></span><br><span class="line"><span class="code">      &#125;</span></span><br><span class="line"><span class="code">    &#125;</span></span><br><span class="line"><span class="code">  &#125;</span></span><br><span class="line">----------------------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure><p>incrementAndGet()æ–¹æ³• åœ¨ä¸€ä¸ª æ— é™å¾ªç¯ ä¸­ï¼Œ<br>ä¸æ–­å°è¯• å°†ä¸€ä¸ªæ¯”å½“å‰å€¼ å¤§1çš„æ–°å€¼ èµ‹å€¼ç»™è‡ªå·±ã€‚<br>å¦‚æœå¤±è´¥äº†ï¼Œé‚£è¯´æ˜åœ¨æ‰§è¡Œ â€œè·å–-è®¾ç½®â€ æ“ä½œçš„æ—¶å€™ å€¼å·²ç»æœ‰äº†ä¿®æ”¹ï¼Œ<br>äºæ˜¯ å†æ¬¡å¾ªç¯ è¿›è¡Œä¸‹ä¸€æ¬¡æ“ä½œï¼Œç›´åˆ°è®¾ç½®æˆåŠŸä¸ºæ­¢ã€‚</p><p>å°½ç®¡ CAS çœ‹èµ·æ¥å¾ˆç¾ï¼Œä½†æ˜¾ç„¶è¿™ç§æ“ä½œæ— æ³•æ¶µç›– äº’æ–¥åŒæ­¥çš„æ‰€æœ‰ä½¿ç”¨åœºæ™¯ï¼Œ<br>å¹¶ä¸” CAS ä»è¯­ä¹‰ä¸Šæ¥è¯´ å¹¶ä¸æ˜¯å®Œç¾çš„ï¼Œå­˜åœ¨è¿™æ ·ä¸€ä¸ª é€»è¾‘æ¼æ´ï¼š<br>å¦‚æœä¸€ä¸ª å˜é‡V åˆæ¬¡è¯»å–çš„æ—¶å€™æ˜¯ Aå€¼ï¼Œ<br>å¹¶ä¸”åœ¨å‡†å¤‡èµ‹å€¼çš„æ—¶å€™ æ£€æŸ¥åˆ°å®ƒä»ç„¶ä¸ºAå€¼ï¼Œ<br>é‚£æˆ‘ä»¬å°±èƒ½è¯´å®ƒçš„å€¼ æ²¡æœ‰è¢«å…¶ä»–çº¿ç¨‹æ”¹å˜è¿‡äº†å—ï¼Ÿ<br>å¦‚æœåœ¨è¿™æ®µæœŸé—´ å®ƒçš„å€¼æ›¾ç»è¢«æ”¹æˆäº†Bï¼Œ åæ¥åˆè¢«æ”¹å›Aï¼Œ<br>é‚£ CASæ“ä½œ å°±ä¼šè¯¯è®¤ä¸ºå®ƒ ä»æ¥æ²¡æœ‰è¢«æ”¹å˜è¿‡ã€‚</p><p>è¿™ä¸ª æ¼æ´ ç§°ä¸º CASæ“ä½œ çš„ â€œABAé—®é¢˜â€ã€‚</p><p>J.U.CåŒ… ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæä¾›äº†ä¸€ä¸ªå¸¦æœ‰æ ‡è®°çš„ åŸå­å¼•ç”¨ç±»â€œAtomicStampedReferenceâ€ï¼Œ<br>å®ƒå¯ä»¥é€šè¿‡æ§åˆ¶ å˜é‡å€¼çš„ç‰ˆæœ¬ æ¥ä¿è¯ CASçš„æ­£ç¡®æ€§ã€‚</p><p>ä¸è¿‡ç›®å‰æ¥è¯´è¿™ä¸ªç±» æ¯”è¾ƒâ€œé¸¡è‚‹â€ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹ ABAé—®é¢˜ ä¸ä¼šå½±å“ ç¨‹åºå¹¶å‘çš„æ­£ç¡®æ€§ï¼Œ<br>å¦‚æœéœ€è¦ è§£å†³ABAé—®é¢˜ï¼Œæ”¹ç”¨ä¼ ç»Ÿçš„ äº’æ–¥åŒæ­¥ å¯èƒ½ä¼šæ¯” åŸå­ç±»æ›´é«˜æ•ˆã€‚</p><h6 id="3-æ— åŒæ­¥æ–¹æ¡ˆ"><a href="#3-æ— åŒæ­¥æ–¹æ¡ˆ" class="headerlink" title="3.æ— åŒæ­¥æ–¹æ¡ˆ"></a>3.æ— åŒæ­¥æ–¹æ¡ˆ</h6><p>è¦ä¿è¯ çº¿ç¨‹å®‰å…¨ï¼Œå¹¶ä¸æ˜¯ä¸€å®šå°±è¦è¿›è¡Œ åŒæ­¥ï¼Œä¸¤è€…æ²¡æœ‰ å› æœå…³ç³»ã€‚</p><p>åŒæ­¥ åªæ˜¯ä¿è¯ å…±äº«æ•°æ®äº‰ç”¨æ—¶çš„æ­£ç¡®æ€§ çš„æ‰‹æ®µï¼Œ<br>å¦‚æœä¸€ä¸ªæ–¹æ³• æœ¬æ¥å°±ä¸æ¶‰åŠ å…±äº«æ•°æ®ï¼Œ<br>é‚£å®ƒè‡ªç„¶å°±æ— éœ€ ä»»ä½•åŒæ­¥æªæ–½ å»ä¿è¯ æ­£ç¡®æ€§ï¼Œ<br>å› æ­¤ä¼šæœ‰ä¸€äº›ä»£ç å¤©ç”Ÿå°±æ˜¯ çº¿ç¨‹å®‰å…¨çš„ï¼Œç¬”è€…ç®€å•åœ°ä»‹ç»å…¶ä¸­çš„ä¸¤ç±»ã€‚</p><p><strong>å¯é‡å…¥ä»£ç ï¼ˆReentrant Codeï¼‰</strong>:<br>è¿™ç§ä»£ç ä¹Ÿå«åš çº¯ä»£ç ï¼ˆPure Codeï¼‰ï¼Œ<br>å¯ä»¥åœ¨ ä»£ç æ‰§è¡Œçš„ä»»ä½•æ—¶åˆ» ä¸­æ–­å®ƒï¼Œ<br>è½¬è€Œå» æ‰§è¡Œå¦å¤–ä¸€æ®µä»£ç ï¼ˆåŒ…æ‹¬ é€’å½’è°ƒç”¨å®ƒæœ¬èº«ï¼‰ï¼Œ<br>è€Œåœ¨ æ§åˆ¶æƒ è¿”å›åï¼Œ<br>åŸæ¥çš„ç¨‹åº ä¸ä¼šå‡ºç°ä»»ä½•é”™è¯¯ã€‚</p><p>ç›¸å¯¹ çº¿ç¨‹å®‰å…¨ æ¥è¯´ï¼Œ<br>å¯é‡å…¥æ€§ æ˜¯æ›´åŸºæœ¬çš„ç‰¹æ€§ï¼Œ<br>å®ƒå¯ä»¥ä¿è¯ çº¿ç¨‹å®‰å…¨ï¼Œ<br>å³æ‰€æœ‰çš„ å¯é‡å…¥ çš„ä»£ç éƒ½æ˜¯ çº¿ç¨‹å®‰å…¨çš„ï¼Œ<br>ä½†æ˜¯å¹¶éæ‰€æœ‰çš„ çº¿ç¨‹å®‰å…¨ çš„ä»£ç éƒ½æ˜¯ å¯é‡å…¥çš„ã€‚</p><p>å¯é‡å…¥ä»£ç  æœ‰ä¸€äº› å…±åŒçš„ç‰¹å¾ï¼Œ<br>ä¾‹å¦‚ ä¸ä¾èµ–å­˜å‚¨åœ¨å †ä¸Šçš„æ•°æ® å’Œ å…¬ç”¨çš„ç³»ç»Ÿèµ„æºã€ç”¨åˆ°çš„çŠ¶æ€é‡ éƒ½ç”±å‚æ•°ä¸­ä¼ å…¥ã€ä¸è°ƒç”¨éå¯é‡å…¥çš„æ–¹æ³•ç­‰ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªç®€å•çš„åŸåˆ™æ¥åˆ¤æ–­ ä»£ç æ˜¯å¦å…·å¤‡å¯é‡å…¥æ€§ï¼š<br>å¦‚æœä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒçš„è¿”å›ç»“æœæ˜¯å¯ä»¥ é¢„æµ‹çš„ï¼Œåªè¦è¾“å…¥äº†ç›¸åŒçš„æ•°æ®ï¼Œå°±éƒ½èƒ½è¿”å›ç›¸åŒçš„ç»“æœï¼Œé‚£å®ƒå°±æ»¡è¶³ å¯é‡å…¥æ€§ çš„è¦æ±‚ï¼Œå½“ç„¶ä¹Ÿå°±æ˜¯ çº¿ç¨‹å®‰å…¨çš„ã€‚</p><p><strong>çº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼ˆThread Local Storageï¼‰</strong>:<br>å¦‚æœä¸€æ®µä»£ç ä¸­ æ‰€éœ€è¦çš„æ•°æ® å¿…é¡»ä¸ å…¶ä»–ä»£ç  å…±äº«ï¼Œ<br>é‚£å°±çœ‹çœ‹è¿™äº› å…±äº«æ•°æ®çš„ä»£ç  æ˜¯å¦èƒ½ä¿è¯ åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­ æ‰§è¡Œï¼Ÿ<br>å¦‚æœèƒ½ä¿è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠ å…±äº«æ•°æ®çš„å¯è§èŒƒå›´ é™åˆ¶åœ¨ åŒä¸€ä¸ªçº¿ç¨‹ä¹‹å†…ï¼Œ<br>è¿™æ ·ï¼Œæ— é¡» åŒæ­¥  ä¹Ÿèƒ½ä¿è¯ çº¿ç¨‹ä¹‹é—´ ä¸å‡ºç° æ•°æ®äº‰ç”¨ çš„é—®é¢˜ã€‚</p><p>ç¬¦åˆè¿™ç§ç‰¹ç‚¹çš„åº”ç”¨å¹¶ä¸å°‘è§ï¼Œ<br>å¤§éƒ¨åˆ†ä½¿ç”¨ æ¶ˆè´¹é˜Ÿåˆ—çš„æ¶æ„æ¨¡å¼ï¼ˆå¦‚â€œç”Ÿäº§è€…-æ¶ˆè´¹è€…â€æ¨¡å¼ï¼‰éƒ½ä¼šå°† äº§å“çš„æ¶ˆè´¹è¿‡ç¨‹ å°½é‡åœ¨ ä¸€ä¸ªçº¿ç¨‹ä¸­ æ¶ˆè´¹å®Œï¼Œ<br>å…¶ä¸­æœ€é‡è¦çš„ä¸€ä¸ªåº”ç”¨å®ä¾‹å°±æ˜¯ ç»å…¸Webäº¤äº’æ¨¡å‹ ä¸­çš„ â€œä¸€ä¸ªè¯·æ±‚å¯¹åº”ä¸€ä¸ªæœåŠ¡å™¨çº¿ç¨‹â€ï¼ˆThread-per-Requestï¼‰ çš„å¤„ç†æ–¹å¼ï¼Œ<br>è¿™ç§ å¤„ç†æ–¹å¼çš„å¹¿æ³›åº”ç”¨ ä½¿å¾—å¾ˆå¤š WebæœåŠ¡ç«¯åº”ç”¨ éƒ½å¯ä»¥ä½¿ç”¨ çº¿ç¨‹æœ¬åœ°å­˜å‚¨ æ¥è§£å†³ çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</p><p>Javaè¯­è¨€ä¸­ï¼Œ<br>å¦‚æœ ä¸€ä¸ªå˜é‡ è¦è¢« å¤šçº¿ç¨‹ è®¿é—®ï¼Œå¯ä»¥ä½¿ç”¨ volatileå…³é”®å­— å£°æ˜å®ƒä¸º â€œæ˜“å˜çš„â€ï¼›<br>å¦‚æœ ä¸€ä¸ªå˜é‡ è¦è¢« æŸä¸ªçº¿ç¨‹ ç‹¬äº«ï¼ŒJavaä¸­å°±æ²¡æœ‰ç±»ä¼¼C++ä¸­ __declspec(thread)è¿™æ ·çš„å…³é”®å­—ï¼Œ<br>ä¸è¿‡è¿˜æ˜¯å¯ä»¥é€šè¿‡ java.lang.ThreadLocalç±» æ¥å®ç° çº¿ç¨‹æœ¬åœ°å­˜å‚¨ çš„åŠŸèƒ½ã€‚</p><blockquote><p>åœ¨ Visual C++ ä¸­æ˜¯ â€œ<strong>declspec(thread)â€å…³é”®å­—ï¼Œè€Œåœ¨ GCC ä¸­æ˜¯â€œ</strong>threadâ€ã€‚</p></blockquote><p>æ¯ä¸€ä¸ªçº¿ç¨‹çš„ Threadå¯¹è±¡ä¸­éƒ½æœ‰ä¸€ä¸ª ThreadLocalMapå¯¹è±¡ï¼Œ<br>è¿™ä¸ªå¯¹è±¡ å­˜å‚¨äº†ä¸€ç»„ ä»¥ ThreadLocal.threadLocalHashCode ä¸º é”® ï¼Œä»¥ æœ¬åœ°çº¿ç¨‹å˜é‡ ä¸º å€¼ çš„ K-Vå€¼å¯¹ï¼Œ<br>ThreadLocalå¯¹è±¡ å°±æ˜¯ å½“å‰çº¿ç¨‹çš„ThreadLocalMapçš„ è®¿é—®å…¥å£ï¼Œ<br>æ¯ä¸€ä¸ª ThreadLocalå¯¹è±¡ éƒ½åŒ…å«äº† ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„ threadLocalHashCodeå€¼ï¼Œ<br>ä½¿ç”¨è¿™ä¸ªå€¼ å°±å¯ä»¥åœ¨çº¿ç¨‹ K-Vå€¼å¯¹ ä¸­æ‰¾å› å¯¹åº”çš„æœ¬åœ°çº¿ç¨‹å˜é‡ã€‚</p><h4 id="é”ä¼˜åŒ–"><a href="#é”ä¼˜åŒ–" class="headerlink" title="é”ä¼˜åŒ–"></a>é”ä¼˜åŒ–</h4><p>é«˜æ•ˆå¹¶å‘ æ˜¯ä» JDK1.5åˆ°JDK1.6çš„ä¸€ä¸ª é‡è¦æ”¹è¿›ï¼Œ<br>HotSpotè™šæ‹Ÿæœº å¼€å‘å›¢é˜Ÿåœ¨è¿™ä¸ªç‰ˆæœ¬ä¸ŠèŠ±è´¹äº†å¤§é‡çš„ç²¾åŠ›å»å®ç° å„ç§é”ä¼˜åŒ–æŠ€æœ¯ï¼Œ<br>å¦‚ é€‚åº”æ€§è‡ªæ—‹ï¼ˆAdaptive Spinningï¼‰ã€é”æ¶ˆé™¤ï¼ˆLock Eliminationï¼‰ã€é”ç²—åŒ–ï¼ˆLock Coarseningï¼‰ã€è½»é‡çº§é”ï¼ˆLightweight Lockingï¼‰å’Œåå‘é”ï¼ˆBiased Lockingï¼‰ç­‰ï¼Œ<br>è¿™äº›æŠ€æœ¯éƒ½æ˜¯ä¸ºäº† åœ¨çº¿ç¨‹ä¹‹é—´ æ›´é«˜æ•ˆåœ° å…±äº«æ•°æ®ï¼Œ<br>ä»¥åŠ è§£å†³ç«äº‰é—®é¢˜ï¼Œ<br>ä»è€Œ æé«˜ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ã€‚</p><h5 id="è‡ªæ—‹é”ä¸è‡ªé€‚åº”è‡ªæ—‹"><a href="#è‡ªæ—‹é”ä¸è‡ªé€‚åº”è‡ªæ—‹" class="headerlink" title="è‡ªæ—‹é”ä¸è‡ªé€‚åº”è‡ªæ—‹"></a>è‡ªæ—‹é”ä¸è‡ªé€‚åº”è‡ªæ—‹</h5><p>å‰é¢æˆ‘ä»¬è®¨è®º äº’æ–¥åŒæ­¥ çš„æ—¶å€™ï¼Œ<br>æåˆ°äº† äº’æ–¥åŒæ­¥ å¯¹æ€§èƒ½æœ€å¤§çš„å½±å“ æ˜¯é˜»å¡çš„å®ç°ï¼Œ<br>æŒ‚èµ·çº¿ç¨‹ å’Œ æ¢å¤çº¿ç¨‹ çš„æ“ä½œéƒ½éœ€è¦ è½¬å…¥å†…æ ¸æ€ ä¸­å®Œæˆï¼Œ<br>è¿™äº›æ“ä½œç»™ç³»ç»Ÿçš„ å¹¶å‘æ€§èƒ½ å¸¦æ¥äº†å¾ˆå¤§çš„å‹åŠ›ã€‚</p><p>åŒæ—¶ï¼Œè™šæ‹Ÿæœº çš„å¼€å‘å›¢é˜Ÿä¹Ÿæ³¨æ„åˆ°åœ¨è®¸å¤šåº”ç”¨ä¸Šï¼Œ<br>å…±äº«æ•°æ®çš„é”å®šçŠ¶æ€ åªä¼šæŒç»­å¾ˆçŸ­çš„ä¸€æ®µæ—¶é—´ï¼Œ<br>ä¸ºäº†è¿™æ®µæ—¶é—´ å»æŒ‚èµ·å’Œæ¢å¤çº¿ç¨‹ å¹¶ä¸å€¼å¾—ã€‚</p><p>å¦‚æœ ç‰©ç†æœºå™¨ æœ‰ä¸€ä¸ªä»¥ä¸Šçš„ å¤„ç†å™¨ï¼Œ<br>èƒ½è®© ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„çº¿ç¨‹ åŒæ—¶å¹¶è¡Œæ‰§è¡Œï¼Œ<br>æˆ‘ä»¬å°±å¯ä»¥è®©  åé¢è¯·æ±‚é”çš„é‚£ä¸ªçº¿ç¨‹ â€œç¨ç­‰ä¸€ä¸‹â€ï¼Œ<br>ä½†ä¸æ”¾å¼ƒ å¤„ç†å™¨çš„æ‰§è¡Œæ—¶é—´ï¼Œ<br>çœ‹çœ‹ æŒæœ‰é”çš„çº¿ç¨‹ æ˜¯å¦å¾ˆå¿«å°±ä¼šé‡Šæ”¾é”ã€‚</p><p>ä¸ºäº†è®©çº¿ç¨‹ç­‰å¾…ï¼Œæˆ‘ä»¬åªéœ€è®© çº¿ç¨‹æ‰§è¡Œä¸€ä¸ªå¿™å¾ªç¯ï¼ˆè‡ªæ—‹ï¼‰ï¼Œè¿™é¡¹æŠ€æœ¯å°±æ˜¯æ‰€è°“çš„ è‡ªæ—‹é”ã€‚</p><p>è‡ªæ—‹é” åœ¨ JDK1.4.2 ä¸­å°±å·²ç»å¼•å…¥ï¼Œ<br>åªä¸è¿‡ é»˜è®¤ æ˜¯ å…³é—­çš„ï¼Œ<br>å¯ä»¥ä½¿ç”¨ -XX:+UseSpinning å‚æ•°æ¥å¼€å¯ï¼Œ<br>åœ¨ JDK1.6 ä¸­å°±å·²ç»æ”¹ä¸º é»˜è®¤å¼€å¯äº†ã€‚</p><p>è‡ªæ—‹ç­‰å¾… ä¸èƒ½ä»£æ›¿ é˜»å¡ï¼Œ<br>ä¸”å…ˆä¸è¯´å¯¹ å¤„ç†å™¨æ•°é‡çš„è¦æ±‚ï¼Œ<br>è‡ªæ—‹ç­‰å¾… æœ¬èº«è™½ç„¶ é¿å…äº†çº¿ç¨‹åˆ‡æ¢çš„å¼€é”€ï¼Œ<br>ä½†å®ƒæ˜¯è¦ å ç”¨å¤„ç†å™¨æ—¶é—´çš„ï¼Œ<br>å› æ­¤ï¼Œå¦‚æœ é” è¢«å ç”¨çš„æ—¶é—´ å¾ˆçŸ­ï¼Œè‡ªæ—‹ç­‰å¾… çš„ æ•ˆæœå°±ä¼šéå¸¸å¥½ï¼Œ<br>åä¹‹ï¼Œå¦‚æœ é” è¢«å ç”¨çš„æ—¶é—´ å¾ˆé•¿ï¼Œé‚£ä¹ˆ è‡ªæ—‹çš„çº¿ç¨‹ åªä¼š ç™½ç™½æ¶ˆè€—å¤„ç†å™¨èµ„æºï¼Œ<br>è€Œä¸ä¼šåš ä»»ä½•æœ‰ç”¨çš„å·¥ä½œï¼Œ<br>åè€Œä¼šå¸¦æ¥ æ€§èƒ½ä¸Šçš„æµªè´¹ã€‚</p><p>å› æ­¤ï¼Œè‡ªæ—‹ç­‰å¾…çš„æ—¶é—´ å¿…é¡»è¦æœ‰ ä¸€å®šçš„é™åº¦ï¼Œ<br>å¦‚æœ è‡ªæ—‹è¶…è¿‡äº†é™å®šçš„æ¬¡æ•° ä»ç„¶æ²¡æœ‰ æˆåŠŸè·å¾—é”ï¼Œ<br>å°±åº”å½“ä½¿ç”¨ ä¼ ç»Ÿçš„æ–¹å¼ å»æŒ‚èµ·çº¿ç¨‹äº†ã€‚</p><p>è‡ªæ—‹æ¬¡æ•° çš„ é»˜è®¤å€¼ æ˜¯ 10æ¬¡ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨å‚æ•°-XX:PreBlockSpin æ¥æ›´æ”¹ã€‚</p><p>åœ¨ JDK1.6 ä¸­å¼•å…¥äº† è‡ªé€‚åº”çš„è‡ªæ—‹é”ã€‚</p><p>è‡ªé€‚åº” æ„å‘³ç€ è‡ªæ—‹çš„æ—¶é—´ ä¸å†å›ºå®šäº†ï¼Œ<br>è€Œæ˜¯ç”± å‰ä¸€æ¬¡åœ¨åŒä¸€ä¸ªé”ä¸Šçš„è‡ªæ—‹æ—¶é—´ åŠ é”çš„æ‹¥æœ‰è€…çš„çŠ¶æ€ æ¥å†³å®šã€‚</p><p>å¦‚æœåœ¨ åŒä¸€ä¸ªé”å¯¹è±¡ä¸Šï¼Œ<br>è‡ªæ—‹ç­‰å¾… åˆšåˆšæˆåŠŸè·å¾—è¿‡é”ï¼Œå¹¶ä¸” æŒæœ‰é”çš„çº¿ç¨‹ æ­£åœ¨è¿è¡Œä¸­ï¼Œ<br>é‚£ä¹ˆ è™šæ‹Ÿæœº å°±ä¼šè®¤ä¸º è¿™æ¬¡è‡ªæ—‹ ä¹Ÿå¾ˆæœ‰å¯èƒ½å†æ¬¡æˆåŠŸï¼Œ<br>è¿›è€Œå®ƒå°† å…è®¸ è‡ªæ—‹ç­‰å¾… æŒç»­ç›¸å¯¹æ›´é•¿çš„æ—¶é—´ï¼Œæ¯”å¦‚100ä¸ªå¾ªç¯ã€‚</p><p>å¦å¤–ï¼Œå¦‚æœ å¯¹äºæŸä¸ªé”ï¼Œè‡ªæ—‹ å¾ˆå°‘æˆåŠŸè·å¾—è¿‡ï¼Œ<br>éšç€ ç¨‹åºè¿è¡Œå’Œæ€§èƒ½ç›‘æ§ä¿¡æ¯ çš„ ä¸æ–­å®Œå–„ï¼Œ<br>è™šæ‹Ÿæœº å¯¹ ç¨‹åºé” çš„ çŠ¶å†µé¢„æµ‹ å°±ä¼šè¶Šæ¥è¶Šå‡†ç¡®ï¼Œ<br>è™šæ‹Ÿæœº å°±ä¼šå˜å¾— è¶Šæ¥è¶Šâ€œèªæ˜â€äº†ã€‚</p><h5 id="é”æ¶ˆé™¤"><a href="#é”æ¶ˆé™¤" class="headerlink" title="é”æ¶ˆé™¤"></a>é”æ¶ˆé™¤</h5><p>é”æ¶ˆé™¤ æ˜¯æŒ‡ è™šæ‹Ÿæœº å³æ—¶ç¼–è¯‘å™¨ åœ¨è¿è¡Œæ—¶ï¼Œ<br>å¯¹ä¸€äº›ä»£ç ä¸Š è¦æ±‚ åŒæ­¥ï¼Œä½†æ˜¯è¢«æ£€æµ‹åˆ° ä¸å¯èƒ½å­˜åœ¨å…±äº«æ•°æ®ç«äº‰çš„é” è¿›è¡Œ æ¶ˆé™¤ã€‚</p><p>é”æ¶ˆé™¤ çš„ ä¸»è¦åˆ¤å®šä¾æ® æ¥æºäº é€ƒé€¸åˆ†æ çš„ æ•°æ®æ”¯æŒï¼ˆç¬¬11ç« å·²ç»è®²è§£è¿‡ é€ƒé€¸åˆ†ææŠ€æœ¯ï¼‰ï¼Œ<br>å¦‚æœåˆ¤æ–­ åœ¨ä¸€æ®µä»£ç ä¸­ï¼Œå † ä¸Šçš„æ‰€æœ‰ æ•°æ® éƒ½ä¸ä¼š é€ƒé€¸å‡ºå» ä»è€Œè¢« å…¶ä»–çš„çº¿ç¨‹è®¿é—®åˆ°ï¼Œ<br>é‚£å°±å¯ä»¥æŠŠå®ƒä»¬å½“åš å †ä¸Šæ•°æ®å¯¹å¾…ï¼Œ<br>è®¤ä¸ºå®ƒä»¬æ˜¯ çº¿ç¨‹ç§æœ‰çš„ï¼ŒåŒæ­¥åŠ é” è‡ªç„¶ä¹Ÿå°±æ— é¡»è¿è¡Œã€‚</p><p>ä¹Ÿè®¸è¯»è€…ä¼šæœ‰ç–‘é—®ï¼Œ å˜é‡ æ˜¯å¦é€ƒé€¸ï¼Œ<br>å¯¹äº è™šæ‹Ÿæœº æ¥è¯´éœ€è¦ä½¿ç”¨ æ•°æ®æµåˆ†æ æ¥ç¡®å®šï¼Œ<br>ä½†æ˜¯ç¨‹åºå‘˜è‡ªå·±åº”è¯¥æ—¶å¾ˆæ¸…æ¥šçš„ï¼Œæ€ä¹ˆä¼šåœ¨ æ˜çŸ¥é“ä¸å­˜åœ¨æ•°æ®äº‰ç”¨çš„æƒ…å†µä¸‹ è¦æ±‚åŒæ­¥å‘¢ï¼Ÿ<br>ç­”æ¡ˆæ˜¯æœ‰è®¸å¤š åŒæ­¥æªæ–½ å¹¶ä¸æ˜¯ç¨‹åºå‘˜è‡ªå·±åŠ çš„ï¼Œ<br>åŒæ­¥çš„ä»£ç  åœ¨javaç¨‹åºä¸­çš„ æ™®éç¨‹åº¦ ä¹Ÿè®¸è¶…è¿‡äº†å¤§éƒ¨åˆ†è¯»è€…çš„æƒ³è±¡ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹çœ‹ä»£ç æ¸…å•13-6ä¸­çš„ä¾‹å­ï¼Œè¿™æ®µéå¸¸ç®€å•çš„ä»£ç  ä»…ä»…æ˜¯è¾“å‡º3ä¸ªå­—ç¬¦ä¸²ç›¸åŠ çš„ç»“æœï¼Œ<br>æ— è®ºæ˜¯ æºç å­—é¢ä¸Š è¿˜æ˜¯ ç¨‹åºè¯­ä¹‰ä¸Š éƒ½æ²¡æœ‰åŒæ­¥ã€‚</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">                                ä»£ç æ¸…å• 13-6 ä¸€æ®µçœ‹èµ·æ¥æ²¡æœ‰åŒæ­¥çš„ä»£ç </span></span><br><span class="line">----------------------------------------------------------------------------------------------</span><br><span class="line">public String concatString(String s1,String s2,String s3)&#123;</span><br><span class="line"><span class="code">  return s1+s2+s3;</span></span><br><span class="line">&#125;</span><br><span class="line">----------------------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¹ŸçŸ¥é“ï¼Œ<br>ç”±äº Stringæ˜¯ä¸€ä¸ªä¸å¯å˜çš„ç±»ï¼Œå¯¹å­—ç¬¦ä¸²çš„è¿æ¥æ“ä½œ æ€»æ˜¯é€šè¿‡ç”Ÿæˆ æ–°çš„Stringå¯¹è±¡ æ¥è¿›è¡Œçš„ï¼Œ<br>å› æ­¤ Javacç¼–è¯‘å™¨ ä¼šå¯¹ Stringè¿æ¥ åš è‡ªåŠ¨ä¼˜åŒ–ã€‚</p><p>åœ¨ JDK1.5 ä¹‹å‰ï¼Œä¼šè½¬åŒ–ä¸º StringBufferå¯¹è±¡çš„è¿ç»­append()æ“ä½œï¼Œ<br>åœ¨ JDK1.5åŠä»¥åçš„ç‰ˆæœ¬ä¸­ï¼Œä¼šè½¬ä¸º StringBuilderå¯¹è±¡çš„è¿ç»­append()æ“ä½œï¼Œ<br>å³ä»£ç æ¸…å•13-6ä¸­çš„ä»£ç  å¯èƒ½ä¼šå˜æˆä»£ç æ¸…å• 13-7çš„æ ·å­ã€‚</p><blockquote><p>å®¢è§‚åœ°è¯´ï¼Œæ—¢ç„¶è°ˆåˆ° é”æ¶ˆé™¤ä¸é€ƒé€¸åˆ†æï¼Œé‚£ è™šæ‹Ÿæœº å°±ä¸å¯èƒ½æ˜¯ JDK1.5ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œå®é™…ä¸Šä¼šè½¬åŒ–ä¸º éçº¿ç¨‹å®‰å…¨çš„StringBuilder æ¥å®Œæˆå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œå¹¶ä¸ä¼šåŠ é”ï¼Œ ä½†è¿™ä¹Ÿä¸å½±å“ç¬”è€…ç”¨è¿™ä¸ªä¾‹å­è¯æ˜ Javaå¯¹è±¡ä¸­åŒæ­¥çš„æ™®éæ€§ã€‚</p></blockquote><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">                                ä»£ç æ¸…å• 13-7 Javacè½¬åŒ–åçš„å­—ç¬¦ä¸²è¿æ¥æ“ä½œ</span></span><br><span class="line">----------------------------------------------------------------------------------------------</span><br><span class="line">public String concatString(String s1,String s2,String s3)&#123;</span><br><span class="line"><span class="code">  StringBuffer sb = new StringBuffer();</span></span><br><span class="line"><span class="code">  sb.append(s1);</span></span><br><span class="line"><span class="code">  sb.append(s2);</span></span><br><span class="line"><span class="code">  sb.append(s3);</span></span><br><span class="line"><span class="code">  return sb.toString();</span></span><br><span class="line">&#125;</span><br><span class="line">----------------------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure><p>ç°åœ¨å¤§å®¶è¿˜è®¤ä¸ºè¿™æ®µä»£ç æ²¡æœ‰æ¶‰åŠåŒæ­¥å—ï¼Ÿ<br>æ¯ä¸ª StringBuffer.append() æ–¹æ³•ä¸­éƒ½æœ‰ä¸€ä¸ª åŒæ­¥å—ï¼Œé”å°±æ˜¯sbå¯¹è±¡ã€‚<br>è™šæ‹Ÿæœº è§‚å¯Ÿ å˜é‡sbï¼Œå¾ˆå¿«å°±ä¼šå‘ç°å®ƒçš„ åŠ¨æ€ä½œç”¨åŸŸ è¢«é™åˆ¶åœ¨ concatString()æ–¹æ³•å†…éƒ¨ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œsbçš„æ‰€æœ‰å¼•ç”¨ æ°¸è¿œä¸ä¼š â€œé€ƒé€¸â€ åˆ° concatString() æ–¹æ³•ä¹‹å¤–ï¼Œ<br>å…¶ä»–çº¿ç¨‹ æ— æ³•è®¿é—® åˆ° å®ƒï¼Œ<br>å› æ­¤ï¼Œè™½ç„¶è¿™é‡Œæœ‰é”ï¼Œä½†æ˜¯å¯ä»¥è¢« å®‰å…¨åœ°æ¶ˆé™¤æ‰ï¼Œ<br>åœ¨ å³æ—¶ç¼–è¯‘ ä¹‹åï¼Œè¿™æ®µä»£ç å°±ä¼šå¿½ç•¥æ‰ æ‰€æœ‰çš„åŒæ­¥å— è€Œç›´æ¥æ‰§è¡Œäº†ã€‚</p><h5 id="é”ç²—åŒ–"><a href="#é”ç²—åŒ–" class="headerlink" title="é”ç²—åŒ–"></a>é”ç²—åŒ–</h5><p>åŸåˆ™ä¸Šï¼Œæˆ‘ä»¬åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™ï¼Œæ€»æ˜¯æ¨èå°† åŒæ­¥å—çš„ä½œç”¨èŒƒå›´ é™åˆ¶å¾— å°½é‡å°â€”â€”åªåœ¨ å…±äº«æ•°æ®çš„å®é™…ä½œç”¨åŸŸ ä¸­æ‰è¿›è¡ŒåŒæ­¥ï¼Œ<br>è¿™æ ·æ˜¯ä¸ºäº† ä½¿å¾—éœ€è¦ åŒæ­¥çš„æ“ä½œæ•°é‡ å°½å¯èƒ½ å˜å°ï¼Œ<br>å¦‚æœå­˜åœ¨ é”ç«äº‰ï¼Œé‚£ç­‰å¾… é”çš„çº¿ç¨‹ ä¹Ÿèƒ½å°½å¿«æ‹¿åˆ°é”ã€‚</p><p>å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œä¸Šé¢çš„åŸåˆ™éƒ½æ˜¯æ­£ç¡®çš„ï¼Œ<br>ä½†æ˜¯å¦‚æœ ä¸€ç³»åˆ—çš„è¿ç»­çš„åŠ¨ä½œ éƒ½å¯¹ åŒä¸€ä¸ªå¯¹è±¡ åå¤åŠ é”å’Œè§£é”ï¼Œ<br>ç”šè‡³ åŠ é”æ“ä½œ æ˜¯å‡ºç°åœ¨ å¾ªç¯ä½“ä¸­çš„ï¼Œ<br>é‚£å³æ˜¯æ²¡æœ‰ çº¿ç¨‹ç«äº‰ï¼Œé¢‘ç¹åœ°è¿›è¡Œäº’æ–¥åŒæ­¥æ“ä½œ ä¹Ÿä¼šå¯¼è‡´ ä¸å¿…è¦çš„æ€§èƒ½æŸè€—ã€‚</p><p>ä»£ç æ¸…å•13-7ä¸­ è¿ç»­çš„append()æ–¹æ³•å°±å±äºè¿™ç±»æƒ…å†µã€‚</p><p>å¦‚æœ è™šæ‹Ÿæœº æ¢æµ‹åˆ°æœ‰è¿™æ · ä¸€ä¸²é›¶ç¢çš„æ“ä½œ éƒ½å¯¹ åŒä¸€ä¸ªå¯¹è±¡åŠ é”ï¼Œ<br>å°†ä¼šæŠŠ åŠ é”åŒæ­¥çš„èŒƒå›´ æ‰©å±•ï¼ˆç²—åŒ–ï¼‰åˆ° æ•´ä¸ªæ“ä½œåºåˆ—çš„å¤–éƒ¨ï¼Œ<br>ä»¥ä»£ç æ¸…å•13-7ä¸ºä¾‹ï¼Œå°±æ˜¯æ‰©å±•åˆ°ç¬¬ä¸€ä¸ªappend()æ“ä½œä¹‹å‰ ç›´è‡³ æœ€åä¸€ä¸ªappend()æ“ä½œä¹‹åï¼Œ<br>è¿™æ ·åªéœ€è¦ åŠ é”ä¸€æ¬¡ å°±å¯ä»¥äº†ã€‚</p><h5 id="è½»é‡çº§é”"><a href="#è½»é‡çº§é”" class="headerlink" title="è½»é‡çº§é”"></a>è½»é‡çº§é”</h5><p>è½»é‡çº§é” æ˜¯ JDK1.6ä¹‹ä¸­ åŠ å…¥çš„ æ–°å‹é”æœºåˆ¶ï¼Œ<br>å®ƒåå­—ä¸­çš„ â€œè½»é‡çº§â€ æ˜¯ ç›¸å¯¹äº ä½¿ç”¨ æ“ä½œç³»ç»Ÿäº’æ–¥é‡æ¥å®ç°çš„ä¼ ç»Ÿé” è€Œè¨€çš„ï¼Œ<br>å› æ­¤ ä¼ ç»Ÿçš„é”æœºåˆ¶ å°±ç§°ä¸º â€œé‡é‡çº§â€é”ã€‚</p><p>é¦–å…ˆéœ€è¦å¼ºè°ƒçš„ä¸€ç‚¹æ˜¯ï¼Œ è½»é‡çº§é” å¹¶ä¸æ˜¯ç”¨æ¥ ä»£æ›¿ é‡é‡çº§é” çš„ï¼Œ<br>å®ƒçš„æœ¬æ„ æ˜¯åœ¨ æ²¡æœ‰å¤šçº¿ç¨‹ç«äº‰çš„å‰æä¸‹ï¼Œ<br>å‡å°‘ ä¼ ç»Ÿçš„é‡é‡çº§é” ä½¿ç”¨ æ“ä½œç³»ç»Ÿäº’æ–¥é‡ äº§ç”Ÿçš„æ€§èƒ½æ¶ˆè€—ã€‚</p><p>è¦ç†è§£ è½»é‡çº§é”ï¼Œ<br>ä»¥åŠåé¢ä¼šè®²åˆ°çš„ åå‘é”çš„åŸç†å’Œè¿ä½œè¿‡ç¨‹ï¼Œ<br>å¿…é¡»ä» HotSpotè™šæ‹Ÿæœºçš„å¯¹è±¡ï¼ˆå¯¹è±¡å¤´éƒ¨åˆ†ï¼‰çš„å†…å­˜å¸ƒå±€å¼€å§‹ä»‹ç»ã€‚</p><p>HotSpotè™šæ‹Ÿæœºçš„å¯¹è±¡å¤´ï¼ˆObject Headerï¼‰åˆ†ä¸ºä¸¤éƒ¨åˆ†ä¿¡æ¯ï¼Œ<br>ç¬¬ä¸€éƒ¨åˆ† ç”¨äºå­˜å‚¨ å¯¹è±¡è‡ªèº«çš„ è¿è¡Œæ—¶æ•°æ®ï¼Œå¦‚å“ˆå¸Œç ï¼ˆHashCodeï¼‰ã€GCåˆ†ä»£å¹´é¾„ï¼ˆGenerational GC Ageï¼‰ç­‰ï¼Œ<br>è¿™éƒ¨åˆ†æ•°æ®çš„é•¿åº¦ åœ¨32ä½å’Œ64ä½çš„ è™šæ‹Ÿæœºä¸­ åˆ†åˆ«ä¸º 32bitå’Œ64bitï¼Œå®˜æ–¹ç§°å®ƒä¸º â€œMark Wordâ€ï¼Œ<br>å®ƒæ˜¯ å®ç°è½»é‡çº§é” å’Œ åå‘é” çš„ å…³é”®ã€‚</p><p>å¦ä¸€éƒ¨åˆ† ç”¨äºå­˜å‚¨ æŒ‡å‘æ–¹æ³•åŒºå¯¹è±¡ ç±»å‹æ•°æ®çš„æŒ‡é’ˆï¼Œ<br>å¦‚æœæ˜¯æ•°ç»„å¯¹è±¡çš„è¯ï¼Œè¿˜ä¼šæœ‰ä¸€ä¸ªé¢å¤–çš„éƒ¨åˆ† ç”¨äºå­˜å‚¨ æ•°ç»„é•¿åº¦ã€‚</p><p>å¯¹è±¡å¤´ä¿¡æ¯ æ˜¯ä¸ å¯¹è±¡è‡ªèº«å®šä¹‰çš„ æ•°æ®æ— å…³çš„ é¢å¤–å­˜å‚¨æˆæœ¬ï¼Œ<br>è€ƒè™‘åˆ° è™šæ‹Ÿæœºçš„ç©ºé—´æ•ˆç‡ï¼Œ<br>Mark Word è¢«è®¾è®¡æˆä¸€ä¸ª éå›ºå®šçš„æ•°æ®ç»“æ„ ä»¥ä¾¿åœ¨ æå°çš„ç©ºé—´å†… å­˜å‚¨å°½é‡å¤šçš„ä¿¡æ¯ï¼Œ<br>å®ƒä¼šæ ¹æ®å¯¹è±¡çš„çŠ¶æ€ å¤ç”¨ è‡ªå·±çš„ å­˜å‚¨ç©ºé—´ã€‚</p><p>ä¾‹å¦‚ï¼Œåœ¨32ä½çš„HotSpotè™šæ‹Ÿæœºä¸­ å¯¹è±¡æœªè¢«é”å®šçš„çŠ¶æ€ä¸‹ï¼Œ<br>Mark Wordçš„ 32bitç©ºé—´çš„ 25bit ç”¨äºå­˜å‚¨ å¯¹è±¡å“ˆå¸Œç ï¼ˆHashCodeï¼‰ï¼Œ<br>4bit ç”¨äºå­˜å‚¨ å¯¹è±¡åˆ†ä»£å¹´é¾„ï¼Œ<br>2bit ç”¨äºå­˜å‚¨ é”æ ‡å¿—ä½ï¼Œ<br>1bit å›ºå®šä¸º 0ï¼Œ<br>åœ¨å…¶ä»–çŠ¶æ€ï¼ˆè½»é‡çº§é”å®šã€é‡é‡çº§é”å®šã€GCæ ‡è®°ã€å¯åå‘ï¼‰ä¸‹ å¯¹è±¡çš„å­˜å‚¨å†…å®¹ è§è¡¨13-1ã€‚</p><table>  <thead>    <tr>      <th colspan="2">è¡¨ 13-1 HotSpotè™šæ‹Ÿæœºå¯¹è±¡å¤´ Mark Word</th>    </tr>  </thead>  <tr>    <th>å­˜å‚¨å†…å®¹</th>    <th>æ ‡å¿—ä½</th>    <th>çŠ¶æ€</th>  </tr>  <tr>    <td>å¯¹è±¡å“ˆå¸Œç ã€å¯¹è±¡åˆ†ä»£å¹´é¾„</td>    <td>01</td>    <td>æœªé”å®š</td>  </tr>    <tr>    <td>æŒ‡å‘é”è®°å½•çš„æŒ‡é’ˆ</td>    <td>00</td>    <td>è½»é‡çº§é”å®š</td>  </tr>    <tr>    <td>æŒ‡å‘é‡é‡çº§é”çš„æŒ‡é’ˆ</td>    <td>10</td>    <td>è†¨èƒ€ï¼ˆé‡é‡çº§é”å®šï¼‰</td>  </tr>   <tr>    <td>ç©ºï¼Œä¸éœ€è¦è®°å½•ä¿¡æ¯</td>    <td>11</td>    <td>GCæ ‡è®°</td>  </tr>   <tr>    <td>åå‘çº¿ç¨‹IDã€åå‘æ—¶é—´æˆ³ã€å¯¹è±¡åˆ†ä»£å¹´é¾„</td>    <td>01</td>    <td>å¯åå‘</td>  </tr></table><p>ç®€å•åœ°ä»‹ç»äº† å¯¹è±¡çš„å†…å­˜å¸ƒå±€ åï¼Œ<br>æˆ‘ä»¬æŠŠè¯é¢˜è¿”å›åˆ° è½»é‡çº§é”çš„æ‰§è¡Œè¿‡ç¨‹ä¸Šã€‚</p><p>åœ¨ä»£ç è¿›å…¥ åŒæ­¥å— çš„æ—¶å€™ï¼Œ<br>å¦‚æœæ­¤ åŒæ­¥å¯¹è±¡ æ²¡æœ‰è¢« é”å®šï¼ˆé”æ ‡å¿—ä½ ä¸ºâ€œ01â€çŠ¶æ€ï¼‰ï¼Œ<br>è™šæ‹Ÿæœº é¦–å…ˆå°† åœ¨å½“å‰çº¿ç¨‹çš„ æ ˆå¸§ ä¸­ å»ºç«‹ä¸€ä¸ªåä¸º é”è®°å½•ï¼ˆLock Recordï¼‰çš„ç©ºé—´ï¼Œ<br>ç”¨äºå­˜å‚¨ é”å¯¹è±¡ç›®å‰çš„Mark Wordçš„æ‹·è´<br>ï¼ˆå®˜æ–¹æŠŠè¿™ä»½æ‹·è´åŠ äº†ä¸€ä¸ª Displacedå‰ç¼€ï¼Œå³ Displaced Mark Wordï¼‰ï¼Œ<br>è¿™æ—¶å€™ çº¿ç¨‹å †æ ˆ ä¸ å¯¹è±¡å¤´çš„çŠ¶æ€ å¦‚å›¾13-3æ‰€ç¤ºã€‚</p><p>ç„¶åï¼Œ<br>è™šæ‹Ÿæœº å°†ä½¿ç”¨ CASæ“ä½œ å°è¯•å°† å¯¹è±¡çš„Mark Word æ›´æ–°ä¸ºæŒ‡å‘ Lock Recordçš„æŒ‡é’ˆã€‚</p><p>å¦‚æœè¿™ä¸ªæ›´æ–°åŠ¨ä½œ æˆåŠŸäº†ï¼Œé‚£ä¹ˆè¿™ä¸ªçº¿ç¨‹ å°±æ‹¥æœ‰äº† è¯¥å¯¹è±¡çš„é”ï¼Œ<br>å¹¶ä¸” å¯¹è±¡Mark Word çš„ é”æ ‡å¿—ä½ï¼ˆMark Wordçš„æœ€å2bitï¼‰å°†è½¬å˜ä¸ºâ€œ00â€ï¼Œ<br>å³è¡¨ç¤ºæ­¤å¯¹è±¡å¤„äº è½»é‡çº§é”å®šçŠ¶æ€ï¼Œ<br>è¿™æ—¶å€™ çº¿ç¨‹å †æ ˆä¸å¯¹è±¡å¤´çš„çŠ¶æ€ å¦‚å›¾13-4æ‰€ç¤ºã€‚</p><blockquote><p>å›¾13-3å’Œå›¾13-4æ¥æºäº HotSpotè™šæ‹Ÿæœºçš„ä¸€ä½Senior Staff Engineerâ€”â€”Paul Hohenseeæ‰€å†™çš„PPT â€œThe Hotspot Java Virtual Machineâ€ã€‚</p></blockquote><p>å¦‚æœè¿™ä¸ªæ›´æ–°åŠ¨ä½œ å¤±è´¥äº†ï¼Œè™šæ‹Ÿæœº é¦–å…ˆä¼šæ£€æŸ¥ å¯¹è±¡çš„Mark Word æ˜¯å¦æŒ‡å‘ å½“å‰çº¿ç¨‹çš„æ ˆå¸§ï¼Œ<br>å¦‚æœåªè¯´æ˜ å½“å‰çº¿ç¨‹å·²ç»æ‹¥æœ‰äº†è¿™ä¸ªå¯¹è±¡çš„é”ï¼Œé‚£å°±å¯ä»¥ç›´æ¥ è¿›å…¥åŒæ­¥å— ç»§ç»­æ‰§è¡Œï¼Œ<br>å¦åˆ™è¯´æ˜ è¿™ä¸ªé”å¯¹è±¡ å·²ç»è¢«å…¶ä»–çº¿ç¨‹ æŠ¢å äº†ã€‚</p><p>å¦‚æœæœ‰ä¸¤æ¡ä»¥ä¸Šçš„ çº¿ç¨‹ äº‰ç”¨åŒä¸€ä¸ªé”ï¼Œ<br>é‚£ è½»é‡çº§é” å°±ä¸å†æœ‰æ•ˆï¼Œè¦ è†¨èƒ€ ä¸º é‡é‡çº§é”ï¼Œ<br>é”æ ‡å¿— çš„ çŠ¶æ€å€¼ å˜ä¸º â€œ10â€œï¼Œ<br>Mark Wordä¸­å­˜å‚¨çš„ å°±æ˜¯æŒ‡å‘ é‡é‡çº§é”ï¼ˆäº’æ–¥é‡ï¼‰çš„æŒ‡é’ˆï¼Œ<br>åé¢ ç­‰å¾…é”çš„çº¿ç¨‹ ä¹Ÿè¦è¿›å…¥ é˜»å¡çŠ¶æ€ã€‚</p><p>ä¸Šé¢æè¿°çš„æ˜¯ è½»é‡çº§é”çš„æ·é”è¿‡ç¨‹ï¼Œ<br>å®ƒçš„ è§£é”è¿‡ç¨‹ ä¹Ÿæ˜¯é€šè¿‡ CASæ“ä½œæ¥è¿›è¡Œçš„ï¼Œ<br>å¦‚æœ å¯¹è±¡çš„Mark Word ä»ç„¶æŒ‡å‘è¿™ çº¿ç¨‹çš„é”è®°å½•ï¼Œ<br>é‚£å°±ç”¨ CASæ“ä½œ æŠŠ å¯¹è±¡çš„Mark Word å’Œ çº¿ç¨‹ä¸­å¤åˆ¶çš„Displaced Mark Wordæ›¿æ¢å›æ¥ï¼Œ<br>å¦‚æœæ›¿æ¢æˆåŠŸï¼Œæ•´ä¸ªåŒæ­¥è¿‡ç¨‹å°±å®Œæˆäº†ã€‚<br>å¦‚æœæ›¿æ¢å¤±è´¥ï¼Œè¯´æ˜æœ‰å…¶ä»–çº¿ç¨‹ å°è¯•è¿‡è·å–è¯¥é”ï¼Œé‚£å°±è¦åœ¨é‡Šæ”¾é”çš„åŒæ—¶ï¼Œå”¤é†’è¢«æŒ‚èµ·çš„çº¿ç¨‹ã€‚</p><p>è½»é‡çº§é” èƒ½æå‡ ç¨‹åºåŒæ­¥æ€§èƒ½ çš„ä¾æ®æ˜¯ â€œå¯¹äºç»å¤§éƒ¨åˆ†çš„é”ï¼Œåœ¨æ•´ä¸ªåŒæ­¥å‘¨æœŸå†…éƒ½æ˜¯ä¸å­˜åœ¨ç«äº‰çš„â€ï¼Œ<br>è¿™æ˜¯ä¸€ä¸ªç»éªŒæ•°æ®ã€‚</p><p>å¦‚æœæ²¡æœ‰ç«äº‰ï¼Œè½»é‡çº§é”ä½¿ç”¨ CASæ“ä½œ é¿å…äº†ä½¿ç”¨ äº’æ–¥é‡çš„å¼€é”€ï¼Œ<br>ä½†å¦‚æœå­˜åœ¨ é”ç«äº‰ï¼Œé™¤äº†äº’æ–¥é‡çš„å¼€é”€ä»¥å¤–ï¼Œè¿˜é¢å¤–å‘ç”Ÿäº† CASæ“ä½œï¼Œ<br>å› æ­¤åœ¨ æœ‰ç«äº‰çš„æƒ…å†µä¸‹ï¼Œ è½»é‡çº§é” ä¼šæ¯” ä¼ ç»Ÿçš„é‡é‡çº§é” æ›´æ…¢ã€‚</p><h5 id="åå‘é”"><a href="#åå‘é”" class="headerlink" title="åå‘é”"></a>åå‘é”</h5><p>åå‘é” ä¹Ÿæ˜¯ JDK1.6 ä¸­å¼•å…¥çš„ä¸€é¡¹ é”ä¼˜åŒ–ï¼Œ<br>å®ƒçš„ç›®çš„æ˜¯ æ¶ˆé™¤æ•°æ®åœ¨æ— ç«äº‰æƒ…å†µä¸‹çš„åŒæ­¥åŸè¯­ï¼Œè¿›ä¸€æ­¥æé«˜ç¨‹åºçš„è¿è¡Œæ€§èƒ½ã€‚</p><p>å¦‚æœè¯´ è½»é‡çº§é” æ˜¯åœ¨ æ— ç«äº‰çš„æƒ…å†µä¸‹ ä½¿ç”¨ CASæ“ä½œ å» æ¶ˆé™¤åŒæ­¥ä½¿ç”¨çš„äº’æ–¥é‡ï¼Œ<br>é‚£ åå‘é” å°±æ˜¯åœ¨ æ— ç«äº‰çš„æƒ…å†µä¸‹ æƒ³æŠŠ æ•´ä¸ªåŒæ­¥éƒ½æ¶ˆé™¤æ‰ï¼Œè¿CASæ“ä½œéƒ½ä¸åšäº†ã€‚</p><p>åå‘é”çš„ â€œåâ€ï¼Œå°±æ˜¯åå¿ƒçš„â€œåâ€ã€åè¢’çš„â€œåâ€ï¼Œ<br>å®ƒçš„æ„æ€æ˜¯ è¿™ä¸ªé” ä¼šåå‘äº ç¬¬ä¸€ä¸ª è·å¾—å®ƒçš„çº¿ç¨‹ï¼Œ<br>å¦‚æœåœ¨æ¥ä¸‹æ¥çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œè¯¥é” æ²¡æœ‰è¢«å…¶ä»–çš„ çº¿ç¨‹è·å–ï¼Œåˆ™æŒæœ‰ åå‘é”çš„ çº¿ç¨‹ å°†æ°¸è¿œä¸éœ€è¦å†è¿›è¡Œ åŒæ­¥ã€‚</p><p>å¦‚æœè¯»è€…è¯»æ‡‚äº†å‰é¢ è½»é‡çº§é” ä¸­ å…³äºå¯¹è±¡å¤´Mark Wordä¸çº¿ç¨‹ä¹‹é—´ çš„ æ“ä½œè¿‡ç¨‹ï¼Œ<br>é‚£ åå‘é”çš„åŸç† ç†è§£èµ·æ¥å°±ä¼šå¾ˆç®€å•ã€‚</p><p>å‡è®¾å½“å‰ è™šæ‹Ÿæœº å¯ç”¨äº† åå‘é”ï¼ˆå¯ç”¨å‚æ•° -XX:+UseBiasedLockingï¼Œè¿™æ˜¯ JDK1.6çš„é»˜è®¤å€¼ï¼‰ï¼Œ<br>é‚£ä¹ˆï¼Œå½“ é”å¯¹è±¡ ç¬¬ä¸€æ¬¡ è¢«çº¿ç¨‹è·å–çš„æ—¶å€™ï¼Œè™šæ‹Ÿæœº å°†ä¼šæŠŠ å¯¹è±¡å¤´ä¸­çš„ æ ‡å¿—ä½ è®¾ä¸º â€œ01â€ï¼Œå³åå‘æ¨¡å¼ã€‚</p><p>å¦‚æœä½¿ç”¨ CASæ“ä½œ æŠŠ è·å–åˆ°è¿™ä¸ªé”çš„çº¿ç¨‹çš„ID è®°å½•åœ¨ å¯¹è±¡çš„Mark Wordä¹‹ä¸­ï¼Œ<br>å¦‚æœ CASæ“ä½œ æˆåŠŸ<br>æŒæœ‰ åå‘é”çš„çº¿ç¨‹ ä»¥åæ¯æ¬¡è¿›å…¥è¿™ä¸ªé” ç›¸å…³çš„åŒæ­¥å—æ—¶ï¼Œè™šæ‹Ÿæœºéƒ½å¯ä»¥ä¸å†è¿›è¡Œ ä»»ä½•åŒæ­¥æ“ä½œ<br>ï¼ˆä¾‹å¦‚ LOckingã€Unlocking åŠå¯¹ Mark Wordçš„Update ç­‰ï¼‰ã€‚</p><p>å½“æœ‰ å¦å¤–ä¸€ä¸ªçº¿ç¨‹ å»å°è¯• è·å–è¿™ä¸ªé”æ—¶ï¼Œ<br>åå‘æ¨¡å¼ å°± å®£å‘Šç»“æŸã€‚</p><p>æ ¹æ® é”å¯¹è±¡ ç›®å‰æ˜¯å¦å¤„äº è¢«é”å®š çš„çŠ¶æ€ï¼Œ<br>æ’¤é”€ åå‘ï¼ˆRevoke Biasï¼‰å æ¢å¤åˆ° æœªé”å®šï¼ˆæ ‡å¿—ä½ä¸º â€œ01â€ï¼‰ æˆ– è½»é‡çº§é”å®šï¼ˆæ ‡å¿—ä½ä¸ºâ€œ00â€ï¼‰çš„çŠ¶æ€ï¼Œ<br>åç»­çš„åŒæ­¥æ“ä½œ å°±å¦‚ä¸Šé¢ä»‹ç»çš„ è½»é‡çº§é”é‚£æ ·æ‰§è¡Œã€‚</p><p>åå‘é”ã€è½»é‡çº§é”çš„çŠ¶æ€è½¬åŒ– åŠ å¯¹è±¡çš„Mark Wordçš„å…³ç³»å¦‚å›¾13-5 æ‰€ç¤ºã€‚</p><p>åå‘é” å¯ä»¥æé«˜ å¸¦æœ‰ åŒæ­¥ ä½† æ— ç«äº‰çš„ ç¨‹åºæ€§èƒ½ã€‚</p><p>å®ƒåŒæ ·æ˜¯ä¸€ä¸ªå¸¦æœ‰ æ•ˆç›Šæƒè¡¡ï¼ˆTrade Offï¼‰æ€§è´¨çš„ä¼˜åŒ–ï¼Œ<br>ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒå¹¶ä¸ä¸€å®šæ€»æ˜¯å¯¹ ç¨‹åºè¿è¡Œ æœ‰åˆ©ï¼Œ<br>å¦‚æœ ç¨‹åºä¸­å¤§å¤šæ•°çš„é” æ€»æ˜¯è¢« å¤šä¸ªä¸åŒçš„çº¿ç¨‹ è®¿é—®ï¼Œ<br>é‚£ åå‘æ¨¡å¼å°±æ˜¯å¤šä½™çš„ã€‚</p><p>åœ¨å…·ä½“é—®é¢˜å…·ä½“åˆ†æçš„å‰æä¸‹ï¼Œæœ‰æ—¶å€™ä½¿ç”¨å‚æ•° -XX:-UseBiasedLocking æ¥ ç¦æ­¢åå‘é”ä¼˜åŒ– åè€Œå¯ä»¥ æå‡æ€§èƒ½ã€‚</p><h4 id="æœ¬ç« å°ç»“"><a href="#æœ¬ç« å°ç»“" class="headerlink" title="æœ¬ç« å°ç»“"></a>æœ¬ç« å°ç»“</h4><p>æœ¬ç« ä»‹ç»äº† çº¿ç¨‹å®‰å…¨ æ‰€æ¶‰åŠçš„ æ¦‚å¿µå’Œåˆ†ç±»ã€åŒæ­¥å®ç°çš„æ–¹å¼ åŠ è™šæ‹Ÿæœºçš„åº•å±‚è¿ä½œåŸç†ï¼Œ<br>å¹¶ä¸”ä»‹ç»äº† è™šæ‹Ÿæœº ä¸ºäº†å®ç°é«˜æ•ˆå¹¶å‘ æ‰€é‡‡å–çš„çš„ ä¸€ç³»åˆ— é”ä¼˜åŒ–æªæ–½ã€‚</p><p>è®¸å¤šèµ„æ·±çš„ç¨‹åºå‘˜éƒ½è¯´è¿‡ï¼Œèƒ½å¤Ÿå†™å‡º é«˜ä¼¸ç¼©æ€§çš„å¹¶å‘ç¨‹åº æ˜¯ä¸€é—¨è‰ºæœ¯ï¼Œ<br>è€Œ äº†è§£å¹¶å‘ åœ¨ç³»ç»Ÿåº•å±‚ æ˜¯å¦‚ä½•å®ç°çš„ï¼Œåˆ™æ˜¯ æŒæ¡è¿™é—¨è‰ºæœ¯çš„ å‰ææ¡ä»¶ï¼Œ<br>ä¹Ÿæ˜¯æˆé•¿ä¸º é«˜çº§ç¨‹åºå‘˜çš„å¿…å¤‡çŸ¥è¯†ä¹‹ä¸€ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;æ·±å…¥javaè™šæ‹Ÿæœº-ç¬¬äº”éƒ¨åˆ†-é«˜æ•ˆå¹¶å‘&quot;&gt;&lt;a href=&quot;#æ·±å…¥javaè™šæ‹Ÿæœº-ç¬¬äº”éƒ¨åˆ†-é«˜æ•ˆå¹¶å‘&quot; class=&quot;headerlink&quot; title=&quot;æ·±å…¥javaè™šæ‹Ÿæœº-ç¬¬äº”éƒ¨åˆ†-é«˜æ•ˆå¹¶å‘&quot;&gt;&lt;/a&gt;æ·±å…¥javaè™šæ‹Ÿæœº-ç¬¬äº”éƒ¨åˆ†-é«˜æ•ˆå¹¶å‘&lt;/h2&gt;&lt;h3 i
      
    
    </summary>
    
    
      <category term="é¢è¯•" scheme="https://fengshana.github.io/categories/%E9%9D%A2%E8%AF%95/"/>
    
    
      <category term="é¢è¯•" scheme="https://fengshana.github.io/tags/%E9%9D%A2%E8%AF%95/"/>
    
      <category term="è™šæ‹Ÿæœº" scheme="https://fengshana.github.io/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº-Javaå†…å­˜æ¨¡å‹ä¸çº¿ç¨‹</title>
    <link href="https://fengshana.github.io/2020/05/26/%E3%80%90%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JAVA%E8%99%9A%E6%8B%9F%E6%9C%BA%E3%80%91/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JAVA%E8%99%9A%E6%8B%9F%E6%9C%BA12/"/>
    <id>https://fengshana.github.io/2020/05/26/%E3%80%90%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JAVA%E8%99%9A%E6%8B%9F%E6%9C%BA%E3%80%91/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JAVA%E8%99%9A%E6%8B%9F%E6%9C%BA12/</id>
    <published>2020-05-26T14:39:02.793Z</published>
    <updated>2020-06-05T18:03:34.909Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ·±å…¥javaè™šæ‹Ÿæœº-ç¬¬äº”éƒ¨åˆ†-é«˜æ•ˆå¹¶å‘"><a href="#æ·±å…¥javaè™šæ‹Ÿæœº-ç¬¬äº”éƒ¨åˆ†-é«˜æ•ˆå¹¶å‘" class="headerlink" title="æ·±å…¥javaè™šæ‹Ÿæœº-ç¬¬äº”éƒ¨åˆ†-é«˜æ•ˆå¹¶å‘"></a>æ·±å…¥javaè™šæ‹Ÿæœº-ç¬¬äº”éƒ¨åˆ†-é«˜æ•ˆå¹¶å‘</h2><h3 id="ç¬¬12ç« -Javaå†…å­˜æ¨¡å‹ä¸çº¿ç¨‹"><a href="#ç¬¬12ç« -Javaå†…å­˜æ¨¡å‹ä¸çº¿ç¨‹" class="headerlink" title="ç¬¬12ç«  Javaå†…å­˜æ¨¡å‹ä¸çº¿ç¨‹"></a>ç¬¬12ç«  Javaå†…å­˜æ¨¡å‹ä¸çº¿ç¨‹</h3><p><strong>å¹¶å‘å¤„ç†çš„å¹¿æ³›åº”ç”¨</strong> æ˜¯ä½¿å¾— <strong>Amdah1å®šå¾‹ ä»£æ›¿ æ‘©å°”å®šå¾‹</strong> æˆä¸º<strong>è®¡ç®—æœºæ€§èƒ½å‘å±•æºåŠ¨åŠ›</strong> çš„æ ¹æœ¬åŸå› ï¼Œ ä¹Ÿæ˜¯äººç±» â€œå‹æ¦¨â€ è®¡ç®—æœºè¿ç®—èƒ½åŠ›çš„æœ€æœ‰åˆ©æ­¦å™¨ã€‚  </p><blockquote><p><strong>Amdah1å®šå¾‹</strong> ä»£æ›¿ <strong>æ‘©å°”å®šå¾‹</strong> æˆä¸º <strong>è®¡ç®—æœºæ€§èƒ½å‘å±•æºåŠ¨åŠ›</strong> çš„<strong>æ ¹æœ¬åŸå› </strong>ï¼š <strong>å¹¶å‘å¤„ç†çš„å¹¿æ³›åº”ç”¨</strong>ã€‚</p></blockquote><blockquote><p><strong>Amdah1å®šå¾‹</strong></p><ul><li>é€šè¿‡ç³»ç»Ÿä¸­ <strong>å¹¶è¡ŒåŒ–ä¸ä¸²è¡ŒåŒ–</strong> çš„ <strong>æ¯”é‡</strong> æ¥ <strong>æè¿°</strong> <strong>å¤šå¤„ç†å™¨ç³»ç»Ÿ</strong> èƒ½è·å¾—çš„ <strong>è¿ç®—åŠ é€Ÿèƒ½åŠ›</strong>ï¼›</li></ul></blockquote><blockquote><p><strong>æ‘©å°”å®šå¾‹</strong></p><ul><li>åˆ™ç”¨äº <strong>æè¿°</strong> <strong>å¤„ç†å™¨</strong> <strong>æ™¶ä½“ç®¡æ•°é‡</strong> ä¸ <strong>è¿è¡Œæ•ˆç‡</strong> ä¹‹é—´çš„<strong>å‘å±•å…³ç³»</strong>ã€‚</li></ul></blockquote><blockquote><p>è¿™ä¸¤ä¸ª<strong>å®šå¾‹</strong> çš„ <strong>æ›´æ›¿</strong> ä»£è¡¨äº†ï¼šè¿‘å¹´æ¥ <strong>ç¡¬ä»¶å‘å±•</strong> ä»è¿½æ±‚ <strong>å¤„ç†å™¨é¢‘ç‡</strong> åˆ° è¿½æ±‚ <strong>å¤šæ ¸å¿ƒå¹¶è¡Œå¤„ç†</strong> çš„<strong>å‘å±•è¿‡ç¨‹</strong>ï¼›</p></blockquote><h4 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h4><p><strong>å¤šä»»åŠ¡å¤„ç†</strong> åœ¨ <strong>ç°ä»£è®¡ç®—æœºæ“ä½œç³»ç»Ÿ</strong> ä¸­ å‡ ä¹å·²æ˜¯ä¸€é¡¹å¿…å¤‡çš„æŠ€èƒ½äº†ã€‚  </p><blockquote><p><strong>ç°ä»£è®¡ç®—æœºæ“ä½œç³»ç»Ÿ</strong> ä¸­ï¼Œ<strong>å¤šä»»åŠ¡å¤„ç†</strong> å‡ ä¹å·²æ˜¯ä¸€é¡¹å¿…å¤‡çš„æŠ€èƒ½ã€‚</p></blockquote><p>åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œè®© <strong>è®¡ç®—æœº</strong> <strong>åŒæ—¶å»åšå‡ ä»¶äº‹æƒ…</strong>ï¼Œ ä¸ä»…æ˜¯å› ä¸º <strong>è®¡ç®—æœºçš„è¿ç®—èƒ½åŠ›å¼ºå¤§</strong> äº†ï¼Œè¿˜è¦ä¸€ä¸ªå¾ˆé‡è¦çš„åŸå› æ˜¯ <strong>è®¡ç®—æœºçš„è¿ç®—é€Ÿåº¦</strong> ä¸ <strong>å®ƒçš„å­˜å‚¨å’Œé€šä¿¡å­ç³»ç»Ÿé€Ÿåº¦</strong> çš„ <strong>å·®è·å¤ªå¤§</strong>ï¼Œ<br><strong>å¤§é‡çš„æ—¶é—´</strong>éƒ½<strong>èŠ±è´¹</strong>åœ¨<strong>ç£ç›˜I/O</strong> ã€<strong>ç½‘ç»œé€šä¿¡</strong>æˆ–è€… <strong>æ•°æ®åº“è®¿é—®</strong>ä¸Šã€‚</p><blockquote><p>è®©è®¡ç®—æœºåŒæ—¶å»åšå‡ ä»¶äº‹æƒ…çš„åŸå› ï¼š</p><ul><li>è®¡ç®—æœºçš„<strong>è¿ç®—èƒ½åŠ›</strong>å¼ºå¤§</li><li>è®¡ç®—æœºçš„ <strong>è¿ç®—é€Ÿåº¦</strong> ä¸ å®ƒçš„ <strong>å­˜å‚¨å’Œé€šä¿¡å­ç³»ç»Ÿ</strong> <strong>é€Ÿåº¦</strong> çš„<strong>å·®è·å¤ªå¤§</strong>ï¼›</li><li>ä¸ºäº†<strong>é¿å…</strong>å¤§é‡çš„<strong>æ—¶é—´</strong>éƒ½<strong>èŠ±è´¹</strong>åœ¨ <strong>ç£ç›˜I/O</strong>ã€<strong>ç½‘ç»œé€šä¿¡</strong>ã€<strong>è®¿é—®æ•°æ®åº“</strong>ä¸Š;</li></ul></blockquote><p>å¦‚æœä¸å¸Œæœ› <strong>å¤„ç†å™¨</strong> åœ¨<strong>å¤§éƒ¨åˆ†æ—¶é—´</strong>é‡Œéƒ½å¤„äº <strong>ç­‰å¾…å…¶ä»–èµ„æºçš„çŠ¶æ€</strong>ï¼Œ<br>å°±å¿…é¡» ä½¿ç”¨ä¸€äº›æ‰‹æ®µ å»æŠŠ <strong>å¤„ç†å™¨çš„é¢„ç®—èƒ½åŠ›</strong> <strong>å‹æ¦¨</strong> å‡ºæ¥ï¼Œ<br>å¦åˆ™å°±ä¼š<strong>é€ æˆ</strong>å¾ˆå¤§çš„<strong>æµªè´¹</strong>ï¼Œ<br>è€Œè®©<strong>è®¡ç®—æœº</strong> <strong>åŒæ—¶å¤„ç†å‡ é¡¹ä»»åŠ¡</strong> åˆ™æ˜¯æœ€å®¹æ˜“æƒ³åˆ°ã€ä¹Ÿè¢«è¯æ˜ æ˜¯éå¸¸æœ‰æ•ˆçš„â€œå‹æ¦¨â€æ‰‹æ®µï¼›</p><blockquote><p><strong>å¤„ç†å™¨</strong> åœ¨<strong>å¤§éƒ¨åˆ†æ—¶é—´</strong>é‡Œ éƒ½å¤„äº <strong>ç­‰å¾…å…¶ä»–èµ„æºçš„çŠ¶æ€</strong></p></blockquote><blockquote><p>è§£å†³ å¤„ç†å™¨åœ¨å¤§éƒ¨åˆ†æ—¶é—´é‡Œ éƒ½å¤„äº ç­‰å¾…å…¶ä»–èµ„æºçš„çŠ¶æ€ çš„æ‰‹æ®µ or å¦‚ä½•å°† å¤„ç†å™¨çš„é¢„ç®—èƒ½åŠ› å‹æ¦¨å‡ºæ¥ï¼š</p><ul><li>è®©è®¡ç®—æœº åŒæ—¶å¤„ç†å‡ é¡¹ä»»åŠ¡ï¼ˆæœ€å®¹æ˜“æƒ³åˆ°ã€ä¹Ÿè¢«è¯æ˜æ˜¯éå¸¸æœ‰æ•ˆçš„â€œå‹æ¦¨â€æ‰‹æ®µï¼‰</li></ul></blockquote><p>é™¤äº†å……åˆ†åˆ©ç”¨ <strong>è®¡ç®—æœºå¤„ç†å™¨çš„èƒ½åŠ›</strong> å¤–ï¼Œ<strong>ä¸€ä¸ªæœåŠ¡ç«¯</strong> <strong>åŒæ—¶</strong>å¯¹ <strong>å¤šä¸ªå®¢æˆ·ç«¯æä¾›æœåŠ¡</strong> åˆ™æ˜¯å¦ä¸€ä¸ªæ›´<strong>å…·ä½“çš„å¹¶å‘åº”ç”¨åœºæ™¯</strong>ã€‚</p><blockquote><p>å…·ä½“çš„<strong>å¹¶å‘åº”ç”¨åœºæ™¯</strong>ï¼š</p><ul><li>ä¸€ä¸ªæœåŠ¡ç«¯ åŒæ—¶å¯¹ å¤šä¸ªå®¢æˆ·ç«¯ æä¾›æœåŠ¡ã€‚</li><li>å……åˆ†åˆ©ç”¨è®¡ç®—æœºå¤„ç†å™¨çš„èƒ½åŠ›ï¼ˆè®©è®¡ç®—æœºåŒæ—¶å¤„ç†å‡ é¡¹ä»»åŠ¡ï¼‰ï¼›</li></ul></blockquote><p><strong>è¡¡é‡</strong> <strong>ä¸€ä¸ªæœåŠ¡æ€§èƒ½</strong> çš„ <strong>é«˜ä½å¥½å</strong>ï¼Œ<br><strong>æ¯ç§’äº‹åŠ¡å¤„ç†æ•°ï¼ˆTransactions Per Secondï¼Œ TPSï¼‰æ˜¯æœ€é‡è¦çš„æŒ‡æ ‡ä¹‹ä¸€</strong>ï¼Œ<br>å®ƒä»£è¡¨ç€ <strong>ä¸€ç§’å†…</strong>  <strong>æœåŠ¡ç«¯</strong> <strong>å¹³å‡</strong> <strong>èƒ½å“åº”</strong> <strong>çš„è¯·æ±‚æ€»æ•°</strong>ï¼Œ<br>è€Œ <strong>TPS å€¼</strong> ä¸ <strong>ç¨‹åºçš„ å¹¶å‘èƒ½åŠ›</strong> åˆæœ‰ éå¸¸<strong>å¯†åˆ‡</strong>çš„<strong>å…³ç³»</strong>ã€‚</p><blockquote><p><strong>æ¯ç§’äº‹åŠ¡å¤„ç†æ•°ï¼ˆTransactions Per Second ï¼ŒTPSï¼‰</strong></p><ul><li>æ¯ç§’äº‹åŠ¡å¤„ç†æ•°ï¼ˆTransactions Per Second ï¼ŒTPSï¼‰æ˜¯ <strong>è¡¡é‡</strong>ä¸€ä¸ªæœåŠ¡<strong>æ€§èƒ½é«˜ä½å¥½å</strong>çš„æœ€é‡è¦<strong>æŒ‡æ ‡</strong>ä¹‹ä¸€</li><li>æ¯ç§’äº‹åŠ¡å¤„ç†æ•°ï¼ˆTransactions Per Second ï¼ŒTPSï¼‰ ä»£è¡¨ç€ <strong>ä¸€ç§’å†… æœåŠ¡ç«¯çš„ å¹³å‡ èƒ½å“åº” çš„ è¯·æ±‚æ€»æ•°</strong>ï¼›</li><li>æ¯ç§’äº‹åŠ¡å¤„ç†æ•°ï¼ˆTransactions Per Second ï¼ŒTPSï¼‰ä¸ <strong>ç¨‹åºçš„å¹¶å‘èƒ½åŠ›</strong> æœ‰ç€éå¸¸<strong>å¯†åˆ‡</strong>çš„<strong>å…³ç³»</strong>ã€‚</li></ul></blockquote><p>å¯¹äº <strong>è®¡ç®—é‡ç›¸åŒ</strong> çš„ä»»åŠ¡ï¼Œ <strong>ç¨‹åºçº¿ç¨‹</strong> <strong>å¹¶å‘åè°ƒ</strong> å¾— è¶Š<strong>æœ‰æ¡ä¸ç´Š</strong>ï¼Œ<strong>æ•ˆç‡</strong>è‡ªç„¶å°±ä¼š<strong>æé«˜</strong>ï¼›<br>åä¹‹ï¼Œ<strong>çº¿ç¨‹ä¹‹é—´</strong> <strong>é¢‘ç¹é˜»å¡</strong> ç”šè‡³ <strong>æ­»é”</strong>ï¼Œå°†ä¼šå¤§å¤§ <strong>é™ä½</strong> <strong>ç¨‹åº</strong> çš„ <strong>å¹¶å‘èƒ½åŠ›</strong>ã€‚</p><blockquote><p>è®¡ç®—é‡ç›¸åŒçš„ä»»åŠ¡ï¼Œçº¿ç¨‹ä¹‹é—´çŠ¶æ€ä¸åŒå°†å¯¼è‡´ä¸åŒçš„ç»“æœï¼š</p><ul><li>ç¨‹åºçº¿ç¨‹ å¹¶å‘åè°ƒ æœ‰æ¡ä¸ç´Šï¼Œæ•ˆç‡æé«˜ï¼›</li><li>çº¿ç¨‹ä¹‹é—´ é¢‘ç¹é˜»å¡ ç”šè‡³ æ­»é”ï¼Œå°†ä¼šå¤§å¤§ é™ä½ ç¨‹åº çš„ å¹¶å‘ èƒ½åŠ›ï¼›</li></ul></blockquote><p><strong>æœåŠ¡ç«¯</strong> æ˜¯ javaè¯­è¨€ æœ€æ“…é•¿çš„é¢†åŸŸä¹‹ä¸€ï¼Œè¿™ä¸ªé¢†åŸŸçš„åº”ç”¨ å äº† Javaåº”ç”¨ä¸­æœ€å¤§çš„ä¸€å—ä»½é¢ï¼Œ</p><blockquote><p>å¿…é¡»ä»¥ <strong>ä»£ç çš„æ€»ä½“è§„æ¨¡</strong> æ¥<strong>è¡¡é‡</strong>ï¼Œ <strong>æœåŠ¡ç«¯åº”ç”¨</strong> <strong>ä¸èƒ½</strong>ä¸ <strong>JavaCardã€ç§»åŠ¨ç»ˆç«¯</strong> è¿™äº›é¢†åŸŸå»æ¯” <strong>ç»å¯¹æ•°é‡</strong>ã€‚</p></blockquote><p>ä¸è¿‡ å¦‚ä½•å†™å¥½ å¹¶å‘åº”ç”¨ç¨‹åº å´åˆæ˜¯ æœåŠ¡ç«¯ç¨‹åºå¼€å‘çš„éš¾ç‚¹ä¹‹ä¸€ï¼Œ å¤„ç†å¥½å¹¶å‘æ–¹é¢çš„é—®é¢˜ é€šå¸¸éœ€è¦æ›´å¤šçš„ ç¼–ç ç»éªŒ æ¥æ”¯æŒã€‚  </p><blockquote><p><strong>æœåŠ¡ç«¯ é¢†åŸŸçš„åº”ç”¨</strong> å ç”¨äº†javaåº”ç”¨ ä¸­æœ€å¤§çš„ä¸€å—ä»½é¢ã€‚<br>æœåŠ¡ç«¯ ç¨‹åºå¼€å‘çš„éš¾ç‚¹ä¹‹ä¸€ï¼šå¦‚ä½•å†™å¥½ å¹¶å‘åº”ç”¨ç¨‹åºï¼›<br>å¤„ç†å¥½å¹¶å‘æ–¹é¢çš„é—®é¢˜ï¼šé€šå¸¸éœ€è¦æ›´å¤šçš„ ç¼–ç ç»éªŒ æ¥æ”¯æŒï¼›</p></blockquote><p>å¹¸å¥½ <strong>javaè¯­è¨€å’Œè™šæ‹Ÿæœº</strong> æä¾›äº†è®¸å¤šå·¥å…·ï¼ŒæŠŠ <strong>å¹¶å‘ç¼–ç¨‹</strong> çš„é—¨æ§› é™ä½äº†ä¸å°‘ã€‚<br>å¹¶ä¸”å„ç§ <strong>ä¸­é—´ä»¶æœåŠ¡å™¨</strong>ã€<strong>å„ç±»æ¡†æ¶</strong> éƒ½åŠªåŠ›åœ°æ›¿ç¨‹åºå‘˜ <strong>å¤„ç†å°½å¯èƒ½å¤šçš„çº¿ç¨‹å¹¶å‘ç»†èŠ‚</strong>ï¼Œ<br>ä½¿å¾—ç¨‹åºå‘˜ åœ¨ç¼–ç æ—¶èƒ½ <strong>æ›´å…³æ³¨ä¸šåŠ¡é€»è¾‘</strong>ï¼Œ<br>è€Œ <strong>ä¸æ˜¯èŠ±è´¹å¤§éƒ¨åˆ†æ—¶é—´</strong>å» <strong>å…³æ³¨æ­¤æœåŠ¡</strong> <strong>ä¼šåŒæ—¶è¢«å¤šå°‘äººè°ƒç”¨</strong>ã€<strong>å¦‚ä½•åè°ƒç¡¬ä»¶èµ„æº</strong>ã€‚</p><blockquote><p>javaè¯­è¨€å’Œè™šæ‹Ÿæœº æä¾›çš„è®¸å¤š å·¥å…·ï¼Œé™ä½äº† å¹¶å‘ç¼–ç¨‹ çš„ é—¨æ§›ã€‚<br>å„ç§ä¸­é—´ä»¶æœåŠ¡å™¨ã€å„ç±»æ¡†æ¶çš„å¥½å¤„ï¼š</p><ul><li>å„ç§ ä¸­é—´ä»¶æœåŠ¡å™¨ã€å„ç±»æ¡†æ¶ å¤„ç†å°½å¯èƒ½å¤šçš„çº¿ç¨‹å¹¶å‘ç»†èŠ‚ï¼›</li><li>ç¨‹åºå‘˜èƒ½å¤Ÿå…³æ³¨ä¸šåŠ¡é€»è¾‘ï¼Œé¿å…èŠ±è´¹å¤§éƒ¨åˆ†æ—¶é—´å» å…³æ³¨æ­¤æœåŠ¡ ä¼šåŒæ—¶è¢«å¤šå°‘äººè°ƒç”¨ã€å¦‚ä½•åè°ƒç¡¬ä»¶èµ„æºç­‰</li></ul></blockquote><p>æ— è®º<strong>è¯­è¨€ã€ä¸­é—´ä»¶å’Œæ¡†æ¶</strong> å¦‚ä½•å…ˆè¿›ï¼Œå¼€å‘äººå‘˜éƒ½<strong>ä¸èƒ½æœŸæœ› å®ƒä»¬èƒ½ç‹¬ç«‹å®Œæˆæ‰€æœ‰å¹¶å‘å¤„ç†çš„äº‹æƒ…</strong>ï¼Œäº†è§£ å¹¶å‘çš„å†…å¹• ä¹Ÿæ˜¯ ç§°ä¸ºä¸€ä¸ªé«˜çº§ç¨‹åºå‘˜ ä¸å¯ç¼ºå°‘çš„è¯¾ç¨‹ã€‚<br>ï¼ˆğŸ™ƒå°½ç®¡æˆ‘æ˜¯å¦‚æ­¤åƒåœ¾ï¼Œä½†æ˜¯æˆ‘ä¾ç„¶çƒ­çˆ±â€”â€“ä¸ªå±ğŸ™ƒï¼‰</p><blockquote><p>ä¸èƒ½å»æœŸæœ› æŸç§è¯­è¨€ã€ä¸­é—´ä»¶æˆ–è€…æ¡†æ¶ èƒ½å¤Ÿç‹¬ç«‹å®Œæˆæ‰€æœ‰å¹¶å‘å¤„ç†çš„äº‹æƒ…ã€‚</p></blockquote><p>â€œ<strong>é«˜æ•ˆå¹¶å‘</strong>â€ æ˜¯æœ¬ä¹¦ è®²è§£javaè™šæ‹Ÿæœºçš„æœ€åä¸€éƒ¨åˆ†ï¼Œ<br>å°†ä¼šå‘è¯»è€…ä»‹ç»  <strong>è™šæ‹Ÿæœº</strong>  å¦‚ä½•å®ç° <strong>å¤šçº¿ç¨‹ã€å¤šçº¿ç¨‹ä¹‹é—´</strong> ç”±äº <strong>å…±äº«</strong> å’Œ <strong>ç«äº‰æ•°æ®</strong> è€Œ <strong>å¯¼è‡´çš„</strong> ä¸€ç³»åˆ— <strong>é—®é¢˜</strong> åŠ <strong>è§£å†³æ–¹æ¡ˆ</strong>ã€‚</p><h4 id="ç¡¬ä»¶çš„æ•ˆç‡-ä¸-ä¸€è‡´æ€§"><a href="#ç¡¬ä»¶çš„æ•ˆç‡-ä¸-ä¸€è‡´æ€§" class="headerlink" title="ç¡¬ä»¶çš„æ•ˆç‡ ä¸ ä¸€è‡´æ€§"></a>ç¡¬ä»¶çš„æ•ˆç‡ ä¸ ä¸€è‡´æ€§</h4><p>åœ¨æ­£å¼è®²è§£ <strong>javaè™šæ‹Ÿæœºå¹¶å‘ç›¸å…³</strong> çš„çŸ¥è¯†ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆèŠ±è´¹ä¸€ç‚¹æ—¶é—´å»äº†è§£ä¸€ä¸‹ <strong>ç‰©ç†è®¡ç®—æœº</strong>ä¸­çš„ <strong>å¹¶å‘é—®é¢˜</strong>ï¼Œ<br><strong>ç‰©ç†æœº</strong>é‡åˆ°çš„ <strong>å¹¶å‘é—®é¢˜</strong> ä¸ <strong>è™šæ‹Ÿæœºä¸­çš„æƒ…å†µ</strong> æœ‰ä¸å°‘<strong>ç›¸ä¼¼</strong>ä¹‹å¤„ï¼Œ<br><strong>ç‰©ç†æœº</strong> å¯¹ <strong>å¹¶å‘çš„å¤„ç†æ–¹æ¡ˆ</strong> å¯¹äº <strong>è™šæ‹Ÿæœºçš„å®ç°</strong> ä¹Ÿæœ‰ç›¸å½“å¤§çš„å‚è€ƒæ„ä¹‰ã€‚</p><blockquote><p>ç‰©ç†æœºä¸è™šæ‹Ÿæœº</p><ul><li>ç‰©ç†æœº é‡åˆ°çš„ å¹¶å‘é—®é¢˜ ä¸ è™šæ‹Ÿæœºä¸­çš„æƒ…å†µ æœ‰ä¸å°‘ç›¸ä¼¼ä¹‹å¤„ï¼›</li><li>ç‰©ç†æœº å¯¹ å¹¶å‘çš„å¤„ç†æ–¹æ¡ˆ å¯¹äº è™šæ‹Ÿæœºçš„å®ç° ä¹Ÿæœ‰ç›¸å½“å¤§çš„å‚è€ƒæ„ä¹‰ã€‚</li></ul></blockquote><p>â€œè®© <strong>è®¡ç®—æœº</strong> <strong>å¹¶å‘æ‰§è¡Œ</strong> <strong>è‹¥å¹²ä¸ª</strong> <strong>è¿ç®—ä»»åŠ¡</strong>â€ ä¸ â€œæ›´<strong>å……åˆ†</strong> åœ° <strong>åˆ©ç”¨</strong> <strong>è®¡ç®—æœºå¤„ç†å™¨çš„æ•ˆèƒ½</strong>â€ ä¹‹é—´çš„å› æœå…³ç³»ï¼Œçœ‹èµ·æ¥é¡ºç†æˆç« ï¼Œ<br>å®é™…ä¸Šä»–ä»¬ä¹‹é—´çš„å…³ç³» å¹¶æ²¡æœ‰æƒ³è±¡ä¸­çš„é‚£ä¹ˆç®€å•ï¼Œ<br>å…¶ä¸­ä¸€ä¸ª é‡è¦çš„<strong>å¤æ‚æ€§</strong> æ¥æºæ˜¯ ç»å¤§å¤šæ•°çš„ <strong>è¿ç®—ä»»åŠ¡</strong> éƒ½ <strong>ä¸å¯èƒ½</strong> <strong>åªé </strong> <strong>å¤„ç†å™¨â€œè®¡ç®—â€</strong> å°±èƒ½å®Œæˆï¼Œ<br><strong>å¤„ç†å™¨</strong> è‡³å°‘ è¦ä¸ <strong>å†…å­˜äº¤äº’</strong>ï¼Œ<br>å¦‚è¯»å–è¿ç®—æ•°æ®ã€å­˜å‚¨è¿ç®—ç»“æœç­‰ï¼Œ<br>è¿™ä¸ª<strong>I/O</strong>æ“ä½œæ˜¯å¾ˆ<strong>éš¾æ¶ˆé™¤</strong>çš„<br>ï¼ˆ<strong>æ— æ³•ä»…é å¯„å­˜å™¨</strong>æ¥<strong>å®Œæˆ</strong>æ‰€æœ‰è¿ç®—<strong>ä»»åŠ¡</strong>ï¼‰ã€‚  </p><p>ç”±äº <strong>è®¡ç®—æœºçš„å­˜å‚¨è®¾å¤‡</strong> ä¸ <strong>å¤„ç†å™¨çš„è¿ç®—é€Ÿåº¦</strong> æœ‰å‡ ä¸ªæ•°é‡çº§çš„å·®è·ï¼Œ<br>æ‰€ä»¥ <strong>ç°ä»£è®¡ç®—æœºç³»ç»Ÿ</strong> éƒ½ä¸å¾—ä¸åŠ å…¥ ä¸€å±‚ <strong>è¯»å†™é€Ÿåº¦</strong> <strong>å°½å¯èƒ½æ¥è¿‘</strong> <strong>å¤„ç†å™¨è¿ç®—é€Ÿåº¦</strong> çš„ <strong>é«˜é€Ÿç¼“å­˜ï¼ˆCacheï¼‰</strong> æ¥ä½œä¸º <strong>å†…å­˜ä¸å¤„ç†å™¨</strong> ä¹‹é—´çš„<strong>ç¼“å†²</strong>ï¼š<br>å°†è¿ç®—éœ€è¦ä½¿ç”¨çš„<strong>æ•°æ®</strong> <strong>å¤åˆ¶</strong>åˆ° <strong>ç¼“å­˜</strong>ä¸­ï¼Œ<br>è®©<strong>è¿ç®—</strong>èƒ½<strong>å¿«é€Ÿè¿›è¡Œ</strong>ï¼Œ<br>å½“<strong>è¿ç®—ç»“æŸ</strong>å å†ä» <strong>ç¼“å­˜</strong> <strong>åŒæ­¥</strong>å› <strong>å†…å­˜</strong>ä¹‹ä¸­ï¼Œ<br>è¿™æ · <strong>å¤„ç†å™¨</strong> å°± <strong>æ— éœ€ç­‰å¾…</strong> ç¼“æ…¢çš„ <strong>å†…å­˜è¯»å†™</strong> äº†ã€‚</p><blockquote><p>â€œè®©è®¡ç®—æœº å¹¶å‘æ‰§è¡Œ è‹¥å¹²ä¸ªè¿ç®—ä»»åŠ¡â€ ä¸ â€œæ›´å……åˆ†åœ°åˆ©ç”¨è®¡ç®—æœºå¤„ç†å™¨çš„æ•ˆèƒ½â€ä¹‹é—´å› æœå…³ç³»çš„å¤æ‚æ€§æ¥æº</p><ol><li>ç»å¤§å¤šæ•°çš„è¿ç®—ä»»åŠ¡éƒ½ä¸å¯èƒ½åªé  å¤„ç†å™¨â€œè®¡ç®—â€ å°±èƒ½å®Œæˆ</li><li>å¤„ç†å™¨ è‡³å°‘ è¦ä¸ å†…å­˜äº¤äº’ï¼ˆå¦‚è¯»å–è¿ç®—æ•°æ®ã€å­˜å‚¨è¿ç®—ç»“æœç­‰ï¼‰ï¼›è¿™ä¸ªI/Oæ“ä½œæ˜¯å¾ˆéš¾æ¶ˆé™¤çš„ï¼›</li><li>æ— æ³•ä»…é å¯„å­˜å™¨æ¥å®Œæˆæ‰€æœ‰è¿ç®—ä»»åŠ¡ï¼›</li><li>è®¡ç®—æœºçš„å­˜å‚¨è®¾å¤‡ ä¸ å¤„ç†å™¨çš„è¿ç®—é€Ÿåº¦ æœ‰å‡ ä¸ªæ•°é‡çº§çš„ å·®è·ã€‚</li><li>ç°ä»£è®¡ç®—æœºç³»ç»Ÿä¸­åŠ å…¥äº† ä¸€å±‚ (è¯»å†™é€Ÿåº¦å°½å¯èƒ½æ¥è¿‘å¤„ç†å™¨è¿ç®—é€Ÿåº¦) çš„ é«˜é€Ÿç¼“å­˜ï¼ˆCacheï¼‰ æ¥ä½œä¸º <strong>å†…å­˜ä¸å¤„ç†å™¨ä¹‹é—´çš„ç¼“å†²</strong>ï¼š<ul><li>å°† è¿ç®— æ‰€éœ€è¦ä½¿ç”¨åˆ°çš„ æ•°æ® å¤åˆ¶åˆ° ç¼“å­˜ ä¸­ï¼›</li><li>è®©è¿ç®—èƒ½å¿«é€Ÿè¿›è¡Œï¼›</li><li>å½“è¿ç®—ç»“æŸåï¼Œå†ä» ç¼“å­˜ åŒæ­¥ å› å†…å­˜ ä¹‹ä¸­ï¼›</li><li>è¿™æ ·å¤„ç†å™¨ å°±æ— éœ€ç­‰å¾… ç¼“æ…¢çš„ å†…å­˜è¯»å†™ äº†ï¼›</li></ul></li></ol></blockquote><p>åŸºäº <strong>é«˜é€Ÿç¼“å­˜</strong> çš„ <strong>å­˜å‚¨äº¤äº’</strong> å¾ˆå¥½åœ°è§£å†³äº† <strong>å¤„ç†å™¨ ä¸ å†…å­˜ çš„é€Ÿåº¦çŸ›ç›¾</strong>ï¼Œ<br>ä½†æ˜¯ä¹Ÿä¸º è®¡ç®—æœºç³»ç»Ÿ å¸¦æ¥æ›´é«˜çš„<strong>å¤æ‚åº¦</strong>ï¼Œ<br>å› ä¸ºå®ƒå¼•å…¥äº†ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼š <strong>ç¼“å­˜ä¸€è‡´æ€§ï¼ˆCache Coherenceï¼‰</strong>ã€‚  </p><blockquote><p>é«˜é€Ÿç¼“å­˜ çš„ å­˜å‚¨äº¤äº’ ä¼˜ç¼ºç‚¹ï¼š</p><ul><li>ä¼˜ç‚¹ï¼šè§£å†³äº† å¤„ç†å™¨ä¸å†…å­˜ ä¹‹é—´çš„ é€Ÿåº¦çŸ›ç›¾ï¼›</li><li>ç¼ºç‚¹ï¼šå¸¦æ¥äº†æ–°é—®é¢˜-ç¼“å­˜ä¸€è‡´æ€§ï¼ˆCache Coherenceï¼‰</li></ul></blockquote><p>åœ¨ <strong>å¤šå¤„ç†å™¨ç³»ç»Ÿ</strong> ä¸­ï¼Œæ¯ä¸ª <strong>å¤„ç†å™¨</strong> éƒ½æœ‰ è‡ªå·±çš„ <strong>é«˜é€Ÿç¼“å­˜</strong>ï¼Œè€Œå®ƒä»¬åˆ <strong>å…±äº«</strong> <strong>åŒä¸€ä¸»å†…å­˜ï¼ˆMain Memoryï¼‰</strong>ã€‚</p><p>å½“ <strong>å¤šä¸ªå¤„ç†å™¨çš„è¿ç®—ä»»åŠ¡</strong> éƒ½è®¾è®¡ <strong>åŒä¸€å—</strong> <strong>ä¸»å†…å­˜åŒºåŸŸ</strong> æ—¶ï¼Œ<br> å°†å¯èƒ½å¯¼è‡´ <strong>å„è‡ªçš„ç¼“å­˜æ•°æ®ä¸ä¸€è‡´</strong>ï¼Œ<br> å¦‚æœçœŸçš„å‘ç”Ÿè¿™ç§æƒ…å†µï¼Œé‚£åŒæ­¥å›åˆ° ä¸»å†…å­˜æ—¶ ä»¥è°çš„ç¼“å­˜æ•°æ®ä¸ºå‡†å‘¢ï¼Ÿ  </p><p>ä¸ºäº†<strong>è§£å†³ä¸€è‡´æ€§çš„é—®é¢˜</strong>ï¼Œ<br>éœ€è¦ å„ä¸ª <strong>å¤„ç†å™¨</strong> <strong>è®¿é—®ç¼“å­˜</strong> æ—¶ éƒ½ <strong>éµå¾ª</strong> ä¸€äº› <strong>åè®®</strong>ï¼Œ<br>åœ¨<strong>è¯»å†™</strong>æ—¶ è¦<strong>æ ¹æ®åè®®</strong> æ¥è¿›è¡Œ<strong>æ“ä½œ</strong>ï¼Œ<br>è¿™ç±»åè®®æœ‰ MSIã€MESIï¼ˆIllinois Protoclï¼‰ã€MOSIã€Synapseã€Firefly åŠ Dragon Protocol ç­‰ã€‚  </p><p>åœ¨æœ¬ç« ä¸­å°†ä¼šå¤šæ¬¡æåˆ°çš„ â€œ<strong>å†…å­˜æ¨¡å‹</strong>â€ ä¸€è¯ï¼Œ<br>å¯ä»¥ç†è§£ä¸º åœ¨<strong>ç‰¹å®šçš„æ“ä½œåè®®</strong>ä¸‹ï¼Œå¯¹ <strong>ç‰¹å®šçš„å†…å­˜æˆ–é«˜é€Ÿç¼“å­˜</strong> è¿›è¡Œ <strong>è¯»å†™è®¿é—®çš„è¿‡ç¨‹æŠ½è±¡</strong>ã€‚  </p><p><strong>ä¸åŒæ¶æ„çš„ç‰©ç†æœºå™¨</strong> å¯ä»¥æ‹¥æœ‰ <strong>ä¸ä¸€æ ·çš„å†…å­˜æ¨¡å‹</strong>ï¼Œ<br>è€Œ <strong>javaè™šæ‹Ÿæœº</strong> ä¹Ÿæœ‰è‡ªå·±çš„<strong>å†…å­˜æ¨¡å‹</strong>ï¼Œ<br>å¹¶ä¸”è¿™é‡Œä»‹ç»çš„ <strong>å†…å­˜è®¿é—®æ“ä½œ</strong> ä¸ <strong>ç¡¬ä»¶çš„ç¼“å­˜è®¿é—®æ“ä½œ</strong>å…·æœ‰å¾ˆé«˜çš„<strong>å¯æ¯”æ€§</strong>ã€‚</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">---------               -----------                ----------------               ------</span><br><span class="line">|<span class="string"> å¤„ç†å™¨ </span>|<span class="string"> &lt;----------&gt; </span>|<span class="string"> é«˜é€Ÿç¼“å­˜ </span>|<span class="string">  &lt;----------&gt; </span>|<span class="string">      ç¼“å­˜     </span>|<span class="string">  &lt;----------&gt; </span>|<span class="string"> ä¸» </span>|</span><br><span class="line">---------               -----------               |<span class="string">               </span>|<span class="string">               </span>|<span class="string">    </span>|</span><br><span class="line">---------               -----------               |<span class="string">               </span>|<span class="string">               </span>|<span class="string">    </span>|</span><br><span class="line">|<span class="string"> å¤„ç†å™¨ </span>|<span class="string"> &lt;----------&gt; </span>|<span class="string"> é«˜é€Ÿç¼“å­˜ </span>|<span class="string">  &lt;----------&gt; </span>|<span class="string">     ä¸€è‡´æ€§    </span>|<span class="string">  &lt;----------&gt; </span>|<span class="string"> å†… </span>|</span><br><span class="line">---------               -----------               |<span class="string">               </span>|<span class="string">               </span>|<span class="string">    </span>|</span><br><span class="line">---------               -----------               |<span class="string">               </span>|<span class="string">               </span>|<span class="string">    </span>|</span><br><span class="line">|<span class="string"> å¤„ç†å™¨ </span>|<span class="string"> &lt;----------&gt; </span>|<span class="string"> é«˜é€Ÿç¼“å­˜ </span>|<span class="string">  &lt;----------&gt; </span>|<span class="string">      åè®®     </span>|<span class="string">  &lt;----------&gt; </span>|<span class="string"> å­˜ </span>|</span><br><span class="line">---------               -----------                ----------------               ------</span><br></pre></td></tr></table></figure><p>é™¤äº† <strong>å¢åŠ </strong> <strong>é«˜é€Ÿç¼“å­˜</strong> ä¹‹å¤–ï¼Œ<br>ä¸ºäº†ä½¿å¾— <strong>å¤„ç†å™¨å†…éƒ¨ çš„ è¿ç®—å•ä½</strong> èƒ½å°½é‡è¢« <strong>å……åˆ†ä½¿ç”¨</strong>ï¼Œ<br><strong>å¤„ç†å™¨</strong> å¯èƒ½ä¼šå¯¹ <strong>è¾“å…¥ä»£ç </strong> è¿›è¡Œ <strong>ä¹±åºæ‰§è¡Œï¼ˆOut-Of-Order Executionï¼‰ä¼˜åŒ–</strong>ï¼Œ<br><strong>å¤„ç†å™¨</strong> ä¼šåœ¨ <strong>è®¡ç®—ä¹‹å</strong> å°†<strong>ä¹±åºæ‰§è¡Œçš„ç»“æœ</strong> <strong>é‡ç»„</strong>ï¼Œ<br>ä¿è¯ <strong>è¯¥ç»“æœ ä¸ é¡ºåºæ‰§è¡Œ çš„ç»“æœæ˜¯ä¸€è‡´çš„</strong>ï¼Œ<br>ä½† <strong>å¹¶ä¸ä¿è¯ ç¨‹åºä¸­ å„ä¸ªè¯­å¥ è®¡ç®—çš„å…ˆåé¡ºåº ä¸ è¾“å…¥ä»£ç ä¸­çš„é¡ºåº ä¸€è‡´</strong>ï¼Œ<br>å› æ­¤ ï¼Œ<br>å¦‚æœ<strong>å­˜åœ¨ ä¸€ä¸ªè®¡ç®—ä»»åŠ¡ ä¾èµ– å¦å¤–ä¸€ä¸ª è®¡ç®—ä»»åŠ¡çš„ ä¸­é—´ç»“æœ</strong>ï¼Œ<br>é‚£ä¹ˆå…¶ <strong>é¡ºåºæ€§å¹¶ä¸èƒ½é  ä»£ç çš„å…ˆåé¡ºåº æ¥ä¿è¯</strong>ã€‚  </p><p>ä¸ <strong>å¤„ç†å™¨çš„ä¹±åºæ‰§è¡Œä¼˜åŒ–</strong> ç±»ä¼¼ï¼Œ<br><strong>javaè™šæ‹Ÿæœº</strong> çš„ <strong>å³æ—¶ç¼–è¯‘å™¨</strong> ä¸­ä¹Ÿæœ‰ç±»ä¼¼çš„ <strong>æŒ‡ä»¤é‡æ’åºï¼ˆInstruction Reorderï¼‰ä¼˜åŒ–</strong>ã€‚</p><blockquote><p>å¤„ç†å™¨å†…éƒ¨ çš„ è¿ç®—å•ä½ï¼Œå¦‚ä½•å°½å¯èƒ½è¢« å……åˆ†åˆ©ç”¨ï¼Ÿ</p><ul><li>å¢åŠ é«˜é€Ÿç¼“å­˜</li><li>ä¹±åºæ‰§è¡Œï¼ˆOut-Of-Order Executionï¼‰ä¼˜åŒ–<ul><li>å¤„ç†å™¨ å¯èƒ½ä¼šå¯¹ è¾“å…¥ä»£ç  è¿›è¡Œ ä¹±åºæ‰§è¡Œï¼ˆOut-Of-Order Executionï¼‰ä¼˜åŒ–</li><li>å¤„ç†å™¨ ä¼šåœ¨ è®¡ç®—ä¹‹å å°† ä¹±åºæ‰§è¡Œçš„ç»“æœ é‡ç»„</li><li>ä¿è¯ è¯¥ç»“æœ ä¸ é¡ºåºæ‰§è¡Œ çš„ç»“æœ æ˜¯ä¸€è‡´çš„ï¼›</li><li>ä½†å¹¶ ä¸ä¿è¯ ç¨‹åºä¸­å„ä¸ªè¯­å¥è®¡ç®—çš„å…ˆåé¡ºåº ä¸ è¾“å…¥ä»£ç ä¸­çš„é¡ºåº ä¸€è‡´ï¼›</li><li>å¦‚æœå­˜åœ¨ ä¸€ä¸ªè®¡ç®—ä»»åŠ¡ ä¾èµ– å¦å¤–ä¸€ä¸ªè®¡ç®—ä»»åŠ¡çš„ ä¸­é—´ç»“æœï¼Œé‚£ä¹ˆå…¶é¡ºåºæ€§ å¹¶ä¸èƒ½ä¾é  ä»£ç çš„å…ˆåé¡ºåº æ¥ä¿è¯ã€‚</li></ul></li></ul></blockquote><h4 id="Javaå†…å­˜æ¨¡å‹"><a href="#Javaå†…å­˜æ¨¡å‹" class="headerlink" title="Javaå†…å­˜æ¨¡å‹"></a>Javaå†…å­˜æ¨¡å‹</h4><p><strong>Javaè™šæ‹Ÿæœºè§„èŒƒ</strong> ä¸­è¯•å›¾å®šä¹‰ä¸€ç§  <strong>Javaå†…å­˜æ¨¡å‹ï¼ˆJava Memory Modelï¼ŒJMMï¼‰</strong><br>æ¥ <strong>å±è”½æ‰</strong> å„ç§ <strong>ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿ</strong> çš„ <strong>å†…å­˜è®¿é—®å·®å¼‚</strong>ï¼Œ<br>ä»¥ <strong>å®ç°</strong> è®© <strong>Javaç¨‹åº</strong> åœ¨ <strong>å„ç§å¹³å°</strong> ä¸‹éƒ½èƒ½è¾¾åˆ°<strong>ä¸€è‡´çš„å†…å­˜è®¿é—®æ•ˆæœ</strong>ã€‚</p><blockquote><p>æœ¬ä¹¦ä¸­çš„ Javaå†…å­˜æ¨¡å‹ éƒ½ç‰¹æŒ‡ ç›®å‰æ­£åœ¨ä½¿ç”¨çš„ï¼Œå³åœ¨ JDK1.2 ä¹‹åå»ºç«‹èµ·æ¥å¹¶åœ¨ JDK1.5 ä¸­å®Œå¤‡è¿‡çš„å†…å­˜æ¨¡å‹ã€‚</p></blockquote><p>åœ¨æ­¤ä¹‹å‰ï¼Œä¸»æµç¨‹åºè¯­è¨€ï¼ˆC/C++ç­‰ï¼‰ <strong>ç›´æ¥ä½¿ç”¨</strong> <strong>ç‰©ç†ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿçš„å†…å­˜æ¨¡å‹</strong>ï¼Œ<br>å› æ­¤ï¼Œä¼šç”±äº<strong>ä¸åŒå¹³å°ä¸Šå†…å­˜æ¨¡å‹çš„å·®å¼‚</strong>ï¼Œæœ‰å¯èƒ½å¯¼è‡´ç¨‹åºåœ¨ä¸€å¥—å¹³å°ä¸Šå¹¶å‘å®Œå…¨<strong>æ­£å¸¸</strong>ï¼Œè€Œåœ¨å¦å¤–ä¸€å¥—å¹³å°ä¸Šå¹¶å‘è®¿é—®å´ç»å¸¸<strong>å‡ºé”™</strong>ï¼Œå› æ­¤åœ¨æŸäº›åœºæ™¯å°±å¿…é¡»é’ˆå¯¹ä¸åŒçš„å¹³å°æ¥ç¼–å†™ç¨‹åºã€‚</p><p><strong>å®šä¹‰Javaå†…å­˜æ¨¡å‹</strong> å¹¶éä¸€ä»¶å®¹æ˜“çš„äº‹æƒ…ï¼Œ<br>è¿™ä¸ªæ¨¡å‹å¿…é¡»å®šä¹‰å¾—<strong>è¶³å¤Ÿä¸¥è°¨</strong>ï¼Œæ‰èƒ½è®©Javaçš„ <strong>å¹¶å‘å†…å­˜è®¿é—®æ“ä½œ</strong> <strong>ä¸ä¼šäº§ç”Ÿæ­§ä¹‰</strong>ï¼›<br>ä½†æ˜¯ï¼Œä¹Ÿå¿…é¡»å®šä¹‰å¾—<strong>è¶³å¤Ÿå®½æ¾</strong>ï¼Œä½¿å¾— è™šæ‹Ÿæœºçš„å®ç° æœ‰è¶³å¤Ÿçš„è‡ªç”±ç©ºé—´ å»åˆ©ç”¨ ç¡¬ä»¶çš„å„ç§ç‰¹æ€§ï¼ˆå¯„å­˜å™¨ã€é«˜é€Ÿç¼“å­˜å’ŒæŒ‡ä»¤é›†ä¸­æŸäº›ç‰¹æœ‰çš„æŒ‡ä»¤ï¼‰æ¥ è·å– æ›´å¥½çš„æ‰§è¡Œé€Ÿåº¦ã€‚<br>ç»è¿‡é•¿æ—¶é—´çš„éªŒè¯å’Œä¿®è¡¥ï¼Œåœ¨ JDK1.5ï¼ˆå®ç°äº†JSR-133ï¼‰å‘å¸ƒåï¼ŒJavaå†…å­˜æ¨¡å‹å·²ç»æˆç†Ÿå’Œå®Œå–„èµ·æ¥äº†ã€‚</p><blockquote><p>JSR-133ï¼šJava Memory Model and Thread Specification Revision ï¼ˆJavaå†…å­˜æ¨¡å‹å’Œçº¿ç¨‹è§„èŒƒä¿®è®¢ï¼‰ã€‚</p></blockquote><h5 id="ä¸»å†…å­˜å’Œå·¥ä½œå†…å­˜"><a href="#ä¸»å†…å­˜å’Œå·¥ä½œå†…å­˜" class="headerlink" title="ä¸»å†…å­˜å’Œå·¥ä½œå†…å­˜"></a>ä¸»å†…å­˜å’Œå·¥ä½œå†…å­˜</h5><p>Javaå†…å­˜æ¨¡å‹ çš„ ä¸»è¦ç›®æ ‡ æ˜¯ å®šä¹‰ç¨‹åºä¸­ å„ä¸ªå˜é‡çš„ è®¿é—®è§„åˆ™ï¼Œå³åœ¨ è™šæ‹Ÿæœºä¸­ å°† å˜é‡å­˜å‚¨åˆ°å†…å­˜ å’Œ ä»å†…å­˜ä¸­å–å‡ºå˜é‡ è¿™æ ·çš„åº•å±‚ç»†èŠ‚ã€‚  </p><p>æ­¤å¤„çš„ å˜é‡ï¼ˆVariablesï¼‰ä¸Javaç¼–ç¨‹ä¸­æ‰€è¯´çš„å˜é‡ æœ‰åŒºåˆ«ï¼Œå®ƒ åŒ…æ‹¬äº† å®ä¾‹å­—æ®µã€é™æ€å­—æ®µå’Œæ„æˆæ•°ç»„å¯¹è±¡çš„å…ƒç´ ï¼Œä½†ä¸åŒ…æ‹¬ å±€éƒ¨å˜é‡ä¸æ–¹æ³•å‚æ•°ï¼Œ<br>å› ä¸ºåè€…æ˜¯ çº¿ç¨‹ç§æœ‰çš„ï¼Œä¸ä¼šè¢«å…±äº«ï¼Œè‡ªç„¶å°±ä¸ä¼šå­˜åœ¨ç«äº‰é—®é¢˜ã€‚</p><blockquote><p>æ­¤å¤„è¯·è¯»è€…æ³¨æ„åŒºåˆ†æ¦‚å¿µï¼š<br>å¦‚æœ å±€éƒ¨å˜é‡ æ˜¯ä¸€ä¸ª reference ç±»å‹ï¼Œå®ƒ å¼•ç”¨çš„å¯¹è±¡ åœ¨ Javaå †ä¸­ å¯è¢« å„ä¸ªçº¿ç¨‹å…±äº«ï¼Œä½†æ˜¯ reference æœ¬èº«åœ¨ Javaæ ˆçš„ å±€éƒ¨å˜é‡è¡¨ä¸­ï¼Œå®ƒæ˜¯çº¿ç¨‹ç§æœ‰çš„ã€‚</p></blockquote><p>ä¸ºäº†è·å¾—è¾ƒå¥½çš„ æ‰§è¡Œæ•ˆèƒ½ï¼ŒJavaå†…å­˜æ¨¡å‹ å¹¶æ²¡æœ‰é™åˆ¶ æ‰§è¡Œå¼•æ“ ä½¿ç”¨å¤„ç†å™¨çš„ ç‰¹å®šå¯„å­˜å™¨ æˆ– ç¼“å­˜ æ¥å’Œä¸»å†…å­˜è¿›è¡Œäº¤äº’ï¼Œä¹Ÿæ²¡æœ‰é™åˆ¶ å³æ—¶ç¼–è¯‘å™¨ è¿›è¡Œè°ƒæ•´ä»£ç æ‰§è¡Œé¡ºåº è¿™ç±»ä¼˜åŒ–æªæ–½ã€‚</p><p>Javaå†…å­˜æ¨¡å‹ è§„å®šäº† æ‰€æœ‰çš„å˜é‡ éƒ½ å­˜å‚¨åœ¨ä¸»å†…å­˜ï¼ˆMain Memoryï¼‰ä¸­ï¼ˆæ­¤å¤„çš„ ä¸»å†…å­˜ ä¸ä»‹ç» ç‰©ç†ç¡¬ä»¶æ—¶çš„ä¸»å†…å­˜ åå­—ä¸€æ ·ï¼Œä¸¤è€…ä¹Ÿå¯ä»¥äº’ç›¸ç±»æ¯”ï¼Œä½† æ­¤å¤„ä»…æ˜¯ è™šæ‹Ÿæœºå†…å­˜ çš„ä¸€éƒ¨åˆ†ï¼‰ã€‚</p><p>æ¯æ¡çº¿ç¨‹ è¿˜æœ‰è‡ªå·±çš„ å·¥ä½œå†…å­˜ï¼ˆWorking Memoryï¼Œ å¯ä¸å‰é¢è®²çš„ å¤„ç†å™¨é«˜é€Ÿç¼“å­˜ ç±»æ¯”ï¼‰ï¼Œçº¿ç¨‹ çš„ å·¥ä½œå†…å­˜ ä¸­ ä¿å­˜äº† è¢«è¯¥çº¿ç¨‹ ä½¿ç”¨åˆ°çš„ å˜é‡ çš„ ä¸»å†…å­˜ å‰¯æœ¬æ‹·è´ï¼Œçº¿ç¨‹ å¯¹ å˜é‡ çš„æ‰€æœ‰æ“ä½œï¼ˆè¯»å–ã€èµ‹å€¼ç­‰ï¼‰ éƒ½ å¿…é¡»åœ¨å·¥ä½œå†…å­˜ä¸­è¿›è¡Œï¼Œ è€Œä¸èƒ½ç›´æ¥è¯»å†™ä¸»å†…å­˜ä¸­çš„å˜é‡ã€‚  </p><blockquote><p>æœ‰ä¸å°‘è¯»è€…ä¼šå¯¹è¿™æ®µæè¿°ä¸­çš„ â€œæ‹·è´å‰¯æœ¬â€ æå‡ºç–‘é—®ï¼Œ<br>å¦‚ â€œå‡è®¾çº¿ç¨‹ä¸­è®¿é—®ä¸€ä¸ª10MBçš„å¯¹è±¡ï¼Œä¹Ÿä¼šæŠŠè¿™10MBçš„å†…å­˜å¤åˆ¶ä¸€ä»½æ‹·è´å‡ºæ¥å—ï¼Ÿâ€<br>äº‹å®ä¸Šå¹¶ä¸ä¼šå¦‚æ­¤ï¼Œè¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨ã€å¯¹è±¡ä¸­æŸä¸ªåœ¨çº¿ç¨‹è®¿é—®åˆ°çš„å­—æ®µ æ˜¯æœ‰å¯èƒ½å­˜åœ¨æ‹·è´çš„ï¼Œä½† ä¸ä¼šæœ‰ è™šæ‹Ÿæœº å®ç°æˆ æŠŠæ•´ä¸ªå¯¹è±¡æ‹·è´ä¸€æ¬¡ã€‚</p></blockquote><blockquote><p>æ ¹æ® Javaè™šæ‹Ÿæœºè§„èŒƒ çš„è§„å®š<br>volatileå˜é‡ ä¾ç„¶æœ‰å·¥ä½œå†…å­˜çš„æ‹·è´<br>ä½†æ˜¯ç”±äº å®ƒ ç‰¹æ®Šçš„æ“ä½œé¡ºåºæ€§è§„å®šï¼ˆåæ–‡ä¼šè®²åˆ°ï¼‰ï¼Œ<br>æ‰€ä»¥çœ‹èµ·æ¥å¦‚åŒç›´æ¥åœ¨ä¸»å†…å­˜ä¸­è¯»å†™è®¿é—®ä¸€èˆ¬ï¼Œå› æ­¤è¿™é‡Œçš„æè¿°å¯¹äº volatileä¹Ÿå¹¶ä¸å­˜åœ¨ä¾‹å¤–ã€‚</p></blockquote><p>ä¸åŒçš„ çº¿ç¨‹ä¹‹é—´ ä¹Ÿæ— æ³• ç›´æ¥è®¿é—® å¯¹æ–¹å·¥ä½œå†…å­˜ä¸­çš„ å˜é‡ï¼Œçº¿ç¨‹é—´ å˜é‡å€¼çš„ä¼ é€’ å‡éœ€è¦ é€šè¿‡ä¸»å†…å­˜æ¥å®Œæˆï¼Œçº¿ç¨‹ã€ä¸»å†…å­˜ã€å·¥ä½œå†…å­˜ä¸‰è€…çš„äº¤äº’å…³ç³»ï¼›  </p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">------------              -----------                ----------------               ------</span><br><span class="line">|<span class="string"> Javaçº¿ç¨‹ </span>|<span class="string"> &lt;----------&gt; </span>|<span class="string"> å·¥ä½œå†…å­˜ </span>|<span class="string">  &lt;----------&gt; </span>|<span class="string">      Save     </span>|<span class="string">  &lt;----------&gt; </span>|<span class="string"> ä¸» </span>|</span><br><span class="line">------------              -----------               |<span class="string">       å’Œ      </span>|<span class="string">               </span>|<span class="string">    </span>|</span><br><span class="line">------------              -----------               |<span class="string">               </span>|<span class="string">               </span>|<span class="string">    </span>|</span><br><span class="line">|<span class="string"> Javaçº¿ç¨‹ </span>|<span class="string"> &lt;----------&gt; </span>|<span class="string"> å·¥ä½œå†…å­˜ </span>|<span class="string">  &lt;----------&gt; </span>|<span class="string">     Load      </span>|<span class="string">  &lt;----------&gt; </span>|<span class="string"> å†… </span>|</span><br><span class="line">------------              -----------               |<span class="string">               </span>|<span class="string">               </span>|<span class="string">    </span>|</span><br><span class="line">------------              -----------               |<span class="string">               </span>|<span class="string">               </span>|<span class="string">    </span>|</span><br><span class="line">|<span class="string"> Javaçº¿ç¨‹ </span>|<span class="string"> &lt;----------&gt; </span>|<span class="string"> å·¥ä½œå†…å­˜ </span>|<span class="string">  &lt;----------&gt; </span>|<span class="string">      æ“ä½œ     </span>|<span class="string">  &lt;----------&gt; </span>|<span class="string"> å­˜ </span>|</span><br><span class="line">------------              -----------                ----------------               ------</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ‰€è®²çš„ ä¸»å†…å­˜ã€å·¥ä½œå†…å­˜ ä¸æœ¬ä¹¦ç¬¬2ç« æ‰€è®²çš„Javaå†…å­˜åŒºåŸŸä¸­çš„Javaå †ã€æ ˆã€æ–¹æ³•åŒºç­‰å¹¶ä¸æ˜¯åŒä¸€ä¸ªå±‚æ¬¡çš„å†…å­˜åˆ’åˆ†ï¼Œ<br>è¿™ä¸¤è€…åŸºæœ¬ä¸Šæ˜¯æ²¡æœ‰å…³ç³»çš„ï¼Œ<br>å¦‚æœä¸¤è€…ä¸€å®šè¦å‹‰å¼ºå¯¹åº”èµ·æ¥ï¼Œ<br>é‚£ä» å˜é‡ã€ä¸»å†…å­˜ã€å·¥ä½œå†…å­˜ çš„å®šä¹‰æ¥çœ‹ï¼Œ<br>ä¸»å†…å­˜ ä¸»è¦å¯¹åº”äº Javaå †ä¸­çš„å¯¹è±¡å®ä¾‹æ•°æ®éƒ¨åˆ†ï¼Œ<br>è€Œ å·¥ä½œå†…å­˜ åˆ™å¯¹åº”äº è™šæ‹Ÿæœºæ ˆä¸­çš„éƒ¨åˆ†åŒºåŸŸã€‚<br>ä»æ›´ä½å±‚æ¬¡ä¸Šè¯´ï¼Œ<br>ä¸»å†…å­˜ å°±ç›´æ¥å¯¹åº”äº ç‰©ç†ç¡¬ä»¶çš„å†…å­˜ ï¼Œè€Œä¸ºäº† è·å–æ›´å¥½çš„è¿è¡Œé€Ÿåº¦ï¼Œ<br>è™šæ‹Ÿæœºï¼ˆç”šè‡³æ˜¯ç¡¬ä»¶ç³»ç»Ÿæœ¬èº«çš„ä¼˜åŒ–æªæ–½ï¼‰å¯èƒ½ä¼šè®© å·¥ä½œå†…å­˜ ä¼˜å…ˆå­˜å‚¨äº å¯„å­˜å™¨å’Œé«˜é€Ÿç¼“å­˜ä¸­ï¼Œå› ä¸ºç¨‹åºè¿è¡Œæ—¶ ä¸»è¦è®¿é—®è¯»å†™çš„ æ˜¯å·¥ä½œå†…å­˜ã€‚</p><blockquote><p>é™¤äº† å®ä¾‹æ•°æ®ï¼ŒJavaå † è¿˜ä¿å­˜äº† å¯¹è±¡çš„å…¶ä»–ä¿¡æ¯<br>å¯¹äº HotSpotè™šæ‹Ÿæœº æ¥è®²ï¼Œ</p><ul><li>æœ‰ Mark Wordï¼ˆå­˜å‚¨å¯¹è±¡å“ˆå¸Œç ã€GCæ ‡å¿—ã€GCå¹´é¾„ã€åŒæ­¥é”ç­‰ä¿¡æ¯ï¼‰</li><li>Klass Point(æŒ‡å‘å­˜å‚¨ç±»å‹å…ƒæ•°æ®çš„æŒ‡é’ˆ)</li><li>åŠä¸€äº›ç”¨äºå­—èŠ‚å¯¹é½è¡¥ç™½çš„å¡«å……æ•°æ®ï¼ˆå¦‚æœå®ä¾‹æ•°æ®åˆšå¥½æ»¡è¶³8å­—èŠ‚å¯¹é½çš„è¯ï¼Œåˆ™å¯ä»¥ä¸å­˜åœ¨è¡¥ç™½ï¼‰</li></ul></blockquote><h5 id="å†…å­˜é—´äº¤äº’æ“ä½œ"><a href="#å†…å­˜é—´äº¤äº’æ“ä½œ" class="headerlink" title="å†…å­˜é—´äº¤äº’æ“ä½œ"></a>å†…å­˜é—´äº¤äº’æ“ä½œ</h5><p>å…³äº ä¸»å†…å­˜ ä¸ å·¥ä½œå†…å­˜ ä¹‹é—´çš„ å…·ä½“çš„ äº¤äº’åè®®ï¼Œ<br>å³ ä¸€ä¸ªå˜é‡ å¦‚ä½•ä» ä¸»å†…å­˜ æ‹·è´åˆ° å·¥ä½œå†…å­˜ã€ å¦‚ä½•ä» å·¥ä½œå†…å­˜ åŒæ­¥ å› ä¸»å†…å­˜ ä¹‹ç±»çš„ å®ç°ç»†èŠ‚ï¼Œ<br>Javaå†…å­˜æ¨¡å‹ å®šä¹‰äº†ä»¥ä¸‹ 8ç§æ“ä½œ æ¥å®Œæˆï¼Œ<br>è™šæ‹Ÿæœºå®ç°æ—¶ å¿…é¡»ä¿è¯ ä¸‹é¢æåŠçš„æ¯ä¸€ç§æ“ä½œ éƒ½æ˜¯ åŸå­çš„ã€ä¸å¯å†åˆ†çš„ï¼ˆå¯¹äº double å’Œ long ç±»å‹çš„å˜é‡æ¥è¯´ï¼Œloadã€storeã€read å’Œ write æ“ä½œåœ¨æŸäº›å¹³å°ä¸Šå…è®¸æœ‰ä¾‹å¤–ï¼Œè¿™ä¸ªé—®é¢˜åœ¨12.3.4èŠ‚å†è®²ï¼‰</p><blockquote><p>åŸºäºç†è§£éš¾åº¦å’Œä¸¥è°¨æ€§è€ƒè™‘ï¼Œæœ€æ–°çš„ JSR-133 æ–‡æ¡£ä¸­ï¼Œå·²ç»æ”¾å¼ƒé‡‡ç”¨è¿™8ç§æ“ä½œå» å®šä¹‰Javaå†…å­˜æ¨¡å‹çš„è®¿é—®åè®®ï¼ˆä»…æ˜¯ æè¿°æ–¹å¼ æ”¹å˜äº†ï¼ŒJavaå†…å­˜æ¨¡å‹ å¹¶æ²¡æœ‰æ”¹å˜ï¼‰ã€‚</p></blockquote><table>  <tr>    <th>operation</th>    <th>åç§°</th>    <th>ä½œç”¨å˜é‡</th>    <th>æè¿°</th>  </tr>  <tr>    <td>lock</td>    <td>(é”å®š)</td>    <td>ä½œç”¨äº ä¸»å†…å­˜ çš„ å˜é‡</td>    <td>å®ƒæŠŠ ä¸€ä¸ª å˜é‡ æ ‡è¯†ä¸º ä¸€æ¡çº¿ç¨‹ ç‹¬å  çš„ çŠ¶æ€ã€‚</td>  </tr>  <tr>    <td>unlock</td>    <td>(è§£é”)</td>    <td>ä½œç”¨äº ä¸»å†…å­˜ çš„ å˜é‡</td>    <td>å®ƒæŠŠ ä¸€ä¸ª å¤„äºé”å®šçŠ¶æ€ çš„å˜é‡ é‡Šæ”¾å‡ºæ¥ï¼Œé‡Šæ”¾åçš„å˜é‡ æ‰å¯ä»¥ è¢« å…¶ä»–çº¿ç¨‹ é”å®šã€‚</td>  </tr>  <tr>    <td>read</td>    <td>(è¯»å–)</td>    <td>ä½œç”¨äº ä¸»å†…å­˜ çš„ å˜é‡</td>    <td>å®ƒæŠŠ ä¸€ä¸ª å˜é‡çš„å€¼ ä» ä¸»å†…å­˜ ä¼ è¾“åˆ° çº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­ï¼Œä»¥ä¾¿éšåçš„ loadåŠ¨ä½œ ä½¿ç”¨ã€‚</td>  </tr>  <tr>    <td>load</td>    <td>(è½½å…¥)</td>    <td>ä½œç”¨äº å·¥ä½œå†…å­˜ çš„ å˜é‡</td>    <td>å®ƒæŠŠ readæ“ä½œ ä» ä¸»å†…å­˜ ä¸­å¾—åˆ°çš„ å˜é‡å€¼ æ”¾å…¥ å·¥ä½œå†…å­˜ çš„å˜é‡å‰¯æœ¬ ä¸­ã€‚</td>  </tr>   <tr>    <td>use</td>    <td>(ä½¿ç”¨)</td>    <td>ä½œç”¨äº å·¥ä½œå†…å­˜ çš„ å˜é‡</td>    <td>å®ƒæŠŠ å·¥ä½œå†…å­˜ä¸­ ä¸€ä¸ªå˜é‡çš„å€¼ ä¼ é€’ç»™ æ‰§è¡Œå¼•æ“ï¼Œæ¯å½“ è™šæ‹Ÿæœº é‡åˆ°ä¸€ä¸ª éœ€è¦ä½¿ç”¨åˆ°å˜é‡çš„å€¼ çš„å­—èŠ‚ç æŒ‡ä»¤æ—¶ å°†ä¼šæ‰§è¡Œè¿™ä¸ªæ“ä½œã€‚</td>  </tr>   <tr>    <td>assign</td>    <td>(èµ‹å€¼)</td>    <td>ä½œç”¨äº å·¥ä½œå†…å­˜ çš„ å˜é‡</td>    <td>å®ƒæŠŠ ä¸€ä¸ª ä»æ‰§è¡Œå¼•æ“ æ¥æ”¶åˆ°çš„å€¼ èµ‹ç»™ å·¥ä½œå†…å­˜çš„å˜é‡ï¼Œæ¯å½“ è™šæ‹Ÿæœº é‡åˆ° ä¸€ä¸ªç»™å˜é‡èµ‹å€¼çš„å­—èŠ‚ç æŒ‡ä»¤ æ—¶ æ‰§è¡Œè¿™ä¸ªæ“ä½œã€‚</td>  </tr>  <tr>    <td>store</td>    <td>(å­˜å‚¨)</td>    <td>ä½œç”¨äº å·¥ä½œå†…å­˜ çš„ å˜é‡</td>    <td>å®ƒæŠŠ å·¥ä½œå†…å­˜ ä¸­ ä¸€ä¸ªå˜é‡çš„å€¼ ä¼ é€åˆ° ä¸»å†…å­˜ ä¸­ï¼Œä»¥ä¾¿ éšåçš„writeæ“ä½œ ä½¿ç”¨ã€‚</td>  </tr>    <tr>    <td>write</td>    <td>(å†™å…¥)</td>    <td>ä½œç”¨äº ä¸»å†…å­˜ çš„ å˜é‡</td>    <td>å®ƒæŠŠ storeæ“ä½œ ä» å·¥ä½œå†…å­˜ ä¸­å¾—åˆ°çš„ å˜é‡çš„å€¼ æ”¾å…¥ ä¸»å†…å­˜ çš„ å˜é‡ ä¸­ã€‚</td>  </tr></table><p>å¦‚æœè¦æŠŠ ä¸€ä¸ªå˜é‡ ä» ä¸»å†…å­˜ å¤åˆ¶åˆ° å·¥ä½œå†…å­˜ï¼Œé‚£å°±è¦ é¡ºåºåœ° æ‰§è¡Œ readå’Œload æ“ä½œï¼›<br>å¦‚æœè¦æŠŠ å˜é‡ ä» å·¥ä½œå†…å­˜ åŒæ­¥å› ä¸»å†…å­˜ï¼Œå°±è¦ é¡ºåºåœ° æ‰§è¡Œ storeå’Œwrite æ“ä½œã€‚</p><p>æ³¨æ„ï¼Œ Javaå†…å­˜æ¨¡å‹ åªè¦æ±‚ä¸Šè¿° ä¸¤ä¸ªæ“ä½œ å¿…é¡»æŒ‰é¡ºåºæ‰§è¡Œï¼Œè€Œæ²¡æœ‰ä¿è¯æ˜¯ è¿ç»­æ‰§è¡Œã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œreadå’Œloadä¹‹é—´ï¼Œstoreå’Œwriteä¹‹é—´ æ˜¯å¯æ’å…¥å…¶ä»–æŒ‡ä»¤çš„ï¼Œ<br>å¦‚å¯¹ä¸»å†…å­˜ä¸­çš„å˜é‡ aã€bè¿›è¡Œè®¿é—®æ—¶ï¼Œä¸€ç§å¯èƒ½å‡ºç°é¡ºåºæ˜¯ read aã€read bã€load bã€ load aã€‚<br>é™¤æ­¤ä¹‹å¤–ï¼ŒJavaå†…å­˜æ¨¡å‹ è¿˜è§„å®šäº† åœ¨æ‰§è¡Œä¸Šè¿°8ä¸­åŸºæœ¬æ“ä½œæ—¶ å¿…é¡»æ»¡è¶³å¦‚ä¸‹è§„åˆ™ï¼š</p><ul><li>ä¸å…è®¸ readå’Œloadã€storeå’Œwrite æ“ä½œä¹‹ä¸€ å•ç‹¬å‡ºç°ï¼›<ul><li>å³ ä¸å…è®¸ ä¸€ä¸ªå˜é‡ ä»ä¸»å†…å­˜è¯»å–äº† ä½†å·¥ä½œå†…å­˜ä¸æ¥å—ï¼›</li><li>æˆ–è€…ä»å·¥ä½œå†…å­˜å‘èµ·å›å†™äº† ä½†ä¸»å†…å­˜ä¸æ¥å—çš„æƒ…å†µå‡ºç°ã€‚</li></ul></li><li>ä¸å…è®¸ ä¸€ä¸ªçº¿ç¨‹ ä¸¢å¼ƒ å®ƒçš„ æœ€è¿‘çš„ assignæ“ä½œï¼›<ul><li>å³ å˜é‡ åœ¨ å·¥ä½œå†…å­˜ ä¸­ æ”¹å˜äº† ä¹‹å å¿…é¡»æŠŠ è¯¥å˜åŒ– åŒæ­¥å› ä¸»å†…å­˜ã€‚</li></ul></li><li>ä¸å…è®¸ ä¸€ä¸ªçº¿ç¨‹ æ— åŸå› åœ°ï¼ˆæ²¡æœ‰å‘ç”Ÿè¿‡ä»»ä½•assignæ“ä½œï¼‰æŠŠ æ•°æ® ä» çº¿ç¨‹çš„å·¥ä½œå†…å­˜ åŒæ­¥å› ä¸»å†…å­˜ã€‚</li><li>ä¸€ä¸ª æ–°çš„å˜é‡ åªèƒ½åœ¨ ä¸»å†…å­˜ ä¸­â€œè¯ç”Ÿâ€ï¼Œ ä¸å…è®¸ åœ¨å·¥ä½œå†…å­˜ä¸­ ç›´æ¥ä½¿ç”¨ ä¸€ä¸ªæœªè¢«åˆå§‹åŒ–ï¼ˆloadæˆ–assignï¼‰çš„å˜é‡ï¼›<ul><li>æ¢å¥è¯è¯´ï¼Œå°±æ˜¯å¯¹ ä¸€ä¸ªå˜é‡ å®æ–½ useã€storeæ“ä½œä¹‹å‰ï¼Œå¿…é¡»å…ˆæ‰§è¡Œè¿‡äº† assignæˆ–load æ“ä½œï¼›</li></ul></li><li>ä¸€ä¸ªå˜é‡ åœ¨ åŒä¸€æ—¶åˆ» åªå…è®¸ ä¸€æ¡çº¿ç¨‹ å¯¹å…¶è¿›è¡Œ lockæ“ä½œï¼Œä½† lockæ“ä½œ å¯ä»¥è¢« åŒä¸€æ¡çº¿ç¨‹ æ‰§è¡Œå¤šæ¬¡ï¼Œå¤šæ¬¡æ‰§è¡Œlockåï¼Œåªæœ‰æ‰§è¡Œç›¸åŒæ¬¡æ•°çš„ unlockæ“ä½œï¼Œå˜é‡æ‰ä¼šè¢«è§£é”ï¼›</li><li>å¦‚æœå¯¹ ä¸€ä¸ªå˜é‡ æ‰§è¡Œ lockæ“ä½œï¼Œé‚£å°†ä¼š æ¸…ç©ºå·¥ä½œå†…å­˜ ä¸­ æ­¤å˜é‡çš„å€¼ï¼Œåœ¨ æ‰§è¡Œå¼•æ“ ä½¿ç”¨è¿™ä¸ªå˜é‡å‰ï¼Œéœ€è¦é‡æ–°æ‰§è¡Œ loadæˆ–assignæ“ä½œ åˆå§‹åŒ–å˜é‡çš„å€¼ã€‚</li><li>å¦‚æœ ä¸€ä¸ªå˜é‡ äº‹å…ˆæ²¡æœ‰è¢« lockæ“ä½œ é”å®šï¼Œé‚£å°±ä¸å…è®¸ å¯¹å®ƒæ‰§è¡Œ unlockæ“ä½œï¼Œä¹Ÿä¸å…è®¸å» unlock ä¸€ä¸ªè¢«å…¶ä»–çº¿ç¨‹é”å®šä½çš„ å˜é‡ã€‚</li><li>å¯¹ ä¸€ä¸ªå˜é‡ æ‰§è¡Œ unlockæ“ä½œ ä¹‹å‰ï¼Œå¿…é¡»å…ˆæŠŠ æ­¤å˜é‡ åŒæ­¥å› ä¸»å†…å­˜ ä¸­ï¼ˆæ‰§è¡Œ storeã€writeæ“ä½œï¼‰ï¼›</li></ul><p>è¿™ 8ç§å†…å­˜è®¿é—®æ“ä½œ ä»¥åŠ ä¸Šè¿°è§„åˆ™é™å®šï¼Œå†åŠ ä¸Šç¨åä»‹ç»çš„å¯¹ volatile çš„ä¸€äº›ç‰¹æ®Šè§„å®šï¼Œå°±å·²ç»å®Œå…¨ç¡®å®šäº† javaç¨‹åºä¸­ å“ªäº›å†…å­˜è®¿é—®æ“ä½œ åœ¨å¹¶å‘ä¸‹ æ˜¯å®‰å…¨çš„ã€‚</p><p>ç”±äºè¿™ç§å®šä¹‰ ç›¸å½“ä¸¥è°¨ ä½†åˆååˆ† çƒ¦çï¼ˆæˆ‘è§‰å¾—å‘¨å¤§å¤§è¿™é‡Œå¯èƒ½æ˜¯æƒ³æ‰“ç¹çï¼Ÿï¼‰ï¼Œå®è·µèµ·æ¥å¾ˆéº»çƒ¦ï¼Œ<br>æ‰€ä»¥ åœ¨12.3.6èŠ‚ä¸­ç¬”è€…å°†ä»‹ç»è¿™ç§å®šä¹‰çš„ ä¸€ä¸ªç­‰æ•ˆåˆ¤æ–­åŸåˆ™ â€”â€“ å…ˆè¡Œå‘ç”ŸåŸåˆ™ï¼Œç”¨æ¥ç¡®å®š ä¸€ä¸ªè®¿é—® åœ¨å¹¶å‘ç¯å¢ƒä¸‹ æ˜¯å¦ å®‰å…¨ã€‚</p><h5 id="å¯¹äº-volatile-å‹å˜é‡çš„-ç‰¹æ®Šè§„åˆ™"><a href="#å¯¹äº-volatile-å‹å˜é‡çš„-ç‰¹æ®Šè§„åˆ™" class="headerlink" title="å¯¹äº volatile å‹å˜é‡çš„ ç‰¹æ®Šè§„åˆ™"></a>å¯¹äº volatile å‹å˜é‡çš„ ç‰¹æ®Šè§„åˆ™</h5><p>å…³é”®å­— volatile å¯ä»¥è¯´æ˜¯ Javaè™šæ‹Ÿæœº æä¾›çš„ æœ€è½»é‡çº§ çš„ åŒæ­¥æœºåˆ¶ï¼Œ<br>ä½†æ˜¯å®ƒ å¹¶ä¸å®¹æ˜“ å®Œå…¨è¢«æ­£ç¡®ã€ å®Œæ•´åœ°ç†è§£ï¼Œä»¥è‡³äºè®¸å¤šç¨‹åºå‘˜éƒ½ä¹ æƒ¯ä¸å»ä½¿ç”¨å®ƒï¼Œ<br>é‡åˆ°éœ€è¦å¤„ç† å¤šçº¿ç¨‹æ•°æ® ç«äº‰é—®é¢˜ çš„æ—¶å€™ ä¸€å¾‹ä½¿ç”¨ synchronized æ¥è¿›è¡Œ åŒæ­¥ã€‚<br>ï¼ˆç„¶è€Œæˆ‘ä¹Ÿä¸æ˜¯ä¹ æƒ¯ä¸ä¹ æƒ¯çš„é—®é¢˜ï¼Œæ˜¯æˆ‘æ ¹æœ¬ä¸ä¼šç”¨synchronizedï¼Œä¸æ‡‚å¤šçº¿ç¨‹å¹¶å‘è¿™ä¸€å—ï¼Œæ ¹æœ¬æ²¡å…¥é—¨çš„é—®é¢˜ï¼‰</p><p>äº†è§£ volatileå˜é‡çš„è¯­ä¹‰ å¯¹åé¢äº†è§£ å¤šçº¿ç¨‹æ“ä½œçš„å…¶ä»–ç‰¹æ€§ å¾ˆæœ‰æ„ä¹‰ï¼Œ<br>åœ¨æœ¬èŠ‚ä¸­ æˆ‘ä»¬å°† å¤šèŠ±è´¹ä¸€äº›æ—¶é—´å»å¼„æ¸…æ¥š volatileçš„è¯­ä¹‰ åˆ°åº•æ˜¯ä»€ä¹ˆã€‚</p><p>Javaå†…å­˜æ¨¡å‹ å¯¹ volatile ä¸“é—¨å®šä¹‰äº† ä¸€äº› ç‰¹æ®Šçš„è®¿é—®è§„åˆ™ï¼Œ<br>åœ¨ä»‹ç» è¿™äº›æ¯”è¾ƒ æ‹—å£çš„è§„åˆ™å®šä¹‰ ä¹‹å‰ï¼Œç¬”è€…å…ˆç”¨ ä¸é‚£ä¹ˆæ­£å¼ ä½† é€šä¿—æ˜“æ‡‚çš„ è¯­è¨€ æ¥ä»‹ç»ä¸€ä¸‹ è¿™ä¸ªå…³é”®å­—çš„ä½œç”¨ã€‚<br>ï¼ˆå¥½äººä¸€ç”Ÿå¹³å®‰<del>~</del> è™½ç„¶æˆ‘ä¹Ÿä¸ä¸€å®šèƒ½çœ‹æ‡‚ä½ é€šä¿—æ˜“æ‡‚çš„è¯­è¨€ï¼‰</p><p>å½“ ä¸€ä¸ªå˜é‡ å®šä¹‰ä¸º volatile ä¹‹åï¼Œå®ƒ å°†å…·å¤‡ ä¸¤ç§ç‰¹æ€§ï¼Œ<br>ç¬¬ä¸€ æ˜¯ä¿è¯ æ­¤å˜é‡ å¯¹ æ‰€æœ‰çº¿ç¨‹ çš„ å¯è§æ€§ï¼Œ<br>è¿™é‡Œçš„ â€œå¯è§æ€§â€ æ˜¯æŒ‡å½“ ä¸€æ¡çº¿ç¨‹ ä¿®æ”¹äº† è¿™ä¸ª å˜é‡çš„å€¼ï¼Œæ–°å€¼ å¯¹äº å…¶ä»–çº¿ç¨‹ æ¥è¯´ æ˜¯å¯ä»¥ç«‹å³å¾—çŸ¥çš„ã€‚<br>è€Œ æ™®é€šå˜é‡ ä¸èƒ½åšåˆ°è¿™ä¸€ç‚¹ï¼Œ æ™®é€šå˜é‡ çš„ å€¼ åœ¨çº¿ç¨‹é—´ ä¼ é€’ å‡éœ€è¦é€šè¿‡ ä¸»å†…å­˜ æ¥å®Œæˆï¼Œ<br>ä¾‹å¦‚ï¼Œçº¿ç¨‹A ä¿®æ”¹ ä¸€ä¸ªæ™®é€šå˜é‡çš„å€¼ï¼Œç„¶å å‘ ä¸»å†…å­˜ è¿›è¡Œ å›å†™ï¼Œå¦å¤–ä¸€æ¡çº¿ç¨‹B åœ¨çº¿ç¨‹A å›å†™å®Œæˆ äº†ä¹‹å å†ä» ä¸»å†…å­˜ è¿›è¡Œ è¯»å– æ“ä½œï¼Œæ–°å˜é‡å€¼ æ‰ä¼šå¯¹çº¿ç¨‹Bå¯è§ã€‚</p><p>ï¼ˆè¯¶è¯¶è¯¶ï¼Œè¿™ä¸ªæˆ‘çœ‹æ‡‚äº†ï¼Œå¯èƒ½åŸå› åœ¨äºæˆ‘çœ‹äº†è§†é¢‘çš„åŸå› ï¼Œæˆ‘æ€ä¹ˆå¯ä»¥è¿™ä¹ˆè ¢ã€‚ã€‚ã€‚ã€‚ï¼‰</p><p>å…³äº volatileå˜é‡çš„å¯è§æ€§ï¼Œç»å¸¸ä¼šè¢«å¼€å‘äººå‘˜è¯¯ä¼šï¼Œè®¤ä¸ºä»¥ä¸‹æè¿°æˆç«‹ï¼šâ€œvolatileå˜é‡ å¯¹æ‰€æœ‰çº¿ç¨‹ æ˜¯ ç«‹å³å¯è§ çš„ï¼Œå¯¹ volatileå˜é‡ æ‰€æœ‰çš„ å†™æ“ä½œ éƒ½èƒ½ ç«‹åˆ»ååº” åˆ° å…¶ä»–çº¿ç¨‹ä¹‹ä¸­ï¼Œæ¢å¥è¯è¯´ï¼Œ volatileå˜é‡ åœ¨ å„ä¸ªçº¿ç¨‹ä¸­ æ˜¯ ä¸€è‡´çš„ï¼Œæ‰€ä»¥åŸºäº volatileå˜é‡ çš„ è¿ç®— åœ¨å¹¶å‘ä¸‹ æ˜¯å®‰å…¨çš„â€ã€‚  </p><p>è¿™å¥è¯çš„è®ºæ®éƒ¨åˆ† å¹¶æ²¡æœ‰é”™ï¼Œ ä½†æ˜¯å…¶è®ºæ® å¹¶ä¸èƒ½å¾—å‡º â€œåŸºäº volatileå˜é‡ çš„ è¿ç®— åœ¨å¹¶å‘ä¸‹ æ˜¯å®‰å…¨çš„â€è¿™ä¸ªç»“è®ºã€‚  </p><p>ï¼ˆemmï¼Œæˆ‘è§‰å¾—è®ºæ®éƒ¨åˆ†ä¹Ÿæœ‰ç‚¹æ¯›ç—…ï¼Œ<br>ä¸ªäººè§‚ç‚¹ï¼šâ€volatileå˜é‡ å¯¹æ‰€æœ‰çº¿ç¨‹ æ˜¯ ç«‹å³å¯è§çš„â€ï¼Œ ç«‹å³å¯è§å—ï¼Ÿ<br>ä¸æ˜¯ä¹‹å‰è¯´ æ™®é€šå˜é‡çš„å€¼åœ¨çº¿ç¨‹é—´ä¼ é€’å‡éœ€è¦é€šè¿‡ä¸»å†…å­˜æ¥å®Œæˆå—ï¼Œ<br>é‚£æ—¢ç„¶æ˜¯è¦é€šè¿‡ä¸»å†…å­˜æ¥å®Œæˆçš„è¯ï¼Œé‚£æ˜¯ä¸æ˜¯å°±éœ€è¦æ‰§è¡Œé‚£8ä¸ªæ“ä½œå…¶ä¸­çš„readè¯»å–æ“ä½œä»¥åŠloadã€useæ“ä½œç­‰ï¼›<br>ç„¶åè®ºæ®éƒ¨åˆ†å½“ä¸­çš„ â€œå¯¹volatileå˜é‡ æ‰€æœ‰çš„ å†™æ“ä½œ éƒ½èƒ½ ç«‹åˆ»ååº” åˆ°å…¶ä»–çº¿ç¨‹ä¹‹ä¸­â€ ç»†å“ä¸€ä¸‹å“¦ï¼Œèƒ½ç«‹åˆ»ååº”ï¼Ÿ<br>ä¸æ˜¯8ä¸ªæ“ä½œå½“ä¸­å·¥ä½œå†…å­˜çš„èµ‹å€¼æ“ä½œassignè¿™ç§çš„æ“ä½œä¸€æ—¦æœ‰äº†è¿˜éœ€è¦åŒæ­¥å›ä¸»å†…å­˜çš„å—ï¼Ÿ<br>ä¹Ÿå°±æ˜¯æ‰§è¡Œstoreä»¥åŠwriteæ“ä½œï¼Œä»¥åŠç«‹åˆ»åæ˜ åˆ°å…¶ä»–çº¿ç¨‹ä¹‹ä¸­éš¾é“ä¸è¦ å…¶ä»–çº¿ç¨‹åˆè¦å»æ¸…ç©ºå…¶å·¥ä½œå†…å­˜å½“ä¸­çš„è¯¥å˜é‡ç„¶åé‡æ–°è¿›è¡Œreadã€loadâ€¦.æ“ä½œä¹‹ç±»çš„ï¼Ÿ<br>è¿˜æ˜¯è¯´emmï¼Œ<br>å·¥ä½œå†…å­˜ä¸ä¸»å†…å­˜ä¹‹é—´çš„è¿™ä¸ªäº¤äº’éå¸¸å¿«ï¼Ÿå¿«åˆ°é‚£å‡ ä¸ªæ“ä½œæ‰€éœ€èŠ±è´¹æ—¶é—´å¯ä»¥å¿½ç•¥ä¸è®¡æ‰€ä»¥è¯´ ç«‹å³å¯è§ã€ç«‹å³ååº”ï¼Ÿ<br>å®³ï¼Œä¸»è¦æ˜¯è‡ªå·±ä¹Ÿä¸æ‡‚ï¼Œçœ‹äº†ä¹¦å’Œè§†é¢‘ä¹‹åå§æœ‰é—®é¢˜ä¹Ÿæ²¡æœ‰äººå¯ä»¥è§£ç­”ä¸‹â€¦.ã€’â–½ã€’ï¼‰</p><p>volatileå˜é‡ åœ¨ å„ä¸ªçº¿ç¨‹çš„ å·¥ä½œå†…å­˜ ä¸­ä¸å­˜åœ¨ä¸€è‡´æ€§é—®é¢˜<br>ï¼ˆåœ¨ å„ä¸ªçº¿ç¨‹çš„ å·¥ä½œå†…å­˜ä¸­ï¼Œvolatileå˜é‡ ä¹Ÿå¯ä»¥å­˜åœ¨ ä¸ä¸€è‡´çš„ æƒ…å†µï¼Œä½†ç”±äº æ¯æ¬¡ä½¿ç”¨ä¹‹å‰ éƒ½è¦å…ˆåˆ·æ–°ï¼Œæ‰§è¡Œå¼•æ“ çœ‹ä¸åˆ° ä¸ä¸€è‡´çš„æƒ…å†µï¼Œå› æ­¤å¯ä»¥è®¤ä¸º ä¸å­˜åœ¨ä¸€è‡´æ€§é—®é¢˜ï¼‰ï¼Œ<br>ä½†æ˜¯Javaé‡Œé¢çš„è¿ç®— å¹¶é åŸå­æ“ä½œï¼Œå¯¼è‡´ volatileå˜é‡ çš„è¿ç®— åœ¨ å¹¶å‘ä¸‹ä¸€æ ·æ˜¯ä¸å®‰å…¨çš„ï¼Œ</p><p>æˆ‘ä»¬å¯ä»¥ é€šè¿‡ä¸€æ®µç®€å•çš„æ¼”ç¤ºæ¥è¯´æ˜åŸå› ï¼Œè¯·çœ‹ä»£ç æ¸…å•12-1 ä¸­æ¼”ç¤ºçš„ä¾‹å­ã€‚</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">                                ä»£ç æ¸…å• <span class="number">12</span><span class="number">-1</span> <span class="keyword">volatile</span> çš„è¿ç®—</span><br><span class="line">----------------------------------------------------------------------------------------------</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * volatile å˜é‡è‡ªå¢è¿ç®—æµ‹è¯•</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * @author zzm</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VolatileTest</span> &#123;</span></span><br><span class="line">      <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">volatile</span> <span class="keyword">int</span> race = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">increase</span><span class="params">()</span></span>&#123;</span><br><span class="line">        race++;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> THREADS_COUNT = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(<span class="keyword">String</span>[] args)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        Thread[] threads = <span class="keyword">new</span> Thread[THREADS_COUNT];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; THREADS_COUNT; i++)&#123;</span><br><span class="line">          threads[i] = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable()&#123;</span><br><span class="line">            @Override</span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="built_in">run</span>()&#123;</span><br><span class="line">              <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++)&#123;</span><br><span class="line">                increase();</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">          threads[i].start();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç­‰å¾…æ‰€æœ‰ç´¯åŠ çº¿ç¨‹éƒ½ç»“æŸ</span></span><br><span class="line">        <span class="keyword">while</span>(Thread.activeCount() &gt; <span class="number">1</span>)</span><br><span class="line">            Thread.<span class="built_in">yield</span>();</span><br><span class="line"></span><br><span class="line">        System.out.<span class="built_in">println</span>(race);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">----------------------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç  å‘èµ·äº†20ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹ å¯¹ raceå˜é‡ è¿›è¡Œ10000æ¬¡è‡ªå¢æ“ä½œï¼Œå¦‚æœè¿™æ®µä»£ç èƒ½å¤Ÿ æ­£ç¡®å¹¶å‘ çš„è¯ï¼Œæœ€åè¾“å‡ºçš„ç»“æœåº”è¯¥æ˜¯200000ã€‚</p><p>è¯»è€…è¿è¡Œå®Œè¿™æ®µä»£ç ä¹‹åï¼Œå¹¶ä¸ä¼šè·å¾—æœŸæœ›çš„ç»“æœï¼Œè€Œä¸”ä¼šå‘ç° æ¯æ¬¡è¿è¡Œç¨‹åºï¼Œè¾“å‡ºçš„ç»“æœéƒ½ä¸ä¸€æ ·ï¼Œéƒ½æ˜¯ä¸€ä¸ªå°äº 200000çš„æ•°å­—ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>é—®é¢˜å°±å‡ºç°åœ¨ è‡ªå¢è¿ç®— â€œrace++â€ä¹‹ä¸­ï¼Œ<br>æˆ‘ä»¬ç”¨ Javap åç¼–è¯‘ è¿™æ®µä»£ç ä¹‹åï¼Œä¼šå¾—åˆ°ä»£ç æ¸…å•12-2ï¼Œ<br>å‘ç°åªæœ‰ä¸€è¡Œä»£ç çš„ increase() æ–¹æ³•åœ¨ Classæ–‡ä»¶ ä¸­æ˜¯ç”± 4æ¡å­—èŠ‚ç æŒ‡ä»¤æ„æˆçš„ï¼ˆreturn æŒ‡ä»¤ä¸æ˜¯ç”± race++ äº§ç”Ÿçš„ï¼Œè¿™æ¡æŒ‡ä»¤å¯ä»¥ä¸è®¡ç®—ï¼‰ï¼Œ<br>ä» å­—èŠ‚ç å±‚é¢ä¸Š å¾ˆå®¹æ˜“å°±åˆ†æå‡º å¹¶å‘å¤±è´¥ çš„åŸå› äº†ï¼š<br>å½“ getstaticæŒ‡ä»¤ æŠŠ race çš„å€¼ å–åˆ° æ“ä½œæ ˆé¡¶æ—¶ï¼Œvolatileå…³é”®å­— ä¿è¯äº† raceçš„å€¼ åœ¨æ­¤æ—¶æ˜¯æ­£ç¡®çš„çš„ï¼Œ<br>ä½†æ˜¯åœ¨æ‰§è¡Œ iconst_1ã€iaddè¿™äº›æŒ‡ä»¤çš„æ—¶å€™ï¼Œ<br>å…¶ä»–çº¿ç¨‹ å¯èƒ½å·²ç»æŠŠ raceçš„å€¼ åŠ å¤§äº†ï¼Œ<br>è€Œåœ¨ æ“ä½œæ ˆé¡¶ çš„å€¼ å°±å˜æˆäº† è¿‡æœŸçš„æ•°æ®ï¼Œ<br>æ‰€ä»¥ putstatic æŒ‡ä»¤æ‰§è¡Œåå°±å¯èƒ½æŠŠ è¾ƒå°çš„ raceå€¼ åŒæ­¥å› ä¸»å†…å­˜ä¹‹ä¸­ã€‚</p><p>ï¼ˆæ­å–œæˆ‘ï¼Œç«Ÿç„¶åˆçœ‹æ‡‚äº†è¿™ä¸€æ®µé€šä¿—æ˜“æ‡‚çš„è¯ï¼ŒåŸå› å¯èƒ½åœ¨äºæˆ‘çœ‹äº†è§†é¢‘çš„ç¼˜æ•…ã€‚ã€‚ã€‚ï¼‰  </p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">                                ä»£ç æ¸…å• <span class="number">12</span><span class="number">-2</span> VolatileTest çš„å­—èŠ‚ç </span><br><span class="line">----------------------------------------------------------------------------------------------</span><br><span class="line"><span class="keyword">public</span> static <span class="built_in">void</span> increase();</span><br><span class="line">  Code:</span><br><span class="line">    Stack=<span class="number">2</span>, Locals=<span class="number">0</span>, Args_size=<span class="number">0</span></span><br><span class="line">    <span class="number">0</span>ï¼š   getstatic      #<span class="number">13</span>; <span class="comment">//Field race:I</span></span><br><span class="line">    <span class="number">3</span>ï¼š   iconst_1</span><br><span class="line">    <span class="number">4</span>ï¼š   iadd</span><br><span class="line">    <span class="number">5</span>ï¼š   putstatic      #<span class="number">13</span>; <span class="comment">//Field race:I</span></span><br><span class="line">    <span class="number">8</span>ï¼š   <span class="keyword">return</span></span><br><span class="line">  LineNumberTable:</span><br><span class="line">    Line <span class="number">14</span>: <span class="number">0</span></span><br><span class="line">    Line <span class="number">15</span>: <span class="number">8</span></span><br><span class="line">----------------------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure><p>å®¢è§‚åœ°è¯´ï¼Œç¬”è€…åœ¨æ­¤ä½¿ç”¨ å­—èŠ‚ç  æ¥åˆ†æ å¹¶å‘é—®é¢˜ï¼Œä»ç„¶æ˜¯ ä¸ä¸¥è°¨çš„ï¼Œ<br>å› ä¸ºå³ä½¿ ç¼–è¯‘å‡ºæ¥ åªæœ‰ä¸€æ¡å­—èŠ‚ç æŒ‡ä»¤ï¼Œ ä¹Ÿä¸æ„å‘³ç€ æ‰§è¡Œè¿™æ¡æŒ‡ä»¤å°±æ˜¯ ä¸€ä¸ªåŸå­æ“ä½œã€‚  </p><p>ä¸€æ¡å­—èŠ‚ç æŒ‡ä»¤ åœ¨ è§£é‡Šæ‰§è¡Œ æ—¶ï¼Œè§£é‡Šå™¨å°†è¦è¿è¡Œè®¸å¤šä»£ç æ‰èƒ½å®ç° å®ƒçš„è¯­ä¹‰ï¼Œ<br>å¦‚æœæ˜¯ ç¼–è¯‘æ‰§è¡Œï¼Œä¸€æ¡å­—èŠ‚ç æŒ‡ä»¤ ä¹Ÿå¯èƒ½ è½¬åŒ–æˆè‹¥å¹²æ¡ æœ¬åœ°æœºå™¨ç æŒ‡ä»¤ï¼Œ<br>æ­¤å¤„ä½¿ç”¨ -XX:+PrintAssembly å‚æ•°è¾“å‡º åæ±‡ç¼– æ¥åˆ†æä¼š æ›´ä¸¥è°¨ ä¸€äº›ï¼Œ<br>ä½†è€ƒè™‘åˆ°è¯»è€…é˜…è¯»çš„æ–¹ä¾¿ï¼Œå¹¶ä¸”å­—èŠ‚ç å·²ç»èƒ½è¯´æ˜é—®é¢˜ï¼Œæ‰€ä»¥æ­¤å¤„ä½¿ç”¨å­—èŠ‚ç åˆ†æã€‚</p><p>ï¼ˆæˆ‘è§‰å¾—è¿™ä¸ªè€ƒè™‘åˆ°è¯»è€…æ–¹ä¾¿ï¼Œå¯èƒ½æ˜¯è€ƒè™‘åˆ°äº†åƒæˆ‘è¿™ç§å°ç™½åˆ°æ—¶å€™çœ‹ä¸æ‡‚ï¼Œå°±è§£é‡Šçš„ä¹Ÿå°±è¶Šè®²è¶Šå¤šè¶Šè®²è¶Šå¤šã€‚ã€‚ã€‚ã€‚ çœŸæ˜¯å¤ªè´´å¿ƒäº†ï¼Œè´´å¿ƒçš„æš–å®å®ï¼‰</p><p>ç”±äº volatileå˜é‡ åªèƒ½ä¿è¯ å¯è§æ€§ï¼Œ<br>åœ¨ä¸ç¬¦åˆ ä»¥ä¸‹ä¸¤æ¡è§„åˆ™çš„è¿ç®—åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬ä»ç„¶è¦é€šè¿‡ åŠ é”ï¼ˆä½¿ç”¨ synchronizedæˆ–java.util.concurrentä¸­çš„åŸå­ç±»ï¼‰æ¥ä¿è¯åŸå­æ€§ã€‚</p><ul><li>è¿ç®—ç»“æœ å¹¶ä¸ä¾èµ– å˜é‡ çš„å½“å‰å€¼ï¼Œæˆ–è€… èƒ½å¤Ÿç¡®ä¿ åªæœ‰å•ä¸€çš„çº¿ç¨‹ä¿®æ”¹ å˜é‡çš„å€¼ã€‚</li><li>å˜é‡ ä¸éœ€è¦ ä¸ å…¶ä»–çš„çŠ¶æ€å˜é‡ å…±åŒå‚ä¸ ä¸å˜çº¦æŸã€‚</li></ul><p>è€Œåœ¨åƒ å¦‚ä¸‹çš„ä»£ç æ¸…ä»£12-3æ‰€ç¤ºçš„ è¿™ç±»åœºæ™¯å°±å¾ˆé€‚åˆä½¿ç”¨ volatileå˜é‡ æ¥æ§åˆ¶å¹¶å‘ï¼Œå½“ shutdown() æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œèƒ½ä¿è¯ æ‰€æœ‰çº¿ç¨‹ ä¸­æ‰§è¡Œçš„ doWork() æ–¹æ³•éƒ½ç«‹å³åœä¸‹æ¥ã€‚</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">                                ä»£ç æ¸…å• 12-3 volatile çš„ä½¿ç”¨åœºæ™¯</span></span><br><span class="line">----------------------------------------------------------------------------------------------</span><br><span class="line">volatile boolean shutdownRequested;</span><br><span class="line"></span><br><span class="line">public void shutdown()&#123;</span><br><span class="line"><span class="code">      shutdownRequested = true;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public void doWork()&#123;</span><br><span class="line"><span class="code">      while(!shutdownRequested)&#123;</span></span><br><span class="line"><span class="code">        // do stuff</span></span><br><span class="line"><span class="code">      &#125;</span></span><br><span class="line">&#125;</span><br><span class="line">----------------------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ volatileå˜é‡ çš„ç¬¬äºŒä¸ªè¯­ä¹‰ æ˜¯ ç¦æ­¢æŒ‡ä»¤é‡æ’åºä¼˜åŒ–ï¼Œ<br>æ™®é€šçš„å˜é‡ ä»…ä»… ä¼šä¿è¯ åœ¨è¯¥æ–¹æ³•çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ æ‰€æœ‰ä¾èµ– èµ‹å€¼ç»“æœ çš„åœ°æ–¹ éƒ½èƒ½è·å–åˆ° æ­£ç¡®çš„ç»“æœï¼Œ<br>è€Œä¸èƒ½ ä¿è¯ å˜é‡èµ‹å€¼ æ“ä½œçš„é¡ºåº ä¸ ç¨‹åºä»£ç ä¸­çš„æ‰§è¡Œé¡ºåº ä¸€è‡´ã€‚  </p><p>å› ä¸º åœ¨ä¸€ä¸ªçº¿ç¨‹çš„æ–¹æ³• æ‰§è¡Œè¿‡ç¨‹ä¸­ æ— æ³•æ„ŸçŸ¥åˆ°è¿™ç‚¹ï¼Œ<br>è¿™ä¹Ÿå°±æ˜¯ Javaå†…å­˜æ¨¡å‹ ä¸­æè¿°çš„æ‰€è°“çš„ â€œçº¿ç¨‹å†… è¡¨ç°ä¸º ä¸²è¡Œ çš„è¯­ä¹‰â€ï¼ˆWithin-Tread As-If-Serial Semanticsï¼‰ã€‚</p><p>ä¸Šé¢çš„æè¿°ä»ç„¶ä¸å¤ªå®¹æ˜“ç†è§£ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç»§ç»­é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥çœ‹çœ‹ä¸ºä½• æŒ‡ä»¤é‡æ’åº ä¼š å¹²æ‰° ç¨‹åºçš„å¹¶å‘æ‰§è¡Œï¼Œ<br>æ¼”ç¤ºç¨‹åºå¦‚ä»£ç æ¸…å•12-4æ‰€ç¤ºã€‚<br>ï¼ˆå‘¨å¤§å¤§çœŸæ˜¯è¯´åˆ°æˆ‘çš„å¿ƒåé‡Œå»äº†ï¼ŒçœŸæ˜¯å¤ªä¸ºæˆ‘è¿™ç§äººè€ƒè™‘äº†ï¼Œå²‚æ­¢æ˜¯ä¸å¤ªå®¹æ˜“ç†è§£ï¼ï¼ç®€ç›´ï¼Œæˆ‘éƒ½ä¸å¥½æ„æ€è¯´è‡ªå·±æ˜¯ä¸­å›½äººäº†ã€‚å®³ï¼›â•®(â•¯â–½â•°)â•­ï¼‰</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">                                ä»£ç æ¸…å• 12-4 æŒ‡ä»¤é‡æ’åº</span></span><br><span class="line">----------------------------------------------------------------------------------------------</span><br><span class="line">Map configOptions;</span><br><span class="line"></span><br><span class="line">char[] configText;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­¤ å˜é‡ å¿…é¡»å®šä¹‰ä¸º volatile</span></span><br><span class="line">volatile boolean initialized = false;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡è®¾ä»¥ä¸‹ä»£ç åœ¨ çº¿ç¨‹A ä¸­æ‰§è¡Œ</span></span><br><span class="line"><span class="comment">// æ¨¡æ‹Ÿ è¯»å–é…ç½®ä¿¡æ¯ï¼Œå½“è¯»å–å®Œæˆå å°† initialized è®¾ç½®ä¸º true ä»¥é€šçŸ¥å…¶ä»–çº¿ç¨‹ é…ç½®å¯ç”¨</span></span><br><span class="line">configOptions = new HashMap();</span><br><span class="line">configText =  readConfigFile(fileName);</span><br><span class="line">processConfigOptions(configText, configOptions);</span><br><span class="line">initialized = true;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡è®¾ä»¥ä¸‹ä»£ç åœ¨ çº¿ç¨‹B ä¸­æ‰§è¡Œ</span></span><br><span class="line"><span class="comment">// ç­‰å¾… initialized ä¸º trueï¼Œä»£è¡¨ çº¿ç¨‹A å·²ç»æŠŠé…ç½®ä¿¡æ¯ åˆå§‹åŒ–å®Œæˆ</span></span><br><span class="line">while (!initialized)&#123;</span><br><span class="line"><span class="code">  sleep();</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ çº¿ç¨‹A ä¸­åˆå§‹åŒ–å¥½çš„é…ç½®ä¿¡æ¯</span></span><br><span class="line">doSomethingWithConfig();</span><br><span class="line">----------------------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure><p>ä»£ç æ¸…å•12-4ä¸­çš„ç¨‹åºæ˜¯ä¸€æ®µ ä¼ªä»£ç ï¼Œå…¶ä¸­æè¿°çš„åœºæ™¯ååˆ†å¸¸è§ï¼Œåªæ˜¯æˆ‘ä»¬åœ¨å¤„ç†é…ç½®æ–‡ä»¶æ—¶ä¸€èˆ¬ä¸ä¼šå‡ºç°å¹¶å‘è€Œå·²ã€‚  </p><p>å¦‚æœå®šä¹‰ initializedå˜é‡ æ²¡æœ‰ä½¿ç”¨ volatileä¿®é¥°ï¼Œ<br>å°±å¯èƒ½ä¼šç”±äº æŒ‡ä»¤é‡æ’åºçš„ä¼˜åŒ–ï¼Œ<br>å¯¼è‡´ä½äº çº¿ç¨‹A ä¸­çš„æœ€åä¸€å¥ä»£ç  â€œinitialized=trueâ€è¢«æå‰æ‰§è¡Œï¼ˆè¿™é‡Œè™½ç„¶ä½¿ç”¨Javaä½œä¸ºä¼ªä»£ç ï¼Œä½†æ‰€æŒ‡çš„ é‡æ’åºä¼˜åŒ– æ˜¯ æœºå™¨çº§ çš„ ä¼˜åŒ– æ“ä½œï¼Œæå‰æ‰§è¡Œ æ˜¯æŒ‡ è¿™å¥è¯å¯¹åº”çš„ æ±‡ç¼–ä»£ç  è¢« æå‰æ‰§è¡Œï¼‰ï¼Œ<br>è¿™æ ·åœ¨ çº¿ç¨‹B ä¸­ä½¿ç”¨é…ç½®ä¿¡æ¯çš„ä»£ç  å°±å¯èƒ½å‡ºç°é”™è¯¯ï¼Œ<br>è€Œ volatileå…³é”®å­— åˆ™å¯ä»¥é¿å…æ­¤ç±»æƒ…å†µçš„å‘ç”Ÿã€‚</p><blockquote><p>volatile å±è”½ æŒ‡ä»¤é‡æ’åº çš„è¯­ä¹‰ åœ¨JDK1.5 æ‰è¢«å®Œå…¨ä¿®å¤ï¼Œæ­¤å‰çš„JDKä¸­ å³ä½¿å°†å˜é‡å£°æ˜ä¸º volatile ä¹Ÿä»ç„¶ä¸èƒ½å®Œå…¨é¿å… é‡æ’åº æ‰€å¯¼è‡´çš„é—®é¢˜<br>(ä¸»è¦æ˜¯ volatileå˜é‡ å‰åçš„ä»£ç  ä»ç„¶å­˜åœ¨ é‡æ’åº é—®é¢˜)ï¼Œè¿™ç‚¹ ä¹Ÿæ˜¯åœ¨ JDK1.5 ä¹‹å‰çš„Javaä¸­ æ— æ³•å®‰å…¨åœ°ä½¿ç”¨ DCLï¼ˆåŒé”æ£€æµ‹ï¼‰æ¥å®ç°å•ä¾‹æ¨¡å¼çš„åŸå› ã€‚</p></blockquote><p>æŒ‡ä»¤é‡æ’åº æ˜¯ å¹¶å‘ç¼–ç¨‹ ä¸­æœ€å®¹æ˜“è®©å¼€å‘äººå‘˜äº§ç”Ÿç–‘æƒ‘çš„åœ°æ–¹ï¼Œé™¤äº†ä¸Šé¢ä¼ªä»£ç çš„ä¾‹å­ä¹‹å¤–ï¼Œ<br>ç¬”è€…å†ä¸¾ä¸€ä¸ªå¯ä»¥å®é™…æ“ä½œè¿è¡Œçš„ä¾‹å­æ¥åˆ†æ volatileå…³é”®å­— æ˜¯å¦‚ä½• ç¦æ­¢æŒ‡ä»¤é‡æ’åºä¼˜åŒ–çš„ã€‚  </p><p>ä»£ç æ¸…å•12-5æ˜¯ä¸€æ®µæ ‡å‡†çš„ DCLå•ä¾‹ä»£ç ï¼Œå¯ä»¥è§‚å¯Ÿ åŠ å…¥volatileå’ŒæœªåŠ å…¥volatileå…³é”®å­— æ‰€ç”Ÿæˆ æ±‡ç¼–ä»£ç  çš„å·®åˆ«<br>ï¼ˆå¦‚ä½•è·å¾—JITçš„æ±‡ç¼–ä»£ç ï¼Œè¯·å‚è€ƒ4.2.7èŠ‚ï¼‰ã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">                                ä»£ç æ¸…å• 12-5 DCLå•ä¾‹æ¨¡å¼</span><br><span class="line">----------------------------------------------------------------------------------------------</span><br><span class="line">public class Singleton&#123;</span><br><span class="line">    private volatile static Singleton instance;</span><br><span class="line"></span><br><span class="line">    public static Singleton getInstance()&#123;</span><br><span class="line">      <span class="keyword">if</span>(instance == <span class="literal">null</span>)&#123;</span><br><span class="line">        synchronized ( Singleton.class )&#123;</span><br><span class="line">          <span class="keyword">if</span>(instance ==<span class="literal">null</span> )&#123;</span><br><span class="line">           <span class="built_in"> instance </span>= new Singleton();</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      return instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args)&#123;</span><br><span class="line">      Singleton.getInstance();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">----------------------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘åï¼Œè¿™æ®µä»£ç å¯¹ instanceå˜é‡ èµ‹å€¼éƒ¨åˆ† å¦‚ä»£ç æ¸…å•12-6æ‰€ç¤ºã€‚</p><p>(å§æ§½ï¼Œæˆ‘æœ‰ç—…æˆ‘ä¸ºä»€ä¹ˆè¦æŠ„è¿™ä¸ªä»£ç æ¸…å•12-6â€¦)</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">                                ä»£ç æ¸…å• <span class="number">12</span><span class="number">-6</span></span><br><span class="line">----------------------------------------------------------------------------------------------</span><br><span class="line"><span class="number">0x01a3de0f</span>: mov       $<span class="number">0x3375cdb0</span>,%esi           ; ...beb0cd75 <span class="number">33</span></span><br><span class="line">                                                 ;    &#123;oop(<span class="string">'Singleton'</span>)&#125;</span><br><span class="line"><span class="number">0x01a3de14</span>: mov       %eax,<span class="number">0x150</span>(%esi)           ; ..<span class="number">.89865001</span> <span class="number">0000</span></span><br><span class="line"><span class="number">0x01a3de1a</span>: shr       $<span class="number">0x9</span>,%esi                  ; ...clee09</span><br><span class="line"><span class="number">0x01a3de1d</span>: movb      $<span class="number">0x0</span>,<span class="number">0x1104800</span>(%esi)       ; ...c6860048 <span class="number">100100</span></span><br><span class="line"><span class="number">0x01a3de24</span>: lock  add1 $<span class="number">0x0</span>,(%esp)               ; ...f0830424 <span class="number">00</span></span><br><span class="line">                                                 ; *putstatic instance</span><br><span class="line">                                                 ; -</span><br><span class="line">Singleton::<span class="symbol">getInstance@</span><span class="number">24</span></span><br><span class="line">----------------------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure><p>é€šè¿‡ å¯¹æ¯” å°±ä¼šå‘ç°ï¼Œ å…³é”®å˜åŒ– åœ¨äºæœ‰ volatileä¿®é¥°çš„å˜é‡ï¼Œ<br>èµ‹å€¼åï¼ˆå‰é¢ mov %eax,0x150(%esi) è¿™å¥ä¾¿æ˜¯èµ‹å€¼æ“ä½œï¼‰ å¤šæ‰§è¡Œäº†ä¸€ä¸ªâ€ lock add1 $0x0,(%esp)â€ æ“ä½œï¼Œ<br>è¿™ä¸ªæ“ä½œç›¸å½“äºä¸€ä¸ª å†…å­˜å±éšœ ï¼ˆMemory Barrier æˆ– Memory Fenceï¼ŒæŒ‡ é‡æ’åºæ—¶ ä¸èƒ½æŠŠ åé¢çš„æŒ‡ä»¤ é‡æ’åºåˆ° å†…å­˜å±éšœ ä¹‹å‰çš„ä½ç½®ï¼‰ï¼Œ<br>åªæœ‰ä¸€ä¸ª CPU è®¿é—® å†…å­˜æ—¶ï¼Œå¹¶ä¸éœ€è¦ å†…å­˜å±éšœï¼›<br>ä½†å¦‚æœæœ‰ ä¸¤ä¸ªæˆ–æ›´å¤šCPU è®¿é—® åŒä¸€å— å†…å­˜ï¼Œä¸” å…¶ä¸­æœ‰ä¸€ä¸ªåœ¨ è§‚æµ‹ å¦ä¸€ä¸ªï¼Œå°±éœ€è¦ å†…å­˜å±éšœ æ¥ä¿è¯ ä¸€è‡´æ€§äº†ã€‚</p><p>è¿™å¥ æŒ‡ä»¤ ä¸­çš„ â€œadd1 $0x0,(%esp)â€ï¼ˆæŠŠ ESPå¯„å­˜å™¨ çš„ å€¼ åŠ  0ï¼‰æ˜¾ç„¶æ˜¯ä¸€ä¸ª ç©ºæ“ä½œ<br>ï¼ˆé‡‡ç”¨è¿™ä¸ª ç©ºæ“ä½œ è€Œä¸æ˜¯ ç©ºæ“ä½œæŒ‡ä»¤nop æ˜¯å› ä¸º IA32æ‰‹å†Œè§„å®š lockå‰ç¼€ ä¸å…è®¸ é…åˆ nopæŒ‡ä»¤ ä½¿ç”¨ï¼‰ï¼Œ<br>å…³é”®åœ¨äº lockå‰ç¼€ï¼ŒæŸ¥è¯¢ IA32æ‰‹å†Œï¼Œ<br>å®ƒçš„ä½œç”¨æ˜¯ä½¿å¾— æœ¬CPU çš„ Cache å†™å…¥äº† å†…å­˜ï¼Œ<br>è¯¥ å†™å…¥åŠ¨ä½œ ä¹Ÿä¼šå¼•èµ· åˆ«çš„CPU æˆ–è€… åˆ«çš„å†…æ ¸ æ— æ•ˆåŒ–ï¼ˆInvalidateï¼‰å…¶Cacheï¼Œ<br>è¿™ç§æ“ä½œç›¸å½“äºå¯¹ Cacheä¸­çš„å˜é‡ åšäº†ä¸€æ¬¡ å‰é¢ä»‹ç» Javaå†…å­˜æ¨¡å¼ ä¸­æ‰€è¯´çš„ â€storeâ€œå’Œâ€writeâ€œæ“ä½œã€‚<br>æ‰€ä»¥é€šè¿‡è¿™æ ·ä¸€ä¸ª ç©ºæ“ä½œï¼Œå¯è®©å‰é¢ volatileå˜é‡ çš„ ä¿®æ”¹ å¯¹ å…¶ä»–CPU ç«‹å³å¯è§ã€‚</p><blockquote><p>Doug Lea åˆ—å‡ºäº†å„ç§å¤„ç†å™¨æ¶æ„ä¸‹çš„ å†…å­˜å±éšœæŒ‡ä»¤ï¼ˆ<code>http://g.oswego.edu/d1/jmm/cookbook.html</code>ï¼‰</p></blockquote><blockquote><p>è¿™ä¸ª <code>http://g.oswego.edu/d1/jmm/cookbook.html</code> æˆ‘è¯•äº†ä¸‹è®¿é—®ä¸é€šï¼›â€¦</p></blockquote><p>ï¼ˆçœ‹åˆ°è¿™äº›æ–‡å­—ğŸ™ƒï¼Œè«åæˆ‘ğŸ™ƒå°±æƒ³èµ·äº†é«˜ä¸­çš„æ•°å­¦ğŸ™ƒè¿˜æœ‰å¤§å­¦çš„é«˜ç­‰æ•°å­¦ğŸ™ƒã€‚è¿˜æƒ³èµ·äº†é‚£ä¸ªæ–æ³¢æ‹‰å¥‘æ•°åˆ—è¿˜æœ‰é‚£ä¸ªKMPæ¨¡å¼åŒ¹é…ç®—æ³•ğŸ™ƒï¼Œå§æ§½ğŸ™ƒï¼‰</p><blockquote><p>ğŸ™ƒğŸ™ƒğŸ™ƒæ‹ä¸€æ‹ğŸ™ƒğŸ™ƒğŸ™ƒ</p><ul><li>åŠ äº†volatileå’Œä¸åŠ volatileçš„åŒºåˆ«ï¼šâ€œ0x01a3de24: lock  add1 $0x0,(%esp)               ; â€¦f0830424 00â€è¿™ä¸€è¡Œä»£ç æ˜¯å¦å­˜åœ¨</li><li>â€œ0x01a3de14: mov       %eax,0x150(%esi)           ; â€¦89865001 0000â€è¿™ä¸€å¥æ˜¯èµ‹å€¼æ“ä½œï¼Œç›¸å½“äºâ€œinstance = new Singleton();â€è¿™å¥è¯ï¼Ÿ</li><li>â€œadd1 $0x0,(%esp)â€ç›¸å½“äºä¸€ä¸ªå†…å­˜å±éšœï¼›</li><li>å†…å­˜å±éšœï¼ˆMemory Barrieræˆ– Memory Fenceï¼‰ä½œç”¨ï¼šé‡æ’åºæ—¶ï¼Œä¸èƒ½æŠŠ åé¢çš„æŒ‡ä»¤ é‡æ’åºåˆ° å†…å­˜å±éšœ ä¹‹å‰çš„ä½ç½®<ul><li>ä¸¾ä¸ªä¾‹å­ï¼Œå°±å¥½æ¯”emmä¹‹å‰é‚£ä¸ªä»£ç å—ï¼Œä¸¤ä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹Aä¸çº¿ç¨‹Bï¼›çº¿ç¨‹Aè´Ÿè´£è¯»å–é…ç½®ä¿¡æ¯ï¼›çº¿ç¨‹Bç­‰å¾…çº¿ç¨‹Aåˆå§‹åŒ–é…ç½®ä¿¡æ¯å®Œæˆï¼›å®Œæˆä¹‹åè¿›è¡Œä½¿ç”¨çº¿ç¨‹Aåˆå§‹åŒ–å¥½çš„é…ç½®ä¿¡æ¯ï¼›åœ¨è¿™å½“ä¸­å¦‚æœçº¿ç¨‹Aå½“ä¸­â€œinitialized=trueâ€è¿™å¥è¯æå‰æ‰§è¡Œï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´çº¿ç¨‹Bçš„åˆ¤æ–­å¤±è¯¯ä¸ä¼šå†æ‰§è¡Œsleep()ï¼Œä»è€Œæ‰§è¡Œä¸‹é¢çš„doSomethingWithConfig()æ–¹æ³•ï¼›è€Œæ­¤æ—¶æ‰§è¡Œè¿™ä¸ªæ–¹æ³•å°±æœ‰å¯èƒ½ä¼šå‡ºé”™ï¼›</li></ul></li><li>â€œadd1 $0x0,(%esp)â€å½“ä¸­çš„espæŒ‡çš„æ˜¯ESPå¯„å­˜å™¨</li><li>â€œadd1 $0x0,(%esp)â€è¯¥æŒ‡ä»¤ä¸ºä¸€ä¸ªç©ºæ“ä½œ<ul><li>è¯¥ ç©ºæ“ä½œ å¯¼è‡´ æœ¬CPU çš„ Cache å†™å…¥äº† å†…å­˜ï¼›</li><li>æœ¬CPUçš„Cacheå†™å…¥å†…å­˜ ç›¸å½“äº Cacheä¸­çš„å˜é‡ åšäº†ä¸€æ¬¡â€œstoreâ€ä¸â€œwriteâ€ï¼Œä¹Ÿå°±æ˜¯ åŒæ­¥å›å†…å­˜ çš„æ„æ€ï¼›</li><li>é€šè¿‡å°† æœ¬CPUçš„Cacheå†™å…¥å†…å­˜ çš„è¯¥ç©ºæ“ä½œï¼Œä»è€Œä½¿å¾—volatileå˜é‡ çš„ä¿®æ”¹å¯¹å…¶ä»–CPUç«‹å³å¯è§</li><li>è¿™ä¸ªç©ºæ“ä½œæ˜¯ä¸æ˜¯ä¹Ÿå°±æ˜¯ä¸€ä¸ªåˆ·æ–°çš„æ“ä½œï¼Ÿç±»ä¼¼ï¼Ÿ</li><li>æ„æ€ä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªESPå¯„å­˜å™¨çš„å€¼ä¸æ˜¯åŠ 0å—ï¼Œé‚£è¿™ä¸ªESPå¯„å­˜å™¨çš„å€¼è¿™ä¸ªåº”è¯¥æ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œç„¶ååŠ è¿™ä¸ª0å¯¹è¿™ä¸ªå¸¸é‡å¹¶ä¸ä¼šèµ·åˆ°ä»€ä¹ˆå½±å“ï¼Œä½†æ˜¯å½“ä¸­ä¼šæœ‰ä¸€ä¸ªå†™æ“ä½œï¼Œä¹Ÿå°±æ˜¯assignè¿™ä¸ªæ“ä½œï¼›å› ä¸ºæ‰§è¡Œ8ä¸ªæ“ä½œä¸­å…¶ä¸­çš„è§„åˆ™æœ‰ä¸€æ¡æ˜¯ï¼šä¸å…è®¸ä¸€ä¸ªçº¿ç¨‹æ— åŸå› åœ°ï¼ˆæ²¡æœ‰å‘ç”Ÿè¿‡ä»»ä½•assignæ“ä½œï¼‰æŠŠæ•°æ®ä»çº¿ç¨‹çš„å·¥ä½œå†…å­˜åŒæ­¥å›ä¸»å†…å­˜ã€‚</li><li>æ‰€ä»¥ä¼šå»é€šè¿‡è¿™æ ·ä¸€ä¸ªç©ºæ“ä½œï¼Œè®©å‰é¢çš„ volatileå˜é‡ çš„ä¿®æ”¹ å¯¹å…¶ä»–CPUç«‹å³å¯è§</li><li>å¯¹äº†ï¼Œè¿™ä¸ªCPUï¼Œå…¶ä»–CPUä¹Ÿå°±ç›¸å½“äºæ˜¯ä¸»å†…å­˜äº†æ˜¯å§</li></ul></li></ul></blockquote><p>é‚£ä¸ºä½•è¯´ å®ƒç¦æ­¢æŒ‡ä»¤é‡æ’åº å‘¢ï¼Ÿ<br>ä» ç¡¬ä»¶æ¶æ„ ä¸Šè®²ï¼ŒæŒ‡ä»¤é‡æ’åº æ˜¯æŒ‡ CPU é‡‡ç”¨äº† å…è®¸å°† å¤šæ¡æŒ‡ä»¤ ä¸æŒ‰ ç¨‹åºè§„å®šçš„é¡ºåº åˆ†å¼€å‘é€ç»™ å„ç›¸åº” ç”µè·¯å•å…ƒ å¤„ç†ã€‚<br>ä½†å¹¶ä¸æ˜¯è¯´ æŒ‡ä»¤ä»»æ„é‡æ’ï¼Œ CPU éœ€è¦èƒ½ æ­£ç¡®å¤„ç† æŒ‡ä»¤ ä¾èµ–æƒ…å†µ ä»¥ä¿éšœ ç¨‹åº èƒ½å¾—å‡º æ­£ç¡®çš„æ‰§è¡Œç»“æœã€‚</p><p>è­¬å¦‚<br>æŒ‡ä»¤1 æŠŠ åœ°å€A ä¸­çš„ å€¼ åŠ 10ï¼Œ<br>æŒ‡ä»¤2 æŠŠ åœ°å€A ä¸­çš„ å€¼ ä¹˜ä»¥2ï¼Œ<br>æŒ‡ä»¤3 æŠŠ åœ°å€B ä¸­çš„ å€¼ å‡å»3ï¼Œ<br>è¿™æ—¶ æŒ‡ä»¤1å’ŒæŒ‡ä»¤2 æ˜¯æœ‰ä¾èµ–çš„ï¼Œ<br>å®ƒä»¬ä¹‹é—´çš„é¡ºåº ä¸èƒ½é‡æ’â€”â€”â€“ï¼ˆA+10ï¼‰<em>2å’Œ A</em>2+10æ˜¾ç„¶ä¸ç›¸ç­‰ï¼Œ<br>ä½†æŒ‡ä»¤3 å¯ä»¥é‡æ’åˆ°æŒ‡ä»¤1ã€2ä¹‹å‰æˆ–è€…ä¸­é—´ï¼Œ<br>åªè¦ä¿è¯CPUæ‰§è¡Œåé¢ ä¾èµ–åˆ°Aã€Bå€¼çš„æ“ä½œæ—¶èƒ½è·å–åˆ°æ­£ç¡®çš„Aå’ŒBå€¼å³å¯ã€‚</p><p>æ‰€ä»¥åœ¨ æœ¬å†…CPUä¸­ï¼ˆè¿™ä¸ªåœ°æ–¹ï¼Œæœ¬å†…ï¼Ÿemmï¼Œæ˜¯å¦æ˜¯æƒ³è¯´çš„æ˜¯æœ¬å†…å­˜or æœ¬CPUå•Šï¼Ÿï¼‰ï¼Œé‡æ’åºçœ‹èµ·æ¥ä¾ç„¶æ˜¯æœ‰åºçš„ã€‚<br>å› æ­¤ï¼Œ lock add1 $0x0,(%esp) æŒ‡ä»¤ æŠŠ ä¿®æ”¹ åŒæ­¥ åˆ° å†…å­˜æ—¶ï¼Œæ„å‘³ç€æ‰€æœ‰ä¹‹å‰çš„ æ“ä½œ éƒ½å·²ç» æ‰§è¡Œå®Œæˆï¼Œè¿™æ ·ä¾¿å½¢æˆäº†â€œæŒ‡ä»¤é‡æ’åºæ— æ³•è¶Šè¿‡å†…å­˜å±éšœâ€çš„æ•ˆæœã€‚</p><p>è§£å†³äº† volatile çš„è¯­ä¹‰é—®é¢˜ï¼Œå†æ¥çœ‹çœ‹åœ¨ä¼—å¤šä¿éšœå¹¶å‘å®‰å…¨çš„å·¥å…·ä¸­é€‰ç”¨ volatile çš„æ„ä¹‰â€”â€”-å®ƒèƒ½è®©æˆ‘ä»¬çš„ä»£ç æ¯”ä½¿ç”¨å…¶ä»–çš„åŒæ­¥å·¥å…·ä¼šæ›´å¿«å—ï¼Ÿ</p><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œvolatile çš„ åŒæ­¥æœºåˆ¶ çš„æ€§èƒ½ ç¡®å®è¦ä¼˜äº é”ï¼ˆä½¿ç”¨ synchronized å…³é”®å­— æˆ– java.util.concurrentåŒ…é‡Œé¢çš„é”ï¼‰ï¼Œ<br>ä½†æ˜¯ç”±äº è™šæ‹Ÿæœº å¯¹ é” å®è¡Œçš„è®¸å¤š æ¶ˆé™¤å’Œä¼˜åŒ–ï¼Œä½¿å¾—æˆ‘ä»¬å¾ˆéš¾é‡åŒ–åœ°è®¤ä¸º volatile å°±ä¼šæ¯” synchronized å¿«å¤šå°‘ã€‚  </p><p>å¦‚æœè®© volatile è‡ªå·±ä¸è‡ªå·±æ¯”è¾ƒï¼Œé‚£å¯ä»¥ç¡®å®šä¸€ä¸ªåŸåˆ™ï¼š<br>volatileå˜é‡ è¯»æ“ä½œçš„æ€§èƒ½æ¶ˆè€— æ¯” æ™®é€šå˜é‡å‡ ä¹æ²¡æœ‰ä»€ä¹ˆå·®åˆ«ï¼Œä½†æ˜¯ å†™æ“ä½œ åˆ™å¯èƒ½ ä¼šæ…¢ä¸€äº›ï¼›<br>å› ä¸ºå®ƒéœ€è¦ åœ¨æœ¬åœ°ä»£ç ä¸­ æ’å…¥è®¸å¤š å†…å­˜å±éšœæŒ‡ä»¤ æ¥ä¿è¯ å¤„ç†å™¨ ä¸å‘ç”Ÿ ä¹±åºæ‰§è¡Œã€‚</p><p>ä¸è¿‡å³ä¾¿å¦‚æ­¤ï¼Œå¤§å¤šæ•°åœºæ™¯ä¸‹ volatile çš„æ€»å¼€é”€ ä»ç„¶è¦æ¯” é” ä½ï¼Œ<br>æˆ‘ä»¬åœ¨ volatileä¸é” ä¸­é€‰æ‹©çš„å”¯ä¸€ä¾æ®ä»…ä»…æ˜¯ volatileçš„è¯­ä¹‰ èƒ½å¦æ»¡è¶³ä½¿ç”¨åœºæ™¯çš„éœ€æ±‚ã€‚</p><p>åœ¨æœ¬èŠ‚çš„æœ€åï¼Œæˆ‘ä»¬å›å¤´çœ‹ä¸€ä¸‹ Javaå†…å­˜æ¨¡å‹ ä¸­å¯¹ volatileå˜é‡ å®šä¹‰çš„ç‰¹æ®Šè§„åˆ™ã€‚</p><p>å‡å®š T è¡¨ç¤ºä¸€ä¸ªçº¿ç¨‹ï¼ŒV å’Œ W åˆ†åˆ«è¡¨ç¤º ä¸¤ä¸ª volatileå‹å˜é‡ï¼Œé‚£ä¹ˆåœ¨è¿›è¡Œreadã€loadã€useã€assignã€storeå’Œwrite æ“ä½œæ—¶éœ€è¦æ»¡è¶³å¦‚ä¸‹è§„åˆ™ï¼š</p><ul><li>åªæœ‰å½“ çº¿ç¨‹ T å¯¹ å˜é‡ V æ‰§è¡Œçš„å‰ä¸€ä¸ªåŠ¨ä½œæ˜¯ load çš„æ—¶å€™ï¼Œçº¿ç¨‹ T æ‰èƒ½å¯¹ å˜é‡ V æ‰§è¡Œ useåŠ¨ä½œï¼›<ul><li>å¹¶ä¸”ï¼Œåªæœ‰å½“ çº¿ç¨‹ T å¯¹ å˜é‡ V æ‰§è¡Œçš„ åä¸€ä¸ªåŠ¨ä½œ æ˜¯ use çš„æ—¶å€™ï¼Œçº¿ç¨‹ T æ‰èƒ½å¯¹ å˜é‡ V æ‰§è¡Œ load åŠ¨ä½œã€‚</li><li>çº¿ç¨‹ T å¯¹ å˜é‡ V çš„ useåŠ¨ä½œ å¯ä»¥è®¤ä¸ºæ˜¯ å’Œçº¿ç¨‹ T å¯¹ å˜é‡ V çš„ loadã€readåŠ¨ä½œç›¸å…³è”ï¼Œå¿…é¡»è¿ç»­ä¸€èµ·å‡ºç°<ul><li>ï¼ˆè¿™æ¡ è§„åˆ™ è¦æ±‚åœ¨ å·¥ä½œå†…å­˜ ä¸­ï¼Œæ¯æ¬¡ä½¿ç”¨ V å‰éƒ½å¿…é¡»å…ˆä» ä¸»å†…å­˜ åˆ·æ–°æœ€æ–°çš„å€¼ï¼Œç”¨äºä¿è¯ èƒ½çœ‹è§ å…¶ä»–çº¿ç¨‹ å¯¹ å˜é‡ V æ‰€åšçš„ä¿®æ”¹åçš„å€¼ï¼‰ã€‚</li></ul></li></ul></li><li>åªæœ‰å½“ çº¿ç¨‹ T å¯¹ å˜é‡ V æ‰§è¡Œçš„å‰ä¸€ä¸ªåŠ¨ä½œæ˜¯ assign çš„æ—¶å€™ï¼Œçº¿ç¨‹ T æ‰èƒ½å¯¹ å˜é‡ V æ‰§è¡Œ store åŠ¨ä½œï¼›<ul><li>å¹¶ä¸”ï¼Œåªæœ‰å½“ çº¿ç¨‹ T å¯¹å˜é‡ V æ‰§è¡Œçš„ åä¸€ä¸ªåŠ¨ä½œ æ˜¯ store çš„æ—¶å€™å¯ä»¥è®¤ä¸ºæ˜¯å’Œ çº¿ç¨‹ T å¯¹ å˜é‡ V çš„storeã€writeåŠ¨ä½œç›¸å…³è”ï¼Œå¿…é¡» è¿ç»­ ä¸€èµ·å‡ºç°<ul><li>ï¼ˆè¿™æ¡ è§„åˆ™ è¦æ±‚åœ¨ å·¥ä½œå†…å­˜ä¸­ï¼Œæ¯æ¬¡ä¿®æ”¹ V åéƒ½å¿…é¡»ç«‹åˆ» åŒæ­¥å› ä¸»å†…å­˜ ä¸­ï¼Œç”¨äºä¿è¯ å…¶ä»–çº¿ç¨‹ å¯ä»¥çœ‹åˆ° è‡ªå·±å¯¹å˜é‡ V æ‰€åšçš„ä¿®æ”¹ï¼‰</li></ul></li></ul></li><li>å‡å®š åŠ¨ä½œ A æ˜¯ çº¿ç¨‹ T å¯¹ å˜é‡ V å®æ–½çš„ use æˆ– assign åŠ¨ä½œï¼›<br>å‡å®š åŠ¨ä½œ F æ˜¯å’Œ åŠ¨ä½œ A ç›¸å…³è”çš„ load æˆ– store åŠ¨ä½œï¼Œ<br>å‡å®š åŠ¨ä½œ P æ˜¯å’Œ åŠ¨ä½œ F ç›¸å…³è”çš„ read æˆ– write åŠ¨ä½œï¼›<br>ç±»ä¼¼çš„ï¼Œ<br>å‡å®š åŠ¨ä½œ B æ˜¯ çº¿ç¨‹ T å¯¹ å˜é‡ W å®æ–½çš„ use æˆ– assign åŠ¨ä½œï¼Œ<br>å‡å®š åŠ¨ä½œ G æ˜¯å’ŒåŠ¨ä½œ B ç›¸å…³è”çš„ load æˆ– store åŠ¨ä½œï¼Œ<br>å‡å®š åŠ¨ä½œ Q æ˜¯å’ŒåŠ¨ä½œ G ç›¸åº”çš„å¯¹ å˜é‡ W çš„ readæˆ–write åŠ¨ä½œã€‚<br>å¦‚æœ A å…ˆäº Bï¼Œé‚£ä¹ˆ P å…ˆäº Q<ul><li>ï¼ˆè¿™æ¡ è§„åˆ™ è¦æ±‚ volatile ä¿®é¥°çš„å˜é‡ ä¸ä¼šè¢« æŒ‡ä»¤é‡æ’åºä¼˜åŒ–ï¼Œä¿è¯ ä»£ç çš„æ‰§è¡Œé¡ºåº å’Œ ç¨‹åºçš„é¡ºåº ç›¸åŒï¼‰</li></ul></li></ul><blockquote><p>ç†è§£ä¸ºå°±å¥½åƒæ˜¯ä¸€ä¸ªè¦ read-load-use åŠªåŠ›åˆ·æ–°ï¼›ä¸€ä¸ªassign-store-write åŠªåŠ›æ›´æ–°ä¸€æ ·</p></blockquote><h5 id="å¯¹äº-long-å’Œ-double-å‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™"><a href="#å¯¹äº-long-å’Œ-double-å‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™" class="headerlink" title="å¯¹äº long å’Œ double å‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™"></a>å¯¹äº long å’Œ double å‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™</h5><p>javaå†…å­˜æ¨¡å‹ è¦æ±‚ lockã€unlockã€readã€loadã€useã€assignã€storeã€write è¿™ä¸ª 8ä¸ªæ“ä½œ éƒ½å…·æœ‰ åŸå­æ€§ï¼Œ<br>ä½†æ˜¯å¯¹äº 64ä½çš„æ•°æ®ç±»å‹ï¼ˆ long å’Œ double ï¼‰ï¼Œåœ¨æ¨¡å‹ä¸­ç‰¹åˆ«å®šä¹‰äº†ä¸€æ¡ç›¸å¯¹å®½æ¾çš„è§„å®šï¼šå…è®¸ è™šæ‹Ÿæœº å°† æ²¡æœ‰è¢« volatile ä¿®é¥°çš„ 64ä½æ•°æ®çš„ è¯»å†™æ“ä½œ åˆ’åˆ†ä¸º ä¸¤æ¬¡32ä½çš„æ“ä½œ æ¥è¿›è¡Œï¼Œå³å…è®¸ è™šæ‹Ÿæœº å®ç°é€‰æ‹© å¯ä»¥ ä¸ä¿è¯64ä½æ•°æ®ç±»å‹çš„ loadã€storeã€readå’Œwriteè¿™ä¸ª4ä¸ªæ“ä½œçš„åŸå­æ€§ï¼Œ<br>è¿™ç‚¹å°±æ˜¯æ‰€è°“çš„ longå’Œdouble çš„éåŸå­æ€§åå®šï¼ˆNonatomic Treatment of double and long Variablesï¼‰ã€‚</p><p>å¦‚æœæœ‰ å¤šä¸ªçº¿ç¨‹ å…±äº«ä¸€ä¸ª å¹¶æœªå£°æ˜ä¸º volatileçš„ long æˆ– double ç±»å‹çš„å˜é‡ï¼Œå¹¶ä¸”åŒæ—¶å¯¹å®ƒä»¬è¿›è¡Œ è¯»å–å’Œä¿®æ”¹ æ“ä½œï¼Œ<br>é‚£ä¹ˆ æŸäº›çº¿ç¨‹ å¯èƒ½ä¼š è¯»å–åˆ°ä¸€ä¸ª æ—¢éåŸå€¼ï¼Œä¹Ÿä¸æ˜¯å…¶ä»–çº¿ç¨‹ä¿®æ”¹å€¼çš„ ä»£è¡¨äº† â€œåŠä¸ªå˜é‡â€çš„æ•°å€¼ã€‚</p><p>ä¸è¿‡è¿™ç§è¯»å–åˆ° â€œåŠä¸ªå˜é‡â€çš„æƒ…å†µ éå¸¸ç½•è§ï¼ˆåœ¨ç›®å‰ å•†ç”¨javaè™šæ‹Ÿæœº ä¸­ä¸ä¼šå‡ºç°ï¼‰ï¼Œ<br>å› ä¸º javaå†…å­˜æ¨¡å‹ è™½ç„¶å…è®¸è™šæ‹Ÿæœºä¸æŠŠ longå’Œdouble å˜é‡çš„ è¯»å†™ å®ç°æˆåŸå­æ“ä½œï¼Œ<br>ä½†å…è®¸ è™šæ‹Ÿæœº é€‰æ‹©æŠŠè¿™äº›æ“ä½œå®ç°ä¸º å…·æœ‰åŸå­æ€§çš„æ“ä½œï¼Œè€Œä¸”è¿˜ â€œå¼ºçƒˆå»ºè®®â€ è™šæ‹Ÿæœº è¿™æ ·å®ç°ã€‚</p><p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œç›®å‰å„ç§å¹³å°ä¸‹çš„ å•†ç”¨è™šæ‹Ÿæœº å‡ ä¹éƒ½é€‰æ‹©æŠŠ 64ä½æ•°æ®çš„è¯»å†™æ“ä½œ ä½œä¸º åŸå­æ“ä½œ æ¥å¯¹å¾…ï¼Œ<br>å› æ­¤æˆ‘ä»¬åœ¨ç¼–å†™ä»£ç æ—¶ ä¸€èˆ¬ä¸éœ€è¦æŠŠç”¨åˆ°çš„ longå’Œdouble å˜é‡ä¸“é—¨å£°æ˜ä¸º volatileã€‚</p><h5 id="åŸå­æ€§ã€å¯è§æ€§å’Œæœ‰åºæ€§"><a href="#åŸå­æ€§ã€å¯è§æ€§å’Œæœ‰åºæ€§" class="headerlink" title="åŸå­æ€§ã€å¯è§æ€§å’Œæœ‰åºæ€§"></a>åŸå­æ€§ã€å¯è§æ€§å’Œæœ‰åºæ€§</h5><p>ä»‹ç»å®Œ Javaå†…å­˜æ¨¡å‹ çš„ ç›¸å…³æ“ä½œå’Œè§„åˆ™ï¼Œ<br>æˆ‘ä»¬å†æ•´ä½“å›é¡¾ä¸€ä¸‹ è¿™ä¸ªæ¨¡å‹çš„ç‰¹å¾ã€‚</p><p>Javaå†…å­˜æ¨¡å‹ æ˜¯å›´ç»•ç€åœ¨ å¹¶å‘è¿‡ç¨‹ä¸­ å¦‚ä½•å¤„ç†åŸå­æ€§ã€å¯è§æ€§å’Œæœ‰åºæ€§ è¿™3ä¸ªç‰¹å¾æ¥å»ºç«‹çš„ï¼Œ<br>æˆ‘ä»¬é€ä¸ªæ¥çœ‹ä¸€ä¸‹å“ªäº›æ“ä½œå®ç°äº†è¿™3ä¸ªç‰¹æ€§ã€‚</p><p><strong>åŸå­æ€§ï¼ˆAtomicityï¼‰</strong>ï¼šç”± Javaå†…å­˜æ¨¡å‹ æ¥ç›´æ¥ä¿è¯çš„ åŸå­æ€§å˜é‡æ“ä½œ åŒ…æ‹¬ readã€loadã€assignã€useã€storeå’Œwrite</p><p>æˆ‘ä»¬å¤§è‡´å¯ä»¥è®¤ä¸º åŸºæœ¬æ•°æ®ç±»å‹çš„è®¿é—®è¯»å†™ æ˜¯å…·å¤‡åŸå­æ€§çš„ï¼ˆä¾‹å¤–å°±æ˜¯ longå’Œdouble çš„éåŸå­æ€§åå®šï¼Œè¯»è€…åªè¦çŸ¥é“è¿™ä»¶äº‹æƒ…å°±å¯ä»¥äº†ï¼Œæ— éœ€å¤ªè¿‡åœ¨æ„è¿™äº›å‡ ä¹ä¸ä¼šå‘ç”Ÿçš„ä¾‹å¤–æƒ…å†µï¼‰</p><p>å¦‚æœ åº”ç”¨åœºæ™¯ éœ€è¦ä¸€ä¸ª æ›´å¤§èŒƒå›´çš„ åŸå­æ€§ä¿è¯ï¼ˆç»å¸¸ä¼šé‡åˆ°ï¼‰ï¼ŒJavaå†…å­˜æ¨¡å‹è¿˜æä¾›äº†äº† lockå’Œunlock æ“ä½œæ¥æ»¡è¶³è¿™ç§éœ€æ±‚ï¼Œ </p><p>å°½ç®¡ è™šæ‹Ÿæœº æœªæŠŠ lockå’Œunlock æ“ä½œç›´æ¥å¼€æ”¾ç»™ç”¨æˆ·ä½¿ç”¨ï¼Œä½†æ˜¯å´æä¾›äº† æ›´é«˜å±‚æ¬¡çš„å­—èŠ‚ç æŒ‡ä»¤ monitorenterå’Œmonitorexit æ¥ éšå¼åœ° ä½¿ç”¨è¿™ä¸¤ä¸ªæ“ä½œï¼Œè¿™ä¸¤ä¸ªå­—èŠ‚ç æŒ‡ä»¤åæ˜ åˆ°Javaä»£ç ä¸­ å°±æ˜¯ åŒæ­¥å—â€”â€“synchronizedå…³é”®å­—ï¼Œå› æ­¤ synchronized å—ä¹‹é—´çš„æ“ä½œä¹Ÿå…·å¤‡åŸå­æ€§ã€‚</p><p><strong>å¯è§æ€§ï¼ˆVisibilityï¼‰</strong>ï¼šå¯è§æ€§ æ˜¯æŒ‡å½“ ä¸€ä¸ªçº¿ç¨‹ ä¿®æ”¹äº† å…±äº«å˜é‡çš„å€¼ï¼Œå…¶ä»–çº¿ç¨‹ èƒ½å¤Ÿ ç«‹å³å¾—çŸ¥ è¿™ä¸ªä¿®æ”¹ã€‚</p><p>ä¸Šæ–‡åœ¨è®²è§£ volatileå˜é‡ çš„æ—¶å€™æˆ‘ä»¬å·²è¯¦ç»†è®¨è®ºè¿‡è¿™ä¸€ç‚¹ã€‚</p><p>Javaå†…å­˜æ¨¡å‹ æ˜¯é€šè¿‡åœ¨ å˜é‡ä¿®æ”¹å å°† æ–°å€¼ åŒæ­¥å› ä¸»å†…å­˜ï¼Œåœ¨å˜é‡è¯»å–å‰ ä» ä¸»å†…å­˜ åˆ·æ–°å˜é‡å€¼ è¿™ç§ä¾èµ–ä¸»å†…å­˜ä½œä¸º ä¼ é€’åª’ä»‹ çš„æ–¹å¼æ¥å®ç°å¯è§æ€§çš„ï¼Œæ— è®ºæ˜¯ æ™®é€šå˜é‡ è¿˜æ˜¯ volatileå˜é‡ éƒ½æ˜¯å¦‚æ­¤</p><p>æ™®é€šå˜é‡ä¸volatileå˜é‡ çš„åŒºåˆ«æ˜¯ï¼švolatile çš„ ç‰¹æ®Šè§„åˆ™ ä¿è¯äº† æ–°å€¼ èƒ½ç«‹å³ åŒæ­¥åˆ° ä¸»å†…å­˜ï¼Œä»¥åŠæ¯æ¬¡ ä½¿ç”¨å‰ ç«‹å³ä» ä¸»å†…å­˜åˆ·æ–°ã€‚</p><p>å› æ­¤ï¼Œå¯ä»¥è¯´ volatile ä¿è¯äº† å¤šçº¿ç¨‹æ“ä½œæ—¶ å˜é‡çš„å¯è§æ€§ï¼Œè€Œ æ™®é€šå˜é‡ åˆ™ä¸èƒ½ä¿è¯è¿™ä¸€ç‚¹ã€‚</p><p>é™¤äº† volatile ä¹‹å¤–ï¼ŒJavaè¿˜æœ‰ä¸¤ä¸ªå…³é”®å­— èƒ½å®ç°å¯è§æ€§ï¼Œå³ synchronized å’Œ finalã€‚</p><p>åŒæ­¥å— çš„ å¯è§æ€§ æ˜¯ç”± â€œå¯¹ä¸€ä¸ª å˜é‡ æ‰§è¡Œ unlock æ“ä½œä¹‹å‰ï¼Œ å¿…é¡»å…ˆæŠŠ æ­¤å˜é‡ åŒæ­¥å› ä¸»å†…å­˜ä¸­ï¼ˆæ‰§è¡Œstoreã€writeæ“ä½œï¼‰â€è¿™æ¡è§„åˆ™è·å¾—çš„ï¼Œ</p><p>è€Œ final å…³é”®å­— çš„å¯è§æ€§æ˜¯æŒ‡ï¼šè¢« final ä¿®é¥°çš„å­—æ®µ åœ¨æ„é€ å™¨ä¸­ ä¸€æ—¦åˆå§‹åŒ–å®Œæˆï¼Œ å¹¶ä¸”æ„é€ å™¨ æ²¡æœ‰æŠŠâ€œthisâ€çš„å¼•ç”¨ ä¼ é€’å‡ºå»ï¼ˆthiså¼•ç”¨é€ƒé€¸ æ˜¯ä¸€ä»¶å¾ˆå±é™©çš„äº‹æƒ…ï¼Œå…¶ä»–çº¿ç¨‹ æœ‰å¯èƒ½ é€šè¿‡è¿™ä¸ªå¼•ç”¨ è®¿é—®åˆ° â€œåˆå§‹åŒ–äº†ä¸€åŠâ€ çš„å¯¹è±¡ï¼‰ï¼Œé‚£åœ¨ å…¶ä»–çº¿ç¨‹ ä¸­å°±èƒ½çœ‹è§ finalå­—æ®µçš„å€¼ã€‚</p><p>å¦‚ä»£ç æ¸…å•12-7æ‰€ç¤ºï¼Œå˜é‡iå’Œjéƒ½å…·å¤‡å¯è§æ€§ï¼Œå®ƒä»¬æ— éœ€åŒæ­¥ å°±èƒ½è¢« å…¶ä»–çº¿ç¨‹æ­£ç¡®è®¿é—®ã€‚</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">                                ä»£ç æ¸…å• 12-7 final ä¸å¯è§æ€§</span></span><br><span class="line">----------------------------------------------------------------------------------------------</span><br><span class="line">public static final int i;</span><br><span class="line"></span><br><span class="line">public final int j;</span><br><span class="line"></span><br><span class="line">static &#123;</span><br><span class="line"><span class="code">  i = 0;</span></span><br><span class="line"><span class="code">  // do something</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"><span class="code">  // ä¹Ÿå¯ä»¥é€‰æ‹©åœ¨ æ„é€ å‡½æ•°ä¸­ åˆå§‹åŒ–</span></span><br><span class="line"><span class="code">  j = 0;</span></span><br><span class="line"><span class="code">  // do something</span></span><br><span class="line">&#125;</span><br><span class="line">----------------------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure><p><strong>æœ‰åºæ€§ï¼ˆOrderingï¼‰</strong>ï¼šJavaå†…å­˜æ¨¡å‹ çš„ æœ‰åºæ€§ åœ¨å‰é¢è®²è§£ volatile æ—¶ä¹Ÿè¯¦ç»†åœ°è®¨è®ºè¿‡äº†ï¼Œ<br>Javaç¨‹åº ä¸­  å¤©ç„¶çš„æœ‰åºæ€§ å¯ä»¥æ€»ç»“ä¸ºä¸€å¥è¯ï¼š</p><p>å¦‚æœåœ¨ æœ¬çº¿ç¨‹ å†…è§‚å¯Ÿï¼Œæ‰€æœ‰çš„æ“ä½œ éƒ½æ˜¯ æœ‰åºçš„ï¼›<br>å¦‚æœåœ¨ ä¸€ä¸ªçº¿ç¨‹ä¸­ è§‚å¯Ÿ å¦ä¸€ä¸ªçº¿ç¨‹ï¼Œæ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯ æ— åºçš„ã€‚</p><p>å‰åŠå¥æ˜¯æŒ‡ â€œçº¿ç¨‹å†… è¡¨ç°ä¸º ä¸²è¡Œçš„è¯­ä¹‰â€ï¼ˆWithin-Thread As-If-Serial Semanticsï¼‰ï¼Œ<br>ååŠå¥æ˜¯æŒ‡ â€œæŒ‡ä»¤é‡æ’åºâ€ç°è±¡å’Œ â€œå·¥ä½œå†…å­˜ä¸ä¸»å†…å­˜åŒæ­¥å»¶è¿Ÿâ€ç°è±¡ã€‚</p><p>Javaè¯­è¨€ æä¾›äº† volatileå’Œsynchronized ä¸¤ä¸ªå…³é”®å­— æ¥ ä¿è¯ çº¿ç¨‹ä¹‹é—´ æ“ä½œçš„ æœ‰åºæ€§ï¼Œ<br>volatileå…³é”®å­— æœ¬èº«å°±åŒ…å«äº† ç¦æ­¢æŒ‡ä»¤é‡æ’åº çš„è¯­ä¹‰ï¼Œ<br>è€Œ synchronized åˆ™æ˜¯ç”± â€œä¸€ä¸ªå˜é‡åœ¨åŒä¸€æ—¶åˆ»åªå…è®¸ä¸€æ¡çº¿ç¨‹ å¯¹å…¶è¿›è¡Œ lock æ“ä½œâ€è¿™æ¡è§„åˆ™è·å¾—çš„ï¼Œè¿™æ¡è§„åˆ™ å†³å®šäº† æŒæœ‰åŒä¸€ä¸ªé”çš„ä¸¤ä¸ªåŒæ­¥å— åªèƒ½ ä¸²è¡Œåœ°è¿›å…¥ï¼›</p><p>ä»‹ç»å®Œ å¹¶å‘ ä¸­ 3ç§ é‡è¦çš„ç‰¹æ€§åï¼Œè¯»è€…æœ‰æ²¡æœ‰å‘ç° synchronizedå…³é”®å­— åœ¨éœ€è¦è¿™3ç§ç‰¹æ€§çš„æ—¶å€™ éƒ½å¯ä»¥ä½œä¸ºå…¶ä¸­ä¸€ç§çš„ è§£å†³æ–¹æ¡ˆï¼Ÿ<br>çœ‹èµ·æ¥å¾ˆâ€œä¸‡èƒ½â€å§ã€‚<br>çš„ç¡®ï¼Œå¤§éƒ¨åˆ†çš„ å¹¶å‘æ§åˆ¶ æ“ä½œéƒ½èƒ½ä½¿ç”¨ synchronized æ¥å®Œæˆã€‚<br>synchronized çš„â€œä¸‡èƒ½â€ ä¹Ÿé—´æ¥é€ å°±äº† å®ƒè¢«ç¨‹åºå‘˜æ»¥ç”¨çš„ å±€é¢ï¼Œè¶Šâ€œä¸‡èƒ½â€çš„ å¹¶å‘æ§åˆ¶ï¼Œé€šå¸¸ä¼šä¼´éšç€è¶Šå¤§çš„ æ€§èƒ½å½±å“ï¼Œ<br>è¿™ç‚¹æˆ‘ä»¬å°†åœ¨ç¬¬13ç« è®²è§£ è™šæ‹Ÿæœºé”ä¼˜åŒ–æ—¶åœ¨ä»‹ç»ã€‚  </p><h5 id="å…ˆè¡Œå‘ç”ŸåŸåˆ™"><a href="#å…ˆè¡Œå‘ç”ŸåŸåˆ™" class="headerlink" title="å…ˆè¡Œå‘ç”ŸåŸåˆ™"></a>å…ˆè¡Œå‘ç”ŸåŸåˆ™</h5><p>å¦‚æœ Javaå†…å­˜æ¨¡å‹ ä¸­æ‰€æœ‰çš„ æœ‰åºæ€§ éƒ½ä»…ä»…ä¾é  volatile å’Œ synchronized æ¥å®Œæˆï¼Œé‚£ä¹ˆæœ‰ä¸€äº›æ“ä½œå°†ä¼šå˜å¾—å¾ˆ çƒ¦çï¼Œ<br>ä½†æ˜¯æˆ‘ä»¬åœ¨ç¼–å†™Javaå¹¶å‘ä»£ç çš„æ—¶å€™å¹¶æ²¡æœ‰æ„Ÿè§‰åˆ°è¿™ä¸€ç‚¹ï¼Œ<br>è¿™æ˜¯å› ä¸ºJavaè¯­è¨€ä¸­æœ‰ä¸€ä¸ª â€œå…ˆè¡Œå‘ç”Ÿâ€ï¼ˆhappens-beforeï¼‰ çš„ åŸåˆ™ã€‚<br>è¿™ä¸ªåŸåˆ™éå¸¸é‡è¦ï¼Œå®ƒæ˜¯ åˆ¤æ–­ æ•°æ®æ˜¯å¦ç«äº‰ã€çº¿ç¨‹æ˜¯å¦å®‰å…¨ çš„ ä¸»è¦ä¾æ®ï¼Œä¾é è¿™ä¸ªåŸåˆ™ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‡ æ¡è§„åˆ™ä¸€æ½å­åœ°è§£å†³ å¹¶å‘ç¯å¢ƒä¸‹ ä¸¤ä¸ªæ“ä½œä¹‹é—´æ˜¯å¦å¯èƒ½å­˜åœ¨å†²çªçš„æ‰€æœ‰é—®é¢˜ã€‚</p><p>ç°åœ¨å°±æ¥çœ‹çœ‹ â€œå…ˆè¡Œå‘ç”Ÿâ€åŸåˆ™ æŒ‡çš„æ˜¯ä»€ä¹ˆã€‚<br>å…ˆè¡Œå‘ç”Ÿ æ˜¯ Javaå†…å­˜æ¨¡å‹ ä¸­å®šä¹‰çš„ ä¸¤é¡¹æ“ä½œ ä¹‹é—´çš„ ååºå…³ç³»ï¼Œ<br>å¦‚æœè¯´ æ“ä½œA å…ˆè¡Œå‘ç”Ÿäº æ“ä½œBï¼Œå…¶å®å°±æ˜¯è¯´ å‘ç”Ÿåœ¨æ“ä½œB ä¹‹å‰ï¼Œæ“ä½œA äº§ç”Ÿçš„å½±å“ èƒ½è¢« æ“ä½œB è§‚å¯Ÿåˆ°ï¼Œâ€œå½±å“â€ åŒ…æ‹¬ ä¿®æ”¹äº†å†…å­˜ä¸­å…±äº«å˜é‡çš„å€¼ã€å‘é€äº†æ¶ˆæ¯ã€è°ƒç”¨äº†æ–¹æ³•ç­‰ã€‚<br>è¿™å¥è¯ä¸éš¾ç†è§£ï¼Œä½†å®ƒ æ„å‘³ç€ä»€ä¹ˆå‘¢ï¼Ÿ<br>æˆ‘ä»¬å¯ä»¥ä¸¾ä¸ªä¾‹å­æ¥è¯´æ˜ä¸€ä¸‹ï¼Œå¦‚ä»£ç æ¸…å•12-8ä¸­æ‰€ç¤ºçš„è¿™3å¥ä¼ªä»£ç ã€‚</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">                                ä»£ç æ¸…å• 12-8 å…ˆè¡Œå‘ç”ŸåŸåˆ™ç¤ºä¾‹1</span></span><br><span class="line">----------------------------------------------------------------------------------------------</span><br><span class="line"><span class="comment">// ä»¥ä¸‹æ“ä½œåœ¨ çº¿ç¨‹A ä¸­æ‰§è¡Œ</span></span><br><span class="line">i = 1;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»¥ä¸‹æ“ä½œåœ¨ çº¿ç¨‹B ä¸­æ‰§è¡Œ</span></span><br><span class="line">j = i;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»¥ä¸‹æ“ä½œåœ¨ çº¿ç¨‹C ä¸­æ‰§è¡Œ</span></span><br><span class="line">i = 2;</span><br><span class="line">----------------------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure><p>å‡è®¾ çº¿ç¨‹A ä¸­çš„æ“ä½œ â€œi=1;â€ å…ˆè¡Œå‘ç”Ÿäº çº¿ç¨‹B çš„æ“ä½œâ€œj=iâ€œ ï¼Œ<br>é‚£ä¹ˆå¯ä»¥ç¡®å®šåœ¨ çº¿ç¨‹B çš„æ“ä½œæ‰§è¡Œåï¼Œå˜é‡jçš„å€¼ä¸€å®šç­‰äº1ï¼Œ<br>å¾—å‡ºè¿™ä¸ªç»“è®ºçš„ä¾æ®æœ‰ä¸¤ä¸ªï¼š<br>ä¸€æ˜¯æ ¹æ® å…ˆè¡Œå‘ç”ŸåŸåˆ™ï¼Œ â€œi=1â€çš„ç»“æœå¯ä»¥è¢«è§‚å¯Ÿåˆ°ï¼›<br>äºŒæ˜¯ çº¿ç¨‹C è¿˜æ²¡â€œç™»åœºâ€ï¼Œ çº¿ç¨‹A æ“ä½œç»“æŸä¹‹åæ²¡æœ‰å…¶ä»–çº¿ç¨‹ ä¼šä¿®æ”¹å˜é‡içš„å€¼ã€‚</p><p>ç°åœ¨å†æ¥è€ƒè™‘ çº¿ç¨‹Cï¼Œæˆ‘ä»¬ä¾ç„¶ä¿æŒ çº¿ç¨‹A å’Œ çº¿ç¨‹B ä¹‹é—´çš„ å…ˆè¡Œå‘ç”Ÿå…³ç³»ï¼Œ<br>è€Œ çº¿ç¨‹C å‡ºç°åœ¨ çº¿ç¨‹A å’Œ çº¿ç¨‹B çš„æ“ä½œä¹‹é—´ï¼Œ<br>ä½†æ˜¯ çº¿ç¨‹C ä¸ çº¿ç¨‹B æ²¡æœ‰ å…ˆè¡Œå‘ç”Ÿå…³ç³»ï¼Œ<br>é‚£ j çš„å€¼ä¼šæ˜¯å¤šå°‘å‘¢?</p><p>ç­”æ¡ˆæ˜¯ä¸ç¡®å®šï¼<br>1å’Œ2éƒ½æœ‰å¯èƒ½ï¼Œå› ä¸º çº¿ç¨‹C å¯¹ å˜é‡i çš„å½±å“ å¯èƒ½ä¼šè¢« çº¿ç¨‹B è§‚å¯Ÿåˆ°ï¼Œ<br>ä¹Ÿå¯èƒ½ä¸ä¼šï¼Œ è¿™æ—¶å€™ çº¿ç¨‹B å°±å­˜åœ¨ è¯»å–åˆ° è¿‡æœŸæ•°æ®çš„é£é™©ï¼Œä¸å…·å¤‡ çº¿ç¨‹å®‰å…¨æ€§ã€‚</p><p>ä¸‹é¢æ˜¯ Javaå†…å­˜æ¨¡å‹ ä¸‹ä¸€äº›â€œå¤©ç„¶çš„â€å…ˆè¡Œå‘ç”Ÿå…³ç³»ï¼Œ<br>è¿™äº› å…ˆè¡Œå‘ç”Ÿå…³ç³» æ— éœ€ä»»ä½• åŒæ­¥å™¨ ååŠ©ï¼Œå¯ä»¥åœ¨ç¼–ç ä¸­ç›´æ¥ä½¿ç”¨ã€‚</p><p>å¦‚æœ ä¸¤ä¸ªæ“ä½œ ä¹‹é—´çš„å…³ç³»ä¸åœ¨æ­¤åˆ—ï¼Œå¹¶ä¸”æ— æ³•ä»ä¸‹åˆ—è§„åˆ™æ¨å¯¼å‡ºæ¥çš„è¯ï¼Œå®ƒä»¬å°± æ²¡æœ‰é¡ºåºæ€§ä¿éšœï¼Œè™šæ‹Ÿæœº å¯ä»¥å¯¹å®ƒä»¬ éšæ„åœ° è¿›è¡Œ é‡æ’åºã€‚</p><p><strong>ç¨‹åºæ¬¡åºè§„åˆ™ï¼ˆProgram Order Ruleï¼‰</strong>ï¼š<br>åœ¨ ä¸€ä¸ªçº¿ç¨‹ å†…ï¼ŒæŒ‰ç…§ ç¨‹åºä»£ç  é¡ºåºï¼Œä¹¦å†™åœ¨å‰é¢çš„æ“ä½œ å…ˆè¡Œå‘ç”Ÿäº ä¹¦å†™åœ¨åé¢çš„æ“ä½œã€‚<br>å‡†ç¡®åœ°è¯´ï¼Œåº”è¯¥æ˜¯ æ§åˆ¶æµé¡ºåº è€Œä¸æ˜¯ ç¨‹åºä»£ç é¡ºåºï¼Œ åº”ä¸ºè¦è€ƒè™‘ åˆ†æ”¯ã€å¾ªç¯ ç­‰ç»“æ„ã€‚</p><p><strong>*ç®¡ç¨‹é”å®šè§„åˆ™ï¼ˆMonitor Lock Ruleï¼‰</strong>ï¼š<br>ä¸€ä¸ª unlockæ“ä½œ å…ˆè¡Œå‘ç”Ÿäº åé¢å¯¹ åŒä¸€ä¸ªé” çš„ lockæ“ä½œã€‚<br>è¿™é‡Œå¿…é¡»å¼ºè°ƒçš„æ˜¯ åŒä¸€ä¸ªé”ï¼Œè€Œ â€œåé¢â€ æ˜¯æŒ‡ æ—¶é—´ä¸Šçš„å…ˆåé¡ºåºã€‚</p><p><strong>volatile å˜é‡è§„åˆ™ï¼ˆVolatile Variable Ruleï¼‰</strong>ï¼š<br>å¯¹ ä¸€ä¸ª volatileå˜é‡ çš„ å†™æ“ä½œ å…ˆè¡Œå‘ç”Ÿäº åé¢å¯¹è¿™ä¸ªå˜é‡çš„ è¯»æ“ä½œï¼Œ<br>è¿™é‡Œçš„ â€œåé¢â€åŒæ ·æ˜¯æŒ‡ æ—¶é—´ä¸Šçš„å…ˆåé¡ºåºã€‚</p><p><strong>çº¿ç¨‹å¯åŠ¨è§„åˆ™ï¼ˆThread Start Ruleï¼‰</strong>ï¼š<br>Thread å¯¹è±¡çš„ start() æ–¹æ³• å…ˆè¡Œå‘ç”Ÿäº æ­¤çº¿ç¨‹çš„æ¯ä¸€ä¸ªåŠ¨ä½œã€‚</p><p><strong>çº¿ç¨‹ç»ˆæ­¢è§„åˆ™ï¼ˆThread Termination Ruleï¼‰</strong>ï¼š<br>çº¿ç¨‹ ä¸­çš„ æ‰€æœ‰æ“ä½œ éƒ½ å…ˆè¡Œå‘ç”Ÿäº å¯¹æ­¤çº¿ç¨‹çš„ ç»ˆæ­¢æ£€æµ‹ï¼Œ<br>æˆ‘ä»¬å¯ä»¥é€šè¿‡ Thread.join()æ–¹æ³•ç»“æŸã€Thread.isAlive()çš„è¿”å›å€¼ ç­‰æ‰‹æ®µ æ£€æµ‹åˆ° çº¿ç¨‹å·²ç»ç»ˆæ­¢æ‰§è¡Œã€‚</p><p><strong>çº¿ç¨‹ä¸­æ–­è§„åˆ™ï¼ˆThread Interruption Ruleï¼‰</strong>ï¼š<br>å¯¹ çº¿ç¨‹ interrupt() æ–¹æ³•çš„è°ƒç”¨ å…ˆè¡Œå‘ç”Ÿäº è¢« ä¸­æ–­çº¿ç¨‹çš„ä»£ç  æ£€æµ‹åˆ° ä¸­æ–­äº‹ä»¶ çš„å‘ç”Ÿï¼Œå¯ä»¥é€šè¿‡ Thread.interrupted()æ–¹æ³• æ£€æµ‹åˆ° æ˜¯å¦æœ‰ä¸­æ–­å‘ç”Ÿã€‚</p><p><strong>å¯¹è±¡ç»ˆç»“è§„åˆ™ï¼ˆFinalizer Ruleï¼‰</strong>:<br>ä¸€ä¸ªå¯¹è±¡çš„ åˆå§‹åŒ– å®Œæˆï¼ˆæ„é€ å‡½æ•°æ‰§è¡Œç»“æŸï¼‰ å…ˆè¡Œå‘ç”Ÿäº å®ƒçš„ finalize() æ–¹æ³•çš„å¼€å§‹ã€‚</p><p><strong>ä¼ é€’æ€§ï¼ˆTransitivityï¼‰</strong>:<br>å¦‚æœ æ“ä½œA å…ˆè¡Œå‘ç”Ÿäº æ“ä½œBï¼Œæ“ä½œB å…ˆè¡Œå‘ç”Ÿäº æ“ä½œCï¼Œé‚£å°±å¯ä»¥å¾—å‡º æ“ä½œA å…ˆè¡Œå‘ç”Ÿäº æ“ä½œC çš„ç»“è®ºã€‚</p><p>Javaè¯­è¨€ æ— é¡» ä»»ä½•åŒæ­¥æ‰‹æ®µä¿éšœ å°±èƒ½æˆç«‹çš„ å…ˆè¡Œå‘ç”Ÿè§„åˆ™ å°±åªæœ‰ä¸Šé¢è¿™äº›äº†ï¼Œ<br>ç¬”è€…æ¼”ç¤ºä¸€ä¸‹ å¦‚ä½•ä½¿ç”¨è¿™äº›è§„åˆ™å»åˆ¤å®š æ“ä½œé—´æ˜¯å¦å…·å¤‡é¡ºåºæ€§ï¼Œ<br>å¯¹äº è¯»å†™å…±äº«å˜é‡ çš„æ“ä½œæ¥è¯´ï¼Œå°±æ˜¯ çº¿ç¨‹æ˜¯å¦å®‰å…¨ï¼Œ<br>è¯»è€…è¿˜å¯ä»¥ä»ä¸‹é¢è¿™ä¸ªä¾‹å­ä¸­æ„Ÿå—ä¸€ä¸‹ â€œæ—¶é—´ä¸Šçš„å…ˆåé¡ºåºâ€ ä¸ â€œå…ˆè¡Œå‘ç”Ÿâ€ ä¹‹é—´æœ‰ä»€ä¹ˆä¸åŒã€‚<br>æ¼”ç¤ºä¾‹å­å¦‚ä»£ç æ¸…å•12-9æ‰€ç¤ºã€‚</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">                                ä»£ç æ¸…å• 12-9 å…ˆè¡Œå‘ç”ŸåŸåˆ™ç¤ºä¾‹2</span></span><br><span class="line">----------------------------------------------------------------------------------------------</span><br><span class="line">private int  value = 0;</span><br><span class="line"></span><br><span class="line">public void setValue(int value)&#123;</span><br><span class="line"><span class="code">  this.value=value;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public int getValue()&#123;</span><br><span class="line"><span class="code">  return value;</span></span><br><span class="line">&#125;</span><br><span class="line">----------------------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure><p>ä»£ç æ¸…å•12-9ä¸­æ˜¾ç¤ºçš„æ˜¯ä¸€ç»„å†æ™®é€šä¸è¿‡çš„ getter/setter æ–¹æ³•ï¼Œ<br>å‡è®¾å­˜åœ¨ çº¿ç¨‹Aå’ŒBï¼Œ çº¿ç¨‹Aå…ˆï¼ˆæ—¶é—´ä¸Šçš„å…ˆåï¼‰è°ƒç”¨äº† â€œsetValueâ€ï¼Œ<br>ç„¶å çº¿ç¨‹B è°ƒç”¨äº† åŒä¸€ä¸ªå¯¹è±¡ çš„â€œgetValue()â€ï¼Œé‚£ä¹ˆ çº¿ç¨‹B æ”¶åˆ°çš„è¿”å›å€¼ æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>æˆ‘ä»¬ä¾æ¬¡åˆ†æä¸€ä¸‹ å…ˆè¡Œå‘ç”ŸåŸåˆ™ ä¸­çš„å„é¡¹è§„åˆ™ï¼Œ<br>ç”±äº ä¸¤ä¸ªæ–¹æ³• åˆ†åˆ«ç”± çº¿ç¨‹Aå’Œçº¿ç¨‹B è°ƒç”¨ï¼Œä¸åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­ï¼Œæ‰€ä»¥ ç¨‹åºæ¬¡åºè§„åˆ™ åœ¨è¿™é‡Œä¸é€‚ç”¨ï¼›</p><p>ç”±äº æ²¡æœ‰åŒæ­¥å—ï¼Œè‡ªç„¶å°±ä¸ä¼šå‘ç”Ÿ lockå’Œunlock æ“ä½œï¼Œæ‰€ä»¥ ç®¡ç¨‹é”å®šè§„åˆ™ ä¸é€‚ç”¨ï¼›</p><p>ç”±äº valueå˜é‡ æ²¡æœ‰è¢« volatileå…³é”®å­— ä¿®é¥°ï¼Œæ‰€ä»¥ volatileå˜é‡è§„åˆ™ ä¸é€‚ç”¨ï¼›</p><p>åé¢çš„ çº¿ç¨‹å¯åŠ¨ã€ç»ˆæ­¢ã€ä¸­æ–­è§„åˆ™å’Œå¯¹è±¡ç»ˆç»“è§„åˆ™ ä¹Ÿå’Œè¿™é‡Œå®Œå…¨æ²¡æœ‰å…³ç³»ã€‚</p><p>å› ä¸º æ²¡æœ‰ä¸€ä¸ªé€‚ç”¨çš„ å…ˆè¡Œå‘ç”ŸåŸåˆ™ï¼Œæ‰€ä»¥æœ€åä¸€æ¡ ä¼ é€’æ€§ ä¹Ÿæ— ä»è°ˆèµ·ï¼Œ</p><p>å› æ­¤æˆ‘ä»¬å¯ä»¥åˆ¤å®šå°½ç®¡ çº¿ç¨‹A åœ¨æ“ä½œæ—¶é—´ä¸Š å…ˆäº çº¿ç¨‹Bï¼Œä½†æ˜¯æ— æ³•ç¡®å®š çº¿ç¨‹B ä¸­â€œgetValue()â€æ–¹æ³•è¿”å›çš„ç»“æœï¼Œ<br>æ¢å¥è¯è¯´ï¼Œè¿™é‡Œé¢çš„æ“ä½œä¸æ˜¯ çº¿ç¨‹å®‰å…¨çš„ã€‚</p><p>é‚£æ€ä¹ˆä¿®å¤è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬è‡³å°‘æœ‰ä¸¤ç§æ¯”è¾ƒç®€å•çš„æ–¹æ¡ˆå¯ä»¥é€‰æ‹©ï¼š<br>è¦ä¹ˆæŠŠ getter/setter æ–¹æ³•éƒ½å®šä¹‰ä¸º synchronized æ–¹æ³•ï¼Œè¿™æ ·å°±å¯ä»¥ç”°å‹‡ ç®¡ç¨‹é”å®šè§„åˆ™ï¼›</p><p>è¦ä¹ˆæŠŠ value å®šä¹‰ä¸º volatileå˜é‡ï¼Œç”±äº setteræ–¹æ³• å¯¹ valueçš„ä¿®æ”¹ ä¸ä¾èµ– valueçš„åŸå€¼ï¼Œæ»¡è¶³ volatileå…³é”®å­—ä½¿ç”¨åœºæ™¯ï¼Œ<br>è¿™æ ·å°±å¯ä»¥ å¥—ç”¨volatileå˜é‡è§„åˆ™ æ¥å®ç° å…ˆè¡Œå‘ç”Ÿå…³ç³»ã€‚</p><p>é€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼š<br>ä¸€ä¸ªæ“ä½œ â€œæ—¶é—´ä¸Šçš„å…ˆå‘ç”Ÿâ€ ä¸ä»£è¡¨è¿™ä¸ªæ“ä½œ ä¼šæ˜¯ â€œå…ˆè¡Œå‘ç”Ÿâ€ï¼Œ<br>é‚£å¦‚æœ ä¸€ä¸ªæ“ä½œ â€œå…ˆè¡Œå‘ç”Ÿâ€ æ˜¯å¦å°±èƒ½æ¨å¯¼ è¿™ä¸ªæ“ä½œ å¿…å®šæ˜¯ â€œæ—¶é—´ä¸Šçš„å…ˆå‘ç”Ÿâ€ å‘¢ï¼Ÿ</p><p>å¾ˆé—æ†¾ï¼Œè¿™ä¸ªæ¨è®ºä¹Ÿæ˜¯ä¸æˆç«‹çš„ï¼Œä¸€ä¸ªå…¸å‹çš„ä¾‹å­å°±æ˜¯å¤šæ¬¡æåˆ°çš„ â€œæŒ‡ä»¤é‡æ’åºâ€ï¼Œ<br>æ¼”ç¤ºä¾‹å­å¦‚ä»£ç æ¸…å•12-10æ‰€ç¤ºã€‚</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">                                ä»£ç æ¸…å• 12-10 å…ˆè¡Œå‘ç”ŸåŸåˆ™ç¤ºä¾‹3</span></span><br><span class="line">----------------------------------------------------------------------------------------------</span><br><span class="line"><span class="comment">// ä»¥ä¸‹æ“ä½œåœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œ</span></span><br><span class="line">int i = 1;</span><br><span class="line">int j = 2;</span><br><span class="line">----------------------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure><p>ä»£ç æ¸…å•12-10çš„ ä¸¤æ¡èµ‹å€¼è¯­å¥ åœ¨ åŒä¸€ä¸ªçº¿ç¨‹ ä¹‹ä¸­ï¼Œ<br>æ ¹æ® ç¨‹åºæ¬¡åºè§„åˆ™ï¼Œ â€œint i=1â€ çš„æ“ä½œ å…ˆè¡Œå‘ç”Ÿäº â€œint j=2â€ï¼Œ<br>ä½†æ˜¯ â€œint j=2â€çš„ä»£ç å®Œå…¨å¯èƒ½å…ˆè¢« å¤„ç†å™¨ æ‰§è¡Œï¼Œè¿™å¹¶ä¸å½±å“ å…ˆè¡Œå‘ç”ŸåŸåˆ™çš„æ­£ç¡®æ€§ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨ è¿™æ¡çº¿ç¨‹ ä¹‹ä¸­æ²¡æœ‰åŠæ³•æ„ŸçŸ¥åˆ°è¿™ç‚¹ã€‚</p><p>ä¸Šé¢ä¸¤ä¸ªä¾‹å­ç»¼åˆèµ·æ¥è¯æ˜äº†ä¸€ä¸ªç»“è®ºï¼šæ—¶é—´å…ˆåé¡ºåº ä¸ å…ˆè¡Œå‘ç”ŸåŸåˆ™ ä¹‹é—´åŸºæœ¬æ²¡æœ‰å¤ªå¤§çš„å…³ç³»ï¼Œæ‰€ä»¥æˆ‘ä»¬è¡¡é‡ å¹¶å‘å®‰å…¨é—®é¢˜ çš„æ—¶å€™ä¸è¦å—åˆ° æ—¶é—´é¡ºåºçš„å¹²æ‰°ï¼Œä¸€åˆ‡å¿…é¡»ä»¥ å…ˆè¡Œå‘ç”ŸåŸåˆ™ ä¸ºå‡†ã€‚</p><h4 id="Javaä¸çº¿ç¨‹"><a href="#Javaä¸çº¿ç¨‹" class="headerlink" title="Javaä¸çº¿ç¨‹"></a>Javaä¸çº¿ç¨‹</h4><p>å¹¶å‘ ä¸ä¸€å®šè¦ ä¾èµ– å¤šçº¿ç¨‹ï¼ˆå¦‚PHPä¸­å¾ˆå¸¸è§çš„ å¤šè¿›ç¨‹å¹¶å‘ï¼‰ï¼Œ<br>ä½†æ˜¯åœ¨Javaé‡Œé¢è°ˆè®º å¹¶å‘ï¼Œå¤§å¤šæ•°éƒ½ä¸ çº¿ç¨‹ è„±ä¸å¼€å…³ç³»ã€‚</p><p>æ—¢ç„¶æˆ‘ä»¬è¿™æœ¬ä¹¦æ¢è®¨çš„è¯é¢˜æ˜¯ Javaè™šæ‹Ÿæœºçš„ç‰¹æ€§ï¼Œé‚£è®²åˆ° Javaçº¿ç¨‹ï¼Œæˆ‘ä»¬å°±ä» Javaçº¿ç¨‹ åœ¨ è™šæ‹Ÿæœºä¸­çš„å®ç° å¼€å§‹è®²èµ·ã€‚</p><h5 id="çº¿ç¨‹çš„å®ç°"><a href="#çº¿ç¨‹çš„å®ç°" class="headerlink" title="çº¿ç¨‹çš„å®ç°"></a>çº¿ç¨‹çš„å®ç°</h5><p>æˆ‘ä»¬çŸ¥é“ï¼Œçº¿ç¨‹ æ˜¯æ¯” è¿›ç¨‹ æ›´è½»é‡çº§ çš„ è°ƒåº¦æ‰§è¡Œå•ä½ï¼Œ<br>çº¿ç¨‹çš„å¼•å…¥ ï¼Œå¯ä»¥æŠŠ ä¸€ä¸ªè¿›ç¨‹çš„ èµ„æºåˆ†é… å’Œ æ‰§è¡Œè°ƒåº¦ åˆ†å¼€ï¼Œå„ä¸ªçº¿ç¨‹ æ—¢å¯ä»¥ å…±äº«è¿›ç¨‹èµ„æºï¼ˆå†…å­˜åœ°å€ã€æ–‡ä»¶I/Oç­‰ï¼‰ï¼Œåˆå¯ä»¥ç‹¬ç«‹è°ƒåº¦ï¼ˆçº¿ç¨‹ æ˜¯ CPU è°ƒåº¦ çš„ åŸºæœ¬å•ä½ï¼‰ã€‚</p><p>ä¸»æµçš„ æ“ä½œç³»ç»Ÿ éƒ½æä¾›äº† çº¿ç¨‹å®ç°ï¼ŒJavaè¯­è¨€åˆ™æä¾›äº† åœ¨ä¸åŒç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿå¹³å°ä¸‹ å¯¹çº¿ç¨‹æ“ä½œçš„ç»Ÿä¸€å¤„ç†ï¼Œ<br>æ¯ä¸ªå·²ç»æ‰§è¡Œ start()ä¸”è¿˜æœªç»“æŸçš„ java.lang.Threadç±»çš„å®ä¾‹ï¼Œå°±ä»£è¡¨äº† ä¸€ä¸ªçº¿ç¨‹ã€‚</p><p>æˆ‘ä»¬æ³¨æ„åˆ° Threadç±»ä¸å¤§éƒ¨åˆ†çš„ Java API æœ‰æ˜¾è‘—çš„åŒºåˆ«ï¼Œ<br>ä»–çš„æ‰€æœ‰å…³é”®æ–¹æ³•éƒ½æ˜¯ å£°æ˜ä¸ºNativeçš„ã€‚</p><p>åœ¨ Java APIä¸­ï¼Œä¸€ä¸ª Native æ–¹æ³• å¾€å¾€æ„å‘³ç€ è¿™ä¸ªæ–¹æ³•æ²¡æœ‰ä½¿ç”¨ æˆ– æ— æ³•ä½¿ç”¨ å¹³å°æ— å…³çš„æ‰‹æ®µæ¥å®ç°ï¼ˆå½“ç„¶ä¹Ÿå¯èƒ½æ˜¯ä¸ºäº† æ‰§è¡Œæ•ˆç‡ è€Œä½¿ç”¨ Native æ–¹æ³•ï¼Œ ä¸è¿‡ï¼Œé€šå¸¸ æœ€é«˜æ•ˆç‡çš„æ‰‹æ®µ ä¹Ÿå°±æ˜¯ å¹³å°ç›¸å…³çš„æ‰‹æ®µï¼‰ã€‚</p><p>æ­£å› ä¸ºå¦‚æ­¤ï¼Œä½œè€…æŠŠæœ¬èŠ‚çš„æ ‡é¢˜å®šä¸º â€œçº¿ç¨‹çš„å®ç°â€ è€Œä¸æ˜¯ â€œJavaçº¿ç¨‹çš„å®ç°â€ã€‚</p><p>å®ç°çº¿ç¨‹ ä¸»è¦æœ‰3ä¸­æ–¹å¼ï¼š<br>ä½¿ç”¨ å†…æ ¸çº¿ç¨‹ å®ç°ã€<br>ä½¿ç”¨ ç”¨æˆ·çº¿ç¨‹ å®ç°<br>å’Œä½¿ç”¨ ç”¨æˆ·çº¿ç¨‹ åŠ  è½»é‡çº§è¿›ç¨‹ æ··åˆå®ç°ã€‚</p><h6 id="1-ä½¿ç”¨å†…æ ¸çº¿ç¨‹å®ç°"><a href="#1-ä½¿ç”¨å†…æ ¸çº¿ç¨‹å®ç°" class="headerlink" title="1.ä½¿ç”¨å†…æ ¸çº¿ç¨‹å®ç°"></a>1.ä½¿ç”¨å†…æ ¸çº¿ç¨‹å®ç°</h6><p>å†…æ ¸çº¿ç¨‹ ï¼ˆKernel-Level Threadï¼ŒKLTï¼‰ å°±æ˜¯ç›´æ¥ç”± æ“ä½œç³»ç»Ÿå†…æ ¸ï¼ˆKernelï¼Œä¸‹ç§°å†…æ ¸ï¼‰æ”¯æŒçš„çº¿ç¨‹ï¼Œ<br>è¿™ç§çº¿ç¨‹ ç”± å†…æ ¸ æ¥å®Œæˆ çº¿ç¨‹åˆ‡æ¢ï¼Œ<br>å†…æ ¸ é€šè¿‡æ“çºµ è°ƒåº¦å™¨ï¼ˆSchedulerï¼‰å¯¹ çº¿ç¨‹ è¿›è¡Œ è°ƒåº¦ ï¼Œ<br>å¹¶è´Ÿè´£å°† çº¿ç¨‹çš„ä»»åŠ¡ æ˜ å°„åˆ°å„ä¸ª å¤„ç†å™¨ ä¸Šã€‚</p><p>æ¯ä¸ª å†…æ ¸çº¿ç¨‹ å¯ä»¥è§†ä¸º å†…æ ¸ çš„ä¸€ä¸ªåˆ†èº«ï¼Œ<br>è¿™æ · æ“ä½œç³»ç»Ÿ å°±æœ‰èƒ½åŠ› åŒæ—¶å¤„ç†å¤šä»¶äº‹æƒ…ï¼Œæ”¯æŒå¤šçº¿ç¨‹ çš„ å†…æ ¸ å°±å«åš å¤šçº¿ç¨‹å†…æ ¸ï¼ˆMulti-Threads Kernelï¼‰ã€‚</p><p>ç¨‹åº ä¸€èˆ¬ä¸ä¼šç›´æ¥å»ä½¿ç”¨ å†…æ ¸çº¿ç¨‹ï¼Œè€Œæ˜¯å»ä½¿ç”¨ å†…æ ¸çº¿ç¨‹ çš„ä¸€ç§é«˜çº§æ¥å£â€”-è½»é‡çº§è¿›ç¨‹ï¼ˆLight Weight Processï¼ŒLWPï¼‰ï¼Œ<br>è½»é‡çº§è¿›ç¨‹ å°±æ˜¯æˆ‘ä»¬é€šå¸¸æ„ä¹‰ä¸Šæ‰€è®²çš„ çº¿ç¨‹ï¼Œ<br>ç”±äº æ¯ä¸ªè½»é‡çº§è¿›ç¨‹ éƒ½æœ‰ä¸€ä¸ª å†…æ ¸çº¿ç¨‹ æ”¯æŒï¼Œå› æ­¤åªæœ‰å…ˆæ”¯æŒ å†…æ ¸çº¿ç¨‹ï¼Œæ‰èƒ½æœ‰ è½»é‡çº§è¿›ç¨‹ã€‚</p><p>è¿™ç§ è½»é‡çº§è¿›ç¨‹ ä¸ å†…æ ¸çº¿ç¨‹ ä¹‹é—´ 1:1çš„å…³ç³» ç§°ä¸º ä¸€å¯¹ä¸€çš„çº¿ç¨‹æ¨¡å‹ï¼Œå¦‚å›¾12-3æ‰€ç¤ºã€‚</p><p>ï¼ˆå®æ´»å®è¯´ï¼Œè¿™ä¸ªå›¾å¤ªéš¾äº†ğŸ™ƒğŸ™ƒğŸ™ƒæˆ‘ç”»ä¸å‡ºğŸ™ƒğŸ™ƒğŸ™ƒï¼‰</p><p>ç”±äº å†…æ ¸çº¿ç¨‹ çš„æ”¯æŒï¼Œæ¯ä¸ª è½»é‡çº§è¿›ç¨‹ éƒ½æˆä¸ºä¸€ä¸ª ç‹¬ç«‹çš„ è°ƒåº¦å•å…ƒï¼Œ<br>å³ä½¿æœ‰ä¸€ä¸ª è½»é‡çº§è¿›ç¨‹ åœ¨ç³»ç»Ÿè°ƒç”¨ä¸­ é˜»å¡äº†ï¼Œä¹Ÿä¸ä¼šå½±å“ æ•´ä¸ªè¿›ç¨‹ç»§ç»­å·¥ä½œï¼Œ<br>ä½†æ˜¯ è½»é‡çº§è¿›ç¨‹ å…·æœ‰å®ƒçš„å±€é™æ€§ï¼š<br>é¦–å…ˆï¼Œç”±äºæ˜¯åŸºäº å†…æ ¸çº¿ç¨‹ å®ç°çš„ï¼Œæ‰€ä»¥å„ç§çº¿ç¨‹æ“ä½œï¼Œå¦‚ åˆ›å»ºã€ææ„åŠåŒæ­¥ï¼Œéƒ½éœ€è¦è¿›è¡Œ ç³»ç»Ÿè°ƒç”¨ã€‚<br>è€Œç³»ç»Ÿè°ƒç”¨çš„ä»£ä»·ç›¸å¯¹è¾ƒé«˜ï¼Œéœ€è¦åœ¨ ç”¨æˆ·æ€ï¼ˆUser Modeï¼‰å’Œå†…æ ¸æ€ï¼ˆKernel Modeï¼‰ ä¸­ æ¥å›åˆ‡æ¢ã€‚<br>å…¶æ¬¡ï¼Œæ¯ä¸ªè½»é‡çº§è¿›ç¨‹ éƒ½éœ€è¦æœ‰ä¸€ä¸ª å†…æ ¸çº¿ç¨‹ çš„æ”¯æŒï¼Œå› æ­¤ è½»é‡çº§è¿›ç¨‹ è¦æ¶ˆè€—ä¸€å®šçš„ å†…æ ¸èµ„æºï¼ˆå¦‚ å†…æ ¸çº¿ç¨‹ çš„ æ ˆç©ºé—´ï¼‰ï¼Œ<br>å› æ­¤ ä¸€ä¸ªç³»ç»Ÿ æ”¯æŒè½»é‡çº§è¿›ç¨‹ çš„ æ•°é‡ æ˜¯æœ‰é™çš„ã€‚</p><h6 id="2-ä½¿ç”¨ç”¨æˆ·çº¿ç¨‹å®ç°"><a href="#2-ä½¿ç”¨ç”¨æˆ·çº¿ç¨‹å®ç°" class="headerlink" title="2.ä½¿ç”¨ç”¨æˆ·çº¿ç¨‹å®ç°"></a>2.ä½¿ç”¨ç”¨æˆ·çº¿ç¨‹å®ç°</h6><p>ä» å¹¿ä¹‰ ä¸Šæ¥è®²ï¼Œä¸€ä¸ªçº¿ç¨‹ åªè¦ä¸æ˜¯ å†…æ ¸çº¿ç¨‹ï¼Œå°±å¯ä»¥è®¤ä¸ºæ˜¯ ç”¨æˆ·çº¿ç¨‹ï¼ˆUser Threadï¼ŒUTï¼‰ï¼Œ<br>å› æ­¤ï¼Œä»è¿™ä¸ªå®šä¹‰ä¸Šæ¥è®²ï¼Œè½»é‡çº§è¿›ç¨‹ ä¹Ÿå±äº ç”¨æˆ·çº¿ç¨‹ï¼Œä½† è½»é‡çº§è¿›ç¨‹ çš„å®ç° å§‹ç»ˆæ˜¯å»ºç«‹åœ¨ å†…æ ¸ä¹‹ä¸Šçš„ï¼Œè®¸å¤šæ“ä½œéƒ½è¦è¿›è¡Œ ç³»ç»Ÿè°ƒç”¨ï¼Œæ•ˆç‡ä¼šå—åˆ°é™åˆ¶ã€‚</p><p>è€Œ ç‹­ä¹‰çš„ ç”¨æˆ·çº¿ç¨‹ æŒ‡çš„æ˜¯ å®Œå…¨å»ºç«‹åœ¨ ç”¨æˆ·ç©ºé—´çš„ çº¿ç¨‹åº“ ä¸Šï¼Œç³»ç»Ÿå†…æ ¸ ä¸èƒ½æ„ŸçŸ¥ çº¿ç¨‹å­˜åœ¨çš„å®ç°ã€‚</p><p>ç”¨æˆ·çº¿ç¨‹ çš„ å»ºç«‹ã€åŒæ­¥ã€é”€æ¯å’Œè°ƒåº¦ å®Œå…¨åœ¨ ç”¨æˆ·æ€ ä¸­å®Œæˆï¼Œä¸éœ€è¦ å†…æ ¸çš„å¸®åŠ©ã€‚</p><p>å¦‚æœç¨‹åº å®ç°å¾—å½“ï¼Œè¿™ç§çº¿ç¨‹ ä¸éœ€è¦åˆ‡æ¢åˆ° å†…æ ¸æ€ï¼Œå› æ­¤æ“ä½œ å¯ä»¥ä½¿ éå¸¸å¿«é€Ÿä¸”ä½æ¶ˆè€—çš„ï¼Œ<br>ä¹Ÿå¯ä»¥æ”¯æŒè§„æ¨¡æ›´å¤§çš„çº¿ç¨‹æ•°é‡ï¼Œéƒ¨åˆ†é«˜æ€§èƒ½ æ•°æ®åº“ä¸­çš„å¤šçº¿ç¨‹ å°±æ˜¯ç”± ç”¨æˆ·çº¿ç¨‹ å®ç°çš„ã€‚<br>è¿™ç§ è¿›ç¨‹ ä¸ ç”¨æˆ·çº¿ç¨‹ ä¹‹é—´ 1:N çš„å…³ç³» ç§°ä¸º ä¸€å¯¹å¤šçš„çº¿ç¨‹æ¨¡å‹ï¼Œå¦‚å›¾12-4æ‰€ç¤ºã€‚</p><p>ï¼ˆä¸ç”»å›¾äº†è‡ªå·±å»ä¹°ä¹¦çœ‹çœ‹ğŸ™ƒğŸ™ƒğŸ™ƒï¼‰</p><p>ä½¿ç”¨ ç”¨æˆ·çº¿ç¨‹ çš„ ä¼˜åŠ¿ åœ¨äº ä¸éœ€è¦ç³»ç»Ÿå†…æ ¸æ”¯æ´ï¼ŒåŠ£åŠ¿ ä¹Ÿåœ¨äº æ²¡æœ‰ç³»ç»Ÿå†…æ ¸çš„æ”¯æ´ï¼Œæ‰€æœ‰çš„ çº¿ç¨‹æ“ä½œ éƒ½éœ€è¦ ç”¨æˆ·ç¨‹åº è‡ªå·±å¤„ç†ã€‚</p><p>çº¿ç¨‹çš„ åˆ›å»ºã€åˆ‡æ¢å’Œè°ƒåº¦ éƒ½æ˜¯éœ€è¦è€ƒè™‘çš„é—®é¢˜ï¼Œè€Œä¸”ç”±äº æ“ä½œç³»ç»Ÿ åªæŠŠ å¤„ç†å™¨èµ„æº åˆ†é…åˆ° è¿›ç¨‹ï¼Œ<br>é‚£è¯¸å¦‚ â€œé˜»å¡å¦‚ä½•å¤„ç†â€ã€â€˜å¤šå¤„ç†å™¨ç³»ç»Ÿä¸­å¦‚ä½•å°†çº¿ç¨‹æ˜ å°„åˆ°å…¶ä»–å¤„ç†å™¨ä¸Šâ€œè¿™ç±»é—®é¢˜è§£å†³èµ·æ¥å°†ä¼š å¼‚å¸¸å›°éš¾ï¼Œç”šè‡³ä¸å¯èƒ½å®Œæˆã€‚</p><p>è¨€è€Œä½¿ç”¨ ç”¨æˆ·çº¿ç¨‹å®ç°çš„ç¨‹åº ä¸€èˆ¬éƒ½æ¯”è¾ƒå¤æ‚ï¼Œé™¤äº†ä»¥å‰åœ¨ä¸æ”¯æŒå¤šçº¿ç¨‹çš„æ“ä½œç³»ç»Ÿä¸­ï¼ˆå¦‚DOSï¼‰çš„å¤šçº¿ç¨‹ç¨‹åº ä¸ å°‘æ•°æœ‰ç‰¹æ®Šéœ€æ±‚çš„ç¨‹åºå¤–ï¼Œ<br>ç°åœ¨ä½¿ç”¨ç”¨æˆ·çº¿ç¨‹çš„ç¨‹åºè¶Šæ¥è¶Šå°‘äº†ï¼ŒJavaã€Rubyç­‰è¯­è¨€éƒ½æ›¾ç»ä½¿ç”¨è¿‡ç”¨æˆ·çº¿ç¨‹ï¼Œæœ€ç»ˆåˆéƒ½æ”¾å¼ƒä½¿ç”¨å®ƒã€‚</p><blockquote><p>æ­¤å¤„è®²çš„â€œå¤æ‚â€ä¸â€œç¨‹åºè‡ªå·±å®Œæˆçº¿ç¨‹æ“ä½œâ€ï¼Œå¹¶ä¸é™åˆ¶ ç¨‹åºä¸­ å¿…é¡»ç¼–å†™äº†å¤æ‚çš„å®ç°ç”¨æˆ·çº¿ç¨‹çš„ä»£ç ï¼Œ<br>ä½¿ç”¨ç”¨æˆ·çº¿ç¨‹çš„ç¨‹åºï¼Œå¾ˆå¤šéƒ½ä¾èµ–ç‰¹å®šçš„çº¿ç¨‹åº“æ¥å®ŒæˆåŸºæœ¬çš„çº¿ç¨‹æ“ä½œï¼Œè¿™äº›å¤æ‚æ€§ éƒ½ å°è£…åœ¨ çº¿ç¨‹åº“ ä¹‹ä¸­ã€‚</p></blockquote><p>ï¼ˆğŸ™ƒğŸ™ƒğŸ™ƒè¡¨ç¤ºåƒæˆ‘è¿™ç§ä¿—äººä¼°è®¡ä¸€è¾ˆå­éƒ½ç”¨ä¸åˆ°ç”¨æˆ·çº¿ç¨‹ä»¥åŠå†…æ ¸çº¿ç¨‹ï¼Œè€Œä¸”ä¼°è®¡æˆ‘ç”¨åˆ°äº†æˆ‘ä¹Ÿä¸çŸ¥é“ï¼‰</p><h6 id="3-ä½¿ç”¨ç”¨æˆ·çº¿ç¨‹åŠ è½»é‡çº§è¿›ç¨‹æ··åˆå®ç°"><a href="#3-ä½¿ç”¨ç”¨æˆ·çº¿ç¨‹åŠ è½»é‡çº§è¿›ç¨‹æ··åˆå®ç°" class="headerlink" title="3.ä½¿ç”¨ç”¨æˆ·çº¿ç¨‹åŠ è½»é‡çº§è¿›ç¨‹æ··åˆå®ç°"></a>3.ä½¿ç”¨ç”¨æˆ·çº¿ç¨‹åŠ è½»é‡çº§è¿›ç¨‹æ··åˆå®ç°</h6><p>çº¿ç¨‹ é™¤äº† ä¾èµ– å†…æ ¸çº¿ç¨‹ å®ç° å’Œ å®Œå…¨ç”± ç”¨æˆ·ç¨‹åº è‡ªå·±å®ç° ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ç§å°† å†…æ ¸çº¿ç¨‹ä¸ç”¨æˆ·çº¿ç¨‹ ä¸€èµ·ä½¿ç”¨çš„å®ç°æ–¹å¼ã€‚</p><p>åœ¨è¿™ç§æ··åˆå®ç°ä¸‹ï¼Œæ—¢å­˜åœ¨ ç”¨æˆ·çº¿ç¨‹ï¼Œä¹Ÿå­˜åœ¨ è½»é‡çº§è¿›ç¨‹ã€‚</p><p>ç”¨æˆ·çº¿ç¨‹ è¿˜æ˜¯å®Œå…¨å»ºç«‹åœ¨ ç”¨æˆ·ç©ºé—´ ä¸­ï¼Œå› æ­¤ ç”¨æˆ·çº¿ç¨‹ çš„ åˆ›å»ºã€åˆ‡æ¢ã€ææ„ç­‰æ“ä½œä¾ç„¶å»‰ä»·ï¼Œå¹¶ä¸”å¯ä»¥æ”¯æŒ å¤§è§„æ¨¡çš„ç”¨æˆ·çº¿ç¨‹å¹¶å‘ã€‚</p><p>è€Œæ“ä½œç³»ç»Ÿæä¾›æ”¯æŒçš„ è½»é‡çº§è¿›ç¨‹ åˆ™ä½œä¸ºç”¨æˆ·çº¿ç¨‹å’Œå†…æ ¸çº¿ç¨‹ä¹‹é—´çš„ æ¡¥æ¢ï¼Œè¿™æ ·å¯ä»¥ä½¿ç”¨ å†…æ ¸æä¾›çš„çº¿ç¨‹è°ƒåº¦åŠŸèƒ½åŠå¤„ç†å™¨æ˜ å°„ï¼Œ<br>å¹¶ä¸” ç”¨æˆ·çº¿ç¨‹çš„ç³»ç»Ÿè°ƒç”¨ è¦é€šè¿‡ è½»é‡çº§çº¿ç¨‹ æ¥å®Œæˆï¼Œå¤§å¤§é™ä½äº† æ•´ä¸ªçº¿ç¨‹ è¢«å®Œå…¨é˜»å¡ çš„é£é™©ã€‚</p><p>åœ¨è¿™ç§ æ··åˆæ¨¡å¼ä¸­ï¼Œç”¨æˆ·çº¿ç¨‹å’Œè½»é‡çº§è¿›ç¨‹ çš„æ•°é‡ æ˜¯ ä¸å®šçš„ï¼Œå³ä¸º N:M çš„å…³ç³»ï¼Œå¦‚å›¾12-5æ‰€ç¤ºï¼Œè¿™ç§å°±æ˜¯ å¤šå¯¹å¤šçš„çº¿ç¨‹æ¨¡å‹ã€‚</p><p>è®¸å¤š UNIXç³»åˆ— çš„ æ“ä½œç³»ç»Ÿï¼Œ å¦‚ Solarisã€HP-UX ç­‰éƒ½æä¾›äº† N:M çš„çº¿ç¨‹æ¨¡å‹ å®ç°ã€‚</p><h6 id="4-Javaçº¿ç¨‹çš„å®ç°"><a href="#4-Javaçº¿ç¨‹çš„å®ç°" class="headerlink" title="4.Javaçº¿ç¨‹çš„å®ç°"></a>4.Javaçº¿ç¨‹çš„å®ç°</h6><p>Javaçº¿ç¨‹ åœ¨ JDK1.2 ä¹‹å‰ï¼Œæ˜¯åŸºäºç§°ä¸º â€œç»¿è‰²çº¿ç¨‹â€ï¼ˆGreen Threadsï¼‰çš„ ç”¨æˆ·çº¿ç¨‹ å®ç°çš„ï¼Œ<br>è€Œåœ¨ JDK1.2 ä¸­ï¼Œçº¿ç¨‹æ¨¡å‹ æ›¿æ¢ä¸º åŸºäºæ“ä½œç³»ç»Ÿ åŸç”Ÿçº¿ç¨‹æ¨¡å‹ æ¥å®ç°ã€‚</p><p>å› æ­¤ï¼Œåœ¨ç›®å‰çš„JDKç‰ˆæœ¬ä¸­ï¼Œæ“ä½œç³»ç»Ÿ æ”¯æŒæ€æ ·çš„ çº¿ç¨‹æ¨¡å‹ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Š å†³å®šäº† Javaè™šæ‹Ÿæœºçš„çº¿ç¨‹ æ˜¯æ€æ · æ˜ å°„çš„ï¼Œ<br>è¿™ç‚¹åœ¨ ä¸åŒçš„å¹³å°å•† æ²¡æœ‰åŠæ³• è¾¾æˆä¸€è‡´ï¼Œè™šæ‹Ÿæœºè§„èŒƒ ä¸­ä¹Ÿå¹¶æœªé™å®š Javaçº¿ç¨‹ éœ€è¦ä½¿ç”¨å“ªç§ çº¿ç¨‹æ¨¡å‹ æ¥å®ç°ã€‚</p><p>çº¿ç¨‹æ¨¡å‹ åªå¯¹ çº¿ç¨‹çš„ å¹¶å‘è§„æ¨¡å’Œæ“ä½œæˆæœ¬ äº§ç”Ÿå½±å“ï¼Œå¯¹Javaç¨‹åºçš„ ç¼–ç å’Œè¿è¡Œè¿‡ç¨‹ æ¥è¯´ï¼Œè¿™äº›å·®å¼‚éƒ½æ˜¯é€æ˜çš„ã€‚</p><p>å¯¹äº Sun JDKæ¥è¯´ï¼Œå®ƒçš„ Windowsç‰ˆæœ¬å’ŒLinuxç‰ˆéƒ½æ˜¯ä½¿ç”¨ ä¸€å¯¹ä¸€çš„çº¿ç¨‹æ¨¡å‹ å®ç°çš„ï¼Œ<br>ä¸€æ¡Javaçº¿ç¨‹ å°± æ˜ å°„åˆ° ä¸€æ¡è½»é‡çº§è¿›ç¨‹ä¹‹ä¸­ï¼Œå› ä¸º Windowså’ŒLinux ç³»ç»Ÿæä¾›çš„çº¿ç¨‹æ¨¡å‹å°±æ˜¯ ä¸€å¯¹ä¸€çš„ã€‚</p><blockquote><p>Windowsä¸‹ç”± çº¤ç¨‹åŒ…ï¼ˆFiber Packageï¼‰ï¼ŒLinuxä¸‹ä¹Ÿæœ‰ NGPTï¼ˆåœ¨2.4å†…æ ¸çš„å¹´ä»£ï¼‰æ¥å®ç° N:M æ¨¡å‹ï¼Œä½†æ˜¯ä»–ä»¬éƒ½æ²¡æœ‰æˆä¸ºä¸»æµã€‚</p></blockquote><p>è€Œåœ¨ Solariså¹³å° ä¸­ï¼Œ<br>ç”±äº æ“ä½œç³»ç»Ÿ çš„ çº¿ç¨‹ç‰¹æ€§ å¯ä»¥åŒæ—¶ æ”¯æŒ  ä¸€å¯¹ä¸€ï¼ˆé€šè¿‡Bound Threadsæˆ–Alternate Libthread å®ç°ï¼‰åŠ å¤šå¯¹å¤šï¼ˆé€šè¿‡ LWP/Thread Based Synchronization å®ç°ï¼‰ çš„çº¿ç¨‹æ¨¡å‹ï¼Œ<br>å› æ­¤åœ¨ Solaris ç‰ˆçš„JDKä¸­ ä¹Ÿå¯¹åº”æä¾›äº† ä¸¤ä¸ªå¹³å°ä¸“æœ‰çš„ è™šæ‹Ÿæœºå‚æ•°ï¼š -XX:+UseLWPSynchronization(é»˜è®¤å€¼) å’Œ -XX:+UseBoundThreads æ¥æ˜ç¡®æŒ‡å®šè™šæ‹Ÿæœºä½¿ç”¨å“ªç§ çº¿ç¨‹æ¨¡å‹ã€‚</p><h5 id="Javaçº¿ç¨‹è°ƒåº¦"><a href="#Javaçº¿ç¨‹è°ƒåº¦" class="headerlink" title="Javaçº¿ç¨‹è°ƒåº¦"></a>Javaçº¿ç¨‹è°ƒåº¦</h5><p>çº¿ç¨‹è°ƒåº¦ æ˜¯æŒ‡ ç³»ç»Ÿ ä¸º çº¿ç¨‹ åˆ†é… å¤„ç†å™¨ä½¿ç”¨æƒ çš„è¿‡ç¨‹ï¼Œ<br>ä¸»è¦è°ƒåº¦æ–¹å¼æœ‰ä¸¤ç§ï¼Œåˆ†åˆ«æ˜¯ ååŒå¼çº¿ç¨‹è°ƒåº¦ï¼ˆCooperative Threads-Schedulingï¼‰ å’Œ æŠ¢å å¼çº¿ç¨‹è°ƒåº¦ï¼ˆPreemptive Threads-Schedulingï¼‰ã€‚</p><p>å¦‚æœä½¿ç”¨ ååŒå¼è°ƒåº¦çš„å¤šçº¿ç¨‹ç³»ç»Ÿï¼Œçº¿ç¨‹çš„æ‰§è¡Œæ—¶é—´ ç”± çº¿ç¨‹æœ¬èº« æ¥æ§åˆ¶ï¼Œçº¿ç¨‹ æŠŠ è‡ªå·±çš„å·¥ä½œæ‰§è¡Œå®Œäº†ä¹‹åï¼Œè¦ä¸»åŠ¨é€šçŸ¥ ç³»ç»Ÿ åˆ‡æ¢åˆ° å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä¸Šã€‚</p><p>ååŒå¼å¤šçº¿ç¨‹ çš„ æœ€å¤§å¥½å¤„ æ˜¯ å®ç°ç®€å•ï¼Œè€Œä¸”ç”±äº çº¿ç¨‹è¦æŠŠè‡ªå·±çš„äº‹æƒ…å¹²å®Œåæ‰ä¼šè¿›è¡Œ çº¿ç¨‹åˆ‡æ¢ï¼Œåˆ‡æ¢æ“ä½œ å¯¹ çº¿ç¨‹è‡ªå·±æ˜¯å¯çŸ¥çš„ï¼Œæ‰€ä»¥æ²¡æœ‰ä»€ä¹ˆ çº¿ç¨‹åŒæ­¥ çš„é—®é¢˜ã€‚</p><p>Luaè¯­è¨€ä¸­çš„ â€œååŒä¾‹ç¨‹â€ å°±æ˜¯è¿™ç±»å®ç°ã€‚</p><p>å®ƒçš„ åå¤„ ä¹Ÿå¾ˆæ˜æ˜¾ï¼šçº¿ç¨‹æ‰§è¡Œæ—¶é—´ ä¸å¯æ§åˆ¶ï¼Œç”šè‡³å¦‚æœä¸€ä¸ªçº¿ç¨‹ç¼–å†™ æœ‰é—®é¢˜ï¼Œ ä¸€ç›´ä¸å‘ŠçŸ¥ç³»ç»Ÿè¿›æ€§ çº¿ç¨‹åˆ‡æ¢ï¼Œé‚£ä¹ˆç¨‹åºå°±ä¼š ä¸€ç›´é˜»å¡ åœ¨é‚£é‡Œã€‚</p><p>å¾ˆä¹…ä»¥å‰çš„ Windows3.xç³»ç»Ÿ å°±æ˜¯ä½¿ç”¨ ååŒå¼ æ¥å®ç° å¤šè¿›ç¨‹å¤šä»»åŠ¡ çš„ï¼Œç›¸å½“ä¸ç¨³å®šï¼Œä¸€ä¸ªè¿›ç¨‹ åšæŒä¸è®©å‡º CPU æ‰§è¡Œæ—¶é—´ å°±å¯èƒ½å¯¼è‡´æ•´ä¸ªç³»ç»Ÿ å´©æºƒã€‚</p><p>å¦‚æœä½¿ç”¨ æŠ¢å å¼è°ƒåº¦çš„å¤šçº¿ç¨‹ç³»ç»Ÿï¼Œé‚£ä¹ˆ æ¯ä¸ªçº¿ç¨‹ å°†ç”± ç³»ç»Ÿ æ¥åˆ†é… æ‰§è¡Œæ—¶é—´ï¼Œçº¿ç¨‹çš„åˆ‡æ¢ä¸ç”± çº¿ç¨‹æœ¬èº« æ¥å†³å®šï¼ˆåœ¨Javaä¸­ï¼ŒThread.yield()å¯ä»¥è®©å‡ºæ‰§è¡Œæ—¶é—´ï¼Œä½†æ˜¯è¦è·å–æ‰§è¡Œæ—¶é—´çš„è¯ï¼Œçº¿ç¨‹æœ¬èº«æ˜¯æ²¡æœ‰ä»€ä¹ˆåŠæ³•çš„ï¼‰ã€‚</p><p>åœ¨è¿™ç§å®ç° çº¿ç¨‹è°ƒåº¦ çš„æ–¹å¼ä¸‹ï¼Œçº¿ç¨‹çš„æ‰§è¡Œæ—¶é—´ æ˜¯ ç³»ç»Ÿ å¯æ§çš„ï¼Œä¹Ÿä¸ä¼šæœ‰ ä¸€ä¸ªçº¿ç¨‹ å¯¼è‡´ æ•´ä¸ªè¿›ç¨‹é˜»å¡ çš„é—®é¢˜ï¼Œ<br>Javaä½¿ç”¨çš„ çº¿ç¨‹è°ƒåº¦æ–¹å¼ å°±æ˜¯ æŠ¢å å¼è°ƒåº¦ã€‚</p><blockquote><p>åœ¨JDKåç»­ç‰ˆæœ¬ä¸­ æœ‰å¯èƒ½ä¼šæä¾› åç¨‹ï¼ˆCoroutinesï¼‰æ–¹å¼ æ¥è¿›è¡Œ å¤šä»»åŠ¡å¤„ç†ï¼Œç›¸å…³èµ„æ–™å¯å‚è§ï¼š<code>http://wikis.sum.com/display/mlvm/Coroutines</code>ã€‚</p></blockquote><p>ä¸å‰é¢æ‰€è¯´çš„ Windows3.x çš„ä¾‹å­ç›¸å¯¹ï¼Œåœ¨ Windows9x/NT å†…æ ¸ä¸­å°±æ˜¯ä½¿ç”¨ æŠ¢å å¼ æ¥å®ç° å¤šçº¿ç¨‹çš„ï¼Œå½“ä¸€ä¸ªè¿›ç¨‹å‡ºäº†é—®é¢˜ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ ä»»åŠ¡ç®¡ç†å™¨ æŠŠè¿™ä¸ª è¿›ç¨‹ â€œæ€æ‰â€ï¼Œè€Œä¸è‡³äºå¯¼è‡´ ç³»ç»Ÿå´©æºƒã€‚</p><p>è™½ç„¶ Javaçº¿ç¨‹è°ƒåº¦ æ˜¯ç³»ç»Ÿè‡ªåŠ¨å®Œæˆçš„ï¼Œ<br>ä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥ â€œå»ºè®®â€ ç³»ç»Ÿç»™æŸäº› çº¿ç¨‹ å¤šåˆ†é…ä¸€ç‚¹ æ‰§è¡Œæ—¶é—´ï¼Œå¦å¤–çš„ä¸€äº›çº¿ç¨‹åˆ™å¯ä»¥å°‘åˆ†é…ä¸€ç‚¹â€”â€”è¿™ä¸€é¡¹æ“ä½œå¯ä»¥é€šè¿‡è®¾ç½® çº¿ç¨‹ä¼˜å…ˆçº§ æ¥å®Œæˆã€‚</p><p>Javaè¯­è¨€ ä¸€å…±è®¾ç½®äº† 10ä¸ªçº§åˆ« çš„ çº¿ç¨‹ä¼˜å…ˆçº§ï¼ˆ Thread.MIN_PRIORITY è‡³ Thread.MAX_PRIORITY ï¼‰ï¼Œåœ¨ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶å¤„äº Ready çŠ¶æ€æ—¶ï¼Œä¼˜å…ˆçº§è¶Šé«˜çš„ çº¿ç¨‹ è¶Šå®¹æ˜“è¢« ç³»ç»Ÿ é€‰æ‹©æ‰§è¡Œã€‚</p><p>ä¸è¿‡ï¼Œçº¿ç¨‹ä¼˜å…ˆçº§ å¹¶ä¸æ˜¯ å¤ªé è°±ï¼ŒåŸå› æ˜¯ Javaçš„çº¿ç¨‹ æ˜¯é€šè¿‡ æ˜ å°„åˆ° ç³»ç»Ÿçš„ åŸç”Ÿçº¿ç¨‹ ä¸Šæ¥å®ç°çš„ï¼Œ<br>æ‰€ä»¥ çº¿ç¨‹è°ƒåº¦ æœ€ç»ˆè¿˜æ˜¯å–å†³äº æ“ä½œç³»ç»Ÿï¼Œè™½ç„¶ç°åœ¨å¾ˆå¤šæ“ä½œç³»ç»Ÿéƒ½æä¾› çº¿ç¨‹ä¼˜å…ˆçº§ çš„æ¦‚å¿µï¼Œ<br>ä½†æ˜¯å¹¶ä¸è§å¾—èƒ½ä¸ Javaçº¿ç¨‹çš„ä¼˜å…ˆçº§ ä¸€ä¸€å¯¹åº”ï¼Œ<br>å¦‚Solarisä¸­ æœ‰ 2147483648ï¼ˆ2^32ï¼‰ä¸­ä¼˜å…ˆçº§ï¼Œä½†Windowsä¸­å°±åªæœ‰7ä¸­ï¼Œæ¯”Javaçº¿ç¨‹ä¼˜å…ˆçº§å¤šçš„ç³»ç»Ÿè¿˜å¥½è¯´ï¼Œä¸­é—´ç•™ä¸‹ä¸€ç‚¹ç©ºä½å°±å¯ä»¥äº†ï¼Œ<br>ä½†æ¯”Javaçº¿ç¨‹ä¼˜å…ˆçº§å°‘çš„ç³»ç»Ÿï¼Œå°±ä¸å¾—ä¸å‡ºç°å‡ ä¸ª ä¼˜å…ˆçº§ç›¸åŒçš„æƒ…å†µäº†ã€‚</p><p>è¡¨12-1 æ˜¾ç¤ºäº† Javaçº¿ç¨‹ä¼˜å…ˆçº§ ä¸ Windowsçº¿ç¨‹ä¼˜å…ˆçº§ ä¹‹é—´çš„å¯¹åº”å…³ç³»ï¼Œ<br>Windowså¹³å°çš„JDKä¸­ ä½¿ç”¨äº†é™¤ THREAD_PRIORITY_IDLE ä¹‹å¤–çš„å…¶ä½™6ç§çº¿ç¨‹ä¼˜å…ˆçº§ã€‚</p><table>  <thead>    <tr>      <th colspan="2">è¡¨ 12-1 Javaçº¿ç¨‹ä¼˜å…ˆçº§ä¸Windowsçº¿ç¨‹ä¼˜å…ˆçº§ä¹‹é—´çš„å¯¹åº”å…³ç³»</th>    </tr>  </thead>  <tr>    <th>Javaçº¿ç¨‹ä¼˜å…ˆçº§</th>    <th>Windowsçº¿ç¨‹ä¼˜å…ˆçº§</th>  </tr>  <tr>    <td>1ï¼ˆThread.MIN_PRIORITYï¼‰</td>    <td>THREAD_PRIORITY_LOWEST</td>  </tr>    <tr>    <td>2</td>    <td>THREAD_PRIORITY_LOWEST</td>  </tr>    <tr>    <td>3</td>    <td>THREAD_PRIORITY_BELOW_NORMAL</td>  </tr>   <tr>    <td>4</td>    <td>THREAD_PRIORITY_BELOW_NORMAL</td>  </tr>   <tr>    <td>5</td>    <td>THREAD_PRIORITY_NORMAL</td>  </tr>   <tr>    <td>6</td>    <td>THREAD_PRIORITY_ABOVE_NORMAL</td>  </tr>    <tr>    <td>7</td>    <td>THREAD_PRIORITY_ABOVE_NORMAL</td>  </tr>    <tr>    <td>8</td>    <td>THREAD_PRIORITY_HIGHEST</td>  </tr>   <tr>    <td>9</td>    <td>THREAD_PRIORITY_HIGHEST</td>  </tr>   <tr>    <td>10ï¼ˆThread.MAX_PRIORITYï¼‰</td>    <td>THREAD_PRIORITY_CRITICAL</td>  </tr></table><p>ä¸Šæ–‡è¯´åˆ° â€œçº¿ç¨‹ä¼˜å…ˆçº§å¹¶ä¸æ˜¯å¤ªé è°±â€ï¼Œä¸ä»…ä»…æ˜¯è¯´ åœ¨ä¸€äº›å¹³å°ä¸Š ä¸åŒçš„ä¼˜å…ˆçº§ å®é™…ä¼šå˜å¾—ç›¸åŒ è¿™ä¸€ç‚¹ï¼Œè¿˜æœ‰å…¶ä»–æƒ…å†µ è®©æˆ‘ä»¬ä¸èƒ½å¤ªä¾èµ– ä¼˜å…ˆçº§ï¼š<br>ä¼˜å…ˆçº§å¯èƒ½ä¼šè¢« ç³»ç»Ÿ è‡ªè¡Œæ”¹å˜ã€‚<br>ä¾‹å¦‚ï¼Œåœ¨Windowsç³»ç»Ÿä¸­ å­˜åœ¨ä¸€ä¸ªç§°ä¸º â€œä¼˜å…ˆçº§æ¨è¿›å™¨â€(Priority Boostingï¼Œå½“ç„¶å®ƒå¯ä»¥è¢«å…³é—­æ‰)çš„åŠŸèƒ½ï¼Œ<br>å®ƒçš„å¤§è‡´ä½œç”¨å°±æ˜¯ å½“ç³»ç»Ÿ å‘ç° ä¸€ä¸ªçº¿ç¨‹ æ‰§è¡Œå¾— ç‰¹åˆ«â€œå‹¤å¥‹åŠªåŠ›â€çš„è¯ï¼Œå¯èƒ½ä¼šè¶Šè¿‡ çº¿ç¨‹ä¼˜å…ˆçº§ å»ä¸ºå®ƒ åˆ†é…æ‰§è¡Œæ—¶é—´ã€‚<br>å› æ­¤ï¼Œæˆ‘ä»¬ä¸èƒ½åœ¨ç¨‹åºä¸­ é€šè¿‡ ä¼˜å…ˆçº§ æ¥å®Œå…¨å‡†ç¡®åœ° åˆ¤æ–­ä¸€ç»„çŠ¶æ€éƒ½ä¸º Readyçš„çº¿ç¨‹ å°†ä¼šå…ˆæ‰§è¡Œå“ªä¸€ä¸ªã€‚</p><h5 id="çŠ¶æ€è½¬æ¢"><a href="#çŠ¶æ€è½¬æ¢" class="headerlink" title="çŠ¶æ€è½¬æ¢"></a>çŠ¶æ€è½¬æ¢</h5><p>Javaè¯­è¨€ å®šä¹‰äº† 5ä¸­çº¿ç¨‹çŠ¶æ€ï¼Œåœ¨ ä»»æ„ä¸€ä¸ªæ—¶é—´ç‚¹ï¼Œ ä¸€ä¸ªçº¿ç¨‹åªèƒ½ æœ‰ä¸”åªæœ‰ å…¶ä¸­çš„ä¸€ç§çŠ¶æ€ï¼Œè¿™5ç§çŠ¶æ€åˆ†åˆ«å¦‚ä¸‹ã€‚</p><p>æ–°å»ºï¼ˆNewï¼‰ï¼šåˆ›å»ºå å°šæœªå¯åŠ¨ çš„çº¿ç¨‹ å¤„äºè¿™ç§ çŠ¶æ€ã€‚</p><p>è¿è¡Œï¼ˆRunnableï¼‰ï¼šRunnableåŒ…æ‹¬äº† æ“ä½œç³»ç»Ÿ çº¿ç¨‹çŠ¶æ€ä¸­çš„ Runningå’ŒReadyï¼Œä¹Ÿå°±æ˜¯å¤„äºæ­¤çŠ¶æ€çš„ çº¿ç¨‹ æœ‰å¯èƒ½æ­£åœ¨æ‰§è¡Œï¼Œä¹Ÿæœ‰å¯èƒ½æ­£åœ¨ç­‰å¾…ç€ CPU ä¸ºå®ƒåˆ†é…æ‰§è¡Œæ—¶é—´ã€‚</p><p>æ— é™æœŸç­‰å¾…ï¼ˆWaitingï¼‰ï¼šå¤„äºè¿™ç§çŠ¶æ€çš„ çº¿ç¨‹ ä¸ä¼šè¢« åˆ†é…CPUæ‰§è¡Œæ—¶é—´ï¼Œå®ƒä»¬è¦ç­‰å¾…è¢« å…¶ä»–çº¿ç¨‹ æ˜¾å¼åœ° å”¤é†’ã€‚<br>ä»¥ä¸‹æ–¹æ³•ä¼šè®©çº¿ç¨‹é™·å…¥æ— é™æœŸçš„ç­‰å¾…çŠ¶æ€ï¼š</p><ul><li>æ²¡æœ‰è®¾ç½® Timeout å‚æ•°çš„ Object.wait() æ–¹æ³•</li><li>æ²¡æœ‰è®¾ç½® Timeout å‚æ•°çš„ Thread.join() æ–¹æ³•</li><li>LockSupport.park() æ–¹æ³•</li></ul><p>é™æœŸç­‰å¾…ï¼ˆTimed Waitingï¼‰ï¼šå¤„äºè¿™ç§çŠ¶æ€çš„ çº¿ç¨‹ ä¹Ÿä¸ä¼šè¢«åˆ†é… CPUæ‰§è¡Œæ—¶é—´ï¼Œä¸è¿‡ æ— éœ€ç­‰å¾…è¢«å…¶ä»–çº¿ç¨‹ æ˜¾å¼åœ° å”¤é†’ï¼Œåœ¨ä¸€å®šæ—¶é—´ä¹‹å å®ƒä»¬ä¼šç”±ç³»ç»Ÿ è‡ªåŠ¨å”¤é†’ã€‚<br>ä»¥ä¸‹æ–¹æ³•ä¼šè®©çº¿ç¨‹ è¿›å…¥ é™æœŸç­‰å¾… çŠ¶æ€ï¼š</p><ul><li>Thread.sleep()æ–¹æ³•</li><li>è®¾ç½®äº† Timeout å‚æ•°çš„ Object.wait() æ–¹æ³•</li><li>è®¾ç½®äº† Timeout å‚æ•°çš„ Thread.join() æ–¹æ³•</li><li>LockSupport.parkNanos()æ–¹æ³•</li><li>LockSupport.parkUtil()æ–¹æ³•</li></ul><p>é˜»å¡ï¼ˆBlockedï¼‰ï¼šçº¿ç¨‹è¢« é˜»å¡ äº†ï¼Œ<br>â€œé˜»å¡çŠ¶æ€â€ä¸â€œç­‰å¾…çŠ¶æ€â€ çš„åŒºåˆ«æ˜¯ï¼š<br>â€œé˜»å¡çŠ¶æ€â€åœ¨ç­‰å¾…ç€è·å–åˆ°ä¸€ä¸ª æ’ä»–é”ï¼Œè¿™ä¸ªäº‹ä»¶ å°†åœ¨ å¦å¤–ä¸€ä¸ªçº¿ç¨‹ æ”¾å¼ƒè¿™ä¸ªé”çš„æ—¶å€™ å‘ç”Ÿï¼›<br>è€Œ â€œç­‰å¾…çŠ¶æ€â€ åˆ™æ˜¯åœ¨ ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œæˆ–è€…å”¤é†’åŠ¨ä½œçš„å‘ç”Ÿã€‚<br>åœ¨ç¨‹åºç­‰å¾…è¿›å…¥ åŒæ­¥åŒºåŸŸ çš„æ—¶å€™ï¼Œçº¿ç¨‹å°†è¿›å…¥è¿™ç§çŠ¶æ€ã€‚</p><p>ç»“æŸï¼ˆTerminatedï¼‰ï¼šå·²ç»ˆæ­¢ çº¿ç¨‹ çš„ çº¿ç¨‹çŠ¶æ€ï¼Œçº¿ç¨‹å·²ç» ç»“æŸæ‰§è¡Œã€‚</p><p>ä¸Šè¿°5ç§çŠ¶æ€ åœ¨é‡åˆ° ç‰¹å®šäº‹ä»¶ å‘ç”Ÿçš„æ—¶å€™ å°†ä¼š äº’ç›¸è½¬æ¢ï¼Œå®ƒä»¬çš„ è½¬æ¢å…³ç³» å¦‚å›¾12-6 æ‰€ç¤ºã€‚</p><h5 id="æœ¬ç« å°ç»“"><a href="#æœ¬ç« å°ç»“" class="headerlink" title="æœ¬ç« å°ç»“"></a>æœ¬ç« å°ç»“</h5><p>æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆäº†è§£äº† è™šæ‹ŸæœºJavaå†…å­˜æ¨¡å‹ çš„ç»“æ„åŠæ“ä½œï¼Œ<br>ç„¶åè®²è§£äº† åŸå­æ€§ã€å¯è§æ€§ã€æœ‰åºæ€§ åœ¨ Javaå†…å­˜æ¨¡å‹ ä¸­çš„ä½“ç°ï¼Œ<br>æœ€åä»‹ç»äº† å…ˆè¡Œå‘ç”ŸåŸåˆ™ çš„è§„åˆ™åŠä½¿ç”¨ã€‚</p><p>å¦å¤–ï¼Œæˆ‘ä»¬è¿˜äº†è§£äº† çº¿ç¨‹ åœ¨ Javaè¯­è¨€ä¹‹ä¸­ æ˜¯å¦‚ä½•å®ç°çš„ã€‚</p><p>å…³äº â€œé«˜æ•ˆå¹¶å‘â€ è¿™ä¸ªè¯é¢˜ï¼Œåœ¨æœ¬ç« ä¸­ ä¸»è¦ä»‹ç»äº† è™šæ‹Ÿæœºå¦‚ä½•å®ç°â€œå¹¶å‘â€ï¼Œåœ¨ç¬¬13ç« ä¸­ï¼Œæˆ‘ä»¬çš„ä¸»è¦å…³æ³¨ç‚¹å°†æ˜¯ è™šæ‹Ÿæœºå¦‚ä½•å®ç°â€œé«˜æ•ˆâ€ï¼Œ<br>åŠ è™šæ‹Ÿæœºå¯¹æˆ‘ä»¬ç¼–å†™çš„å¹¶å‘ä»£ç  æä¾›äº†ä»€ä¹ˆæ ·çš„ ä¼˜åŒ–æ‰‹æ®µã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;æ·±å…¥javaè™šæ‹Ÿæœº-ç¬¬äº”éƒ¨åˆ†-é«˜æ•ˆå¹¶å‘&quot;&gt;&lt;a href=&quot;#æ·±å…¥javaè™šæ‹Ÿæœº-ç¬¬äº”éƒ¨åˆ†-é«˜æ•ˆå¹¶å‘&quot; class=&quot;headerlink&quot; title=&quot;æ·±å…¥javaè™šæ‹Ÿæœº-ç¬¬äº”éƒ¨åˆ†-é«˜æ•ˆå¹¶å‘&quot;&gt;&lt;/a&gt;æ·±å…¥javaè™šæ‹Ÿæœº-ç¬¬äº”éƒ¨åˆ†-é«˜æ•ˆå¹¶å‘&lt;/h2&gt;&lt;h3 i
      
    
    </summary>
    
    
      <category term="è™šæ‹Ÿæœº" scheme="https://fengshana.github.io/categories/%E8%99%9A%E6%8B%9F%E6%9C%BA/"/>
    
    
      <category term="é¢è¯•" scheme="https://fengshana.github.io/tags/%E9%9D%A2%E8%AF%95/"/>
    
      <category term="è™šæ‹Ÿæœº" scheme="https://fengshana.github.io/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>æµç¨‹å›¾-markdownç¾äººé±¼ğŸ§œâ€â™€ï¸å›¾è¡¨</title>
    <link href="https://fengshana.github.io/2020/05/21/%E3%80%90%E7%90%90%E7%A2%8E%E9%9A%8F%E7%AC%94%E3%80%91/%E3%80%90%E6%B5%81%E7%A8%8B%E5%9B%BE%E3%80%91%E7%BE%8E%E4%BA%BA%E9%B1%BC/"/>
    <id>https://fengshana.github.io/2020/05/21/%E3%80%90%E7%90%90%E7%A2%8E%E9%9A%8F%E7%AC%94%E3%80%91/%E3%80%90%E6%B5%81%E7%A8%8B%E5%9B%BE%E3%80%91%E7%BE%8E%E4%BA%BA%E9%B1%BC/</id>
    <published>2020-05-20T19:31:58.233Z</published>
    <updated>2020-06-05T18:02:51.833Z</updated>
    
    <content type="html"><![CDATA[<p>ğŸŒŸğŸŒŸğŸŒŸ<br>ğŸ˜„åˆšåˆšæ‰¾åˆ°ä¸¤ä¸ªæ‰¾è¡¨æƒ…åŒ…Emojiçš„åœ°æ–¹ï¼Œå˜¿å˜¿ğŸ˜‰ï¼Œç»ˆäºå¯ä»¥ä¸ç”¨æ˜¯é¢œæ–‡å­—äº†ğŸ˜‰ï¼›ï¼ˆåˆšåˆšè¯•äº†æœ‰äº›ååº”ä¸å‡ºæ¥â€¦ğŸ™ƒ,ä½†æ˜¯å¯ä»¥è¿›è¡Œcopyï¼Œpasteå•Šå“ˆå“ˆå“ˆğŸ§™â€â™€ï¸ ğŸ§™â€â™€ï¸ ğŸ§™â€â™€ï¸ ï¼‰<br>å‚è€ƒblog: <code>https://segmentfault.com/q/1010000021180710/</code></p><ul><li>ğŸ’« <code>https://unicode.org/emoji/charts/full-emoji-list.html</code></li><li>ğŸ’« <code>https://emoji.muan.co/</code></li><li>ğŸ’« <code>https://www.webfx.com/tools/emoji-cheat-sheet/</code></li></ul><hr><p>å‚è€ƒblog: <code>http://kkpattern.github.io/2015/05/15/Embed-Chart-in-Jekyll.html</code></p><p>mermaid.full.min.js:  </p><ul><li><p>ä½¿ç”¨çš„æ˜¯ï¼š<code>https://www.bootcdn.cn/mermaid/0.2.4/</code></p></li><li><p><code>https://cdn.bootcdn.net/ajax/libs/mermaid/0.2.4/mermaid.full.min.js</code></p></li><li><p>æˆ‘æ˜¯é‡‡ç”¨çš„hexoçš„nextä¸»é¢˜æ‰€ä»¥æ‰¾åˆ°è‡ªå·±çš„ theme/next/layout/layout.swig å½“ä¸­è¿›è¡Œç¼–è¾‘</p>  <figure class="highlight twig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="keyword">set</span></span> html_class = 'theme-next ' + theme.scheme %&#125;</span></span><br><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="keyword">if</span></span> theme.motion.enable %&#125;</span></span><br><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="keyword">set</span></span> html_class = html_class + ' use-motion' %&#125;</span></span><br><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="keyword">endif</span></span> %&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span> <span class="attr">class</span>=<span class="string">"</span></span></span><span class="template-variable">&#123;&#123; html_class | lower &#125;&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> <span class="attr">lang</span>=<span class="string">"</span></span></span><span class="template-variable">&#123;&#123; config.language &#125;&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="keyword">include</span></span> '_partials/head.swig' %&#125;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">title</span>&gt;</span></span><span class="template-tag">&#123;% <span class="name"><span class="keyword">block</span></span> title %&#125;</span><span class="template-tag">&#123;% <span class="name"><span class="keyword">endblock</span></span> %&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="keyword">include</span></span> '_third-party/analytics/index.swig' %&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcss.com/jquery_lazyload/1.9.7/jquery.lazyload.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://unpkg.com/minigrid@3.1.1/dist/minigrid.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"/photos/photos.css"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"/photos/photo.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="comment">&lt;!--æŠŠscriptç²˜åˆ°è¿™é‡Œå°±å·®ä¸å¤šäº†--&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcdn.net/ajax/libs/mermaid/0.2.4/mermaid.full.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">........</span></span><br></pre></td></tr></table></figure></li></ul><p>ç„¶åå°±å¯ä»¥æ„‰å¿«çš„ä½¿ç”¨äº†æµç¨‹å›¾äº†ï¼›ç»ˆäºä¸ç”¨å‚»é€¼å¼æˆªå›¾æˆ–è€…è‡ªå·±ç”»äº†ï¼›å®³ï¼›  </p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">div</span> <span class="built_in">class</span>=<span class="string">"mermaid"</span>&gt;</span><br><span class="line">graph TD;</span><br><span class="line">    A<span class="comment">--&gt;B;</span></span><br><span class="line">    A<span class="comment">--&gt;C;</span></span><br><span class="line">    B<span class="comment">--&gt;D;</span></span><br><span class="line">    C<span class="comment">--&gt;D;</span></span><br><span class="line">&lt;/<span class="keyword">div</span>&gt;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æ”¾åœ¨äº†ä»£ç å—<code>å†…å®¹</code>å½“ä¸­æ˜¾ç¤ºï¼›<br>ä¸‹é¢å°±æ˜¯ä¸Šè¿°ä»£ç ç›´æ¥ç²˜åœ¨äº†markdownæ–‡ä»¶å½“ä¸­ç„¶åæ˜¾ç¤ºå‡ºæ¥çš„å†…å®¹ï¼›</p><div class="mermaid">graph TD;    A-->B;    A-->C;    B-->D;    C-->D;</div><p>ç°åœ¨å¾—å¥½å¥½å­¦å­¦æ€ä¹ˆç”»æµç¨‹å›¾äº†ï¼›å“ˆå“ˆå“ˆå“ˆ<del>~</del></p><p>æ’å…¥ä¸€ä¸‹<strong>æµç¨‹å›¾mermaidè¯­æ³•</strong>ï¼Œ<br>å‚è€ƒblog ğŸ‘‡</p><ul><li><code>https://www.jianshu.com/p/9810ba886955</code></li><li><code>https://blog.csdn.net/wangyaninglm/article/details/52887045</code></li></ul><p><strong>æ–¹å‘æ§åˆ¶</strong></p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">æµç¨‹å›¾åˆ†ä¸ºç«–å‘å’Œæ¨ªå‘ä¸¤å¤§ç±»ï¼Œç«–å‘åŒ…æ‹¬è‡ªä¸Šè€Œä¸‹å’Œè‡ªä¸‹è€Œä¸Šä¸¤ç§é¡ºåºï¼Œæ¨ªå‘åŒ…æ‹¬ä»å³åˆ°å·¦å’Œä»å·¦åˆ°å³ä¸¤ç§é¡ºåºã€‚</span><br><span class="line">å…¶å¯¹åº”è¯­æ³•åˆ†åˆ«ä¸ºï¼šgraph TB/graph BT/graph RL/graph LRã€‚</span><br><span class="line"></span><br><span class="line">TB - <span class="built_in">top</span> <span class="built_in">bottom</span>ï¼ˆè‡ªä¸Šè€Œä¸‹ï¼‰</span><br><span class="line">BT - <span class="built_in">bottom</span> <span class="built_in">top</span>ï¼ˆè‡ªä¸‹è€Œä¸Šï¼‰</span><br><span class="line">RL - <span class="built_in">right</span> <span class="built_in">left</span>ï¼ˆä»å³åˆ°å·¦ï¼‰</span><br><span class="line">LR - <span class="built_in">left</span> <span class="built_in">right</span>ï¼ˆä»å·¦åˆ°å³ï¼‰</span><br><span class="line">TD: é»˜è®¤æ–¹å‘ï¼Œä»ä¸Šåˆ°ä¸‹</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ä¸‹ï¼›</p><div class="mermaid">graph LR;    subgraph      A[h_user user:id:3506728370       :name ]-->B[æ˜¥æ™š];    C[h_user user:id:3506728370       :fans ]-->D[12210862];    E[h_user user:id:3506728370       :blogs ]-->F[83];    end</div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ğŸŒŸğŸŒŸğŸŒŸ&lt;br&gt;ğŸ˜„åˆšåˆšæ‰¾åˆ°ä¸¤ä¸ªæ‰¾è¡¨æƒ…åŒ…Emojiçš„åœ°æ–¹ï¼Œå˜¿å˜¿ğŸ˜‰ï¼Œç»ˆäºå¯ä»¥ä¸ç”¨æ˜¯é¢œæ–‡å­—äº†ğŸ˜‰ï¼›ï¼ˆåˆšåˆšè¯•äº†æœ‰äº›ååº”ä¸å‡ºæ¥â€¦ğŸ™ƒ,ä½†æ˜¯å¯ä»¥è¿›è¡Œcopyï¼Œpasteå•Šå“ˆå“ˆå“ˆğŸ§™â€â™€ï¸ ğŸ§™â€â™€ï¸ ğŸ§™â€â™€ï¸ ï¼‰&lt;br&gt;å‚è€ƒblog: &lt;code&gt;https://segmen
      
    
    </summary>
    
    
      <category term="éšç¬”" scheme="https://fengshana.github.io/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
      <category term="æµç¨‹å›¾" scheme="https://fengshana.github.io/tags/%E6%B5%81%E7%A8%8B%E5%9B%BE/"/>
    
  </entry>
  
  <entry>
    <title>è¿™ä¸–é—´ï¼Œå”¯æœ‰é’æ˜¥ä¸æ¢¦æƒ³ä¸å¯è¾œè´Ÿ</title>
    <link href="https://fengshana.github.io/2020/05/16/%E3%80%90%E5%BF%83%E6%83%85%E3%80%91/%E8%BF%99%E4%B8%96%E9%97%B4%EF%BC%8C%E5%94%AF%E6%9C%89%E9%9D%92%E6%98%A5%E4%B8%8E%E6%A2%A6%E6%83%B3%E4%B8%8D%E5%8F%AF%E8%BE%9C%E8%B4%9F/"/>
    <id>https://fengshana.github.io/2020/05/16/%E3%80%90%E5%BF%83%E6%83%85%E3%80%91/%E8%BF%99%E4%B8%96%E9%97%B4%EF%BC%8C%E5%94%AF%E6%9C%89%E9%9D%92%E6%98%A5%E4%B8%8E%E6%A2%A6%E6%83%B3%E4%B8%8D%E5%8F%AF%E8%BE%9C%E8%B4%9F/</id>
    <published>2020-05-15T16:13:48.915Z</published>
    <updated>2020-05-15T17:54:49.083Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è§‚çœ‹ç¬”è®°ï¼š<a href="https://www.bilibili.com/video/BV1j4411j79x/?spm_id_from=trigger_reload" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1j4411j79x/?spm_id_from=trigger_reload</a>  </p><blockquote><p>è¡¡æ°´ä¸­å­¦â€œå­¦éœ¸â€åŠ±å¿—æ¼”è®²ï¼šè¿™ä¸–é—´ï¼Œå”¯æœ‰é’æ˜¥ä¸æ¢¦æƒ³ä¸å¯è¾œè´Ÿ</p></blockquote><p>è¿™ä¸ªæ˜¯ä»–çš„æ ‡é¢˜æŒºå¥½çš„ï¼›<br>è¿™ä¸ªæ˜¯æˆ‘å¦¹å¦¹ä»‹ç»æˆ‘å»çœ‹çš„ï¼Œå¥¹ä»¬ç­ä¸Šæˆäººç¤¼çœ‹äº†è¿™ä¸ªå½“æ—¶æ²¡çœ‹å®Œï¼Œç„¶ååé¢å‘çƒ§å›å®¶æŠŠå®ƒåˆå®Œæ•´çš„çœ‹äº†ä¸€éï¼›æˆ‘çœ‹äº†ï¼Œç„¶åæœ¬æ¥æ˜¯æ˜¨å¤©çœ‹çš„ï¼Œå‡†å¤‡å†™äº›ä»€ä¹ˆçš„ï¼›å› ä¸ºæ˜¨å¤©ä¸€å¤©é¢è¯•äº†ä¸¤è½®ï¼Œæœ‰ç‚¹ç´¯ï¼›ç„¶åç¡äº†æ˜¨å¤©ç¡çš„å¾ˆå¥½ï¼›  </p><p>å¦¹å¦¹ï¼š å¼ é”¡é”‹<br>å¦¹å¦¹ï¼šåŸæ¥æˆ‘å¸¸å¸¸æƒ³ï¼Œåˆ«äººå°Šé‡æˆ‘ï¼Œæ˜¯å› ä¸ºæˆ‘å¾ˆä¼˜ç§€ï¼›å¯æ˜¯åˆ°äº†è¡¡ä¸­æ‰å‘ç°ï¼Œåˆ«äººå°Šé‡æˆ‘ï¼Œæ˜¯å› ä¸ºåˆ«äººå¾ˆä¼˜ç§€ï¼Œè¿™æ˜¯è¡¡ä¸­å­¦å­ç‹¬æœ‰çš„é’æ˜¥é­…åŠ›ã€‚  </p><p>æˆ‘è·Ÿæˆ‘å¦¹çš„å…³ç³»ï¼Œæ˜¯ä¸€ç§ååˆ†å¹³ç­‰çš„å…³ç³»ï¼Œå°±æ¯”å¦‚è¯´æ¨èæˆ‘æˆ–è€…è¯´å®‰åˆ©æˆ‘çœ‹æŸä¸ªè§‰å¾—æ„ä¹‰éå¸¸å¤§çš„ä¸€ä¸ªè§†é¢‘ä»€ä¹ˆçš„ï¼›æˆ–è€…æ˜¯â€¦.æ€»ä¹‹æˆ‘è®¤ä¸ºæˆ‘ç°åœ¨å’Œå®¶äººä¹‹é—´çš„ä¸€ä¸ªç›¸å¤„çš„ä¸€ä¸ªæ¨¡å¼å°±æ˜¯ä¸å®¶äººéƒ½æ˜¯ä¸€ä¸ªå¹³ç­‰çš„ä¸€ä¸ªçŠ¶æ€ï¼›æˆ‘å¯ä»¥å‘Šè¯‰ä½ æˆ‘ç°åœ¨çš„ä¸€ä¸ªçŠ¶æ€ï¼›ä½ ä¹Ÿå‘æˆ‘å€¾è¯‰ä½ çš„å¿ƒå£°ï¼›æˆ‘è§‰å¾—è¿™ç§çŠ¶æ€éå¸¸çš„å¥½ï¼›å¥½äº†ä¸æ‰¯äº†ï¼›  </p><p>è¿™ä¸ªè§†é¢‘æ˜¨å¤©çœ‹åˆ°åé¢å…¶å®æˆ‘æ³ªç›®äº†ã€‚<br>æ‰“åŠ¨äººå¿ƒçš„åœ°æ–¹å¯èƒ½åœ¨äºçš„ç¡®æœ‰äº›è¯æˆ³ä¸­å¿ƒåäº†ã€‚ä¹Ÿæœ‰å¯èƒ½æ˜¯æˆ‘çš„å¿ƒåº•è¿˜ä¸å¤Ÿåšå¼ºåšç¡¬å§ã€‚ç„¶åå®¹æ˜“æ„ŸåŠ¨çš„ç¼˜æ•…ã€‚  </p><p>æ€»çš„æ¥è¯´æˆ‘å¸Œæœ›æˆ‘ï¼Œæˆ‘è®¤è¯†æˆ‘çˆ±çš„äººçˆ±æˆ‘çš„äººä¸ç®¡å¹´é¾„å¤šå°‘å²ä½™ç”Ÿéƒ½èƒ½å¤Ÿæœç€è‡ªå·±çš„ä¸€ä¸ªç›®æ ‡è€ŒåŠªåŠ›å¥‹æ–—è¿½é€ç€ã€‚  </p><p>ä¸‹é¢æ˜¯çœ‹è§†é¢‘çš„ä»–çš„ä¸€ä¸ªæ¼”è®²çš„å†…å®¹ï¼›æˆ‘ä¹Ÿæ˜¯ä¸€è¾¹å¬ä¸€è¾¹å†™ï¼›å¯¹äº†å…¶å®æˆ‘å‘ç°ï¼Œå°±æ˜¯åœ¨bç«™ä¸Šé¢å…¶å®æ¯å¤©æœ‰50ä¸Šä¸‹å·¦å³çš„äººåœ¨çœ‹è¿™ä¸ªè§†é¢‘ï¼›å…¶å®ä»–çš„è¿™åœºæ¼”è®²å¸¦æ¥çš„åŠ›é‡ä¹Ÿæ˜¯å¾ˆå¤§çš„ï¼Œèƒ½å¤Ÿåšåˆ°ä¸€ç§å°±æ˜¯æ­£é¢ç§¯æå‘ä¸Šåœ¨è‡ªå·±å¤„äºä½ç³œæˆ–è€…æ˜¯è¿·èŒ«çš„è¿™æ ·ä¸€ç§çŠ¶æ€ä¸‹ï¼Œç„¶åç»™äººä¸€ç§å°±æ˜¯æ­£ç¡®çš„è¿™æ ·ä¸€ä¸ªæ–¹å‘æŒ‡å¼•çš„ä½œç”¨æ˜¯éå¸¸å€¼å¾—å­¦ä¹ çš„ï¼›  </p><p>æˆ‘ä¹Ÿæ˜¯å…¶ä¸­çš„å—ç›Šè€…å³ä½¿æˆ‘å½“å‰å·²ç»ç¦»å¼€å­¦æ ¡çš„ç”Ÿæ´»æ­¥å…¥ç¤¾ä¼šäº†ã€‚  </p><p>å¥½äº†ä¸å¤šè¯´äº†ï¼Œæˆ‘è¿™äººå°±æ˜¯å®¹æ˜“æ¯”è¾ƒè¯å¤šæœ‰ä¸ªæ—¶å€™è‡ªå·±è·Ÿè‡ªå·±è¯´è¯éƒ½èƒ½è¯´å¾—ç¡ä¸ç€è§‰ã€‚å®³ï¼Œæ„äººã€‚(ï½¡â€¢Ë‡â€¸Ë‡â€¢ï½¡)  </p><p>å¯¹äº†ï¼Œå»ºè®®è¯·ä½¿ç”¨åŸé€Ÿåº¦è¿›è¡Œæ’­æ”¾ï¼Œä¸è¦å¿«è¿›ã€‚ï¼ˆæ›´æœ‰æ„Ÿè§‰ï¼‰  </p><h2 id="æ¼”è®²ç¨¿"><a href="#æ¼”è®²ç¨¿" class="headerlink" title="æ¼”è®²ç¨¿"></a>æ¼”è®²ç¨¿</h2><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br></pre></td><td class="code"><pre><span class="line">å°Šæ•¬çš„è€å¸ˆï¼Œäº²çˆ±çš„åŒå­¦ä»¬ï¼Œå¤§å®¶å¥½ï¼ï¼ˆæ­¤æ—¶ä»–é èº¬<span class="number">90</span>åº¦ï¼Œä¸é”™å°ä¼™å­ï¼Œå“ˆå“ˆå“ˆå“ˆå“ˆ~~~ï¼‰</span><br><span class="line"></span><br><span class="line">æˆ‘æ˜¯<span class="number">838</span>ç­çš„å¼ é”¡é”‹ã€‚</span><br><span class="line"></span><br><span class="line">ç›¸ä¿¡å¾ˆå¤šåŒå­¦åº”è¯¥è®¤è¯†æˆ‘ï¼Œåœ¨å¤§å®¶çœ¼é‡Œï¼Œæˆ‘æ‰®æ¼”æ›´å¤šçš„é€šå¸¸æ˜¯ä¸ªè°æ˜Ÿçš„è§’è‰²ã€‚  </span><br><span class="line"></span><br><span class="line">å¯æ˜¯å¤§å®¶ä¼¼ä¹å¿˜è®°äº†ï¼Œåœ¨æˆ‘è¿™çœ‹ä¼¼ç‹‚é‡ï¼Œå®åˆ™ç‹‚é‡çš„å¤–è¡¨ä¸‹ï¼ˆä¸å“¦è€é˜¿å§¨è§‰å¾—ä½ é•¿çš„æŒºæ¸…ç§€çš„å“¦å“ˆå“ˆå“ˆå“ˆï¼‰ï¼Œä¹Ÿéšè—ç€ä¸€é¢—æ†§æ†¬é˜³å…‰çš„å¿ƒã€‚ï¼ˆå¾ˆå¥½ï¼‰</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥ï¼Œæˆ‘ç«™åœ¨è¿™é‡Œï¼Œä¸å¤§å®¶åˆ†äº«å…³äºå­¦ä¹ ï¼Œï¼ˆæ­¤å¤„åº”è¯¥åŠ ä¸ªé€—å·ï¼Œä¸ç„¶å°±å˜æˆäº†â€œå­¦ä¹ æˆ‘çš„çœ‹æ³•â€ emmï¼‰æˆ‘çš„çœ‹æ³•ã€‚</span><br><span class="line"></span><br><span class="line">æˆ‘æ¼”è®²çš„ä¸»é¢˜æ˜¯ï¼šé’æ˜¥ä¸æ¢¦æƒ³ã€‚  </span><br><span class="line"></span><br><span class="line">è¯è¯´è¿™ä¸–é—´ï¼Œå”¯æœ‰é’æ˜¥ä¸æ¢¦æƒ³ä¸å¯è¾œè´Ÿã€‚  </span><br><span class="line"></span><br><span class="line">èŠ±å¼€æ­£å¥½ï¼Œå¾®é£ä¸ç‡¥ï¼Œï¼ˆæˆ‘é‚£å¥é˜³å…‰æ­£å¥½å¾®é£ä¸ç‡¥ä¹Ÿæ˜¯å–è‡ªè¿™é‡Œå“ˆå“ˆå“ˆå“ˆï¼‰æˆ‘ä»¬æ‰¬å¸†ï¼Œèµ·èˆªã€‚  </span><br><span class="line"></span><br><span class="line">é¦–å…ˆï¼Œé’æ˜¥ï¼Œé’æ˜¥æ˜¯ä»€ä¹ˆé¢œè‰²çš„ï¼Ÿ  </span><br><span class="line"></span><br><span class="line">æ˜¯äº”æœˆçš„èŠ±æµ·ï¼Œç¿çƒ‚æ— æ¯”ï¼›æ˜¯æµ·è¾¹çš„æµªèŠ±ï¼Œæ°¸ä¸åœæ¯ï¼›æ˜¯ä»²å¤çš„éª„é˜³ï¼Œæ¿€æƒ…å››å°„ã€‚  </span><br><span class="line"></span><br><span class="line">é’æ˜¥åœ¨è¡¡ä¸­ï¼Œæ˜¯ç»šä¸½å¤šå½©çš„ï¼›  </span><br><span class="line"></span><br><span class="line">åŸæ¥å•Šï¼Œæˆ‘å¸¸å¸¸æƒ³ï¼Œåˆ«äººå°Šé‡æˆ‘ï¼Œæ˜¯å› ä¸ºï¼Œæˆ‘å¾ˆä¼˜ç§€ã€‚  </span><br><span class="line"></span><br><span class="line">å¯æ˜¯ï¼Œåˆ°äº†è¡¡ä¸­æ‰å‘ç°ï¼Œåˆ«äººå°Šé‡æˆ‘ï¼Œæ˜¯å› ä¸ºï¼Œåˆ«äººå¾ˆä¼˜ç§€ã€‚  </span><br><span class="line"></span><br><span class="line">è¿™ï¼Œæ˜¯è¡¡ä¸­å­¦å­ï¼Œç‹¬æœ‰çš„ï¼Œé’æ˜¥é­…åŠ›ï¼  </span><br><span class="line"></span><br><span class="line">åŒæ ·ï¼Œæ­£å€¼é’æ˜¥ï¼Œæˆ‘ä»¬æœ‰çŠ¯é”™çš„æƒåˆ©ã€‚  </span><br><span class="line"></span><br><span class="line">è®°å¾—ç¬¬ä¸€æ¬¡äº¤æ”¹é”™æœ¬ï¼Œæˆ‘é—®è€å¸ˆè¦æ”¹å¤šå°‘ï¼Ÿï¼ˆå¥½äº†ï¼Œä»–åœ¨è®²è¿°ä»–çš„äºŒè´§ç»å†äº†ï¼Œè·Ÿæˆ‘æœ‰çš„ä¸€æ¯”ï¼‰</span><br><span class="line"></span><br><span class="line">è€å¸ˆè¯´ï¼Œæ ¹æ®ä¸ªäººæƒ…å†µï¼Œåœ¨ç²¾ä¸åœ¨å¤šã€‚  </span><br><span class="line"></span><br><span class="line">å“¦å‘œï¼Ÿ  </span><br><span class="line"></span><br><span class="line">æ˜¯å—ï¼Ÿ</span><br><span class="line"></span><br><span class="line">è¿™å¯æ˜¯æ‚¨è¯´çš„ã€‚</span><br><span class="line"></span><br><span class="line">è¯´æ—¶è¿Ÿé‚£æ—¶å¿«ï¼Œæˆ‘é¡¿æ—¶ç»½æ”¾äº†ä¸€ä¸ªè€€çœ¼çš„ç¬‘å®¹ã€‚ï¼ˆè¿™ä¸ªç¬‘å®¹å¯ä»¥æƒ³è±¡ï¼‰</span><br><span class="line"></span><br><span class="line">æˆ‘å¿ƒä¸åœ¨ç„‰ï¼Œè‰è‰äº†äº‹ã€‚</span><br><span class="line"></span><br><span class="line">å¯æ˜¯ï¼Œæ”¹é”™å‘ä¸‹æ¥æ—¶å´æ˜¯ï¼Œä¸€ç‰‡ä¸‡ç´«åƒçº¢çš„æ ·å­ã€‚  </span><br><span class="line"></span><br><span class="line">ä¸Šé¢ï¼Œæœ‰è¯¦ç»†çš„æ‰¹æ³¨ï¼Œè¯„è¯­æ˜¯è¿™æ ·çš„ï¼šè¿™ä¸ªæ”¹é”™æ”¹çš„ä¸é”™ï¼Œæœ‰äº›é¢˜æ”¹ç€æ”¹ç€å°±é”™äº†ã€‚ï¼ˆå”‰å“Ÿè¿™ä¸ªè€å¸ˆå¾ˆçš®å“¦ï¼‰</span><br><span class="line"></span><br><span class="line">æˆ‘ä»¬è€å¸ˆé’æ˜¥æ´»æ³¼çš„åŠ›é‡ï¼Œå°±è¿™æ ·è®©å­¦ä¹ ç”Ÿæ´»å¦™è¶£æ¨ªç”Ÿã€‚  </span><br><span class="line"></span><br><span class="line">å…¶æ¬¡ï¼Œæ˜¯è¿™é‡Œé’æ˜¥çš„å­¦ä¹ æ°›å›´ï¼ˆå…¶å®ä»–è¿™é‡Œåœé¡¿äº†ä¸€å®šæ—¶é—´ï¼Œå°±æ˜¯ç­‰ç€ä¸‹é¢çš„åŒå­¦æ¸æ¸é™ä¸‹æ¥ç„¶åå†è¯´è¯ï¼Œå—¯ï¼ŒæŒºå¥½çš„ï¼‰ï¼Œå½“ä½ æ»¡çœ¼ï¼Œéƒ½æ˜¯è¿½æ±‚å“è¶Šçš„å­—æ ·æ—¶ï¼Œä¾¿ä¹Ÿï¼Œæ²¡ç†ç”±è½åäº†ã€‚  </span><br><span class="line"></span><br><span class="line">ï¼ˆå¥½äº†ï¼ŒäºŒè´§çš„è‡ªé»‘å¼€å§‹äº†ï¼‰è¿æˆ‘è¿™ä¸ªï¼Œè¢«åŒå­¦ä»¬èª‰ä¸ºï¼šå¤å¨œæ‹‰é»‘æš—ä¹‹ç¥çš„äººï¼Œä¹Ÿï¼Œæ—©å·²ç»ï¼Œåœ¨å‰å¾€å“è¶Šçš„è·¯ä¸Šã€‚</span><br><span class="line"></span><br><span class="line">æˆ‘å–œæ¬¢ï¼Œåœ¨æŸä¸ªè¯¾é—´ç¢ç£¨é‚£äº›ï¼Œä¼˜é›…çš„ï¼Œç¾ä¸½çš„æ•°å­¦é¢˜ã€‚ï¼ˆçš„ç¡®ï¼Œå¦‚æœçœŸçš„è§‰å¾—è¯¶è¿™ä¸ªçš„ç¡®ååˆ†æœ‰è¶£ï¼Œå…¶å®æ˜¯ä¼šæ…¢æ…¢çš„æ²‰ä¸‹å»çœŸæ­£å–œæ¬¢ä¸Šè¿™äº›ä»¥å‰è§‰å¾—æ¯ç‡¥ä¹å‘³çš„ä¸œè¥¿ã€‚æ¯”å¦‚è¯´æ•°æ®ç»“æ„ï¼‰</span><br><span class="line"></span><br><span class="line">ï¼ˆå¥½äº†ï¼ŒäºŒè´§é•¿å¸ä¸€å£æ°”ï¼Œå“ˆå“ˆï¼‰å°ä¸œè¥¿ï¼ŒçœŸåˆ«è‡´ã€‚ï¼ˆä»–è¿™é‡Œåˆåœ¨ç­‰ä¸‹é¢çš„å£°éŸ³é™ä¸‹æ¥ä¸€ç‚¹ç„¶åæ‰å¼€å§‹è¯´è¯ï¼Œä¸é”™ï¼‰</span><br><span class="line"></span><br><span class="line">æˆ‘å–œæ¬¢ï¼Œåœ¨æŸå¤©æ¸…æ™¨å¤´æ˜è„‘èƒ€æ—¶ï¼Œå›æƒ³åˆšåˆšå­¦è¿‡çš„ï¼Œç³»ç»Ÿå‘½åæ³•ã€‚  </span><br><span class="line"></span><br><span class="line">å“‡ï¼Œè¿™ä¸€ç¬é—´æœ‰ä¸€ç™¾ä¸‡ä¸ªå¯èƒ½ã€‚  </span><br><span class="line"></span><br><span class="line">æˆ‘å–œæ¬¢ï¼ŒæŸå¤©æ™šä¸Šèººåœ¨åºŠä¸Šï¼Œå›æƒ³æ›¾ç»èƒŒè¿‡çš„è€å­ï¼Œâ€œçŸ¥äººè€…æ™ºï¼Œè‡ªçŸ¥è€…æ˜ã€‚åœ£äººè€…æœ‰åŠ›ï¼Œè‡ªèƒœè€…å¼ºã€‚â€ æˆ‘å¥½å›°å•Šâ€¦â€¦</span><br><span class="line"></span><br><span class="line">ç¬¬äºŒï¼Œæ¢¦æƒ³ã€‚</span><br><span class="line"></span><br><span class="line">æœ‰ä¸€æ¡è·¯ï¼ŒäººçƒŸç¨€å°‘å¯¸æ­¥éš¾è¡Œï¼Œä½†æ˜¯ï¼Œå´ä¸å¾—ä¸åšæŒå‰è¿›ï¼Œå› ä¸ºå®ƒçš„å°½å¤´ï¼Œç§ç€æ¢¦æƒ³ã€‚ï¼ˆè¿™ä¸ªæ—¶å€™æˆ‘æƒ³åˆ°äº†ä¸€é¦–çº¯éŸ³ä¹å¯ä»¥åœä¸‹å°±æ˜¯å«å•¥æ¥ç€ the right pathï¼›ç„¶åé€šè¿‡è¿™é¦–çº¯éŸ³ä¹ï¼Œæˆ‘ä¹Ÿå‘ç°äº†ä¸€é¦–æ„ä¹‰éå¸¸å¯¹äºæˆ‘è€Œè¨€éå¸¸å¥½çš„ä¸€é¦–å°è¯—ï¼›é»„è‰²çš„æ ‘æ—é‡Œåˆ†å‡ºä¸¤æ¡è·¯ æˆ‘é€‰æ‹©äº†äººè¿¹æ›´å°‘çš„ä¸€æ¡ ä»æ­¤å†³å®šäº†æˆ‘ä¸€ç”Ÿçš„é“è·¯ï¼›åŒæ ·ä¹Ÿé€ç»™ä½ ä»¬ï¼›æœ‰ä¸ªæ—¶å€™å¬çº¯éŸ³ä¹ï¼Œå…¶å®ä¹Ÿæ˜¯åœ¨å¬è‡ªå·±å†…å¿ƒçš„å£°éŸ³ã€‚ï¼‰</span><br><span class="line"></span><br><span class="line">åŒå­¦ä»¬ï¼Œä½ çš„æ¢¦æƒ³æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆæˆ‘ä»¥å‰å¯èƒ½ä¸çŸ¥é“ï¼Œä½†æ˜¯æˆ‘ç°åœ¨çŸ¥é“äº†ï¼Œä¹ŸçŸ¥é“æˆ‘å‰è¿›çš„æ–¹å‘æ˜¯ä»€ä¹ˆäº†ã€‚ï¼‰</span><br><span class="line"></span><br><span class="line">ç›¸ä¿¡ï¼Œå¾ˆå¤šäººçš„å›ç­”éƒ½ä¼šæ˜¯æ¸…åŒ—è¿™æ ·çš„é¡¶å°–åæ ¡ã€‚</span><br><span class="line"></span><br><span class="line">æˆ‘ä»¬é€‰æ‹©å®ƒä»¬ä¸ä»…ä»…å› ä¸ºå®ƒä»¬æ˜¯åæ ¡ï¼Œè¿˜å› ä¸ºå®ƒä»¬åè½çš„åŸå¸‚ï¼Œå®ƒä»¬ç¾ä¸½çš„ä¼ è¯´ã€‚  </span><br><span class="line"></span><br><span class="line">å¯¹äºç—´è¿·äºåœ°ç†å­¦ç§‘çš„æˆ‘æ¥è¯´ï¼Œå¤–é¢çš„ä¸–ç•Œï¼Œå¤–é¢çš„åŸå¸‚å°±æ˜¯æˆ‘çš„æ¢¦æƒ³ã€‚  </span><br><span class="line"></span><br><span class="line">è¿™é‡Œï¼Œå¹¿ä¸œï¼Œå¯¹å¤–å¼€æ”¾çš„å‰æ²¿ï¼Œæˆ‘æŠŠå®ƒåšæˆå¡è´´éšèº«æºå¸¦ï¼›</span><br><span class="line"></span><br><span class="line">è¿™é‡Œï¼Œä¸Šæµ·ï¼Œå…¨ä¸­å›½æœ€å¤§çš„åŸå¸‚ï¼Œæˆ‘æŠŠå®ƒæ‹æˆç…§ç‰‡è´´åœ¨è¯¾æ¡Œä¸Šï¼›  </span><br><span class="line"></span><br><span class="line">è¿™é‡Œï¼Œè¥¿å®‰ï¼Œå¤§å”ä¸å¤œåŸï¼Œæˆ‘åšæ¢¦éƒ½ä¼šæƒ³èµ·å®ƒã€‚</span><br><span class="line"></span><br><span class="line">çœ‹å®Œè¿™äº›ï¼Œä¸çŸ¥é“åŒå­¦ä»¬å¿ƒé‡Œæœ‰ä»€ä¹ˆæ„Ÿè§¦ï¼›ï¼ˆæ„Ÿè§¦å˜›ï¼Œä¹Ÿæœ‰çš„ï¼Œæˆ‘ä¹Ÿæƒ³å»å¤–é¢çš„ä¸–ç•Œå¤šçœ‹çœ‹å¤šèµ°èµ°å¤šç»å†ï¼‰</span><br><span class="line"></span><br><span class="line">æ­¤åˆ»ï¼Œä½ çš„å¿ƒé‡Œæ˜¯å¦å……æ»¡äº†å¯¹æœªæ¥çš„æ¸´æœ›ï¼Ÿ</span><br><span class="line"></span><br><span class="line">æˆ‘é—®åŒå­¦ä»¬ä¸€ä¸ªé—®é¢˜ï¼Œè¯·å¤§å®¶ä¼¸å‡ºå³æ‰‹ã€‚</span><br><span class="line"></span><br><span class="line">çœ‹ï¼Œå®ƒåƒä»€ä¹ˆï¼Ÿï¼ˆä»–ä¸¾èµ·äº†å³æ‰‹ï¼Œè¯´å®è¯å—ï¼Ÿåƒæ‰‹ï¼‰</span><br><span class="line"></span><br><span class="line">åƒå³æ‰‹ï¼Ÿ</span><br><span class="line"></span><br><span class="line">è¿™éƒ½è¢«ä½ å‘ç°äº†å—ï¼Ÿï¼ˆä¸é”™å•Šï¼Œéƒ½å¾ˆçš®ï¼Œå“ˆå“ˆå“ˆå“ˆï¼‰</span><br><span class="line"></span><br><span class="line">åŒå­¦ä»¬ï¼Œæœç„¶è§å¤šè¯†å¹¿å•Šï¼ï¼ˆé‚£æ˜¯é‚£æ˜¯ï¼Œè°¦è™šä¸€ç‚¹ï¼Œè‡ªå·±äººçŸ¥é“å°±è¡Œï¼‰</span><br><span class="line"></span><br><span class="line">è¯·å¤§å®¶ï¼Œäº”æŒ‡å¹¶æ‹¢ï¼Œæ”¾äºè…°é—´ï¼Œæ…¢æ…¢é«˜ä¸¾ï¼Œä¸¾è¿‡å¤´é¡¶ï¼Œå¼ å¼€ã€‚</span><br><span class="line"></span><br><span class="line">æˆåŠŸäº†å—ï¼Ÿé‚£æ­å–œä½ ï¼ä½ ç»™è‡ªå·±ï¼Œæ”¾äº†ä¸ªçƒŸèŠ±ã€‚ï¼ˆä¸é”™çš„å°ä¼™å­ï¼Œå“ˆå“ˆå“ˆå“ˆï¼‰</span><br><span class="line"></span><br><span class="line">å¯æ˜¯ï¼ŒçƒŸèŠ±è™½ç¾ï¼Œè½¬ç¬å³é€ã€‚ï¼ˆæˆ‘è¿™ä¸ªçƒŸèŠ±ä¸å¤ªç¾ï¼Œäº”æŒ‡å¤ªçŸ­äº†çœ‹ä¸å‡ºæ¥çƒŸèŠ±çš„æ ·å­ï¼‰</span><br><span class="line"></span><br><span class="line">ç°åœ¨ï¼Œè¯·åŒå­¦ä»¬ä¼¸å‡ºä½ çš„çƒŸèŠ±ï¼ŒæŠŠå®ƒæ”¥æˆæ‹³ã€‚</span><br><span class="line"></span><br><span class="line">å¤§å®¶çœ‹ï¼Œå®ƒåˆåƒä»€ä¹ˆï¼Ÿï¼ˆåƒçŸ³å¤´ï¼‰</span><br><span class="line"></span><br><span class="line">å¥½ï¼Œæˆ‘ä»¬ä¸è¦å†æ¥äº†ã€‚ã€‚</span><br><span class="line"></span><br><span class="line">è¯·å¤§å®¶æŠŠä½ çš„å³æ‹³ç½®äºä½ çš„è€³è¾¹ï¼Œå¦‚æœä½ èƒ½æ¸…æ¥šåœ°å¬åˆ°è„‰æçš„å¾‹åŠ¨ï¼Œé‚£ä¹ˆæˆ‘å‘Šè¯‰ä½ ï¼šè¿™ï¼Œæ˜¯ç”Ÿå‘½ã€‚  </span><br><span class="line"></span><br><span class="line">æˆ‘ä»¬æ¢¦æƒ³å¾ˆç¾ï¼Œå¾ˆè¿œå¤§ï¼›</span><br><span class="line"></span><br><span class="line">ä½†æ˜¯åªæœ‰æŠŠæŒæ¡æˆæ‹³ï¼Œç”¨å°½å…¨åŠ›ï¼ŒæŒ¥å‘ç”Ÿæ´»ï¼Œè¿™æ ·ï¼Œæ‰æ˜¯é’æ˜¥è·¯ä¸Šï¼Œè¯¥æœ‰çš„å§¿æ€ã€‚ï¼ˆä¸é”™ï¼Œå¥½æ ·çš„ï¼Œæˆ‘æ€ä¹ˆæ„Ÿè§‰æˆ‘åœ¨ï¼Œï¼Œåˆ›å»ºæˆ‘è‡ªå·±çš„å¼¹å¹•ã€‚ã€‚ã€‚ã€‚ï¼‰</span><br><span class="line"></span><br><span class="line">åŒå­¦ä»¬ï¼Œä½ ï¼Œæœ‰æ²¡æœ‰æ„Ÿåˆ°ä¸€ç§éœ‡æ’¼ï¼Ÿ</span><br><span class="line"></span><br><span class="line">ç›¸ä¿¡ï¼Œå¾ˆå¤šäººéƒ½ä¼šè·Ÿæˆ‘ä¸€æ ·ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ç§å¿µæƒ³ã€‚</span><br><span class="line"></span><br><span class="line">ä¸€ç§å‘è‡ªå†…å¿ƒï¼Œç”±å†…è€Œå¤–çš„ï¼Œå¯¹åŸå¸‚ï¼Œå¯¹æœªæ¥çš„æ¸´æœ›ã€‚</span><br><span class="line"></span><br><span class="line">å°‘å¹´ä»¬æ—©å·²ä¸æƒ³æ‹˜æ³¥äºè¿™é‡Œï¼Œåªèƒ½åœ¨æ‰€è°“ï¼ŒæŠ–éŸ³ã€ç”µå½±é‡Œï¼Œå»è§‚æœ›åˆ«äººçš„ç”Ÿæ´»ã€‚ï¼ˆæ˜¯çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬è¦åšçš„æ˜¯è¿‡å¥½è‡ªå·±çš„ç”Ÿæ´»ï¼Œè€Œä¸æ˜¯å»ç¾¡æ…•åˆ«äººï¼Œå…¶å®è‡ªå·±ä¹Ÿå¯ä»¥ï¼‰</span><br><span class="line"></span><br><span class="line">å¯æ˜¯ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬å°±åªèƒ½åšé‚£ä¸ªèº²åœ¨é˜´æš—çš„è§’è½é‡Œï¼Œæ–°é²œçš„èˆå°ä¹‹ä¸Šï¼Œå…‰é²œäº®ä¸½çš„åˆ«äººçš„é‚£ä¸ªï¼Œå‘å¾®çš„äººã€‚</span><br><span class="line"></span><br><span class="line">è¿™æ ·ä¸è¡Œã€‚</span><br><span class="line"></span><br><span class="line">ä¸€ç‚¹å„¿éƒ½ä¸å¥½ç©ã€‚ï¼ˆæˆ‘ä¹Ÿè§‰å¾—ï¼Œå› ä¸ºä½ ä¸è§‰å¾—å¹²å·´å·´çš„çœ‹ç€åˆ«äººçš„ç”Ÿæ´»ï¼Œåªä¼šè®©è‡ªå·±emmè§‰å¾—è‡ªå·±çš„ç”Ÿæ´»å¹¶æ²¡æœ‰ï¼Œæ€ä¹ˆè¯´å‘¢å¦‚æœè‡ªå·±çš„ä¸‰è§‚å¹¶ä¸æ˜¯æ‘†çš„å¾ˆæ­£çš„è¯ï¼Œå°±ä¼šäº§ç”Ÿä¸€ç§æ”€æ¯”çš„è¿™æ ·ä¸€ç§å¿ƒç†æƒ…ç»ªï¼Œè¿™æ ·æ˜¯éå¸¸ä¸å¥½çš„ã€‚ï¼‰</span><br><span class="line"></span><br><span class="line">æˆ‘ä»¬ï¼Œä¼šèµ°å‡ºå»ï¼Œé¡ºå¢ƒä¹Ÿå¥½é€†å¢ƒä¹Ÿå¥½ï¼Œäººç”Ÿï¼Œæœ¬å°±æ˜¯ä¸€åœºä¸ç§ç§å›°éš¾æ— ä¼‘æ— å°½çš„æ–—äº‰ï¼Œä¸€åœºï¼Œæ•Œä¼—æˆ‘å¯¡çš„æ–—äº‰ã€‚ï¼ˆå§æ§½ï¼Œä»–è¿™é‡Œå¥½åƒå¿µé”™äº†ï¼Œå¿µæˆäº†æ•Œå¯¡æ•Œä¼—çš„æ–—äº‰ï¼Œä½†æ˜¯å½“å‰ä»–å¹¶æ²¡æœ‰å°±æ˜¯å› ä¸ºè¿™ä¸ªç‚¹çš„å¤±è¯¯è€Œåé¢æ¼”è®²çš„ä¸å¥½ï¼Œè¿™ä¸€ç‚¹å¾ˆå¥½å…¶å®ï¼Œé¢å¯¹å¤±è¯¯å¹¶ä¸æ…Œå¼ è€Œæ˜¯é¡ºåˆ©çš„æ¥å…¥ä¸‹ä¸€å¥è¯è¿™æ ·å­ï¼Œä¸é”™å°ä¼™å­ï¼‰</span><br><span class="line"></span><br><span class="line">æˆ‘æ›¾æŠŠè‡ªå·±å‘å¾€çš„å¤§å­¦çƒ­çˆ±çš„åŸå¸‚ï¼Œæ‹æˆç…§ç‰‡è´´åœ¨è¯¾æ¡Œä¸Šï¼Œæ¯å½“æˆ‘ç²¾ç–²åŠ›ç«­æ—¶ï¼Œéƒ½è¦çœ‹ä¸€ä¸‹å®ƒï¼ˆæ–¹ä¾¿æ‰¾å›è‡ªå·±å½“åˆçš„ä¿¡å¿µä¸ä¼šæ„Ÿåˆ°è¿·èŒ«çš„è¿™æ ·ä¸€ç§æ–¹å¼ï¼Œå…¶å®ä¹Ÿæ˜¯å¼•å¯¼è‡ªå·±èµ°å‡ºä½è½çš„è¿™æ ·ä¸€ç§æƒ…ç»ªæˆ–è€…è¯´é¿å…ä½è½ï¼›å…¶å®æˆ‘ä¹Ÿæœ‰ï¼Œå°±æ˜¯å†™ä¸€äº›è¯ç„¶åç»å¸¸å»çœ‹ï¼Œé¼“åŠ±è‡ªå·±çš„è¿™æ ·ä¸€ç§æ–¹å¼ï¼‰ï¼Œç„¶åè´¨é—®è‡ªå·±ï¼Œå°±è¿™æ ·å•¦ï¼Œä½ å°±è¿™ç‚¹ä¸œè¥¿ï¼Ÿï¼ˆæ˜¯çš„ï¼Œæˆ‘ä¹Ÿè¿™æ ·å‚»é€¼å¼è‡ªå˜²ï¼‰ä½ çœŸçš„çœŸçš„åˆ°äº†æœ€åæ­‡æ–¯åº•é‡Œä¸èƒ½åšæŒçš„åœ°æ­¥äº†å—ï¼Ÿ</span><br><span class="line"></span><br><span class="line">ä½ çš„ç†æƒ³æ˜¯è¯—ï¼Œç†æƒ³æ˜¯æ¢¦ï¼Œç†æƒ³æ˜¯è¿œæ–¹çš„ç”°é‡ï¼Œæ˜¯ç©¿è¶Šä¸–ç•Œçš„æ—…è¡Œï¼</span><br><span class="line"></span><br><span class="line">ä½†ç°åœ¨ä½ èƒ½åšçš„æ‰€æœ‰ï¼Œåªæ˜¯ï¼ŒæŠŠæ‰‹æ¡ç´§ï¼ï¼ˆå—¯ï¼‰</span><br><span class="line"></span><br><span class="line">åšç§¯è–„å‘ï¼ï¼ˆå—¯ï¼‰</span><br><span class="line"></span><br><span class="line">ä½ ï¼Œåªæœ‰ä»˜å‡ºï¼ï¼ˆå—¯ï¼‰</span><br><span class="line"></span><br><span class="line">ä»˜å‡ºä½ çš„æ—¶é—´ï¼ŒèµŒä¸Šä½ çš„å°Šä¸¥ï¼Œæ‹¿å‡ºä½ çš„å…¨éƒ¨ï¼ä½ çš„everything!ï¼ˆå—¯ï¼Œæ˜¯çš„ï¼ŒåŠªåŠ›äº†æ‰æœ‰æ”¶è·ï¼Œä¸åŠªåŠ›ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼‰</span><br><span class="line"></span><br><span class="line">å½“åˆ«äººæ‰“æ¸¸æˆæ—¶ä½ åœ¨å­¦ä¹ ï¼Œå½“åˆ«äººç¡æ‡’è§‰æ—¶ä½ åœ¨å­¦ä¹ ï¼Œä½ å«ç€æ³ªåœ¨æ·±å¤œé‡Œèˆè¹ˆï¼Œåœ¨å›å¿†é‡Œå¥”è·‘ï¼ï¼ˆå…¶å®è¿™å¥è¯å¥½åƒæ‰æ˜¯æ‰“åŠ¨æˆ‘çš„ç‚¹ï¼Œå°±æ˜¯å¬äº†è¿™äº›è¯å¾ˆå®¹æ˜“å°±è”æƒ³åˆ°ä»¥å‰è‡ªå·±åŠªåŠ›åšæŒçš„ä¸€äº›ç”»é¢è¿™æ ·å­ï¼‰</span><br><span class="line"></span><br><span class="line">æ²¡æœ‰äººï¼Œåœ¨å¹´å°‘æ—¶æƒ³æˆä¸ºä¸€ä¸ªæ™®é€šäººã€‚</span><br><span class="line"></span><br><span class="line">å°½ç®¡ç”Ÿæ´»ï¼Œå®ƒä¼šå‰¥å¤ºä½ çš„æ‰€çˆ±è·µè¸ä½ çš„å°Šä¸¥ï¼ŒæŠŠä½ è¸©åœ¨è„šä¸‹éä½“é³ä¼¤ã€‚</span><br><span class="line"></span><br><span class="line">ä½†ä½ ï¼Œæ€èƒ½ï¼Œå€’ä¸‹ï¼ï¼ˆä½†æˆ‘ï¼Œæ€èƒ½ï¼Œå€’ä¸‹ï¼ï¼‰</span><br><span class="line"></span><br><span class="line">ä½ çš„èº«åï¼Œæ˜¯æŒšçˆ±çš„äººï¼›</span><br><span class="line"></span><br><span class="line">é‚£äº›å—è¿‡çš„ä¼¤éƒ½å°†æˆä¸ºä½ çš„å‹‹ç« ï¼Œéƒ½æ˜¯ä½ ï¼Œé€ç»™æœªæ¥çš„è‡ªå·±æœ€å¥½çš„ç¤¼ç‰©ï¼ï¼ˆæ˜¯çš„ï¼Œå°±åƒæ˜¯æˆ‘ä¹‹å‰è¯´ï¼Œemmï¼Œå¸Œæœ›è‡ªå·±èƒ½å¤Ÿæˆä¸ºæœªæ¥çš„è‡ªå·±çš„ä¸€å—å«è„šçŸ³/è¸è„šçŸ³ï¼‰</span><br><span class="line"></span><br><span class="line">æˆ‘ï¼Œä¹Ÿæœ‰æ¢¦æƒ³å•Šï¼ï¼ˆæˆ‘çš„æ¢¦æƒ³æ˜¯ï¼Œåœ¨javaå¼€å‘è¿™ä¸€è¡Œå½“ä¸­æ…¢æ…¢çš„æ²‰æ·€è‡ªå·±ï¼Œé‡è§æ›´å¤šæ›´å¥½çš„äººï¼‰</span><br><span class="line"></span><br><span class="line">æˆ‘å‘Šè¯‰è‡ªå·±ï¼Œæ€»æœ‰ä¸€å¤©ï¼Œæˆ‘ä¼šç«™åœ¨é‡‘è‰²çš„èˆå°ä¸Šï¼Œèšå…‰ç¯æ‰“å‘æˆ‘ï¼Œæ‘„åƒæœºå¯¹å‡†æˆ‘ï¼Œæ‰€æœ‰äººçš„ç›®å…‰æ³¨è§†ç€æˆ‘ï¼Œæˆ‘èƒ½ç«™åœ¨å°ä¸Šä¾ƒä¾ƒè€Œè°ˆã€‚æ­¤åˆ»ï¼Œä¸–ç•Œåªæœ‰æˆ‘ä¸€äººï¼ï¼ˆemmä¸é”™ï¼‰</span><br><span class="line"></span><br><span class="line">æˆ‘è¦è®©å¹³æ—¥é‡Œè½»è”‘æˆ‘çš„å¯¹æ‰‹çŸ¥é“ï¼Œæˆ‘è¦è®©ä»–ä»¬äº²å£è¯´å‡ºé‚£ä¸‰ä¸ªå­—ï¼šï¼ˆæˆ‘çˆ±ä½ ï¼Ÿå¯¹ä¸èµ·ï¼Ÿæˆ‘æ¨ä½ ï¼Ÿæˆ‘å¯èƒ½å¹³æ—¶emmè‚¥çš‚å»çœ‹å¤šäº†ï¼Ÿï¼‰</span><br><span class="line"></span><br><span class="line">ä½ ï¼Œèµ¢äº†ï¼ï¼ˆå‰å®³ï¼‰</span><br><span class="line"></span><br><span class="line">å¦‚æœè¯´ï¼Œé’æ˜¥ï¼Œæ˜¯è¶³è¿¹ï¼Œé‚£æ¢¦æƒ³ï¼Œä¸€å®šï¼Œå«åšè¿œæ–¹ã€‚</span><br><span class="line"></span><br><span class="line">è¯·åŒå­¦ä»¬ç›¸ä¿¡ï¼Œç”Ÿæ´»æ˜æœ—ï¼Œä¸‡ç‰©å¯çˆ±ï¼›ï¼ˆæ˜¯çš„ï¼Œæˆ‘ç¡®å®ç›¸ä¿¡ç€è¿™å¥è¯ï¼‰</span><br><span class="line"></span><br><span class="line">äººé—´å€¼å¾—ï¼Œæœªæ¥å¯æœŸã€‚ï¼ˆæ˜¯çš„ï¼Œäººé—´å€¼å¾—ï¼Œæœªæ¥å¯æœŸï¼ï¼‰</span><br><span class="line"></span><br><span class="line">ï¼ˆåŠ æ²¹ï¼Œè¯¶æˆ‘åˆšæŠŠç½‘é¡µç»™å‰æ‰äº†ï¼Œä»–ç»“å°¾å…¶å®å¥½åƒä¹ŸåŒæ ·æ˜¯é èº¬äº†<span class="number">90</span>åº¦ï¼Œä¸é”™ã€‚å°ä¼™å­ã€‚ï¼‰</span><br></pre></td></tr></table></figure><h2 id="æœªé€‰æ‹©çš„è·¯"><a href="#æœªé€‰æ‹©çš„è·¯" class="headerlink" title="æœªé€‰æ‹©çš„è·¯"></a>æœªé€‰æ‹©çš„è·¯</h2><p>ä»å‰å¯èƒ½è§‰å¾—åäººåè¨€åªä¼šå‘ç”Ÿåœ¨åäººèº«ä¸Šï¼Œå…¶å®åäººä¹Ÿåªæ˜¯å°†è‡ªå·±çš„æ‰€æ„Ÿè¡¨è¾¾äº†å‡ºæ¥ï¼›æ¥çº¾è§£è‡ªå·±çš„æŸä¸€ç§æƒ…ç»ªè€Œå·²ï¼›å…¶å®å¾ˆå¤šçš„æ—¶å€™å»è¯»æŸä¸€é¦–å°è¯—æŸä¸€å¥ç»å…¸åå¥å†è”æƒ³ä¸€ä¸‹è‡ªå·±çš„ç”Ÿæ´»ï¼Œå¾ˆå¤šçš„æ—¶å€™æ˜¯çš„ç¡®æœ‰å¾ˆå¤§çš„ä¸€ä¸ªå…±åŒä¹‹å¤„çš„ã€‚<br>è¿™å°±æ˜¯å…±é¸£å§ã€‚<br>å°†è‡ªå·±çš„è¡¨è¾¾é€šè¿‡æ–‡å­—çš„å½¢å¼æ¸©æŸ”çš„è¡¨è¾¾äº†å‡ºæ¥ã€‚  </p><p>å¥½äº†ä¸è¯´äº†ï¼Œä»Šå¤©é¢è¯•é—®äº†å¾®æœåŠ¡ï¼Œæˆ‘ç›´æ¥è¯´æˆ‘ä¸ä¼šã€‚ç°åœ¨æŒ¨æ‰“çš„æ—¶å€™åˆ°äº†ã€‚å»çœ‹ä¹¦å»äº†ã€‚  </p><p>å¯¹äº†ï¼Œè¯»è¿™é¦–å°è¯—çš„æ—¶å€™ï¼Œbgmåˆ‡æ¢æˆ <strong>the right path</strong>è·Ÿé…å“¦~ï¼ˆthe right pathå…¶å®æœ‰æ®µæ—¶é—´ï¼Œåœ¨å»å¹´å§ï¼Œæˆ‘å¾ªç¯äº†å¾ˆä¹…ï¼Œå› ä¸ºæœ¬èº«å»å¹´æ˜¯ä¸€ä¸ªå®³æ€•æˆé•¿ä½†åˆæ¸´æœ›æˆé•¿ï¼Œè¿·èŒ«çš„ä¸€ä¸ªçŠ¶æ€ï¼ŒæŒºä¸§çš„ï¼Œæ‰€ä»¥è¯´ï¼Œè¿™ä¸ªæ—¶å€™è¦ä¹ˆæ‰¾æœ‹å‹å€¾è¯‰è¦ä¹ˆï¼Œå¬çº¯éŸ³ä¹é™ä¸‹å¿ƒæ¥å¬å¬è‡ªå·±å¿ƒåº•çš„å£°éŸ³ã€‚å»ºè®®ä¸€å®šè¦å°†è¿™ç§æƒ…ç»ªæ’è§£å‡ºæ¥ï¼Œä¸è¦å‹æŠ‘è‡ªå·±ï¼Œä¸å¥½ï¼Œå› ä¸ºç»å†è¿‡ï¼Œæ‰€ä»¥çŸ¥é“ï¼Œå»å­¦ä¼šå¦è¯šå­¦ä¼šæ€ä¹ˆæ ·å»æ¥å—å®¹çº³è‡ªå·±ã€‚å¸Œæœ›çœ‹æ–‡çš„é“å‹ä»¬ä¹Ÿèƒ½åƒæ¼”è®²äººä¸€æ ·ï¼Œæˆ–è®¸æ˜¯æ­¤åˆ»æˆ–è®¸æ˜¯æœªæ¥çš„æŸä¸€ä¸ªæ—¶é—´ç‚¹èƒ½å¤Ÿæ…¢æ…¢ç»½æ”¾å±äºè‡ªå·±çš„é‚£ä¸€æ˜Ÿå…‰äº®ã€‚ï¼‰  </p><p>è¯¶è¯¶è¯¶æˆ‘çªç„¶å‘ç°ï¼Œæˆ‘æ‹çš„è¿™ä¸ªç…§ç‰‡è·Ÿæˆ‘è¿™ä¸ªé€‰æ‹©çš„è·¯ï¼Œæœ‰ç‚¹ç›çš„è¿™æ ·ä¸€ä¸ªä½œç”¨ï¼Œå“ˆå“ˆå“ˆå“ˆå“ˆï¼Œä½ çœ‹ï¼Œè¿™æ—¶å€™æˆ‘ä»Šå¤©æ‹çš„äº‘ï¼Œå¾ˆæ¼‚äº®ï¼Œä¸åƒä¸€æ¡é“è·¯å—ï¼Ÿå“ˆå“ˆå“ˆå¯èƒ½æ˜¯æˆ‘æƒ³å¤šäº†å“ˆå“ˆå“ˆå“ˆã€‚  </p><p>å¥½äº†è¯ä¸å¤šè¯´æˆ‘æ’¤äº†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">ã€Šæœªé€‰æ‹©çš„è·¯ã€‹</span><br><span class="line"></span><br><span class="line">ç½—ä¼¯ç‰¹ å¼—ç½—æ–¯ç‰¹</span><br><span class="line"></span><br><span class="line">é»„è‰²çš„æ ‘æ—é‡Œåˆ†å‡ºä¸¤æ¡è·¯ï¼Œ</span><br><span class="line"></span><br><span class="line">å¯æƒœæˆ‘ä¸èƒ½åŒæ—¶å»æ¶‰è¶³ï¼Œ</span><br><span class="line"></span><br><span class="line">æˆ‘åœ¨é‚£è·¯å£ä¹…ä¹…ä¼«ç«‹ï¼Œ</span><br><span class="line"></span><br><span class="line">æˆ‘å‘ç€ä¸€æ¡è·¯æç›®æœ›å»ï¼Œ</span><br><span class="line"></span><br><span class="line">ç›´åˆ°å®ƒæ¶ˆå¤±åœ¨ä¸›æ—æ·±å¤„ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ä½†æˆ‘å´é€‰æ‹©äº†å¦å¤–ä¸€æ¡è·¯ï¼Œ</span><br><span class="line"></span><br><span class="line">å®ƒè’è‰å‡„å‡„ï¼Œååˆ†å¹½å¯‚ï¼Œ</span><br><span class="line"></span><br><span class="line">æ˜¾å¾—æ›´è¯±äººï¼Œæ›´ç¾ä¸½ï¼›</span><br><span class="line"></span><br><span class="line">è™½ç„¶åœ¨è¿™ä¸¤æ¡å°è·¯ä¸Šï¼Œ</span><br><span class="line"></span><br><span class="line">éƒ½å¾ˆå°‘ç•™ä¸‹æ—…äººçš„è¶³è¿¹ï¼›</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">è™½ç„¶é‚£å¤©æ¸…æ™¨è½å¶æ»¡åœ°ï¼Œ</span><br><span class="line"></span><br><span class="line">ä¸¤æ¡è·¯éƒ½æœªç»è„šå°æ±¡æŸ“ã€‚</span><br><span class="line"></span><br><span class="line">å•Šï¼Œç•™ä¸‹ä¸€æ¡è·¯ç­‰æ”¹æ—¥å†è§ï¼</span><br><span class="line"></span><br><span class="line">ä½†æˆ‘çŸ¥é“è·¯å¾„å»¶ç»µæ— å°½å¤´ï¼Œ</span><br><span class="line"></span><br><span class="line">ææ€•æˆ‘éš¾ä»¥å†è¿”å›ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ä¹Ÿè®¸å¤šå°‘å¹´ååœ¨æŸä¸ªåœ°æ–¹ï¼Œ</span><br><span class="line"></span><br><span class="line">æˆ‘å°†è½»å£°å¹æ¯æŠŠå¾€äº‹å›é¡¾ï¼š</span><br><span class="line"></span><br><span class="line">ä¸€ç‰‡æ ‘æ—é‡Œåˆ†å‡ºä¸¤æ¡è·¯ï¼Œ</span><br><span class="line"></span><br><span class="line">è€Œæˆ‘é€‰æ‹©äº†äººè¿¹æ›´å°‘çš„ä¸€æ¡ï¼Œ</span><br><span class="line"></span><br><span class="line">ä»æ­¤å†³å®šäº†æˆ‘ä¸€ç”Ÿçš„é“è·¯ã€‚</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;è§‚çœ‹ç¬”è®°ï¼š&lt;a href=&quot;https://www.bilibili.com/video/BV1j4411j79x/?spm_id_from
      
    
    </summary>
    
    
      <category term="å¿ƒæƒ…" scheme="https://fengshana.github.io/categories/%E5%BF%83%E6%83%85/"/>
    
    
      <category term="å¿ƒæƒ…" scheme="https://fengshana.github.io/tags/%E5%BF%83%E6%83%85/"/>
    
  </entry>
  
  <entry>
    <title>112èŠ‚Rediså…¥é—¨åˆ°ç²¾é€šã€é»‘é©¬ç¨‹åºå‘˜ã€‘</title>
    <link href="https://fengshana.github.io/2020/05/13/%E3%80%90REDIS%E3%80%91/%E3%80%90REDIS%E3%80%91112%E8%8A%82Redis%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A%E3%80%90%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98%E3%80%91/"/>
    <id>https://fengshana.github.io/2020/05/13/%E3%80%90REDIS%E3%80%91/%E3%80%90REDIS%E3%80%91112%E8%8A%82Redis%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A%E3%80%90%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98%E3%80%91/</id>
    <published>2020-05-13T13:49:09.207Z</published>
    <updated>2020-06-09T05:33:56.179Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è§‚çœ‹è§†é¢‘: <code>https://www.bilibili.com/video/BV1CJ411m7Gc?from=search&amp;seid=17203994801277039493</code>ã€‚</p><h2 id="112èŠ‚Rediså…¥é—¨åˆ°ç²¾é€šã€é»‘é©¬ç¨‹åºå‘˜ã€‘"><a href="#112èŠ‚Rediså…¥é—¨åˆ°ç²¾é€šã€é»‘é©¬ç¨‹åºå‘˜ã€‘" class="headerlink" title="112èŠ‚Rediså…¥é—¨åˆ°ç²¾é€šã€é»‘é©¬ç¨‹åºå‘˜ã€‘"></a>112èŠ‚Rediså…¥é—¨åˆ°ç²¾é€šã€é»‘é©¬ç¨‹åºå‘˜ã€‘</h2><h3 id="è¯¾ç¨‹å®‰æ’"><a href="#è¯¾ç¨‹å®‰æ’" class="headerlink" title="è¯¾ç¨‹å®‰æ’"></a>è¯¾ç¨‹å®‰æ’</h3><h4 id="Windowsç¯å¢ƒè¿›è¡Œè®²è§£"><a href="#Windowsç¯å¢ƒè¿›è¡Œè®²è§£" class="headerlink" title="Windowsç¯å¢ƒè¿›è¡Œè®²è§£"></a>Windowsç¯å¢ƒè¿›è¡Œè®²è§£</h4><ol><li>RedisåŸºç¡€</li></ol><ul><li>Rediså…¥é—¨</li><li>æ•°æ®ç±»å‹ï¼ˆæ•°æ®çš„å­˜å‚¨æ ¼å¼ï¼‰</li><li>é€šç”¨å‘½ä»¤</li><li>Jedisï¼ˆJavaå¦‚ä½•è¿æ¥redisä»¥åŠæ“ä½œredisï¼‰</li></ul><h4 id="Linuxç¯å¢ƒå®æ“ï¼ˆå®æ“æ€§å®ç”¨æ€§å¼ºï¼‰"><a href="#Linuxç¯å¢ƒå®æ“ï¼ˆå®æ“æ€§å®ç”¨æ€§å¼ºï¼‰" class="headerlink" title="Linuxç¯å¢ƒå®æ“ï¼ˆå®æ“æ€§å®ç”¨æ€§å¼ºï¼‰"></a>Linuxç¯å¢ƒå®æ“ï¼ˆå®æ“æ€§å®ç”¨æ€§å¼ºï¼‰</h4><ol start="2"><li>Redisé«˜çº§</li></ol><ul><li>æŒä¹…åŒ–</li><li>redis.conf</li><li>äº‹åŠ¡</li><li>é›†ç¾¤</li></ul><ol start="3"><li>Redisåº”ç”¨</li></ol><ul><li>ä¼ä¸šçº§è§£å†³æ–¹æ¡ˆ</li></ul><h3 id="rediså…¥é—¨-NoSQLä»‹ç»"><a href="#rediså…¥é—¨-NoSQLä»‹ç»" class="headerlink" title="rediså…¥é—¨-NoSQLä»‹ç»"></a>rediså…¥é—¨-NoSQLä»‹ç»</h3><h4 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h4><ul><li>Redisç®€ä»‹</li><li>Redisçš„ä¸‹è½½ä¸å®‰è£…</li><li>Redisçš„åŸºæœ¬æ“ä½œ</li></ul><h4 id="ä¸­å›½è¢«ä¸–ç•Œé»‘çš„æœ€æƒ¨çš„ä¸€å¤©"><a href="#ä¸­å›½è¢«ä¸–ç•Œé»‘çš„æœ€æƒ¨çš„ä¸€å¤©" class="headerlink" title="ä¸­å›½è¢«ä¸–ç•Œé»‘çš„æœ€æƒ¨çš„ä¸€å¤©"></a>ä¸­å›½è¢«ä¸–ç•Œé»‘çš„æœ€æƒ¨çš„ä¸€å¤©</h4><p>2007å¹´10æœˆ30æ—¥ï¼ŒåŒ—äº¬å¥¥è¿ä¼šé—¨ç¥¨é¢å‘å¢ƒå†…å…¬ä¼—ç¬¬äºŒé˜¶æ®µé¢„å”®æ­£å¼å¯åŠ¨ã€‚<br>ä¸Šåˆä¸€å¼€å§‹ï¼Œå…¬ä¼—æäº¤ç”³è¯·ç©ºå‰è¸Šè·ƒã€‚<br>ä¸Šåˆ9æ—¶è‡³10æ—¶ï¼Œå®˜æ–¹ç¥¨åŠ¡ç½‘ç«™çš„<font style="color:red">æµè§ˆé‡</font>è¾¾åˆ°äº†<font style="color:red">800ä¸‡æ¬¡</font>ï¼Œç¥¨åŠ¡å‘¼å«ä¸­å¿ƒçƒ­çº¿ä»9æ—¶è‡³10æ—¶çš„<font style="color:red">å‘¼å…¥é‡</font>è¶…è¿‡äº†<font style="color:red">380ä¸‡äººæ¬¡</font>ã€‚<br>ç”±äºç¬é—´è®¿é—®æ•°é‡è¿‡å¤§ï¼ŒæŠ€æœ¯ç³»ç»Ÿåº”å¯¹ä¸ç•…ï¼Œé€ æˆå¾ˆå¤šç”³è´­è€…æ— æ³•åŠæ—¶æäº¤ç”³è¯·ï¼Œä¸ºæ­¤èƒŒæ™¯å¥¥ç»„å§”ç¥¨åŠ¡ä¸­å¿ƒå¯¹å¹¿å¤§å…¬ä¼—æœªèƒ½åŠæ—¶ã€ä¾¿æ·åœ°å®ç°å¥¥è¿é—¨ç¥¨é¢„å®šè¡¨ç¤ºæ­‰æ„ã€‚  </p><p>äººå¤ªå¤šï¼ˆå…¨ä¸–ç•Œçš„å†²å‡»ï¼‰  </p><h4 id="ä¸å¯å›é¿çš„é—®é¢˜"><a href="#ä¸å¯å›é¿çš„é—®é¢˜" class="headerlink" title="ä¸å¯å›é¿çš„é—®é¢˜"></a>ä¸å¯å›é¿çš„é—®é¢˜</h4><p>å¥¥è¿ä¼šé—¨ç¥¨é¢„å”®ç³»ç»Ÿå¼€æ”¾ç¬¬ä¸€å¤©ï¼Œä¸Šåˆ9ç‚¹æ­£å¼å¼€å§‹å”®ç¥¨åˆ°ä¸­åˆ12ç‚¹ï¼Œ3ä¸ªå°æ—¶å†…ï¼Œç¥¨åŠ¡ç½‘ç«™è¢«æµè§ˆæ¬¡æ•°è¾¾åˆ°<font style="color:red">2000ä¸‡æ¬¡</font>ã€‚  </p><h4 id="ä¸€ä¸ªç¥å¥‡çš„ç½‘ç«™"><a href="#ä¸€ä¸ªç¥å¥‡çš„ç½‘ç«™" class="headerlink" title="ä¸€ä¸ªç¥å¥‡çš„ç½‘ç«™"></a>ä¸€ä¸ªç¥å¥‡çš„ç½‘ç«™</h4><p>æ˜¥è¿ï¼Œåˆ‡è‚¤ä¹‹ç—›ï¼ˆä¸€èˆ¬ä¸¤ç§çŠ¶æ€ï¼šæ­£åœ¨èµ°å‘å´©æºƒçš„è·¯ä¸Šorå´©æºƒï¼‰ï¼š <strong>ç›˜ç‚¹12306ï¼š ä¸€ä¸ªæ€»åœ¨â€œå´©æºƒä¸­â€çš„ç¥å¥‡ç½‘ç«™</strong><br><strong>æ·˜å®å´©å®Œ12306å´© è¿ç€4å¤©ï¼Œæ¯å¤©éƒ½æœ‰å¹³å°å´©æºƒâ€¦..</strong>  </p><p>å¯¹åº”çš„é—®é¢˜ç‚¹éƒ½æ˜¯è®¿é—®é‡æ¯”è¾ƒå¤§ï¼›  </p><h4 id="å¤§å‹ç¿»è½¦ç°åœº"><a href="#å¤§å‹ç¿»è½¦ç°åœº" class="headerlink" title="å¤§å‹ç¿»è½¦ç°åœº"></a>å¤§å‹ç¿»è½¦ç°åœº</h4><p><strong>äº¬ä¸œä¿ƒé”€çˆ†æœåŠ¡å™¨ åˆ˜å¼ºä¸œï¼šå†æä¸€æ¬¡</strong></p><ul><li>äººå‘˜è¿‡å¤š</li><li>è®¿é—®é‡æ¯”è¾ƒå¤§</li><li>æµé‡è¿‡å¤§</li></ul><h4 id="é—®é¢˜ç°è±¡"><a href="#é—®é¢˜ç°è±¡" class="headerlink" title="é—®é¢˜ç°è±¡"></a>é—®é¢˜ç°è±¡</h4><p><strong>è¡¨å±‚ç°è±¡</strong></p><ul><li><strong>æµ·é‡ç”¨æˆ·</strong></li><li><strong>é«˜å¹¶å‘</strong>ï¼ˆæ‰€æœ‰äººä¸€å—è¿›æ¥è®¿é—®ç½‘ç«™ï¼Œç½‘ç«™æ‰›ä¸ä½ï¼‰</li></ul><p><strong>æ ¸å¿ƒé—®é¢˜</strong></p><h4 id="ç½ªé­ç¥¸é¦–â€”â€“å…³ç³»å‹æ•°æ®åº“"><a href="#ç½ªé­ç¥¸é¦–â€”â€“å…³ç³»å‹æ•°æ®åº“" class="headerlink" title="ç½ªé­ç¥¸é¦–â€”â€“å…³ç³»å‹æ•°æ®åº“"></a>ç½ªé­ç¥¸é¦–â€”â€“å…³ç³»å‹æ•°æ®åº“</h4><p>æ•°æ®è®¿é—®ä¸­å½±å“å› ç´ ï¼š  </p><ul><li><strong>æ€§èƒ½ç“¶é¢ˆï¼šç£ç›˜IOæ€§èƒ½ä½ä¸‹</strong><ul><li>æ•°æ®åº“æ˜¯ä¿å­˜åœ¨ç£ç›˜ä¸Šçš„ï¼Œè€Œç£ç›˜çš„IOæ€§èƒ½ä¹Ÿå°±æ˜¯è¯»å†™æ€§èƒ½ç›¸å¯¹æ¥è¯´æ¯”è¾ƒä½ä¸‹ï¼›</li><li>CPUçš„æ•°æ®äº¤æ¢æ˜¯å’Œé«˜é€Ÿç¼“å­˜Cacheæ¥åšï¼›</li><li>Cacheçš„æ•°æ®äº¤æ¢å’Œå†…å­˜åšï¼›</li><li>å†…å­˜çš„æ•°æ®äº¤æ¢å’Œç¡¬ç›˜åšï¼›</li><li>æä¾›åŸºç¡€æ•°æ®çš„è¿™äº›ä¿¡æ¯åœ¨ç¡¬ç›˜ä¸Šå­˜å‚¨ï¼›è€Œä¸”æ˜¯ä¸€å±‚ä¸€å±‚çš„å¾€ä¸Šè¿›è¡Œä¼ é€’ï¼›å¯¼è‡´æ€§èƒ½ä½ä¸‹ï¼›</li></ul></li><li><strong>æ‰©å±•ç“¶é¢ˆï¼šæ•°æ®å…³ç³»å¤æ‚ï¼Œæ‰©å±•æ€§å·®ï¼Œä¸ä¾¿äºå¤§è§„æ¨¡é›†ç¾¤</strong><ul><li>æ•°æ®åº“ä¸­æ•°æ®çš„å­˜å‚¨æ ¼å¼ï¼›</li><li>æ•°æ®åº“ä¸ä»…ä»…å­˜å‚¨æ•°æ®ï¼›æ›´å¤šçš„è¿˜éœ€è¦è¿›è¡Œæè¿°æ•°æ®å…³ç³»ï¼ˆè¡¨ä¸è¡¨ä¹‹é—´çš„å¤šå…³è”ï¼‰ï¼›ï¼ˆå‘ˆç°ç½‘çŠ¶å…³è”ï¼Œå‰åäº¤å‰ï¼Œé”™ç»¼å¤æ‚ï¼Œæ‰©å±•æ€§å·®ï¼Œç‰µä¸€å‘è€ŒåŠ¨å…¨èº«ï¼‰</li></ul></li></ul><h4 id="è§£å†³æ€è·¯"><a href="#è§£å†³æ€è·¯" class="headerlink" title="è§£å†³æ€è·¯"></a>è§£å†³æ€è·¯</h4><h5 id="NoSQL"><a href="#NoSQL" class="headerlink" title="NoSQL"></a>NoSQL</h5><ul><li>é™ä½ç£ç›˜IOæ¬¡æ•°ï¼Œè¶Šä½è¶Šå¥½ï¼ˆé’ˆå¯¹IOæ€§èƒ½å·®ï¼‰ â€”â€”- å†…å­˜å­˜å‚¨</li><li>å»é™¤æ•°æ®é—´å…³ç³»ï¼Œè¶Šç®€å•è¶Šå¥½ â€”â€”â€“ ä¸å­˜å‚¨å…³ç³»ï¼Œä»…å­˜å‚¨æ•°æ®</li></ul><p>NoSQL: å³ <strong>Not-Only SQL</strong> ï¼ˆ<strong>æ³›æŒ‡</strong>éå…³ç³»å‹çš„æ•°æ®åº“ï¼‰ï¼Œï¼ˆ<strong>å®šä½</strong>ï¼‰ä½œä¸ºå…³ç³»å‹æ•°æ®åº“çš„<strong>è¡¥å……</strong>ï¼›<br>ï¼ˆ<br>æ•°æ®è¿˜æ˜¯å¾—å­˜åœ¨ç¡¬ç›˜ä¸Šï¼Œ<br>ä¸èƒ½å°†å…¨éƒ¨çš„æ•°æ®ç§»åˆ°å†…å­˜å½“ä¸­å»ï¼›<br>å†…å­˜å½“ä¸­çš„æ•°æ®è¿˜æ˜¯ä»ç¡¬ç›˜å½“ä¸­æ¥ï¼›<br>æ‰€ä»¥NoSQLçš„å®šä½æ˜¯è¡¥å……ï¼›<br>ï¼‰</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Not</span> <span class="string">ä¸ï¼›  </span></span><br><span class="line"><span class="attr">Only</span> <span class="string">ä»…ä»…ï¼›åªæ˜¯ï¼›  </span></span><br><span class="line"><span class="attr">Not</span> <span class="string">Only ä¸ä»…ä»…ï¼Œä¸åªæ˜¯ï¼›</span></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆæŒ‡å‘çš„å³ä¸ºåšäº‹æƒ…ä¸èƒ½å¤Ÿä»…ä»…åªç”¨SQLï¼›ä¸æ•°æ®å­˜å‚¨è®¿é—®çš„ç±»ä¼¼çš„<strong>æ³›æŒ‡</strong>ç§°ä½œæ˜¯NoSQLï¼›  </p><p>ä½œç”¨ï¼š åº”å¯¹åŸºäº<strong>æµ·é‡ç”¨æˆ·</strong>å’Œæµ·é‡æ•°æ®å‰æä¸‹çš„æ•°æ®å¤„ç†é—®é¢˜ï¼ˆ<strong>é«˜å¹¶å‘</strong>ï¼‰ï¼›</p><p>é’ˆå¯¹çš„æ˜¯å¤§é‡ç”¨æˆ·å¯¹å¤§é‡æ•°æ®è®¿é—®å‡ºç°çš„ä¸€ä¸ªé›†ä¸­çš„å¤§é‡è®¿é—®ä»è€Œå‡ºç°çš„é—®é¢˜ï¼›<br>å°‘é‡æ•°æ®å°‘é‡ç”¨æˆ·ä¾æ—§å¯ä»¥ä½¿ç”¨ä½†æ˜¯æœªå…æœ‰ç‚¹æ€é¸¡ç„‰ç”¨ç‰›åˆ€çš„æ„æ€ï¼›  </p><p>æ‰€ä»¥ä¸€å®šå¾—å®šä¹‰å¥½NoSQLæ˜¯ç”¨æ¥å¹²å˜›çš„ï¼›å®ƒæ˜¯å¯¹äºå…³ç³»å‹æ•°æ®åº“çš„è¡¥å……èµ·åˆ°è¯¥åšç”¨ï¼›  </p><p><strong>NoSQLç‰¹å¾</strong>ï¼š<br>ï¼ˆç‰¹å¾éƒ½æ˜¯ç›¸å¯¹çš„ï¼›æ²¡æœ‰ç»å¯¹çš„ç‰¹å¾ï¼›å…´è®¸å†è¿‡å‡ å¹´å°±æ˜¯æ™®éæ€§çš„ä¸€ä¸ªç‰¹ç‚¹äº†ï¼‰</p><ul><li><strong>å¯æ‰©å®¹ï¼Œå¯ä¼¸ç¼©</strong>ï¼›</li><li><strong>å¤§æ•°æ®</strong>é‡ä¸‹<strong>é«˜æ€§èƒ½</strong></li><li><strong>çµæ´»</strong>çš„<strong>æ•°æ®ç±»å‹</strong>ï¼ˆèƒ½å…¼å®¹æ•°æ®åº“ä¸­çš„æ•°æ®ï¼‰</li><li><strong>é«˜å¯ç”¨</strong>ï¼ˆä¸<strong>é›†ç¾¤</strong>ç›¸å…³è¿›è¡Œäº†è§£ï¼‰</li></ul><h5 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h5><p>å¸¸è§çš„<strong>NoSQLæ•°æ®åº“</strong>è§£å†³æ–¹æ¡ˆï¼š  </p><ul><li><font style="color:red;font-weight:bolder;">Redis</font></li><li>memcache</li><li>HBase</li><li>MongoDB</li></ul><p>å·²ç»åœ¨å¸‚åœºä¸Šå­˜ç•™äº†ä¸€å®šæ—¶é—´äº†ï¼›å¹¶ä¸æ˜¯æ–°å‡ºæ¥çš„è¿™æ ·ä¸€ç§æŠ€æœ¯ï¼›<br>é’ˆå¯¹çš„ä¸åŒåœºæ™¯ï¼›æ‰€ä½“ç°çš„ä»·å€¼ä¸ä¸€æ ·ï¼›  </p><h5 id="è§£å†³æ–¹æ¡ˆï¼ˆç”µå•†åœºæ™¯ä¸ºä¾‹ï¼‰"><a href="#è§£å†³æ–¹æ¡ˆï¼ˆç”µå•†åœºæ™¯ä¸ºä¾‹ï¼‰" class="headerlink" title="è§£å†³æ–¹æ¡ˆï¼ˆç”µå•†åœºæ™¯ä¸ºä¾‹ï¼‰"></a>è§£å†³æ–¹æ¡ˆï¼ˆç”µå•†åœºæ™¯ä¸ºä¾‹ï¼‰</h5><p><strong>MySQL</strong>  </p><ol><li>å•†å“åŸºæœ¬ä¿¡æ¯</li></ol><ul><li>åç§°</li><li>ä»·æ ¼</li><li>å‚å•†</li></ul><p><strong>MongoDB</strong>  </p><p>é«˜é€Ÿå¤„ç†ï¼Œä¸“ç”¨ä½œæ–‡æ¡£å¤„ç†çš„åœ°æ–¹ï¼›  </p><ol start="2"><li>å•†å“é™„åŠ ä¿¡æ¯</li></ol><ul><li>æè¿°</li><li>è¯¦æƒ…</li><li>è¯„è®º</li></ul><p><strong>åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ</strong></p><ol start="3"><li>å›¾ç‰‡ä¿¡æ¯</li></ol><p><strong>ESã€Luceneã€solr</strong></p><ol start="4"><li>æœç´¢å…³é”®å­—</li></ol><p><strong>Redisã€memcacheã€tair</strong>  </p><ol start="5"><li><strong>çƒ­ç‚¹</strong>ä¿¡æ¯(<strong>è®¿é—®æ€§è¾ƒé«˜</strong>)</li></ol><ul><li><strong>é«˜é¢‘</strong></li><li><strong>æ³¢æ®µæ€§</strong></li></ul><p>Redisæ‰€å¤„ä½ç½®ï¼š  </p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">-------------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">-------------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">ï¼ˆå•†å“è¯„ä»·ä¿¡æ¯ï¼‰|<span class="string">  </span>|<span class="string">        ï¼ˆçƒ­ç‚¹ä¿¡æ¯å­˜å‚¨ï¼‰</span>|<span class="string">  </span>|<span class="string">              </span>|<span class="string">    ï¼ˆæœç´¢å…³é”®å­—åŠå…¨æ–‡æ£€ç´¢ï¼‰</span>|<span class="string">  </span>|<span class="string">                         </span>|<span class="string"> </span>|<span class="string">ï¼ˆå•†å“å›¾ç‰‡ï¼‰</span></span><br><span class="line"><span class="string">-----------------------    ----------------------           </span>|<span class="string">                -----------------------          ----------------------</span></span><br><span class="line">|<span class="string"> MongoDBé›†ç¾¤ï¼ˆæ–‡æ¡£ï¼‰ </span>|<span class="string">     </span>|<span class="string"> Redisé›†ç¾¤ï¼ˆç¼“å­˜ï¼‰ </span>|<span class="string">            </span>|<span class="string">                </span>|<span class="string"> Solré›†ç¾¤ï¼ˆå…¨æ–‡æ£€ç´¢ï¼‰</span>|<span class="string">           </span>|<span class="string"> FastDFSé›†ç¾¤ï¼ˆå›¾ç‰‡ï¼‰</span>|</span><br><span class="line">-----------------------    ----------------------           |<span class="string">                -----------------------          ----------------------</span></span><br><span class="line"><span class="string">-------------------------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">-------------------------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">    </span>|<span class="string">              </span>|<span class="string">              </span>|<span class="string">              </span>|<span class="string">              </span>|<span class="string">              </span>|</span><br><span class="line">---------      ---------      ---------      ---------      ---------      ---------</span><br><span class="line">|<span class="string"> MySQL </span>|<span class="string">      </span>|<span class="string"> MySQL </span>|<span class="string">      </span>|<span class="string"> MySQL </span>|<span class="string">      </span>|<span class="string"> MySQL </span>|<span class="string">      </span>|<span class="string"> MySQL </span>|<span class="string">      </span>|<span class="string"> MySQL </span>|</span><br><span class="line">---------      ---------      ---------      ---------      ---------      ---------</span><br><span class="line">                                      åŸºæœ¬ä¿¡æ¯å­˜å‚¨</span><br></pre></td></tr></table></figure><h3 id="rediså…¥é—¨-redisç®€ä»‹"><a href="#rediså…¥é—¨-redisç®€ä»‹" class="headerlink" title="rediså…¥é—¨-redisç®€ä»‹"></a>rediså…¥é—¨-redisç®€ä»‹</h3><p>æ¦‚å¿µï¼š<font style="color:red;font-weight:bolder;">Redisï¼ˆRemote Dictionary Serverï¼‰</font>æ˜¯ç”¨<strong>Cè¯­è¨€</strong>å¼€å‘çš„ä¸€ä¸ªå¼€æºçš„é«˜æ€§èƒ½<font style="color:red;font-weight:bolder;">é”®å€¼å¯¹ï¼ˆkey-valueï¼‰</font>æ•°æ®åº“ã€‚  </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Remote è¿œç¨‹ï¼›  </span><br><span class="line">Dictionary å­—å…¸ï¼›ï¼ˆæä¾›åŠŸèƒ½ï¼‰  </span><br><span class="line">Server æœåŠ¡ï¼›</span><br></pre></td></tr></table></figure><p>ç±»ä¼¼äºJavaå½“ä¸­çš„ä¸€ç§ç»“æ„ã€å­˜å‚¨æ¨¡å‹Mapï¼›<br>æ¯”å¦‚è¯´åå­—å¯¹åº”äººï¼›<br>ï¼ˆä½†æ˜¯å¥½åƒä¸å¤ªé€‚åˆï¼Œèº«ä»½è¯å·å¯¹åº”äººå¯èƒ½è¿˜å¥½ä¸€ç‚¹ï¼‰<br>è¿™å°±å±äºä¸€ä¸ªé”®å€¼å¯¹ï¼›<br>Rediså°±æ˜¯è¿™æ ·çš„ä¸€ä¸ªæ•°æ®åº“ï¼›<br>Rediså½“ä¸­å­˜æ”¾çš„æ•°æ®å°±æ˜¯ä¸€ä¸ªé”®å¯¹åº”ä¸€ä¸ªå€¼è¿™æ ·å­ï¼›<br>ä¸åƒæ¥è§¦çš„MySQLæ•°æ®åº“ï¼›ï¼ˆæ•°æ®åº“ã€æ•°æ®è¡¨ã€è®°å½•è¡Œã€å€¼ï¼‰ï¼›<br>è€ŒRedisæ˜¯ä¸€ä¸ªé”®åˆ™å¯¹åº”ä¸€ä¸ªå–å€¼ï¼›è¿™ä¹Ÿæ˜¯å…¶æ€§èƒ½é«˜çš„ä¸€ä¸ªåŸå› ï¼›ï¼ˆä¸€ä¸ªåç§°å¯¹åº”ä¸€ä¸ªå€¼ï¼‰  </p><p>äº†è§£äº†Redisæ˜¯ä»€ä¹ˆä¹‹åä¸‹é¢å°±æ¥è¯´è¯´Redisçš„ç‰¹å¾äº†ï¼›  </p><h4 id="ç‰¹å¾"><a href="#ç‰¹å¾" class="headerlink" title="ç‰¹å¾"></a>ç‰¹å¾</h4><ol><li>æ•°æ®é—´<strong>æ²¡æœ‰å¿…ç„¶çš„å…³è”å…³ç³»</strong>ï¼ˆä¹Ÿç®—æ˜¯å…³ç³»å‹æ•°æ®åº“çš„å¼±åŠ¿ï¼‰</li><li>å†…éƒ¨é‡‡ç”¨<strong>å•çº¿ç¨‹</strong>æœºåˆ¶è¿›è¡Œå·¥ä½œï¼ˆä¸ä¼šæ‰‹è„‘å¹¶ç”¨ï¼Œæ“ä½œåŸå­æ€§å¼ºå°±èƒ½ä¿è¯å¾ˆå¤šå®‰å…¨æ€§çš„ä¸œè¥¿ï¼‰</li><li><strong>é«˜æ€§èƒ½</strong>ã€‚å®˜æ–¹æä¾›æµ‹è¯•æ•°æ®ï¼Œ50ä¸ªå¹¶å‘æ‰§è¡Œ 100 000 ä¸ªè¯·æ±‚ï¼Œè¯»çš„é€Ÿåº¦æ˜¯110000 æ¬¡/s ï¼Œ å†™çš„é€Ÿåº¦æ˜¯ 81000 æ¬¡/sã€‚</li><li><strong>å¤šæ•°æ®ç±»å‹</strong>æ”¯æŒ</li></ol><ul><li><strong>å­—ç¬¦ä¸²</strong>ç±»å‹ <strong>string</strong></li><li><strong>åˆ—è¡¨</strong>ç±»å‹ <strong>list</strong></li><li><strong>æ•£åˆ—</strong>ç±»å‹ <strong>hash</strong></li><li><strong>é›†åˆ</strong>ç±»å‹ <strong>set</strong></li><li><strong>æœ‰åºé›†åˆ</strong>ç±»å‹ <strong>sorted_set</strong></li></ul><ol start="5"><li><strong>æŒä¹…åŒ–</strong>æ”¯æŒã€‚å¯ä»¥è¿›è¡Œ<strong>æ•°æ®ç¾éš¾æ¢å¤</strong>ï¼ˆæ•°æ®åœ¨å†…å­˜å½“ä¸­è¿›è¡Œå­˜å‚¨ï¼Œå¿…å®šä¼šæœ‰çŸ­ç”µçš„æƒ…å†µï¼Œä¸‡ä¸€åœ¨å†…å­˜ä¸­å­˜å‚¨çš„æŸäº›é‡è¦æ•°æ®ä¸€æ—¦æ²¡äº†å¯å’‹åŠï¼›è¿™å°±å¾ˆå°´å°¬äº†ï¼›æ‰€ä»¥åšäº†ä¸ªæ•°æ®ç¾éš¾æ¢å¤å¤„ç†ï¼‰  </li></ol><h4 id="Redisçš„åº”ç”¨"><a href="#Redisçš„åº”ç”¨" class="headerlink" title="Redisçš„åº”ç”¨"></a>Redisçš„åº”ç”¨</h4><ul><li>ä¸º<strong>çƒ­ç‚¹æ•°æ®åŠ é€ŸæŸ¥è¯¢</strong>ï¼ˆä¸»è¦åœºæ™¯ï¼‰ï¼Œå¦‚çƒ­ç‚¹å•†å“ã€çƒ­ç‚¹æ–°é—»ã€çƒ­ç‚¹èµ„è®¯ã€æ¨å¹¿ç­‰é«˜è®¿é—®é‡ä¿¡æ¯ç­‰ï¼›ï¼ˆè¿™ä¸ªæ•°æ®å¿…ç„¶æˆä¸ºçƒ­ç‚¹ï¼‰  </li><li><strong>ä»»åŠ¡é˜Ÿåˆ—</strong>ï¼Œå¦‚ç§’æ€ã€æŠ¢è´­ã€è´­ç¥¨æ’é˜Ÿç­‰ï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰</li><li><strong>å³æ—¶ä¿¡æ¯æŸ¥è¯¢</strong>ï¼Œå¦‚ä¸ªä½æ’è¡Œæ¦œã€å„ç±»ç½‘ç«™è®¿é—®ç»Ÿè®¡ã€å…¬äº¤åˆ°ç«™ä¿¡æ¯ã€åœ¨çº¿äººæ•°ä¿¡æ¯ï¼ˆèŠå¤©å®¤ã€ç½‘ç«™ï¼‰ã€è®¾å¤‡ä¿¡å·ç­‰ï¼›ï¼ˆåˆ·æ–°é€Ÿåº¦å¿«ï¼ŒåŒ…æ‹¬ç¼“å­˜ç­‰æŠ€æœ¯ï¼Œä¿è¯å…¶å®æ—¶æ€§ï¼›ï¼‰</li><li><strong>æ—¶æ•ˆæ€§ä¿¡æ¯æ§åˆ¶</strong>ï¼Œå¦‚éªŒè¯ç æ§åˆ¶ï¼ˆ5åˆ†é’Ÿã€30åˆ†é’Ÿæœ‰æ•ˆç­‰ï¼‰ã€æŠ•ç¥¨æ§åˆ¶ç­‰ï¼›ï¼ˆæ—¶æ•ˆæ€§å¯ä»¥ä½¿ç”¨redisåšæ§åˆ¶ï¼‰</li><li><strong>åˆ†å¸ƒå¼æ•°æ®å…±äº«</strong>ï¼Œå¦‚åˆ†å¸ƒå¼é›†ç¾¤æ¶æ„ä¸­çš„sessionåˆ†ç¦»</li><li><strong>æ¶ˆæ¯é˜Ÿåˆ—</strong></li><li><strong>åˆ†å¸ƒå¼é”</strong></li></ul><h3 id="rediså…¥é—¨-redisä¸‹è½½å®‰è£…ä¸æœåŠ¡å¯åŠ¨"><a href="#rediså…¥é—¨-redisä¸‹è½½å®‰è£…ä¸æœåŠ¡å¯åŠ¨" class="headerlink" title="rediså…¥é—¨-redisä¸‹è½½å®‰è£…ä¸æœåŠ¡å¯åŠ¨"></a>rediså…¥é—¨-redisä¸‹è½½å®‰è£…ä¸æœåŠ¡å¯åŠ¨</h3><p>ç›®å½•ï¼š  </p><ul><li>Redisç®€ä»‹</li><li><font style="color:red;">Redisçš„ä¸‹è½½ä¸å®‰è£…</font></li><li>Redisçš„åŸºæœ¬æ“ä½œ</li></ul><h4 id="Redis-çš„ä¸‹è½½"><a href="#Redis-çš„ä¸‹è½½" class="headerlink" title="Redis çš„ä¸‹è½½"></a>Redis çš„ä¸‹è½½</h4><ul><li>Linuxï¼ˆé€‚ç”¨äºä¼ä¸šåŠå¼€å‘ï¼‰<ul><li>Redisé«˜çº§å¼€å§‹ä½¿ç”¨</li><li>ä»¥4.0ç‰ˆæœ¬ä½œä¸ºä¸»ç‰ˆæœ¬</li></ul></li><li>Windowsç‰ˆæœ¬ï¼ˆé€‚åˆé›¶åŸºç¡€å­¦ä¹ ï¼‰<ul><li>Rediså…¥é—¨ä½¿ç”¨</li><li>ä»¥3.2ç‰ˆæœ¬ä¸ºä¸»ç‰ˆæœ¬</li><li>ä¸‹è½½åœ°å€ï¼š<code>https://github.com/MSOpenTech/redis/tags</code></li><li>é€‰æ‹©æ­¤ç‰ˆæœ¬ä¸‹è½½ï¼š<code>https://github.com/microsoftarchive/redis/releases/tag/win-3.2.100</code></li><li>ä¸‹è½½ç±»å‹ï¼š<code>https://github.com/microsoftarchive/redis/releases/tag/win-3.2.100</code></li></ul></li></ul><p>Rediså®‰è£…ç‰¹åˆ«ç‰¹åˆ«ç‰¹åˆ«ç®€å•ï¼›ç»¿è‰²ç‰ˆè½¯ä»¶ï¼›è§£å‹ç¼©ä¸‹å³å¯ï¼›  </p><ul><li>é…ç½®ç›¸å…³<ul><li>redis.windows.conf</li><li>redis.windows-service.conf</li></ul></li><li>æ–‡æ¡£(è¯´æ˜æ€§å†…å®¹)<ul><li>Redis on Windows RElease Note.docx</li><li>Redis on Windows.docx</li><li>Windows Service Documentation.docx</li></ul></li><li>ä¸»è¦çœ‹çš„æ–‡ä»¶ï¼ˆexeæ–‡ä»¶ï¼‰<ul><li>redis-benchmark.exe<ul><li>redis-benchmark.exeç”¨äºæ¥åšæ€§èƒ½æµ‹è¯•ä½¿ç”¨</li></ul></li><li>redis-check-aof.exe<ul><li>ä½œç”¨ï¼šredis-check-aof.exeç”¨äºåšæŒä¹…åŒ–ä½¿ç”¨</li></ul></li><li>redis-cli.exe<ul><li>å…¨ç§°redis-clientï¼›</li></ul></li><li>redis-server.exe<ul><li>å¯åŠ¨redisçš„ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼›</li><li>å¯åŠ¨å®Œäº†ä¹‹åå°±ç›¸å½“äºmysqlå¯äº†ä¸€ä¸ªæœåŠ¡å™¨ç±»ä¼¼ï¼›</li><li>ä½†æ˜¯å¦‚æœæ˜¯éœ€è¦å»æ“ä½œè¿™ä¸ªredisæ•°æ®åº“å°±éœ€è¦ä½¿ç”¨å¦å¤–ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œä¹Ÿå°±æ˜¯å¦å¤–ä¸€ä¸ªexeå¯æ‰§è¡Œæ–‡ä»¶redis-cli.exe</li></ul></li></ul></li><li>ç›®å‰ä½¿ç”¨å¾—åˆ°çš„å³redis-server.exeä»¥åŠredis-cli.exe</li></ul><p>ä½¿ç”¨å³ï¼š<strong>åŒå‡»è¿è¡Œredis-server.exe</strong> æ–‡ä»¶å³å¯ï¼›  </p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"># è¿›ç¨‹å·ä»¥åŠå½“å‰å¯åŠ¨çš„æ—¶é—´ï¼›</span><br><span class="line">[<span class="number">2460</span>] <span class="number">24</span> Sep <span class="number">13</span>:<span class="number">11</span>:<span class="number">03.987</span></span><br><span class="line"></span><br><span class="line"># è­¦å‘Šæ²¡æœ‰æŒ‡å®šé…ç½®æ–‡ä»¶ï¼›å½“å‰ä½¿ç”¨çš„æ˜¯é»˜è®¤çš„é…ç½®æ–‡ä»¶</span><br><span class="line"># Warning: no config file specified, using the <span class="keyword">default</span> config.</span><br><span class="line"></span><br><span class="line"># ä¸ºäº†æŒ‡å®šé…ç½®æ–‡ä»¶æ‰€ä½¿ç”¨çš„çš„é…ç½®æ–‡ä»¶ä½ç½®</span><br><span class="line"># In order to specify a config file use F:\Redis\Redis-x64<span class="number">-3.2</span><span class="number">.100</span><span class="number">-6379</span>\redis-server.exe /path/to/redis.conf</span><br><span class="line"></span><br><span class="line"># redisç‰ˆæœ¬ ä»¥åŠemm å¤šå°‘ä½çš„æ˜¯</span><br><span class="line">Redis <span class="number">3.2</span><span class="number">.100</span> (<span class="number">00000000</span>/<span class="number">0</span>) <span class="number">64</span> bit</span><br><span class="line"></span><br><span class="line"># rediså½“å‰çš„ç«¯å£å·ï¼ˆrediså¯¹å¤–æä¾›æœåŠ¡ï¼Œæ‰€ä½¿ç”¨çš„çš„ç«¯å£å·æ˜¯<span class="number">6379</span>ï¼›ipåœ°å€å³æœ¬æœº<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="keyword">or</span> localhostï¼‰</span><br><span class="line">Port: <span class="number">6379</span></span><br><span class="line"></span><br><span class="line"># rediså½“å‰æ‰€å¯åŠ¨æ—¶çš„è¿›ç¨‹ process idå·</span><br><span class="line"># æ¯å¯åŠ¨ä¸€ä¸ªredisæœåŠ¡å°±ç›¸å½“äºæ˜¯ Redis redis=new Redis(); newäº†ä¸€ä¸ªRediså¯¹è±¡ä¸€æ ·</span><br><span class="line"># é‚£ä¹ˆä¸€ä¸ªå¯¹è±¡å°±æ˜¯ä¸€ä¸ªå®ä¾‹ï¼›é‚£ä¹ˆè¿™ä¸ªPIDå¯ä»¥è¯´æ˜¯è¿™ä¸ªå®ä¾‹çš„ID</span><br><span class="line"># æµ‹è¯•ï¼šå°†å½“å‰çš„è¿™ä¸ªåŒå‡»å‡ºæ¥çš„redis-server.exeè¿›è¡Œå…³é—­ï¼Œé‡æ–°åŒå‡»redis-server.exeæ—¶ä¼šå‘ç° PIDä¼šå‘ç”Ÿæ”¹å˜ä¸º<span class="number">13028</span>æˆ–è€…æ˜¯å…¶ä»–çš„æ•°å€¼</span><br><span class="line"># å¦‚æœæƒ³è¦æœ‰ä¸¤ä¸ªredis-serverçš„æœåŠ¡å¦‚ä½•å¤„ç†ï¼›åŒå‡»ä¸€æ¬¡redis-serverå†åŒå‡»ä¸€æ¬¡æ˜¯æ²¡æœ‰ç”¨çš„ï¼›è¿™æ ·çš„åšæ³•å¯¼è‡´çš„ç»“æœæ˜¯ç¬¬äºŒæ¬¡åŒå‡»çš„æ—¶å€™ä¼šå‡ºç°é—ªé€€ç°è±¡åŸå› å°±æ˜¯ç«¯å£<span class="number">6379</span>è¢«å ï¼›å³å› ä¸ºå·²ç»å­˜åœ¨äº†ä¸€ä¸ªredisæœåŠ¡äº†ï¼Œè€Œå­˜åœ¨çš„è¯¥redisæœåŠ¡çš„ç«¯å£å·æ˜¯<span class="number">6379</span></span><br><span class="line"># è¿™ä¸ªæ—¶å€™å°±è¦å»å¦å¤–ç”Ÿæˆä¸€ä¸ªredis.conf é…ç½®æ–‡ä»¶ï¼›ä¿®æ”¹å…¶ç«¯å£ä¸ºå…¶ä»–çš„å€¼ï¼›ä¸æœ¬æœºä¸Šç«¯å£å·æ•°å€¼ä¸å†²çªçš„ä¸€ä¸ªå€¼</span><br><span class="line"></span><br><span class="line">PID: <span class="number">2460</span></span><br><span class="line"></span><br><span class="line">      http:<span class="comment">//redis.io</span></span><br><span class="line"></span><br><span class="line"># ä»¥ä¸‹ä¸ºredisæœåŠ¡ç«¯çš„æ‰§è¡Œæ—¥å¿—</span><br><span class="line"># å›å¤´å»æ“ä½œäº†redis-cli.exeï¼›é‚£ä¹ˆå°±å°†ä¼šåœ¨redis-server.exeè¯¥cmdæ‰“æœåŠ¡ç«¯æ—¥å¿—ï¼›å“å‘€ï¼›å°±æ˜¯ä¸€ä¸ªæœåŠ¡ç«¯åå°ï¼›redis-cli.exeå°±æ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯åˆ«çº ç»“äº†ï¼›</span><br><span class="line">[<span class="number">13028</span>] <span class="number">24</span> Sep <span class="number">13</span>:<span class="number">11</span>:<span class="number">59</span>:<span class="number">345</span> # Server started. Redis version <span class="number">3.2</span><span class="number">.100</span></span><br><span class="line">[<span class="number">13028</span>] <span class="number">24</span> Sep <span class="number">13</span>:<span class="number">11</span>:<span class="number">59.345</span> * The server <span class="keyword">is</span> now ready to accept connections on port <span class="number">6379</span></span><br></pre></td></tr></table></figure><p>redisçš„å®¢æˆ·ç«¯ï¼Œ<strong>åŒå‡»è¿è¡Œredis-cli.exe</strong> æ–‡ä»¶å³å¯ï¼›ï¼ˆåœ¨æ­¤å¤„å°±èƒ½å¤Ÿå»æ“ä½œè¿æ¥æœåŠ¡ç«¯ï¼Œæ“ä½œçš„æ–¹å¼æ˜¯å‘½ä»¤è¡Œå¼çš„ï¼‰  </p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0.0.1:6379</span>&gt;</span><br></pre></td></tr></table></figure><h4 id="å®‰è£…Redis"><a href="#å®‰è£…Redis" class="headerlink" title="å®‰è£…Redis"></a>å®‰è£…Redis</h4><p>æ ¸å¿ƒæ–‡ä»¶ï¼š  </p><ul><li>redis-server.exe æœåŠ¡å™¨å¯åŠ¨å‘½ä»¤</li><li>redis-cli.exe å‘½ä»¤è¡Œå®¢æˆ·ç«¯</li><li>redis.windows.conf redisæ ¸å¿ƒé…ç½®æ–‡ä»¶</li><li>redis-benchmark.exe æ€§èƒ½æµ‹è¯•å·¥å…·</li><li>redis-check-aof.exe AOFæ–‡ä»¶ä¿®å¤å·¥å…·</li><li>redis-check-dump.exe RDBæ–‡ä»¶æ£€æŸ¥å·¥å…·ï¼ˆå¿«ç…§æŒä¹…åŒ–æ–‡ä»¶ï¼‰</li></ul><h4 id="å¯åŠ¨Redis"><a href="#å¯åŠ¨Redis" class="headerlink" title="å¯åŠ¨Redis"></a>å¯åŠ¨Redis</h4><p>æœåŠ¡å™¨å¯åŠ¨ä½¿ç”¨redis-server.exe<br>å®¢æˆ·ç«¯è¿æ¥ä½¿ç”¨redis-cli.exe  </p><p>æˆ–è€…é€šè¿‡CMD å‘½ä»¤æç¤ºç¬¦æ¥è¿›è¡Œå¯åŠ¨ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼›<br>windows+rè°ƒèµ·CMDï¼›</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\ASUS&gt;f:</span><br><span class="line"></span><br><span class="line">F:\&gt;cd Redis</span><br><span class="line"></span><br><span class="line">F:\Redis&gt;cd Redis-x64<span class="number">-3.2</span><span class="number">.100</span><span class="number">-6379</span></span><br><span class="line"></span><br><span class="line">F:\Redis\Redis-x64<span class="number">-3.2</span><span class="number">.100</span><span class="number">-6379</span>&gt;</span><br><span class="line"></span><br><span class="line">#æŸ¥çœ‹è¯¥ç›®å½•ä¸‹çš„å­ç›®å½•</span><br><span class="line">F:\Redis\Redis-x64<span class="number">-3.2</span><span class="number">.100</span><span class="number">-6379</span>&gt;dir</span><br><span class="line"></span><br><span class="line">F:\Redis\Redis-x64<span class="number">-3.2</span><span class="number">.100</span><span class="number">-6379</span>&gt;redis-server</span><br><span class="line"></span><br><span class="line">--------------------------------------------</span><br><span class="line"></span><br><span class="line"># å†è°ƒèµ·ä¸€ä¸ªCMDå‘½ä»¤æç¤ºç¬¦ shellç«¯</span><br><span class="line">C:\Users\ASUS&gt;f:</span><br><span class="line"></span><br><span class="line">F:\&gt;cd Redis</span><br><span class="line"></span><br><span class="line">F:\Redis&gt;cd Redis-x64<span class="number">-3.2</span><span class="number">.100</span><span class="number">-6379</span></span><br><span class="line"></span><br><span class="line">F:\Redis\Redis-x64<span class="number">-3.2</span><span class="number">.100</span><span class="number">-6379</span>&gt;</span><br><span class="line"></span><br><span class="line">#æŸ¥çœ‹è¯¥ç›®å½•ä¸‹çš„å­ç›®å½•</span><br><span class="line">F:\Redis\Redis-x64<span class="number">-3.2</span><span class="number">.100</span><span class="number">-6379</span>&gt;dir</span><br><span class="line"></span><br><span class="line">F:\Redis\Redis-x64<span class="number">-3.2</span><span class="number">.100</span><span class="number">-6379</span>&gt;redis-cli</span><br></pre></td></tr></table></figure><h3 id="rediså…¥é—¨-redisåŸºç¡€æ“ä½œ"><a href="#rediså…¥é—¨-redisåŸºç¡€æ“ä½œ" class="headerlink" title="rediså…¥é—¨-redisåŸºç¡€æ“ä½œ"></a>rediså…¥é—¨-redisåŸºç¡€æ“ä½œ</h3><p>ç›®å½•Contents:  </p><ul><li>Redisç®€ä»‹</li><li>Redisçš„ä¸‹è½½ä¸å®‰è£…</li><li>Redisçš„åŸºæœ¬æ“ä½œ</li></ul><h4 id="å‘½ä»¤è¡Œæ¨¡å¼å·¥å…·ä½¿ç”¨æ€è€ƒ"><a href="#å‘½ä»¤è¡Œæ¨¡å¼å·¥å…·ä½¿ç”¨æ€è€ƒ" class="headerlink" title="å‘½ä»¤è¡Œæ¨¡å¼å·¥å…·ä½¿ç”¨æ€è€ƒ"></a>å‘½ä»¤è¡Œæ¨¡å¼å·¥å…·ä½¿ç”¨æ€è€ƒ</h4><ul><li>åŠŸèƒ½æ€§å‘½ä»¤</li><li>æ¸…é™¤å±å¹•ä¿¡æ¯</li><li>å¸®åŠ©ä¿¡æ¯æŸ¥é˜…</li><li>é€€å‡ºæŒ‡ä»¤</li></ul><p>redis-å­˜æ”¾æ•°æ®(ç”¨äºå®¢æˆ·ç«¯æ“ä½œæŒ‡ä»¤)  </p><h5 id="ä¿¡æ¯æ·»åŠ -å¾€é‡Œæ”¾"><a href="#ä¿¡æ¯æ·»åŠ -å¾€é‡Œæ”¾" class="headerlink" title="ä¿¡æ¯æ·»åŠ (å¾€é‡Œæ”¾)"></a>ä¿¡æ¯æ·»åŠ (å¾€é‡Œæ”¾)</h5><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> key <span class="built_in">value</span> [EX <span class="built_in">seconds</span>] [PX <span class="built_in">milliseconds</span>] [NX|XX]</span><br></pre></td></tr></table></figure><ul><li>åŠŸèƒ½<blockquote><p>è®¾ç½® keyï¼Œvalue æ•°æ®</p></blockquote></li><li>å‘½ä»¤<blockquote><p><strong>set</strong> key value</p></blockquote></li><li>èŒƒä¾‹<blockquote><p>set name laowang</p></blockquote></li></ul><h5 id="ä¿¡æ¯æŸ¥è¯¢-å¾€å¤–å–"><a href="#ä¿¡æ¯æŸ¥è¯¢-å¾€å¤–å–" class="headerlink" title="ä¿¡æ¯æŸ¥è¯¢(å¾€å¤–å–)"></a>ä¿¡æ¯æŸ¥è¯¢(å¾€å¤–å–)</h5><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">get</span> <span class="built_in">key</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼›å¦‚æœ key ä¸å­˜åœ¨ï¼Œå°†è¿”å› nil(ç©º)  </p><ul><li>åŠŸèƒ½<blockquote><p>æ ¹æ® key æŸ¥è¯¢å¯¹åº”çš„ valueï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œè¿”å›ç©ºï¼ˆnilï¼‰</p></blockquote></li><li>å‘½ä»¤<blockquote><p><strong>get</strong> key</p></blockquote></li><li>èŒƒä¾‹<blockquote><p>get name</p></blockquote></li></ul><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">F:\&gt;cd Redis</span><br><span class="line"></span><br><span class="line">F:\Redis&gt;cd Redis-x64<span class="number">-3.2</span><span class="number">.100</span><span class="number">-6379</span></span><br><span class="line"></span><br><span class="line">F:\Redis\Redis-x64<span class="number">-3.2</span><span class="number">.100</span><span class="number">-6379</span>&gt;redis-cli</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; <span class="keyword">set</span> name laowang</span><br><span class="line">OK</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; <span class="keyword">get</span> name</span><br><span class="line"><span class="string">"laowang"</span></span><br><span class="line"></span><br><span class="line"># å–ä¸€ä¸ªä¸å­˜åœ¨çš„key</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; <span class="keyword">get</span> names</span><br><span class="line">(nil)</span><br><span class="line"></span><br><span class="line"># åœ¨rediså½“ä¸­è¿›è¡Œæ¸…é™¤å±å¹•æŒ‡ä»¤</span><br><span class="line">clear</span><br><span class="line"># åœ¨windowsï¼Œå³cmdä¸‹ä½¿ç”¨ cls è¿›è¡Œæ¸…å±</span><br></pre></td></tr></table></figure><h5 id="æ¸…é™¤å±å¹•ä¿¡æ¯"><a href="#æ¸…é™¤å±å¹•ä¿¡æ¯" class="headerlink" title="æ¸…é™¤å±å¹•ä¿¡æ¯"></a>æ¸…é™¤å±å¹•ä¿¡æ¯</h5><ul><li>åŠŸèƒ½<blockquote><p>æ¸…é™¤å±å¹•ä¸­çš„ä¿¡æ¯</p></blockquote></li><li>å‘½ä»¤<blockquote><p>clear</p></blockquote></li></ul><h5 id="å¸®åŠ©"><a href="#å¸®åŠ©" class="headerlink" title="å¸®åŠ©"></a>å¸®åŠ©</h5><ul><li>åŠŸèƒ½<blockquote><p>è·å–å‘½ä»¤å¸®åŠ©æ–‡æ¡£ï¼Œè·å–ç»„ä¸­æ‰€æœ‰å‘½ä»¤ä¿¡æ¯åç§°</p></blockquote></li><li>å‘½ä»¤<blockquote><p>help å‘½ä»¤å<br>  help @ç»„å</p></blockquote></li></ul><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"># å¦‚æœæƒ³è¦çœ‹ <span class="keyword">set</span> æŒ‡ä»¤å¦‚ä½•ä½¿ç”¨åˆ™è¾“å…¥ä»¥ä¸‹å‘½ä»¤è¡Œ</span><br><span class="line"></span><br><span class="line">F:\&gt;cd Redis</span><br><span class="line"></span><br><span class="line">F:\Redis&gt;cd Redis-x64<span class="number">-3.2</span><span class="number">.100</span><span class="number">-6379</span></span><br><span class="line"></span><br><span class="line">F:\Redis\Redis-x64<span class="number">-3.2</span><span class="number">.100</span><span class="number">-6379</span>&gt;redis-cli</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help <span class="keyword">get</span></span><br><span class="line"></span><br><span class="line">  GET key # å‘½ä»¤æ ¼å¼ï¼›å³æŒ‡ä»¤</span><br><span class="line">  summary: Get the value of a key # åŠŸèƒ½æè¿°ï¼›æ€»ç»“æè¿°ï¼Œè·å–ä¸€ä¸ªkeyæ‰€å¯¹åº”çš„å–å€¼</span><br><span class="line">  since: <span class="number">1.0</span><span class="number">.0</span> # å‡ºç°ç‰ˆæœ¬ï¼›æœ€æ—©çš„åœ¨<span class="number">1.0</span><span class="number">.0</span>ç‰ˆæœ¬å°±æœ‰æ­¤å‘½ä»¤ï¼›å½“å‰ç‰ˆæœ¬ä¸º<span class="number">3.2</span><span class="number">.100</span> è¯¥ç‰ˆæœ¬</span><br><span class="line">  group: <span class="built_in">string</span> # æ‰€å±ç¾¤ç»„ï¼›è¿™ä¸ªå‘½ä»¤å±äºä¸€ä¸ªç¾¤ç»„ï¼›è¯¥ç¾¤ç»„åç§°å«åš<span class="built_in">string</span>ï¼›</span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help</span><br><span class="line">redis-cli <span class="number">3.2</span><span class="number">.100</span></span><br><span class="line">To <span class="keyword">get</span> help about Redis commands type:</span><br><span class="line">      # å¯ä»¥å»è·å–ä¸€ä¸ªåˆ—è¡¨å‘½ä»¤</span><br><span class="line">      # å¯ä»¥è·å–å¾—åˆ°&lt;group&gt;åœ¨è¿™ä¸ªç¾¤ç»„å½“ä¸­çš„æ‰€æœ‰å‘½ä»¤</span><br><span class="line">      # å³æ¯”å¦‚è¯´ help @<span class="built_in">string</span> å¯ä»¥è·å–å¾—åˆ°åœ¨<span class="built_in">string</span>è¯¥ç¾¤ç»„å½“ä¸­çš„æ‰€æœ‰å‘½ä»¤</span><br><span class="line">      <span class="string">"help @&lt;group&gt;"</span> to <span class="keyword">get</span> a list of commands <span class="keyword">in</span> &lt;group&gt;</span><br><span class="line"></span><br><span class="line">      # help å‘½ä»¤åç§°å³å¯ä»¥è·å–å¾—åˆ°çš„æ˜¯æœ‰å…³äºè¯¥å‘½ä»¤çš„æ‰€æœ‰å¸®åŠ©ä¿¡æ¯</span><br><span class="line">      <span class="string">"help &lt;command&gt;"</span> <span class="keyword">for</span> help on &lt;command&gt;</span><br><span class="line"></span><br><span class="line">      #å¯ä»¥è·å–ä¸€ä¸ªåˆ—è¡¨å¯èƒ½å¸®åŠ©çš„æç¤º</span><br><span class="line">      <span class="string">"help &lt;tab&gt;"</span> to <span class="keyword">get</span> a list of possible help topics</span><br><span class="line"></span><br><span class="line">      # quitå³ç”¨äºé€€å‡º</span><br><span class="line">      <span class="string">"quit"</span> to exit</span><br><span class="line"></span><br><span class="line">To <span class="keyword">set</span> redis-cli perferences:</span><br><span class="line">      <span class="string">":set hints"</span> enable online hints</span><br><span class="line">      <span class="string">":set nohints"</span> disable online hints</span><br><span class="line">Set your preferences <span class="keyword">in</span> ~/.redisclirc</span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help <span class="keyword">set</span></span><br><span class="line"></span><br><span class="line">  SET key value [EX seconds] [PX milliseconds] [NX|XX]</span><br><span class="line">  summary: Set the <span class="built_in">string</span> value of a key</span><br><span class="line">  since: <span class="number">1.0</span><span class="number">.0</span></span><br><span class="line">  group: <span class="built_in">string</span></span><br><span class="line"></span><br><span class="line"># tab x <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @generic</span><br><span class="line"># tab x <span class="number">2</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @<span class="built_in">string</span></span><br><span class="line"># tab x <span class="number">3</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @list</span><br><span class="line"># tab x <span class="number">4</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @<span class="keyword">set</span></span><br><span class="line"># tab x <span class="number">5</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @sorted_set</span><br><span class="line"># tab x <span class="number">6</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @hash</span><br><span class="line"># tab x <span class="number">7</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @pubsub</span><br><span class="line"># tab x <span class="number">8</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @transactions</span><br><span class="line"># tab x <span class="number">9</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @connection</span><br><span class="line"># tab x <span class="number">10</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @server</span><br><span class="line"># tab x <span class="number">11</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @scripting</span><br><span class="line"># tab x <span class="number">12</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @hyperloglog</span><br><span class="line"># tab x <span class="number">13</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @cluster</span><br><span class="line"># tab x <span class="number">14</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @geo</span><br><span class="line"># tab x <span class="number">15</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @APPEND</span><br><span class="line"># tab x <span class="number">16</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @AUTH</span><br><span class="line"># tab x <span class="number">17</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @BGREWRITEAOF</span><br><span class="line"># tab x <span class="number">18</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @BGSAVE</span><br><span class="line"># tab x <span class="number">19</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @BITCOUNT</span><br><span class="line"># tab x <span class="number">20</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @BITFIELD</span><br><span class="line"># tab x <span class="number">21</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @BITOP</span><br><span class="line"># tab x <span class="number">22</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @BITPOS</span><br><span class="line"># tab x <span class="number">23</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @BLPOP</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @BRPOP</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @BRPOPLPUSH</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @CLIENT GETNAME</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @CLIENT KILL</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @CLIENT LIST</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @CLIENT REPLY</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @CLIENT SETNAME</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help @CLIENT ADDSLOTS</span><br><span class="line">.....</span><br><span class="line"></span><br><span class="line"># (æˆ‘åœ¨å¹²ä»€ä¹ˆå‚»é€¼äº‹ï¼Œæˆ‘ä»¥ä¸ºæœ‰å°½å¤´ï¼Œåœ¨è¿™é‡Œä¸€ç›´tab * n)</span><br></pre></td></tr></table></figure><h5 id="é€€å‡ºå®¢æˆ·ç«¯å‘½ä»¤è¡Œæ¨¡å¼"><a href="#é€€å‡ºå®¢æˆ·ç«¯å‘½ä»¤è¡Œæ¨¡å¼" class="headerlink" title="é€€å‡ºå®¢æˆ·ç«¯å‘½ä»¤è¡Œæ¨¡å¼"></a>é€€å‡ºå®¢æˆ·ç«¯å‘½ä»¤è¡Œæ¨¡å¼</h5><ul><li>åŠŸèƒ½<blockquote><p>é€€å‡ºå®¢æˆ·ç«¯</p></blockquote></li><li>å‘½ä»¤<blockquote><p>quit<br>  exit<br>  &lt;ESC &gt;</p></blockquote></li></ul><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># åœ¨cmdå½“ä¸­è¿›è¡Œæ‰“å¡redis-cliï¼›ç„¶åæŒ‰é”®escï¼›é€€å‡ºåˆ°dosçª—å£ä¸‹</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt;</span><br><span class="line"></span><br><span class="line">F:\Redis\Redis-x64<span class="number">-3.2</span><span class="number">.100</span><span class="number">-6379</span>&gt;</span><br></pre></td></tr></table></figure><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><h5 id="Rediså…¥é—¨"><a href="#Rediså…¥é—¨" class="headerlink" title="Rediså…¥é—¨"></a>Rediså…¥é—¨</h5><ol><li>Redisç®€ä»‹ï¼ˆNoSQLæ•°æ®åº“ï¼›é€šè¿‡ä»¥key-valueçš„å½¢å¼è¿›è¡Œå­˜å‚¨ï¼‰</li><li>Redisçš„ä¸‹è½½ä¸å®‰è£…ï¼ˆç»¿è‰²ç‰ˆæœ¬ï¼›å®¹æ˜“å®‰è£…ï¼›å½“å‰æ˜¯windowsç¯å¢ƒ3.2.100ç‰ˆæœ¬ï¼›åæœŸåŸºäºlinuxç¯å¢ƒ4.0ç‰ˆæœ¬æ¥è¿›è¡Œå®æ“ï¼‰</li><li>Redisçš„åŸºæœ¬æ“ä½œ<blockquote><ul><li>set/get(è®¾ç½®é”®å€¼ä¸å–å€¼)</li><li>clearï¼ˆæ¸…å±ï¼‰</li><li>helpï¼ˆè·å–å¸®åŠ©ä¿¡æ¯ï¼‰</li></ul></blockquote></li></ol><h3 id="æ•°æ®ç±»å‹-æ•°æ®ç±»å‹ç®€ä»‹"><a href="#æ•°æ®ç±»å‹-æ•°æ®ç±»å‹ç®€ä»‹" class="headerlink" title="æ•°æ®ç±»å‹-æ•°æ®ç±»å‹ç®€ä»‹"></a>æ•°æ®ç±»å‹-æ•°æ®ç±»å‹ç®€ä»‹</h3><h4 id="è¯¾ç¨‹å®‰æ’-1"><a href="#è¯¾ç¨‹å®‰æ’-1" class="headerlink" title="è¯¾ç¨‹å®‰æ’"></a>è¯¾ç¨‹å®‰æ’</h4><h5 id="è¯¾ç¨‹è®¡åˆ’"><a href="#è¯¾ç¨‹è®¡åˆ’" class="headerlink" title="è¯¾ç¨‹è®¡åˆ’"></a>è¯¾ç¨‹è®¡åˆ’</h5><h6 id="Windowsç¯å¢ƒ"><a href="#Windowsç¯å¢ƒ" class="headerlink" title="Windowsç¯å¢ƒ"></a>Windowsç¯å¢ƒ</h6><ol><li>redisåŸºç¡€<ul><li>Rediså…¥é—¨</li><li>æ•°æ®ç±»å‹</li><li>é€šç”¨å‘½ä»¤</li><li>Jedis</li></ul></li></ol><h6 id="linuxç¯å¢ƒ"><a href="#linuxç¯å¢ƒ" class="headerlink" title="linuxç¯å¢ƒ"></a>linuxç¯å¢ƒ</h6><ol start="2"><li><p>Redisé«˜çº§</p><ul><li>æŒä¹…åŒ–</li><li>redis.conf</li><li>äº‹åŠ¡</li><li>é›†ç¾¤</li></ul></li><li><p>Redisåº”ç”¨</p><ul><li>ä¼ä¸šçº§è§£å†³æ–¹æ¡ˆ</li></ul></li></ol><h4 id="Redisæ•°æ®ç±»å‹"><a href="#Redisæ•°æ®ç±»å‹" class="headerlink" title="Redisæ•°æ®ç±»å‹"></a>Redisæ•°æ®ç±»å‹</h4><h5 id="ç›®å½•Contents"><a href="#ç›®å½•Contents" class="headerlink" title="ç›®å½•Contents"></a>ç›®å½•Contents</h5><ul><li><font style="color:red;">æ•°æ®å­˜å‚¨ç±»å‹ä»‹ç»</font></li><li>string</li><li>hash</li><li>list</li><li>set</li><li>sorted_set</li><li>æ•°æ®ç±»å‹å®è·µæ¡ˆä¾‹</li></ul><h4 id="ä¸šåŠ¡æ•°æ®çš„ç‰¹æ®Šæ€§"><a href="#ä¸šåŠ¡æ•°æ®çš„ç‰¹æ®Šæ€§" class="headerlink" title="ä¸šåŠ¡æ•°æ®çš„ç‰¹æ®Šæ€§"></a>ä¸šåŠ¡æ•°æ®çš„ç‰¹æ®Šæ€§</h4><p>ä¸ºä»€ä¹ˆè®¾è®¡äº†äº”ç§æ•°æ®ç±»å‹ï¼ˆstringï¼Œlistï¼Œhashï¼Œsetï¼Œsorted_setï¼‰ï¼Œå³è¿™äº”ç§æ•°æ®ç±»å‹çš„å‰ä¸–ä»Šç”Ÿï¼›  </p><p>ä¸€å®šæ˜¯å‘ç°æŸä¸€ç§æ•°æ®å®ƒéœ€è¦å­˜å…¥åˆ°rediså½“ä¸­äº†ï¼›å†å°†è¿™ç§æ•°æ®çš„ç‰¹å¾æŠ½å‡ºæ¥ï¼›ç„¶ååšæˆä¸€ç§æ•°æ®ç±»å‹ï¼›ä¹Ÿå°±æ˜¯è¯´ç”¨åˆ°å“ªä¸€ç§å°±åšå“ªä¸€ç§ï¼›<br>ç„¶åæ€»ä¹‹åˆ°ç°åœ¨æ€»ç»“å‡ºæ¥äº†5ç§è¶³å¤Ÿä½¿ç”¨äº†å³è¶³å¤Ÿæ—¥å¸¸å¼€å‘äº†ï¼›<br>å¦‚æœæœ‰æ–°éœ€æ±‚æ¥äº†åˆéœ€è¦æ–°çš„æ•°æ®ç±»å‹ï¼›å³åé¢å†å»åŠ æ–°çš„æ•°æ®ç±»å‹è®¾è®¡æ–°çš„æ•°æ®ç±»å‹å³å¯ï¼›<br>ä¸”redisçš„æ•°æ®ç±»å‹å¹¶ä¸åªæœ‰è¿™äº”ç§æ•°æ®ç±»å‹ï¼ˆstringï¼Œlistï¼Œhashï¼Œsetï¼Œsorted_setï¼‰ï¼Œåé¢è¿˜ä¼šç»§ç»­ä»‹ç»å…¶ä»–çš„ä¸€äº›æ•°æ®ç±»å‹ï¼›  </p><p>æ€»ä¹‹è¿˜æ˜¯è¦å›æ¥åˆ†æä¸šåŠ¡æƒ…å†µï¼›é€šè¿‡å…·ä½“çš„ä¸šåŠ¡æƒ…å†µæ‰¾åˆ°åˆé€‚çš„æ•°æ®ç±»å‹è¿›è¡Œå­˜å‚¨æ•°æ®ï¼›<br>redisæœ€åˆå®šä½çš„æ˜¯ä½œä¸ºç¼“å­˜ä½¿ç”¨çš„ï¼›é‚£ä¹ˆç¼“å­˜å½“ä¸­æ”¾ä»€ä¹ˆï¼Œè¿™ä¸ªå°±å¾ˆå…³é”®ï¼›</p><h5 id="ä½œä¸ºç¼“å­˜ä½¿ç”¨"><a href="#ä½œä¸ºç¼“å­˜ä½¿ç”¨" class="headerlink" title="ä½œä¸ºç¼“å­˜ä½¿ç”¨"></a>ä½œä¸ºç¼“å­˜ä½¿ç”¨</h5><ol><li>åŸå§‹ä¸šåŠ¡åŠŸèƒ½è®¾è®¡ï¼ˆåº”ç”¨åœºæ™¯ï¼šç§’æ€ï¼‰<ul><li>ç§’æ€</li><li>äº¬ä¸œ618</li><li>å¤©çŒ«åŒåä¸€äº’åŠ¨</li><li>12306æ’é˜Ÿè´­ç¥¨</li></ul></li><li>è¿è¥å¹³å°ç›‘æ§åˆ°çš„çªå‘é«˜é¢‘è®¿é—®æ•°æ®<ul><li>çªå‘æ—¶æ”¿è¦é—»ï¼Œè¢«å¼ºåŠ¿å…³æ³¨å›´è§‚(å¨±ä¹å…«å¦é˜µ-ä¸æ˜çœŸç›¸çš„åƒç“œç¾¤ä¼—ï¼Œä¸èƒ½é¢„æœŸé¢„è®¡å…¶æˆä¸ºçƒ­ç‚¹æ¶ˆæ¯çƒ­ç‚¹æ–°é—»ï¼Œä½†æ˜¯å¯ä»¥è¿›è¡Œå¹³å°å¯¹å…¶ç›‘æ§å¤„ç†ï¼Œå¹³å°ç›‘æ§åˆ°å…¶ï¼ˆæœªè¢«é¢„æœŸæˆä¸ºçƒ­ç‚¹çš„ä¿¡æ¯ï¼‰è¢«é«˜é¢‘æ¬¡è®¿é—®)</li></ul></li><li>é«˜é¢‘ã€å¤æ‚çš„ç»Ÿè®¡æ•°æ®ï¼ˆåº”ç”¨åœºæ™¯ï¼šç›´æ’­åœ¨çº¿äººæ•°ï¼‰<ul><li>åœ¨çº¿äººæ•°</li><li>æŠ•ç¥¨æ’è¡Œæ¦œï¼ˆå¥³å›¢ç”·å›¢ç»™äººæŠ•ç¥¨å®æ—¶åˆ·æ–°ï¼‰</li></ul></li></ol><h5 id="é™„åŠ åŠŸèƒ½"><a href="#é™„åŠ åŠŸèƒ½" class="headerlink" title="é™„åŠ åŠŸèƒ½"></a>é™„åŠ åŠŸèƒ½</h5><p>æ¯”å¦‚è¯´å®¢æˆ·é‡çªç„¶å˜å¤šä»200ä¸ªçš„è®¿é—®é‡å®¢æˆ·åˆ°ä»¥ä¸‡ä¸ºå•ä½çš„å®¢æˆ·ï¼›ï¼ˆé«˜å¹¶å‘ï¼Œæœºå™¨æ”¯æ’‘ä¸ä½ï¼‰  </p><p>ç³»ç»ŸåŠŸèƒ½ä¼˜åŒ–æˆ–å‡çº§</p><ul><li>å•æœåŠ¡å™¨å‡çº§é›†ç¾¤</li><li>Sessionç®¡ç†</li><li>Tokenç®¡ç†</li></ul><h5 id="Redisæ•°æ®ç±»å‹ï¼ˆ5ç§å¸¸ç”¨çš„æ•°æ®ç±»å‹ï¼‰"><a href="#Redisæ•°æ®ç±»å‹ï¼ˆ5ç§å¸¸ç”¨çš„æ•°æ®ç±»å‹ï¼‰" class="headerlink" title="Redisæ•°æ®ç±»å‹ï¼ˆ5ç§å¸¸ç”¨çš„æ•°æ®ç±»å‹ï¼‰"></a>Redisæ•°æ®ç±»å‹ï¼ˆ5ç§å¸¸ç”¨çš„æ•°æ®ç±»å‹ï¼‰</h5><p>å¯ä»¥ä¸javaå½“ä¸­çš„æ•°æ®ç±»å‹è¿›è¡Œä¸€ä¸‹ç±»æ¯”è®°å¿†ï¼›å®ƒä»¬æœ‰å¾ˆå¤šçš„ç›¸ä¼¼ä¹‹å¤„ï¼›  </p><ul><li>string        String</li><li>hash          HashMap</li><li>list          LinkedList</li><li>set           HashSet</li><li>sorted_set    TreeSet</li></ul><h3 id="æ•°æ®ç±»å‹-stringåŸºæœ¬æ“ä½œ"><a href="#æ•°æ®ç±»å‹-stringåŸºæœ¬æ“ä½œ" class="headerlink" title="æ•°æ®ç±»å‹-stringåŸºæœ¬æ“ä½œ"></a>æ•°æ®ç±»å‹-stringåŸºæœ¬æ“ä½œ</h3><h4 id="ç›®å½•Contents-1"><a href="#ç›®å½•Contents-1" class="headerlink" title="ç›®å½•Contents"></a>ç›®å½•Contents</h4><ul><li>æ•°æ®å­˜å‚¨ç±»å‹ä»‹ç»</li><li>string</li><li>hash</li><li>list</li><li>set</li><li>sorted_set</li><li>æ•°æ®ç±»å‹å®è·µæ¡ˆä¾‹</li></ul><h4 id="redis-æ•°æ®å­˜å‚¨æ ¼å¼"><a href="#redis-æ•°æ®å­˜å‚¨æ ¼å¼" class="headerlink" title="redis æ•°æ®å­˜å‚¨æ ¼å¼"></a>redis æ•°æ®å­˜å‚¨æ ¼å¼</h4><p>å¯¹äºredisæ¥è¯´ï¼Œé‡Œé¢å­˜å‚¨æ•°æ®æ˜¯ä¸€ä¸ªæ˜ å°„å…³ç³»ï¼›</p><ul><li>redis è‡ªèº«æ˜¯ä¸€ä¸ª Mapï¼Œå…¶ä¸­æ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯é‡‡ç”¨ <font style="color:red;font-weight:bolder;">key: value</font> çš„å½¢å¼è¿›è¡Œå­˜å‚¨</li><li><font style="color:red;font-weight:bolder;">æ•°æ®ç±»å‹</font> æŒ‡çš„æ˜¯ å­˜å‚¨çš„æ•°æ® çš„ç±»å‹ï¼Œä¹Ÿå°±æ˜¯ value éƒ¨åˆ†çš„ç±»å‹ï¼Œkey éƒ¨åˆ†æ°¸è¿œéƒ½æ˜¯å­—ç¬¦ä¸²</li><li></li></ul><p>è¿™ä¸ªkeyï¼Œåç§°æ˜¯ç”¨æ¥è®¿é—®è¿™ä¸ªæ•°æ®ä½¿ç”¨çš„ï¼›</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Redis å­˜å‚¨ç©ºé—´</span><br><span class="line"></span><br><span class="line">å·¦è¾¹ä¸ºkey(æ°¸è¿œéƒ½æ˜¯å­—ç¬¦ä¸²)    å³è¾¹ä¸ºvalue</span><br><span class="line">---------------------------------------------</span><br><span class="line">|  name |                   |    laowang   |</span><br><span class="line">---------------------------------------------</span><br><span class="line"></span><br><span class="line">---------------------------------------------</span><br><span class="line">|  age  |                   |    101       |</span><br><span class="line">---------------------------------------------</span><br><span class="line"></span><br><span class="line">---------------------------------------------</span><br><span class="line">|  åç§°  |                  |    æ•°æ®     |</span><br><span class="line">---------------------------------------------</span><br><span class="line"></span><br><span class="line">---------------------------------------------</span><br><span class="line">|  key  |                   |    value     |</span><br><span class="line">---------------------------------------------</span><br></pre></td></tr></table></figure><h4 id="string-ç±»å‹"><a href="#string-ç±»å‹" class="headerlink" title="string ç±»å‹"></a>string ç±»å‹</h4><ul><li>å­˜å‚¨çš„æ•°æ®ï¼šå•ä¸ªæ•°æ®ï¼Œæœ€ç®€å•ï¼ˆæœ€å¸¸ç”¨ï¼‰çš„æ•°æ®å­˜å‚¨ç±»å‹ï¼Œä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„æ•°æ®å­˜å‚¨ç±»å‹</li><li>å­˜å‚¨æ•°æ®çš„æ ¼å¼ï¼šä¸€ä¸ªå­˜å‚¨ç©ºé—´ä¿å­˜ä¸€ä¸ªæ•°æ®</li><li>å­˜å‚¨å†…å®¹ï¼šé€šå¸¸ä½¿ç”¨å­—ç¬¦ä¸²ï¼Œå¦‚æœå­—ç¬¦ä¸²ä»¥æ•´æ•°çš„å½¢å¼å±•ç¤ºï¼Œå¯ä»¥ä½œä¸ºæ•°å­—æ“ä½œä½¿ç”¨ï¼ˆä½†æ˜¯ä»ç„¶æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼‰<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Redis å­˜å‚¨ç©ºé—´</span><br><span class="line"></span><br><span class="line">---------------------------------------------</span><br><span class="line">|  key1  |------------------&gt;|    laowang   |</span><br><span class="line">---------------------------------------------</span><br><span class="line">|  key1  |------------------&gt;|   4006184000 |</span><br><span class="line">---------------------------------------------</span><br></pre></td></tr></table></figure></li></ul><h4 id="string-ç±»å‹æ•°æ®çš„åŸºæœ¬æ“ä½œ"><a href="#string-ç±»å‹æ•°æ®çš„åŸºæœ¬æ“ä½œ" class="headerlink" title="string ç±»å‹æ•°æ®çš„åŸºæœ¬æ“ä½œ"></a>string ç±»å‹æ•°æ®çš„åŸºæœ¬æ“ä½œ</h4><ul><li>æ·»åŠ /ä¿®æ”¹æ•°æ®<figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> <span class="built_in">key</span> <span class="built_in">value</span></span><br></pre></td></tr></table></figure></li><li>è·å–æ•°æ®<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">get</span> <span class="keyword">value</span></span><br></pre></td></tr></table></figure></li><li>åˆ é™¤æ•°æ®<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">del</span> <span class="built_in">key</span></span><br></pre></td></tr></table></figure></li></ul><p>ç»ƒä¹ ï¼š  </p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">F:\Redis\Redis-x64<span class="number">-3.2</span><span class="number">.100</span><span class="number">-6379</span>&gt;redis-cli</span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; <span class="keyword">set</span> name laowang</span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; <span class="keyword">get</span> name</span><br><span class="line"><span class="string">"laowang"</span></span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; <span class="keyword">set</span> age <span class="number">11111</span></span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; <span class="keyword">get</span> age</span><br><span class="line"><span class="string">"11111"</span></span><br><span class="line"></span><br><span class="line"># åˆ é™¤è¯¥æ•°æ®åˆ™è¯¥æ•°æ®ä»rediså½“ä¸­ä¸å†æœ‰äº†ï¼›</span><br><span class="line"># åˆ é™¤å®Œæˆä¹‹åè¿”å› (<span class="built_in">int</span>eger) <span class="number">1</span> ä»£è¡¨åˆ é™¤æˆåŠŸï¼›</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; del age</span><br><span class="line">(<span class="built_in">int</span>eger) <span class="number">1</span></span><br><span class="line"></span><br><span class="line"># è¿™ä¸ªæ—¶å€™redisçš„å†…å­˜å½“ä¸­å°±ä¸å­˜åœ¨è¯¥key: ageï¼›value: <span class="number">11111</span> è¯¥æ•°æ®äº†ï¼›</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; <span class="keyword">get</span> age</span><br><span class="line">(nil)</span><br><span class="line"></span><br><span class="line"># å½“å†å»è¿›è¡Œåˆ é™¤ä¸€ä¸ªrediså†…å­˜å½“ä¸­ä¸å­˜åœ¨çš„æ•°æ®</span><br><span class="line"># è¿™ä¸ªæ—¶å€™å°±è¿”å› (<span class="built_in">int</span>eger)<span class="number">0</span> ï¼›è¡¨ç¤ºåˆ é™¤å¤±è´¥ï¼›</span><br><span class="line"># åœ¨rediså½“ä¸­ï¼Œæ“ä½œå¦‚æœæ˜¯ä»¥æˆåŠŸå¤±è´¥ä¸ºæ ‡è¯†çš„è¯ï¼›éƒ½æ˜¯ä½¿ç”¨çš„(<span class="built_in">int</span>eger) <span class="number">1</span> / (<span class="built_in">int</span>eger) <span class="number">0</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; del age</span><br><span class="line">(<span class="built_in">int</span>eger) <span class="number">0</span></span><br></pre></td></tr></table></figure><ul><li>æ·»åŠ /ä¿®æ”¹å¤šä¸ªæ•°æ®<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"># <span class="number">1.</span> m æ˜¯ å•è¯ Multiple[è‹± /ËˆmÊŒltÉªpl/] çš„ç®€å†™</span><br><span class="line"># <span class="number">2.</span> adj. å¤šé‡çš„ï¼›å¤šæ ·çš„ï¼›è®¸å¤šçš„ï¼›n. å€æ•°ï¼›[ç”µ]å¹¶è”ï¼›å¤æ•° multiples</span><br><span class="line"># <span class="number">3.</span> å°±æ˜¯å¤šä¸ªçš„æ„æ€ï¼Œmsetä¸€æ¬¡æ€§è®¾ç½®å¤šä¸ªé”®å€¼ï¼›mgetä¸€æ¬¡æ€§å–å¤šä¸ªå€¼å‡ºæ¥ï¼›</span><br><span class="line"># <span class="number">4.</span> ä»¥åŠåŸæ¥å¦‚æœå­˜åœ¨è¯¥keyä»¥åŠè¯¥keyæ‰€å¯¹åº”çš„å–å€¼ï¼›åˆ™å¦‚æœå†æ¬¡è®¾ç½®msetï¼›å°±å°†å‘ç”Ÿè¦†ç›–åŸæ¥keyçš„å–å€¼</span><br><span class="line"># <span class="number">5.</span> é€šè¿‡mgetè¿›è¡Œå–å‡ºä¸€ä¸ªä¸å­˜åœ¨çš„keyæ—¶åŒæ ·è¿”å›nilï¼›</span><br><span class="line"># <span class="number">6.</span> æ ¼å¼: mset key1 value1 key2 value2 ...</span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; mset a <span class="number">1</span> b <span class="number">2</span> c <span class="number">3</span> d <span class="number">4</span></span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; <span class="keyword">get</span> a</span><br><span class="line"><span class="string">"1"</span></span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; <span class="keyword">get</span> b</span><br><span class="line"><span class="string">"2"</span></span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; <span class="keyword">get</span> c</span><br><span class="line"><span class="string">"3"</span></span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; <span class="keyword">get</span> d</span><br><span class="line"><span class="string">"4"</span></span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; mget a b c d</span><br><span class="line"><span class="number">1</span>) <span class="string">"1"</span></span><br><span class="line"><span class="number">2</span>) <span class="string">"2"</span></span><br><span class="line"><span class="number">3</span>) <span class="string">"3"</span></span><br><span class="line"><span class="number">4</span>) <span class="string">"4"</span></span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; mset a <span class="number">111</span> b <span class="number">222</span> c <span class="number">333</span> d <span class="number">444</span></span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; mget a b c d</span><br><span class="line"><span class="number">1</span>) <span class="string">"111"</span></span><br><span class="line"><span class="number">2</span>) <span class="string">"222"</span></span><br><span class="line"><span class="number">3</span>) <span class="string">"333"</span></span><br><span class="line"><span class="number">4</span>) <span class="string">"444"</span></span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; mget a e c d</span><br><span class="line"><span class="number">1</span>) <span class="string">"111"</span></span><br><span class="line"><span class="number">2</span>) (nil)</span><br><span class="line"><span class="number">3</span>) <span class="string">"333"</span></span><br><span class="line"><span class="number">4</span>) <span class="string">"444"</span></span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; mget z i p</span><br><span class="line"><span class="number">1</span>) (nil)</span><br><span class="line"><span class="number">2</span>) (nil)</span><br><span class="line"><span class="number">3</span>) (nil)</span><br></pre></td></tr></table></figure></li><li>è·å–å¤šä¸ªæ•°æ®<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># æ ¼å¼ï¼šmget key1 key2 ...</span><br><span class="line"></span><br><span class="line"><span class="number">127.0.0.1:6379</span>&gt; set a <span class="number">11111</span></span><br><span class="line">OK</span><br></pre></td></tr></table></figure></li><li>è·å–æ•°æ®å­—ç¬¦ä¸ªæ•°ï¼ˆå­—ç¬¦ä¸²é•¿åº¦ï¼‰<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># æ ¼å¼ï¼šstrlen key</span><br><span class="line"></span><br><span class="line"># a è¯¥keyçš„valueæœ‰<span class="number">5</span>ä¸ªå­—ç¬¦ï¼ˆé•¿åº¦ï¼‰</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; strlen a</span><br><span class="line">(<span class="built_in">int</span>eger) <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; strlen name</span><br><span class="line">(<span class="built_in">int</span>eger) <span class="number">7</span></span><br></pre></td></tr></table></figure></li><li>è¿½åŠ ä¿¡æ¯åˆ°åŸå§‹ä¿¡æ¯åéƒ¨ï¼ˆå¦‚æœåŸå§‹ä¿¡æ¯å­˜åœ¨å°±è¿½åŠ ï¼Œå¦åˆ™æ–°å»ºï¼‰<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># æ ¼å¼ï¼šappend key value</span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; <span class="keyword">get</span> a</span><br><span class="line"><span class="string">"11111"</span></span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; append a <span class="number">22222</span></span><br><span class="line">(<span class="built_in">int</span>eger) <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; <span class="keyword">get</span> a</span><br><span class="line"><span class="string">"1111122222"</span></span><br><span class="line"></span><br><span class="line"># appendä¸€ä¸ªåœ¨rediså†…å­˜å½“ä¸­å¹¶ä¸å­˜åœ¨çš„keyä¹Ÿä¼šæˆåŠŸï¼›å³ä¸å­˜åœ¨åˆ™æ–°å»ºï¼›</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; append laowang <span class="number">999999</span></span><br><span class="line">(<span class="built_in">int</span>eger) <span class="number">6</span></span><br><span class="line"></span><br><span class="line"># å½“è¿™ä¸ªå˜é‡å¯¹åº”çš„å­˜å‚¨å€¼å¦‚æœå­˜åœ¨åˆ™è¿½åŠ ï¼›ä¸å­˜åœ¨åˆ™æ–°å»º</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; <span class="keyword">get</span> laowang</span><br><span class="line"><span class="string">"999999"</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="æ•°æ®ç±»å‹-å•æŒ‡ä»¤æ“ä½œä¸å¤šæŒ‡ä»¤æ“ä½œçš„é€‰æ‹©ä¹‹æƒ‘"><a href="#æ•°æ®ç±»å‹-å•æŒ‡ä»¤æ“ä½œä¸å¤šæŒ‡ä»¤æ“ä½œçš„é€‰æ‹©ä¹‹æƒ‘" class="headerlink" title="æ•°æ®ç±»å‹-å•æŒ‡ä»¤æ“ä½œä¸å¤šæŒ‡ä»¤æ“ä½œçš„é€‰æ‹©ä¹‹æƒ‘"></a>æ•°æ®ç±»å‹-å•æŒ‡ä»¤æ“ä½œä¸å¤šæŒ‡ä»¤æ“ä½œçš„é€‰æ‹©ä¹‹æƒ‘</h3><h4 id="string-ç±»å‹æ•°æ®çš„åŸºæœ¬æ“ä½œ-1"><a href="#string-ç±»å‹æ•°æ®çš„åŸºæœ¬æ“ä½œ-1" class="headerlink" title="string ç±»å‹æ•°æ®çš„åŸºæœ¬æ“ä½œ"></a>string ç±»å‹æ•°æ®çš„åŸºæœ¬æ“ä½œ</h4><p>å•æ•°æ®æ“ä½œä¸å¤šæ•°æ®æ“ä½œå¦‚ä½•é€‰æ‹©<br>ï¼ˆä»€ä¹ˆæ—¶å€™ç”¨setæ›´å¥½ï¼›ä»€ä¹ˆæ—¶å€™ç”¨msetæ›´å¥½ï¼‰</p><h4 id="å•æ•°æ®æ“ä½œä¸å¤šæ•°æ®æ“ä½œçš„é€‰æ‹©ä¹‹æƒ‘"><a href="#å•æ•°æ®æ“ä½œä¸å¤šæ•°æ®æ“ä½œçš„é€‰æ‹©ä¹‹æƒ‘" class="headerlink" title="å•æ•°æ®æ“ä½œä¸å¤šæ•°æ®æ“ä½œçš„é€‰æ‹©ä¹‹æƒ‘"></a>å•æ•°æ®æ“ä½œä¸å¤šæ•°æ®æ“ä½œçš„é€‰æ‹©ä¹‹æƒ‘</h4><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> <span class="built_in">key</span> <span class="built_in">value</span></span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line"><span class="built_in">vs</span></span><br></pre></td></tr></table></figure><p>mset key1 value1 key2 value2 â€¦</p><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">åŒºåˆ«ï¼š  </span><br><span class="line"></span><br><span class="line">* <span class="built_in">set</span>ä¸€æ¬¡æ€§åªèƒ½è®¾ç½®ä¸€ä¸ª<span class="built_in">key</span>çš„å–å€¼<span class="built_in">value</span></span><br><span class="line">* msetä¸€æ¬¡æ€§åªèƒ½è®¾ç½®å¤šä¸ª<span class="built_in">key</span>çš„å–å€¼<span class="built_in">value</span></span><br><span class="line">* <span class="built_in">get</span>ä¸mgetåŒç†</span><br><span class="line"></span><br><span class="line">ä¸€æ¡æŒ‡ä»¤çš„æ‰§è¡Œè¿‡ç¨‹</span><br></pre></td></tr></table></figure><hr><p>|           |â€”â€”â€“setâ€”-ã€‹|          |<br>| åº”ç”¨æœåŠ¡å™¨ |                | RedisæœåŠ¡|<br>|           |ã€Šâ€”â€”resultâ€”|          |</p><hr><p>ä¸€æ¡æŒ‡ä»¤æ‰§è¡Œçš„æ•´ä¸ªè¿‡ç¨‹<br>é¦–å…ˆæŒ‡ä»¤åˆ°è¾¾ä»¥åå‘é€ç»™redis;<br>redisæ‹¿åˆ°æŒ‡ä»¤ä»¥åï¼›ç»“æŸå®ŒæŠŠç»“æœè¿”å›ç»™æœåŠ¡å™¨ï¼›<br>é‚£ä¹ˆåœ¨è¿™ä¸ªè¿‡ç¨‹å½“ä¸­ï¼›<br>æœ‰è¿™ä¹ˆå‡ ä¸ªåœ°æ–¹æ˜¯éœ€è¦è€—è´¹æ—¶é—´çš„ï¼›</p><ol><li>setæŒ‡ä»¤ä»åº”ç”¨æœåŠ¡å™¨å‘é€åˆ°redisæœåŠ¡è¿™ä¸ªè¿‡ç¨‹æ˜¯éœ€è¦è€—è´¹æ—¶é—´çš„</li><li>åˆ°è¾¾redisæœåŠ¡ï¼Œæ‰§è¡ŒæŒ‡ä»¤åŒæ ·æ˜¯éœ€è¦è€—è´¹æ—¶é—´çš„</li><li>é‚£ä¹ˆredisè¿”å›æŸ¥è¯¢åˆ°çš„æ•°æ®å›å»åˆ°åº”ç”¨æœåŠ¡å™¨ä¹Ÿæ˜¯éœ€è¦è€—è´¹æ—¶é—´çš„ï¼›</li></ol><p>é‚£ä¹ˆå¦‚æœæ˜¯ä¸‰ä¸ªæŒ‡ä»¤çš„è¯ï¼›é‚£ä¹ˆä¸Šè¿°è¿‡ç¨‹å°†ä¼šæ˜¯ä¸€ä¸ªO(n)çš„è¿‡ç¨‹å³ä¸Šè¿°è¿‡ç¨‹æ‰§è¡Œ3éï¼›</p><ol><li>å‘é€æŒ‡ä»¤ x 3</li><li>æ‰§è¡ŒæŒ‡ä»¤ x 3</li><li>è¿”å›ç»“æœ x 3<br>é‚£ä¹ˆå…¶æ€»æ‰§è¡Œæ—¶é—´ä¸ºå¤šå°‘ï¼Ÿ<br>å‡å®šæŒ‡ä»¤å‘é€ä¸æŒ‡ä»¤è¿”å›çš„æ—¶é—´ä¸€æ ·é‚£ä¹ˆæ€»æ‰§è¡Œæ—¶é—´ä¸ºï¼š</li></ol><p>å•æŒ‡ä»¤ï¼ˆsetï¼‰3æ¡æŒ‡ä»¤çš„æ‰§è¡Œè¿‡ç¨‹æ—¶é—´ä¸º<br>å‘é€è¿”å›æ—¶é—´ x 6 + æ‰§è¡Œæ—¶é—´ x 3</p><p>å¦‚æœæ˜¯å¤šæŒ‡ä»¤ï¼ˆmsetï¼‰3æ¡æŒ‡ä»¤çš„æ‰§è¡Œè¿‡ç¨‹ä¸º<br>å‘é€è¿”å›æ—¶é—´ x 2 + æ‰§è¡Œæ—¶é—´ x 3</p><p>å‡è¡¡ä¸€ä¸‹å‘é€æ—¶é•¿å’Œæ‰§è¡Œæ—¶é•¿ä¹‹é—´çš„å…³ç³»ï¼›<br>å‡å¦‚è¯´å½“å‰éœ€è¦æ“ä½œ50ï¼ˆå¤§æ•°æ®é‡ï¼‰ä¸ªæ•°æ®ï¼›setä¸msetçš„æ•ˆç‡å·®è·ï¼›<br>æ²¡æœ‰æ˜ç¡®çš„ç»“è®ºè¯´ä»€ä¹ˆæ—¶å€™ç”¨setä»€ä¹ˆæ—¶å€™ç”¨msetï¼›<br>éƒ½æ˜¯ç»“åˆå…·ä½“çš„ä¸šåŠ¡æƒ…å†µæ‰èƒ½ä½œå‡ºé€‰æ‹©å‡ºæ›´é€‚åˆæŸä¸ªä¸šåŠ¡åœºæ™¯ä¸‹çš„æŒ‡ä»¤ï¼›</p><p>å¦‚æœä¸€æ¬¡å‘é€å®Œæ‰€æ¶ˆè€—çš„æ—¶é•¿æ‰§è¡Œå®Œçš„æ—¶é•¿éå¸¸çš„å¤§çš„è¯ï¼Œé‚£ä¹ˆå¯¹äºå•çº¿ç¨‹çš„ç¯å¢ƒæ¥è¯´å¹¶ä¸é€‚ç”¨ï¼›æ‰€ä»¥è¯´é¢å¯¹è¿™ç§æƒ…å†µä¸€å®šéœ€è¦åŠæ—¶åˆ‡å‰²ï¼›</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### æ•°æ®ç±»å‹-æ•°å€¼å¢å‡æ“ä½œ</span><br><span class="line"></span><br><span class="line">#### string ç±»å‹æ•°æ®çš„æ‰©å±•æ“ä½œ</span><br><span class="line"></span><br><span class="line">##### ä¸šåŠ¡åœºæ™¯</span><br><span class="line"></span><br><span class="line">åœ¨å¼€å‘å½“ä¸­ï¼Œéšç€ä¸šåŠ¡è¿›è¡Œæ•°æ®é‡ä¹Ÿä¼šè¶Šæ¥è¶Šå¤§ï¼›ä¸€å¼ è¡¨èƒ½å¤Ÿå­˜å‚¨çš„æ•°æ®é‡ä¸èƒ½å¤Ÿè®©å…¶æ— é™æçš„è¿›è¡Œæ‰©å¼ ï¼›å¦åˆ™ä¼šéå¸¸å½±å“æŸ¥è¯¢æ•ˆç‡ï¼›é‚£ä¹ˆè¿™ä¸ªæ—¶å€™é‡‡å–çš„æ–¹å¼å°±æ˜¯å°†ä¸€å¼ æ•°æ®é‡å¤§çš„è¡¨åˆ‡å‰²åˆ†å‰²æˆå‡ å¼ å°è¡¨ï¼›ç”šè‡³å°†ä¸€ä¸ªåº“å½“ä¸­çš„è¡¨åˆ†æ•£åˆ°å‡ ä¸ªåº“è¿™æ ·çš„å¤„ç†æ“ä½œï¼›é‚£ä¹ˆè¿™å¯¹åº”çš„æ“ä½œå³åˆ†åº“åˆ†è¡¨ï¼›</span><br><span class="line">åœ¨è¿™é‡Œä¸è€ƒè™‘åˆ†åº“é—®é¢˜ä»…ä»…è€ƒè™‘åˆ†è¡¨é—®é¢˜ï¼›</span><br><span class="line">é‚£ä¹ˆè¡¨æœ‰äº†è€Œè¡¨ä¸­çš„idæ˜¯ä¸€ä¸ªä¸€ä¸ªè¿ç»­è‡ªå¢çš„ï¼›</span><br><span class="line">é‚£ä¹ˆå¦‚æœå°†è¿™äº›æ•°æ®åˆ†åˆ°åˆ«çš„è¡¨å½“ä¸­ï¼›</span><br><span class="line">å°±å°†ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜ï¼›æ¯ä¸€ä¸ªè¡¨æ§åˆ¶è‡ªå·±çš„ä¸»é”®è‡ªå¢ï¼›ä¼šå‡ºç°é—®é¢˜ï¼›å³ä¸»é”®é‡å¤ï¼›</span><br><span class="line">äºæ˜¯å°±éœ€è¦å»è§£å†³ä¸»é”®é‡å¤çš„é—®é¢˜ï¼›</span><br><span class="line"></span><br><span class="line">å¤§å‹ä¼ä¸šåŠåº”ç”¨ä¸­ï¼Œåˆ†è¡¨æ“ä½œæ˜¯åŸºæœ¬æ“ä½œï¼Œä½¿ç”¨å¤šå¼ è¡¨å­˜å‚¨åŒç±»å‹æ•°æ®ï¼›</span><br><span class="line">ä½†æ˜¯å¯¹åº”çš„ä¸»é”® id å¿…é¡»ä¿è¯ç»Ÿä¸€æ€§ï¼Œä¸èƒ½é‡å¤ã€‚</span><br><span class="line">Oracleæ•°æ®åº“å…·æœ‰ sequence è®¾å®šï¼ˆæœ‰åºåˆ—çš„æ¦‚å¿µæ‰€ä»¥å¯ä»¥è§£å†³åˆ†è¡¨æ—¶ä¸»é”®é‡å¤é—®é¢˜ï¼‰ï¼Œå¯ä»¥è§£å†³è¯¥é—®é¢˜ã€‚</span><br><span class="line">ä½†æ˜¯ MySQL æ•°æ®åº“å¹¶ä¸å…·æœ‰ç±»ä¼¼çš„æœºåˆ¶ï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•è§£å†³ï¼Ÿ</span><br><span class="line"></span><br><span class="line">æŠŠåŸæ¥çš„è¡¨åˆ†æˆè‹¥å¹²å¼ è¡¨ä¹‹åï¼›åªè¦ä¿è¯ä¸€ç‚¹ï¼›æ‰€æœ‰çš„ä¸»é”®idä¸é‡å¤å³å¯ï¼›  </span><br><span class="line">è¿™ä¸ªä¸»é”®idåŸæœ¬ç”±æ•°æ®åº“æ§åˆ¶ç°åœ¨ç”±å…¶ä»–æœåŠ¡è¿›è¡Œæ§åˆ¶ï¼›</span><br><span class="line"></span><br><span class="line">##### è§£å†³æ–¹æ¡ˆ</span><br><span class="line"></span><br><span class="line">* è®¾ç½®æ•°å€¼æ•°æ®å¢åŠ æŒ‡å®šèŒƒå›´çš„å€¼</span><br></pre></td></tr></table></figure><p>  incr key<br>  incrby key increment<br>  incrbyfloat key increment<br>  <figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">* </span>è®¾ç½®æ•°å€¼æ•°æ®å‡å°‘æŒ‡å®šèŒƒå›´çš„å€¼</span><br></pre></td></tr></table></figure><br>  decr key<br>  decrby key decrement<br>  <figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">å¯¹ä¸€ä¸ªå­—ç¬¦ä¸²è¿›è¡Œæ“ä½œï¼›å¦‚æœè¯¥å­—ç¬¦ä¸²çš„å–å€¼æ˜¯ä¸€ä¸ªçº¯æ•°å­—ï¼›</span><br><span class="line">é‚£ä¹ˆå¯¹å…¶è¿›è¡Œ+<span class="number">1</span>ï¼ˆincrementï¼‰/<span class="number">-1</span>ï¼ˆdecrementï¼‰æ“ä½œ</span><br></pre></td></tr></table></figure><br>127.0.0.1:6379&gt; set num 1<br>OK</p><p>127.0.0.1:6379&gt; incr num<br>(integer) 2</p><p>127.0.0.1:6379&gt; get num<br>â€œ2â€</p><p>127.0.0.1:6379&gt; incr num<br>(integer) 3</p><p>127.0.0.1:6379&gt; incr num<br>(integer) 4</p><p>127.0.0.1:6379&gt; get num<br>â€œ4â€</p><p>127.0.0.1:6379&gt; decr num<br>(integer) 3</p><p>127.0.0.1:6379&gt; get num<br>â€œ3â€</p><h1 id="æŸ¥çœ‹-incrby-å‘½ä»¤è¯¦ç»†"><a href="#æŸ¥çœ‹-incrby-å‘½ä»¤è¯¦ç»†" class="headerlink" title="æŸ¥çœ‹ incrby å‘½ä»¤è¯¦ç»†"></a>æŸ¥çœ‹ incrby å‘½ä»¤è¯¦ç»†</h1><p>127.0.0.1:6379&gt; help incrby</p><p>  INCRBY key increment</p><h1 id="ä¸ºä¸€ä¸ªkeyå¢åŠ ä¸€ä¸ªæ•´æ•°å€¼ï¼›by-the-given-amount-ç”¨ç»™å®šçš„å€¼è¿›è¡Œå¢åŠ ï¼›"><a href="#ä¸ºä¸€ä¸ªkeyå¢åŠ ä¸€ä¸ªæ•´æ•°å€¼ï¼›by-the-given-amount-ç”¨ç»™å®šçš„å€¼è¿›è¡Œå¢åŠ ï¼›" class="headerlink" title="ä¸ºä¸€ä¸ªkeyå¢åŠ ä¸€ä¸ªæ•´æ•°å€¼ï¼›by the given amount ç”¨ç»™å®šçš„å€¼è¿›è¡Œå¢åŠ ï¼›"></a>ä¸ºä¸€ä¸ªkeyå¢åŠ ä¸€ä¸ªæ•´æ•°å€¼ï¼›by the given amount ç”¨ç»™å®šçš„å€¼è¿›è¡Œå¢åŠ ï¼›</h1><h1 id="å³é»˜è®¤incr-æ˜¯-1ï¼›decr-æ˜¯-1"><a href="#å³é»˜è®¤incr-æ˜¯-1ï¼›decr-æ˜¯-1" class="headerlink" title="å³é»˜è®¤incr æ˜¯+1ï¼›decr æ˜¯ -1"></a>å³é»˜è®¤incr æ˜¯+1ï¼›decr æ˜¯ -1</h1><h1 id="è€Œincrby-ä¸-decrby-åˆ™æ˜¯è®©å®ƒ-nï¼›æˆ–è€…æ˜¯è®©å®ƒ-nï¼›"><a href="#è€Œincrby-ä¸-decrby-åˆ™æ˜¯è®©å®ƒ-nï¼›æˆ–è€…æ˜¯è®©å®ƒ-nï¼›" class="headerlink" title="è€Œincrby ä¸ decrby åˆ™æ˜¯è®©å®ƒ +nï¼›æˆ–è€…æ˜¯è®©å®ƒ -nï¼›"></a>è€Œincrby ä¸ decrby åˆ™æ˜¯è®©å®ƒ +nï¼›æˆ–è€…æ˜¯è®©å®ƒ -nï¼›</h1><p>  summary: Increment the integer value of a key by the given amount<br>  since: 1.0.0<br>  group: string</p><p>127.0.0.1:6379&gt; incrby num 10<br>(integer) 13</p><p>127.0.0.1:6379&gt; get num<br>â€œ13â€</p><p>127.0.0.1:6379&gt; decrby num 2<br>(integer) 11</p><p>127.0.0.1:6379&gt; get num<br>â€œ11â€</p><h1 id="incrbyfloat-floatåˆ™ä¸å°æ•°æœ‰å…³ï¼›"><a href="#incrbyfloat-floatåˆ™ä¸å°æ•°æœ‰å…³ï¼›" class="headerlink" title="incrbyfloat floatåˆ™ä¸å°æ•°æœ‰å…³ï¼›"></a>incrbyfloat floatåˆ™ä¸å°æ•°æœ‰å…³ï¼›</h1><p>127.0.0.1:6379&gt; incrbyfloat num 0.5<br>â€œ11.5â€</p><p>127.0.0.1:6379&gt; get num<br>â€œ11.5â€</p><p>127.0.0.1:6379&gt; incrbyfloat num 0.00000000009<br>â€œ11.500000000089999â€</p><p>127.0.0.1:6379&gt; get num<br>â€œ11.500000000089999â€</p><h1 id="å°è¯•-incrby-æ·»åŠ çš„incrementä¸ºfloatç±»å‹å–å€¼"><a href="#å°è¯•-incrby-æ·»åŠ çš„incrementä¸ºfloatç±»å‹å–å€¼" class="headerlink" title="å°è¯• incrby æ·»åŠ çš„incrementä¸ºfloatç±»å‹å–å€¼"></a>å°è¯• incrby æ·»åŠ çš„incrementä¸ºfloatç±»å‹å–å€¼</h1><p>127.0.0.1:6379&gt; incrby num 0.9</p><h1 id="æŠ¥é”™ï¼›é”™è¯¯å€¼ä¸æ˜¯ä¸€ä¸ªintegerç±»å‹å–å€¼æˆ–è€…è¶…å‡ºå…¶èŒƒå›´å–å€¼"><a href="#æŠ¥é”™ï¼›é”™è¯¯å€¼ä¸æ˜¯ä¸€ä¸ªintegerç±»å‹å–å€¼æˆ–è€…è¶…å‡ºå…¶èŒƒå›´å–å€¼" class="headerlink" title="æŠ¥é”™ï¼›é”™è¯¯å€¼ä¸æ˜¯ä¸€ä¸ªintegerç±»å‹å–å€¼æˆ–è€…è¶…å‡ºå…¶èŒƒå›´å–å€¼"></a>æŠ¥é”™ï¼›é”™è¯¯å€¼ä¸æ˜¯ä¸€ä¸ªintegerç±»å‹å–å€¼æˆ–è€…è¶…å‡ºå…¶èŒƒå›´å–å€¼</h1><p>(error) ERR value is not an integer or out of range</p><h1 id="å³-incrã€incrbyã€decrã€decrbyä¸“ç”¨äºæ“ä½œæ•´æ•°ï¼›incrbyfloatç”¨äºæ“ä½œå°æ•°"><a href="#å³-incrã€incrbyã€decrã€decrbyä¸“ç”¨äºæ“ä½œæ•´æ•°ï¼›incrbyfloatç”¨äºæ“ä½œå°æ•°" class="headerlink" title="å³ incrã€incrbyã€decrã€decrbyä¸“ç”¨äºæ“ä½œæ•´æ•°ï¼›incrbyfloatç”¨äºæ“ä½œå°æ•°"></a>å³ incrã€incrbyã€decrã€decrbyä¸“ç”¨äºæ“ä½œæ•´æ•°ï¼›incrbyfloatç”¨äºæ“ä½œå°æ•°</h1><h1 id="éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼šincrby-ä¸-decrby-åé¢çš„å–å€¼-incrementä¸-decrementå¯ä»¥æ˜¯æ­£æ•°ä¹Ÿå¯ä»¥æ˜¯è´Ÿæ•°ï¼›"><a href="#éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼šincrby-ä¸-decrby-åé¢çš„å–å€¼-incrementä¸-decrementå¯ä»¥æ˜¯æ­£æ•°ä¹Ÿå¯ä»¥æ˜¯è´Ÿæ•°ï¼›" class="headerlink" title="éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼šincrby ä¸ decrby åé¢çš„å–å€¼ incrementä¸ decrementå¯ä»¥æ˜¯æ­£æ•°ä¹Ÿå¯ä»¥æ˜¯è´Ÿæ•°ï¼›"></a>éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼šincrby ä¸ decrby åé¢çš„å–å€¼ incrementä¸ decrementå¯ä»¥æ˜¯æ­£æ•°ä¹Ÿå¯ä»¥æ˜¯è´Ÿæ•°ï¼›</h1><p>127.0.0.1:6379&gt; set num1 1<br>OK</p><h1 id="num1-1-1-1-0"><a href="#num1-1-1-1-0" class="headerlink" title="( + num1 ) + ( - 1 ) = 1 - 1 = 0"></a>( + num1 ) + ( - 1 ) = 1 - 1 = 0</h1><p>127.0.0.1:6379&gt; incrby num1 -1<br>(integer) 0</p><p>127.0.0.1:6379&gt; get num1<br>â€œ0â€</p><h1 id="num1-1-0-1-1"><a href="#num1-1-0-1-1" class="headerlink" title="( + num1 ) + ( 1 ) = 0 + 1 = 1"></a>( + num1 ) + ( 1 ) = 0 + 1 = 1</h1><p>127.0.0.1:6379&gt; incrby num1 1<br>(integer) 1</p><p>127.0.0.1:6379&gt; get num1<br>â€œ1â€</p><h1 id="num1-2-1-2-1"><a href="#num1-2-1-2-1" class="headerlink" title="( + num1 ) + ( - 2 ) = 1 - 2 = -1"></a>( + num1 ) + ( - 2 ) = 1 - 2 = -1</h1><p>127.0.0.1:6379&gt; incrby num1 -2<br>(integer) -1</p><h1 id="num1-2-1-2-3"><a href="#num1-2-1-2-3" class="headerlink" title="( + num1 ) + ( - 2 ) = -1 - 2 = -3"></a>( + num1 ) + ( - 2 ) = -1 - 2 = -3</h1><p>127.0.0.1:6379&gt; decrby num1 2<br>(integer) -3</p><p>127.0.0.1:6379&gt; get num1<br>â€œ-3â€</p><h1 id="num1-1-3-3-3-3-0"><a href="#num1-1-3-3-3-3-0" class="headerlink" title="( + num1 ) + ( - 1 ) = -3 - ( -3 ) = -3 + 3 = 0"></a>( + num1 ) + ( - 1 ) = -3 - ( -3 ) = -3 + 3 = 0</h1><p>127.0.0.1:6379&gt; decrby num1 -3<br>(integer) 0</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">##### <span class="type">string</span>ä½œä¸ºæ•°å€¼æ“ä½œ</span><br><span class="line"></span><br><span class="line">* <span class="type">string</span>åœ¨rediså†…éƒ¨å­˜å‚¨é»˜è®¤å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå½“é‡åˆ°å¢å‡ç±»å‹æ“ä½œincrã€decræ—¶å°±ä¼šè½¬å˜æˆæ•°å€¼å‹è¿›è¡Œè®¡ç®—ï¼›(å½’æ ¹ç»“åº•å…¶è¿˜æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²)</span><br><span class="line">* redisæ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯åŸå­æ€§çš„ï¼Œé‡‡ç”¨å•çº¿ç¨‹å¤„ç†æ‰€æœ‰ä¸šåŠ¡ï¼Œå‘½ä»¤æ˜¯ä¸€ä¸ªä¸€ä¸ªæ‰§è¡Œçš„ï¼›å› æ­¤æ— éœ€è€ƒè™‘å¹¶å‘å¸¦æ¥çš„æ•°æ®ï¼›</span><br><span class="line">* æ³¨æ„ï¼š&lt;font style=<span class="string">"color:red;"</span>&gt;æŒ‰æ•°å€¼è¿›è¡Œæ“ä½œçš„æ•°æ®ï¼Œå¦‚æœåŸå§‹æ•°æ®ä¸èƒ½è½¬æˆæ•°å€¼ï¼Œæˆ–åˆ™è¶…è¶Šäº†redisæ•°å€¼ä¸Šé™èŒƒå›´ï¼Œå°†æŠ¥é”™&lt;/font&gt;ã€‚</span><br><span class="line"><span class="number">9</span> <span class="number">22</span> <span class="number">33</span>  <span class="number">7203</span> <span class="number">6854</span> <span class="number">77</span> <span class="number">5807</span> ï¼ˆjavaä¸­longå‹æ•°æ®æœ€å¤§å–å€¼ï¼ŒLong.MAX_VALUEï¼‰</span><br></pre></td></tr></table></figure><h1 id="1-ç¬¬ä¸€ç§æƒ…å†µï¼šåŸå§‹æ•°æ®ä¸èƒ½è½¬æˆæ•°å€¼"><a href="#1-ç¬¬ä¸€ç§æƒ…å†µï¼šåŸå§‹æ•°æ®ä¸èƒ½è½¬æˆæ•°å€¼" class="headerlink" title="1. ç¬¬ä¸€ç§æƒ…å†µï¼šåŸå§‹æ•°æ®ä¸èƒ½è½¬æˆæ•°å€¼"></a>1. ç¬¬ä¸€ç§æƒ…å†µï¼šåŸå§‹æ•°æ®ä¸èƒ½è½¬æˆæ•°å€¼</h1><p>  127.0.0.1:6379&gt; set num2 abc<br>  OK<br>  127.0.0.1:6379&gt; incr num2<br>  (error) ERR value is not an integer or out of range</p><h1 id="2-ç¬¬äºŒç§æƒ…å†µï¼Œè¶…è¶Šredisæ•°å€¼ä¸Šé™èŒƒå›´"><a href="#2-ç¬¬äºŒç§æƒ…å†µï¼Œè¶…è¶Šredisæ•°å€¼ä¸Šé™èŒƒå›´" class="headerlink" title="2. ç¬¬äºŒç§æƒ…å†µï¼Œè¶…è¶Šredisæ•°å€¼ä¸Šé™èŒƒå›´"></a>2. ç¬¬äºŒç§æƒ…å†µï¼Œè¶…è¶Šredisæ•°å€¼ä¸Šé™èŒƒå›´</h1><p>  127.0.0.1:6379&gt; incrby num2 11111111111111111111111111111111111111111111111111111111111111<br>  (error) ERR value is not an integer or out of range<br>  <figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&gt; **Tips <span class="number">1</span>:**</span><br><span class="line">  * redisç”¨äºæ§åˆ¶æ•°æ®åº“è¡¨ä¸»é”®idï¼Œä¸ºæ•°æ®åº“è¡¨ä¸»é”®æä¾›ç”Ÿæˆç­–ç•¥ï¼Œä¿éšœæ•°æ®åº“è¡¨çš„ä¸»é”®å”¯ä¸€æ€§</span><br><span class="line">  * æ­¤æ–¹æ¡ˆé€‚ç”¨äºæ‰€æœ‰æ•°æ®åº“ï¼Œä¸”æ”¯æŒæ•°æ®åº“é›†ç¾¤</span><br><span class="line"></span><br><span class="line">### æ•°æ®ç±»å‹-æ•°æ®æ—¶æ•ˆæ€§è®¾ç½®</span><br><span class="line"></span><br><span class="line">#### string ç±»å‹æ•°æ®çš„æ‰©å±•æ“ä½œ</span><br><span class="line"></span><br><span class="line">##### ä¸šåŠ¡åœºæ™¯</span><br><span class="line"></span><br><span class="line">* â€œæœ€å¼ºå¥³ç”Ÿâ€ å¯åŠ¨æµ·é€‰æŠ•ç¥¨ï¼Œåªèƒ½é€šè¿‡å¾®ä¿¡æŠ•ç¥¨ï¼Œæ¯ä¸ªå¾®ä¿¡å·æ¯<span class="number">4</span>ä¸ªå°æ—¶åªèƒ½æŠ•<span class="number">1</span>ç¥¨ï¼›</span><br><span class="line">* ç”µå•†å•†å®¶å¼€å¯çƒ­é—¨å•†å“æ¨èï¼Œçƒ­é—¨å•†å“ä¸èƒ½ä¸€ç›´å¤„äºçƒ­é—¨æœŸï¼Œæ¯ç§å•†å“çƒ­é—¨æœŸç»´æŒ<span class="number">3</span>å¤©ï¼Œ<span class="number">3</span>å¤©åè‡ªåŠ¨å–æ¶ˆçƒ­é—¨ï¼›</span><br><span class="line">* æ–°é—»ç½‘ç«™ä¼šå‡ºç°çƒ­ç‚¹æ–°é—»ï¼Œçƒ­ç‚¹æ–°é—»æœ€å¤§çš„ç‰¹å¾æ˜¯æ—¶æ•ˆæ€§ï¼Œå¦‚ä½•è‡ªåŠ¨æ§åˆ¶çƒ­ç‚¹æ–°é—»çš„æ—¶æ•ˆæ€§</span><br></pre></td></tr></table></figure><br>news_id: HB314790725 3åˆ†é’Ÿæ—¶æ•ˆæ€§ï¼š03:00ï¼ˆè¿›è¡Œå€’æ•°è®¡æ—¶ï¼‰<br>                                 â†“ â†“ â†“<br>news_id: HB314790725 3åˆ†é’Ÿæ—¶æ•ˆæ€§ï¼š00:00</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">##### è§£å†³æ–¹æ¡ˆ</span><br><span class="line"></span><br><span class="line">* è®¾ç½®æ•°æ®å…·æœ‰æŒ‡å®šçš„ç”Ÿå‘½å‘¨æœŸ(æ•°æ®èƒ½æ´»å¤šä¹…ï¼Œæ¯”å¦‚ä¸‰åˆ†é’Ÿã€äº”åˆ†é’Ÿä¹‹ç±»çš„éªŒè¯ç æ—¶æ•ˆæ€§)</span><br></pre></td></tr></table></figure><h1 id="1-è¿™ä¸¤ä¸ªå‘½ä»¤çš„å·®åˆ«åœ¨äºç”Ÿå‘½å‘¨æœŸçš„å•ä½ä¸åŒ"><a href="#1-è¿™ä¸¤ä¸ªå‘½ä»¤çš„å·®åˆ«åœ¨äºç”Ÿå‘½å‘¨æœŸçš„å•ä½ä¸åŒ" class="headerlink" title="1. è¿™ä¸¤ä¸ªå‘½ä»¤çš„å·®åˆ«åœ¨äºç”Ÿå‘½å‘¨æœŸçš„å•ä½ä¸åŒ"></a>1. è¿™ä¸¤ä¸ªå‘½ä»¤çš„å·®åˆ«åœ¨äºç”Ÿå‘½å‘¨æœŸçš„å•ä½ä¸åŒ</h1><h1 id="2-setexå‘½ä»¤çš„æ—¶é—´å•ä½ä¸º-ç§’seconds"><a href="#2-setexå‘½ä»¤çš„æ—¶é—´å•ä½ä¸º-ç§’seconds" class="headerlink" title="2. setexå‘½ä»¤çš„æ—¶é—´å•ä½ä¸º ç§’seconds"></a>2. setexå‘½ä»¤çš„æ—¶é—´å•ä½ä¸º ç§’seconds</h1><h1 id="3-psetexå‘½ä»¤çš„æ—¶é—´å•ä½ä¸º-æ¯«ç§’milliseconds"><a href="#3-psetexå‘½ä»¤çš„æ—¶é—´å•ä½ä¸º-æ¯«ç§’milliseconds" class="headerlink" title="3. psetexå‘½ä»¤çš„æ—¶é—´å•ä½ä¸º æ¯«ç§’milliseconds"></a>3. psetexå‘½ä»¤çš„æ—¶é—´å•ä½ä¸º æ¯«ç§’milliseconds</h1><h1 id="æ ¼å¼ï¼šsetex-key-seconds-value"><a href="#æ ¼å¼ï¼šsetex-key-seconds-value" class="headerlink" title="æ ¼å¼ï¼šsetex key seconds value"></a>æ ¼å¼ï¼šsetex key seconds value</h1><h1 id="æ ¼å¼ï¼špsetex-key-milliseconds-value"><a href="#æ ¼å¼ï¼špsetex-key-milliseconds-value" class="headerlink" title="æ ¼å¼ï¼špsetex key milliseconds value"></a>æ ¼å¼ï¼špsetex key milliseconds value</h1><p>  #ç¤ºä¾‹(10ç§’åè¿‡æœŸ)ï¼š<br>  127.0.0.1:6379&gt; setex tel 10 1<br>  OK<br>  127.0.0.1:6379&gt; get tel<br>  â€œ1â€<br>  127.0.0.1:6379&gt; get tel<br>  â€œ1â€<br>  127.0.0.1:6379&gt; get tel<br>  (nil)<br>  127.0.0.1:6379&gt;</p><h1 id="å¦‚æœåœ¨-setex-ä¹‹åé‡æ–°å¯¹åŒä¸€ä¸ªé”®è¿›è¡Œ-set-key-valueï¼›åˆ™setexå‘½ä»¤æ‰€æŒ‡å®šçš„ç”Ÿå‘½å‘¨æœŸå°†ä¸å†èµ·ä½œç”¨"><a href="#å¦‚æœåœ¨-setex-ä¹‹åé‡æ–°å¯¹åŒä¸€ä¸ªé”®è¿›è¡Œ-set-key-valueï¼›åˆ™setexå‘½ä»¤æ‰€æŒ‡å®šçš„ç”Ÿå‘½å‘¨æœŸå°†ä¸å†èµ·ä½œç”¨" class="headerlink" title="å¦‚æœåœ¨ setex ä¹‹åé‡æ–°å¯¹åŒä¸€ä¸ªé”®è¿›è¡Œ set key valueï¼›åˆ™setexå‘½ä»¤æ‰€æŒ‡å®šçš„ç”Ÿå‘½å‘¨æœŸå°†ä¸å†èµ·ä½œç”¨"></a>å¦‚æœåœ¨ setex ä¹‹åé‡æ–°å¯¹åŒä¸€ä¸ªé”®è¿›è¡Œ set key valueï¼›åˆ™setexå‘½ä»¤æ‰€æŒ‡å®šçš„ç”Ÿå‘½å‘¨æœŸå°†ä¸å†èµ·ä½œç”¨</h1><p>  127.0.0.1:6379&gt; setex tel 10 1<br>  OK<br>  127.0.0.1:6379&gt; set tel 2<br>  OK<br>  127.0.0.1:6379&gt; get tel<br>  â€œ2â€<br>  127.0.0.1:6379&gt;<br>  <figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&gt; **Tips <span class="number">2</span>:**</span><br><span class="line"></span><br><span class="line">* redis æ§åˆ¶æ•°æ®çš„ç”Ÿå‘½å‘¨æœŸï¼Œé€šè¿‡æ•°æ®æ˜¯å¦å¤±æ•ˆæ§åˆ¶ä¸šåŠ¡è¡Œä¸ºï¼Œé€‚ç”¨äºæ‰€æœ‰å…·æœ‰æ—¶æ•ˆæ€§é™å®šæ§åˆ¶çš„æ“ä½œ</span><br><span class="line"></span><br><span class="line">### keyçš„å‘½åè§„èŒƒ</span><br><span class="line"></span><br><span class="line">#### <span class="built_in">string</span> ç±»å‹æ•°æ®æ“ä½œçš„æ³¨æ„äº‹é¡¹</span><br><span class="line"></span><br><span class="line">* æ•°æ®æ“ä½œä¸æˆåŠŸçš„åé¦ˆä¸æ•°æ®æ­£å¸¸æ“ä½œä¹‹é—´çš„å·®å¼‚</span><br><span class="line">  â‘  è¡¨ç¤ºè¿è¡Œç»“æ„æ˜¯å¦æˆåŠŸ</span><br><span class="line">    * ï¼ˆ<span class="built_in">int</span>egerï¼‰<span class="number">0</span> ---&gt; <span class="literal">false</span> å¤±è´¥</span><br><span class="line">    * ï¼ˆ<span class="built_in">int</span>egerï¼‰<span class="number">1</span> ---&gt; <span class="literal">true</span>  æˆåŠŸ</span><br><span class="line">  </span><br><span class="line">  â‘¡ è¡¨ç¤ºè¿è¡Œç»“æœå€¼</span><br><span class="line">    * ï¼ˆ<span class="built_in">int</span>egerï¼‰<span class="number">3</span> ---&gt; <span class="number">3</span>ä¸ª</span><br><span class="line">    * ï¼ˆ<span class="built_in">int</span>egerï¼‰<span class="number">1</span> ---&gt; <span class="number">1</span>ä¸ª</span><br><span class="line">* æ•°æ®æœªè·å–åˆ°</span><br><span class="line">  â‘ ï¼ˆnilï¼‰ç­‰åŒäº<span class="literal">null</span>ï¼Œä¸å­˜åœ¨</span><br><span class="line">* æ•°æ®æœ€å¤§å­˜å‚¨é‡</span><br><span class="line">  â‘  <span class="number">512</span>MBï¼ˆä¸Šé™ï¼‰</span><br><span class="line">* æ•°æ®è®¡ç®—æœ€å¤§èŒƒå›´ï¼ˆjavaä¸­çš„longçš„æœ€å¤§å€¼ï¼‰</span><br><span class="line">  â‘  <span class="number">9</span> <span class="number">22</span> <span class="number">33</span> <span class="number">7203</span> <span class="number">6854</span> <span class="number">7758</span> <span class="number">07</span></span><br><span class="line">  â‘  <span class="number">-9</span> <span class="number">22</span> <span class="number">33</span> <span class="number">7203</span> <span class="number">6854</span> <span class="number">7758</span> <span class="number">07</span></span><br><span class="line">  â‘¢ æ¯” <span class="number">9</span> <span class="number">22</span> <span class="number">33</span> <span class="number">7203</span> <span class="number">6854</span> <span class="number">7758</span> <span class="number">07</span>è¿˜è¦å¤§ï¼›æ¯”<span class="number">-9</span> <span class="number">22</span> <span class="number">33</span> <span class="number">7203</span> <span class="number">6854</span> <span class="number">7758</span> <span class="number">07</span>è¿˜è¦å°ï¼›åˆ™æŠ›å‡ºå¼‚å¸¸Errorï¼›</span><br><span class="line"></span><br><span class="line">#### <span class="built_in">string</span> ç±»å‹åº”ç”¨åœºæ™¯</span><br><span class="line"></span><br><span class="line">##### ä¸šåŠ¡åœºæ™¯</span><br><span class="line"></span><br><span class="line">ä¸»é¡µé«˜é¢‘è®¿é—®ä¿¡æ¯æ˜¾ç¤ºæ§åˆ¶ï¼Œä¾‹å¦‚æ–°æµªå¾®åšå¤§Vä¸»é¡µæ˜¾ç¤ºç²‰ä¸æ•°ä¸å¾®åšæ•°é‡ï¼›  </span><br><span class="line"></span><br><span class="line">è¿™ç§æ•°æ®å¦‚ä½•æ”¾å…¥åˆ°rediså½“ä¸­æ€æ ·è¿›è¡Œå­˜å‚¨ï¼Ÿ</span><br><span class="line"></span><br><span class="line">##### è§£å†³æ–¹æ¡ˆ</span><br><span class="line"></span><br><span class="line">* åœ¨redisä¸­ä¸ºå¤§Vç”¨æˆ·è®¾å®šç”¨æˆ·ä¿¡æ¯ï¼Œä»¥ç”¨æˆ·ä¸»é”®å’Œå±æ€§å€¼ä½œä¸ºkeyï¼Œåå°è®¾å®šå®šæ—¶åˆ·æ–°ç­–ç•¥å³å¯</span><br></pre></td></tr></table></figure></p><h1 id="è¡¨åï¼šä¸»é”®åï¼šä¸»é”®å€¼ï¼šå±æ€§å"><a href="#è¡¨åï¼šä¸»é”®åï¼šä¸»é”®å€¼ï¼šå±æ€§å" class="headerlink" title="è¡¨åï¼šä¸»é”®åï¼šä¸»é”®å€¼ï¼šå±æ€§å"></a>è¡¨åï¼šä¸»é”®åï¼šä¸»é”®å€¼ï¼šå±æ€§å</h1><p>  eg:  user:id:3506728370:fans         â€”&gt;     12210947<br>  eg:  user:id:3506728370:blogs        â€”&gt;     6164<br>  eg:  user:id:3506728370:focuss       â€”&gt;     83</p><p>  127.0.0.1:6379&gt; set user:id:00789:fans 123456789<br>  OK</p><p>  127.0.0.1:6379&gt; set user:id:00789:blogs 789<br>  OK</p><p>  127.0.0.1:6379&gt; set user:id:00789 {id:00789,blogs:789,,fans:123456789}<br>  OK</p><p>  127.0.0.1:6379&gt; incr user:id:00789:fans<br>  (integer) 123456790</p><h1 id="æ˜¯ç›´æ¥å­˜å‚¨å±æ€§å–å€¼è¿˜æ˜¯é€šè¿‡jsonæ–¹å¼å“ªä¸€ç§æ¯”è¾ƒå¥½ï¼›"><a href="#æ˜¯ç›´æ¥å­˜å‚¨å±æ€§å–å€¼è¿˜æ˜¯é€šè¿‡jsonæ–¹å¼å“ªä¸€ç§æ¯”è¾ƒå¥½ï¼›" class="headerlink" title="æ˜¯ç›´æ¥å­˜å‚¨å±æ€§å–å€¼è¿˜æ˜¯é€šè¿‡jsonæ–¹å¼å“ªä¸€ç§æ¯”è¾ƒå¥½ï¼›"></a>æ˜¯ç›´æ¥å­˜å‚¨å±æ€§å–å€¼è¿˜æ˜¯é€šè¿‡jsonæ–¹å¼å“ªä¸€ç§æ¯”è¾ƒå¥½ï¼›</h1><h1 id="ç¬¬ä¸€ç§å¯ä»¥å–ç¬¬äºŒç§ä¹Ÿå¯ä»¥å–å‡ºï¼›"><a href="#ç¬¬ä¸€ç§å¯ä»¥å–ç¬¬äºŒç§ä¹Ÿå¯ä»¥å–å‡ºï¼›" class="headerlink" title="ç¬¬ä¸€ç§å¯ä»¥å–ç¬¬äºŒç§ä¹Ÿå¯ä»¥å–å‡ºï¼›"></a>ç¬¬ä¸€ç§å¯ä»¥å–ç¬¬äºŒç§ä¹Ÿå¯ä»¥å–å‡ºï¼›</h1><h1 id="ç¬¬ä¸€ç§æ”¹å˜æ•°æ®ä¼šè¦æ–¹ä¾¿ä¸€äº›ï¼›"><a href="#ç¬¬ä¸€ç§æ”¹å˜æ•°æ®ä¼šè¦æ–¹ä¾¿ä¸€äº›ï¼›" class="headerlink" title="ç¬¬ä¸€ç§æ”¹å˜æ•°æ®ä¼šè¦æ–¹ä¾¿ä¸€äº›ï¼›"></a>ç¬¬ä¸€ç§æ”¹å˜æ•°æ®ä¼šè¦æ–¹ä¾¿ä¸€äº›ï¼›</h1><h1 id="ç¬¬äºŒç§ä¸€æ”¹å…¨æ”¹ï¼›ä¸¤è€…æ²¡æœ‰è¯´å¥½åéœ€è¦çœ‹å…·ä½“çš„ä¸šåŠ¡é€»è¾‘æƒ…å†µã€ä¸šåŠ¡åœºæ™¯è€Œå®šã€é€‰æ‹©ï¼›"><a href="#ç¬¬äºŒç§ä¸€æ”¹å…¨æ”¹ï¼›ä¸¤è€…æ²¡æœ‰è¯´å¥½åéœ€è¦çœ‹å…·ä½“çš„ä¸šåŠ¡é€»è¾‘æƒ…å†µã€ä¸šåŠ¡åœºæ™¯è€Œå®šã€é€‰æ‹©ï¼›" class="headerlink" title="ç¬¬äºŒç§ä¸€æ”¹å…¨æ”¹ï¼›ä¸¤è€…æ²¡æœ‰è¯´å¥½åéœ€è¦çœ‹å…·ä½“çš„ä¸šåŠ¡é€»è¾‘æƒ…å†µã€ä¸šåŠ¡åœºæ™¯è€Œå®šã€é€‰æ‹©ï¼›"></a>ç¬¬äºŒç§ä¸€æ”¹å…¨æ”¹ï¼›ä¸¤è€…æ²¡æœ‰è¯´å¥½åéœ€è¦çœ‹å…·ä½“çš„ä¸šåŠ¡é€»è¾‘æƒ…å†µã€ä¸šåŠ¡åœºæ™¯è€Œå®šã€é€‰æ‹©ï¼›</h1><p>  127.0.0.1:6379&gt;</p>  <figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">* </span>åœ¨redisä¸­ä»¥jsonæ ¼å¼å­˜å‚¨å¤§Vç”¨æˆ·ä¿¡æ¯ï¼Œå®šæ—¶åˆ·æ–°ï¼ˆä¹Ÿå¯ä»¥ï¼‰</span><br></pre></td></tr></table></figure><p>  eg:  user:id:3506728370         â€”&gt;     {id:3506728370,name:æ˜¥æ™š,fans:123456789,blogs:6164,focus:83}<br>  <figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&gt; **Tips3:**</span><br><span class="line"></span><br><span class="line">* redisåº”ç”¨äºå„ç§ç»“æ„å‹å’Œéç»“æ„å‹é«˜çƒ­è¯»æ•°æ®è®¿é—®åŠ é€Ÿ</span><br><span class="line"></span><br><span class="line">#### keyçš„è®¾ç½®çº¦å®š</span><br><span class="line"></span><br><span class="line">* æ•°æ®åº“ä¸­çš„çƒ­ç‚¹æ•°æ®keyå‘½ä»¤æƒ¯ä¾‹</span><br></pre></td></tr></table></figure></p><hr><pre><code>è¡¨å ï¼šä¸»é”®å ï¼šä¸»é”®å€¼   ï¼šå­—æ®µå</code></pre><hr><pre><code>eq1 : order :   id  : 29437595 : name</code></pre><hr><pre><code>eq2 : equip :   id  : 390472345: type</code></pre><hr><pre><code>eq3 : news  :   id  : 202004150: title</code></pre><hr>  <figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">rediså½“ä¸­çš„å¤§æ•°æ®è¿˜æ˜¯æ¥è‡ªäºæ•°æ®åº“ï¼ˆmysqlï¼‰ï¼›ä¹Ÿæœ‰å°éƒ¨åˆ†ä¸æ˜¯æ¥è‡ªäºæ•°æ®åº“ï¼›  </span><br><span class="line"></span><br><span class="line">### æ•°æ®ç±»å‹-hashç±»å‹ä»‹ç»ä¸åŸºæœ¬æ“ä½œ</span><br><span class="line"></span><br><span class="line">#### ç›®å½•Contents</span><br><span class="line"></span><br><span class="line">* æ•°æ®å­˜å‚¨ç±»å‹ä»‹ç»</span><br><span class="line">* string</span><br><span class="line">* hash</span><br><span class="line">* list</span><br><span class="line">* set</span><br><span class="line">* sorted_set</span><br><span class="line"></span><br><span class="line">#### hashç±»å‹</span><br><span class="line"></span><br><span class="line">##### å­˜å‚¨çš„ç–‘æƒ‘</span><br><span class="line"></span><br><span class="line">* stringå½“ä¸­ä»¥jsonæ–¹å¼å­˜å‚¨æ•°æ®çš„æ ¼å¼ï¼›</span><br></pre></td></tr></table></figure><hr><p>| h_user user:id:3506728370 |â€”â€”â€“&gt;| {name:æ˜¥æ™š, fans:12210862, blogs:6164, focus:83}|</p><hr><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">(å–å‡ºæ•°æ®è¿˜è¡Œï¼Œä½†æ˜¯å¯¹äºä¿®æ”¹æ•°æ®å°±æ˜¾å¾—ç¬¨æ‹™)  </span><br><span class="line"></span><br><span class="line">å¯¹äºä¸Šè¿°æ“ä½œï¼›å¯¹è±¡ç±»å‹æ•°æ®çš„å­˜å‚¨å¦‚æœå…·æœ‰æ¯”è¾ƒ**é¢‘ç¹çš„æ›´æ–°éœ€æ±‚æ“ä½œ**ä¼šæ˜¾å¾—ç¬¨é‡  </span><br><span class="line">é‚£ä¹ˆæ­¤æ—¶é’ˆå¯¹è¿™ç§æ¯”è¾ƒé¢‘ç¹çš„æ›´æ–°éœ€æ±‚æ“ä½œè½¬æ¢æˆ<span class="built_in">string</span>ä»¥å±æ€§å•ä¸ªè¿›è¡Œå­˜å‚¨å–å€¼æ–¹å¼åˆ™ä»–ä»¬è¿™å‡ ä¸ªæ•°æ®æ˜¯åˆ†æ•£åˆ†ç¦»çš„ï¼š</span><br></pre></td></tr></table></figure><hr><p>|â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“         â€”â€”â€”â€“         |<br>|| h_user user:id:3506728370       :name |â€”â€”â€“&gt;|  æ˜¥æ™š  |          |<br>|â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“         â€”â€”â€”â€“         |<br>|                                                                      |<br>|â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“         â€”â€”â€”â€”        |<br>|| h_user user:id:3506728370       :fans |â€”â€”â€“&gt;| 12210862 |        |<br>|â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“         â€”â€”â€”â€”        |<br>|                                                                      |<br>|â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”         â€”â€”â€”â€“        |<br>|| h_user user:id:3506728370       :blogs |â€”â€”â€“&gt;|  83     |        |<br>|â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”         â€”â€”â€”â€“        |</p><hr><pre><code>|       |       ||       |       ||       |       |â†“       â†“       â†“</code></pre><hr><p>|                              â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“  |<br>|                              |                                    |  |<br>|â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”|â€”â€”â€”â€“         â€”â€”â€”       |  |<br>|| h_user user:id:3506728370   |   :name |â€”â€”â€“&gt;|  æ˜¥æ™š  |       |  |<br>|â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”|â€”â€”â€”-         â€”â€”â€”-       |  |<br>|                              |                                    |  |<br>|â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”|â€”â€”â€”-         â€”â€”â€”â€”     |  |<br>|| h_user user:id:3506728370   |   :fans |â€”â€”â€“&gt;| 12210862 |     |  |<br>|â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”|â€”â€”â€”-         â€”â€”â€”â€”     |  |<br>|                              |                                    |  |<br>|â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”|â€”â€”â€”â€“         â€”â€”â€“        |  |<br>|| h_user user:id:3506728370   |   :blogs |â€”â€”â€“&gt;|  83 |         |  |<br>|â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”|â€”â€”â€”â€“         â€”â€”â€“        |  |<br>|                              |                                    |  |<br>|                              â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“  |<br>|â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<br>                   |       |       |<br>                   |       |       |<br>                   |       |       |<br>                   â†“       â†“       â†“<br>#æ¢ç»“æ„ï¼›å·¦è¾¹ä¸»é”®åˆä¸€ï¼›å³è¾¹å°†å±æ€§å¯¹ä¸Šå…¶å€¼æ”¾ä¸€å—ï¼›redisä¸ºé”®å€¼å¯¹æ•°æ®åº“ï¼›ç±»ä¼¼äºredisé‡Œé¢æ”¾redisçš„æ„æ€ï¼›ğŸ˜‚ï¼›å¯¹åº”çš„æ•°æ®è¿˜æ˜¯value</p><hr><p>|                                               â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“  |<br>|                                               | å­˜å‚¨ç©ºé—´                           |  |<br>|                                               |   â€”â€”â€“         â€”â€”â€”-      |  |<br>|                                               |   | name |         |  æ˜¥æ™š  |      |  |<br>|                                               |   â€”â€”â€“         â€”â€”â€”-      |  |<br>|â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“                  |                                    |  |<br>|| h_user user:id:3506728370 |â€”â€”â€”â€”â€”â€“&gt;|   â€”â€”â€“         â€”â€”â€”â€”    |  |<br>|â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“                  |   | fans |         | 12210862 |    |  |<br>|                                               |   â€”â€”â€“         â€”â€”â€”â€”    |  |<br>|                                               |                                    |  |<br>|                                               |   â€”â€”â€”         â€”â€”â€“       |  |<br>|                                               |   | blogs |         |  83  |       |  |<br>|                                               |   â€”â€”â€”         â€”â€”â€“       |  |<br>|                                               |                                    |  |<br>|                                               â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“  |</p><hr><pre><code>|       |       ||       |       ||       |       |â†“       â†“       â†“</code></pre><hr><p>|                                               â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“ - |<br>|                                               | å­˜å‚¨ç©ºé—´ï¼ˆå³è¾¹çš„è¯¥ç»“æ„å³hashï¼‰                             |  |<br>|                                               |   â€”â€”â€”â€”â€”â€”â€“         â€”â€”â€”â€”â€”â€”â€“      |  |<br>|                                               |   |  field  |  name |         |  value  |  æ˜¥æ™š  |        |  |<br>|                                               |   â€”â€”â€”â€”â€”â€”â€“         â€”â€”â€”â€”â€”â€”â€“      |  |<br>|â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-       |                                                          |  |<br>||   key    | h_user user:id:3506728370 |â€”â€”&gt;|   â€”â€”â€”â€”â€”â€”â€“         â€”â€”â€”â€”â€”â€”â€”-    |  |<br>|â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-       |   |  field  |  fans |         |  value  |  12210862 |    |  |<br>|                                               |   â€”â€”â€”â€”â€”â€”â€“         â€”â€”â€”â€”â€”â€”â€”-    |  |<br>|                                               |                                                          |  |<br>|                                               |   â€”â€”â€”â€”â€”â€”â€“         â€”â€”â€”â€”â€”â€”â€“      |  |<br>|                                               |   |  field  |  blogs |         |  value  |  83  |        |  |<br>|                                               |   â€”â€”â€”â€”â€”â€”â€“         â€”â€”â€”â€”â€”â€”â€“      |  |<br>|                                               |                                                          |  |<br>|                                               â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”  |</p><hr><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">æˆ–è€…è¯´keyå¯¹åº”çš„ä¸å†æ˜¯ä¸€ä¸ªå•ç‹¬çš„æ•°æ®äº†ï¼›è€Œæ˜¯ä¸€å †æ•°æ®ï¼›</span><br><span class="line">è€Œè¿™ä¸€å¯¹æ•°æ®å®ƒçš„æ•´ä½“ç»“æ„å’Œå‰é¢æ‰€çœ‹çš„é‚£ä¸ªç»“æ„æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼›è¿™å°±æ˜¯æ‰€è°“çš„hashç±»å‹ï¼›</span><br><span class="line"></span><br><span class="line">#### hashç±»å‹</span><br><span class="line"></span><br><span class="line">* æ–°çš„å­˜å‚¨éœ€æ±‚ï¼šå¯¹ä¸€ç³»åˆ—å­˜å‚¨çš„æ•°æ®è¿›è¡Œç¼–ç»„ï¼Œæ–¹ä¾¿ç®¡ç†ï¼Œå…¸å‹åº”ç”¨å­˜å‚¨å¯¹è±¡ä¿¡æ¯ï¼›ï¼ˆå¯ä»¥ç†è§£ä¸ºæ˜¯rediså½“ä¸­çš„å°å‹redisï¼‰</span><br><span class="line">* éœ€è¦çš„å­˜å‚¨ç»“æ„ï¼šä¸€ä¸ªå­˜å‚¨ç©ºé—´ä¿å­˜å¤šä¸ªé”®å€¼å¯¹æ•°æ®ï¼›</span><br></pre></td></tr></table></figure><hr><p>|                                               â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“ - |<br>|                                               | hashå­˜å‚¨ç©ºé—´                                              |  |<br>|                                               |   â€”â€”â€”â€”â€”â€”â€“         â€”â€”â€”â€”â€”â€”-       |  |<br>|                                               |   |      field1     |          |      value1     |       |  |<br>|                                               |   â€”â€”â€”â€”â€”â€”â€“         â€”â€”â€”â€”â€”â€”-       |  |<br>|â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-       |                                                          |  |<br>||                key                   |â€”â€”&gt;|   â€”â€”â€”â€”â€”â€”â€“        â€”â€”â€”â€”â€”â€”â€”-     |  |<br>|â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-       |   |      field2     |          |      value2     |       |  |<br>|                                               |   â€”â€”â€”â€”â€”â€”â€“        â€”â€”â€”â€”â€”â€”â€”-     |  |<br>|                                               |                                                          |  |<br>|                                               |   â€”â€”â€”â€”â€”â€”â€“         â€”â€”â€”â€”â€”â€”â€“      |  |<br>|                                               |   |      field3      |         |      value3     |       |  |<br>|                                               |   â€”â€”â€”â€”â€”â€”â€“         â€”â€”â€”â€”â€”â€”â€“      |  |<br>|                                               |                                                          |  |<br>|                                               â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”  |</p><hr><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">hash</span>åº•å±‚å…¶å®ä¸ºä¸€ä¸ª<span class="built_in">hash</span>è¡¨çš„å­˜å‚¨ç»“æ„ï¼›  </span><br><span class="line"><span class="built_in">hash</span>å­˜å‚¨ç»“æ„ä¼˜åŒ–ï¼š  </span><br><span class="line"></span><br><span class="line">* å¦‚æœfieldæ•°é‡è¾ƒå°‘ï¼Œå­˜å‚¨ç»“æ„ä¼˜åŒ–ä¸ºç±»æ•°ç»„ï¼ˆè¿˜ä¸æ˜¯çœŸæ•°ç»„ï¼‰ç»“æ„</span><br><span class="line">* å¦‚æœfieldæ•°é‡è¾ƒå¤šï¼Œå­˜å‚¨ç»“æ„ä½¿ç”¨HashMapç»“æ„</span><br><span class="line"></span><br><span class="line"><span class="comment">#### hash ç±»å‹æ•°æ®çš„åŸºæœ¬æ“ä½œ</span></span><br><span class="line"></span><br><span class="line">* æ·»åŠ /ä¿®æ”¹æ•°æ®(å±æ€§å­˜åœ¨åˆ™è¿›è¡Œä¿®æ”¹ï¼›å±æ€§ä¸å­˜åœ¨åˆ™è¿›è¡Œæ–°å¢)</span><br></pre></td></tr></table></figure><p>  hset key field value<br>  <figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">* </span>è·å–æ•°æ®</span><br></pre></td></tr></table></figure><br>  hget key field<br>  hgetall key<br>  <figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">* </span>åˆ é™¤æ•°æ®</span><br></pre></td></tr></table></figure><br>  hdel key field1 [field2 â€¦]<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ç¤ºä¾‹ï¼š</span><br></pre></td></tr></table></figure></p><h1 id="è®¾ç½®å€¼"><a href="#è®¾ç½®å€¼" class="headerlink" title="è®¾ç½®å€¼"></a>è®¾ç½®å€¼</h1><p>127.0.0.1:6379&gt; hset user name laowang<br>(integer) 1<br>127.0.0.1:6379&gt; hset user age 100<br>(integer) 1<br>127.0.0.1:6379&gt; hset user gender girl<br>(integer) 1</p><h1 id="å°†å€¼å…¨éƒ¨å–å‡º"><a href="#å°†å€¼å…¨éƒ¨å–å‡º" class="headerlink" title="å°†å€¼å…¨éƒ¨å–å‡º"></a>å°†å€¼å…¨éƒ¨å–å‡º</h1><p>127.0.0.1:6379&gt; hgetall user</p><p>1) â€œnameâ€<br>2) â€œlaowangâ€<br>3) â€œageâ€<br>4) â€œ100â€<br>5) â€œgenderâ€<br>6) â€œgirlâ€</p><h1 id="è¿›è¡Œå•ä¸ªå–å€¼"><a href="#è¿›è¡Œå•ä¸ªå–å€¼" class="headerlink" title="è¿›è¡Œå•ä¸ªå–å€¼"></a>è¿›è¡Œå•ä¸ªå–å€¼</h1><p>127.0.0.1:6379&gt; hget user name<br>â€œlaowangâ€<br>127.0.0.1:6379&gt; hget user gender<br>â€œgirlâ€<br>127.0.0.1:6379&gt; hget user age<br>â€œ100â€</p><h1 id="è¿›è¡Œåˆ é™¤å±æ€§"><a href="#è¿›è¡Œåˆ é™¤å±æ€§" class="headerlink" title="è¿›è¡Œåˆ é™¤å±æ€§"></a>è¿›è¡Œåˆ é™¤å±æ€§</h1><p>127.0.0.1:6379&gt; hdel user gender<br>(integer) 1<br>127.0.0.1:6379&gt; hdel user age name<br>(integer) 2<br>127.0.0.1:6379&gt; hdel user age<br>(integer) 0<br>127.0.0.1:6379&gt; hgetall user<br>(empty list or set)</p><h1 id="è®¾ç½®å€¼ï¼›é‡æ–°èµ‹å€¼åˆ™è¦†ç›–åŸæ¥å­˜åœ¨çš„å€¼"><a href="#è®¾ç½®å€¼ï¼›é‡æ–°èµ‹å€¼åˆ™è¦†ç›–åŸæ¥å­˜åœ¨çš„å€¼" class="headerlink" title="è®¾ç½®å€¼ï¼›é‡æ–°èµ‹å€¼åˆ™è¦†ç›–åŸæ¥å­˜åœ¨çš„å€¼"></a>è®¾ç½®å€¼ï¼›é‡æ–°èµ‹å€¼åˆ™è¦†ç›–åŸæ¥å­˜åœ¨çš„å€¼</h1><p>127.0.0.1:6379&gt; hset user name laowang<br>(integer) 1<br>127.0.0.1:6379&gt; hset user name laoli<br>(integer) 0<br>127.0.0.1:6379&gt; hgetall user</p><p>1) â€œnameâ€<br>2) â€œlaoliâ€<br>127.0.0.1:6379&gt; hset user name laowang<br>(integer) 0<br>127.0.0.1:6379&gt; hget user name<br>â€œlaowangâ€</p><h1 id="æŸ¥çœ‹é•¿åº¦ï¼›æ£€æŸ¥çš„æ˜¯fieldçš„æ•°é‡ï¼›"><a href="#æŸ¥çœ‹é•¿åº¦ï¼›æ£€æŸ¥çš„æ˜¯fieldçš„æ•°é‡ï¼›" class="headerlink" title="æŸ¥çœ‹é•¿åº¦ï¼›æ£€æŸ¥çš„æ˜¯fieldçš„æ•°é‡ï¼›"></a>æŸ¥çœ‹é•¿åº¦ï¼›æ£€æŸ¥çš„æ˜¯fieldçš„æ•°é‡ï¼›</h1><p>127.0.0.1:6379&gt; hlen user<br>(integer) 1</p><h1 id="æ£€æŸ¥fieldæ˜¯å¦å­˜åœ¨ï¼›0ä¸å­˜åœ¨ï¼›1å­˜åœ¨"><a href="#æ£€æŸ¥fieldæ˜¯å¦å­˜åœ¨ï¼›0ä¸å­˜åœ¨ï¼›1å­˜åœ¨" class="headerlink" title="æ£€æŸ¥fieldæ˜¯å¦å­˜åœ¨ï¼›0ä¸å­˜åœ¨ï¼›1å­˜åœ¨"></a>æ£€æŸ¥fieldæ˜¯å¦å­˜åœ¨ï¼›0ä¸å­˜åœ¨ï¼›1å­˜åœ¨</h1><p>127.0.0.1:6379&gt; hexists user gender<br>(integer) 0<br>127.0.0.1:6379&gt; hexists user name<br>(integer) 1</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### æ•°æ®ç±»å‹-hashæ‰©å±•æ“ä½œä¸ä½¿ç”¨æ³¨æ„äº‹é¡¹</span><br><span class="line"></span><br><span class="line">#### hash ç±»å‹æ•°æ®æ‰©å±•æ“ä½œ</span><br><span class="line"></span><br><span class="line">(keyå½“ä¸­çš„fieldä¸ä¼šè¿›è¡Œé‡å¤ï¼Œå°±å¦‚æœé‡å¤è®¾ç½®ç›¸åŒçš„fieldå°†ä¼šå‘ç”Ÿè¦†ç›–ï¼›è€Œä¸åŒçš„fieldæ‰€å¯¹åº”çš„æ˜¯å…è®¸ç›¸åŒå€¼å­˜åœ¨çš„)</span><br></pre></td></tr></table></figure><p>127.0.0.1:6379&gt; hgetall user</p><p>1) â€œnameâ€<br>2) â€œlaowangâ€<br>3) â€œgenderâ€<br>4) â€œ101.09â€<br>5) â€œageâ€<br>6) â€œ101.09â€<br>127.0.0.1:6379&gt; hset user name laoli<br>(integer) 0<br>127.0.0.1:6379&gt; hgetall user</p><p>1) â€œnameâ€<br>2) â€œlaoliâ€<br>3) â€œgenderâ€<br>4) â€œ101.09â€<br>5) â€œageâ€<br>6) â€œ101.09â€</p><p>127.0.0.1:6379&gt; hgetall user</p><p>1) â€œnameâ€<br>2) â€œlaowangâ€<br>3) â€œgenderâ€<br>4) â€œgirlâ€<br>5) â€œageâ€<br>6) â€œ101.09â€<br>127.0.0.1:6379&gt; hset user gender 101.09<br>(integer) 0<br>127.0.0.1:6379&gt; hgetall user</p><p>1) â€œnameâ€<br>2) â€œlaowangâ€<br>3) â€œgenderâ€<br>4) â€œ101.09â€<br>5) â€œageâ€<br>6) â€œ101.09â€</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="bullet">* </span>è·å–å“ˆå¸Œè¡¨ä¸­æ‰€æœ‰çš„å­—æ®µåæˆ–å­—æ®µå€¼</span><br></pre></td></tr></table></figure><p>  hkeys key<br>  hvals key<br>  <figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">* </span>è®¾ç½®æŒ‡å®šå­—æ®µçš„æ•°å€¼æ•°æ®å¢åŠ æŒ‡å®šèŒƒå›´çš„å€¼</span><br></pre></td></tr></table></figure><br>  hincrby key field increment<br>  hincrbyfloat key field increment<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ç¤ºä¾‹ï¼š</span><br></pre></td></tr></table></figure><br>127.0.0.1:6379&gt; hgetall user</p><p>1) â€œnameâ€<br>2) â€œlaowangâ€<br>3) â€œgenderâ€<br>4) â€œgirlâ€<br>5) â€œageâ€<br>6) â€œ100â€<br>127.0.0.1:6379&gt; hkeys user</p><p>1) â€œnameâ€<br>2) â€œgenderâ€<br>3) â€œageâ€<br>127.0.0.1:6379&gt; hvals user</p><p>1) â€œlaowangâ€<br>2) â€œgirlâ€<br>3) â€œ100â€<br>127.0.0.1:6379&gt; hincrby user age 1<br>(integer) 101<br>127.0.0.1:6379&gt; hgetall user</p><p>1) â€œnameâ€<br>2) â€œlaowangâ€<br>3) â€œgenderâ€<br>4) â€œgirlâ€<br>5) â€œageâ€<br>6) â€œ101â€<br>127.0.0.1:6379&gt; hincrbyfloat user age 0.09<br>â€œ101.09â€<br>127.0.0.1:6379&gt; hgetall user</p><p>1) â€œnameâ€<br>2) â€œlaowangâ€<br>3) â€œgenderâ€<br>4) â€œgirlâ€<br>5) â€œageâ€<br>6) â€œ101.09â€</p><p>127.0.0.1:6379&gt; hset user2 name laowang<br>(integer) 1</p><h1 id="è¿”å›å½¢å¼éƒ½æ˜¯é€šè¿‡åˆ—è¡¨çš„å½¢å¼è¿›è¡Œè¿”å›"><a href="#è¿”å›å½¢å¼éƒ½æ˜¯é€šè¿‡åˆ—è¡¨çš„å½¢å¼è¿›è¡Œè¿”å›" class="headerlink" title="è¿”å›å½¢å¼éƒ½æ˜¯é€šè¿‡åˆ—è¡¨çš„å½¢å¼è¿›è¡Œè¿”å›"></a>è¿”å›å½¢å¼éƒ½æ˜¯é€šè¿‡åˆ—è¡¨çš„å½¢å¼è¿›è¡Œè¿”å›</h1><p>127.0.0.1:6379&gt; hkeys user2</p><p>1) â€œnameâ€</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="section">#### hashç±»å‹æ•°æ®æ“ä½œçš„æ³¨æ„äº‹é¡¹</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">* </span>hashç±»å‹ä¸‹çš„valueåªèƒ½å­˜å‚¨å­—ç¬¦ä¸²ï¼Œä¸å…è®¸å­˜å‚¨å…¶ä»–æ•°æ®ç±»å‹ï¼Œä¸å…è®¸åµŒå¥—ç°è±¡ã€‚å¦‚æœæ•°æ®æœªè·å–åˆ°ï¼Œå¯¹åº”çš„å€¼ä¸ºï¼ˆnilï¼‰</span><br><span class="line"><span class="bullet">* </span>æ¯ä¸ªhash å¯ä»¥å­˜å‚¨2^32 - 1 ä¸ªé”®å€¼å¯¹ï¼›ï¼ˆä¸Šé™ï¼‰</span><br><span class="line"><span class="bullet">* </span>hashç±»å‹ååˆ†è´´è¿‘å¯¹è±¡çš„æ•°æ®å­˜å‚¨å½¢å¼ï¼Œå¹¶ä¸”å¯ä»¥çµæ´»æ·»åŠ åˆ é™¤å¯¹è±¡å±æ€§ã€‚ä½†æ˜¯hashè®¾è®¡åˆè¡·<span class="strong">**ä¸æ˜¯ä¸ºäº†å­˜å‚¨å¤§é‡å¯¹è±¡è€Œè®¾è®¡**</span>çš„ï¼Œ<span class="strong">**åˆ‡è®°ä¸å¯æ»¥ç”¨**</span>ï¼Œ<span class="strong">**æ›´ä¸å¯ä»¥å°†hashä½œä¸ºå¯¹è±¡åˆ—è¡¨ä½¿ç”¨**</span>(éšç€å­˜å‚¨å¤§é‡å¯¹è±¡ï¼Œé‚£ä¹ˆæ•ˆç‡å°†ä¼šé™ä½)ï¼›</span><br><span class="line"><span class="bullet">* </span>hgetall æ“ä½œå¯ä»¥è·å–å…¨éƒ¨å±æ€§ï¼Œå¦‚æœå†…éƒ¨fieldè¿‡å¤šï¼Œéå†æ•´ä½“æ•°æ®æ•ˆç‡å°±ä¼šä½ï¼Œæœ‰å¯èƒ½æˆä¸ºæ•°æ®è®¿é—®ç“¶é¢ˆã€‚ï¼ˆæ¯æ¬¡æŸ¥è¯¢çš„æ—¶å€™æœ€å¥½æ˜¯è¦å“ªä¸ªæŸ¥è¯¢é‚£ä¸ªå³ä½¿ç”¨hget key fieldè¿™ç§æ–¹å¼ï¼›å› ä¸ºæœ‰äº›æ—¶å€™æ‹¿å‡ºä¸€äº›ä¸éœ€è¦çš„æ•°æ®æœ‰ä¸ªæ—¶å€™ä¼šå¾ˆå½±å“æ•ˆç‡ï¼‰</span><br><span class="line"></span><br><span class="line"><span class="section">### æ•°æ®ç±»å‹-hashå®ç°è´­ç‰©è½¦</span></span><br><span class="line"></span><br><span class="line"><span class="section">#### hash ç±»å‹åº”ç”¨åœºæ™¯</span></span><br><span class="line"></span><br><span class="line"><span class="section">##### ä¸šåŠ¡åœºæ™¯</span></span><br><span class="line"></span><br><span class="line">ç”µå•†ç½‘ç«™è´­ç‰©è½¦è®¾è®¡ä¸å®ç°  </span><br><span class="line"></span><br><span class="line">ï¼ˆäº¬ä¸œç”µå•†ç½‘ç«™è´­ç‰©è½¦ï¼‰  </span><br><span class="line"></span><br><span class="line">åˆ†æï¼š</span><br><span class="line"></span><br><span class="line"><span class="bullet">1. </span>ä¸åŒç”¨æˆ·çš„è´­ç‰©è½¦æ˜¯å…±ç”¨è¿˜æ˜¯å„ç”¨ä¸ªçš„ï¼ˆæ¯ä¸ªç”¨æˆ·çš„idå¯ä»¥è¿›è¡ŒåŒºåˆ†ï¼‰ï¼›</span><br><span class="line"><span class="bullet">2. </span>ä¸€ä¸ªè´­ç‰©è½¦ä¸­æ˜¯ä¸€æ ·å•†å“è¿˜æ˜¯å¤šæ ·å•†å“?</span><br><span class="line"><span class="bullet">3. </span>ä¸€ä¸ªå•†å“å­˜åœ¨æœ‰å¯¹åº”è´­ä¹°çš„æ•°é‡ï¼›</span><br><span class="line"></span><br><span class="line">æ­¤æ—¶:  </span><br><span class="line"></span><br><span class="line"><span class="bullet">1. </span>å¯ä»¥ä½¿ç”¨  ç”¨æˆ·id:key  ï¼Œå³ç”¨æˆ·idä½œä¸ºkeyï¼›</span><br><span class="line"><span class="bullet">2. </span>ç”¨ç”¨æˆ·æ‰€ä¹°çš„å•†å“ç¼–å·ä½œä¸ºfieldï¼Œå³ å•†å“id:fieldï¼›</span><br><span class="line"><span class="bullet">3. </span>é‚£ä¹ˆå¯¹åº”çš„valueå³è¯¥å•†å“æ‰€è´­ä¹°çš„æ•°é‡ï¼Œå³ æ•°é‡:valueï¼›</span><br><span class="line"><span class="bullet">4. </span>é‚£ä¹ˆæ­¤æ—¶ç»“æ„å®Œæˆã€‚</span><br><span class="line"></span><br><span class="line">é—®é¢˜ï¼š è´­ç‰©è½¦æ‰€å¯¹åº”çš„æ“ä½œï¼Œrediså½“ä¸­çš„hashæ˜¯å¦æ”¯æŒï¼Ÿ  </span><br><span class="line"></span><br><span class="line"><span class="bullet">1. </span>å•†å“æ•°é‡çš„è¯»å–ï¼šå–å€¼ï¼šhget</span><br><span class="line"><span class="bullet">2. </span>å•†å“æ•°é‡çš„å¢åŠ ã€è®¾ç½®ï¼šå¢åŠ :hincrbyï¼›è®¾ç½®:hset</span><br><span class="line"><span class="bullet">3. </span>åˆ é™¤è´­ç‰©è½¦ä¸­æŸä¸€å•†å“: åˆ é™¤:hdel</span><br><span class="line"><span class="bullet">4. </span>å…¨é€‰è·å–å¾—åˆ°å…¨éƒ¨çš„å•†å“ï¼šå…¨é€‰:hgetall</span><br><span class="line"><span class="bullet">5. </span>è·å–å•†å“æ€»æ•°é‡: æ€»é‡:hlen</span><br><span class="line"></span><br><span class="line"><span class="section">##### ä¸šåŠ¡åˆ†æ</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">* </span>ä»…åˆ†æè´­ç‰©è½¦çš„rediså­˜å‚¨æ¨¡å‹</span><br><span class="line"><span class="bullet">  * </span>æ·»åŠ ã€æµè§ˆã€æ›´æ”¹æ•°é‡ã€åˆ é™¤ã€æ¸…ç©º</span><br><span class="line"><span class="bullet">* </span>è´­ç‰©è½¦ä¸æ•°æ®åº“é—´æŒä¹…åŒ–åŒæ­¥ï¼ˆä¸è®¨è®ºï¼‰</span><br><span class="line"><span class="bullet">* </span>è´­ç‰©è½¦ä¸è®¢å•é—´å…³ç³»ï¼ˆä¸è®¨è®ºï¼‰</span><br><span class="line"><span class="bullet">  * </span>æäº¤è´­ç‰©è½¦ï¼šè¯»å–æ•°æ®ç”Ÿæˆè®¢å•</span><br><span class="line"><span class="bullet">  * </span>å•†å®¶ä¸´æ—¶ä»·æ ¼è°ƒæ•´ï¼šéš¶å±äºè®¢å•çº§åˆ«</span><br><span class="line"><span class="bullet">* </span>æœªç™»å½•ç”¨æˆ·è´­ç‰©è½¦ä¿¡æ¯å­˜å‚¨ï¼ˆä¸è®¨è®ºï¼‰</span><br><span class="line"><span class="bullet">  * </span>cookieå­˜å‚¨</span><br><span class="line"></span><br><span class="line"><span class="section">##### è§£å†³æ–¹æ¡ˆ</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">* </span>ä»¥å®¢æˆ·idä½œä¸ºkeyï¼Œæ¯ä½å®¢æˆ·åˆ›å»ºä¸€ä¸ªhashå­˜å‚¨ç»“æ„å­˜å‚¨å¯¹åº”çš„è´­ç‰©è½¦ä¿¡æ¯</span><br><span class="line"><span class="bullet">* </span>å°†å•†å“ç¼–å·ä½œä¸ºfieldï¼Œè´­ä¹°æ•°é‡ä½œä¸ºvalueè¿›è¡Œå­˜å‚¨</span><br><span class="line"><span class="bullet">* </span>æ·»åŠ å•†å“ï¼Œè¿½åŠ å…¨æ–°çš„fieldä¸value</span><br><span class="line"><span class="bullet">* </span>æµè§ˆï¼šéå†hash</span><br><span class="line"><span class="bullet">* </span>æ›´æ”¹æ•°é‡ï¼šè‡ªå¢/è‡ªå‡ï¼Œè®¾ç½®valueå€¼</span><br><span class="line"><span class="bullet">* </span>åˆ é™¤å•†å“ï¼šåˆ é™¤field</span><br><span class="line"><span class="bullet">* </span>æ¸…ç©ºï¼šåˆ é™¤field</span><br><span class="line"></span><br><span class="line">ç¤ºä¾‹ï¼š</span><br></pre></td></tr></table></figure><p>127.0.0.1:6379&gt; hmset 001 g01 100 g02 200<br>OK<br>127.0.0.1:6379&gt; hmset 002 g02 1 g04 7 g06 100<br>OK<br>127.0.0.1:6379&gt; hset 001 g03 9<br>(integer) 1<br>127.0.0.1:6379&gt; hgetall 001</p><p>1) â€œg01â€<br>2) â€œ100â€<br>3) â€œg02â€<br>4) â€œ200â€<br>5) â€œg03â€<br>6) â€œ9â€<br>127.0.0.1:6379&gt; hdel 001 g01<br>(integer) 1<br>127.0.0.1:6379&gt; hgetall 001</p><p>1) â€œg02â€<br>2) â€œ200â€<br>3) â€œg03â€<br>4) â€œ9â€<br>127.0.0.1:6379&gt; hincrby 001 g03 1<br>(integer) 10<br>127.0.0.1:6379&gt; hgetall 001</p><p>1) â€œg02â€<br>2) â€œ200â€<br>3) â€œg03â€<br>4) â€œ10â€</p><pre><code>##### å½“å‰è®¾è®¡æ˜¯å¦åŠ é€Ÿäº†è´­ç‰©è½¦çš„å‘ˆç°å½“å‰ä»…ä»…æ˜¯å°†æ•°æ®å­˜å‚¨åˆ°äº†redisä¸­ï¼Œå¹¶æ²¡æœ‰èµ·åˆ°åŠ é€Ÿçš„ä½œç”¨ï¼Œå•†å“ä¿¡æ¯è¿˜éœ€è¦äºŒæ¬¡æŸ¥è¯¢æ•°æ®åº“è´­ç‰©è½¦åˆ°åº•çœ‹åˆ°çš„æ˜¯ä»€ä¹ˆï¼Œç¬¬ä¸€ä¸ªå•†å“idæ˜¯ä»€ä¹ˆ?  å•†å“ä¿¡æ¯è¿˜å¿…é¡»äºŒæ¬¡å»æ•°æ®åº“è¿›è¡ŒæŸ¥è¯¢ï¼›å½“å‰çš„è¿™ç§æ–¹æ¡ˆæŸ¥çœ‹è´­ç‰©è½¦åªæ˜¯å­˜è´­ç‰©è½¦ï¼Œå¹¶æ²¡æœ‰æé«˜æ•ˆç‡ï¼›##### åˆ†æè¦è§£å†³çš„é—®é¢˜* æ¯æ¡è´­ç‰©è½¦ä¸­çš„å•†å“è®°å½•ä¿å­˜æˆä¸¤æ¡field### hashå®ç°æŠ¢è´­### æ•°æ®ç±»å‹-listç±»å‹ä»‹ç»ä¸åŸºæœ¬æ“ä½œ### æ•°æ®ç±»å‹-listé˜»å¡æ•°æ®è·å–### æ•°æ®ç±»å‹-listæ‰©å±•æ“ä½œåˆ é™¤æ•°æ®### æ•°æ®ç±»å‹-listå®ç°æ—¥å¿—æ¶ˆæ¯é˜Ÿåˆ—### æ•°æ®ç±»å‹-setç±»å‹ä»‹ç»ä¸åŸºæœ¬æ“ä½œ### æ•°æ®ç±»å‹-setæ“ä½œéšæœºæ•°æ®### æ•°æ®ç±»å‹-setæ•°æ®äº¤å¹¶å·®æ“ä½œ### æ•°æ®ç±»å‹-setå®ç°æƒé™æ ¡éªŒ### æ•°æ®ç±»å‹-setå®ç°ç½‘ç«™è®¿é—®é‡ç»Ÿè®¡### æ•°æ®ç±»å‹-setå®ç°é»‘ç™½åå•### setç±»å‹ä»‹ç»ä¸åŸºæœ¬æ“ä½œ### æ•°æ®ç±»å‹-sorted_setåŸºæœ¬æ“ä½œï¼ˆ2ï¼‰### æ•°æ®ç±»å‹-sorted_setå®ç°æ’è¡Œæ¦œ### setå®ç°æ—¶æ•ˆæ€§ä»»åŠ¡ç®¡ç†### setå¸¦æœ‰æƒé‡çš„ä»»åŠ¡ç®¡ç†### æ•°æ®ç±»å‹-æ¡ˆä¾‹-æŒ‰æ¬¡ç»“ç®—çš„æœåŠ¡æ§åˆ¶### æ•°æ®ç±»å‹-æ¡ˆä¾‹-å¾®ä¿¡æ¥æ”¶æ¶ˆæ¯é¡ºåºæ§åˆ¶### é€šç”¨æŒ‡ä»¤-keyåŸºæœ¬æ“ä½œ### é€šç”¨æŒ‡ä»¤-keyæ—¶æ•ˆæ€§æ§åˆ¶æ“ä½œ### é€šç”¨æŒ‡ä»¤-keyæŸ¥è¯¢æ“ä½œ### é€šç”¨æŒ‡ä»¤-keyå…¶ä»–æ“ä½œ### é€šç”¨æŒ‡ä»¤-dbåŸºæœ¬æ“ä½œ### é€šç”¨æŒ‡ä»¤-dbå…¶ä»–æ“ä½œ### jedis-jedisç®€ä»‹### jedis-helloworldï¼ˆjedisç‰ˆï¼‰### jedis-jediså¸¸è§„æ“ä½œæ¼”ç¤º### jedis-ä¸šåŠ¡è¯·æ±‚æ¬¡æ•°æ§åˆ¶æ¡ˆä¾‹éœ€æ±‚åˆ†æ### jedis-ç¨‹åºç»“æ„æ­å»º### jedis-ç¨‹åºä»£ç å®ç°### jedis-å·¥å…·ç±»åˆ¶ä½œ### jedis-å¯è§†åŒ–å®¢æˆ·ç«¯ä»‹ç»### linuxç¯å¢ƒå®‰è£…redis-åŸºäºLinuxå®‰è£…redis### linuxç¯å¢ƒå®‰è£…redis-æŒ‡å®šç«¯å£å¯åŠ¨æœåŠ¡### linuxç¯å¢ƒå®‰è£…redis-æŒ‡å®šé…ç½®æ–‡ä»¶å¯åŠ¨æœåŠ¡### linuxç¯å¢ƒå®‰è£…redis-é…ç½®æ–‡ä»¶å¯åŠ¨ç›®å½•ç®¡ç†### æŒä¹…åŒ–-æŒä¹…åŒ–ç®€ä»‹#### è¯¾ç¨‹å®‰æ’##### è¯¾ç¨‹è®¡åˆ’&gt; Windowsç¯å¢ƒ1. RedisåŸºç¡€  * Rediså…¥é—¨  * æ•°æ®ç±»å‹  * é€šç”¨å‘½ä»¤  * Jedis&gt; Linux ç¯å¢ƒ2. Redisé«˜çº§  * Rediså®‰è£…  * æŒä¹…åŒ–  * äº‹åŠ¡  * åˆ é™¤ç­–ç•¥  * redis.conf  * é«˜çº§æ•°æ®ç±»å‹3. Redisé›†ç¾¤4. ä¼ä¸šçº§è§£å†³æ–¹æ¡ˆ#### ç›®å½•Contents* æŒä¹…åŒ–ç®€ä»‹* RDB* AOF* RDBä¸AOFåŒºåˆ«* æŒä¹…åŒ–åº”ç”¨åœºæ™¯é¦–å…ˆä»€ä¹ˆæ˜¯æŒä¹…åŒ–ï¼Ÿé’ˆå¯¹rediså½“ä¸­çš„æŒä¹…åŒ–æ–¹æ¡ˆè¿›è¡Œé€ä¸€è®²è§£ï¼Œå¹¶å¯¹æ–¹æ¡ˆä¹‹é—´è¿›è¡Œä¸€ä¸ªæ¯”å¯¹ï¼›#### æ„å¤–çš„æ–­ç”µå†™è®ºæ–‡çš„æ—¶å€™æ–­ç”µäº†ã€‚#### â€œè‡ªåŠ¨å¤‡ä»½â€å…¶å®æ˜¯å°†å†…å­˜å½“ä¸­çš„æ•°æ®ä¸åœ¨ç¡¬ç›˜å½“ä¸­çš„æ•°æ®åšäº†ä¸€ä¸ªå…³è”ã€‚### æŒä¹…åŒ–-saveæŒ‡ä»¤### æŒä¹…åŒ–-RDBç›¸å…³é…ç½®### æŒä¹…åŒ–-æ•°æ®æ¢å¤è¿‡ç¨‹æ¼”ç¤º### æŒä¹…åŒ–-saveæŒ‡ä»¤å·¥ä½œåŸç†### æŒä¹…åŒ–-bgsaveæŒ‡ä»¤ä¸å·¥ä½œåŸç†### æŒä¹…åŒ–-saveé…ç½®ä¸å·¥ä½œåŸç†### æŒä¹…åŒ–-RDBä¸‰ç§å¯åŠ¨æ–¹å¼å¯¹æ¯”ä¸ä¼˜ç¼ºç‚¹åˆ†æ### æŒä¹…åŒ–-AOFç®€ä»‹### æŒä¹…åŒ–-AOFæŒä¹…åŒ–ç­–ç•¥åŸºæœ¬æ“ä½œ### æŒä¹…åŒ–-AOFé‡å†™æ¦‚å¿µä¸å‘½ä»¤æ‰§è¡Œ### æŒä¹…åŒ–-AOFè‡ªåŠ¨é‡å†™é…ç½®### æŒä¹…åŒ–-AOFé‡å†™å·¥ä½œåŸç†### æŒä¹…åŒ–-RDBä¸AOFæ–¹æ¡ˆå¯¹æ¯”### æŒä¹…åŒ–-æŒä¹…åŒ–åº”ç”¨åœºæ™¯åˆ†æ### äº‹åŠ¡-redisäº‹åŠ¡ç®€ä»‹### äº‹åŠ¡-äº‹åŠ¡çš„åŸºæœ¬æ“ä½œï¼ˆå®šä¹‰ï¼Œå–æ¶ˆï¼Œæ‰§è¡Œï¼‰### äº‹åŠ¡-äº‹åŠ¡çš„å·¥ä½œæµç¨‹### äº‹åŠ¡-äº‹åŠ¡æ“ä½œçš„æ³¨æ„äº‹é¡¹### äº‹åŠ¡-é”### äº‹åŠ¡-æ­»é”è§£å†³æ–¹æ¡ˆ### åˆ é™¤ç­–ç•¥-è¿‡æœŸæ•°æ®çš„æ¦‚å¿µ### åˆ é™¤ç­–ç•¥-è¿‡æœŸæ•°æ®çš„åº•å±‚å­˜å‚¨ç»“æ„### åˆ é™¤ç­–ç•¥-å®šæ—¶åˆ é™¤ä¸æƒ°æ€§åˆ é™¤### åˆ é™¤ç­–ç•¥-å®šæœŸåˆ é™¤### åˆ é™¤ç­–ç•¥-é€å‡ºç­–ç•¥### æœåŠ¡å™¨é…ç½®-redis.confé…ç½®### é«˜çº§æ•°æ®ç±»å‹-bitmapsä»‹ç»ä¸åŸºæœ¬æ“ä½œ### é«˜çº§æ•°æ®ç±»å‹-bitmapsæ‰©å±•æ“ä½œ### é«˜çº§æ•°æ®ç±»å‹-HyperLogLog### é«˜çº§æ•°æ®ç±»å‹-CEO### ä¸»ä»å¤åˆ¶-ä¸»ä»å¤åˆ¶ç®€ä»‹### ä¸»ä»å¤åˆ¶-ä¸»ä»å¤åˆ¶çš„ä½œç”¨### ä¸»ä»å¤åˆ¶-ä¸»ä»å¤åˆ¶çš„ä¸‰ä¸ªé˜¶æ®µ### ä¸»ä»å¤åˆ¶-å·¥ä½œæµç¨‹ï¼ˆ1ï¼‰å»ºç«‹è¿æ¥é˜¶æ®µ### ä¸»ä»å¤åˆ¶-æ­å»ºä¸»ä»ç»“æ„### ä¸»ä»å¤åˆ¶-å·¥ä½œæµç¨‹ï¼ˆ2ï¼‰æ•°æ®åŒæ­¥é˜¶æ®µï¼ˆç®€ï¼‰### ä¸»ä»å¤åˆ¶-æ•°æ®åŒæ­¥é˜¶æ®µæ³¨æ„äº‹é¡¹### ä¸»ä»å¤åˆ¶-è¿è¡Œid(runid)### ä¸»ä»å¤åˆ¶-å¤åˆ¶ç¼“å†²åŒºä¸åç§»é‡### ä¸»ä»å¤åˆ¶-å·¥ä½œæµç¨‹ï¼ˆ2ï¼‰æ•°æ®åŒæ­¥ä¸å‘½ä»¤ä¼ æ’­é˜¶æ®µï¼ˆå…¨ï¼‰### ä¸»ä»å¤åˆ¶-å¿ƒè·³æœºåˆ¶ä¸å‘½ä»¤ä¼ æ’­é˜¶æ®µå·¥ä½œæµç¨‹### ä¸»ä»å¤åˆ¶-å¸¸è§é—®é¢˜ï¼ˆ1ï¼‰### ä¸»ä»å¤åˆ¶-å¸¸è§é—®é¢˜ï¼ˆ2ï¼‰### ä¸»ä»å¤åˆ¶-å¸¸è§é—®é¢˜ï¼ˆ3ï¼‰### å“¨å…µ-å“¨å…µç®€ä»‹### å“¨å…µ-å“¨å…µç»“æ„æ­å»º### å“¨å…µ-å·¥ä½œåŸç†ï¼ˆ1ï¼‰### å“¨å…µ-å·¥ä½œåŸç†ï¼ˆ2ï¼‰### å“¨å…µ-å·¥ä½œåŸç†ï¼ˆ3ï¼‰### é›†ç¾¤-é›†ç¾¤ç®€ä»‹### é›†ç¾¤-é›†ç¾¤å­˜å‚¨ç»“æ„è®¾è®¡### é›†ç¾¤-clusteré›†ç¾¤æ­å»º### é›†ç¾¤-è®¾ç½®ä¸è·å–æ•°æ®### é›†ç¾¤-ä¸»ä»ä¸‹çº¿ä¸ä¸»ä»åˆ‡æ¢### ä¼ä¸šçº§è§£å†³æ–¹æ¡ˆ-ç¼“å­˜é¢„çƒ­### ä¼ä¸šçº§è§£å†³æ–¹æ¡ˆ-ç¼“å­˜é›ªå´©### ä¼ä¸šçº§è§£å†³æ–¹æ¡ˆ-ç¼“å­˜å‡»ç©¿### ä¼ä¸šçº§è§£å†³æ–¹æ¡ˆ-ç¼“å­˜ç©¿é€### ä¼ä¸šçº§è§£å†³æ–¹æ¡ˆ-æ€§èƒ½æŒ‡æ ‡ç›‘æ§### ä¼ä¸šçº§è§£å†³æ–¹æ¡ˆ-æ€§èƒ½æŒ‡æ ‡ç›‘æ§å‘½ä»¤</code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;è§‚çœ‹è§†é¢‘: &lt;code&gt;https://www.bilibili.com/video/BV1CJ411m7Gc?from=search&amp;am
      
    
    </summary>
    
    
      <category term="é¢è¯•" scheme="https://fengshana.github.io/categories/%E9%9D%A2%E8%AF%95/"/>
    
    
      <category term="é¢è¯•" scheme="https://fengshana.github.io/tags/%E9%9D%A2%E8%AF%95/"/>
    
      <category term="redis" scheme="https://fengshana.github.io/tags/redis/"/>
    
  </entry>
  
</feed>
