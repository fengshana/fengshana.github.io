<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Fsn</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://fengshana.github.io/"/>
  <updated>2020-04-14T17:45:12.433Z</updated>
  <id>https://fengshana.github.io/</id>
  
  <author>
    <name>Fsn</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>PayPal 支付流程</title>
    <link href="https://fengshana.github.io/2020/04/15/%E9%A2%86%E8%B5%AB/paypal%E6%94%AF%E4%BB%98%E6%B5%81%E7%A8%8B/"/>
    <id>https://fengshana.github.io/2020/04/15/%E9%A2%86%E8%B5%AB/paypal%E6%94%AF%E4%BB%98%E6%B5%81%E7%A8%8B/</id>
    <published>2020-04-15T04:52:56.000Z</published>
    <updated>2020-04-14T17:45:12.433Z</updated>
    
    <content type="html"><![CDATA[<h2 id="PayPal-交互示意图"><a href="#PayPal-交互示意图" class="headerlink" title="PayPal 交互示意图"></a>PayPal 交互示意图</h2><p>有一个关于paypal的交互图我得贡献出来，不知道从哪篇博客上保存下来的了，不太记得了。<br>通过这个交互图，然后再加上API文档更好理解一点。</p><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANX2e3FjuQJF1Z5tWbx.4FG5JL.HWnrtw7AHhlwZdbCbKOOk8Slh7k48Le*rSTcyj0OytedTNvnOyiYo.YjOMuSqQ!/r" alt="image"></p><p>分为四个端：一个是开发者端，一个是live端，一个是沙箱端，还有一个就是提工单的那个端</p><ul><li>提工单：<a href="https://www.paypal-support.com/s/contactsupport" target="_blank" rel="noopener">https://www.paypal-support.com/s/contactsupport</a></li><li>开发者：<a href="https://developer.paypal.com" target="_blank" rel="noopener">https://developer.paypal.com</a></li><li>沙箱：<a href="https://www.sandbox.paypal.com/" target="_blank" rel="noopener">https://www.sandbox.paypal.com/</a></li><li>live：<a href="https://www.paypal.com/c2/home" target="_blank" rel="noopener">https://www.paypal.com/c2/home</a></li></ul><h2 id="PayPal-maven依赖"><a href="#PayPal-maven依赖" class="headerlink" title="PayPal maven依赖"></a>PayPal maven依赖</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.paypal.sdk<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>rest-api-sdk<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--      &lt;version&gt;1.4.2&lt;/version&gt;--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.14.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="PayPal-相关Code"><a href="#PayPal-相关Code" class="headerlink" title="PayPal 相关Code"></a>PayPal 相关Code</h2><blockquote><p>PaypalConfig，paypal相关配置  </p></blockquote><p>关于这个代码百度一下，有很多。</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yourshares.configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.<span class="keyword">JSONObject</span>;</span><br><span class="line"><span class="keyword">import</span> com.paypal.base.codec.<span class="built_in">binary</span>.Base64;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.<span class="keyword">BufferedReader</span>;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.net.HttpURLConnection;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.<span class="keyword">HashMap</span>;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.paypal.base.rest.APIContext;</span><br><span class="line"><span class="keyword">import</span> com.paypal.base.rest.OAuthTokenCredential;</span><br><span class="line"><span class="keyword">import</span> com.paypal.base.rest.PayPalRESTException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.Scheduled;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@Configuration</span><br><span class="line"><span class="keyword">public</span> class PaypalConfig&#123;</span><br><span class="line">    @Value(<span class="string">"$&#123;paypal.client.app&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">String</span> clientId;</span><br><span class="line">    @Value(<span class="string">"$&#123;paypal.client.secret&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">String</span> clientSecret;</span><br><span class="line">    @Value(<span class="string">"$&#123;paypal.mode&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">String</span> mode;</span><br><span class="line">    @Value(<span class="string">"$&#123;paypal.tokenurl&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">String</span> tokenurl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    <span class="keyword">public</span> Map&lt;<span class="keyword">String</span>, <span class="keyword">String</span>&gt; paypalSdkConfig()&#123;</span><br><span class="line">        Map&lt;<span class="keyword">String</span>, <span class="keyword">String</span>&gt; sdkConfig = <span class="keyword">new</span> <span class="keyword">HashMap</span>&lt;&gt;();</span><br><span class="line">        sdkConfig.put(<span class="string">"mode"</span>, mode);</span><br><span class="line">        <span class="keyword">return</span> sdkConfig;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    <span class="keyword">public</span> OAuthTokenCredential authTokenCredential()&#123;</span><br><span class="line">        OAuthTokenCredential oAuthTokenCredential=<span class="keyword">new</span> OAuthTokenCredential(clientId, clientSecret, paypalSdkConfig());</span><br><span class="line">        <span class="keyword">return</span> oAuthTokenCredential;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    <span class="keyword">public</span> APIContext apiContext() <span class="keyword">throws</span> PayPalRESTException&#123;</span><br><span class="line"><span class="comment">//        APIContext apiContext = new APIContext(authTokenCredential().getAccessToken());</span></span><br><span class="line">        APIContext apiContext = <span class="keyword">new</span> APIContext(clientId, clientSecret, <span class="string">"sandbox"</span>);</span><br><span class="line"><span class="comment">//        apiContext.setConfigurationMap(paypalSdkConfig());</span></span><br><span class="line">        <span class="keyword">return</span> apiContext;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> APIContext refreshToken(APIContext apiContext)&#123;</span><br><span class="line">        System.out.<span class="built_in">println</span>(<span class="string">"===========[refreshToken]==========="</span>);</span><br><span class="line">        apiContext=apiContext.setRefreshToken(getAccessToken());</span><br><span class="line">        System.out.<span class="built_in">println</span>(<span class="string">"===========[refreshToken END]==========="</span>);</span><br><span class="line">        <span class="keyword">return</span> apiContext;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *    URL url = new URL(TOKEN_URL);</span></span><br><span class="line"><span class="comment">     *    String authorization = clientId+":"+secret;</span></span><br><span class="line"><span class="comment">     * @return</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span>  <span class="keyword">String</span> getAccessToken()&#123;</span><br><span class="line">        System.out.<span class="built_in">println</span>(<span class="string">"===========[getAccessToken]==========="</span>);</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            URL url = <span class="keyword">new</span> URL(tokenurl);</span><br><span class="line">            <span class="keyword">String</span> authorization = clientId+<span class="string">":"</span>+clientSecret;</span><br><span class="line">            authorization = Base64.encodeBase64String(authorization.getBytes());</span><br><span class="line">            HttpURLConnection conn = (HttpURLConnection) url.openConnection();</span><br><span class="line">            conn.setRequestMethod(<span class="string">"POST"</span>);<span class="comment">// 提交模式</span></span><br><span class="line">            <span class="comment">//设置请求头header</span></span><br><span class="line">            conn.setRequestProperty(<span class="string">"Accept"</span>, <span class="string">"application/json"</span>);</span><br><span class="line">            conn.setRequestProperty(<span class="string">"Accept-Language"</span>, <span class="string">"en_US"</span>);</span><br><span class="line">            conn.setRequestProperty(<span class="string">"Authorization"</span>, <span class="string">"Basic "</span>+authorization);</span><br><span class="line">            <span class="comment">// conn.setConnectTimeout(10000);//连接超时 单位毫秒</span></span><br><span class="line">            <span class="comment">// conn.setReadTimeout(2000);//读取超时 单位毫秒</span></span><br><span class="line">            conn.setDoOutput(<span class="keyword">true</span>);<span class="comment">// 是否输入参数</span></span><br><span class="line">            <span class="keyword">String</span> params = <span class="string">"grant_type=client_credentials"</span>;</span><br><span class="line">            conn.getOutputStream().write(params.getBytes());<span class="comment">// 输入参数</span></span><br><span class="line"></span><br><span class="line">            InputStreamReader inStream = <span class="keyword">new</span> InputStreamReader(conn.getInputStream());</span><br><span class="line">            <span class="keyword">BufferedReader</span> reader = <span class="keyword">new</span> <span class="keyword">BufferedReader</span>(inStream);</span><br><span class="line">            StringBuilder result = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">            <span class="keyword">String</span> lineTxt = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">while</span>((lineTxt = reader.readLine()) != <span class="keyword">null</span>)&#123;</span><br><span class="line">                result.<span class="built_in">append</span>(lineTxt);</span><br><span class="line">            &#125;</span><br><span class="line">            reader.close();</span><br><span class="line">            <span class="keyword">String</span> accessTokey = <span class="keyword">JSONObject</span>.parseObject(result.toString()).getString(<span class="string">"access_token"</span>);</span><br><span class="line">            System.out.<span class="built_in">println</span>(<span class="string">"[getAccessToken]:"</span>+accessTokey);</span><br><span class="line">            System.out.<span class="built_in">println</span>(<span class="string">"===========[getAccessToken END]==========="</span>);</span><br><span class="line">            <span class="keyword">return</span> accessTokey;</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception err)&#123;</span><br><span class="line">            err.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>业务层Service接口</p></blockquote><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">package com.yourshares.service.adminWeb;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.paypal.api.payments.Payment;</span><br><span class="line"><span class="keyword">import</span> com.paypal.base.rest.PayPalRESTException;</span><br><span class="line"><span class="keyword">import</span> com.yourshares.entity.model.vo.PaypalPaymentIntent;</span><br><span class="line"><span class="keyword">import</span> com.yourshares.entity.model.vo.PaypalPaymentMethod;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> interface PayService &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pay</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> throws IOException</span>;</span><br><span class="line">    <span class="function"><span class="keyword">String</span> <span class="title">toPay</span><span class="params">(Double totalAmount,<span class="keyword">String</span> OutRepoOrderNo)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">Payment <span class="title">createPayment</span><span class="params">(Double total,</span></span></span><br><span class="line"><span class="function"><span class="params">                          <span class="keyword">String</span> currency,</span></span></span><br><span class="line"><span class="function"><span class="params">                          PaypalPaymentMethod method,</span></span></span><br><span class="line"><span class="function"><span class="params">                          PaypalPaymentIntent intent,</span></span></span><br><span class="line"><span class="function"><span class="params">                          <span class="keyword">String</span> description,</span></span></span><br><span class="line"><span class="function"><span class="params">                          <span class="keyword">String</span> cancelUrl,</span></span></span><br><span class="line"><span class="function"><span class="params">                          <span class="keyword">String</span> successUrl,</span></span></span><br><span class="line"><span class="function"><span class="params">                          <span class="keyword">String</span> outRepoOrderNo)</span>throws PayPalRESTException</span>;</span><br><span class="line">    <span class="function">Payment <span class="title">executePayment</span><span class="params">(<span class="keyword">String</span> paymentId, <span class="keyword">String</span> payerId)</span> throws PayPalRESTException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">paypalCallback</span><span class="params">(Map params,HttpServletRequest request,HttpServletResponse response)</span>throws  IOException</span>;<span class="comment">//回调业务处理</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>业务层实现</p></blockquote><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line">package com.yourshares.service.adminWeb.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.util.StringUtil;</span><br><span class="line"><span class="keyword">import</span> com.paypal.api.payments.*;</span><br><span class="line"><span class="keyword">import</span> com.paypal.base.rest.APIContext;</span><br><span class="line"><span class="keyword">import</span> com.paypal.base.rest.PayPalRESTException;</span><br><span class="line"><span class="keyword">import</span> com.yourshares.common.exception.BizException;</span><br><span class="line"><span class="keyword">import</span> com.yourshares.entity.model.vo.PaypalPaymentIntent;</span><br><span class="line"><span class="keyword">import</span> com.yourshares.entity.model.vo.PaypalPaymentMethod;</span><br><span class="line"><span class="keyword">import</span> com.yourshares.common.tools.LogFileName;</span><br><span class="line"><span class="keyword">import</span> com.yourshares.common.utils.Kits;</span><br><span class="line"><span class="keyword">import</span> com.yourshares.common.utils.LoggerUtils;</span><br><span class="line"><span class="keyword">import</span> com.yourshares.configuration.PaypalConfig;</span><br><span class="line"><span class="keyword">import</span> com.yourshares.configuration.SpringDynamicCronTask;</span><br><span class="line"><span class="keyword">import</span> com.yourshares.entity.dao.TOutRepoOrderMapper;</span><br><span class="line"><span class="keyword">import</span> com.yourshares.entity.dao.TPaypalTransMapper;</span><br><span class="line"><span class="keyword">import</span> com.yourshares.entity.model.po.TOutRepoOrder;</span><br><span class="line"><span class="keyword">import</span> com.yourshares.entity.model.po.TPaypalTrans;</span><br><span class="line"><span class="keyword">import</span> com.yourshares.entity.service.TOutRepoOrderService;</span><br><span class="line"><span class="keyword">import</span> com.yourshares.entity.service.TPaypalTransService;</span><br><span class="line"><span class="keyword">import</span> com.yourshares.service.adminWeb.PayService;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.PropertySource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.interceptor.TransactionAspectSupport;</span><br><span class="line"><span class="keyword">import</span> tk.mybatis.mapper.entity.Condition;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.net.HttpURLConnection;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.net.URLEncoder;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line">@<span class="type">Service</span></span><br><span class="line">@<span class="type">PropertySource</span>(value = &#123;<span class="string">"classpath:application-$&#123;spring.profiles.active&#125;.properties"</span>&#125;, encoding = <span class="string">"utf-8"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PayServiceImpl</span> <span class="title">extends</span> <span class="title">BaseService</span> <span class="title">implements</span> <span class="title">PayService</span> </span>&#123;</span><br><span class="line">    <span class="type">Logger</span> logger = <span class="type">LoggerUtils</span>.<span class="type">Logger</span>(<span class="type">LogFileName</span>.<span class="type">API</span>);</span><br><span class="line"></span><br><span class="line">    @<span class="type">Autowired</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">APIContext</span> apiContext;</span><br><span class="line"></span><br><span class="line"><span class="comment">//回调地址</span></span><br><span class="line">    @<span class="type">Value</span>(<span class="string">"$&#123;paypal.notifyurl&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> notifyurl;</span><br><span class="line"></span><br><span class="line"><span class="comment">//支付成功页面地址</span></span><br><span class="line">    @<span class="type">Value</span>(<span class="string">"$&#123;paypal.successurl&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> successurl;</span><br><span class="line"></span><br><span class="line"><span class="comment">//支付关闭页面地址</span></span><br><span class="line">    @<span class="type">Value</span>(<span class="string">"$&#123;paypal.cancleurl&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> cancleurl;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ipn生产/沙箱地址</span></span><br><span class="line">    @<span class="type">Value</span>(<span class="string">"$&#123;paypal.ipnurl&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> ipnurl;</span><br><span class="line"></span><br><span class="line">    @<span class="type">Resource</span></span><br><span class="line">    <span class="type">TPaypalTransMapper</span> tPaypalTransMapper;</span><br><span class="line">    @<span class="type">Resource</span></span><br><span class="line">    <span class="type">TPaypalTransService</span> tPaypalTransService;</span><br><span class="line">    @<span class="type">Resource</span></span><br><span class="line">    <span class="type">TOutRepoOrderMapper</span> tOutRepoOrderMapper;</span><br><span class="line">    @<span class="type">Resource</span></span><br><span class="line">    <span class="type">TOutRepoOrderService</span> tOutRepoOrderService;</span><br><span class="line">    @<span class="type">Resource</span></span><br><span class="line">    <span class="type">PaypalConfig</span> paypalConfig;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="type">COMPLETED_STATUS</span>=<span class="string">"Completed"</span>;<span class="comment">//完成</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="type">REFUNDED_STATUS</span>=<span class="string">"refunded"</span>;<span class="comment">//退款</span></span><br><span class="line"></span><br><span class="line">    @<span class="type">Override</span></span><br><span class="line">    <span class="keyword">public</span> void pay(<span class="type">HttpServletRequest</span> request, <span class="type">HttpServletResponse</span> response) <span class="keyword">throws</span> <span class="type">IOException</span> &#123;</span><br><span class="line">        <span class="type">String</span> cancelUrl = cancleurl;<span class="comment">//关闭路径 URLUtils.getBaseURl(request) + "/api/v1/pay/cancle"</span></span><br><span class="line">        <span class="type">String</span> successUrl = successurl;<span class="comment">//成功路径 URLUtils.getBaseURl(request) + "/api/v1/pay/success"</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Payment</span> payment = createPayment(</span><br><span class="line">                    <span class="number">500.00</span>,</span><br><span class="line">                    <span class="string">"USD"</span>,</span><br><span class="line">                    <span class="type">PaypalPaymentMethod</span>.paypal,</span><br><span class="line">                    <span class="type">PaypalPaymentIntent</span>.sale,</span><br><span class="line">                    <span class="string">"payment description"</span>,</span><br><span class="line">                    cancelUrl,</span><br><span class="line">                    successUrl,<span class="string">"OUB"</span>+ <span class="type">Kits</span>.<span class="type">Date</span>.getyyyyMMddHHmmss());</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">Links</span> links : payment.getLinks())&#123;</span><br><span class="line">                <span class="keyword">if</span>(links.getRel().equals(<span class="string">"approval_url"</span>))&#123;</span><br><span class="line">                    logger.info(<span class="string">"======toPay redirect:[&#123;&#125;]"</span>,links.getHref());</span><br><span class="line">                    response.sendRedirect(links.getHref());</span><br><span class="line">                    <span class="comment">/*</span></span><br><span class="line"><span class="comment">                    response:</span></span><br><span class="line"><span class="comment">                    &#123;"id":"PAYID-LYZJW5A74P54450UP962954B","intent":"sale","state":"created",</span></span><br><span class="line"><span class="comment">                    "payer":&#123;"payment_method":"paypal"&#125;,</span></span><br><span class="line"><span class="comment">                    "transactions":[&#123;"amount":&#123;"total":"500.00","currency":"USD"&#125;,</span></span><br><span class="line"><span class="comment">                    "description":"payment description","related_resources":[]&#125;],"create_time":"2020-01-30T09:01:40Z",</span></span><br><span class="line"><span class="comment">                    "links":[&#123;"href":"https://api.sandbox.paypal.com/v1/payments/payment/PAYID-LYZJW5A74P54450UP962954B",</span></span><br><span class="line"><span class="comment">                    "rel":"self","method":"GET"&#125;,</span></span><br><span class="line"><span class="comment">                    &#123;"href":"https://www.sandbox.paypal.com/cgi-bin/webscr?cmd=_express-checkout&amp;token=EC-7K413818TR837130E","rel":"approval_url","method":"REDIRECT"&#125;,&#123;"href":"https://api.sandbox.paypal.com/v1/payments/payment/PAYID-LYZJW5A74P54450UP962954B/execute","rel":"execute","method":"POST"&#125;]&#125;</span></span><br><span class="line"><span class="comment">2020-01-30 17:01:37.676  WARN 3644 -- [nio-8080-exec-7] c.y.c.GlobalExceptionResolver            : Resolved [java.lang.IllegalStateException: Cannot call sendRedirect() after the response has been committed]</span></span><br><span class="line"><span class="comment">                     */</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (<span class="type">PayPalRESTException</span> e) &#123;</span><br><span class="line">            logger.error(e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">        response.sendRedirect(cancleurl);</span><br><span class="line"><span class="comment">//        response.getWriter().write("&lt;h1&gt;HELLO WORLLD&lt;/h1&gt;");</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><blockquote><p>获取支付链接</p></blockquote><figure class="highlight golo"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    public String toPay(Double totalAmount,String outRepoOrderNo) &#123;</span><br><span class="line">        String cancelUrl = cancleurl;//关闭路径</span><br><span class="line">        String successUrl =successurl;//成功路径</span><br><span class="line">        String url=<span class="string">""</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Payment payment = createPayment(</span><br><span class="line">                    totalAmount,</span><br><span class="line">                    <span class="string">"USD"</span>,</span><br><span class="line">                    PaypalPaymentMethod.paypal,</span><br><span class="line">                    PaypalPaymentIntent.sale,</span><br><span class="line">                    <span class="string">"领赫 - 账单(*^▽^*)"</span>,</span><br><span class="line">                    cancelUrl,</span><br><span class="line">                    successUrl,</span><br><span class="line">                    outRepoOrderNo);</span><br><span class="line">            <span class="keyword">for</span>(Links links : payment.getLinks())&#123;</span><br><span class="line">                <span class="keyword">if</span>(links.getRel().equals(<span class="string">"approval_url"</span>))&#123;</span><br><span class="line">                    logger.info(<span class="string">"======toPay redirect:[&#123;&#125;]"</span>,links.getHref());</span><br><span class="line">                    url=links.getHref();</span><br><span class="line">                    /*</span><br><span class="line">                    response:</span><br><span class="line">                    &#123;<span class="string">"id"</span>:<span class="string">"PAYID-LYZJW5A74P54450UP962954B"</span>,<span class="string">"intent"</span>:<span class="string">"sale"</span>,<span class="string">"state"</span>:<span class="string">"created"</span>,</span><br><span class="line">                    <span class="string">"payer"</span>:&#123;<span class="string">"payment_method"</span>:<span class="string">"paypal"</span>&#125;,</span><br><span class="line">                    <span class="string">"transactions"</span>:[&#123;<span class="string">"amount"</span>:&#123;<span class="string">"total"</span>:<span class="string">"500.00"</span>,<span class="string">"currency"</span>:<span class="string">"USD"</span>&#125;,</span><br><span class="line">                    <span class="string">"description"</span>:<span class="string">"payment description"</span>,<span class="string">"related_resources"</span>:[]&#125;],<span class="string">"create_time"</span>:<span class="string">"2020-01-30T09:01:40Z"</span>,</span><br><span class="line">                    <span class="string">"links"</span>:[&#123;<span class="string">"href"</span>:<span class="string">"https://api.sandbox.paypal.com/v1/payments/payment/PAYID-LYZJW5A74P54450UP962954B"</span>,</span><br><span class="line">                    <span class="string">"rel"</span>:<span class="string">"self"</span>,<span class="string">"method"</span>:<span class="string">"GET"</span>&#125;,</span><br><span class="line">                    &#123;<span class="string">"href"</span>:<span class="string">"https://www.sandbox.paypal.com/cgi-bin/webscr?cmd=_express-checkout&amp;token=EC-7K413818TR837130E"</span>,<span class="string">"rel"</span>:<span class="string">"approval_url"</span>,<span class="string">"method"</span>:<span class="string">"REDIRECT"</span>&#125;,&#123;<span class="string">"href"</span>:<span class="string">"https://api.sandbox.paypal.com/v1/payments/payment/PAYID-LYZJW5A74P54450UP962954B/execute"</span>,<span class="string">"rel"</span>:<span class="string">"execute"</span>,<span class="string">"method"</span>:<span class="string">"POST"</span>&#125;]&#125;</span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-30</span> <span class="number">17</span>:<span class="number">01</span>:<span class="number">37.676</span>  WARN <span class="number">3644</span> -- [nio<span class="number">-8080</span>-exec<span class="number">-7</span>] c.y.c.GlobalExceptionResolver            : Resolved [java.lang.IllegalStateException: Cannot call sendRedirect() after the response has been committed]</span><br><span class="line">                     */</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (PayPalRESTException e) &#123;</span><br><span class="line">            logger.error(e.getMessage());</span><br><span class="line">            /*</span><br><span class="line">            david</span><br><span class="line">            设置有限刷新次数（&lt;<span class="number">10</span>次），如果多次失败，返回必须返回给上层应用，且把下次刷新时间设置为<span class="number">10</span>分钟之后。成功了就设置为<span class="number">10</span>个小时。</span><br><span class="line">            尝试次数你设置<span class="number">3</span>次吧,现在如果失败了，发送账单接口很久才能返回</span><br><span class="line">             */</span><br><span class="line">            //Error code : <span class="number">401</span> <span class="keyword">with</span> response : &#123;<span class="string">"error"</span>:<span class="string">"invalid_token"</span>,<span class="string">"error_description"</span>:<span class="string">"Access Token not found in cache"</span>&#125;</span><br><span class="line">            // Error code : <span class="number">400</span> <span class="keyword">with</span> response : &#123;<span class="string">"name"</span>:<span class="string">"VALIDATION_ERROR"</span>,<span class="string">"details"</span>:[&#123;<span class="string">"field"</span>:<span class="string">"transactions[0].amount"</span>,<span class="string">"issue"</span>:<span class="string">"Amount cannot be zero"</span>&#125;],<span class="string">"message"</span>:<span class="string">"Invalid request - see details"</span>,<span class="string">"information_link"</span>:<span class="string">"https://developer.paypal.com/docs/api/payments/#errors"</span>,<span class="string">"debug_id"</span>:<span class="string">"16ccf2387e7d9"</span>&#125;</span><br><span class="line">            //Error code : <span class="number">400</span> <span class="keyword">with</span> response : &#123;<span class="string">"name"</span>:<span class="string">"VALIDATION_ERROR"</span>,<span class="string">"message"</span>:<span class="string">"Invalid request - see details"</span>,<span class="string">"debug_id"</span>:<span class="string">"cf6130d18a99"</span>,<span class="string">"information_link"</span>:<span class="string">"https://developer.paypal.com/docs/api/payments/#errors"</span>,<span class="string">"details"</span>:[&#123;<span class="string">"field"</span>:<span class="string">"transactions[0].amount.total"</span>,<span class="string">"location"</span>:<span class="string">"body"</span>,<span class="string">"issue"</span>:<span class="string">"Currency amount must be non-negative number, contain exactly 2 decimal places separated by '.' (JPY contains 0 decimal places), optional thousands separator ',', limited to 7 digits before the decimal point and currency which is a valid ISO Currency Code"</span>&#125;,&#123;<span class="string">"field"</span>:<span class="string">"transactions[0].amount.total.value"</span>,<span class="string">"location"</span>:<span class="string">"body"</span>,<span class="string">"issue"</span>:<span class="string">"Value too long (max length 10)"</span>&#125;]&#125;</span><br><span class="line">            <span class="keyword">if</span>(StringUtils.isNotEmpty(e.getMessage()))&#123;</span><br><span class="line">                String responseDesc=e.getMessage();</span><br><span class="line">                String[] strings=responseDesc.split(<span class="string">"\\&#123;"</span>);</span><br><span class="line">                String json=<span class="string">"&#123;"</span>+strings[<span class="number">1</span>];</span><br><span class="line">                JSONObject response=JSONObject.parseObject(json);</span><br><span class="line">                logger.info(<span class="string">"打印response: "</span>+response.toString());</span><br><span class="line">                <span class="keyword">if</span>(response!=<span class="literal">null</span> &amp;&amp; response.getString(<span class="string">"error"</span>)!=<span class="literal">null</span> &amp;&amp; response.getString(<span class="string">"error"</span>).equalsIgnoreCase(<span class="string">"invalid_token"</span>))&#123;</span><br><span class="line">                    String newUrl=<span class="string">""</span>;</span><br><span class="line">                    <span class="keyword">for</span>(int n=<span class="number">0</span>;n&lt;<span class="number">3</span>;n++)&#123;</span><br><span class="line">                        //在更新了token之后重试</span><br><span class="line">                        logger.info(<span class="string">"token失效，更换新的token,原来的token: &#123;&#125;"</span>,apiContext.getAccessToken());</span><br><span class="line">//                        paypalConfig.refreshToken(apiContext);</span><br><span class="line">                        logger.info(<span class="string">"更换新的token:&#123;&#125;"</span>,apiContext.getAccessToken());</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            Payment payment = createPayment(</span><br><span class="line">                                    totalAmount,</span><br><span class="line">                                    <span class="string">"USD"</span>,</span><br><span class="line">                                    PaypalPaymentMethod.paypal,</span><br><span class="line">                                    PaypalPaymentIntent.sale,</span><br><span class="line">                                    <span class="string">"领赫 - 账单(*^▽^*)"</span>,</span><br><span class="line">                                    cancelUrl,</span><br><span class="line">                                    successUrl,</span><br><span class="line">                                    outRepoOrderNo);</span><br><span class="line">                            <span class="keyword">for</span> (Links links : payment.getLinks()) &#123;</span><br><span class="line">                                <span class="keyword">if</span> (links.getRel().equals(<span class="string">"approval_url"</span>)) &#123;</span><br><span class="line">                                    logger.info(<span class="string">"======toPay redirect:[&#123;&#125;]"</span>, links.getHref());</span><br><span class="line">                                    newUrl = links.getHref();</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;<span class="keyword">catch</span> (PayPalRESTException e1)&#123;</span><br><span class="line">                            logger.error(e1.getMessage());</span><br><span class="line">                        &#125;</span><br><span class="line">                       <span class="keyword">if</span>(StringUtils.isNotEmpty(newUrl))&#123;//尝试三次当中存在有一次url不为空则断开循环</span><br><span class="line">                           <span class="keyword">break</span>;</span><br><span class="line">                       &#125;<span class="keyword">else</span>&#123;//当次循环当中支付链接为空则跳出当次循环进入下一次循环</span><br><span class="line">                            <span class="keyword">continue</span>;</span><br><span class="line">                       &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(StringUtils.isEmpty(newUrl))&#123;//循环了三次之后如果newUrl还是空则抛出异常通知上层应用，说获取支付链接失败</span><br><span class="line">                        //且把下次刷新时间设置为<span class="number">10</span>分钟之后。成功了就设置为<span class="number">10</span>个小时。</span><br><span class="line">                        SpringDynamicCronTask.cron=<span class="string">"0/600 * * * * ?"</span>;//十分钟后再试</span><br><span class="line">                        <span class="keyword">throw</span> new BizException(<span class="string">"获取支付链接异常，请稍后重试"</span>);</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        url=newUrl;</span><br><span class="line">                        SpringDynamicCronTask.cron=<span class="string">"*/36000 * * * * ?"</span>;//十分钟后再试</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span> (response!=<span class="literal">null</span> &amp;&amp; response.getString(<span class="string">"name"</span>)!=<span class="literal">null</span> &amp;&amp;response.getString(<span class="string">"name"</span>).equalsIgnoreCase(<span class="string">"VALIDATION_ERROR"</span>))&#123;</span><br><span class="line">                    //金额无效</span><br><span class="line">                    url =<span class="literal">null</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    url=<span class="literal">null</span>;//<span class="string">"http://y22711s118.iask.in/pay/cancle.html"</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            url=StringUtils.isEmpty(url)==<span class="literal">true</span>?<span class="literal">null</span>:url;//<span class="string">"http://y22711s118.iask.in/pay/cancle.html"</span></span><br><span class="line">        &#125;</span><br><span class="line">     <span class="keyword">return</span> url;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><blockquote><p>创建支付</p></blockquote><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">@Override</span><br><span class="line"><span class="built_in">public</span> Payment createPayment(</span><br><span class="line">        <span class="type">Double</span> total,</span><br><span class="line">        String currency,</span><br><span class="line">        PaypalPaymentMethod <span class="keyword">method</span>,</span><br><span class="line">        PaypalPaymentIntent intent,</span><br><span class="line">        String description,</span><br><span class="line">        String cancelUrl,</span><br><span class="line">        String successUrl,</span><br><span class="line">        String outRepoOrderNo) throws PayPalRESTException &#123;</span><br><span class="line">    Amount amount = <span class="built_in">new</span> Amount();</span><br><span class="line">    amount.setCurrency(currency);</span><br><span class="line">    amount.setTotal(String.format("%.2f", total));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">Transaction</span> <span class="keyword">transaction</span> = <span class="built_in">new</span> <span class="keyword">Transaction</span>();</span><br><span class="line">    <span class="keyword">transaction</span>.setDescription(description);</span><br><span class="line">    <span class="keyword">transaction</span>.setAmount(amount);</span><br><span class="line">    <span class="keyword">transaction</span>.setNotifyUrl(notifyurl);</span><br><span class="line">    <span class="keyword">transaction</span>.setCustom(outRepoOrderNo);//设置订单号<span class="comment">--就取自发货单好了</span></span><br><span class="line"></span><br><span class="line">    List&lt;<span class="keyword">Transaction</span>&gt; transactions = <span class="built_in">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    transactions.<span class="keyword">add</span>(<span class="keyword">transaction</span>);</span><br><span class="line"></span><br><span class="line">    Payer payer = <span class="built_in">new</span> Payer();</span><br><span class="line">    payer.setPaymentMethod(<span class="keyword">method</span>.toString());</span><br><span class="line"></span><br><span class="line">    Payment payment = <span class="built_in">new</span> Payment();</span><br><span class="line">    payment.setIntent(intent.toString());</span><br><span class="line">    payment.setPayer(payer);</span><br><span class="line">    payment.setTransactions(transactions);</span><br><span class="line">    RedirectUrls redirectUrls = <span class="built_in">new</span> RedirectUrls();</span><br><span class="line">    redirectUrls.setCancelUrl(cancelUrl);</span><br><span class="line">    redirectUrls.setReturnUrl(successUrl);</span><br><span class="line">    payment.setRedirectUrls(redirectUrls);</span><br><span class="line"></span><br><span class="line">    logger.<span class="keyword">info</span>("token: "+apiContext.getAccessToken());</span><br><span class="line">    <span class="keyword">return</span> payment.<span class="keyword">create</span>(apiContext);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>执行支付</p></blockquote><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public Payment execute<span class="constructor">Payment(String <span class="params">paymentId</span>, String <span class="params">payerId</span>)</span> throws PayPalRESTException&#123;</span><br><span class="line">    Payment payment = <span class="keyword">new</span> <span class="constructor">Payment()</span>;</span><br><span class="line">    payment.set<span class="constructor">Id(<span class="params">paymentId</span>)</span>;</span><br><span class="line">    PaymentExecution paymentExecute = <span class="keyword">new</span> <span class="constructor">PaymentExecution()</span>;</span><br><span class="line">    paymentExecute.set<span class="constructor">PayerId(<span class="params">payerId</span>)</span>;</span><br><span class="line">    return payment.execute(apiContext, paymentExecute);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>paypal的ipn回调处理</p></blockquote><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br></pre></td><td class="code"><pre><span class="line">    @Transactional</span><br><span class="line">    @Override</span><br><span class="line">    public void paypal<span class="constructor">Callback(Map <span class="params">params</span>,HttpServletRequest <span class="params">request</span>,HttpServletResponse <span class="params">response</span>)</span> throws  IOException&#123;</span><br><span class="line">        logger.info(<span class="string">"paypalCallback &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 进入paypal后台支付通知"</span>);</span><br><span class="line">        PrintWriter out = response.get<span class="constructor">Writer()</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 获取paypal请求参数,并拼接验证参数  文档：https://developer.paypal.com/docs/ipn/integration-guide/ht-ipn/</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line"></span><br><span class="line">            <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"打印一下姓氏："</span>+request.get<span class="constructor">Parameter(<span class="string">"first_name"</span>)</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        Enumeration&lt;String&gt; en = request.get<span class="constructor">ParameterNames()</span>;</span><br><span class="line">        String str = <span class="string">"cmd=_notify-validate"</span>;</span><br><span class="line">        <span class="keyword">while</span> (en.has<span class="constructor">MoreElements()</span>) &#123;</span><br><span class="line">            String paramName = en.next<span class="constructor">Element()</span>;</span><br><span class="line">            String paramValue = request.get<span class="constructor">Parameter(<span class="params">paramName</span>)</span>;<span class="comment">//通过参数名称获取参数值</span></span><br><span class="line">            <span class="comment">//此处的编码一定要和自己的网站编码一致，不然会出现乱码，paypal回复的通知为‘INVALID’</span></span><br><span class="line">            str = str + <span class="string">"&amp;"</span> + paramName + <span class="string">"="</span> + <span class="module-access"><span class="module"><span class="identifier">URLEncoder</span>.</span></span>encode(paramValue,<span class="string">"utf-8"</span>);<span class="comment">//utf-8 URLEncoder.encode(paramValue, "UTF-8")</span></span><br><span class="line">            <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"paramName: "</span>+paramName+<span class="string">"   paramValue:"</span>+paramValue);</span><br><span class="line">            logger.info(<span class="string">"paramName: "</span>+paramName+<span class="string">"   paramValue:"</span>+paramValue);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//建议在此将接受到的信息 str 记录到日志文件中以确认是否收到 IPN 信息</span></span><br><span class="line">        logger.info(<span class="string">"========================================================================================="</span>);</span><br><span class="line">        logger.info(<span class="string">"paypal传递过来的交易信息:"</span>+str);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 将信息 POST 回给 PayPal 进行验证</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">//验证地址测试环境和正式环境不一样配置在yml中</span></span><br><span class="line">        URL u = <span class="keyword">new</span> <span class="constructor">URL(<span class="params">ipnurl</span>)</span>;<span class="comment">//https://ipnpb.paypal.com/cgi-bin/webscr  https://ipnpb.sandbox.paypal.com/cgi-bin/webscr</span></span><br><span class="line">        HttpURLConnection uc = (HttpURLConnection) u.<span class="keyword">open</span><span class="constructor">Connection()</span>;</span><br><span class="line">        uc.set<span class="constructor">RequestMethod(<span class="string">"POST"</span>)</span>;</span><br><span class="line">        uc.set<span class="constructor">DoOutput(<span class="params">true</span>)</span>;</span><br><span class="line">        uc.set<span class="constructor">DoInput(<span class="params">true</span>)</span>;</span><br><span class="line">        uc.set<span class="constructor">UseCaches(<span class="params">false</span>)</span>;</span><br><span class="line">        <span class="comment">//设置 HTTP 的头信息</span></span><br><span class="line">        uc.set<span class="constructor">RequestProperty(<span class="string">"Content-Type"</span>, <span class="string">"application/x-www-form-urlencoded"</span>)</span>;</span><br><span class="line">        PrintWriter pw = <span class="keyword">new</span> <span class="constructor">PrintWriter(<span class="params">uc</span>.<span class="params">getOutputStream</span>()</span>);</span><br><span class="line">        pw.println(str);</span><br><span class="line">        pw.close<span class="literal">()</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 接受 PayPal 对 IPN 回发的回复信息</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        BufferedReader <span class="keyword">in</span> = <span class="keyword">new</span> <span class="constructor">BufferedReader(<span class="params">new</span> InputStreamReader(<span class="params">uc</span>.<span class="params">getInputStream</span>()</span>));</span><br><span class="line">        String res = <span class="keyword">in</span>.read<span class="constructor">Line()</span>;</span><br><span class="line">        <span class="keyword">in</span>.close<span class="literal">()</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 将 POST 信息分配给本地变量，可以根据您的需要添加</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        String paymentStatus = request.get<span class="constructor">Parameter(<span class="string">"payment_status"</span>)</span>; <span class="comment">// 交易状态 Completed 代表交易成功</span></span><br><span class="line">        String paymentDate = request.get<span class="constructor">Parameter(<span class="string">"payment_date"</span>)</span>;<span class="comment">// 交易时间</span></span><br><span class="line">        String txnId = request.get<span class="constructor">Parameter(<span class="string">"txn_id"</span>)</span>; <span class="comment">// 交易id</span></span><br><span class="line">        String parentTxnId = request.get<span class="constructor">Parameter(<span class="string">"parent_txn_id"</span>)</span>; <span class="comment">// 父交易id</span></span><br><span class="line"><span class="comment">//        String receiverEmail = request.getParameter("receiver_email"); // 收款人email</span></span><br><span class="line"><span class="comment">//        String receiverId = request.getParameter("receiver_id"); // 收款人id</span></span><br><span class="line"><span class="comment">//        String payerEmail = request.getParameter("payer_email"); // 付款人email</span></span><br><span class="line"><span class="comment">//        String payerId = request.getParameter("payer_id");  // 付款人id</span></span><br><span class="line"><span class="comment">//        String mcGross = request.getParameter("mc_gross"); // 交易金额</span></span><br><span class="line">        String custom = request.get<span class="constructor">Parameter(<span class="string">"custom"</span>)</span>; <span class="comment">// 自定义字段，我们存放的订单ID</span></span><br><span class="line">        <span class="keyword">if</span> (res<span class="operator"> == </span>null<span class="operator"> || </span>res<span class="operator"> == </span><span class="string">""</span>) &#123;</span><br><span class="line">            res = <span class="string">"0"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        logger.info(<span class="string">"res = "</span> + res);</span><br><span class="line">        logger.info(<span class="string">"paymentStatus = "</span> + paymentStatus);</span><br><span class="line">        logger.info(<span class="string">"txnI = "</span> + txnId);</span><br><span class="line">        logger.info(<span class="string">"parentTxnId = "</span> + parentTxnId);</span><br><span class="line">        logger.info(<span class="string">"custom = "</span> + custom);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 获取 PayPal 对回发信息的回复信息，判断刚才的通知是否为 PayPal 发出的</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">"VERIFIED"</span>.equals<span class="constructor">IgnoreCase(<span class="params">res</span>)</span>) &#123;</span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">             * 如果 parentTxnId 不为空我们就认为是通知就不是第一次通知</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="module-access"><span class="module"><span class="identifier">StringUtil</span>.</span></span>is<span class="constructor">NotEmpty(<span class="params">parentTxnId</span>)</span>) &#123;</span><br><span class="line"><span class="comment">//                // 根据父支付交易号查询付款表数据</span></span><br><span class="line"><span class="comment">//                List&lt;ShopOrderPayment&gt; list = shopOrderPaymentService.getOrderPaymentByParentTxnId(parentTxnId);</span></span><br><span class="line">                Condition paypalTransCondition=<span class="keyword">new</span> <span class="constructor">Condition(TPaypalTrans.<span class="params">class</span>)</span>;</span><br><span class="line">                paypalTransCondition.create<span class="constructor">Criteria()</span>.<span class="keyword">and</span><span class="constructor">EqualTo(<span class="string">"parentTxnId"</span>,<span class="params">parentTxnId</span>)</span>;</span><br><span class="line">                List&lt;TPaypalTrans&gt; tPaypalTransList=tPaypalTransService.find<span class="constructor">ByCondition(<span class="params">paypalTransCondition</span>)</span>;</span><br><span class="line">                <span class="keyword">if</span> (null != tPaypalTransList<span class="operator"> &amp;&amp; </span>tPaypalTransList.size<span class="literal">()</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">/**</span></span><br><span class="line"><span class="comment">                     * 保存支付历史记录数据</span></span><br><span class="line"><span class="comment">                    */</span></span><br><span class="line">                    TPaypalTrans updateTPaypalTrans=<span class="keyword">new</span> <span class="constructor">TPaypalTrans()</span>;</span><br><span class="line">                    updateTPaypalTrans.set<span class="constructor">PaymentStatus(<span class="params">paymentStatus</span>)</span>;<span class="comment">//更新交易状态</span></span><br><span class="line">                    updateTPaypalTrans.set<span class="constructor">PaymentDate(<span class="params">paymentDate</span>)</span>;<span class="comment">//更新交易时间</span></span><br><span class="line">                    <span class="built_in">int</span> n=tPaypalTransService.update(updateTPaypalTrans,paypalTransCondition);</span><br><span class="line">                    <span class="keyword">if</span>(n&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                        logger.info(<span class="string">"更新paypalTrans记录成功：[&#123;&#125;]"</span>,n);</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        logger.info(<span class="string">"更新paypalTrans记录失败：[&#123;&#125;]"</span>,n);</span><br><span class="line">                        throw <span class="keyword">new</span> <span class="constructor">BizException(<span class="string">"更新paypalTrans记录失败"</span>)</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"><span class="comment">//                    /**</span></span><br><span class="line"><span class="comment">//                     * 判断状态是complete则更新订单状态为待确认收货</span></span><br><span class="line"><span class="comment">//                     * 如果是refunded则更新订单状态为已完成</span></span><br><span class="line"><span class="comment">//                     */</span></span><br><span class="line">                    <span class="keyword">if</span> (<span class="module-access"><span class="module"><span class="identifier">COMPLETED_STATUS</span>.</span></span>equals<span class="constructor">IgnoreCase(<span class="params">paymentStatus</span>)</span><span class="operator"> &amp;&amp; </span><span class="module-access"><span class="module"><span class="identifier">StringUtils</span>.</span></span>is<span class="constructor">NotEmpty(<span class="params">custom</span>)</span>) &#123;</span><br><span class="line">                        <span class="comment">//状态是已经完成则进行更新发货表当中的状态OK  //进行更新发货单的状态为支付成功</span></span><br><span class="line">                        TOutRepoOrder tOutRepoOrder=<span class="keyword">new</span> <span class="constructor">TOutRepoOrder()</span>;</span><br><span class="line">                        tOutRepoOrder.set<span class="constructor">TakeDeliveryId(<span class="params">custom</span>)</span>;</span><br><span class="line">                        tOutRepoOrder=tOutRepoOrderService.find<span class="constructor">OneForUpdate(<span class="params">tOutRepoOrder</span>)</span>;</span><br><span class="line">                        <span class="keyword">if</span>(<span class="number">1</span>==tOutRepoOrder.get<span class="constructor">FinanceStatus()</span>)&#123;</span><br><span class="line">                            <span class="comment">//已经更新为已支付无需再次更新下============================================</span></span><br><span class="line">                        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                            <span class="comment">//进行更新为已支付</span></span><br><span class="line">                            TOutRepoOrder updateTOutRepoOrder=<span class="keyword">new</span> <span class="constructor">TOutRepoOrder()</span>;</span><br><span class="line">                            updateTOutRepoOrder.set<span class="constructor">FinanceStatus(1)</span>;<span class="comment">////财务状态0-待确认账单，1-等待支付，2-已支付/3-无需支付 david:还要把订单状态改为“待投入渠道</span></span><br><span class="line">                            updateTOutRepoOrder.set<span class="constructor">Status(2)</span>;<span class="comment">//0 :待发送账单/1:待放货/2:待投入渠道/3:已投入渠道/4：已完成 / 5：已取消*/</span></span><br><span class="line">                            updateTOutRepoOrder.set<span class="constructor">LastUpdateDate((System.<span class="params">currentTimeMillis</span>()</span>/<span class="number">1000L</span>));</span><br><span class="line">                            updateTOutRepoOrder.set<span class="constructor">ConfirmPaymentDate((System.<span class="params">currentTimeMillis</span>()</span>/<span class="number">1000L</span>));<span class="comment">//确认支付时间</span></span><br><span class="line">                            Condition updateOutRepoCondition=<span class="keyword">new</span> <span class="constructor">Condition(TOutRepoOrder.<span class="params">class</span>)</span>;</span><br><span class="line">                            updateOutRepoCondition.create<span class="constructor">Criteria()</span>.<span class="keyword">and</span><span class="constructor">EqualTo(<span class="string">"takeDeliveryId"</span>,<span class="params">custom</span>)</span>;</span><br><span class="line">                            <span class="built_in">int</span> m=tOutRepoOrderService.update(updateTOutRepoOrder,updateOutRepoCondition);</span><br><span class="line">                            <span class="keyword">if</span>(m&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                                logger.info(<span class="string">"更新发货单成功：[&#123;&#125;]"</span>,m);</span><br><span class="line">                            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                                logger.info(<span class="string">"更新发货单失败：[&#123;&#125;]"</span>,m);</span><br><span class="line">                                <span class="module-access"><span class="module"><span class="identifier">TransactionAspectSupport</span>.</span></span>current<span class="constructor">TransactionStatus()</span>.set<span class="constructor">RollbackOnly()</span>;</span><br><span class="line">                                throw <span class="keyword">new</span> <span class="constructor">BizException(<span class="string">"更新发货单失败"</span>)</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="module-access"><span class="module"><span class="identifier">REFUNDED_STATUS</span>.</span></span>equals<span class="constructor">IgnoreCase(<span class="params">paymentStatus</span>)</span>) &#123;</span><br><span class="line">                    <span class="comment">//paypalService.updateOrderStatus(shopOrderPayment.getOrderId(), com.sunvalley.shop.order.constants.Constants.OrderStatus.STATUS_COMPLETE);</span></span><br><span class="line">                    <span class="comment">//暂时不处理，退款状态</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    logger.error(<span class="string">"父支付交易号："</span> + parentTxnId + <span class="string">" 在支付表中不存在"</span>);</span><br><span class="line">                    logger.error(<span class="string">"Class: "</span>+this.get<span class="constructor">Class()</span>.get<span class="constructor">Name()</span>+<span class="string">" method: "</span>+</span><br><span class="line">                            <span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>current<span class="constructor">Thread()</span>.get<span class="constructor">StackTrace()</span><span class="literal">[<span class="number">1</span>]</span>.get<span class="constructor">MethodName()</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">/**</span></span><br><span class="line"><span class="comment">                 * 第一次回调通知,根据 txnId 查询。如果存在则表示支付实时返回结果已经记录了，不存在则表示实时返回结果没有记录到</span></span><br><span class="line"><span class="comment">                 */</span></span><br><span class="line">                TPaypalTrans tPaypalTrans=<span class="keyword">new</span> <span class="constructor">TPaypalTrans()</span>;</span><br><span class="line">                tPaypalTrans.set<span class="constructor">TxnId(<span class="params">txnId</span>)</span>;</span><br><span class="line">                tPaypalTrans=tPaypalTransService.find<span class="constructor">OneForUpdate(<span class="params">tPaypalTrans</span>)</span>;</span><br><span class="line">                <span class="keyword">if</span> (null != tPaypalTrans ) &#123;<span class="comment">//存在记录  &amp;&amp; paymentList.size() &gt; 0</span></span><br><span class="line">                    TPaypalTrans orderPaymentTmp = tPaypalTrans;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="module-access"><span class="module"><span class="identifier">COMPLETED_STATUS</span>.</span></span>equals<span class="constructor">IgnoreCase(<span class="params">orderPaymentTmp</span>.<span class="params">getPaymentStatus</span>()</span>)) &#123;</span><br><span class="line">                        logger.info(<span class="string">"================ 支付表数据已经是complete了，不需要更新 ================"</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="comment">// 如果回传的状态不是complete则更新我们的支付数据</span></span><br><span class="line">                        <span class="comment">/**</span></span><br><span class="line"><span class="comment">                         * 更新支付状态</span></span><br><span class="line"><span class="comment">                         * 保存支付历史记录数据</span></span><br><span class="line"><span class="comment">                         */</span></span><br><span class="line">                        TPaypalTrans updateTPaypalTrans=<span class="keyword">new</span> <span class="constructor">TPaypalTrans()</span>;</span><br><span class="line">                        updateTPaypalTrans.set<span class="constructor">PaymentStatus(<span class="params">paymentStatus</span>)</span>;<span class="comment">//更新交易状态</span></span><br><span class="line">                        updateTPaypalTrans.set<span class="constructor">PaymentDate(<span class="params">paymentDate</span>)</span>;<span class="comment">//更新交易时间</span></span><br><span class="line">                        Condition updatePaypalCondition=<span class="keyword">new</span> <span class="constructor">Condition(TPaypalTrans.<span class="params">class</span>)</span>;</span><br><span class="line">                        updatePaypalCondition.create<span class="constructor">Criteria()</span>.<span class="keyword">and</span><span class="constructor">EqualTo(<span class="string">"txn_id"</span>,<span class="params">txnId</span>)</span>;</span><br><span class="line">                        <span class="built_in">int</span> n=tPaypalTransService.update(updateTPaypalTrans,updatePaypalCondition);</span><br><span class="line">                        <span class="keyword">if</span>(n&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                            logger.info(<span class="string">"更新paypal记录成功：[&#123;&#125;]"</span>,n);</span><br><span class="line">                        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                            logger.info(<span class="string">"更新paypal记录失败：[&#123;&#125;]"</span>,n);</span><br><span class="line">                            throw <span class="keyword">new</span> <span class="constructor">BizException(<span class="string">"更新paypal记录失败"</span>)</span>;</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span> (<span class="module-access"><span class="module"><span class="identifier">COMPLETED_STATUS</span>.</span></span>equals<span class="constructor">IgnoreCase(<span class="params">paymentStatus</span>)</span><span class="operator"> &amp;&amp; </span><span class="module-access"><span class="module"><span class="identifier">StringUtils</span>.</span></span>is<span class="constructor">NotEmpty(<span class="params">custom</span>)</span>) &#123;</span><br><span class="line">                            <span class="comment">//进行更新发货单的状态为支付成功</span></span><br><span class="line">                            TOutRepoOrder tOutRepoOrder=<span class="keyword">new</span> <span class="constructor">TOutRepoOrder()</span>;</span><br><span class="line">                            tOutRepoOrder.set<span class="constructor">TakeDeliveryId(<span class="params">custom</span>)</span>;</span><br><span class="line">                            tOutRepoOrder=tOutRepoOrderService.find<span class="constructor">OneForUpdate(<span class="params">tOutRepoOrder</span>)</span>;</span><br><span class="line">                            <span class="keyword">if</span>(<span class="number">3</span>==tOutRepoOrder.get<span class="constructor">FinanceStatus()</span>)&#123;</span><br><span class="line">                                <span class="comment">//已经更新为已支付无需再次更新下============================================</span></span><br><span class="line">                            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                                <span class="comment">//进行更新为已支付</span></span><br><span class="line">                                TOutRepoOrder updateTOutRepoOrder=<span class="keyword">new</span> <span class="constructor">TOutRepoOrder()</span>;</span><br><span class="line">                                updateTOutRepoOrder.set<span class="constructor">FinanceStatus(1)</span>;<span class="comment">// 财务状态0-未支付，1-已支付</span></span><br><span class="line">                                updateTOutRepoOrder.set<span class="constructor">Status(2)</span>;<span class="comment">//0 :待发送账单/1:待放货/2:待投入渠道/3:已投入渠道/4：已完成 / 5：已取消*/</span></span><br><span class="line">                                updateTOutRepoOrder.set<span class="constructor">LastUpdateDate((System.<span class="params">currentTimeMillis</span>()</span>/<span class="number">1000L</span>));</span><br><span class="line">                                updateTOutRepoOrder.set<span class="constructor">ConfirmPaymentDate((System.<span class="params">currentTimeMillis</span>()</span>/<span class="number">1000L</span>));<span class="comment">//确认支付时间</span></span><br><span class="line">                                Condition updateOutRepoCondition=<span class="keyword">new</span> <span class="constructor">Condition(TOutRepoOrder.<span class="params">class</span>)</span>;</span><br><span class="line">                                updateOutRepoCondition.create<span class="constructor">Criteria()</span>.<span class="keyword">and</span><span class="constructor">EqualTo(<span class="string">"takeDeliveryId"</span>,<span class="params">custom</span>)</span>;</span><br><span class="line">                                <span class="built_in">int</span> m=tOutRepoOrderService.update(updateTOutRepoOrder,updateOutRepoCondition);</span><br><span class="line">                                <span class="keyword">if</span>(m&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                                    logger.info(<span class="string">"更新发货单成功：[&#123;&#125;]"</span>,m);</span><br><span class="line">                                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                                    logger.info(<span class="string">"更新发货单失败：[&#123;&#125;]"</span>,m);</span><br><span class="line">                                    <span class="module-access"><span class="module"><span class="identifier">TransactionAspectSupport</span>.</span></span>current<span class="constructor">TransactionStatus()</span>.set<span class="constructor">RollbackOnly()</span>;</span><br><span class="line">                                    throw <span class="keyword">new</span> <span class="constructor">BizException(<span class="string">"更新发货单失败"</span>)</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">/**</span></span><br><span class="line"><span class="comment">                     * 保存支付信息   不存在记录</span></span><br><span class="line"><span class="comment">                     */</span></span><br><span class="line">                    <span class="keyword">if</span> (<span class="module-access"><span class="module"><span class="identifier">StringUtil</span>.</span></span>is<span class="constructor">NotEmpty(<span class="params">custom</span>)</span><span class="operator"> &amp;&amp; </span><span class="module-access"><span class="module"><span class="identifier">COMPLETED_STATUS</span>.</span></span>equals<span class="constructor">IgnoreCase(<span class="params">paymentStatus</span>)</span>) &#123; <span class="comment">//订单号为空则无法进行更新发货单状态</span></span><br><span class="line">                        <span class="comment">//进行判断如果paymentStatus为completed则进行更新</span></span><br><span class="line">                        TOutRepoOrder tOutRepoOrder=<span class="keyword">new</span> <span class="constructor">TOutRepoOrder()</span>;</span><br><span class="line">                        tOutRepoOrder.set<span class="constructor">TakeDeliveryId(<span class="params">custom</span>)</span>;</span><br><span class="line">                        tOutRepoOrder=tOutRepoOrderService.find<span class="constructor">OneForUpdate(<span class="params">tOutRepoOrder</span>)</span>;</span><br><span class="line">                        <span class="keyword">if</span>(tOutRepoOrder!=null)&#123;</span><br><span class="line">                            TOutRepoOrder updateTOutRepoOrder=<span class="keyword">new</span> <span class="constructor">TOutRepoOrder()</span>;</span><br><span class="line">                            updateTOutRepoOrder.set<span class="constructor">FinanceStatus(1)</span>;<span class="comment">////财务状态0-待确认账单，1-等待支付，2-已支付/3-无需支付</span></span><br><span class="line">                            updateTOutRepoOrder.set<span class="constructor">Status(2)</span>;<span class="comment">//0 :待发送账单/1:待放货/2:待投入渠道/3:已投入渠道/4：已完成 / 5：已取消*/</span></span><br><span class="line">                            updateTOutRepoOrder.set<span class="constructor">LastUpdateDate((System.<span class="params">currentTimeMillis</span>()</span>/<span class="number">1000L</span>));</span><br><span class="line">                            updateTOutRepoOrder.set<span class="constructor">ConfirmPaymentDate((System.<span class="params">currentTimeMillis</span>()</span>/<span class="number">1000L</span>));<span class="comment">//确认支付时间</span></span><br><span class="line">                            Condition updateOutRepoCondition=<span class="keyword">new</span> <span class="constructor">Condition(TOutRepoOrder.<span class="params">class</span>)</span>;</span><br><span class="line">                            updateOutRepoCondition.create<span class="constructor">Criteria()</span>.<span class="keyword">and</span><span class="constructor">EqualTo(<span class="string">"takeDeliveryId"</span>,<span class="params">custom</span>)</span>;</span><br><span class="line">                            <span class="built_in">int</span> m=tOutRepoOrderService.update(updateTOutRepoOrder,updateOutRepoCondition);</span><br><span class="line">                            <span class="keyword">if</span>(m&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                                logger.info(<span class="string">"更新发货单成功：[&#123;&#125;]"</span>,m);</span><br><span class="line">                            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                                logger.info(<span class="string">"更新发货单失败：[&#123;&#125;]"</span>,m);</span><br><span class="line">                                <span class="module-access"><span class="module"><span class="identifier">TransactionAspectSupport</span>.</span></span>current<span class="constructor">TransactionStatus()</span>.set<span class="constructor">RollbackOnly()</span>;</span><br><span class="line">                                throw <span class="keyword">new</span> <span class="constructor">BizException(<span class="string">"更新发货单失败"</span>)</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                            <span class="comment">//通过custom商户订单号在发货单当中查找不到</span></span><br><span class="line">                            logger.info(<span class="string">"商户订单号custom在发货单中不存在"</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        logger.info(<span class="string">"***************** paypal回传的订单ID为空 **************"</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    logger.info(<span class="string">"新增paypalTrans"</span>);</span><br><span class="line">                    TPaypalTrans insertTPaypalTrans= get<span class="constructor">Value(<span class="params">params</span>)</span>;<span class="comment">//调用赋值</span></span><br><span class="line">                    <span class="built_in">int</span> n=tPaypalTransMapper.add(insertTPaypalTrans);</span><br><span class="line">                    <span class="keyword">if</span>(n&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                        logger.info(<span class="string">"新增paypal记录成功：[&#123;&#125;]"</span>,n);</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        logger.info(<span class="string">"新增paypal记录失败：[&#123;&#125;]"</span>,n);</span><br><span class="line">                        throw <span class="keyword">new</span> <span class="constructor">BizException(<span class="string">"新增paypal记录失败"</span>)</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    logger.info(<span class="string">"================= 支付信息保存成功，订单状态更新成待发货成功 ===================="</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">"INVALID"</span>.equals<span class="constructor">IgnoreCase(<span class="params">res</span>)</span>) &#123;</span><br><span class="line">            <span class="comment">//非法信息，可以将此记录到您的日志文件中以备调查</span></span><br><span class="line">            logger.error(<span class="string">"paypal完成支付发送IPN通知返回状态非法，请联系管理员，请求参数："</span> + str);</span><br><span class="line">            logger.error(<span class="string">"Class: "</span>+this.get<span class="constructor">Class()</span>.get<span class="constructor">Name()</span>+<span class="string">" method: "</span>+</span><br><span class="line">                    <span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>current<span class="constructor">Thread()</span>.get<span class="constructor">StackTrace()</span><span class="literal">[<span class="number">1</span>]</span>.get<span class="constructor">MethodName()</span>);</span><br><span class="line">            out.println(<span class="string">"confirmError"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//处理其他错误</span></span><br><span class="line">            logger.error(<span class="string">"paypal完成支付发送IPN通知发生其他异常，请联系管理员，请求参数："</span> + str);</span><br><span class="line">            logger.error(<span class="string">"Class: "</span>+this.get<span class="constructor">Class()</span>.get<span class="constructor">Name()</span>+<span class="string">" method: "</span>+</span><br><span class="line">                    <span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>current<span class="constructor">Thread()</span>.get<span class="constructor">StackTrace()</span><span class="literal">[<span class="number">1</span>]</span>.get<span class="constructor">MethodName()</span>);</span><br><span class="line">            out.println(<span class="string">"confirmError"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; catch (Exception e) &#123;</span><br><span class="line">        logger.error(<span class="string">"确认付款信息发生IO异常"</span> + e.get<span class="constructor">Message()</span>);</span><br><span class="line">        logger.error(<span class="string">"Class: "</span>+this.get<span class="constructor">Class()</span>.get<span class="constructor">Name()</span>+<span class="string">" method: "</span>+</span><br><span class="line">                <span class="module-access"><span class="module"><span class="identifier">Thread</span>.</span></span>current<span class="constructor">Thread()</span>.get<span class="constructor">StackTrace()</span><span class="literal">[<span class="number">1</span>]</span>.get<span class="constructor">MethodName()</span>);</span><br><span class="line">        out.println(<span class="string">"confirmError"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">        out.flush<span class="literal">()</span>;</span><br><span class="line">        out.close<span class="literal">()</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><blockquote><p>反射</p></blockquote><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过参数获取paypaltrans</span></span><br><span class="line"><span class="comment">     * @param params</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    public TPaypalTrans get<span class="constructor">Value(Map <span class="params">params</span>)</span> throws ClassNotFoundException, NoSuchFieldException, IllegalAccessException, InstantiationException &#123;</span><br><span class="line">        Class&lt;?&gt; c =<span class="module-access"><span class="module"><span class="identifier">TPaypalTrans</span>.</span></span><span class="keyword">class</span>;</span><br><span class="line">        Object obj = c.<span class="keyword">new</span><span class="constructor">Instance()</span>; <span class="comment">//使用字段（使用之前我们需要一个该类对象）</span></span><br><span class="line">        logger.info(<span class="string">"getValue - 获取实例"</span>);</span><br><span class="line">        Set&lt;Map.Entry&gt; set=params.entry<span class="constructor">Set()</span>;</span><br><span class="line">        for (Map.Entry entry:set)&#123;</span><br><span class="line">            String keyName=entry.get<span class="constructor">Key()</span>.<span class="keyword">to</span><span class="constructor">String()</span>;</span><br><span class="line"></span><br><span class="line">            StringBuffer stringBuffer=<span class="keyword">new</span> <span class="constructor">StringBuffer(<span class="string">""</span>)</span>;</span><br><span class="line">            String<span class="literal">[]</span> strings=keyName.split(<span class="string">"_"</span>);</span><br><span class="line">            for (<span class="built_in">int</span> i=<span class="number">0</span>;i&lt;strings.length;i++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(i==<span class="number">0</span>)&#123;</span><br><span class="line">                    stringBuffer.append(strings<span class="literal">[<span class="identifier">i</span>]</span>);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    String start=strings<span class="literal">[<span class="identifier">i</span>]</span>.substring(<span class="number">0</span>,<span class="number">1</span>).<span class="keyword">to</span><span class="constructor">UpperCase()</span>;<span class="comment">//大写首位</span></span><br><span class="line">                    String <span class="keyword">end</span>=strings<span class="literal">[<span class="identifier">i</span>]</span>.substring(<span class="number">1</span>);<span class="comment">//截取后面的字符串</span></span><br><span class="line">                    stringBuffer.append(start).append(<span class="keyword">end</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            logger.info(<span class="string">"keyName: "</span>+keyName+<span class="string">"     property: "</span>+stringBuffer.<span class="keyword">to</span><span class="constructor">String()</span>);</span><br><span class="line">            String valueStr=((String<span class="literal">[]</span>)entry.get<span class="constructor">Value()</span>)<span class="literal">[<span class="number">0</span>]</span>;</span><br><span class="line">            logger.info(<span class="string">"valueStr: "</span>+valueStr);</span><br><span class="line"></span><br><span class="line">            Field field = c.get<span class="constructor">DeclaredField(<span class="params">stringBuffer</span>.<span class="params">toString</span>()</span>);<span class="comment">//获取私有字段</span></span><br><span class="line"></span><br><span class="line">            field.set<span class="constructor">Accessible(<span class="params">true</span>)</span>;<span class="comment">//暴力访问  //使用set()方法设置字段值</span></span><br><span class="line">            field.set(obj, valueStr);</span><br><span class="line">        &#125;</span><br><span class="line">        TPaypalTrans tPaypalTrans =(TPaypalTrans)obj;</span><br><span class="line">        logger.info(<span class="string">"getValue - tPaypalTrans: "</span>+<span class="module-access"><span class="module"><span class="identifier">JSONObject</span>.</span></span><span class="keyword">to</span><span class="constructor">JSONString(<span class="params">tPaypalTrans</span>)</span>);</span><br><span class="line">        return tPaypalTrans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>paypal的Ipn回调的响应内容</p></blockquote><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">       /*</span><br><span class="line">       Paypal回调的响应内容：</span><br><span class="line">20200221 11:23:19.734 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[mc_gross]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[500.00]</span></span><br><span class="line">20200221 11:23:19.734 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[protection_eligibility]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[Ineligible]</span></span><br><span class="line">20200221 11:23:19.734 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[address_status]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[confirmed]</span></span><br><span class="line">20200221 11:23:19.734 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[payer_id]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[ZEA54X9BSHDWQ]</span></span><br><span class="line">20200221 11:23:19.735 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[address_street]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[NO 1 Nan Jin Road]</span></span><br><span class="line">20200221 11:23:19.735 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[payment_date]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[19:23:08 Feb 20, 2020 PST]</span></span><br><span class="line">20200221 11:23:19.735 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[payment_status]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[Pending]</span></span><br><span class="line">20200221 11:23:19.735 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[charset]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[gb2312]</span></span><br><span class="line">20200221 11:23:19.735 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[address_zip]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[200000]</span></span><br><span class="line">20200221 11:23:19.735 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[first_name]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[sn]</span></span><br><span class="line">20200221 11:23:19.735 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[mc_fee]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[17.30]</span></span><br><span class="line">20200221 11:23:19.736 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[address_country_code]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[CN]</span></span><br><span class="line">20200221 11:23:19.736 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[address_name]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[F sn]</span></span><br><span class="line">20200221 11:23:19.736 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[notify_version]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[3.9]</span></span><br><span class="line">20200221 11:23:19.736 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[custom]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[OUB20200221112152]</span></span><br><span class="line">20200221 11:23:19.736 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[payer_status]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[verified]</span></span><br><span class="line">20200221 11:23:19.736 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[business]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[sb2@business.example.com]</span></span><br><span class="line">20200221 11:23:19.737 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[address_country]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[China]</span></span><br><span class="line">20200221 11:23:19.737 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[address_city]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[Shanghai]</span></span><br><span class="line">20200221 11:23:19.737 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[quantity]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[1]</span></span><br><span class="line">20200221 11:23:19.737 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[verify_sign]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[A739FTSMk8kYJ.miuYv3SfmM-AuZAiAh8kw3F81AGspKHFru4lpfnZ02]</span></span><br><span class="line">20200221 11:23:19.737 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[payer_email]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[sb1@personal.example.com]</span></span><br><span class="line">20200221 11:23:19.737 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[txn_id]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[67Y54097JV355643W]</span></span><br><span class="line">20200221 11:23:19.737 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[payment_type]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[instant]</span></span><br><span class="line">20200221 11:23:19.737 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[last_name]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[F]</span></span><br><span class="line">20200221 11:23:19.738 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[address_state]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[Shanghai]</span></span><br><span class="line">20200221 11:23:19.738 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[receiver_email]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[sb2@business.example.com]</span></span><br><span class="line">20200221 11:23:19.738 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[payment_fee]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[17.30]</span></span><br><span class="line">20200221 11:23:19.738 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[shipping_discount]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[0.00]</span></span><br><span class="line">20200221 11:23:19.738 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[insurance_amount]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[0.00]</span></span><br><span class="line">20200221 11:23:19.738 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[receiver_id]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[3L9GARBGYFZVS]</span></span><br><span class="line">20200221 11:23:19.738 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[pending_reason]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[paymentreview]</span></span><br><span class="line">20200221 11:23:19.738 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[txn_type]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[express_checkout]</span></span><br><span class="line">20200221 11:23:19.738 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[item_name]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[payment description]</span></span><br><span class="line">20200221 11:23:19.739 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[discount]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[0.00]</span></span><br><span class="line">20200221 11:23:19.739 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[mc_currency]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[USD]</span></span><br><span class="line">20200221 11:23:19.739 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[item_number]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[]</span></span><br><span class="line">20200221 11:23:19.739 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[residence_country]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[CN]</span></span><br><span class="line">20200221 11:23:19.739 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[test_ipn]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[1]</span></span><br><span class="line">20200221 11:23:19.739 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[shipping_method]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[Default]</span></span><br><span class="line">20200221 11:23:19.739 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[transaction_subject]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[payment description]</span></span><br><span class="line">20200221 11:23:19.739 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[payment_gross]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[500.00]</span></span><br><span class="line">20200221 11:23:19.739 PayControl.java:84 INFO  - <span class="comment">[KEY]</span> :<span class="comment">[ipn_track_id]</span>  -  <span class="comment">[VALUE]</span> :<span class="comment">[95332aa3b4c2f]</span></span><br><span class="line">        */</span><br></pre></td></tr></table></figure><h2 id="与Paypal小哥的聊天记录"><a href="#与Paypal小哥的聊天记录" class="headerlink" title="与Paypal小哥的聊天记录"></a>与Paypal小哥的聊天记录</h2><p>为了对接这个paypal支付也是花了不少时间搞。<br>也不是说难点多，就是API文档是英文，所以我又不像david对着英文就可以搞，我还借助了谷歌的翻译，左看看右看看。<br>好了话不多说，看下我跟paypal小哥聊了些啥。<br>其实我怀疑这个Castle小哥是被我搞烦了。  </p><p>Castle：老是问老是问，不知道看API文档？官方文档干什么吃的，你老是问我，让官方文档一点尊严都没有。<br>我：o(╥﹏╥)o，对不起API文档。  </p><p>最终的一个paypal的一个token老是失效问题，Castle小哥让我换给jar包：<br>之前的jar包当中token没有自动更新需要自己去手动更新，然而我之前的想法就是还想着自己去更新下，我真是个傻逼。<br>从此Castle用血的教训告诉我要看官方文档。害，是我不争气，对不住了老哥。  </p><ol><li>这个是处理ipn回调的聊天，主要是ipn回调没调过来。</li></ol><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">尊敬的商户</span> <span class="string">您好，</span></span><br><span class="line"></span><br><span class="line"><span class="attr">感谢您联系PayPal商家技术支持，我是技术工程师Castle，很高兴能有机会帮助您。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">我这边查看了一下您的sandbox账号fsn2915324940@163.com，发现IPN发送记录是正常的且发送地址为：http</span>:<span class="string">//y22711s118.iask.in/api/v1/pay/paypalCallBack</span></span><br><span class="line"></span><br><span class="line"><span class="meta">并且收到了来自您系统返回的200</span> <span class="string">response，以下是一条发送成功的IPN记录范例：</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Message</span> <span class="string">ID</span></span><br><span class="line"><span class="attr">30P16273JX693701F</span></span><br><span class="line"><span class="attr">Unencrypted</span> <span class="string">Message ID</span></span><br><span class="line"><span class="attr">249249217</span></span><br><span class="line"><span class="attr">Time</span> <span class="string">Created</span></span><br><span class="line"><span class="attr">Feb</span> <span class="string">5, 2020 06:25:36 PST</span></span><br><span class="line"><span class="attr">PayPal</span> <span class="string">Account</span></span><br><span class="line"><span class="attr">John</span> <span class="string">Doe's Test Store</span></span><br><span class="line"><span class="attr">Transaction</span> <span class="string">ID</span></span><br><span class="line"><span class="attr">6YS701801F562190A</span></span><br><span class="line"><span class="attr">Delivery</span> <span class="string">Status</span></span><br><span class="line"><span class="attr">Sent</span></span><br><span class="line"><span class="attr">HTTP</span> <span class="string">Response</span></span><br><span class="line"><span class="attr">200</span></span><br><span class="line"><span class="attr">Last</span> <span class="string">IPN send Attempt</span></span><br><span class="line"><span class="attr">Feb</span> <span class="string">5, 2020 06:43:16 PST</span></span><br><span class="line"><span class="attr">Destination</span> <span class="string">URL</span></span><br><span class="line"><span class="attr">http</span>:<span class="string">//y22711s118.iask.in/api/v1/pay/paypalCallBack</span></span><br><span class="line"><span class="attr">Number</span> <span class="string">of Retries</span></span><br><span class="line"><span class="attr">0</span></span><br><span class="line"><span class="attr">Type</span></span><br><span class="line"><span class="attr">Transaction</span> <span class="string">made</span></span><br><span class="line"></span><br><span class="line"><span class="attr">IPN</span> <span class="string">Text</span></span><br><span class="line"><span class="attr">mc_gross</span>=<span class="string">500.00&amp;protection_eligibility=Eligible&amp;address_status=confirmed&amp;</span></span><br><span class="line"><span class="attr">payer_id</span>=<span class="string">A2YKGTAGML7V4&amp;address_street=NO 1 Nan Jin Road&amp;</span></span><br><span class="line"><span class="attr">payment_date</span>=<span class="string">19:46:23 Feb 03, 2020 PST&amp;payment_status=Refunded&amp;charset=gb2312&amp;</span></span><br><span class="line"><span class="attr">address_zip</span>=<span class="string">200000&amp;first_name=莎娜&amp;mc_fee=17.30&amp;address_country_code=CN&amp;</span></span><br><span class="line"><span class="attr">address_name</span>=<span class="string">冯 莎娜&amp;notify_version=3.9&amp;custom=&amp;payer_status=verified&amp;</span></span><br><span class="line"><span class="attr">business</span>=<span class="string">fsn2915324940@163.com&amp;address_country=China&amp;address_city=Shanghai&amp;quantity=1&amp;</span></span><br><span class="line"><span class="attr">verify_sign</span>=<span class="string">AveljTgX9XcE.t0NAN3EYVNEITeVADrLxwEBMAJMMvQqLXMKbbzDQEck&amp;</span></span><br><span class="line"><span class="attr">payer_email</span>=<span class="string">198866436@qq.com&amp;txn_id=6YS701801F562190A&amp;payment_type=instant&amp;last_name=冯&amp;</span></span><br><span class="line"><span class="attr">address_state</span>=<span class="string">Shanghai&amp;receiver_email=fsn2915324940@163.com&amp;payment_fee=17.30&amp;</span></span><br><span class="line"><span class="attr">shipping_discount</span>=<span class="string">0.00&amp;insurance_amount=0.00&amp;receiver_id=DH7T6UAAXRMHQ&amp;</span></span><br><span class="line"><span class="attr">txn_type</span>=<span class="string">express_checkout&amp;item_name=payment description&amp;discount=0.00&amp;mc_currency=USD&amp;</span></span><br><span class="line"><span class="attr">item_number</span>=<span class="string">&amp;residence_country=CN&amp;test_ipn=1&amp;shipping_method=Default&amp;</span></span><br><span class="line"><span class="attr">transaction_subject</span>=<span class="string">payment description&amp;payment_gross=500.00&amp;ipn_track_id=ad78e05c1c28d</span></span><br><span class="line"></span><br><span class="line"><span class="attr">但由于前几天我们在sandbox环境有出现过IPN发送异常的系统错误，您遇到的问题可能与那个有关。那个问题目前已经修复了，请您再尝试一下，看现在能不能顺利收到IPN通知？</span></span><br><span class="line"></span><br><span class="line"><span class="attr">期待您的回复，如果您还有其他产品集成或者交易方面的问题，欢迎随时来信与我们联系。</span></span><br><span class="line"></span><br><span class="line"><span class="attr">友情提醒，请注意如果您没有在该事件发起后的7天之内回复我们，那么该事件将会被自动关闭。届时如果您还有其他问题也可以重新提交一个Case。</span></span><br><span class="line"></span><br><span class="line"><span class="attr">感谢您的耐心和理解，祝您工作顺利生活愉快。</span></span><br><span class="line"><span class="attr">谢谢</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Castle</span></span><br><span class="line"><span class="attr">PayPal</span> <span class="string">商家技术支持部</span></span><br><span class="line"></span><br><span class="line"><span class="attr">ref</span>:<span class="string">_00D30LaY._5002E1WyRdd:ref</span></span><br></pre></td></tr></table></figure><ol start="2"><li>还是ipn回调问题</li></ol><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">尊敬的商户 您好，</span><br><span class="line"></span><br><span class="line">感谢您联系PayPal商家技术支持，我是技术工程师Castle，很高兴能有机会帮助您。</span><br><span class="line"></span><br><span class="line">我查看了一下您的这个sandbox账号，确实目前最新的IPN消息也显示queue状态。这个可能是由于sandbox环境的一些内部错误所导致的。</span><br><span class="line">正常情况下IPN通知应该会在交易状态发生改变（如支付成功，或者退款成功等）时立即发出，有时由于网络原因或服务器负荷等因素，可能会有几秒钟到几分钟的延迟，但超过一小时的话一般都是有一些系统错误导致的。</span><br><span class="line"></span><br><span class="line">目前该问题已经上报给相关的产品研发部门，并且正在紧急修复中了。</span><br><span class="line">给您造成的不便我们非常抱歉，如果有任何进展我们会第一时间通知您，感谢您的耐心和理解。</span><br><span class="line"></span><br><span class="line">期待您的回复，如果您还有其他产品集成或者交易方面的问题，欢迎随时来信与我们联系。</span><br><span class="line"></span><br><span class="line">友情提醒，请注意如果您没有在该事件发起后的<span class="number">7</span>天之内回复我们，那么该事件将会被自动关闭。届时如果您还有其他问题也可以重新提交一个Case。</span><br><span class="line"></span><br><span class="line">感谢您的耐心和理解，祝您工作顺利生活愉快。</span><br><span class="line">谢谢</span><br><span class="line"></span><br><span class="line">Castle</span><br><span class="line">PayPal 商家技术支持部</span><br><span class="line"></span><br><span class="line"><span class="built_in">ref</span>:<span class="module-access"><span class="module"><span class="identifier">_00D30LaY</span>.</span><span class="module"><span class="identifier">_5002E1XCagT</span>:</span></span><span class="built_in">ref</span></span><br></pre></td></tr></table></figure><ol start="3"><li>关于订单查询</li></ol><figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">您好， </span><br><span class="line">感谢您联系<span class="string">PayPal商</span>家技术支持中心，我是技术工程师<span class="string">Kevin，</span>很高兴能为您提供技术服务。</span><br><span class="line"></span><br><span class="line">关于查询订单以及订单详情的<span class="string">API，</span> 请参照以下<span class="string">URL。</span></span><br><span class="line"></span><br><span class="line">交易订单查询：</span><br><span class="line"><span class="string">https:</span>//<span class="string">developer.</span><span class="string">paypal.</span><span class="string">com/</span><span class="string">docs/</span><span class="string">archive/</span><span class="string">nvp-soap-</span><span class="string">api/</span><span class="string">merchant/</span><span class="string">transaction-search-</span><span class="string">nvp/</span></span><br><span class="line"></span><br><span class="line">交易订单详细：</span><br><span class="line"><span class="string">https:</span>//<span class="string">developer.</span><span class="string">paypal.</span><span class="string">com/</span><span class="string">docs/</span><span class="string">archive/</span><span class="string">nvp-soap-</span><span class="string">api/</span><span class="string">merchant/</span><span class="built_in">get-transaction-details-nvp/</span></span><br><span class="line"><span class="built_in"></span></span><br><span class="line"><span class="built_in">以上，谢谢。</span></span><br><span class="line"><span class="built_in">祝您生活愉快。</span></span><br><span class="line"><span class="built_in"></span></span><br><span class="line"><span class="built_in"></span></span><br><span class="line"><span class="built_in">Kevin</span></span><br><span class="line"><span class="built_in">PayPal商家技术支持</span></span><br><span class="line"><span class="built_in"></span></span><br><span class="line"><span class="built_in">ref:_00D30LaY._5002E1XDl2l:ref</span></span><br></pre></td></tr></table></figure><ol start="4"><li>paypal支付链接是否能够失效</li></ol><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">您好， </span><br><span class="line">感谢您联系PayPal商家技术支持中心。</span><br><span class="line"></span><br><span class="line">&gt;&gt;有能够是paypal支付链接失效的api文档吗，能发下吗 就是通过该paypal支付链接使客户端用户无法付款</span><br><span class="line">很抱歉，PayPal并没有相关的API让支付链接失效。</span><br><span class="line"></span><br><span class="line">感谢您的理解与支持。</span><br><span class="line"></span><br><span class="line">以上， 谢谢。</span><br><span class="line">祝您生活愉快！</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PayPal商家技术支持</span><br><span class="line"></span><br><span class="line"><span class="built_in">ref</span>:<span class="module-access"><span class="module"><span class="identifier">_00D30LaY</span>.</span><span class="module"><span class="identifier">_5002E1XRqWK</span>:</span></span><span class="built_in">ref</span></span><br></pre></td></tr></table></figure><ol start="5"><li>ipn回调</li></ol><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">尊敬的商户 您好，</span><br><span class="line"></span><br><span class="line">感谢您联系PayPal商家技术支持，我是技术工程师Castle，很高兴能有机会帮助您。</span><br><span class="line"></span><br><span class="line">根据您的描述，如果输入英文信息都能验证成功，但有中文信息就失败的话，应该是由于<span class="keyword">encoding</span>设置的原因导致验证无法成功。并且由于我们的商户设置页面更新的缘故，原来的入口发生了变化，所以找不到。</span><br><span class="line">请尝试通过以下步骤在您测试的商户账号中将<span class="keyword">encoding</span>设置改为UTF<span class="number">-8</span>应该就能解决：</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>）登录您的PayPal账号后打开这个链接进入设置页面：https://www.paypal.com/cgi-bin/customerprofileweb?cmd=_profile-<span class="keyword">language</span>-<span class="keyword">encoding</span>，如果是sandbox账号的话请打开这个链接：https://www.sandbox.paypal.com/cgi-bin/customerprofileweb?cmd=_profile-<span class="keyword">language</span>-<span class="keyword">encoding</span></span><br><span class="line"><span class="number">2</span>）然后选择More <span class="keyword">Options</span>进入<span class="keyword">encoding</span>选择页面，一般选择UTF8</span><br><span class="line"><span class="number">3</span>）确保您的网站页面也是采用相同的字符编码（UTF8）就不会出错了。</span><br><span class="line"></span><br><span class="line">期待您的回复，如果您还有其他产品集成或者交易方面的问题，欢迎随时来信与我们联系。</span><br><span class="line"></span><br><span class="line">友情提醒，请注意如果您没有在该事件发起后的<span class="number">7</span>天之内回复我们，那么该事件将会被自动关闭。届时如果您还有其他问题也可以重新提交一个<span class="keyword">Case</span>。</span><br><span class="line"></span><br><span class="line">感谢您的耐心和理解，祝您工作顺利生活愉快。</span><br><span class="line">谢谢</span><br><span class="line"></span><br><span class="line">Castle</span><br><span class="line">PayPal 商家技术支持部</span><br><span class="line"></span><br><span class="line"><span class="keyword">ref</span>:_00D30LaY._5002E1XRp4f:<span class="keyword">ref</span></span><br></pre></td></tr></table></figure><ol start="6"><li>paypal token方面的执着</li></ol><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">尊敬的商户 您好，</span><br><span class="line"></span><br><span class="line">感谢您联系PayPal商家技术支持，我是技术工程师Castle，很高兴能有机会帮助您。</span><br><span class="line"></span><br><span class="line">请问您是在调用REST API时遇到了<span class="keyword">access</span>-token过期的错误是么？</span><br><span class="line"></span><br><span class="line">需要注意的是，<span class="keyword">access</span>-token本身是有有效期的，大概是<span class="number">10</span>个小时左右，过期之后请重新使用client ID 和 Secret调用同样的方法再获取一下就可以了。具体方案可以参考文档：https://developer.paypal.com/docs/api/overview/#<span class="keyword">get</span>-an-<span class="keyword">access</span>-token</span><br><span class="line"></span><br><span class="line">期待您的回复，如果您还有其他产品集成或者交易方面的问题，欢迎随时来信与我们联系。</span><br><span class="line"></span><br><span class="line">友情提醒，请注意如果您没有在该事件发起后的<span class="number">7</span>天之内回复我们，那么该事件将会被自动关闭。届时如果您还有其他问题也可以重新提交一个<span class="keyword">Case</span>。</span><br><span class="line"></span><br><span class="line">感谢您的耐心和理解，祝您工作顺利生活愉快。</span><br><span class="line">谢谢</span><br><span class="line"></span><br><span class="line">Castle</span><br><span class="line">PayPal 商家技术支持部</span><br><span class="line"></span><br><span class="line"><span class="keyword">ref</span>:_00D30LaY._5002E1Xq5G0:<span class="keyword">ref</span></span><br></pre></td></tr></table></figure><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">尊敬的商户 您好，</span><br><span class="line">感谢您的回复。</span><br><span class="line"></span><br><span class="line">是的，您只要是使用SDK集成并且按照示例的方法调用来创建支付，应该是不需要额外去处理token过期这个情况的，SDK内部封装的方法会自动判断，如果过期的话重新获取，所以请不用担心。</span><br><span class="line"></span><br><span class="line">期待您的回复，如果您还有其他产品集成或者交易方面的问题，欢迎随时来信与我们联系。</span><br><span class="line">祝您周末愉快~</span><br><span class="line">谢谢</span><br><span class="line"></span><br><span class="line">Castle</span><br><span class="line">PayPal 商家技术支持部</span><br><span class="line"></span><br><span class="line"><span class="built_in">ref</span>:<span class="module-access"><span class="module"><span class="identifier">_00D30LaY</span>.</span><span class="module"><span class="identifier">_5002E1Z2WX6</span>:</span></span><span class="built_in">ref</span></span><br></pre></td></tr></table></figure><figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">尊敬的商户 您好，</span><br><span class="line">感谢您的回复。</span><br><span class="line"></span><br><span class="line">不好意思前面有些事回复晚了，这个<span class="string">apiContext对</span>象确实只会<span class="string">new一</span>次，但内部封装了一套逻辑是会自动调用在<span class="string">token过</span>期的时候调用<span class="string">API来</span>获取新的<span class="string">token的</span>，应该不需要您这边额外进行处理。</span><br><span class="line"></span><br><span class="line">如果您想要手动获取<span class="string">access-token的</span>话，可以直接按照这个乏力，直接调用<span class="string">v1/</span><span class="string">oauth2/</span><span class="string">token接</span>口：<span class="string">https:</span>//<span class="string">developer.</span><span class="string">paypal.</span><span class="string">com/</span><span class="string">docs/</span><span class="string">api/</span><span class="built_in">get-an-access-token-curl/</span></span><br><span class="line"><span class="built_in"></span></span><br><span class="line"><span class="built_in">请问您现在遇到关于token的具体问题是什么呢？</span></span><br><span class="line"><span class="built_in"></span></span><br><span class="line"><span class="built_in">期待您的回复，如果您还有其他产品集成或者交易方面的问题，欢迎随时来信与我们联系。</span></span><br><span class="line"><span class="built_in">谢谢</span></span><br><span class="line"><span class="built_in"></span></span><br><span class="line"><span class="built_in">Castle</span></span><br><span class="line"><span class="built_in">PayPal</span> 商家技术支持部</span><br><span class="line"></span><br><span class="line"><span class="string">ref:_00D30LaY.</span><span class="string">_5002E1Z2WX6:ref</span></span><br></pre></td></tr></table></figure><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">尊敬的商户 您好，</span><br><span class="line">感谢您的回复。</span><br><span class="line"></span><br><span class="line">由于相关的SDK各个版本比较多，麻烦请确认一下您使用的是这个SDK：https://github.com/paypal/PayPal-Java-SDK 么？</span><br><span class="line"></span><br><span class="line">如果是的话，您可以参考这里：https://github.com/paypal/PayPal-Java-SDK/wiki/Making-First-<span class="keyword">Call</span>#instructions，第三步：</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span><span class="keyword">Create</span> an APIContext <span class="keyword">object</span> <span class="keyword">with</span> proper configurations. Make sure <span class="keyword">to</span> <span class="keyword">create</span> one <span class="keyword">for</span> <span class="keyword">each</span> request. Make a <span class="keyword">create</span> <span class="keyword">call</span> <span class="keyword">and</span> use the createdPayment <span class="keyword">object</span> <span class="keyword">to</span> <span class="keyword">get</span> the approval URL.</span><br><span class="line">try &#123;</span><br><span class="line">    APIContext apiContext = <span class="built_in">new</span> APIContext(clientId, clientSecret, "sandbox");</span><br><span class="line">    Payment createdPayment = payment.<span class="keyword">create</span>(apiContext);</span><br><span class="line">    // <span class="keyword">For</span> <span class="keyword">debug</span> purposes <span class="keyword">only</span>: <span class="keyword">System</span>.<span class="keyword">out</span>.println(createdPayment.toString());</span><br><span class="line">&#125; catch (PayPalRESTException e) &#123;</span><br><span class="line">    // Handle errors</span><br><span class="line">&#125; catch (<span class="keyword">Exception</span> ex) &#123;</span><br><span class="line">    // Handle errors</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">这里获取的apiContext 对象应该就是包含<span class="keyword">access</span>-token的，您可以试一下。</span><br><span class="line"></span><br><span class="line">期待您的回复，如果您还有其他产品集成或者交易方面的问题，欢迎随时来信与我们联系。</span><br><span class="line">谢谢</span><br><span class="line"></span><br><span class="line">Castle</span><br><span class="line">PayPal 商家技术支持部</span><br><span class="line"></span><br><span class="line"><span class="keyword">ref</span>:_00D30LaY._5002E1Z2WX6:<span class="keyword">ref</span></span><br></pre></td></tr></table></figure><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">尊敬的商户 您好，</span><br><span class="line"></span><br><span class="line">感谢您联系PayPal商家技术支持，我是技术工程师Castle，很高兴能有机会帮助您。</span><br><span class="line"></span><br><span class="line">一般PayPal这边的REST API SDK都是有封装了获取token的方法的，但仅凭您提供的这个信息：</span><br><span class="line"></span><br><span class="line"><span class="params">&lt;dependency&gt;</span> <span class="params">&lt;groupId&gt;</span>com.paypal.sdk<span class="params">&lt;/groupId&gt;</span> <span class="params">&lt;artifactId&gt;</span>rest-api-sdk<span class="params">&lt;/artifactId&gt;</span> <span class="params">&lt;version&gt;</span><span class="number">1.4</span><span class="number">.2</span><span class="params">&lt;/version&gt;</span> <span class="params">&lt;/dependency&gt;</span></span><br><span class="line"></span><br><span class="line">我这边无法确定具体是哪个SDK，能否请您提供一下您使用的这个SDK的github地址，以便我确认一下源码？</span><br><span class="line"></span><br><span class="line">另外请求token的接口建议不要调用太过频繁，因为一个token的有效期至少有几个小时，在过期之前即使重复调用该接口获取到的也是同一个token，并且过于频繁的调用（比如一分钟内调用十几次）可能会导致PayPal的系统暂时block您的IP地址，所以建议等到一个token过期之后再调用接口获取新的，一般几个小时调用一次是没什么问题的。</span><br><span class="line"></span><br><span class="line">期待您的回复，如果您还有其他产品集成或者交易方面的问题，欢迎随时来信与我们联系。</span><br><span class="line"></span><br><span class="line">友情提醒，请注意如果您没有在该事件发起后的<span class="number">7</span>天之内回复我们，那么该事件将会被自动关闭。届时如果您还有其他问题也可以重新提交一个Case。</span><br><span class="line"></span><br><span class="line">感谢您的耐心和理解，祝您工作顺利生活愉快。</span><br><span class="line">谢谢</span><br><span class="line"></span><br><span class="line">Castle</span><br><span class="line">PayPal 商家技术支持部</span><br><span class="line"></span><br><span class="line"><span class="symbol">ref:</span>_00D30LaY._5002E1Z2WX6:ref</span><br></pre></td></tr></table></figure><h2 id="记录步骤"><a href="#记录步骤" class="headerlink" title="记录步骤"></a>记录步骤</h2><ul><li>浏览器【回车】：<a href="https://www.paypal.com/；就到了：https://www.paypal.com/c2/home界面" target="_blank" rel="noopener">https://www.paypal.com/；就到了：https://www.paypal.com/c2/home界面</a></li><li>点击右上方的【注册】按钮，就到了此界面：<a href="https://www.paypal.com/c2/webapps/mpp/account-selection" target="_blank" rel="noopener">https://www.paypal.com/c2/webapps/mpp/account-selection</a></li><li>选择【个人账户】，然后点击【下一步】</li><li>然后呢就还是该界面浏览器地址不变，标题栏（PayPal–安全快捷的收付款工具）个人账户，他要你选择一个类似身份选择的一个下拉框【选项有：1、线上购物者 2、个体卖家/自由职业者 3、以上都是 4、我不确定】，好我此处选择的是3以上都是，因为我只是想测试下而已。好此处选择好了点击【下一步】</li><li>然后跳到了这个界面：<a href="https://www.paypal.com/welcome/signup/#/name_address" target="_blank" rel="noopener">https://www.paypal.com/welcome/signup/#/name_address</a> 额就是让你填写下你的基本的个人信息，比如说身份证号码啊，姓甚名谁啊，联系方式啊，家住何方啊，年龄几何啊…. 然后呢把那个[激活One Touch]以及那个[我已阅读并同意PayPal的《用户协议》、《隐私政策》和《合理使用规则》。我有权添加以上输入的联系信息并了解PayPal可以通过电子邮件或邮寄信件与我联系]这两个单选框勾选上，最后点击按钮【同意并创建账户】，OK</li><li>然后我们就来到了此界面：<a href="https://www.paypal.com/welcome/signup/#/intent_selection" target="_blank" rel="noopener">https://www.paypal.com/welcome/signup/#/intent_selection</a> 他提示我们的账户已经创建了。他要我们添加信用卡，可惜啊可惜我没有信用卡，当然啦我是个小测试员也用不着用信用卡的地步啦，所以【开始购物】和【付款】我就都不选择啦，拉到底部，选择【不确定？添加卡以便日后使用】即可啦。点击它即可。</li><li>然后我们就来到了该界面：<a href="https://www.paypal.com/welcome/signup/#/add_card" target="_blank" rel="noopener">https://www.paypal.com/welcome/signup/#/add_card</a> 他还是十分强烈的希望我添加一下信用卡，可是我真的没有信用卡呗。我要是有我肯定为你服务几块钱，我数学不太好啊。当然啦，信用卡你不知道你可以【编辑】下账单地址也是OK的。好啦我们就不去关联这个信用卡啦，点击【我以后再执行此操作】即可。</li><li>我们就来到了已激活界面：<a href="https://www.paypal.com/welcome/signup/#/activation" target="_blank" rel="noopener">https://www.paypal.com/welcome/signup/#/activation</a>  activation这个不就是激活的意思吗？不过已经激活不是用那个actived?<br>activated 这个单词。标题【开始使用PayPal购物。】好啦，我们就不去购物啦，直奔主题而去，点击【前往您的账户】</li><li>到达账户界面：<a href="https://www.paypal.com/myaccount" target="_blank" rel="noopener">https://www.paypal.com/myaccount</a></li><li>此处建议，有钱的没钱的把蓝灯开一下：<a href="https://github.com/getlantern/lantern，因为paypal是国外的网站跨境，额反正就是需要翻墙，不要问再问就是不知道。你可以去站长之家看下这个paypal服务器分布在哪里，反正就是网速特慢，尤其是像我这种住乡下的人。" target="_blank" rel="noopener">https://github.com/getlantern/lantern，因为paypal是国外的网站跨境，额反正就是需要翻墙，不要问再问就是不知道。你可以去站长之家看下这个paypal服务器分布在哪里，反正就是网速特慢，尤其是像我这种住乡下的人。</a></li><li>打开子页面：<a href="https://developer.paypal.com/" target="_blank" rel="noopener">https://developer.paypal.com/</a> 开发者，点击右上角的【Log into Dashboard】登录进入控制台</li><li>登录好了的话，就会进入到 <a href="https://developer.paypal.com/developer/applications" target="_blank" rel="noopener">https://developer.paypal.com/developer/applications</a> 该页面，我已经受不了这垃圾网了。</li><li>每当网好了，我就宛如鸡犬升天了。</li><li>好，到了登录界面：<a href="https://www.paypal.com/signin?returnUri=https%3A%2F%2Fdeveloper.paypal.com%2Fdeveloper%2Fapplications" target="_blank" rel="noopener">https://www.paypal.com/signin?returnUri=https%3A%2F%2Fdeveloper.paypal.com%2Fdeveloper%2Fapplications</a></li><li>输入你的账号密码进行登录：<a href="mailto:198866436@qq.com">198866436@qq.com</a>/xxxxxxxxx</li><li>好啦登录成功之后，就又会跳转到：<a href="https://developer.paypal.com/developer/applications" target="_blank" rel="noopener">https://developer.paypal.com/developer/applications</a> 该界面来啦！</li><li>【My Apps &amp; Credentials】这个是标题，就跟支付宝一样，需要建一个属于自己的application</li><li>骚等，莫急慢慢来。sandbox即沙箱环境，live即生产环境，默认为sandbox环境，你要切换也可以的。我选择的是【sandbox】沙箱环境然后点击【Create App】,也就是创建一个application。他有一个默认的default app，我是用自己创建的。然后呢输入您的APP Name以及沙箱的卖家账号输入进去。随便搞一个邮箱即可的。这个邮箱就是用于在沙箱环境充当一个卖家的一个身份，就是别人付款你收钱的这样一个身份，明白了吧。好下面你会发现这个【Sandbox Business Account】没办法填写，而是只能够选择，所以呢我们现在再去返回回去，创建一下沙箱的卖家以及买家的账号，稍等。</li><li>你现在看到左侧有导航栏对吧，BASHBOARD就额你就认为他是控制台的意思好了。然后第二个菜单栏SANDBOX即沙箱，好那么我们就点击【SANDBOX】下面的第一个子菜单【Accounts】账号，点击这个【Accounts】</li><li>今天没时间，之后有时间再来完成这个流程的文档，我今天得先去测试回调流程发货，过几天就要测试了byebye</li></ul><p>今天遇到了一个问题<br>No tracked branch configured for branch developing or the branch doesn’t exist. To make your branch track a remote branch call, for example, git branch –set-upstream-to=origin/developing developing</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line">oft Windows [版本 <span class="number">10.0</span>.<span class="number">17763.1039</span>]</span><br><span class="line">(<span class="keyword">c</span>) <span class="number">2018</span> Microsoft Corporation。保留所有权利。</span><br><span class="line"></span><br><span class="line">F:\Project\Lingo\lingo&gt;</span><br><span class="line">                       git branch --<span class="keyword">set</span>-upstream-<span class="keyword">to</span>=origin/developing developing</span><br><span class="line">error: the requested upstream branch <span class="string">'origin/developing'</span> does not exist</span><br><span class="line">hin<span class="variable">t:</span> </span><br><span class="line">hin<span class="variable">t:</span> If you are planning <span class="keyword">on</span> basing your work <span class="keyword">on</span> <span class="keyword">an</span> upstream</span><br><span class="line">hin<span class="variable">t:</span> branch that already <span class="built_in">exists</span> at the remote, you may need <span class="keyword">to</span></span><br><span class="line">hin<span class="variable">t:</span> run <span class="string">"git fetch"</span> <span class="keyword">to</span> retrieve it.</span><br><span class="line">hin<span class="variable">t:</span> </span><br><span class="line">hin<span class="variable">t:</span> If you are planning <span class="keyword">to</span> push out <span class="keyword">a</span> <span class="keyword">new</span> local branch that</span><br><span class="line">hin<span class="variable">t:</span> will track its remote counterpart, you may want <span class="keyword">to</span> use</span><br><span class="line">hin<span class="variable">t:</span> <span class="string">"git push -u"</span> <span class="keyword">to</span> <span class="keyword">set</span> the upstream config <span class="keyword">as</span> you push.</span><br><span class="line"></span><br><span class="line">F:\Project\Lingo\lingo&gt;git branch --<span class="keyword">set</span>-upstream-<span class="keyword">to</span>=origin/developing developing</span><br><span class="line">error: the requested upstream branch <span class="string">'origin/developing'</span> does not exist</span><br><span class="line">hin<span class="variable">t:</span> </span><br><span class="line">hin<span class="variable">t:</span> If you are planning <span class="keyword">on</span> basing your work <span class="keyword">on</span> <span class="keyword">an</span> upstream</span><br><span class="line">hin<span class="variable">t:</span> branch that already <span class="built_in">exists</span> at the remote, you may need <span class="keyword">to</span></span><br><span class="line">hin<span class="variable">t:</span> run <span class="string">"git fetch"</span> <span class="keyword">to</span> retrieve it.</span><br><span class="line">hin<span class="variable">t:</span> </span><br><span class="line">hin<span class="variable">t:</span> If you are planning <span class="keyword">to</span> push out <span class="keyword">a</span> <span class="keyword">new</span> local branch that</span><br><span class="line">hin<span class="variable">t:</span> will track its remote counterpart, you may want <span class="keyword">to</span> use</span><br><span class="line">hin<span class="variable">t:</span> <span class="string">"git push -u"</span> <span class="keyword">to</span> <span class="keyword">set</span> the upstream config <span class="keyword">as</span> you push.</span><br><span class="line"></span><br><span class="line">F:\Project\Lingo\lingo&gt;git branch --<span class="keyword">set</span>-upstream-<span class="keyword">to</span> origin</span><br><span class="line">error: the requested upstream branch <span class="string">'origin'</span> does not exist</span><br><span class="line">hin<span class="variable">t:</span> </span><br><span class="line">hin<span class="variable">t:</span> If you are planning <span class="keyword">on</span> basing your work <span class="keyword">on</span> <span class="keyword">an</span> upstream</span><br><span class="line">hin<span class="variable">t:</span> branch that already <span class="built_in">exists</span> at the remote, you may need <span class="keyword">to</span></span><br><span class="line">hin<span class="variable">t:</span> run <span class="string">"git fetch"</span> <span class="keyword">to</span> retrieve it.</span><br><span class="line">hin<span class="variable">t:</span> </span><br><span class="line">hin<span class="variable">t:</span> If you are planning <span class="keyword">to</span> push out <span class="keyword">a</span> <span class="keyword">new</span> local branch that</span><br><span class="line">hin<span class="variable">t:</span> will track its remote counterpart, you may want <span class="keyword">to</span> use</span><br><span class="line">hin<span class="variable">t:</span> <span class="string">"git push -u"</span> <span class="keyword">to</span> <span class="keyword">set</span> the upstream config <span class="keyword">as</span> you push.</span><br><span class="line"></span><br><span class="line">F:\Project\Lingo\lingo&gt;git branch --<span class="keyword">set</span>-upstream-<span class="keyword">to</span> origin</span><br><span class="line">error: the requested upstream branch <span class="string">'origin'</span> does not exist</span><br><span class="line">hin<span class="variable">t:</span> </span><br><span class="line">hin<span class="variable">t:</span> If you are planning <span class="keyword">on</span> basing your work <span class="keyword">on</span> <span class="keyword">an</span> upstream</span><br><span class="line">hin<span class="variable">t:</span> branch that already <span class="built_in">exists</span> at the remote, you may need <span class="keyword">to</span></span><br><span class="line">hin<span class="variable">t:</span> run <span class="string">"git fetch"</span> <span class="keyword">to</span> retrieve it.</span><br><span class="line">hin<span class="variable">t:</span> </span><br><span class="line">hin<span class="variable">t:</span> If you are planning <span class="keyword">to</span> push out <span class="keyword">a</span> <span class="keyword">new</span> local branch that</span><br><span class="line">hin<span class="variable">t:</span> will track its remote counterpart, you may want <span class="keyword">to</span> use</span><br><span class="line">hin<span class="variable">t:</span> <span class="string">"git push -u"</span> <span class="keyword">to</span> <span class="keyword">set</span> the upstream config <span class="keyword">as</span> you push.</span><br><span class="line"></span><br><span class="line">F:\Project\Lingo\lingo&gt;git branch --<span class="keyword">set</span>-upstream-<span class="keyword">to</span> origin/developing</span><br><span class="line">error: the requested upstream branch <span class="string">'origin/developing'</span> does not exist</span><br><span class="line">hin<span class="variable">t:</span> </span><br><span class="line">hin<span class="variable">t:</span> If you are planning <span class="keyword">on</span> basing your work <span class="keyword">on</span> <span class="keyword">an</span> upstream</span><br><span class="line">hin<span class="variable">t:</span> branch that already <span class="built_in">exists</span> at the remote, you may need <span class="keyword">to</span></span><br><span class="line">hin<span class="variable">t:</span> run <span class="string">"git fetch"</span> <span class="keyword">to</span> retrieve it.</span><br><span class="line">hin<span class="variable">t:</span> </span><br><span class="line">hin<span class="variable">t:</span> If you are planning <span class="keyword">to</span> push out <span class="keyword">a</span> <span class="keyword">new</span> local branch that</span><br><span class="line">hin<span class="variable">t:</span> will track its remote counterpart, you may want <span class="keyword">to</span> use</span><br><span class="line">hin<span class="variable">t:</span> <span class="string">"git push -u"</span> <span class="keyword">to</span> <span class="keyword">set</span> the upstream config <span class="keyword">as</span> you push.</span><br><span class="line"></span><br><span class="line">F:\Project\Lingo\lingo&gt;git branch --<span class="keyword">set</span>-upstream-<span class="keyword">to</span>=origin/developing developing</span><br><span class="line">error: the requested upstream branch <span class="string">'origin/developing'</span> does not exist</span><br><span class="line">hin<span class="variable">t:</span> </span><br><span class="line">hin<span class="variable">t:</span> If you are planning <span class="keyword">on</span> basing your work <span class="keyword">on</span> <span class="keyword">an</span> upstream</span><br><span class="line">hin<span class="variable">t:</span> branch that already <span class="built_in">exists</span> at the remote, you may need <span class="keyword">to</span></span><br><span class="line">hin<span class="variable">t:</span> run <span class="string">"git fetch"</span> <span class="keyword">to</span> retrieve it.</span><br><span class="line">hin<span class="variable">t:</span> </span><br><span class="line">hin<span class="variable">t:</span> If you are planning <span class="keyword">to</span> push out <span class="keyword">a</span> <span class="keyword">new</span> local branch that</span><br><span class="line">hin<span class="variable">t:</span> will track its remote counterpart, you may want <span class="keyword">to</span> use</span><br><span class="line">hin<span class="variable">t:</span> <span class="string">"git push -u"</span> <span class="keyword">to</span> <span class="keyword">set</span> the upstream config <span class="keyword">as</span> you push.</span><br><span class="line"></span><br><span class="line">F:\Project\Lingo\lingo&gt;git fetch</span><br><span class="line"></span><br><span class="line">F:\Project\Lingo\lingo&gt;git push -<span class="keyword">u</span></span><br><span class="line">fata<span class="variable">l:</span> No configured push destination.</span><br><span class="line">Either specify the URL from the <span class="keyword">command</span>-<span class="built_in">line</span> <span class="built_in">or</span> configure <span class="keyword">a</span> remote repository using</span><br><span class="line"></span><br><span class="line">    git remote <span class="built_in">add</span> <span class="symbol">&lt;name&gt;</span> <span class="symbol">&lt;url&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">and</span> then push using the remote name</span><br><span class="line"></span><br><span class="line">    git push <span class="symbol">&lt;name&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">F:\Project\Lingo\lingo&gt;hin<span class="variable">t:</span> If you are planning <span class="keyword">on</span> basing your work <span class="keyword">on</span> <span class="keyword">an</span> upstream</span><br><span class="line"><span class="string">'hint:'</span> 不是内部或外部命令，也不是可运行的程序</span><br><span class="line">或批处理文件。</span><br><span class="line"></span><br><span class="line">F:\Project\Lingo\lingo&gt;hin<span class="variable">t:</span> branch that already <span class="built_in">exists</span> at the remote, you may need <span class="keyword">to</span></span><br><span class="line"><span class="string">'hint:'</span> 不是内部或外部命令，也不是可运行的程序</span><br><span class="line">或批处理文件。</span><br><span class="line"></span><br><span class="line">F:\Project\Lingo\lingo&gt;hin<span class="variable">t:</span> run <span class="string">"git fetch"</span> <span class="keyword">to</span> retrieve it.</span><br><span class="line"><span class="string">'hint:'</span> 不是内部或外部命令，也不是可运行的程序</span><br><span class="line">或批处理文件。</span><br><span class="line"></span><br><span class="line">F:\Project\Lingo\lingo&gt;git branch --<span class="keyword">set</span>-upstream-<span class="keyword">to</span>=origin/developing developing</span><br><span class="line">error: the requested upstream branch <span class="string">'origin/developing'</span> does not exist</span><br><span class="line">hin<span class="variable">t:</span></span><br><span class="line">hin<span class="variable">t:</span> If you are planning <span class="keyword">on</span> basing your work <span class="keyword">on</span> <span class="keyword">an</span> upstream</span><br><span class="line">hin<span class="variable">t:</span> branch that already <span class="built_in">exists</span> at the remote, you may need <span class="keyword">to</span></span><br><span class="line">hin<span class="variable">t:</span> run <span class="string">"git fetch"</span> <span class="keyword">to</span> retrieve it.</span><br><span class="line">hin<span class="variable">t:</span></span><br><span class="line">hin<span class="variable">t:</span> If you are planning <span class="keyword">to</span> push out <span class="keyword">a</span> <span class="keyword">new</span> local branch that</span><br><span class="line">hin<span class="variable">t:</span> will track its remote counterpart, you may want <span class="keyword">to</span> use</span><br><span class="line">hin<span class="variable">t:</span> <span class="string">"git push -u"</span> <span class="keyword">to</span> <span class="keyword">set</span> the upstream config <span class="keyword">as</span> you push.</span><br><span class="line"></span><br><span class="line">F:\Project\Lingo\lingo&gt;git fetch</span><br><span class="line"></span><br><span class="line">F:\Project\Lingo\lingo&gt;git fetch</span><br><span class="line"></span><br><span class="line">F:\Project\Lingo\lingo&gt;git branch --<span class="keyword">set</span>-upstream-<span class="keyword">to</span> origin/developing developing</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">F:\Project\Lingo\lingo&gt;</span><br><span class="line">F:\Project\Lingo\lingo&gt;</span><br><span class="line">F:\Project\Lingo\lingo&gt;</span><br><span class="line">F:\Project\Lingo\lingo&gt;</span><br><span class="line">F:\Project\Lingo\lingo&gt;</span><br><span class="line">F:\Project\Lingo\lingo&gt;</span><br><span class="line">F:\Project\Lingo\lingo&gt;git branch --<span class="keyword">set</span>-upstream-<span class="keyword">to</span>=origin/developing developing</span><br><span class="line">error: the requested upstream branch <span class="string">'origin/developing'</span> does not exist</span><br><span class="line">hin<span class="variable">t:</span> </span><br><span class="line">hin<span class="variable">t:</span> If you are planning <span class="keyword">on</span> basing your work <span class="keyword">on</span> <span class="keyword">an</span> upstream</span><br><span class="line">hin<span class="variable">t:</span> branch that already <span class="built_in">exists</span> at the remote, you may need <span class="keyword">to</span></span><br><span class="line">hin<span class="variable">t:</span> run <span class="string">"git fetch"</span> <span class="keyword">to</span> retrieve it.</span><br><span class="line">hin<span class="variable">t:</span> </span><br><span class="line">hin<span class="variable">t:</span> If you are planning <span class="keyword">to</span> push out <span class="keyword">a</span> <span class="keyword">new</span> local branch that</span><br><span class="line">hin<span class="variable">t:</span> will track its remote counterpart, you may want <span class="keyword">to</span> use</span><br><span class="line">hin<span class="variable">t:</span> <span class="string">"git push -u"</span> <span class="keyword">to</span> <span class="keyword">set</span> the upstream config <span class="keyword">as</span> you push.</span><br><span class="line"></span><br><span class="line">F:\Project\Lingo\lingo&gt;git fetch</span><br><span class="line"></span><br><span class="line">F:\Project\Lingo\lingo&gt;git push -<span class="keyword">u</span> developing</span><br><span class="line">fata<span class="variable">l:</span> The current branch developing <span class="built_in">has</span> <span class="keyword">no</span> upstream branch.</span><br><span class="line">To push the current branch <span class="built_in">and</span> <span class="keyword">set</span> the remote <span class="keyword">as</span> upstream, use</span><br><span class="line"></span><br><span class="line">    git push --<span class="keyword">set</span>-upstream developing developing</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">F:\Project\Lingo\lingo&gt;git push --<span class="keyword">set</span>-upstream developing developing</span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">'/c/Users/ASUS/.ssh/id_rsa'</span>:</span><br><span class="line">Everything <span class="keyword">up</span>-<span class="keyword">to</span>-date</span><br><span class="line">Branch <span class="string">'developing'</span> <span class="keyword">set</span> <span class="keyword">up</span> <span class="keyword">to</span> track remote branch <span class="string">'developing'</span> from <span class="string">'developing'</span>.</span><br><span class="line"></span><br><span class="line">F:\Project\Lingo\lingo&gt;git branch --<span class="keyword">set</span>-upstream-<span class="keyword">to</span>=origin/developing developing</span><br><span class="line">error: the requested upstream branch <span class="string">'origin/developing'</span> does not exist</span><br><span class="line">hin<span class="variable">t:</span> </span><br><span class="line">hin<span class="variable">t:</span> If you are planning <span class="keyword">on</span> basing your work <span class="keyword">on</span> <span class="keyword">an</span> upstream</span><br><span class="line">hin<span class="variable">t:</span> branch that already <span class="built_in">exists</span> at the remote, you may need <span class="keyword">to</span></span><br><span class="line">hin<span class="variable">t:</span> run <span class="string">"git fetch"</span> <span class="keyword">to</span> retrieve it.</span><br><span class="line">hin<span class="variable">t:</span> </span><br><span class="line">hin<span class="variable">t:</span> If you are planning <span class="keyword">to</span> push out <span class="keyword">a</span> <span class="keyword">new</span> local branch that</span><br><span class="line">hin<span class="variable">t:</span> will track its remote counterpart, you may want <span class="keyword">to</span> use</span><br><span class="line">hin<span class="variable">t:</span> <span class="string">"git push -u"</span> <span class="keyword">to</span> <span class="keyword">set</span> the upstream config <span class="keyword">as</span> you push.</span><br><span class="line"></span><br><span class="line">F:\Project\Lingo\lingo&gt;^A</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;PayPal-交互示意图&quot;&gt;&lt;a href=&quot;#PayPal-交互示意图&quot; class=&quot;headerlink&quot; title=&quot;PayPal 交互示意图&quot;&gt;&lt;/a&gt;PayPal 交互示意图&lt;/h2&gt;&lt;p&gt;有一个关于paypal的交互图我得贡献出来，不知道从哪篇博客
      
    
    </summary>
    
    
      <category term="领赫" scheme="https://fengshana.github.io/categories/%E9%A2%86%E8%B5%AB/"/>
    
    
      <category term="领赫" scheme="https://fengshana.github.io/tags/%E9%A2%86%E8%B5%AB/"/>
    
      <category term="PayPal" scheme="https://fengshana.github.io/tags/PayPal/"/>
    
      <category term="支付" scheme="https://fengshana.github.io/tags/%E6%94%AF%E4%BB%98/"/>
    
  </entry>
  
  <entry>
    <title>基于SpringBoot-邮件服务</title>
    <link href="https://fengshana.github.io/2020/04/15/%E9%A2%86%E8%B5%AB/%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1/"/>
    <id>https://fengshana.github.io/2020/04/15/%E9%A2%86%E8%B5%AB/%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1/</id>
    <published>2020-04-15T04:52:56.000Z</published>
    <updated>2020-04-14T17:01:40.622Z</updated>
    
    <content type="html"><![CDATA[<h2 id="参考Blog"><a href="#参考Blog" class="headerlink" title="参考Blog"></a>参考Blog</h2><ul><li><a href="https://blog.csdn.net/weixin_44767463/article/details/100688643" target="_blank" rel="noopener">https://blog.csdn.net/weixin_44767463/article/details/100688643</a></li><li><a href="https://blog.csdn.net/daa20/article/details/88868807" target="_blank" rel="noopener">https://blog.csdn.net/daa20/article/details/88868807</a></li><li><a href="https://www.cnblogs.com/achengmu/p/10955765.html" target="_blank" rel="noopener">https://www.cnblogs.com/achengmu/p/10955765.html</a></li></ul><h2 id="API官方文档"><a href="#API官方文档" class="headerlink" title="API官方文档"></a>API官方文档</h2><ul><li><a href="https://sendgrid.api-docs.io/" target="_blank" rel="noopener">https://sendgrid.api-docs.io/</a></li><li><a href="https://sendgrid.com/docs/for-developers/sending-email/getting-started-smtp/" target="_blank" rel="noopener">https://sendgrid.com/docs/for-developers/sending-email/getting-started-smtp/</a></li></ul><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><ol><li>邮件样式html不兼容—已解决</li><li>邮件附件名称乱码—已解决</li><li>邮件发送到了垃圾箱—已解决</li><li>邮件使用多线程进行异步处理—已解决</li><li>邮件发送不成功如何处理—面试官提出的问题</li><li>邮件发送使用多线程，关于多线程相关的面试问题</li></ol><ul><li>邮件发送不成功如何处理  </li></ul><p>这个问题我记得我当时的回答是这样的：<br>因为在领赫这个项目当中发送邮件是通过多线程的方式进行发送的邮件，也就是异步处理发送邮件的这个业务。<br>然后面试官就问，如果通过这个多线程发送邮件，但是这个邮件并未发送成功该如何处理？<br>答：因为SendGrid发送邮件时如果发送成功会返回一个200的发送成功的响应码回来；也有的时候并不会发送200的响应码回来，也就是当渠道不稳定的时候，异常的时候，那么这个时候我们系统是没有对这种情况作出处理。因为领赫这个项目是初稿。还有很多需要完善的地方。当然了针对这个问题，我认为所需要作出的完善就是，可以建一张关于发送账单邮件的表，把每一次发送邮件的记录，发送邮件时间，发送人，发送内容，发送状态（未发送/成功/失败）等有必要记录下来的内容映射到表中的字段。而后台当中在每次发送邮件内容的操作旁，如果读取得到该相应操作的发送邮件未成功，可以点击重试发送邮件相关按钮进行重新操作。  </p><p>而且有个点很类似，就是获取paypal的支付链接的时候，因为是沙箱环境，paypal沙箱环境又在做更新处理，我遇到好几次情况就是paypal沙箱环境不稳定，然后返回的token无效，也就是说我通过这个token去获取paypal沙箱环境当中的支付链接的时候无法获取得到返回401响应码，也就是说在获取支付链接的这个业务操作的时候，如果遇到paypal，也就是渠道异常的时候该如何处理，david就建议说重试三次，如果三次内paypal未获取成功那么就判定为paypal渠道问题；否则在三次内进行获取paypal支付链接。不然一直循环获取支付链接的话，会给服务器带来不必要的麻烦，或者说压力。</p><ul><li>多线程</li></ul><p>这个也是面试官问我的一个问题，他问我Runnable和Thread 有什么区别？<br>因为我在项目当中是使用多线程完成的这个发送邮件的这个功能。<br>然后被问到有关多线程相关的问题也是人之常情。<br>但是我不会。<br>我就答了Thread是类，可继承；Runnable是接口多实现。<br>哦豁。其实领赫项目当中有关多线程的操作我都是直接百度来的代码。也怪自己对待面试不够认真。<br>代码：  </p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">package com.yourshares.configuration;</span><br><span class="line"></span><br><span class="line">import com.alibaba.fastjson.JSONObject;</span><br><span class="line">import com.sendgrid.*;</span><br><span class="line">import com.yourshares.common.tools.LogFileName;</span><br><span class="line">import com.yourshares.common.utils.LoggerUtils;</span><br><span class="line">import org.slf4j.Logger;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line"></span><br><span class="line">public <span class="keyword">class</span> MailThread extends Thread&#123;</span><br><span class="line">    Logger logger = LoggerUtils.<span class="constructor">Logger(LogFileName.API)</span>;</span><br><span class="line"></span><br><span class="line">    String contentHtml=<span class="string">""</span>;</span><br><span class="line">    String mainMail=<span class="string">""</span>;</span><br><span class="line">    String sendgridApiKey=<span class="string">""</span>;</span><br><span class="line">    public <span class="constructor">MailThread(JSONObject <span class="params">mail</span>)</span> &#123;</span><br><span class="line">        this.contentHtml = mail.get<span class="constructor">String(<span class="string">"contentHtml"</span>)</span>;</span><br><span class="line">        this.mainMail = mail.get<span class="constructor">String(<span class="string">"mainMail"</span>)</span>;</span><br><span class="line">        this.sendgridApiKey = mail.get<span class="constructor">String(<span class="string">"sendgridApiKey"</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//需要执行的部分</span></span><br><span class="line">    public void run<span class="literal">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        logger.info(<span class="string">"=========================MailThread========================="</span>);</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//发送邮件给客户嘞</span></span><br><span class="line">            Email from = <span class="keyword">new</span> <span class="constructor">Email(<span class="string">"info@fbabee.com"</span>)</span>;<span class="comment">//发件方@outlook.com</span></span><br><span class="line">            String subject = <span class="string">"领赫 - 消息提醒(*^▽^*)"</span>;<span class="comment">//</span></span><br><span class="line">            Email <span class="keyword">to</span> = <span class="keyword">new</span> <span class="constructor">Email(<span class="params">mainMail</span>)</span>;<span class="comment">//客户的主邮箱 mainMail</span></span><br><span class="line">            Content content = <span class="keyword">new</span> <span class="constructor">Content(<span class="string">"text/html"</span>,<span class="params">contentHtml</span>)</span>;</span><br><span class="line">            Mail mail = <span class="keyword">new</span> <span class="constructor">Mail(<span class="params">from</span>, <span class="params">subject</span>, <span class="params">to</span>, <span class="params">content</span>)</span>;</span><br><span class="line">            String apiKey = sendgridApiKey;<span class="comment">//这个key来源参考4如何获取apiKey</span></span><br><span class="line">            SendGrid sg = <span class="keyword">new</span> <span class="constructor">SendGrid(<span class="params">apiKey</span>)</span>;</span><br><span class="line">            Request request = <span class="keyword">new</span> <span class="constructor">Request()</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                request.set<span class="constructor">Method(Method.POST)</span>;</span><br><span class="line">                request.set<span class="constructor">Endpoint(<span class="string">"mail/send"</span>)</span>;</span><br><span class="line">                request.set<span class="constructor">Body(<span class="params">mail</span>.<span class="params">build</span>()</span>);</span><br><span class="line">                Response response = sg.api(request);</span><br><span class="line">                <span class="keyword">if</span>(response==null<span class="operator"> || </span><span class="module-access"><span class="module"><span class="identifier">JSONObject</span>.</span></span><span class="keyword">to</span><span class="constructor">JSONString(<span class="params">response</span>)</span>.length<span class="literal">()</span>&lt;<span class="number">6</span>)&#123;<span class="comment">//发送账单后的响应信息做发送是否成功检查</span></span><br><span class="line">                    logger.info(<span class="string">"发送消息异常，渠道无响应"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                logger.info(<span class="string">"sendMailResponse:[&#123;&#125;]"</span>,<span class="module-access"><span class="module"><span class="identifier">JSONObject</span>.</span></span><span class="keyword">to</span><span class="constructor">JSONString(<span class="params">response</span>)</span>);</span><br><span class="line">                <span class="keyword">if</span>(response!=null<span class="operator"> &amp;&amp; </span><span class="string">"202"</span>.equals(response.get<span class="constructor">StatusCode()</span>+<span class="string">""</span>))&#123;</span><br><span class="line">                    logger.info(<span class="string">"消息发送成功：[&#123;&#125;]"</span>,response.get<span class="constructor">StatusCode()</span>);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    logger.info(<span class="string">"发送消息异常，消息未发送成功，请稍后重试"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//发送账单信息之后，进行更新相关信息，即是否发送成功、财务状态改为待支付etc</span></span><br><span class="line">            &#125; catch (IOException e) &#123;</span><br><span class="line">                logger.error(<span class="string">"请求异常捕获，MSG=[&#123;&#125;]"</span>,e.get<span class="constructor">Message()</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        catch (Exception e)</span><br><span class="line">        &#123;</span><br><span class="line">            e.print<span class="constructor">StackTrace()</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        logger.info(<span class="string">"=========================MailThread END========================="</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>每次调用的时候：</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//发送邮件给客户嘞</span></span><br><span class="line">                       String url=<span class="string">""</span>;</span><br><span class="line">                       String url0=noticeUrl.split(<span class="string">"\\?"</span>)<span class="literal">[<span class="number">0</span>]</span>;<span class="comment">//前缀 http://114.116.22.115:8888/index.html#/seek/detail</span></span><br><span class="line">                       String url1=(noticeUrl.split(<span class="string">"\\?"</span>)<span class="literal">[<span class="number">1</span>]</span>).split(<span class="string">"&amp;"</span>).length!=<span class="number">2</span>?<span class="string">""</span>:(noticeUrl.split(<span class="string">"\\?"</span>)<span class="literal">[<span class="number">1</span>]</span>).split(<span class="string">"&amp;"</span>)<span class="literal">[<span class="number">1</span>]</span>;<span class="comment">//后缀 tab=1</span></span><br><span class="line">                       url=url0+<span class="string">"?id="</span>+tDeliveryOrder.get<span class="constructor">Id()</span>+<span class="string">"&amp;"</span>+url1;</span><br><span class="line">                       TConsumer tConsumer=tConsumerService.find<span class="constructor">By(<span class="string">"id"</span>,<span class="params">tDeliveryOrder</span>.<span class="params">getConsumerId</span>()</span>);<span class="comment">//客户id</span></span><br><span class="line">                       TMiddleClientUser tMiddleClientUser=tMiddleClientUserService.find<span class="constructor">By(<span class="string">"id"</span>,<span class="params">tConsumer</span>.<span class="params">getAccountId</span>()</span>);</span><br><span class="line">                       String contentHtml=get<span class="constructor">MailContent(<span class="params">tMiddleClientUser</span>.<span class="params">getFirstName</span>()</span>+tMiddleClientUser.get<span class="constructor">LastName()</span>,tDeliveryOrder.get<span class="constructor">TakeDeliveryId()</span>,url);<span class="comment">//客户名称,询价单号,打开的页面地址</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                       JSONObject mailJSON=<span class="keyword">new</span> <span class="constructor">JSONObject()</span>;</span><br><span class="line">                       mailJSON.put(<span class="string">"contentHtml"</span>,contentHtml);</span><br><span class="line">                       mailJSON.put(<span class="string">"mainMail"</span>,tConsumer.get<span class="constructor">MainMail()</span>);</span><br><span class="line">                       mailJSON.put(<span class="string">"sendgridApiKey"</span>,sendgridApiKey);</span><br><span class="line">                       MailThread thread=<span class="keyword">new</span> <span class="constructor">MailThread(<span class="params">mailJSON</span>)</span>;</span><br><span class="line">                       thread.start<span class="literal">()</span>;</span><br></pre></td></tr></table></figure><h2 id="邮件效果"><a href="#邮件效果" class="headerlink" title="邮件效果"></a>邮件效果</h2><p>先给晾出邮件的效果。  </p><blockquote><p>第一次尝试使用SendGrid发送邮件：  </p></blockquote><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANX4BFvHaAjGTO21ZnBL.8UU3b*ATRZ4XiOCUkgfb9eneWEQNte7w0GoX1kSJ0FH9dWBYr2bPZsVyvEzU4I5UZcvQ!/r" alt="image"></p><blockquote><p>后来发送的时候想发送html，结果发送的内容变成了html代码，而且附件的名称还乱码，真是神奇了。  </p></blockquote><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANX7toXqNpL60NEetxpe64wpKDyzAo*4fNUC1mz*aywJBexml.2A01S4fGOgzmYmL2WGgKM.q.l4QUgSqXEhbNih4!/r" alt="image"><br><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANXzSDjZfHnJ9mVms8QIiTTM5E82q7xnacy5AsQwUoZX78PFijAGBtOzjLr*kiZ3*he.v4GvE6R5kMe2G.gAGdBAw!/r" alt="image"></p><blockquote><p>再后来我想对这个img进行设置大小这些个，结果…  </p></blockquote><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANX2WVdozPixujwI5BIkbfJRQ6z4ZH7p4jZ3L.gKsw*WFUuwprQ7mvaJVOyu.Pk0NAU9BgnRH.WcXZi1YkK0fiujA!/r" alt="image"></p><blockquote><p>后来我就想啊，阿里云每次给我发的样式也还可以啊，于是骚操作，我就f12，把阿里云的样式代码复制了一份下来当成邮件内容进行发送，结果阿里云的没毛病。  </p></blockquote><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANX9l8TsJ01xt0XPvt76uekv8s0BNRW6rBUC1lUqyB05yltJEu.*u5B5PdmHmYvvhaOcziChD8auF5KgRi1uJoSU4!/r" alt="image"></p><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANX5pYjBiFD.HNLVin2rf4cc3*OODMx3u4*cCJXvNCi3o6qSDKVl1kV1zDX3ti3bMOX.JxP45zmntChdg*5GkQt0Y!/r" alt="image"></p><blockquote><p>解决一下附件名称乱码问题</p></blockquote><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANX9yT4s8vLJLJukFjyzCWLe6FKYZYMBrRfIrdvrJ.PI7sY8AD7eL15JpEIxbNc4kzQY*212Qna24KROrkbdB7Wi4!/r" alt="image"><br><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANX.igs8ZNrQGSq0f.L0h1vNVp883OoZjrpZLGlw*TO1U765OIhUdw7dzZnE4GhqzujJ9uDCVpBqd4vewcVeuB7e0!/r" alt="image"></p><blockquote><p>从下面开始就开始了我的账单样式兼容旅程</p></blockquote><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANX*YVFKePJU0NOSZxmxuU8vJOCtT536pXYkUeec1XBnnLojgmaqt7pVBtPTC72*8YOeC1BtJ30iOz2kH*mOr01ds!/r" alt="image"></p><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANX4o*UiwIyuBDv78s8bWgh8ovgCmSscpQ9GcHHHqS4uy7HrXQb0Kt4gSDH.c0u5m5sU01tkhUCD0g67rwp8kfkeg!/r" alt="image"></p><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANX1jVgZSussaLt.N1Nt8bdp0pUWqnjTI8WaLw23wLoMKImUEoXx0VKLkzKZjpQc5ApJyVpocGX0EWqV3znFS1WrY!/r" alt="image"></p><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANX*GenUxHQqrSVsK0vfB6eTKVVPqcw.7vxBpMlkX6RH*9biADj0DcHG0KiEp.5HS.pmONx2TT1VgHUvD2EnZwi4U!/r" alt="image"></p><blockquote><p>处理好的账单样式</p></blockquote><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANX8Rl*OZLw8E6ubzxv4R*d3VmFAvHE5PEHKFYhQD3775lpeHG8a3theqOuZoGVZdhf.AbkCILhDcu5nqttpi4*gE!/r" alt="image"></p><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANX6ThGnF7nbCkLiuC5NSFqzMuwoM0YuF3WM5cQE93CTtA9V9ajEh7qKsGiUCiAABSdcpL3jPkUHPm.RsD.MhG.pE!/r" alt="image"></p><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANXyx4SEiOmlqZfzszuKcknSsjLVQJkF**PiXP31WycOzfahyCTxLlPbOW73pgeapNqw4nI9tldk9XUK0BITSj5XU!/r" alt="image"></p><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANXzrzsI.fkttQUi7wb7EOmgdAxOPNsOH.vusV*31bHJxNEr9MRXpEWDagd6DlUymkid0VXPiRTPNWm1JFOSmYwKk!/r" alt="image"></p><h2 id="SendGrid"><a href="#SendGrid" class="headerlink" title="SendGrid"></a>SendGrid</h2><h3 id="SendGrid介绍"><a href="#SendGrid介绍" class="headerlink" title="SendGrid介绍"></a>SendGrid介绍</h3><p>首先介绍一下SendGrid邮件服务。  </p><blockquote><p>百度百科</p></blockquote><p>SendGrid 是一个电子邮件服务平台，可以帮助市场营销人员跟踪他们的电子邮件统计数据。<br>致力于帮助公司管理事务性邮件，包括航运通知、简报和注册确认等。</p><p>反正理解为就是一个用来发邮件的第三方就是的。<br>链接：<a href="https://app.sendgrid.com/" target="_blank" rel="noopener">https://app.sendgrid.com/</a><br>注册登录进去之后进行一系列操作，你将会获得你的账号、密码、api_key_id、api_key这些个东西就可以了。</p><h3 id="SendGrid-maven依赖"><a href="#SendGrid-maven依赖" class="headerlink" title="SendGrid maven依赖"></a>SendGrid maven依赖</h3><p>maven依赖jar包：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.sendgrid/sendgrid-java --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sendgrid<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>sendgrid-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="SendGrid-Demo"><a href="#SendGrid-Demo" class="headerlink" title="SendGrid Demo"></a>SendGrid Demo</h3><p>下面我就贴一下测试demo:  </p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">package com.yourshares.modelTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.paypal.base.codec.binary.Base64;</span><br><span class="line"><span class="keyword">import</span> com.sendgrid.*;</span><br><span class="line"><span class="keyword">import</span> com.yourshares.Tester;</span><br><span class="line"><span class="keyword">import</span> com.yourshares.common.tools.LogFileName;</span><br><span class="line"><span class="keyword">import</span> com.yourshares.common.utils.LoggerUtils;</span><br><span class="line"><span class="keyword">import</span> com.yourshares.entity.service.TOutRepoOrderExpenseService;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Mail 模块测试</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MailTest</span> <span class="title">extends</span> <span class="title">Tester</span> </span>&#123;</span><br><span class="line">    <span class="type">Logger</span> logger = <span class="type">LoggerUtils</span>.<span class="type">Logger</span>(<span class="type">LogFileName</span>.<span class="type">API</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> sendgridApiKey=<span class="string">"此处填上您在SendGrid上的APIKEY"</span>;</span><br><span class="line"><span class="comment">//    private final static String DEST = "D:\\80afa41a3bfc474cbf1ac8b5bc1d.pdf";//生成pdf的路径</span></span><br><span class="line"><span class="comment">//    private final static String SRC = "D:\\3b33a68bbf52417aac48687937352464.html";//html文件路径</span></span><br><span class="line"><span class="comment">//    public static final String FONT = "F:\otosanscjksc_downcc\otoSansCJKSC\otoSansCJKsc-Thin.otf";//本地字体路径（百度下载）</span></span><br></pre></td></tr></table></figure><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">  public void style<span class="constructor">Test()</span>&#123;</span><br><span class="line">      String url=<span class="string">""</span>;</span><br><span class="line">      String noticeUrl=<span class="string">"http://114.116.22.115:8888/index.html#/pickup/directlist/detail?id=直发提货单ID"</span>;</span><br><span class="line">      <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"url0:  "</span>+noticeUrl.split(<span class="string">"\\?"</span>)<span class="literal">[<span class="number">0</span>]</span>);</span><br><span class="line">      <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"url1:  "</span>+noticeUrl.split(<span class="string">"\\?"</span>)<span class="literal">[<span class="number">1</span>]</span>);</span><br><span class="line">      String url0=noticeUrl.split(<span class="string">"\\?"</span>)<span class="literal">[<span class="number">0</span>]</span>;<span class="comment">//前缀 http://114.116.22.115:8888/index.html#/seek/detail</span></span><br><span class="line">      String url1=(noticeUrl.split(<span class="string">"\\?"</span>)<span class="literal">[<span class="number">1</span>]</span>).split(<span class="string">"&amp;"</span>).length!=<span class="number">2</span>?<span class="string">""</span>:(noticeUrl.split(<span class="string">"\\?"</span>)<span class="literal">[<span class="number">1</span>]</span>).split(<span class="string">"&amp;"</span>)<span class="literal">[<span class="number">1</span>]</span>;<span class="comment">//后缀 tab=1</span></span><br><span class="line">      url=url0+<span class="string">"?id="</span>+<span class="number">23</span>+<span class="string">"&amp;"</span>+url1;</span><br><span class="line">      String contentHtml=get<span class="constructor">MailContent(<span class="string">"冯莎娜"</span>,<span class="string">"TD202001010809435400000"</span>,<span class="params">url</span>)</span>;<span class="comment">//客户名称,询价单号,打开的页面地址</span></span><br><span class="line">      Email from = <span class="keyword">new</span> <span class="constructor">Email(<span class="string">"info@fbabee.com"</span>)</span>;<span class="comment">//发件方@outlook.com</span></span><br><span class="line">      String subject = <span class="string">"领赫 - 消息提醒(*^▽^*)"</span>;<span class="comment">//</span></span><br><span class="line">      Email <span class="keyword">to</span> = <span class="keyword">new</span> <span class="constructor">Email(<span class="string">"2915324940@qq.com"</span>)</span>;<span class="comment">//客户的主邮箱</span></span><br><span class="line">      Content content = <span class="keyword">new</span> <span class="constructor">Content(<span class="string">"text/html"</span>,<span class="params">contentHtml</span>)</span>;</span><br><span class="line">      Mail mail = <span class="keyword">new</span> <span class="constructor">Mail(<span class="params">from</span>, <span class="params">subject</span>, <span class="params">to</span>, <span class="params">content</span>)</span>;</span><br><span class="line">      String apiKey = sendgridApiKey;<span class="comment">//这个key来源参考4如何获取apiKey</span></span><br><span class="line">      SendGrid sg = <span class="keyword">new</span> <span class="constructor">SendGrid(<span class="params">apiKey</span>)</span>;</span><br><span class="line">      Request request = <span class="keyword">new</span> <span class="constructor">Request()</span>;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">          request.set<span class="constructor">Method(Method.POST)</span>;</span><br><span class="line">          request.set<span class="constructor">Endpoint(<span class="string">"mail/send"</span>)</span>;</span><br><span class="line">          request.set<span class="constructor">Body(<span class="params">mail</span>.<span class="params">build</span>()</span>);</span><br><span class="line">          Response response = sg.api(request);</span><br><span class="line">          <span class="keyword">if</span>(response==null<span class="operator"> || </span><span class="module-access"><span class="module"><span class="identifier">JSONObject</span>.</span></span><span class="keyword">to</span><span class="constructor">JSONString(<span class="params">response</span>)</span>.length<span class="literal">()</span>&lt;<span class="number">6</span>)&#123;<span class="comment">//发送账单后的响应信息做发送是否成功检查</span></span><br><span class="line">              logger.info(<span class="string">"发送消息异常，渠道无响应"</span>);</span><br><span class="line">          &#125;</span><br><span class="line">          logger.info(<span class="string">"sendMailResponse:[&#123;&#125;]"</span>,<span class="module-access"><span class="module"><span class="identifier">JSONObject</span>.</span></span><span class="keyword">to</span><span class="constructor">JSONString(<span class="params">response</span>)</span>);</span><br><span class="line">          <span class="comment">//账单发送成功，后续处理更改发货单状态</span></span><br><span class="line">          <span class="keyword">if</span>(response!=null<span class="operator"> &amp;&amp; </span><span class="string">"202"</span>.equals(response.get<span class="constructor">StatusCode()</span>+<span class="string">""</span>))&#123;</span><br><span class="line">              logger.info(<span class="string">"消息发送成功：[&#123;&#125;]"</span>,response.get<span class="constructor">StatusCode()</span>);</span><br><span class="line">          &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">              logger.info(<span class="string">"发送消息异常，消息未发送成功，请稍后重试"</span>);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">//发送账单信息之后，进行更新相关信息，即是否发送成功、财务状态改为待支付etc</span></span><br><span class="line">      &#125; catch (IOException e) &#123;</span><br><span class="line">          logger.error(<span class="string">"请求异常捕获，MSG=[&#123;&#125;]"</span>,e.get<span class="constructor">Message()</span>);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>这个地方是做邮件样式处理的demo：  </p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @param middleClientUserName 客户名称</span></span><br><span class="line"><span class="comment"> * @param orderId 订单号</span></span><br><span class="line"><span class="comment"> * @return</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">public String getMailContent(String middleClientUserName,String orderId,String noticeUrl)&#123;</span><br><span class="line">    StringBuffer html=new StringBuffer(<span class="string">"&lt;!DOCTYPE html&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;html&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;head&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;meta charset=<span class="subst">\"</span>utf-8<span class="subst">\"</span> /&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/head&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;body&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;table width=<span class="subst">\"</span>800<span class="subst">\"</span> border=<span class="subst">\"</span>0<span class="subst">\"</span> align=<span class="subst">\"</span>center<span class="subst">\"</span> cellpadding=<span class="subst">\"</span>0<span class="subst">\"</span> cellspacing=<span class="subst">\"</span>0<span class="subst">\"</span> bgcolor=<span class="subst">\"</span>#ffffff<span class="subst">\"</span> style=<span class="subst">\"</span>font-family:'Microsoft YaHei';<span class="subst">\"</span>&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;tbody&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;td&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;table width=<span class="subst">\"</span>800<span class="subst">\"</span> border=<span class="subst">\"</span>0<span class="subst">\"</span> align=<span class="subst">\"</span>center<span class="subst">\"</span> cellpadding=<span class="subst">\"</span>0<span class="subst">\"</span> cellspacing=<span class="subst">\"</span>0<span class="subst">\"</span> height=<span class="subst">\"</span>40<span class="subst">\"</span>&gt;&lt;/table&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/td&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;td&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;table width=<span class="subst">\"</span>800<span class="subst">\"</span> border=<span class="subst">\"</span>0<span class="subst">\"</span> align=<span class="subst">\"</span>center<span class="subst">\"</span> cellpadding=<span class="subst">\"</span>0<span class="subst">\"</span> cellspacing=<span class="subst">\"</span>0<span class="subst">\"</span> bgcolor=<span class="subst">\"</span>#ffffff<span class="subst">\"</span> height=<span class="subst">\"</span>48<span class="subst">\"</span> style=<span class="subst">\"</span>font-family:'Microsoft YaHei';<span class="subst">\"</span>&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;tbody&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;td height=<span class="subst">\"</span>48<span class="subst">\"</span> border=<span class="subst">\"</span>0<span class="subst">\"</span> align=<span class="subst">\"</span>center<span class="subst">\"</span> valign=<span class="subst">\"</span>middle<span class="subst">\"</span> style=<span class="subst">\"</span>padding-left:20px;<span class="subst">\"</span>&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;a href=<span class="subst">\"</span>javascript:void(0);<span class="subst">\"</span> target=<span class="subst">\"</span>_blank<span class="subst">\"</span> rel=<span class="subst">\"</span>noopener<span class="subst">\"</span>&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;img src=<span class="subst">\"</span>http://fba-srm.oss-cn-hongkong.aliyuncs.com/202002241734417550微信图片_20200224173432.png<span class="subst">\"</span> width=<span class="subst">\"</span>120px<span class="subst">\"</span> height=<span class="subst">\"</span>25px<span class="subst">\"</span> border=<span class="subst">\"</span>0<span class="subst">\"</span>&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/a&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/td&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;td width=<span class="subst">\"</span>703<span class="subst">\"</span> height=<span class="subst">\"</span>48<span class="subst">\"</span> colspan=<span class="subst">\"</span>2<span class="subst">\"</span> align=<span class="subst">\"</span>right<span class="subst">\"</span> valign=<span class="subst">\"</span>middle<span class="subst">\"</span> style=<span class="subst">\"</span>color:#ffffff; padding-right:20px;<span class="subst">\"</span>&gt;&lt;/td&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/tbody&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/table&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/td&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;td&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;table width=<span class="subst">\"</span>800<span class="subst">\"</span> border=<span class="subst">\"</span>0<span class="subst">\"</span> align=<span class="subst">\"</span>left<span class="subst">\"</span> cellpadding=<span class="subst">\"</span>0<span class="subst">\"</span> cellspacing=<span class="subst">\"</span>0<span class="subst">\"</span> style=<span class="subst">\"</span>border-top:none; border-bottom:none; padding:0 20px;font-size:14px;color:#333333;<span class="subst">\"</span>&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;tbody&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;td width=<span class="subst">\"</span>760<span class="subst">\"</span> height=<span class="subst">\"</span>56<span class="subst">\"</span> border=<span class="subst">\"</span>0<span class="subst">\"</span> align=<span class="subst">\"</span>left<span class="subst">\"</span> colspan=<span class="subst">\"</span>2<span class="subst">\"</span> style=<span class="subst">\"</span> font-size:16px;vertical-align:bottom;<span class="subst">\"</span>&gt;尊敬的"</span> +</span><br><span class="line">            <span class="string">"&lt;a target=<span class="subst">\"</span>_blank<span class="subst">\"</span> href=<span class="subst">\"</span>javascript:void(0);<span class="subst">\"</span> style=<span class="subst">\"</span>font-size:16px; font-weight:bold;<span class="subst">\"</span> rel=<span class="subst">\"</span>noopener<span class="subst">\"</span>&gt;"</span>+middleClientUserName+<span class="string">"&lt;/a&gt;:&lt;/td&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;td width=<span class="subst">\"</span>760<span class="subst">\"</span> height=<span class="subst">\"</span>30<span class="subst">\"</span> border=<span class="subst">\"</span>0<span class="subst">\"</span> align=<span class="subst">\"</span>left<span class="subst">\"</span> colspan=<span class="subst">\"</span>2<span class="subst">\"</span>&gt;&amp;nbsp;&lt;/td&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;td width=<span class="subst">\"</span>40<span class="subst">\"</span> height=<span class="subst">\"</span>32<span class="subst">\"</span> border=<span class="subst">\"</span>0<span class="subst">\"</span> align=<span class="subst">\"</span>left<span class="subst">\"</span> valign=<span class="subst">\"</span>middle<span class="subst">\"</span> style=<span class="subst">\"</span> width:40px; text-align:left;vertical-align:middle; line-height:32px; float:left;<span class="subst">\"</span>&gt;&amp;nbsp;&lt;/td&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;td width=<span class="subst">\"</span>720<span class="subst">\"</span> height=<span class="subst">\"</span>32<span class="subst">\"</span> border=<span class="subst">\"</span>0<span class="subst">\"</span> align=<span class="subst">\"</span>left<span class="subst">\"</span> style=<span class="subst">\"</span> width:720px; text-align:left;vertical-align:middle;line-height:32px;<span class="subst">\"</span>&gt;您提交的询价单&lt;a href=<span class="subst">\"</span>javascript:void(0);<span class="subst">\"</span> target=<span class="subst">\"</span>_blank<span class="subst">\"</span> rel=<span class="subst">\"</span>noopener<span class="subst">\"</span>&gt;(ID:"</span>+orderId+<span class="string">")&lt;/a&gt;，已完成人工报价，请前往查看&lt;/td&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;td width=<span class="subst">\"</span>720<span class="subst">\"</span> height=<span class="subst">\"</span>32<span class="subst">\"</span> colspan=<span class="subst">\"</span>2<span class="subst">\"</span> style=<span class="subst">\"</span>padding-left:40px;line-height:32px;<span class="subst">\"</span>&gt;&lt;a href=<span class="subst">\"</span>"</span>+noticeUrl+<span class="string">"<span class="subst">\"</span> target=<span class="subst">\"</span>_blank<span class="subst">\"</span> rel=<span class="subst">\"</span>noopener<span class="subst">\"</span>&gt;点此查看&lt;/a&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/td&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/tr&gt;"</span> +</span><br><span class="line">            <span class="string">""</span> +</span><br><span class="line">            <span class="string">"&lt;tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;td width=<span class="subst">\"</span>720<span class="subst">\"</span> height=<span class="subst">\"</span>32<span class="subst">\"</span> colspan=<span class="subst">\"</span>2<span class="subst">\"</span> style=<span class="subst">\"</span>padding-left:40px;<span class="subst">\"</span>&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/td&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;td width=<span class="subst">\"</span>720<span class="subst">\"</span> height=<span class="subst">\"</span>32<span class="subst">\"</span> colspan=<span class="subst">\"</span>2<span class="subst">\"</span> style=<span class="subst">\"</span>padding-left:40px;<span class="subst">\"</span>&gt;&lt;/td&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;td width=<span class="subst">\"</span>720<span class="subst">\"</span> height=<span class="subst">\"</span>32<span class="subst">\"</span> colspan=<span class="subst">\"</span>2<span class="subst">\"</span> style=<span class="subst">\"</span>padding-left:40px;<span class="subst">\"</span>&gt;&amp;nbsp;&lt;/td&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/tr&gt;"</span> +</span><br><span class="line">            <span class="string">""</span> +</span><br><span class="line">            <span class="string">"&lt;tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;td width=<span class="subst">\"</span>720<span class="subst">\"</span> height=<span class="subst">\"</span>14<span class="subst">\"</span> colspan=<span class="subst">\"</span>2<span class="subst">\"</span> style=<span class="subst">\"</span>padding-bottom:16px; border-bottom:1px dashed #e5e5e5;font-family:'Microsoft YaHei';<span class="subst">\"</span>&gt; &lt;/td&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;td width=<span class="subst">\"</span>720<span class="subst">\"</span> height=<span class="subst">\"</span>14<span class="subst">\"</span> colspan=<span class="subst">\"</span>2<span class="subst">\"</span> style=<span class="subst">\"</span>padding:8px 0 28px;color:#999999; font-size:12px;font-family:'Microsoft YaHei';<span class="subst">\"</span>&gt;此为系统邮件请勿回复&lt;/td&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/tbody&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/table&gt;"</span> +</span><br><span class="line">            <span class="string">""</span> +</span><br><span class="line">            <span class="string">"&lt;/td&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;td&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;table align=<span class="subst">\"</span>center<span class="subst">\"</span> border=<span class="subst">\"</span>0<span class="subst">\"</span> width=<span class="subst">\"</span>100%<span class="subst">\"</span> cellpadding=<span class="subst">\"</span>0<span class="subst">\"</span> cellspacing=<span class="subst">\"</span>0<span class="subst">\"</span> bgcolor=<span class="subst">\"</span>#fff<span class="subst">\"</span>&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;tbody&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;td&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;p style=<span class="subst">\"</span>line-height: 22px; font-family: 'Microsoft YaHei'; font-size: 12px; color: #999; text-align: center;<span class="subst">\"</span>&gt;&lt;/p&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/td&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/tbody&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/table&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/td&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/tr&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/tbody&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/table&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/body&gt;"</span> +</span><br><span class="line">            <span class="string">"&lt;/html&gt;"</span>);</span><br><span class="line">    logger.info(<span class="string">"账单内容："</span>+html);</span><br><span class="line">    return html.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个地方是我写好的一个html样式，然后测试发送这个邮件内容到我自己的邮箱里面去：  </p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 发送样式 的邮件   https://www.sandbox.paypal.com/invoice/p/#83NQMXZRG6KPAZ4Y</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @throws IOException</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">@Test</span><br><span class="line">public void test4() throws  IOException&#123;</span><br><span class="line">    Email from = new Email(<span class="string">"info@fbabee.com"</span>);<span class="comment">//发件方@outlook.com</span></span><br><span class="line">    String subject = <span class="string">"领赫 - 账单提醒(*^▽^*)"</span>;<span class="comment">//Sending with Twilio SendGrid is Fun</span></span><br><span class="line">    Email to = new Email(<span class="string">"2915324940@qq.com"</span>);<span class="comment">//收件方@gmail.com</span></span><br><span class="line">    <span class="comment">//"&lt;div style='width:800px;height:600px;background-color:black'&gt; &lt;img  width='200px' height='300px'  src='http://m.qpic.cn/psc?/V11rBmNJ1xB9lV/hsnfJ.a5yg7.BhItQyNwPS2w5W77Ya6n7UEvCBQEhtvp5TN5vlqR7nIjceIjHX.H5V6eg9RYIZp65ofTS1zkiEpKFmlRFGi7*beRV26DJLI!/b&amp;bo=VQhABgAKgAcRCag!&amp;rf=viewer_4'&gt;&lt;/img&gt;&lt;/div&gt;"</span></span><br><span class="line">    Content content = new Content(<span class="string">"text/html"</span>,<span class="string">"&lt;!DOCTYPE html&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"&lt;html&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span>&lt;head&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span>&lt;meta charset=<span class="subst">\"</span>utf-8<span class="subst">\"</span> /&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span>&lt;title&gt;&lt;/title&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span>&lt;style&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>.right&#123;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>text-align: right;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>font-size: 10px;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&#125;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>.indent&#123;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>text-indent: 180px;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>font-size: 10px;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&#125;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>.widd&#123;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>width: 230px;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>font-size: 10px;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&#125;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>.centt&#123;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>text-align: center;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>font-size: 10px;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&#125;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>.bolder&#123;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>font-size: 10px;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>font-weight: bolder;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&#125;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>.ant-btn-red &#123;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    color: #FFF;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    background-color: #FF5A44;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    border-color: #FF5A44;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    text-shadow: 0 -1px 0 rgba(0,0,0,0.12);<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    -webkit-box-shadow: 0 2px 0 rgba(0,0,0,0.045);<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    box-shadow: 0 2px 0 rgba(0,0,0,0.045);<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&#125;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">".ant-btn &#123;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    line-height: 2.2;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    position: relative;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    display: inline-block;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    font-weight: 400;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    white-space: nowrap;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    text-align: center;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    background-image: none;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    border: 1px solid transparent;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    -webkit-box-shadow: 0 2px 0 rgba(0,0,0,0.015);<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    box-shadow: 0 2px 0 rgba(0,0,0,0.015);<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    cursor: pointer;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    -webkit-transition: all .3s cubic-bezier(.645, .045, .355, 1);<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    transition: all .3s cubic-bezier(.645, .045, .355, 1);<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    -webkit-user-select: none;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    -moz-user-select: none;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    -ms-user-select: none;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    user-select: none;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    -ms-touch-action: manipulation;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    touch-action: manipulation;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    height: 32px;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    padding: 0 15px;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    font-size: 14px;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    border-radius: 4px;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    color: rgba(0,0,0,0.65);<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    background-color: #fff;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>    border-color: #d9d9d9;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&#125;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>.font&#123;font-size: 10px;&#125;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span>&lt;/style&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span>&lt;/head&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span>&lt;body&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span>&lt;table width=<span class="subst">\"</span>650px<span class="subst">\"</span> height=<span class="subst">\"</span>100%<span class="subst">\"</span> style=<span class="subst">\"</span>background-color: white;margin: auto; font-family:'Microsoft YaHei';<span class="subst">\"</span>&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;tr style=<span class="subst">\"</span>height: 25px;<span class="subst">\"</span>&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>4<span class="subst">\"</span>&gt;&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td style=<span class="subst">\"</span>width: 50px;<span class="subst">\"</span>&gt;&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;tr &gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>3<span class="subst">\"</span> class=<span class="subst">\"</span>bolder<span class="subst">\"</span>&gt;&lt;img width=<span class="subst">\"</span>120px<span class="subst">\"</span> height=<span class="subst">\"</span>25px<span class="subst">\"</span> src=<span class="subst">\"</span>http://fba-srm.oss-cn-hongkong.aliyuncs.com/202002241734417550微信图片_20200224173432.png<span class="subst">\"</span>/&gt;&lt;/td&gt;&lt;!--FBABEE--&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>2<span class="subst">\"</span> style=<span class="subst">\"</span>text-align: right;font-size: 25px;font-weight: bold;<span class="subst">\"</span> &gt;INVOICE&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;tr style=<span class="subst">\"</span>height: 2px;<span class="subst">\"</span>&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>5<span class="subst">\"</span>&gt;&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>3<span class="subst">\"</span> class=<span class="subst">\"</span>font<span class="subst">\"</span>&gt;Shenzhen Linkhub Supply-Chain Management Co.LTD&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td style=<span class="subst">\"</span>font-size: 10px;text-align: right;font-weight: bolder;<span class="subst">\"</span>&gt;Invoince ID&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td style=<span class="subst">\"</span>font-size: 10px;text-align: right;<span class="subst">\"</span>&gt;1904193751&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>3<span class="subst">\"</span> class=<span class="subst">\"</span>font<span class="subst">\"</span>&gt;Add:302,Building D,New Retail Tech Industrial Zoon&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td style=<span class="subst">\"</span>font-size: 10px;text-align: right;font-weight: bolder;<span class="subst">\"</span>&gt;FBA ID&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td style=<span class="subst">\"</span>font-size: 10px;text-align: right;<span class="subst">\"</span>&gt;XXXXXXX&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>3<span class="subst">\"</span> class=<span class="subst">\"</span>font<span class="subst">\"</span>&gt;GUshu,Xixiang Street,Bao'An,518000&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td style=<span class="subst">\"</span>font-size: 10px;text-align: right;font-weight: bolder;<span class="subst">\"</span>&gt;Date Issued&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td style=<span class="subst">\"</span>font-size: 10px;text-align: right;<span class="subst">\"</span>&gt;2019/05/02&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>3<span class="subst">\"</span> class=<span class="subst">\"</span>font<span class="subst">\"</span>&gt;Guangdong Province,China&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td style=<span class="subst">\"</span>font-size: 10px;text-align: right;font-weight: bolder;<span class="subst">\"</span>&gt;Due Date&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td style=<span class="subst">\"</span>font-size: 10px;text-align: right;<span class="subst">\"</span>&gt;2019/05/02&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;tr style=<span class="subst">\"</span>height: 30px;<span class="subst">\"</span>&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>5<span class="subst">\"</span>&gt;&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>2<span class="subst">\"</span> class=<span class="subst">\"</span>bolder<span class="subst">\"</span>&gt;Bill to&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>3<span class="subst">\"</span> class=<span class="subst">\"</span>bolder<span class="subst">\"</span>&gt;Ship to&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;tr style=<span class="subst">\"</span>height: 2px;<span class="subst">\"</span>&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>5<span class="subst">\"</span>&gt;&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>2<span class="subst">\"</span> class=<span class="subst">\"</span>font<span class="subst">\"</span>&gt;公司名称&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>3<span class="subst">\"</span> class=<span class="subst">\"</span>font<span class="subst">\"</span>&gt;24300 Nandina Ave,Moreno Valley,CA,&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>2<span class="subst">\"</span> class=<span class="subst">\"</span>font<span class="subst">\"</span>&gt;公司地址&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>3<span class="subst">\"</span> class=<span class="subst">\"</span>font<span class="subst">\"</span>&gt;92551,United States&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;tr style=<span class="subst">\"</span>height: 30px;<span class="subst">\"</span>&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>5<span class="subst">\"</span>&gt;&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>bolder<span class="subst">\"</span>&gt;Items Description&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>4<span class="subst">\"</span>&gt;&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;tr style=<span class="subst">\"</span>height: 2px;<span class="subst">\"</span>&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>5<span class="subst">\"</span>&gt;&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;&lt;tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>bolder<span class="subst">\"</span>&gt;费用集合一&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>bolder indent<span class="subst">\"</span> colspan=<span class="subst">\"</span>2<span class="subst">\"</span>&gt;Rate&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>centt bolder<span class="subst">\"</span>&gt;Quantity&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>right bolder<span class="subst">\"</span>&gt;Amount&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;tr style=<span class="subst">\"</span>height: 2px;<span class="subst">\"</span>&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>5<span class="subst">\"</span>&gt;&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;&lt;tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>font<span class="subst">\"</span>&gt;固定费用&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>indent<span class="subst">\"</span> colspan=<span class="subst">\"</span>2<span class="subst">\"</span>&gt;1&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>centt<span class="subst">\"</span>&gt;x 10 &lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>right<span class="subst">\"</span>&gt;$ 10.00&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;&lt;tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>font<span class="subst">\"</span>&gt;快递取件费用&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>indent<span class="subst">\"</span> colspan=<span class="subst">\"</span>2<span class="subst">\"</span>&gt;0/kg&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>centt<span class="subst">\"</span>&gt;x 121kg&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>right<span class="subst">\"</span>&gt;$ 0.00&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;&lt;tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>font<span class="subst">\"</span>&gt;关税&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>indent<span class="subst">\"</span> colspan=<span class="subst">\"</span>2<span class="subst">\"</span>&gt;0&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>centt<span class="subst">\"</span>&gt;x 1331 &lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>right<span class="subst">\"</span>&gt;$ 0.00&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;&lt;tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>font<span class="subst">\"</span>&gt;重量变动费用&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>indent<span class="subst">\"</span> colspan=<span class="subst">\"</span>2<span class="subst">\"</span>&gt;8/kg&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>centt<span class="subst">\"</span>&gt;x 121kg&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>right<span class="subst">\"</span>&gt;$ 968.00&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;&lt;tr style=<span class="subst">\"</span>height: 2px;<span class="subst">\"</span>&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>5<span class="subst">\"</span>&gt;&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;&lt;tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>1<span class="subst">\"</span> class=<span class="subst">\"</span>bolder<span class="subst">\"</span>&gt;偏远地区配送附加费&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>4<span class="subst">\"</span>&gt;&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;tr style=<span class="subst">\"</span>height: 2px;<span class="subst">\"</span>&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>5<span class="subst">\"</span>&gt;&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;&lt;tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>font<span class="subst">\"</span>&gt;偏远地区配送附加费&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>indent<span class="subst">\"</span> colspan=<span class="subst">\"</span>2<span class="subst">\"</span>&gt;90/kg&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>centt<span class="subst">\"</span>&gt;x 121kg&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>right<span class="subst">\"</span>&gt;$ 10890.00&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;&lt;tr style=<span class="subst">\"</span>height: 2px;<span class="subst">\"</span>&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>5<span class="subst">\"</span>&gt;&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;&lt;tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>bolder<span class="subst">\"</span>&gt;Total&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>3<span class="subst">\"</span>&gt;&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>right bolder<span class="subst">\"</span>&gt;$ 11868.00&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;tr style=<span class="subst">\"</span>height: 30px;<span class="subst">\"</span>&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>5<span class="subst">\"</span>&gt;&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;&lt;tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>bolder<span class="subst">\"</span>&gt;Bank Infomation&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>4<span class="subst">\"</span>&gt;&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;tr style=<span class="subst">\"</span>height: 2px;<span class="subst">\"</span>&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>5<span class="subst">\"</span>&gt;&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td style=<span class="subst">\"</span>width: 100px;<span class="subst">\"</span> class=<span class="subst">\"</span>bolder<span class="subst">\"</span>&gt;Paypal Account&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>widd<span class="subst">\"</span>&gt;Palpal@fbabee.com&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>3<span class="subst">\"</span>&gt;&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>bolder<span class="subst">\"</span>&gt;Payoneer Account&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>widd<span class="subst">\"</span>&gt;fsn2915324940@163.com&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>3<span class="subst">\"</span>&gt;&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>bolder<span class="subst">\"</span>&gt;T/T&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td class=<span class="subst">\"</span>widd<span class="subst">\"</span>&gt;银行账号信息，暂时明确不了&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>3<span class="subst">\"</span>&gt;&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;tr style=<span class="subst">\"</span>height: 80px;<span class="subst">\"</span>&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>5<span class="subst">\"</span>&gt;&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;tr style=<span class="subst">\"</span>height: 30px;<span class="subst">\"</span>&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;td colspan=<span class="subst">\"</span>5<span class="subst">\"</span>&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;div style=<span class="subst">\"</span>margin:0 auto;width:200px;<span class="subst">\"</span>&gt; <span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;a href=<span class="subst">\"</span>https://www.baidu.com<span class="subst">\"</span> class=<span class="subst">\"</span>ant-btn-red ant-btn<span class="subst">\"</span> style=<span class="subst">\"</span> text-decoration: none;<span class="subst">\"</span>&gt;PayPal确认支付&lt;/a&gt; <span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/div&gt; <span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/td&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span><span class="subst">\t</span>&lt;/tr&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span><span class="subst">\t</span>&lt;/table&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"<span class="subst">\t</span>&lt;/body&gt;<span class="subst">\n</span>"</span> +</span><br><span class="line">            <span class="string">"&lt;/html&gt;"</span> );</span><br><span class="line">    Mail mail = new Mail(from, subject, to, content);</span><br><span class="line">    String apiKey = sendgridApiKey;<span class="comment">//这个key来源参考4如何获取apiKey</span></span><br><span class="line">    SendGrid sg = new SendGrid(apiKey);</span><br><span class="line">    Request request = new Request();</span><br><span class="line">    try &#123;</span><br><span class="line">        request.setMethod(Method.POST);</span><br><span class="line">        request.setEndpoint(<span class="string">"mail/send"</span>);</span><br><span class="line">        request.setBody(mail.build());</span><br><span class="line">        Response response = sg.api(request);</span><br><span class="line">        System.out.println(response.getStatusCode());</span><br><span class="line">        System.out.println(response.getBody());</span><br><span class="line">        System.out.println(response.getHeaders());</span><br><span class="line">    &#125; catch (IOException ex) &#123;</span><br><span class="line">        throw ex;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@Test</span><br><span class="line">public void t()&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个地方是我之前参考的别人的博客，进行发送账单邮件这些的，但是我后来发现，写的样式并不那啥，就是我明明在hbuilder上面html写的还可以整体，但是发送到了qq邮箱里面去的时候，哦豁，不兼容，搞死我了。然而我也不是个前端小哥哥，所以兼容这方面还是费了我点心力的，总之就是心力交瘁。  </p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * https://www.sandbox.paypal.com/invoice/p/#W4NWHW2FA2XXGFZQ  账单的分享链接</span></span><br><span class="line"><span class="comment">     * 样式+附件一起发送</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="comment">//    @org.junit.Test</span></span><br><span class="line"><span class="comment">//    public void test()&#123;</span></span><br><span class="line"><span class="comment">//        EmailOptions emailOptions = new EmailOptions();</span></span><br><span class="line"><span class="comment">//        emailOptions.setToMailList(Arrays.asList("2915324940@qq.com"));//"198866436@qq.com" "fsn2915324940@163.com",</span></span><br><span class="line"><span class="comment">//        emailOptions.setSubject("领赫 - 账单提醒~~~~(*^▽^*)");//附件测试</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//        emailOptions.setContent("来了来了来了&lt;div style='width:800px;height:600px;background-color:black'&gt; &lt;img  width='200px' height='300px'  src='http://m.qpic.cn/psc?/V11rBmNJ1xB9lV/hsnfJ.a5yg7.BhItQyNwPS2w5W77Ya6n7UEvCBQEhtvp5TN5vlqR7nIjceIjHX.H5V6eg9RYIZp65ofTS1zkiEpKFmlRFGi7*beRV26DJLI!/b&amp;bo=VQhABgAKgAcRCag!&amp;rf=viewer_4'&gt;&lt;/img&gt;&lt;/div&gt;");//&lt;h1&gt;终于等到你，来付款吧&lt;/h1&gt;&lt;hr/&gt;&lt;a href='https://www.sandbox.paypal.com/invoice/p/#W4NWHW2FA2XXGFZQ'&gt;GO&lt;/a&gt;</span></span><br><span class="line"><span class="comment">//        //辛苦了。 详细情况请确认附件。  就这些。请多关照。</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//        // 添付ファイル  邮件附件。</span></span><br><span class="line"><span class="comment">//        List&lt;Attachments&gt; attachments = new ArrayList&lt;&gt;();</span></span><br><span class="line"><span class="comment">//        Attachments attachment = new Attachments();</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//        byte[] fileData = null;</span></span><br><span class="line"><span class="comment">//        fileData = fileConvertToByteArray(new File("C:\\Users\\ASUS\\Desktop\\账单TEST.pdf"));//附件  C:\Users\ASUS\Desktop\古风素材\psb (1).jpg</span></span><br><span class="line"><span class="comment">//        attachment.setContentId("账单邮件~~~~(*^▽^*)");</span></span><br><span class="line"><span class="comment">//        Base64 x = new Base64();</span></span><br><span class="line"><span class="comment">//        attachment.setContent(x.encodeAsString(fileData));</span></span><br><span class="line"><span class="comment">//        try &#123;</span></span><br><span class="line"><span class="comment">//            attachment.setFilename(MimeUtility.encodeText("领赫账单.pdf"));//image.jpg  此处发送过去的中文乱码</span></span><br><span class="line"><span class="comment">//        &#125;catch (UnsupportedEncodingException e)&#123;</span></span><br><span class="line"><span class="comment">//            logger.info("转码抛出异常=========");</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//        attachment.setType("plain/text");</span></span><br><span class="line"><span class="comment">//        attachments.add(attachment);</span></span><br><span class="line"><span class="comment">//        emailOptions.setAttachments(attachments);</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//        logger.info("emailOptions:[&#123;&#125;]", JSONObject.toJSONString(emailOptions));</span></span><br><span class="line"><span class="comment">//        // メール送信 发送邮件</span></span><br><span class="line"><span class="comment">//        sendMail(emailOptions);</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * メールの送信 发送邮件</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @param emailOptions メールオプション  邮件选项</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="comment">//    public void sendMail(EmailOptions emailOptions) &#123;</span></span><br><span class="line"><span class="comment">//        Mail mail = new Mail();</span></span><br><span class="line"><span class="comment">//        // 差出人 (sendFrom:注册时的邮箱)</span></span><br><span class="line"><span class="comment">//        Email from = new Email("info@fbabee.com");</span></span><br><span class="line"><span class="comment">//        mail.setFrom(from);</span></span><br><span class="line"><span class="comment">//        // 宛先</span></span><br><span class="line"><span class="comment">//        if (emailOptions.getToMailList() != null) &#123;</span></span><br><span class="line"><span class="comment">//            emailOptions.getToMailList().forEach(to -&gt; &#123;</span></span><br><span class="line"><span class="comment">//                logger.info("========&gt;to:[&#123;&#125;]",JSONObject.toJSONString(to));</span></span><br><span class="line"><span class="comment">//                Personalization personalization = new Personalization();</span></span><br><span class="line"><span class="comment">//                personalization.addTo(new Email(to.toString()));</span></span><br><span class="line"><span class="comment">//                mail.addPersonalization(personalization);</span></span><br><span class="line"><span class="comment">//            &#125;);</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//        // 件名</span></span><br><span class="line"><span class="comment">//        String subject = emailOptions.getSubject();</span></span><br><span class="line"><span class="comment">//        mail.setSubject(subject);</span></span><br><span class="line"><span class="comment">//        // メール内容 邮件内容</span></span><br><span class="line"><span class="comment">////        Content content = new Content("text/plain", emailOptions.getContent());</span></span><br><span class="line"><span class="comment">//        Content content = new Content("text/html", emailOptions.getContent());</span></span><br><span class="line"><span class="comment">//        mail.addContent(content);</span></span><br><span class="line"><span class="comment">//        // 添付ファイル 邮件附件。</span></span><br><span class="line"><span class="comment">//        if (emailOptions.getAttachments() != null) &#123;</span></span><br><span class="line"><span class="comment">//            emailOptions.getAttachments().forEach(attachments -&gt; &#123; mail.addAttachments(attachments); &#125;);</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//        logger.info("mail:[&#123;&#125;]",JSONObject.toJSONString(mail));</span></span><br><span class="line"><span class="comment">//        // (sendgridApiKey:经过变换的API key)</span></span><br><span class="line"><span class="comment">//        SendGrid sg = new SendGrid(sendgridApiKey);</span></span><br><span class="line"><span class="comment">//        Request request = new Request();</span></span><br><span class="line"><span class="comment">//        try &#123;</span></span><br><span class="line"><span class="comment">//            request.setMethod(Method.POST);</span></span><br><span class="line"><span class="comment">//            request.setEndpoint("mail/send");</span></span><br><span class="line"><span class="comment">//            request.setBody(mail.build());</span></span><br><span class="line"><span class="comment">//            Response response = sg.api(request);</span></span><br><span class="line"><span class="comment">//            // 202:成功</span></span><br><span class="line"><span class="comment">//            logger.info("response:[&#123;&#125;]",JSONObject.toJSONString(response));</span></span><br><span class="line"><span class="comment">//            logger.info("StatusCode: [&#123;&#125;]", response.getStatusCode());</span></span><br><span class="line"><span class="comment">//        &#125; catch (IOException ex) &#123;</span></span><br><span class="line"><span class="comment">//            logger.error("", ex);</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 把一个文件转化为byte字节数组。</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @return</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">byte</span>[] fileConvertToByteArray(<span class="built_in">File</span> file) &#123;</span><br><span class="line">        <span class="keyword">byte</span>[] data = null;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            FileInputStream fis = <span class="keyword">new</span> FileInputStream(file);</span><br><span class="line">            ByteArrayOutputStream baos = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> len;</span><br><span class="line">            <span class="keyword">byte</span>[] <span class="built_in">buffer</span> = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">            <span class="keyword">while</span> ((len = fis.<span class="built_in">read</span>(<span class="built_in">buffer</span>)) != <span class="number">-1</span>) &#123;</span><br><span class="line">                baos.<span class="built_in">write</span>(<span class="built_in">buffer</span>, <span class="number">0</span>, len);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            data = baos.toByteArray();</span><br><span class="line"></span><br><span class="line">            fis.<span class="built_in">close</span>();</span><br><span class="line">            baos.<span class="built_in">close</span>();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//base64字符串转byte[]</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] base64String2ByteFun(<span class="keyword">String</span> base64Str)&#123;</span><br><span class="line">        <span class="keyword">return</span> Base64.decodeBase64(base64Str);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//byte[]转base64</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> <span class="title">byte2Base64StringFun</span><span class="params">(<span class="keyword">byte</span>[] b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Base64.encodeBase64String(b);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>这个forEache 简直了，我想说，反正应该是jdk1.8的新式写法吧，还可以感觉，给我的感觉有点额，就是有点像js里面哦哦不是jquery里面一样的那种forEach。  </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br></pre></td><td class="code"><pre><span class="line">    @org.junit.Test</span><br><span class="line">    <span class="built_in">public</span> <span class="type">void</span> test2()&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 测试forEach 用法</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        List&lt;Map&lt;String,<span class="type">Integer</span>&gt;&gt; list=<span class="built_in">new</span> ArrayList&lt;Map&lt;String,<span class="type">Integer</span>&gt;&gt;();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">            Map map=<span class="built_in">new</span> HashMap();</span><br><span class="line">            map.put("测试名称"+i,i);</span><br><span class="line">            list.<span class="keyword">add</span>(map);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (list != <span class="keyword">null</span>) &#123;</span><br><span class="line">            list.<span class="keyword">forEach</span>(<span class="keyword">to</span> -&gt; &#123;</span><br><span class="line">                Map&lt;String,<span class="type">Integer</span>&gt; map=JSONObject.parseObject(JSONObject.toJSONString(<span class="keyword">to</span>),Map.<span class="keyword">class</span>);</span><br><span class="line">               logger.<span class="keyword">info</span>("=====&gt;打印to:[&#123;&#125;]",JSONObject.toJSONString(map));</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    TOutRepoOrderExpenseService tOutRepoOrderExpenseService;</span><br><span class="line"></span><br><span class="line">@Test</span><br><span class="line">    <span class="built_in">public</span> <span class="type">void</span> bytessss() throws <span class="keyword">Exception</span> &#123;</span><br><span class="line">//        String str="hello World  你好世界";</span><br><span class="line">//        try &#123;</span><br><span class="line">//            String aaa = <span class="built_in">new</span> String(str.getBytes("UTF-8"), "iso-8859-1");</span><br><span class="line">//            <span class="keyword">System</span>.<span class="keyword">out</span>.println("=======&gt;aaa print: " + aaa);</span><br><span class="line">//        &#125;catch (UnsupportedEncodingException e)&#123;</span><br><span class="line">//            <span class="keyword">System</span>.<span class="keyword">out</span>.println("====&gt;转码抛出异常");</span><br><span class="line">//        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    //查询账单信息，并循环样式</span><br><span class="line">//    Condition expenseCondition=<span class="built_in">new</span> Condition(TOutRepoOrderExpense.<span class="keyword">class</span>);</span><br><span class="line">//    expenseCondition.createCriteria().andEqualTo("outOrderNo",<span class="number">41</span>);</span><br><span class="line">//    List&lt;TOutRepoOrderExpense&gt; tOutRepoOrderExpenses=tOutRepoOrderExpenseService.findByCondition(expenseCondition);</span><br><span class="line">//    List&lt;List&lt;TOutRepoOrderExpense&gt;&gt; typeList=<span class="built_in">new</span> ArrayList&lt;List&lt;TOutRepoOrderExpense&gt;&gt;();</span><br><span class="line">//    BigDecimal totalSum=BigDecimal.ZERO;</span><br><span class="line">//    <span class="keyword">for</span> (TOutRepoOrderExpense tOutRepoOrderExpense:tOutRepoOrderExpenses)&#123;</span><br><span class="line">//        totalSum=totalSum.<span class="keyword">add</span>(tOutRepoOrderExpense.getTotal());</span><br><span class="line">//        <span class="keyword">if</span>(typeList.size()==<span class="number">0</span>)&#123;</span><br><span class="line">//            List&lt;TOutRepoOrderExpense&gt; list=<span class="built_in">new</span> ArrayList&lt;TOutRepoOrderExpense&gt;();</span><br><span class="line">//            list.<span class="keyword">add</span>(tOutRepoOrderExpense);</span><br><span class="line">//            typeList.<span class="keyword">add</span>(list);</span><br><span class="line">//        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">//         //需要进行比较collectionName是否一致，如果存在一致就放入该集合，如果遍历到底发现无一致的集合则创建新集合</span><br><span class="line">//            <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;typeList.size();i++)&#123;</span><br><span class="line">//                List&lt;TOutRepoOrderExpense&gt; list=typeList.<span class="keyword">get</span>(i);</span><br><span class="line">//                <span class="type">boolean</span> addFlag=<span class="keyword">false</span>;</span><br><span class="line">//                <span class="keyword">for</span>(TOutRepoOrderExpense t:list)&#123;</span><br><span class="line">//                    <span class="keyword">if</span>(t.getCollectionName().equals(tOutRepoOrderExpense.getCollectionName()))&#123;</span><br><span class="line">//                        list.<span class="keyword">add</span>(tOutRepoOrderExpense);</span><br><span class="line">//                        break;</span><br><span class="line">//                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">//                        addFlag=<span class="keyword">true</span>;</span><br><span class="line">//                    &#125;</span><br><span class="line">//                &#125;</span><br><span class="line">//                <span class="keyword">if</span>(addFlag) &#123;</span><br><span class="line">//                    List&lt;TOutRepoOrderExpense&gt; list2=<span class="built_in">new</span> ArrayList&lt;TOutRepoOrderExpense&gt;();</span><br><span class="line">//                    list2.<span class="keyword">add</span>(tOutRepoOrderExpense);</span><br><span class="line">//                    typeList.<span class="keyword">add</span>(list2);</span><br><span class="line">//                    break;</span><br><span class="line">//                &#125;</span><br><span class="line">//            &#125;</span><br><span class="line">//        &#125;</span><br><span class="line">//    &#125;</span><br><span class="line"></span><br><span class="line">    StringBuffer html=<span class="built_in">new</span> StringBuffer("&lt;!DOCTYPE html&gt;" +</span><br><span class="line">            "&lt;html&gt;" +</span><br><span class="line">            "&lt;head&gt;" +</span><br><span class="line">            "&lt;meta charset=\"utf<span class="number">-8</span>\" /&gt;" +</span><br><span class="line">            "&lt;title&gt;&lt;/title&gt;" +</span><br><span class="line">            "&lt;style&gt;" +</span><br><span class="line">            ".right&#123;" +</span><br><span class="line">            "text-align: right;" +</span><br><span class="line">            "&#125;" +</span><br><span class="line">            ".widd&#123;" +</span><br><span class="line">            "width: 230px;" +</span><br><span class="line">            "&#125;" +</span><br><span class="line">            ".centt&#123;" +</span><br><span class="line">            "text-align: center;" +</span><br><span class="line">            "&#125;" +</span><br><span class="line">            ".bolder&#123;" +</span><br><span class="line">//            "font-weight: bolder;" +</span><br><span class="line">            "&#125;" +</span><br><span class="line">            ".ant-btn-red &#123;" +</span><br><span class="line">            "    color: #FFF;" +</span><br><span class="line">            "    background-color: #FF5A44;" +</span><br><span class="line">            "    border-color: #FF5A44;" +</span><br><span class="line">            "    text-shadow: 0 -1px 0 rgba(0,0,0,0.12);" +</span><br><span class="line">            "    -webkit-box-shadow: 0 2px 0 rgba(0,0,0,0.045);" +</span><br><span class="line">            "    box-shadow: 0 2px 0 rgba(0,0,0,0.045);" +</span><br><span class="line">            "&#125;" +</span><br><span class="line">            "" +</span><br><span class="line">            ".ant-btn &#123;" +</span><br><span class="line">            "    line-height: 2.2;" +</span><br><span class="line">            "    position: relative;" +</span><br><span class="line">            "    display: inline-block;" +</span><br><span class="line">            "    font-weight: 400;" +</span><br><span class="line">            "    white-space: nowrap;" +</span><br><span class="line">            "    text-align: center;" +</span><br><span class="line">            "    background-image: none;" +</span><br><span class="line">            "    border: 1px solid transparent;" +</span><br><span class="line">            "    -webkit-box-shadow: 0 2px 0 rgba(0,0,0,0.015);" +</span><br><span class="line">            "    box-shadow: 0 2px 0 rgba(0,0,0,0.015);" +</span><br><span class="line">            "    cursor: pointer;" +</span><br><span class="line">            "    -webkit-transition: all .3s cubic-bezier(.645, .045, .355, 1);" +</span><br><span class="line">            "    transition: all .3s cubic-bezier(.645, .045, .355, 1);" +</span><br><span class="line">            "    -webkit-user-select: none;" +</span><br><span class="line">            "    -moz-user-select: none;" +</span><br><span class="line">            "    -ms-user-select: none;" +</span><br><span class="line">            "    user-select: none;" +</span><br><span class="line">            "    -ms-touch-action: manipulation;" +</span><br><span class="line">            "    touch-action: manipulation;" +</span><br><span class="line">            "    height: 32px;" +</span><br><span class="line">            "    padding: 0 15px;" +</span><br><span class="line">            "    font-size: 14px;" +</span><br><span class="line">            "    border-radius: 4px;" +</span><br><span class="line">            "    color: rgba(0,0,0,0.65);" +</span><br><span class="line">            "    background-color: #fff;" +</span><br><span class="line">            "    border-color: #d9d9d9;" +</span><br><span class="line">            "&#125;" +</span><br><span class="line">            "a:link &#123; text-decoration: none;&#125;" +</span><br><span class="line">            "　　 a:active &#123; text-decoration:none&#125;" +</span><br><span class="line">            "　　 a:hover &#123; text-decoration:none;&#125; " +</span><br><span class="line">            "　　 a:visited &#123; text-decoration: none;&#125;"+</span><br><span class="line">            "&lt;/style&gt;" +</span><br><span class="line">            "&lt;/head&gt;" +</span><br><span class="line">            "&lt;body&gt;" +</span><br><span class="line">            "&lt;table width=\"<span class="number">650</span>px\" height=\"<span class="number">100</span>%\" style=\"background-color: white;margin: auto; font-<span class="keyword">family</span>:<span class="string">'Microsoft YaHei'</span>; font-size: <span class="number">10</span>px;\"&gt;" +</span><br><span class="line">            "&lt;tr style=\"height: <span class="number">25</span>px;\"&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">4</span>\"&gt;&lt;/td&gt;&lt;td style=\"width: <span class="number">50</span>px;\"&gt;&lt;/td&gt;" +</span><br><span class="line">            "&lt;/tr&gt;" +</span><br><span class="line">            "&lt;tr &gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">3</span>\" class=\"bolder\"&gt;FBABEE&lt;/td&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">2</span>\" class=\"right bolder\"&gt;INVOICE&lt;/td&gt;" +</span><br><span class="line">            "&lt;/tr&gt;" +</span><br><span class="line">            "&lt;tr style=\"height: <span class="number">2</span>px;\"&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">5</span>\"&gt;&lt;/td&gt;" +</span><br><span class="line">            "&lt;/tr&gt;" +</span><br><span class="line">            "" +</span><br><span class="line">            "&lt;tr&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">3</span>\"&gt;Shenzhen Linkhub Supply-Chain Management Co.LTD&lt;/td&gt;" +</span><br><span class="line">            "&lt;td class=\"right bolder\"&gt;Invoince ID&lt;/td&gt;" +</span><br><span class="line">            "&lt;td class=\"right\"&gt;1904193751&lt;/td&gt;" +</span><br><span class="line">            "&lt;/tr&gt;" +</span><br><span class="line">            "&lt;tr&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">3</span>\"&gt;Add:302,Building D,New Retail Tech Industrial Zoon&lt;/td&gt;" +</span><br><span class="line">            "&lt;td class=\"right bolder\"&gt;FBA ID&lt;/td&gt;" +</span><br><span class="line">            "&lt;td class=\"right\"&gt;XXXXXXX&lt;/td&gt;" +</span><br><span class="line">            "&lt;/tr&gt;" +</span><br><span class="line">            "&lt;tr&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">3</span>\"&gt;GUshu,Xixiang Street,Bao'An,518000&lt;/td&gt;" +</span><br><span class="line">            "&lt;td class=\"right bolder\"&gt;Date Issued&lt;/td&gt;" +</span><br><span class="line">            "&lt;td class=\"right\"&gt;2019/05/02&lt;/td&gt;" +</span><br><span class="line">            "&lt;/tr&gt;" +</span><br><span class="line">            "&lt;tr&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">3</span>\"&gt;Guangdong Province,China&lt;/td&gt;" +</span><br><span class="line">            "&lt;td class=\"right bolder\"&gt;Due Date&lt;/td&gt;" +</span><br><span class="line">            "&lt;td class=\"right\"&gt;2019/05/02&lt;/td&gt;" +</span><br><span class="line">            "&lt;/tr&gt;" +</span><br><span class="line">            "&lt;tr style=\"height: <span class="number">30</span>px;\"&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">5</span>\"&gt;&lt;/td&gt;" +</span><br><span class="line">            "&lt;/tr&gt;" +</span><br><span class="line">            "&lt;tr&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">2</span>\" class=\"bolder\"&gt;Bill to&lt;/td&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">3</span>\" class=\"bolder\"&gt;Ship to&lt;/td&gt;" +</span><br><span class="line">            "&lt;/tr&gt;" +</span><br><span class="line">            "&lt;tr style=\"height: <span class="number">2</span>px;\"&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">5</span>\"&gt;&lt;/td&gt;" +</span><br><span class="line">            "&lt;/tr&gt;" +</span><br><span class="line">            "&lt;tr&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">2</span>\"&gt;公司名称&lt;/td&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">3</span>\"&gt;24300 Nandina Ave,Moreno Valley,CA,&lt;/td&gt;" +</span><br><span class="line">            "&lt;/tr&gt;" +</span><br><span class="line">            "&lt;tr&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">2</span>\"&gt;公司地址&lt;/td&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">3</span>\"&gt;92551,United States&lt;/td&gt;" +</span><br><span class="line">            "&lt;/tr&gt;" +</span><br><span class="line">            "&lt;tr style=\"height: <span class="number">30</span>px;\"&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">5</span>\"&gt;&lt;/td&gt;" +</span><br><span class="line">            "&lt;/tr&gt;" +</span><br><span class="line">            "&lt;tr&gt;" +</span><br><span class="line">            "&lt;td class=\"bolder\"&gt;Items Description&lt;/td&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">4</span>\"&gt;&lt;/td&gt;" +</span><br><span class="line">            "&lt;/tr&gt;" +</span><br><span class="line">            "&lt;tr style=\"height: <span class="number">2</span>px;\"&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">5</span>\"&gt;&lt;/td&gt;" +</span><br><span class="line">            "&lt;/tr&gt;");</span><br><span class="line">    //此时将集合分了个类，分类之后的集合需要做的即遍历样式 稍等复制一下</span><br><span class="line"></span><br><span class="line">//    <span class="keyword">System</span>.<span class="keyword">out</span>.println("typeList.size:  "+typeList.size());</span><br><span class="line">//    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;typeList.size();i++)&#123;</span><br><span class="line">//        <span class="keyword">if</span>(i==<span class="number">0</span>)&#123; //第一个集合</span><br><span class="line">//            List&lt;TOutRepoOrderExpense&gt; tOutRepoOrderExpensesList=typeList.<span class="keyword">get</span>(i);</span><br><span class="line">//                <span class="keyword">for</span> (<span class="type">int</span> x=<span class="number">0</span>;x&lt;tOutRepoOrderExpensesList.size();x++)&#123;</span><br><span class="line">//                    TOutRepoOrderExpense tOutRepoOrderExpense=tOutRepoOrderExpensesList.<span class="keyword">get</span>(x);</span><br><span class="line">//                    JSONArray jsonArray=JSONArray.parseArray(tOutRepoOrderExpense.getRuleDetail());</span><br><span class="line">//                    JSONObject ruleDetail=jsonArray.getJSONObject(<span class="number">0</span>);</span><br><span class="line">//</span><br><span class="line">//                    String collectionName=tOutRepoOrderExpense.getCollectionName();</span><br><span class="line">//                    String collectionItemName=tOutRepoOrderExpense.getCollectionItemName();</span><br><span class="line">//                    String rate=""+ruleDetail.getBigDecimal("rate");</span><br><span class="line">//                    String unit=ruleDetail.getString("unit")==<span class="keyword">null</span>?"":"/"+ruleDetail.getString("unit");</span><br><span class="line">//                    String unit2=ruleDetail.getString("unit")==<span class="keyword">null</span>?" ":ruleDetail.getString("unit");</span><br><span class="line">//                    String quantity=""+ruleDetail.getBigDecimal("quantity");</span><br><span class="line">//                    String total=""+tOutRepoOrderExpense.getTotal();</span><br><span class="line">//                    <span class="keyword">if</span>(x==<span class="number">0</span>)&#123; //第一个集合当中的第一个对象 //此处需要进行循环表头，以及第一行数据</span><br><span class="line">//                        html=html.append("&lt;tr&gt;" +</span><br><span class="line">//                                "&lt;td class=\"bolder\"&gt;"+collectionName+"&lt;/td&gt;" +</span><br><span class="line">//                                "&lt;td class=\"right bolder\" colspan=\"<span class="number">2</span>\"&gt;Rate&lt;/td&gt;" +</span><br><span class="line">//                                "&lt;td class=\"centt bolder\"&gt;Quantity&lt;/td&gt;" +</span><br><span class="line">//                                "&lt;td class=\"right bolder\"&gt;Amount&lt;/td&gt;" +</span><br><span class="line">//                                "&lt;/tr&gt;" +</span><br><span class="line">//                                "&lt;tr style=\"height: <span class="number">2</span>px;\"&gt;" +</span><br><span class="line">//                                "&lt;td colspan=\"<span class="number">5</span>\"&gt;&lt;/td&gt;" +</span><br><span class="line">//                                "&lt;/tr&gt;" +</span><br><span class="line">//                                "&lt;tr&gt;" +</span><br><span class="line">//                                "&lt;td&gt;"+collectionItemName+"&lt;/td&gt;" +</span><br><span class="line">//                                "&lt;td class=\"right\" colspan=\"<span class="number">2</span>\"&gt;"+rate+unit+"&lt;/td&gt;" +</span><br><span class="line">//                                "&lt;td class=\"centt\"&gt;x "+quantity+unit2+"&lt;/td&gt;" +</span><br><span class="line">//                                "&lt;td class=\"right\"&gt;$ "+total+"&lt;/td&gt;" +</span><br><span class="line">//                                "&lt;/tr&gt;");</span><br><span class="line">//</span><br><span class="line">//                    &#125;<span class="keyword">else</span>&#123;//第一个集合当中的其余对象</span><br><span class="line">//                        html= html.append("&lt;tr&gt;" +</span><br><span class="line">//                                "&lt;td&gt;"+collectionItemName+"&lt;/td&gt;" +</span><br><span class="line">//                                "&lt;td class=\"right\" colspan=\"<span class="number">2</span>\"&gt;"+rate+unit+"&lt;/td&gt;" +</span><br><span class="line">//                                "&lt;td class=\"centt\"&gt;x "+quantity+unit2+"&lt;/td&gt;" +</span><br><span class="line">//                                "&lt;td class=\"right\"&gt;$ "+tOutRepoOrderExpense.getTotal()+"&lt;/td&gt;" +</span><br><span class="line">//                                "&lt;/tr&gt;");</span><br><span class="line">//                    &#125;</span><br><span class="line">//                &#125;</span><br><span class="line">//                //第一个集合循环后结尾 需要进行空格处理</span><br><span class="line">//            html= html.append("&lt;tr style=\"height: <span class="number">2</span>px;\"&gt;" +</span><br><span class="line">//                    "&lt;td colspan=\"<span class="number">5</span>\"&gt;&lt;/td&gt;" +</span><br><span class="line">//                    "&lt;/tr&gt;");</span><br><span class="line">//</span><br><span class="line">//</span><br><span class="line">//        &#125;</span><br><span class="line">//        <span class="keyword">else</span>&#123;//第二个第三个第四个集合</span><br><span class="line">//            List&lt;TOutRepoOrderExpense&gt; tOutRepoOrderExpensesList=typeList.<span class="keyword">get</span>(i);</span><br><span class="line">//            <span class="keyword">for</span> (<span class="type">int</span> x=<span class="number">0</span>;x&lt;tOutRepoOrderExpensesList.size();x++)&#123;</span><br><span class="line">//</span><br><span class="line">//                TOutRepoOrderExpense tOutRepoOrderExpense=tOutRepoOrderExpensesList.<span class="keyword">get</span>(x);</span><br><span class="line">//                JSONArray jsonArray=JSONArray.parseArray(tOutRepoOrderExpense.getRuleDetail());</span><br><span class="line">//                JSONObject ruleDetail=jsonArray.getJSONObject(<span class="number">0</span>);</span><br><span class="line">//                String collectionName=tOutRepoOrderExpense.getCollectionName();</span><br><span class="line">//                String collectionItemName=tOutRepoOrderExpense.getCollectionItemName();</span><br><span class="line">//                String rate=""+ruleDetail.getBigDecimal("rate");</span><br><span class="line">//                String unit=ruleDetail.getString("unit")==<span class="keyword">null</span>?"":"/"+ruleDetail.getString("unit");</span><br><span class="line">//                String unit2=ruleDetail.getString("unit")==<span class="keyword">null</span>?" ":ruleDetail.getString("unit");</span><br><span class="line">//                String quantity=""+ruleDetail.getBigDecimal("quantity");</span><br><span class="line">//                String total=""+tOutRepoOrderExpense.getTotal();</span><br><span class="line">//</span><br><span class="line">//                <span class="keyword">if</span>(x==<span class="number">0</span>)&#123; //第一个集合当中的第一个对象</span><br><span class="line">//                    //此处需要进行循环表头，以及第一行数据</span><br><span class="line">//                    html=html.append("&lt;tr&gt;" +</span><br><span class="line">//                            "&lt;td colspan=\"<span class="number">1</span>\" class=\"bolder\"&gt;"+collectionName+"&lt;/td&gt;" +</span><br><span class="line">//                            "&lt;td colspan=\"<span class="number">4</span>\"&gt;&lt;/td&gt;" +</span><br><span class="line">//                            "&lt;/tr&gt;" +</span><br><span class="line">//                            "&lt;/tr&gt;" +</span><br><span class="line">//                            "&lt;tr style=\"height: <span class="number">2</span>px;\"&gt;" +</span><br><span class="line">//                            "&lt;td colspan=\"<span class="number">5</span>\"&gt;&lt;/td&gt;" +</span><br><span class="line">//                            "&lt;/tr&gt;" +</span><br><span class="line">//                            "&lt;tr&gt;" +</span><br><span class="line">//                            "&lt;td&gt;"+collectionItemName+"&lt;/td&gt;" +</span><br><span class="line">//                            "&lt;td class=\"right\" colspan=\"<span class="number">2</span>\"&gt;"+rate+unit+"&lt;/td&gt;" +</span><br><span class="line">//                            "&lt;td class=\"centt\"&gt;x "+quantity+unit2+"&lt;/td&gt;" +</span><br><span class="line">//                            "&lt;td class=\"right\"&gt;$ "+total+"&lt;/td&gt;" +</span><br><span class="line">//                            "&lt;/tr&gt;");</span><br><span class="line">//                &#125;</span><br><span class="line">//                <span class="keyword">else</span>&#123;//第一个集合当中的其余对象</span><br><span class="line">//                    html=html.append("&lt;tr&gt;" +</span><br><span class="line">//                            "&lt;td&gt;"+collectionItemName+"&lt;/td&gt;" +</span><br><span class="line">//                            "&lt;td class=\"right\" colspan=\"<span class="number">2</span>\"&gt;"+rate +rate+"&lt;/td&gt;" +</span><br><span class="line">//                            "&lt;td class=\"centt\"&gt;x "+quantity+unit2+"&lt;/td&gt;" +</span><br><span class="line">//                            "&lt;td class=\"right\"&gt;$ "+tOutRepoOrderExpense.getTotal()+"&lt;/td&gt;" +</span><br><span class="line">//                            "&lt;/tr&gt;");</span><br><span class="line">//                &#125;</span><br><span class="line">//            &#125;</span><br><span class="line">//</span><br><span class="line">//            //第n个集合循环后结尾 需要进行空格处理</span><br><span class="line">//            html=  html.append("&lt;tr style=\"height: <span class="number">2</span>px;\"&gt;" +</span><br><span class="line">//                    "&lt;td colspan=\"<span class="number">5</span>\"&gt;&lt;/td&gt;" +</span><br><span class="line">//                    "&lt;/tr&gt;");</span><br><span class="line">//        &#125;</span><br><span class="line">//    &#125;</span><br><span class="line">    String payoneer="fsn2915324940@163.com";//<span class="keyword">info</span>@fbabee.com</span><br><span class="line">    //当集合遍历结束，即加上total样式</span><br><span class="line">    html= html.append("&lt;tr&gt;" +</span><br><span class="line">            "&lt;td class=\"bolder\"&gt;Total&lt;/td&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">2</span>\"&gt;&lt;/td&gt;" +</span><br><span class="line">//            "&lt;td class=\"bolder\"&gt;$ 4761.52&lt;/td&gt;" +</span><br><span class="line">//            "&lt;td class=\"right bolder\"&gt;$ "+totalSum+"&lt;/td&gt;&lt;td&gt;&lt;/td&gt;" +</span><br><span class="line">            "&lt;/tr&gt;" +</span><br><span class="line">            "&lt;tr style=\"height: <span class="number">30</span>px;\"&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">5</span>\"&gt;&lt;/td&gt;" +</span><br><span class="line">            "&lt;/tr&gt;" +</span><br><span class="line">            "&lt;tr&gt;" +</span><br><span class="line">            "&lt;td class=\"bolder\"&gt;Bank Infomation&lt;/td&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">4</span>\"&gt;&lt;/td&gt;" +</span><br><span class="line">            "&lt;/tr&gt;" +</span><br><span class="line">            "&lt;tr style=\"height: <span class="number">2</span>px;\"&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">5</span>\"&gt;&lt;/td&gt;" +</span><br><span class="line">            "&lt;/tr&gt;" +</span><br><span class="line">            "&lt;tr&gt;" +</span><br><span class="line">            "&lt;td style=\"width: <span class="number">100</span>px;\" class=\"bolder\"&gt;Paypal Account&lt;/td&gt;" +</span><br><span class="line">            "&lt;td class=\"widd\"&gt;Palpal@fbabee.com&lt;/td&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">3</span>\"&gt;&lt;/td&gt;" +</span><br><span class="line">            "&lt;/tr&gt;" +</span><br><span class="line">            "&lt;tr&gt;" +</span><br><span class="line">            "&lt;td class=\"bolder\"&gt;Payoneer Account&lt;/td&gt;" +</span><br><span class="line">            "&lt;td class=\"widd\"&gt;"+payoneer+"&lt;/td&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">3</span>\"&gt;&lt;/td&gt;" +</span><br><span class="line">            "&lt;/tr&gt;" +</span><br><span class="line">            "&lt;tr&gt;" +</span><br><span class="line">            "&lt;td class=\"bolder\"&gt;T/T&lt;/td&gt;" +</span><br><span class="line">            "&lt;td class=\"widd\"&gt;银行账号信息，暂时明确不了&lt;/td&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">3</span>\"&gt;&lt;/td&gt;" +</span><br><span class="line">            "&lt;/tr&gt;" +</span><br><span class="line">            "&lt;tr style=\"height: <span class="number">80</span>px;\"&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">5</span>\"&gt;&lt;/td&gt;" +</span><br><span class="line">            "&lt;/tr&gt;" +</span><br><span class="line">            "&lt;/tr&gt;" +</span><br><span class="line">            "&lt;tr style=\"height: <span class="number">30</span>px;\"&gt;" +</span><br><span class="line">            "&lt;td colspan=\"<span class="number">5</span>\"&gt;" +</span><br><span class="line">            "&lt;div style=\"margin:<span class="number">0</span> auto;width:<span class="number">200</span>px;\"&gt; " +</span><br><span class="line">            "&lt;a href=\"https://www.baidu.com\" class=\"ant-btn-red ant-btn\"&gt;PayPal确认支付&lt;/a&gt; " +</span><br><span class="line">            "&lt;/div&gt; " +</span><br><span class="line">            "&lt;/td&gt;" +</span><br><span class="line">            "&lt;/tr&gt;" +</span><br><span class="line">            "&lt;/table&gt;" +</span><br><span class="line">            "&lt;/body&gt;" +</span><br><span class="line">            "&lt;/html&gt;");</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">System</span>.<span class="keyword">out</span>.println("=======html:   "+html);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Email <span class="keyword">from</span> = <span class="built_in">new</span> Email("info@fbabee.com");//发件方@outlook.com</span><br><span class="line">    String subject = "领赫 - 账单提醒(*^▽^*)";//Sending <span class="keyword">with</span> Twilio SendGrid <span class="keyword">is</span> Fun</span><br><span class="line">    Email <span class="keyword">to</span> = <span class="built_in">new</span> Email("2915324940@qq.com");//收件方@gmail.com</span><br><span class="line">    //"&lt;div style='width:800px;height:600px;background-color:black'&gt; &lt;img  width='200px' height='300px'  src='http://m.qpic.cn/psc?/V11rBmNJ1xB9lV/hsnfJ.a5yg7.BhItQyNwPS2w5W77Ya6n7UEvCBQEhtvp5TN5vlqR7nIjceIjHX.H5V6eg9RYIZp65ofTS1zkiEpKFmlRFGi7*beRV26DJLI!/b&amp;bo=VQhABgAKgAcRCag!&amp;rf=viewer_4'&gt;&lt;/img&gt;&lt;/div&gt;"</span><br><span class="line">    Content content = <span class="built_in">new</span> Content("text/html",html.toString());</span><br><span class="line">    Mail mail = <span class="built_in">new</span> Mail(<span class="keyword">from</span>, subject, <span class="keyword">to</span>, content);</span><br><span class="line">    String apiKey = sendgridApiKey;//这个key来源参考<span class="number">4</span>如何获取apiKey</span><br><span class="line">    SendGrid sg = <span class="built_in">new</span> SendGrid(apiKey);</span><br><span class="line">    Request request = <span class="built_in">new</span> Request();</span><br><span class="line">    try &#123;</span><br><span class="line">        request.setMethod(<span class="keyword">Method</span>.POST);</span><br><span class="line">        request.setEndpoint("mail/send");</span><br><span class="line">        request.setBody(mail.build());</span><br><span class="line">        Response response = sg.api(request);</span><br><span class="line">        <span class="keyword">System</span>.<span class="keyword">out</span>.println("=================&gt; response:"+JSONObject.toJSONString(response));</span><br><span class="line">        <span class="keyword">System</span>.<span class="keyword">out</span>.println("=================&gt; statusCode:"+response.getStatusCode());</span><br><span class="line">        <span class="keyword">System</span>.<span class="keyword">out</span>.println("=================&gt; body:"+response.getBody());</span><br><span class="line">        <span class="keyword">System</span>.<span class="keyword">out</span>.println("=================&gt; headers:"+response.getHeaders());</span><br><span class="line">    &#125; catch (IOException ex) &#123;</span><br><span class="line">        throw ex;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>因为之前做出来的html样式一直不兼容，然后david就建议说换成pdf这种文档，直接发个附件过去，额，我试了一下，就是觉得吧，其实弄成pdf会更难看，我是这么觉得的。<br>因为搞出来的确是很难看。所以后面还是去弄了一下html格式。<br>后来发现就是，得每个element标签都给他设置一下style，这样就OK。<br>其实我觉得阿里云的那个账单样式挺好看的，但是账单的样式要求这么做，然后就只能按照客户的需求来。<br>后来的其他邮件内容样式自己发挥我就直接用了阿里云邮件的样式，嘿嘿。</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * HTML转换成pdf</span><br><span class="line">     * @param html html文件路径</span><br><span class="line">     * @param DEST 生成pdf的路径</span><br><span class="line">     * @throws Exception</span><br><span class="line">     */</span><br><span class="line">    public static void tomPdf(String html, String DEST) throws Exception &#123;</span><br><span class="line">//        ConverterProperties props = new ConverterProperties();</span><br><span class="line">//        DefaultFontProvider defaultFontProvider = new DefaultFontProvider(false, false, false);</span><br><span class="line">////        defaultFontProvider.addFont("F:\otosanscjksc_downcc\otoSansCJKSC\otoSansCJKsc-Thin.otf");</span><br><span class="line">//        props.setFontProvider(defaultFontProvider);</span><br><span class="line">//        PdfWriter writer = new PdfWriter(DEST);</span><br><span class="line">//        PdfDocument pdf = new PdfDocument(writer);</span><br><span class="line">//        pdf.setDefaultPageSize(new PageSize(595.0F, 842.0F));</span><br><span class="line">//        Document document = HtmlConverter.convertToDocument(new FileInputStream(html), pdf, props);</span><br><span class="line">//        document.close();</span><br><span class="line">//        pdf.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void testtt()&#123;</span><br><span class="line">        try &#123;</span><br><span class="line">//            tomPdf("F:\\phpStudy\\PhpStudy20180211\\PHPTutorial\\WWW\\领赫\est.html", "F:\\80afa41a3bfc474cbf1ac8b5bc1d.pdf");</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println("完======================");</span><br><span class="line">    &#125;</span><br><span class="line">/*</span><br><span class="line">=================&gt; response:</span><br><span class="line">&#123;"body":"",</span><br><span class="line">"headers":&#123;</span><br><span class="line">"Server":"nginx",</span><br><span class="line">"Access-Control-Allow-Origin":"https://sendgrid.api-docs.io",</span><br><span class="line">"Access-Control-Allow-Methods":"POST",</span><br><span class="line">"Connection":"keep-alive",</span><br><span class="line">"X-Message-Id":"4iVRN4HdSlCxByZsJd3qxA",</span><br><span class="line">"X-No-CORS-Reason":"https://sendgrid.com/docs/Classroom/Basics/API/cors.html",</span><br><span class="line">"Content-Length":"0",</span><br><span class="line">"Access-Control-Max-Age":"600",</span><br><span class="line">"Date":"Fri, 14 Feb 2020 07:43:16 GMT",</span><br><span class="line">"Access-Control-Allow-Headers":"Authorization,Content-Type, On-behalf-of, x-sg-elas-acl"</span><br><span class="line">&#125;,</span><br><span class="line">"statusCode":202&#125;</span><br><span class="line"> */</span><br></pre></td></tr></table></figure><blockquote><p>测试JSONObject</p></blockquote><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line"><span class="built_in">public</span> <span class="type">void</span> tesetJSON()&#123;</span><br><span class="line"></span><br><span class="line">//    JSONArray jsonObject=JSONArray.parseArray("[&#123;\"price\":10,\"quantity\":10,\"rate\":1&#125;]");</span><br><span class="line">////    <span class="keyword">System</span>.<span class="keyword">out</span>.println(jsonObject);</span><br><span class="line"></span><br><span class="line">    JSONObject jsonObject=<span class="built_in">new</span> JSONObject();</span><br><span class="line">    jsonObject.put("name","张三");</span><br><span class="line">    StringBuffer stringBuffer=<span class="built_in">new</span> StringBuffer("");</span><br><span class="line">    stringBuffer.append("姓名："+jsonObject.getString("name")+"~~~");</span><br><span class="line">    <span class="keyword">System</span>.<span class="keyword">out</span>.println("打印;"+stringBuffer);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;参考Blog&quot;&gt;&lt;a href=&quot;#参考Blog&quot; class=&quot;headerlink&quot; title=&quot;参考Blog&quot;&gt;&lt;/a&gt;参考Blog&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.csdn.net/weixin_44767463/a
      
    
    </summary>
    
    
      <category term="领赫" scheme="https://fengshana.github.io/categories/%E9%A2%86%E8%B5%AB/"/>
    
    
      <category term="领赫" scheme="https://fengshana.github.io/tags/%E9%A2%86%E8%B5%AB/"/>
    
      <category term="SendGrid" scheme="https://fengshana.github.io/tags/SendGrid/"/>
    
      <category term="邮件服务" scheme="https://fengshana.github.io/tags/%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1/"/>
    
  </entry>
  
  <entry>
    <title>MySql-存储过程</title>
    <link href="https://fengshana.github.io/2020/04/15/%E9%A2%86%E8%B5%AB/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B/"/>
    <id>https://fengshana.github.io/2020/04/15/%E9%A2%86%E8%B5%AB/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B/</id>
    <published>2020-04-15T04:52:56.000Z</published>
    <updated>2020-04-14T18:46:39.653Z</updated>
    
    <content type="html"><![CDATA[<h2 id="记录"><a href="#记录" class="headerlink" title="记录"></a>记录</h2><p>在领赫这个项目当中，方便敏捷式开发的存储过程pojo-model层以及mapper的编写。  </p><h3 id="david指导"><a href="#david指导" class="headerlink" title="david指导"></a>david指导</h3><ul><li>那个存储过程等你有时间你得优化一下，不要名字全是sqlxJava，至少也要说明摸个存储过程是干嘛用的，不然后期很难维护，过几天你自己都忘了哪个 是干嘛用的。</li><li>如果业务不熟很复杂，还是少用存储过程，不利于维护。</li><li>写存储过程也可以，但是不要搞复杂了，你之前获取产品列表那个存储过程，我感觉你搞复杂了。</li><li>我们这业务不存在复杂的计算，基本上关联几张表就能查出数据。如果存在复杂的业务计算的时候存储过程才能发挥他额作用</li><li>存储过程可以用，尽力做好备注</li><li>两种方式都可以。你那个存储过程那个可以优化一下，通过临时表传递两个存储过程之间的数据不是很好的方式。临时表最好在一个存储过程中使用，不要夸多个存储过程。</li></ul><p>其实我能说我不会写复杂的sql所以写了存储过程吗？(<em>/ω＼</em>)<br>害  </p><h3 id="拼接列的名称"><a href="#拼接列的名称" class="headerlink" title="拼接列的名称"></a>拼接列的名称</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DEFINER=<span class="string">`admin`</span>@<span class="string">`%`</span> <span class="keyword">PROCEDURE</span> <span class="string">`concatColume`</span>(<span class="keyword">in</span> t_name <span class="built_in">char</span>(<span class="number">30</span>))</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line"><span class="keyword">GROUP_CONCAT</span>(</span><br><span class="line">column_name</span><br><span class="line">) <span class="keyword">as</span> <span class="keyword">java</span></span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">information_schema. <span class="keyword">columns</span></span><br><span class="line"><span class="keyword">where</span></span><br><span class="line">table_name = t_name;</span><br><span class="line"><span class="keyword">select</span></span><br><span class="line"><span class="keyword">GROUP_CONCAT</span>(</span><br><span class="line"><span class="keyword">CONCAT</span>(<span class="string">'#&#123;'</span>,column_name,<span class="string">'&#125;#'</span>)</span><br><span class="line">) <span class="keyword">as</span> <span class="keyword">java</span></span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">information_schema. <span class="keyword">columns</span></span><br><span class="line"><span class="keyword">where</span></span><br><span class="line">table_name = t_name;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><h3 id="通过逗号分隔字段取值"><a href="#通过逗号分隔字段取值" class="headerlink" title="通过逗号分隔字段取值"></a>通过逗号分隔字段取值</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DEFINER</span>=`<span class="keyword">admin</span>`@`%` <span class="keyword">PROCEDURE</span> `fieldValue_split_by_comma`(<span class="keyword">in</span> splitContent <span class="type">varchar</span>(<span class="number">255</span>))</span><br><span class="line"><span class="keyword">BEGIN</span> <span class="comment">-- 原来的procedure - sql9java,现在改名为 field_split_by_comma</span></span><br><span class="line">   <span class="keyword">DECLARE</span> n   <span class="type">int</span>  <span class="keyword">DEFAULT</span> <span class="number">0</span>; <span class="comment">-- 特殊字符总个数</span></span><br><span class="line"> <span class="keyword">DECLARE</span> test_n   <span class="type">int</span>  <span class="keyword">DEFAULT</span> <span class="number">0</span>; <span class="comment">-- 特殊字符总个数</span></span><br><span class="line"> <span class="keyword">DECLARE</span> i   <span class="type">int</span>  <span class="keyword">DEFAULT</span> <span class="number">0</span>; <span class="comment">-- 循环变量</span></span><br><span class="line"> <span class="keyword">DECLARE</span> ind <span class="type">int</span>  <span class="keyword">DEFAULT</span> <span class="number">0</span>; <span class="comment">-- 得到特殊字符的下标</span></span><br><span class="line"> <span class="keyword">DECLARE</span> left_str  <span class="type">varchar</span>(<span class="number">30</span>); <span class="comment">-- 左边的字符串</span></span><br><span class="line"> <span class="keyword">DECLARE</span> str_value <span class="type">varchar</span>(<span class="number">30</span>); <span class="comment">-- value变量</span></span><br><span class="line"> <span class="keyword">DECLARE</span> str       <span class="type">varchar</span>(<span class="number">255</span>); <span class="comment">-- 用于拼接的变量</span></span><br><span class="line"> <span class="keyword">create</span> <span class="keyword">temporary</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span> tmp_sql5java(num <span class="type">int</span>,s_id <span class="type">varchar</span>(<span class="number">255</span>));</span><br><span class="line"> <span class="keyword">delete</span> <span class="keyword">from</span> tmp_sql5java;<span class="comment">-- 将拆分出来的那个供应商编号新增入该表</span></span><br><span class="line"> <span class="keyword">SET</span> i = <span class="number">1</span>;</span><br><span class="line"> <span class="keyword">SET</span> str = splitContent;</span><br><span class="line"> <span class="keyword">SET</span> n = length(str)-length(REPLACE(str,",",""))+<span class="number">1</span>; <span class="comment">-- 总共有多少次需要进行替换以及大小写变化</span></span><br><span class="line"> <span class="keyword">SET</span> max_sp_recursion_depth = <span class="number">3000</span>;</span><br><span class="line">    <span class="keyword">WHILE</span> i &lt;= n <span class="keyword">DO</span> </span><br><span class="line">    <span class="keyword">SET</span> ind = LENGTH(SUBSTRING_INDEX(str,<span class="string">','</span>,i)); <span class="comment">-- 特殊字符的下标</span></span><br><span class="line">  <span class="keyword">SET</span> left_str = SUBSTRING_INDEX(str,<span class="string">','</span>,i); <span class="comment">-- 特殊字符左边的字符串</span></span><br><span class="line"><span class="keyword">SET</span> test_n =  LENGTH(SUBSTRING_INDEX(left_str,<span class="string">','</span>,i)); <span class="comment">-- 查看截取了的内容是否还有特殊字符</span></span><br><span class="line"><span class="keyword">if</span>(test_n&lt;<span class="number">0</span>) <span class="keyword">then</span></span><br><span class="line"><span class="keyword">SET</span> str_value = left_str;</span><br><span class="line"><span class="keyword">else</span>   </span><br><span class="line"><span class="keyword">SET</span> str_value = SUBSTRING_INDEX(left_str,<span class="string">','</span>,<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tmp_sql5java <span class="keyword">values</span>(i,str_value);</span><br><span class="line"><span class="keyword">SET</span> i = i+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">WHILE</span>;</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure><h3 id="生成基本的-Mapper-映射"><a href="#生成基本的-Mapper-映射" class="headerlink" title="生成基本的 Mapper 映射"></a>生成基本的 Mapper 映射</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DEFINER</span>=`<span class="keyword">admin</span>`@`%` <span class="keyword">PROCEDURE</span> `generate_base_mapper`(<span class="keyword">in</span> t_name <span class="type">char</span>(<span class="number">255</span>))</span><br><span class="line"><span class="keyword">BEGIN</span>  <span class="comment">-- 原来的 procedure - sql6java,现在改名为 generate_base_mapper</span></span><br><span class="line"><span class="comment">-- t_name 即table_name 上送参数为表名称</span></span><br><span class="line"><span class="keyword">DECLARE</span> columnName <span class="type">varchar</span>(<span class="number">5000</span>);         <span class="comment">-- 原型字段名称</span></span><br><span class="line"><span class="keyword">DECLARE</span> property <span class="type">varchar</span>(<span class="number">255</span>);           <span class="comment">-- 大小写驼峰字段名称</span></span><br><span class="line"><span class="keyword">DECLARE</span> mapper <span class="type">varchar</span>(<span class="number">255</span>);             <span class="comment">-- 表映射名称</span></span><br><span class="line"><span class="keyword">DECLARE</span> <span class="keyword">class</span> <span class="type">varchar</span>(<span class="number">255</span>);              <span class="comment">-- 类名称</span></span><br><span class="line"><span class="keyword">DECLARE</span> varClass <span class="type">varchar</span>(<span class="number">255</span>);           <span class="comment">-- 变量类名称</span></span><br><span class="line"><span class="keyword">DECLARE</span> str text(<span class="number">50000</span>);               <span class="comment">-- 字符串变量</span></span><br><span class="line"><span class="keyword">DECLARE</span> columnsStr <span class="type">varchar</span>(<span class="number">5000</span>);                <span class="comment">-- 列字符串变量</span></span><br><span class="line"><span class="keyword">DECLARE</span> insertColumnsStr <span class="type">varchar</span>(<span class="number">5000</span>);                <span class="comment">-- 列字符串变量</span></span><br><span class="line"><span class="keyword">DECLARE</span> propertyStr <span class="type">varchar</span>(<span class="number">5000</span>);               <span class="comment">-- 属性字符串变量</span></span><br><span class="line"><span class="keyword">DECLARE</span> columnPropertyStr <span class="type">varchar</span>(<span class="number">5000</span>); <span class="comment">-- 列属性字符串变量</span></span><br><span class="line"><span class="keyword">DECLARE</span> findByIdStr <span class="type">varchar</span>(<span class="number">5000</span>);       <span class="comment">-- 通过主键查找对象方法</span></span><br><span class="line"><span class="keyword">DECLARE</span> insertRecord <span class="type">varchar</span>(<span class="number">5000</span>);      <span class="comment">-- 新增记录</span></span><br><span class="line"><span class="keyword">DECLARE</span> selectCount <span class="type">varchar</span>(<span class="number">5000</span>);      <span class="comment">-- 新增记录</span></span><br><span class="line"><span class="keyword">DECLARE</span> findAll <span class="type">varchar</span>(<span class="number">5000</span>);      <span class="comment">-- 新增记录</span></span><br><span class="line"><span class="keyword">DECLARE</span> head <span class="type">varchar</span>(<span class="number">5000</span>);              <span class="comment">-- 新增记录</span></span><br><span class="line"><span class="keyword">DECLARE</span> resultMapper text(<span class="number">10000</span>);             <span class="comment">-- 新增记录</span></span><br><span class="line"><span class="keyword">DECLARE</span> n  <span class="type">int</span>  <span class="keyword">DEFAULT</span> <span class="number">0</span> ;             <span class="comment">-- 总共的字段数</span></span><br><span class="line"><span class="keyword">DECLARE</span> i  <span class="type">int</span>  <span class="keyword">DEFAULT</span> <span class="number">0</span>;              <span class="comment">-- 循环时的变量</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">temporary</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span> tmp_sql2java(property_name <span class="type">varchar</span>(<span class="number">255</span>));</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> tmp_sql2java;</span><br><span class="line"><span class="keyword">SET</span> i = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">SET</span> str = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">SET</span> columnsStr = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">SET</span> insertColumnsStr = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">SET</span> propertyStr = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">SET</span> columnPropertyStr = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">SET</span> findByIdStr = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">SET</span> insertRecord = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">SET</span> selectCount =<span class="string">''</span>;      <span class="comment">-- 新增记录</span></span><br><span class="line"><span class="keyword">SET</span> findAll =<span class="string">''</span>;</span><br><span class="line"><span class="keyword">SET</span> property = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">SET</span> mapper = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">class</span> = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">SET</span> varClass = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">SET</span> resultMapper = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">CALL</span> generate_class_mapperClass_name(t_name,<span class="string">'Mapper'</span>,@mapperName);       <span class="comment">-- 通过表名称获取得到Mapper类名称</span></span><br><span class="line"><span class="keyword">CALL</span> generate_class_mapperClass_name(t_name,<span class="string">''</span>,@className);  <span class="comment">-- 通过表名称获取得到Model类名称</span></span><br><span class="line"><span class="keyword">SET</span> mapper = @mapperName;</span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">class</span> = @className;</span><br><span class="line"><span class="keyword">SET</span> head = CONCAT(</span><br><span class="line"><span class="string">'&lt;?xml version="1.0" encoding="UTF-8"?&gt;\n'</span>,</span><br><span class="line"><span class="string">'&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;\n'</span>,</span><br><span class="line"><span class="string">'&lt;mapper namespace="com.yourshares.entity.dao.'</span>,</span><br><span class="line">mapper,</span><br><span class="line"><span class="string">'"&gt;\n'</span>,</span><br><span class="line"><span class="string">'&lt;resultMap id="BaseResultMap" type="com.yourshares.entity.model.'</span>,</span><br><span class="line"><span class="keyword">class</span>,</span><br><span class="line"><span class="string">'"&gt;\n'</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">select</span> COUNT(*) <span class="keyword">into</span> n <span class="keyword">from</span> information_schema.<span class="keyword">columns</span> <span class="keyword">where</span> <span class="built_in">table_name</span> = t_name; <span class="comment">-- 总共的字段</span></span><br><span class="line"><span class="keyword">WHILE</span> i &lt;= n <span class="keyword">DO</span>                           <span class="comment">-- 循环</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">column_name</span> <span class="keyword">into</span> columnName <span class="keyword">from</span> information_schema.`<span class="keyword">columns</span>` <span class="keyword">where</span> <span class="built_in">table_name</span> = t_name <span class="keyword">and</span> ordinal_position=i;</span><br><span class="line"><span class="keyword">CALL</span> generate_property_name(columnName,@propertyName);    <span class="comment">-- 通过表字段获取得到属性名称</span></span><br><span class="line"><span class="keyword">SET</span>  property = @propertyName;              <span class="comment">-- 赋值</span></span><br><span class="line"><span class="keyword">CALL</span> generate_class_mapperClass_name(columnName,<span class="string">'Mapper'</span>,@varClassName);</span><br><span class="line"><span class="keyword">SET</span>  varClass = @varClassName;</span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">CONCAT(</span><br><span class="line">columnPropertyStr,</span><br><span class="line"><span class="keyword">case</span></span><br><span class="line"><span class="keyword">when</span> column_key <span class="keyword">in</span> (<span class="string">'PRI'</span>) <span class="keyword">then</span>  <span class="string">'&lt;id column="'</span> </span><br><span class="line"><span class="keyword">when</span> column_key <span class="keyword">not</span> <span class="keyword">in</span>  (<span class="string">'PRI'</span>,<span class="string">'MUL'</span>)   <span class="keyword">then</span>  <span class="string">'&lt;result column="'</span></span><br><span class="line"><span class="keyword">when</span> column_key <span class="keyword">in</span> (<span class="string">'MUL'</span>) <span class="keyword">then</span>  <span class="string">'&lt;association column="'</span></span><br><span class="line"><span class="keyword">end</span>,</span><br><span class="line"><span class="built_in">column_name</span>,</span><br><span class="line">CONCAT(<span class="string">'" property="'</span>, property, <span class="string">'"  '</span>),</span><br><span class="line"><span class="keyword">case</span></span><br><span class="line"><span class="keyword">when</span> column_key <span class="keyword">in</span> (<span class="string">'PRI'</span>) <span class="keyword">then</span> </span><br><span class="line">CONCAT(</span><br><span class="line"><span class="string">'jdbcType="'</span> ,</span><br><span class="line"><span class="keyword">case</span></span><br><span class="line"><span class="keyword">when</span> data_type <span class="keyword">in</span> (<span class="string">'int'</span>,<span class="string">'smallint'</span>) <span class="keyword">then</span> <span class="string">'INTEGER'</span></span><br><span class="line"><span class="keyword">else</span> UPPER(data_type)</span><br><span class="line"><span class="keyword">end</span>,</span><br><span class="line"><span class="string">'"  /&gt;\n'</span></span><br><span class="line">)</span><br><span class="line">  <span class="keyword">when</span> column_key <span class="keyword">not</span> <span class="keyword">in</span> (<span class="string">'PRI'</span>,<span class="string">'MUL'</span>) <span class="keyword">then</span> </span><br><span class="line">CONCAT(</span><br><span class="line"><span class="string">'jdbcType="'</span> ,</span><br><span class="line"><span class="keyword">case</span></span><br><span class="line"><span class="keyword">when</span> data_type <span class="keyword">in</span> (<span class="string">'int'</span>,<span class="string">'smallint'</span>) <span class="keyword">then</span> <span class="string">'INTEGER'</span></span><br><span class="line"><span class="keyword">else</span> UPPER(data_type)</span><br><span class="line"><span class="keyword">end</span>,</span><br><span class="line"><span class="string">'"  /&gt;\n'</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">when</span> column_key <span class="keyword">in</span> (<span class="string">'MUL'</span>) <span class="keyword">then</span> </span><br><span class="line">CONCAT(</span><br><span class="line"><span class="string">'select="com.yourshares.entity.dao.'</span>,</span><br><span class="line">@varClassName,</span><br><span class="line"><span class="string">'.findById"&gt;&lt;/association&gt;\n'</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">else</span> <span class="string">''</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">) <span class="keyword">into</span> columnPropertyStr </span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">information_schema.<span class="keyword">columns</span></span><br><span class="line"><span class="keyword">where</span></span><br><span class="line"><span class="built_in">table_name</span> = t_name <span class="keyword">and</span> ordinal_position=i;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> str = CONCAT(str,columnPropertyStr); <span class="comment">-- 拼接resultMap节点当中的子节点</span></span><br><span class="line"><span class="keyword">select</span> CONCAT(columnsStr,<span class="string">'a.'</span>,<span class="built_in">column_name</span>,<span class="string">','</span>) <span class="keyword">into</span> columnsStr <span class="keyword">from</span>  information_schema.<span class="keyword">columns</span> <span class="keyword">where</span> <span class="built_in">table_name</span> = t_name <span class="keyword">and</span> ordinal_position=i; <span class="comment">-- 所有字段列</span></span><br><span class="line"><span class="keyword">select</span> CONCAT(insertColumnsStr,<span class="built_in">column_name</span>,<span class="string">','</span>) <span class="keyword">into</span> insertColumnsStr <span class="keyword">from</span>  information_schema.<span class="keyword">columns</span> <span class="keyword">where</span> <span class="built_in">table_name</span> = t_name <span class="keyword">and</span> ordinal_position=i; <span class="comment">-- 所有字段列</span></span><br><span class="line"><span class="keyword">select</span> CONCAT(propertyStr,<span class="string">'#&#123;'</span>,property,<span class="string">'&#125;,'</span>) <span class="keyword">into</span> propertyStr <span class="keyword">from</span>  information_schema.<span class="keyword">columns</span> <span class="keyword">where</span> <span class="built_in">table_name</span> = t_name <span class="keyword">and</span> ordinal_position=i; <span class="comment">-- 所有属性列</span></span><br><span class="line"><span class="keyword">SET</span> i = i+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">END</span> <span class="keyword">WHILE</span>; </span><br><span class="line"><span class="keyword">SET</span> columnsStr = SUBSTRING(columnsStr,<span class="number">1</span>,LENGTH(columnsStr)<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">SET</span> propertyStr = SUBSTRING(propertyStr,<span class="number">1</span>,LENGTH(propertyStr)<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">SET</span> findByIdStr = CONCAT(</span><br><span class="line"><span class="string">'&lt;select id="findById" parameterType="java.lang.Integer" resultMap="BaseResultMap"&gt;\n'</span>,</span><br><span class="line"><span class="string">'select '</span>, columnsStr, <span class="string">' from '</span>, t_name, <span class="string">' a where a.id=#&#123;value&#125; \n'</span>,</span><br><span class="line"><span class="string">'&lt;/select&gt;\n'</span></span><br><span class="line">);  <span class="comment">-- 查询语句</span></span><br><span class="line"><span class="keyword">SET</span> insertRecord = CONCAT(</span><br><span class="line"><span class="string">'&lt;insert id="insertRecord" parameterType="com.yourshares.entity.model.'</span>, <span class="keyword">class</span>, <span class="string">'"&gt;\n'</span>,</span><br><span class="line"><span class="string">' insert into '</span>,t_name, <span class="string">'\n'</span>,<span class="string">'('</span>,insertColumnsStr,<span class="string">')\n'</span>, <span class="string">'values\n'</span>, <span class="string">'('</span>,propertyStr,<span class="string">')\n'</span>,</span><br><span class="line"><span class="string">'&lt;/insert&gt;\n'</span></span><br><span class="line">);  <span class="comment">-- 新增语句</span></span><br><span class="line"><span class="keyword">SET</span> selectCount = CONCAT(</span><br><span class="line"><span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">SET</span> selectCount = CONCAT(</span><br><span class="line"><span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">SET</span> resultMapper = CONCAT(</span><br><span class="line">head,</span><br><span class="line">columnPropertyStr,</span><br><span class="line"><span class="string">'&lt;/resultMap&gt;\n'</span>,</span><br><span class="line">findByIdStr,</span><br><span class="line">insertRecord,</span><br><span class="line">    <span class="string">'&lt;/mapper&gt;'</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">select</span> resultMapper;</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure><h3 id="生成类的名称，以及映射类的名称"><a href="#生成类的名称，以及映射类的名称" class="headerlink" title="生成类的名称，以及映射类的名称"></a>生成类的名称，以及映射类的名称</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DEFINER</span>=`<span class="keyword">admin</span>`@`%` <span class="keyword">PROCEDURE</span> `generate_class_mapperClass_name`(<span class="keyword">in</span> t_name <span class="type">varchar</span>(<span class="number">255</span>),<span class="keyword">in</span> split_joint_str <span class="type">varchar</span>(<span class="number">255</span>), <span class="keyword">out</span> property_name <span class="type">varchar</span>(<span class="number">255</span>))</span><br><span class="line"><span class="keyword">BEGIN</span> <span class="comment">-- 原来的 procedure - sql5java,现在改名为  generate_class_mapperClass_name,用于生成类名称或者是映射类的名称</span></span><br><span class="line">   <span class="keyword">DECLARE</span> n   <span class="type">int</span>  <span class="keyword">DEFAULT</span> <span class="number">0</span>; <span class="comment">-- 特殊字符总个数</span></span><br><span class="line"> <span class="keyword">DECLARE</span> i   <span class="type">int</span>  <span class="keyword">DEFAULT</span> <span class="number">0</span>; <span class="comment">-- 循环变量</span></span><br><span class="line"> <span class="keyword">DECLARE</span> ind <span class="type">int</span>  <span class="keyword">DEFAULT</span> <span class="number">0</span>; <span class="comment">-- 得到特殊字符的下标</span></span><br><span class="line"> <span class="keyword">DECLARE</span> left_str  <span class="type">varchar</span>(<span class="number">255</span>); <span class="comment">-- 左边的字符串</span></span><br><span class="line"> <span class="keyword">DECLARE</span> right_str <span class="type">varchar</span>(<span class="number">255</span>); <span class="comment">-- 右边的字符串</span></span><br><span class="line"> <span class="keyword">DECLARE</span> midd_char <span class="type">varchar</span>(<span class="number">255</span>); <span class="comment">-- 中间的那个需要修改的字符</span></span><br><span class="line"> <span class="keyword">DECLARE</span> str       <span class="type">varchar</span>(<span class="number">1024</span>); <span class="comment">-- 用于拼接的变量</span></span><br><span class="line"> <span class="keyword">DECLARE</span> first_str <span class="type">varchar</span>(<span class="number">255</span>); <span class="comment">-- 第一个字符</span></span><br><span class="line"> <span class="keyword">DECLARE</span> join_str  <span class="type">varchar</span>(<span class="number">255</span>); <span class="comment">-- 拼接进来的字符串</span></span><br><span class="line"> <span class="keyword">SET</span> i = <span class="number">1</span>;</span><br><span class="line"> <span class="keyword">SET</span> str = t_name;</span><br><span class="line"> <span class="keyword">SET</span> join_str = split_joint_str;</span><br><span class="line"> <span class="keyword">SET</span> n = length(str)-length(REPLACE(str,"_",""))+<span class="number">1</span>; <span class="comment">-- 总共有多少次需要进行替换以及大小写变化</span></span><br><span class="line">    <span class="keyword">WHILE</span> i &lt; n <span class="keyword">DO</span> </span><br><span class="line">    <span class="keyword">SET</span> ind = LENGTH(SUBSTRING_INDEX(str,<span class="string">'_'</span>,i)); <span class="comment">-- 特殊字符的下标</span></span><br><span class="line">  <span class="keyword">SET</span> left_str = CONCAT(SUBSTRING_INDEX(str,<span class="string">'_'</span>,i),<span class="string">'_'</span>); <span class="comment">-- 特殊字符左边的字符串</span></span><br><span class="line"><span class="keyword">SET</span> right_str = </span><br><span class="line">SUBSTRING(SUBSTRING_INDEX(str,<span class="string">'_'</span>,i-(n)),<span class="number">2</span>,LENGTH(SUBSTRING_INDEX(str,<span class="string">'_'</span>,i-(n)))); <span class="comment">-- 特殊字符右边的字符串</span></span><br><span class="line"><span class="keyword">SET</span> midd_char = UPPER(SUBSTRING(SUBSTRING_INDEX(str,<span class="string">'_'</span>,i-(n)),<span class="number">1</span>,<span class="number">1</span>)); <span class="comment">-- 需要变化成大写的字符</span></span><br><span class="line"><span class="keyword">SET</span> str = concat(left_str,midd_char,right_str); <span class="comment">-- 对str字符串变量进行重新赋值</span></span><br><span class="line"><span class="keyword">SET</span> i = i+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">WHILE</span>;</span><br><span class="line"><span class="keyword">SET</span> first_str = UPPER(SUBSTRING(str,<span class="number">1</span>,<span class="number">1</span>));</span><br><span class="line"><span class="keyword">SET</span> str = SUBSTRING(REPLACE(str,"_",""),<span class="number">2</span>);</span><br><span class="line"><span class="keyword">SET</span> property_name = CONCAT(first_str,str,join_str);</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure><h3 id="生成模型层model层的属性-区分大小写"><a href="#生成模型层model层的属性-区分大小写" class="headerlink" title="生成模型层model层的属性,区分大小写"></a>生成模型层model层的属性,区分大小写</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DEFINER</span>=`<span class="keyword">admin</span>`@`%` <span class="keyword">PROCEDURE</span> `generate_model_case`(<span class="keyword">in</span> t_name <span class="type">char</span>(<span class="number">255</span>))</span><br><span class="line"><span class="keyword">BEGIN</span>  <span class="comment">-- 原来的procedure - sql4java,现在改名为 generate_model_case,生成model层属性，属性名称驼峰处理</span></span><br><span class="line"><span class="keyword">DECLARE</span> columnName <span class="type">varchar</span>(<span class="number">1000</span>); <span class="comment">-- 字段名称</span></span><br><span class="line"><span class="keyword">DECLARE</span> property <span class="type">varchar</span>(<span class="number">5000</span>);   <span class="comment">-- 字段名称</span></span><br><span class="line"><span class="keyword">DECLARE</span> str <span class="type">varchar</span>(<span class="number">5000</span>);       <span class="comment">-- 字段名称</span></span><br><span class="line"><span class="keyword">DECLARE</span> n  <span class="type">int</span>  <span class="keyword">DEFAULT</span> <span class="number">0</span> ;     <span class="comment">-- 总共的字段数</span></span><br><span class="line"><span class="keyword">DECLARE</span> i  <span class="type">int</span>  <span class="keyword">DEFAULT</span> <span class="number">0</span>;      <span class="comment">-- 循环时的变量</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">temporary</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span> tmp_sql2java(property_name <span class="type">varchar</span>(<span class="number">5000</span>));</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> tmp_sql2java;</span><br><span class="line"><span class="keyword">SET</span> i = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">select</span> count(*) <span class="keyword">into</span> n <span class="keyword">from</span> information_schema.<span class="keyword">columns</span> <span class="keyword">where</span> <span class="built_in">table_name</span> = t_name;</span><br><span class="line"><span class="keyword">WHILE</span> i &lt;= n <span class="keyword">DO</span> </span><br><span class="line"><span class="keyword">select</span> <span class="built_in">column_name</span> <span class="keyword">into</span> columnName <span class="keyword">from</span> information_schema.`<span class="keyword">columns</span>` <span class="keyword">where</span> <span class="built_in">table_name</span> = t_name <span class="keyword">and</span> ordinal_position=i;</span><br><span class="line"><span class="keyword">CALL</span> generate_property_name(columnName,@propertyName);</span><br><span class="line"><span class="keyword">SET</span> property = @propertyName;</span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">    concat(</span><br><span class="line">         <span class="string">'/*'</span>,</span><br><span class="line">         column_comment,</span><br><span class="line">         <span class="string">'*/\n'</span>,</span><br><span class="line">        <span class="string">'private  '</span>,</span><br><span class="line">        <span class="keyword">case</span></span><br><span class="line">    <span class="keyword">when</span> data_type <span class="keyword">in</span> (<span class="string">'varchar'</span>, <span class="string">'char'</span>, <span class="string">'text'</span>) <span class="keyword">then</span></span><br><span class="line">        <span class="string">'String'</span></span><br><span class="line">    <span class="keyword">when</span> data_type <span class="keyword">in</span> (<span class="string">'int'</span>, <span class="string">'tinyint'</span>,<span class="string">'smallint'</span>) <span class="keyword">then</span></span><br><span class="line">        <span class="string">'Integer'</span></span><br><span class="line"><span class="keyword">when</span> data_type <span class="keyword">in</span> (<span class="string">'float'</span>, <span class="string">'double'</span>,<span class="string">'decimal'</span>) <span class="keyword">then</span></span><br><span class="line">        <span class="string">'BigDecimal'</span></span><br><span class="line">    <span class="keyword">when</span> data_type <span class="keyword">in</span> (<span class="string">'bigint'</span>) <span class="keyword">then</span></span><br><span class="line">        <span class="string">'Long'</span></span><br><span class="line">    <span class="keyword">when</span> data_type <span class="keyword">in</span> (<span class="string">'datetime'</span>) <span class="keyword">then</span></span><br><span class="line">        <span class="string">'Date'</span></span><br><span class="line">    <span class="keyword">when</span> data_type <span class="keyword">in</span> (<span class="string">'bit'</span>, <span class="string">'boolean'</span>) <span class="keyword">then</span></span><br><span class="line">        <span class="string">'Boolean'</span></span><br><span class="line"><span class="keyword">when</span> data_type <span class="keyword">in</span> (<span class="string">'double'</span>) <span class="keyword">then</span></span><br><span class="line">        <span class="string">'BigDecimal'</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="string">'类型不确定'</span></span><br><span class="line">    <span class="keyword">end</span>,</span><br><span class="line">    <span class="string">'  '</span>,</span><br><span class="line">    property,</span><br><span class="line">    <span class="string">';'</span></span><br><span class="line">    ) <span class="keyword">as</span> java <span class="keyword">into</span> str </span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">    information_schema. <span class="keyword">columns</span></span><br><span class="line"><span class="keyword">where</span></span><br><span class="line">    <span class="built_in">table_name</span> = t_name <span class="keyword">and</span> ordinal_position=i;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tmp_sql2java (property_name) <span class="keyword">values</span>(str); </span><br><span class="line"><span class="keyword">SET</span> i = i+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">END</span> <span class="keyword">WHILE</span>;</span><br><span class="line"><span class="keyword">select</span> property_name <span class="keyword">from</span> tmp_sql2java;</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure><h3 id="生成model层属性，不区分大小写"><a href="#生成model层属性，不区分大小写" class="headerlink" title="生成model层属性，不区分大小写"></a>生成model层属性，不区分大小写</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DEFINER</span>=`<span class="keyword">admin</span>`@`%` <span class="keyword">PROCEDURE</span> `generate_model_case`(<span class="keyword">in</span> t_name <span class="type">char</span>(<span class="number">255</span>))</span><br><span class="line"><span class="keyword">BEGIN</span>  <span class="comment">-- 原来的procedure - sql4java,现在改名为 generate_model_case,生成model层属性，属性名称驼峰处理</span></span><br><span class="line"><span class="keyword">DECLARE</span> columnName <span class="type">varchar</span>(<span class="number">1000</span>); <span class="comment">-- 字段名称</span></span><br><span class="line"><span class="keyword">DECLARE</span> property <span class="type">varchar</span>(<span class="number">5000</span>);   <span class="comment">-- 字段名称</span></span><br><span class="line"><span class="keyword">DECLARE</span> str <span class="type">varchar</span>(<span class="number">5000</span>);       <span class="comment">-- 字段名称</span></span><br><span class="line"><span class="keyword">DECLARE</span> n  <span class="type">int</span>  <span class="keyword">DEFAULT</span> <span class="number">0</span> ;     <span class="comment">-- 总共的字段数</span></span><br><span class="line"><span class="keyword">DECLARE</span> i  <span class="type">int</span>  <span class="keyword">DEFAULT</span> <span class="number">0</span>;      <span class="comment">-- 循环时的变量</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">temporary</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span> tmp_sql2java(property_name <span class="type">varchar</span>(<span class="number">5000</span>));</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> tmp_sql2java;</span><br><span class="line"><span class="keyword">SET</span> i = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">select</span> count(*) <span class="keyword">into</span> n <span class="keyword">from</span> information_schema.<span class="keyword">columns</span> <span class="keyword">where</span> <span class="built_in">table_name</span> = t_name;</span><br><span class="line"><span class="keyword">WHILE</span> i &lt;= n <span class="keyword">DO</span> </span><br><span class="line"><span class="keyword">select</span> <span class="built_in">column_name</span> <span class="keyword">into</span> columnName <span class="keyword">from</span> information_schema.`<span class="keyword">columns</span>` <span class="keyword">where</span> <span class="built_in">table_name</span> = t_name <span class="keyword">and</span> ordinal_position=i;</span><br><span class="line"><span class="keyword">CALL</span> generate_property_name(columnName,@propertyName);</span><br><span class="line"><span class="keyword">SET</span> property = @propertyName;</span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">    concat(</span><br><span class="line">         <span class="string">'/*'</span>,</span><br><span class="line">         column_comment,</span><br><span class="line">         <span class="string">'*/\n'</span>,</span><br><span class="line">        <span class="string">'private  '</span>,</span><br><span class="line">        <span class="keyword">case</span></span><br><span class="line">    <span class="keyword">when</span> data_type <span class="keyword">in</span> (<span class="string">'varchar'</span>, <span class="string">'char'</span>, <span class="string">'text'</span>) <span class="keyword">then</span></span><br><span class="line">        <span class="string">'String'</span></span><br><span class="line">    <span class="keyword">when</span> data_type <span class="keyword">in</span> (<span class="string">'int'</span>, <span class="string">'tinyint'</span>,<span class="string">'smallint'</span>) <span class="keyword">then</span></span><br><span class="line">        <span class="string">'Integer'</span></span><br><span class="line"><span class="keyword">when</span> data_type <span class="keyword">in</span> (<span class="string">'float'</span>, <span class="string">'double'</span>,<span class="string">'decimal'</span>) <span class="keyword">then</span></span><br><span class="line">        <span class="string">'BigDecimal'</span></span><br><span class="line">    <span class="keyword">when</span> data_type <span class="keyword">in</span> (<span class="string">'bigint'</span>) <span class="keyword">then</span></span><br><span class="line">        <span class="string">'Long'</span></span><br><span class="line">    <span class="keyword">when</span> data_type <span class="keyword">in</span> (<span class="string">'datetime'</span>) <span class="keyword">then</span></span><br><span class="line">        <span class="string">'Date'</span></span><br><span class="line">    <span class="keyword">when</span> data_type <span class="keyword">in</span> (<span class="string">'bit'</span>, <span class="string">'boolean'</span>) <span class="keyword">then</span></span><br><span class="line">        <span class="string">'Boolean'</span></span><br><span class="line"><span class="keyword">when</span> data_type <span class="keyword">in</span> (<span class="string">'double'</span>) <span class="keyword">then</span></span><br><span class="line">        <span class="string">'BigDecimal'</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="string">'类型不确定'</span></span><br><span class="line">    <span class="keyword">end</span>,</span><br><span class="line">    <span class="string">'  '</span>,</span><br><span class="line">    property,</span><br><span class="line">    <span class="string">';'</span></span><br><span class="line">    ) <span class="keyword">as</span> java <span class="keyword">into</span> str </span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">    information_schema. <span class="keyword">columns</span></span><br><span class="line"><span class="keyword">where</span></span><br><span class="line">    <span class="built_in">table_name</span> = t_name <span class="keyword">and</span> ordinal_position=i;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tmp_sql2java (property_name) <span class="keyword">values</span>(str); </span><br><span class="line"><span class="keyword">SET</span> i = i+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">END</span> <span class="keyword">WHILE</span>;</span><br><span class="line"><span class="keyword">select</span> property_name <span class="keyword">from</span> tmp_sql2java;</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure><h3 id="生成属性名称"><a href="#生成属性名称" class="headerlink" title="生成属性名称"></a>生成属性名称</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DEFINER</span>=`<span class="keyword">admin</span>`@`%` <span class="keyword">PROCEDURE</span> `generate_property_name`(<span class="keyword">in</span> <span class="built_in">column_name</span> <span class="type">varchar</span>(<span class="number">1000</span>),<span class="keyword">out</span> property_name <span class="type">varchar</span>(<span class="number">30</span>))</span><br><span class="line"><span class="keyword">BEGIN</span>  <span class="comment">-- 原来的procedure - sql3java,现在改名为 generate_property_name</span></span><br><span class="line">   <span class="keyword">DECLARE</span> n   <span class="type">int</span>  <span class="keyword">DEFAULT</span> <span class="number">0</span>; <span class="comment">-- 特殊字符总个数</span></span><br><span class="line"> <span class="keyword">DECLARE</span> i   <span class="type">int</span>  <span class="keyword">DEFAULT</span> <span class="number">0</span>; <span class="comment">-- 循环变量</span></span><br><span class="line"> <span class="keyword">DECLARE</span> ind <span class="type">int</span>  <span class="keyword">DEFAULT</span> <span class="number">0</span>; <span class="comment">-- 得到特殊字符的下标</span></span><br><span class="line"> <span class="keyword">DECLARE</span> left_str  <span class="type">varchar</span>(<span class="number">30</span>); <span class="comment">-- 左边的字符串</span></span><br><span class="line"> <span class="keyword">DECLARE</span> right_str <span class="type">varchar</span>(<span class="number">30</span>); <span class="comment">-- 右边的字符串</span></span><br><span class="line"> <span class="keyword">DECLARE</span> midd_char <span class="type">varchar</span>(<span class="number">30</span>); <span class="comment">-- 中间的那个需要修改的字符</span></span><br><span class="line"> <span class="keyword">DECLARE</span> str       <span class="type">varchar</span>(<span class="number">5000</span>); <span class="comment">-- 用于拼接的变量</span></span><br><span class="line"> <span class="keyword">SET</span> i = <span class="number">1</span>;</span><br><span class="line"> <span class="keyword">SET</span> str = <span class="built_in">column_name</span>;</span><br><span class="line"> <span class="keyword">SET</span> n = length(str)-length(REPLACE(str,"_",""))+<span class="number">1</span>; <span class="comment">-- 总共有多少次需要进行替换以及大小写变化</span></span><br><span class="line">    <span class="keyword">WHILE</span> i &lt; n <span class="keyword">DO</span> </span><br><span class="line">    <span class="keyword">SET</span> ind = LENGTH(SUBSTRING_INDEX(str,<span class="string">'_'</span>,i)); <span class="comment">-- 特殊字符的下标</span></span><br><span class="line">  <span class="keyword">SET</span> left_str = CONCAT(SUBSTRING_INDEX(str,<span class="string">'_'</span>,i),<span class="string">'_'</span>); <span class="comment">-- 特殊字符左边的字符串</span></span><br><span class="line"><span class="keyword">SET</span> right_str = </span><br><span class="line">SUBSTRING(SUBSTRING_INDEX(str,<span class="string">'_'</span>,i-(n)),<span class="number">2</span>,LENGTH(SUBSTRING_INDEX(str,<span class="string">'_'</span>,i-(n)))); <span class="comment">-- 特殊字符右边的字符串</span></span><br><span class="line"><span class="keyword">SET</span> midd_char = UPPER(SUBSTRING(SUBSTRING_INDEX(str,<span class="string">'_'</span>,i-(n)),<span class="number">1</span>,<span class="number">1</span>)); <span class="comment">-- 需要变化成大写的字符</span></span><br><span class="line"><span class="keyword">SET</span> str = concat(left_str,midd_char,right_str); <span class="comment">-- 对str字符串变量进行重新赋值</span></span><br><span class="line"><span class="keyword">SET</span> i = i+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">WHILE</span>;</span><br><span class="line"><span class="keyword">SET</span> property_name = REPLACE(str,"_","");</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure><h3 id="用于前端react使用"><a href="#用于前端react使用" class="headerlink" title="用于前端react使用"></a>用于前端react使用</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DEFINER</span>=`<span class="keyword">admin</span>`@`%` <span class="keyword">PROCEDURE</span> `generate_view_interface_model`(<span class="keyword">in</span> t_name <span class="type">char</span>(<span class="number">125</span>))</span><br><span class="line"><span class="keyword">BEGIN</span>  <span class="comment">-- 原来的procedure - sql7java, 用于前端生成基本属性映射，现在改名为  generate_view_interface_model</span></span><br><span class="line"><span class="keyword">DECLARE</span> columnName <span class="type">varchar</span>(<span class="number">1000</span>); <span class="comment">-- 字段名称</span></span><br><span class="line"><span class="keyword">DECLARE</span> <span class="keyword">class</span> <span class="type">varchar</span>(<span class="number">125</span>);</span><br><span class="line"><span class="keyword">DECLARE</span> property <span class="type">varchar</span>(<span class="number">5000</span>);   <span class="comment">-- 字段名称</span></span><br><span class="line"><span class="keyword">DECLARE</span> columnPropertyStr <span class="type">varchar</span>(<span class="number">5000</span>); <span class="comment">-- 列属性字符串变量</span></span><br><span class="line"><span class="keyword">DECLARE</span> resultInterface <span class="type">varchar</span>(<span class="number">5000</span>);             <span class="comment">-- 新增记录</span></span><br><span class="line"><span class="keyword">DECLARE</span> str <span class="type">varchar</span>(<span class="number">5000</span>);       <span class="comment">-- 字段名称</span></span><br><span class="line"><span class="keyword">DECLARE</span> n  <span class="type">int</span>  <span class="keyword">DEFAULT</span> <span class="number">0</span> ;     <span class="comment">-- 总共的字段数</span></span><br><span class="line"><span class="keyword">DECLARE</span> i  <span class="type">int</span>  <span class="keyword">DEFAULT</span> <span class="number">0</span>;      <span class="comment">-- 循环时的变量</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">temporary</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span> tmp_sql2java(property_name <span class="type">varchar</span>(<span class="number">5000</span>));</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> tmp_sql2java;</span><br><span class="line"><span class="keyword">SET</span> i = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">SET</span> columnPropertyStr = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">SET</span> str = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">SET</span> resultInterface = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">CALL</span> generate_class_mapperClass_name(t_name,<span class="string">''</span>,@className);</span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">class</span> = @className;</span><br><span class="line"><span class="keyword">select</span> count(*) <span class="keyword">into</span> n <span class="keyword">from</span> information_schema.<span class="keyword">columns</span> <span class="keyword">where</span> <span class="built_in">table_name</span> = t_name;</span><br><span class="line"><span class="keyword">WHILE</span> i &lt;= n <span class="keyword">DO</span> </span><br><span class="line"><span class="keyword">select</span> <span class="built_in">column_name</span> <span class="keyword">into</span> columnName <span class="keyword">from</span> information_schema.`<span class="keyword">columns</span>` <span class="keyword">where</span> <span class="built_in">table_name</span> = t_name <span class="keyword">and</span> ordinal_position=i;</span><br><span class="line"><span class="keyword">CALL</span> generate_property_name(columnName,@propertyName);</span><br><span class="line"><span class="keyword">SET</span> property = @propertyName;</span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">    concat(</span><br><span class="line">     <span class="string">'/*'</span>,</span><br><span class="line">         column_comment,</span><br><span class="line">         <span class="string">'*/\n'</span>,</span><br><span class="line">        property,</span><br><span class="line"><span class="keyword">case</span></span><br><span class="line">    <span class="keyword">when</span> is_nullable <span class="keyword">in</span> (<span class="string">'YES'</span>) <span class="keyword">then</span></span><br><span class="line">        <span class="string">'?'</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="string">''</span></span><br><span class="line"><span class="keyword">end</span>,</span><br><span class="line">":",</span><br><span class="line">    <span class="keyword">case</span></span><br><span class="line">    <span class="keyword">when</span> data_type <span class="keyword">in</span> (<span class="string">'varchar'</span>, <span class="string">'char'</span>, <span class="string">'text'</span>) <span class="keyword">then</span></span><br><span class="line">        <span class="string">'string'</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="string">'number'</span></span><br><span class="line">    <span class="keyword">end</span>,</span><br><span class="line">    <span class="string">';\n'</span></span><br><span class="line">    ) <span class="keyword">as</span> java <span class="keyword">into</span> columnPropertyStr </span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">    information_schema. <span class="keyword">columns</span></span><br><span class="line"><span class="keyword">where</span></span><br><span class="line">    <span class="built_in">table_name</span> = t_name <span class="keyword">and</span> ordinal_position=i;</span><br><span class="line"><span class="keyword">SET</span> str = CONCAT(str,columnPropertyStr);</span><br><span class="line"><span class="keyword">SET</span> i = i+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">END</span> <span class="keyword">WHILE</span>;</span><br><span class="line"><span class="keyword">SET</span> resultInterface = CONCAT(<span class="string">'export interface '</span>,<span class="keyword">class</span>,<span class="string">' &#123;\n'</span>,str,<span class="string">'&#125;'</span>);</span><br><span class="line"><span class="keyword">select</span> resultInterface;</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure><h3 id="分页"><a href="#分页" class="headerlink" title="分页"></a>分页</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">CREATE <span class="attribute">DEFINER</span>=`admin`@`%` PROCEDURE `page_helper`(<span class="keyword">in</span><span class="built_in"> page </span>int,<span class="keyword">in</span> pageSize int,<span class="keyword">in</span> sqlValue text(10000))</span><br><span class="line">BEGIN  -- 原来的procedure - sql12java,现在改名称为 page_helper</span><br><span class="line">DECLARE prepareSQL text(10000);</span><br><span class="line">DECLARE countSQL int<span class="built_in"> default </span>0;</span><br><span class="line">DECLARE count_sql text(10000);</span><br><span class="line">DECLARE select_sql text(10000);</span><br><span class="line"><span class="builtin-name">SET</span> count_sql = <span class="string">''</span>;</span><br><span class="line"><span class="builtin-name">SET</span> select_sql = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">IF</span><span class="built_in"> page </span>&lt; 1 THEN </span><br><span class="line"><span class="builtin-name">SET</span><span class="built_in"> page </span>= 1;</span><br><span class="line">END <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">IF</span> pageSize &lt; 0 THEN </span><br><span class="line"><span class="builtin-name">SET</span> pageSize = 10;</span><br><span class="line">END <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">SET</span> <span class="attribute">count_sql</span>=concat('select count(*) as count_sum <span class="keyword">from</span> ( <span class="string">',sqlValue,'</span> ) t<span class="string">');</span></span><br><span class="line"><span class="string">  SET @prepareCountSql = count_sql;</span></span><br><span class="line"><span class="string">prepare countSQL from @prepareCountSql; </span></span><br><span class="line"><span class="string">EXECUTE countSQL;           </span></span><br><span class="line"><span class="string">deallocate prepare countSQL;    </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">select page, pageSize as page_size;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">SET select_sql=concat(sqlValue,'</span>  limit <span class="string">',page*pageSize-pageSize,'</span>,<span class="string">',pageSize);</span></span><br><span class="line"><span class="string">-- select select_sql;</span></span><br><span class="line"><span class="string">SET @preparesql = select_sql;</span></span><br><span class="line"><span class="string">prepare prepareSQL from @preparesql; </span></span><br><span class="line"><span class="string">EXECUTE prepareSQL;           </span></span><br><span class="line"><span class="string">deallocate prepare prepareSQL;    </span></span><br><span class="line"><span class="string">END</span></span><br></pre></td></tr></table></figure><h3 id="通过供应商名称获取得到产品编号"><a href="#通过供应商名称获取得到产品编号" class="headerlink" title="通过供应商名称获取得到产品编号"></a>通过供应商名称获取得到产品编号</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DEFINER</span>=`<span class="keyword">admin</span>`@`%` <span class="keyword">PROCEDURE</span> `select_productId_by_supplierName`(<span class="keyword">in</span> keyValue <span class="type">varchar</span>(<span class="number">255</span>))</span><br><span class="line"><span class="keyword">BEGIN</span>  <span class="comment">-- 原来的procedure - sql8java,用于中台当中的产品管理当中的关键字查询，通过供应商名称查找得到供应商编号，再进行对比产品表当中存在有供应商为查询得到的供应商编号，则取出该产品编号，现在改名为 select_productId_by_supplierName</span></span><br><span class="line"><span class="keyword">DECLARE</span> n TINYINT(<span class="number">1</span>) <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">DECLARE</span> t_supplier_id <span class="type">int</span>; <span class="comment">-- t_supplier表当中通过模糊查询出来的供应商编号</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line"><span class="keyword">DECLARE</span> cur_1 <span class="keyword">CURSOR</span> <span class="keyword">FOR</span> <span class="keyword">select</span> t.id <span class="keyword">from</span> t_supplier t <span class="keyword">where</span> t.supplier_name <span class="keyword">like</span> keyValue <span class="keyword">and</span> t.`status`=<span class="string">'0'</span>;</span><br><span class="line"><span class="keyword">DECLARE</span> <span class="keyword">CONTINUE</span> <span class="keyword">HANDLER</span> <span class="keyword">FOR</span> <span class="keyword">NOT</span> <span class="built_in">FOUND</span> <span class="keyword">SET</span> n=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">temporary</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span> tmp_sql3java(product <span class="type">int</span>);<span class="comment">-- 该表的作用在于，如果存在有这样的产品则进行新增到该表当中最后进行查询该表即可</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> tmp_sql3java;</span><br><span class="line"></span><br><span class="line"><span class="keyword">open</span> cur_1;                               <span class="comment">-- 打开游标，开始第一轮的遍历循环，循环的内容是通过关键字模糊查询出来的所有供应商编号,过滤删除掉的</span></span><br><span class="line"><span class="keyword">WHILE</span> n&lt;&gt;<span class="number">1</span> <span class="keyword">DO</span></span><br><span class="line"><span class="keyword">FETCH</span> cur_1 <span class="keyword">INTO</span> t_supplier_id;    </span><br><span class="line"></span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line"><span class="keyword">DECLARE</span> nn TINYINT(<span class="number">1</span>) <span class="keyword">DEFAULT</span> <span class="number">0</span>;                    <span class="comment">-- 变量，代表的是t_product当中supplier_id字段不为空值的总条数</span></span><br><span class="line"><span class="keyword">DECLARE</span> supplier_ids <span class="type">varchar</span>(<span class="number">255</span>); <span class="comment">-- 进行查询出来供应商字段取值不为空的未进行拆分的supplierId字符串</span></span><br><span class="line"><span class="keyword">DECLARE</span> supp_id_value <span class="type">varchar</span>(<span class="number">255</span>);        <span class="comment">-- 新增入tmp_sql4java表的属性字段supp_id</span></span><br><span class="line"><span class="keyword">DECLARE</span> flag <span class="type">int</span>;                <span class="comment">-- 是否可以将产品编号进行新增到tmp_sql3java表当中的依据，如果大于0则新增当前循环的产品编号</span></span><br><span class="line"><span class="keyword">DECLARE</span> nnn <span class="type">int</span>;                  <span class="comment">-- supplier_ids字符串拆分成数组后的总长度</span></span><br><span class="line"><span class="keyword">DECLARE</span> iii <span class="type">int</span>;                  <span class="comment">-- 遍历supplier_ids拆分后数组的变量iii</span></span><br><span class="line"><span class="keyword">DECLARE</span> id_value <span class="type">int</span>;             <span class="comment">-- 新增入tmp_sql4java表的属性字段id</span></span><br><span class="line"><span class="keyword">DECLARE</span> supplier_id <span class="type">int</span>;           <span class="comment">-- 进行了拆分之后的supplierId编号</span></span><br><span class="line"><span class="keyword">DECLARE</span> product_id <span class="type">int</span>;            <span class="comment">-- 进行查询出来供应商字段取值不为空的产品编号</span></span><br><span class="line"><span class="keyword">DECLARE</span> cur_2 <span class="keyword">CURSOR</span> <span class="keyword">FOR</span> <span class="keyword">select</span> tt.id,tt.supplier_id <span class="keyword">from</span> t_product tt <span class="keyword">where</span> tt.supplier_id <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">and</span> tt.`status`=<span class="string">'0'</span>;</span><br><span class="line"><span class="keyword">DECLARE</span> <span class="keyword">CONTINUE</span> <span class="keyword">HANDLER</span> <span class="keyword">FOR</span> <span class="keyword">NOT</span> <span class="built_in">FOUND</span> <span class="keyword">SET</span> nn=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">open</span> cur_2;                               <span class="comment">-- 打开游标，开始第二轮的遍历循环,循环的内容是产品表当中所有supplier_id字段不为空的记录,过滤删除掉的</span></span><br><span class="line"><span class="keyword">WHILE</span> nn&lt;&gt;<span class="number">1</span> <span class="keyword">DO</span></span><br><span class="line"><span class="keyword">FETCH</span> cur_2 <span class="keyword">INTO</span> product_id,supplier_ids; <span class="comment">-- 获取数据产品编号以及供应商字段取值（未进行拆分的供应商编号字符串）</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">temporary</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span> tmp_sql4java(supp_id <span class="type">varchar</span>(<span class="number">255</span>));</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> tmp_sql4java;<span class="comment">-- 每当循环产品表一条记录则刷新一遍tmp_sql4java表，当中存的值是每一条产品表记录当中的supplier_ids字符串进行拆分出来的数值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> flag=<span class="number">0</span>;   <span class="comment">-- 首先先定义值为0</span></span><br><span class="line"><span class="keyword">SET</span> iii=<span class="number">1</span>;    <span class="comment">-- 赋初始值，赋值为1的原因是我是从1开始的，所以约定好从第一个开始，也就是@i,其实不要也行</span></span><br><span class="line"><span class="keyword">call</span> fieldValue_split_by_comma(supplier_ids);<span class="comment">-- 拆分之后进表</span></span><br><span class="line"><span class="keyword">SELECT</span> count(*) <span class="keyword">into</span> nnn <span class="keyword">FROM</span> tmp_sql5java; <span class="comment">-- 为nnn进行赋值</span></span><br><span class="line"><span class="keyword">while</span> iii &lt;= nnn <span class="keyword">DO</span> <span class="comment">-- 进行循环遍历拆分supplierIds的数组</span></span><br><span class="line"><span class="keyword">SELECT</span> s_id <span class="keyword">into</span> supp_id_value </span><br><span class="line"><span class="keyword">FROM</span>  </span><br><span class="line">tmp_sql5java </span><br><span class="line"><span class="keyword">WHERE</span> </span><br><span class="line">num=iii;</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> tmp_sql4java <span class="keyword">values</span> (supp_id_value);</span><br><span class="line"><span class="keyword">SET</span> iii=iii+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">while</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> count(*) <span class="keyword">into</span> flag <span class="keyword">from</span> tmp_sql4java  <span class="keyword">where</span> tmp_sql4java.supp_id=t_supplier_id;</span><br><span class="line"><span class="keyword">if</span>(flag&gt;<span class="number">0</span>) <span class="keyword">THEN</span> <span class="comment">-- 如果存在有拆分出来的供应商编号与模糊查找出来的供应商编号对应的上的话则</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tmp_sql3java <span class="keyword">values</span>(product_id);<span class="comment">-- 将当前循环到的该产品编号存入临时表当中，否则不作处理</span></span><br><span class="line"><span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span> <span class="keyword">while</span>; #结束循环</span><br><span class="line"><span class="keyword">close</span> cur_2; #关闭游标<span class="number">2</span></span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"> <span class="keyword">end</span> <span class="keyword">while</span>; #结束循环</span><br><span class="line"> <span class="keyword">close</span> cur_1; #关闭游标<span class="number">1</span></span><br><span class="line"> <span class="keyword">END</span>;</span><br><span class="line">    <span class="comment">-- select product from tmp_sql3java;</span></span><br><span class="line">  <span class="keyword">END</span></span><br></pre></td></tr></table></figure><h3 id="通过供应商编号获取产品编号"><a href="#通过供应商编号获取产品编号" class="headerlink" title="通过供应商编号获取产品编号"></a>通过供应商编号获取产品编号</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DEFINER</span>=`<span class="keyword">admin</span>`@`%` <span class="keyword">PROCEDURE</span> `select_productId_by_supplierId`(<span class="keyword">in</span> keyValue <span class="type">int</span>)</span><br><span class="line"><span class="keyword">BEGIN</span>   <span class="comment">-- 通过供应商编号进行查找 产品对应有供应商编号的产品编号</span></span><br><span class="line"><span class="keyword">DECLARE</span> n <span class="type">int</span>;</span><br><span class="line"><span class="keyword">DECLARE</span> i <span class="type">int</span>;</span><br><span class="line"><span class="keyword">DECLARE</span> t_supplier_id <span class="type">int</span>; <span class="comment">-- t_supplier表当中通过模糊查询出来的供应商编号</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line"><span class="keyword">DECLARE</span> cur_1 <span class="keyword">CURSOR</span> <span class="keyword">FOR</span> <span class="keyword">select</span> t.id <span class="keyword">from</span> t_supplier t <span class="keyword">where</span> t.id = keyValue <span class="keyword">and</span> t.`status`=<span class="string">'0'</span>;</span><br><span class="line"><span class="keyword">SET</span> i=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">select</span> count(*) <span class="keyword">into</span> n <span class="keyword">from</span>  t_supplier t <span class="keyword">where</span> t.id = keyValue <span class="keyword">and</span> t.`status`=<span class="string">'0'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">temporary</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span> tmp_sql3java(product <span class="type">int</span>);<span class="comment">-- 该表的作用在于，如果存在有这样的产品则进行新增到该表当中最后进行查询该表即可</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> tmp_sql3java;</span><br><span class="line"></span><br><span class="line"><span class="keyword">open</span> cur_1;                               <span class="comment">-- 打开游标，开始第一轮的遍历循环，循环的内容是通过关键字模糊查询出来的所有供应商编号,过滤删除掉的</span></span><br><span class="line"><span class="keyword">WHILE</span> i&lt;=n <span class="keyword">DO</span></span><br><span class="line"><span class="keyword">FETCH</span> cur_1 <span class="keyword">INTO</span> t_supplier_id;  </span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line"><span class="keyword">DECLARE</span> nn TINYINT(<span class="number">1</span>) <span class="keyword">DEFAULT</span> <span class="number">0</span>;                    <span class="comment">-- 变量，代表的是t_product当中supplier_id字段不为空值的总条数</span></span><br><span class="line"><span class="keyword">DECLARE</span> supplier_ids <span class="type">varchar</span>(<span class="number">255</span>); <span class="comment">-- 进行查询出来供应商字段取值不为空的未进行拆分的supplierId字符串</span></span><br><span class="line"><span class="keyword">DECLARE</span> supp_id_value <span class="type">varchar</span>(<span class="number">255</span>);        <span class="comment">-- 新增入tmp_sql4java表的属性字段supp_id</span></span><br><span class="line"><span class="keyword">DECLARE</span> flag <span class="type">int</span>;                <span class="comment">-- 是否可以将产品编号进行新增到tmp_sql4java表当中的依据，如果大于0则新增当前循环的产品编号</span></span><br><span class="line"><span class="keyword">DECLARE</span> nnn <span class="type">int</span>;                  <span class="comment">-- supplier_ids字符串拆分成数组后的总长度</span></span><br><span class="line"><span class="keyword">DECLARE</span> iii <span class="type">int</span>;                  <span class="comment">-- 遍历supplier_ids拆分后数组的变量iii</span></span><br><span class="line"><span class="keyword">DECLARE</span> id_value <span class="type">int</span>;             <span class="comment">-- 新增入tmp_sql4java表的属性字段id</span></span><br><span class="line"><span class="keyword">DECLARE</span> supplier_id <span class="type">int</span>;           <span class="comment">-- 进行了拆分之后的supplierId编号</span></span><br><span class="line"><span class="keyword">DECLARE</span> product_id <span class="type">int</span>;            <span class="comment">-- 进行查询出来供应商字段取值不为空的产品编号</span></span><br><span class="line"> <span class="keyword">DECLARE</span> cur_2 <span class="keyword">CURSOR</span> <span class="keyword">FOR</span> <span class="keyword">select</span> tt.id,tt.supplier_id <span class="keyword">from</span> t_product tt <span class="keyword">where</span> tt.supplier_id <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">and</span> tt.`status`=<span class="string">'0'</span>;</span><br><span class="line"> <span class="keyword">DECLARE</span> <span class="keyword">CONTINUE</span> <span class="keyword">HANDLER</span> <span class="keyword">FOR</span> <span class="keyword">NOT</span> <span class="built_in">FOUND</span> <span class="keyword">SET</span> nn=<span class="number">1</span>;</span><br><span class="line"> <span class="keyword">open</span> cur_2;                               <span class="comment">-- 打开游标，开始第二轮的遍历循环,循环的内容是产品表当中所有supplier_id字段不为空的记录,过滤删除掉的</span></span><br><span class="line"> <span class="keyword">WHILE</span> nn&lt;&gt;<span class="number">1</span> <span class="keyword">DO</span></span><br><span class="line"> <span class="keyword">FETCH</span> cur_2 <span class="keyword">INTO</span> product_id,supplier_ids; <span class="comment">-- 获取数据产品编号以及供应商字段取值（未进行拆分的供应商编号字符串）</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">temporary</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span> tmp_sql4java(supp_id <span class="type">varchar</span>(<span class="number">255</span>));</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> tmp_sql4java;<span class="comment">-- 每当循环产品表一条记录则刷新一遍tmp_sql4java表，当中存的值是每一条产品表记录当中的supplier_ids字符串进行拆分出来的数值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> flag=<span class="number">0</span>;   <span class="comment">-- 首先先定义值为0</span></span><br><span class="line"><span class="keyword">SET</span> iii=<span class="number">1</span>;    <span class="comment">-- 赋初始值，赋值为1的原因是我是从1开始的，所以约定好从第一个开始，也就是@i,其实不要也行</span></span><br><span class="line"><span class="keyword">call</span> fieldValue_split_by_comma(supplier_ids);<span class="comment">-- 拆分之后进表</span></span><br><span class="line"><span class="keyword">SELECT</span> count(*) <span class="keyword">into</span> nnn <span class="keyword">FROM</span> tmp_sql5java; <span class="comment">-- 为nnn进行赋值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> iii &lt;= nnn <span class="keyword">DO</span> <span class="comment">-- 进行循环遍历拆分supplierIds的数组</span></span><br><span class="line"><span class="keyword">SELECT</span> s_id <span class="keyword">into</span> supp_id_value </span><br><span class="line"><span class="keyword">FROM</span>  </span><br><span class="line">tmp_sql5java </span><br><span class="line"><span class="keyword">WHERE</span> </span><br><span class="line">num=iii;</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> tmp_sql4java <span class="keyword">values</span> (supp_id_value);</span><br><span class="line"><span class="keyword">SET</span> iii=iii+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">while</span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">select</span> count(*) <span class="keyword">into</span> flag <span class="keyword">from</span> tmp_sql4java  <span class="keyword">where</span> tmp_sql4java.supp_id=t_supplier_id;</span><br><span class="line"> <span class="keyword">IF</span>(flag&gt;<span class="number">0</span>) <span class="keyword">THEN</span> <span class="comment">-- 如果存在有拆分出来的供应商编号与模糊查找出来的供应商编号对应的上的话则</span></span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> tmp_sql3java <span class="keyword">values</span>(product_id);<span class="comment">-- 将当前循环到的该产品编号存入临时表当中，否则不作处理</span></span><br><span class="line"> <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">end</span> <span class="keyword">while</span>; #结束循环</span><br><span class="line"> <span class="keyword">close</span> cur_2; #关闭游标<span class="number">2</span></span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"><span class="keyword">SET</span> i=i+<span class="number">1</span>;</span><br><span class="line"> <span class="keyword">end</span> <span class="keyword">while</span>; #结束循环</span><br><span class="line"> <span class="keyword">close</span> cur_1; #关闭游标<span class="number">1</span></span><br><span class="line"> <span class="keyword">END</span>;</span><br><span class="line">    <span class="comment">-- select product from tmp_sql3java;</span></span><br><span class="line">  <span class="keyword">END</span></span><br></pre></td></tr></table></figure><h3 id="通过供应商编号获取得到产品"><a href="#通过供应商编号获取得到产品" class="headerlink" title="通过供应商编号获取得到产品"></a>通过供应商编号获取得到产品</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DEFINER</span>=`<span class="keyword">admin</span>`@`%` <span class="keyword">PROCEDURE</span> `select_products_by_supplierId`(<span class="keyword">in</span> supplier_id <span class="type">int</span>)</span><br><span class="line"><span class="keyword">BEGIN</span> <span class="comment">-- 原来的procedure - sql10java,现在改名称为 select_product_by_params</span></span><br><span class="line"><span class="keyword">DECLARE</span> n <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">DECLARE</span> s <span class="type">int</span> <span class="keyword">default</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">DECLARE</span> i <span class="type">int</span>;</span><br><span class="line"><span class="keyword">DECLARE</span> productNo <span class="type">int</span>;</span><br><span class="line"><span class="keyword">DECLARE</span> str <span class="type">varchar</span>(<span class="number">256</span>);</span><br><span class="line"><span class="keyword">DECLARE</span> concatSQL <span class="type">varchar</span>(<span class="number">256</span>);</span><br><span class="line"><span class="keyword">DECLARE</span> sqls text(<span class="number">10000</span>);</span><br><span class="line"><span class="keyword">DECLARE</span> prepareSQL text(<span class="number">10000</span>);</span><br><span class="line">#将局部变量转换成会话变量</span><br><span class="line">#动态<span class="keyword">sql</span>语言只接受会话变量</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> i=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">SET</span> str=<span class="string">''</span>;</span><br><span class="line"><span class="keyword">SET</span> concatSQL=<span class="string">''</span>;</span><br><span class="line"><span class="keyword">SET</span> sqls=<span class="string">''</span>;</span><br><span class="line"> <span class="keyword">call</span> select_productId_by_supplierId(supplier_id);</span><br><span class="line">  <span class="keyword">select</span> count(*) <span class="keyword">into</span> n <span class="keyword">from</span> tmp_sql3java;</span><br><span class="line"> <span class="keyword">if</span> n&gt;<span class="number">0</span> <span class="keyword">then</span> </span><br><span class="line"> <span class="keyword">BEGIN</span></span><br><span class="line"> <span class="keyword">DECLARE</span> cur_3 <span class="keyword">CURSOR</span> <span class="keyword">FOR</span> <span class="keyword">select</span> product <span class="keyword">from</span> tmp_sql3java;</span><br><span class="line"> <span class="keyword">open</span> cur_3;</span><br><span class="line"><span class="keyword">while</span> i&lt;=n <span class="keyword">do</span></span><br><span class="line"> <span class="keyword">fetch</span> cur_3 <span class="keyword">into</span> productNo;</span><br><span class="line"> <span class="keyword">SET</span> str=concat(str,productNo,",");</span><br><span class="line"><span class="keyword">SET</span> i=i+<span class="number">1</span>;</span><br><span class="line"> <span class="keyword">end</span> <span class="keyword">while</span>;</span><br><span class="line"><span class="keyword">SET</span> str= substring(str, <span class="number">1</span>, length(str)<span class="number">-1</span>);</span><br><span class="line"> <span class="keyword">close</span> cur_3;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">SET</span> concatSQL=concat(" and b.id in(",str,")");</span><br><span class="line"> <span class="keyword">END</span>;</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line"><span class="keyword">SET</span> sqls = concat(</span><br><span class="line"><span class="string">'select       </span></span><br><span class="line"><span class="string">  a.id, a.product_id, a.image, a.`name`, a.zh_name, </span></span><br><span class="line"><span class="string"> a.customs_code, a.unit_price, a.sku, a.fn_sku_no, </span></span><br><span class="line"><span class="string"> a.fn_sku_code, a.packing_size_long, a.packing_size_wide, </span></span><br><span class="line"><span class="string"> a.packing_size_height, a.box_weight, a.packing_num, a.card_board_load_num, </span></span><br><span class="line"><span class="string"> a.product_long, a.product_width, a.product_height, a.product_weight, </span></span><br><span class="line"><span class="string"> a.cal_unit,purpose, a.brand_info, a.material, a.model, </span></span><br><span class="line"><span class="string"> a.remark, a.attr_name, a.attr_value, a.`status` </span></span><br><span class="line"><span class="string">from t_product_attr a,t_product b </span></span><br><span class="line"><span class="string">where</span></span><br><span class="line"><span class="string">a.product_id=b.id </span></span><br><span class="line"><span class="string">and a.`status`=0 '</span>,</span><br><span class="line">concatSQL</span><br><span class="line">);</span><br><span class="line">  <span class="comment">-- select sqls;</span></span><br><span class="line">   <span class="keyword">SET</span> @preparesql = sqls;</span><br><span class="line">   <span class="keyword">prepare</span> prepareSQL <span class="keyword">from</span> @preparesql; <span class="comment">-- 预处理需要执行的动态SQL，其中stmt是一个变量</span></span><br><span class="line">   <span class="keyword">EXECUTE</span> prepareSQL;           <span class="comment">-- 执行SQL语句</span></span><br><span class="line">   <span class="keyword">deallocate</span> <span class="keyword">prepare</span> prepareSQL;     <span class="comment">-- 释放掉预处理段</span></span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure><h3 id="渠道订单报表"><a href="#渠道订单报表" class="headerlink" title="渠道订单报表"></a>渠道订单报表</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DEFINER</span>=`<span class="keyword">admin</span>`@`%` <span class="keyword">PROCEDURE</span> `view_channel_order_report`(<span class="keyword">in</span> channelOrderId <span class="type">int</span>(<span class="number">11</span>))</span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line"><span class="keyword">DECLARE</span> step_id <span class="type">int</span>;</span><br><span class="line"><span class="keyword">DECLARE</span> n <span class="type">int</span>;</span><br><span class="line"><span class="keyword">DECLARE</span> i <span class="type">int</span>;</span><br><span class="line"><span class="keyword">DECLARE</span> step_finished_date <span class="type">int</span>;</span><br><span class="line"><span class="keyword">DECLARE</span> id2 <span class="type">int</span>;</span><br><span class="line"><span class="keyword">DECLARE</span> step_name2 <span class="type">VARCHAR</span>(<span class="number">255</span>);</span><br><span class="line"><span class="keyword">DECLARE</span> is_delay2 <span class="type">VARCHAR</span>(<span class="number">255</span>);</span><br><span class="line"><span class="keyword">DECLARE</span> standard_time2 <span class="type">int</span>;</span><br><span class="line"><span class="keyword">DECLARE</span> actual_delay2 <span class="type">VARCHAR</span>(<span class="number">64</span>);</span><br><span class="line"><span class="keyword">DECLARE</span> cur_step <span class="keyword">CURSOR</span> <span class="keyword">FOR</span> <span class="keyword">select</span> id <span class="keyword">from</span> t_channel_order_step <span class="keyword">where</span> channel_order_id=channelOrderId;</span><br><span class="line"><span class="keyword">select</span> count(*) <span class="keyword">into</span> n <span class="keyword">from</span> t_channel_order_step <span class="keyword">where</span> channel_order_id=channelOrderId;</span><br><span class="line"><span class="keyword">SET</span> i=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">temporary</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span> tmp_channel_order_report(</span><br><span class="line">id <span class="type">int</span>(<span class="number">11</span>), step_name <span class="type">varchar</span>(<span class="number">255</span>), is_delay <span class="type">varchar</span>(<span class="number">255</span>), standard_time <span class="type">int</span>(<span class="number">11</span>), actual_delay <span class="type">varchar</span>(<span class="number">64</span>) );</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> tmp_channel_order_report;</span><br><span class="line"><span class="keyword">open</span> cur_step;</span><br><span class="line"><span class="keyword">WHILE</span> i&lt;n <span class="keyword">DO</span></span><br><span class="line"><span class="keyword">fetch</span> cur_step <span class="keyword">into</span> step_id;</span><br><span class="line"><span class="keyword">call</span> last_step_finished_date(step_id,step_finished_date);<span class="comment">-- 当前步骤id的上一步骤完成时间</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">id,`<span class="type">name</span>`,standard_time,</span><br><span class="line"><span class="keyword">if</span>(finished_date <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>, </span><br><span class="line"> ROUND((finished_date-step_finished_date)/<span class="number">3600</span>,<span class="number">1</span>),</span><br><span class="line"> <span class="keyword">if</span>(activity=<span class="number">1</span>, ROUND((unix_timestamp(now())-step_finished_date)/<span class="number">3600</span>,<span class="number">1</span>), <span class="string">'-'</span>)</span><br><span class="line">) <span class="keyword">as</span> actual_delay,</span><br><span class="line"><span class="keyword">if</span>(finished_date <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>, </span><br><span class="line"> <span class="keyword">if</span>(ROUND((finished_date-step_finished_date)/<span class="number">3600</span>,<span class="number">1</span>)&gt;standard_time,<span class="string">'是'</span>,<span class="string">'否'</span>),</span><br><span class="line"> <span class="keyword">if</span>(activity=<span class="number">1</span>,  <span class="keyword">if</span>(ROUND((unix_timestamp(now())-step_finished_date)/<span class="number">3600</span>,<span class="number">1</span>)&gt;standard_time,<span class="string">'是'</span>,<span class="string">'否'</span>), <span class="string">'否'</span>)</span><br><span class="line">) <span class="keyword">as</span> is_delay</span><br><span class="line"></span><br><span class="line"><span class="keyword">into</span> id2,step_name2,standard_time2,actual_delay2,is_delay2  </span><br><span class="line"><span class="keyword">from</span> t_channel_order_step <span class="keyword">where</span> id=step_id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tmp_channel_order_report <span class="keyword">values</span>(id2,step_name2,is_delay2,standard_time2,actual_delay2);</span><br><span class="line"><span class="keyword">SET</span> i=i+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">END</span> <span class="keyword">WHILE</span>;</span><br><span class="line"><span class="keyword">close</span> cur_step;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tmp_channel_order_report;</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure><h3 id="序列"><a href="#序列" class="headerlink" title="序列"></a>序列</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DEFINER=<span class="string">`admin`</span>@<span class="string">`%`</span> <span class="keyword">FUNCTION</span> <span class="string">`currval`</span>(seq_name <span class="built_in">VARCHAR</span>(<span class="number">50</span>)) <span class="keyword">RETURNS</span> <span class="built_in">int</span>(<span class="number">11</span>)</span><br><span class="line">    <span class="keyword">DETERMINISTIC</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">     <span class="keyword">DECLARE</span> <span class="keyword">value</span> <span class="built_in">INTEGER</span>; </span><br><span class="line">     <span class="keyword">SET</span> <span class="keyword">value</span> = <span class="number">0</span>; </span><br><span class="line">     <span class="keyword">SELECT</span> current_value <span class="keyword">INTO</span> <span class="keyword">value</span> </span><br><span class="line">          <span class="keyword">FROM</span> <span class="keyword">sequence</span></span><br><span class="line">          <span class="keyword">WHERE</span> <span class="keyword">name</span> = seq_name; </span><br><span class="line">     RETURN value; </span><br><span class="line"><span class="keyword">END</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> DEFINER=<span class="string">`admin`</span>@<span class="string">`%`</span> <span class="keyword">FUNCTION</span> <span class="string">`nextval`</span>(seq_name <span class="built_in">VARCHAR</span>(<span class="number">50</span>)) <span class="keyword">RETURNS</span> <span class="built_in">int</span>(<span class="number">11</span>)</span><br><span class="line">    <span class="keyword">DETERMINISTIC</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">     <span class="keyword">UPDATE</span> <span class="keyword">sequence</span></span><br><span class="line">          <span class="keyword">SET</span> current_value = current_value + <span class="keyword">increment</span> </span><br><span class="line">          <span class="keyword">WHERE</span> <span class="keyword">name</span> = seq_name; </span><br><span class="line">     RETURN currval(seq_name); </span><br><span class="line"><span class="keyword">END</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> DEFINER=<span class="string">`admin`</span>@<span class="string">`%`</span> <span class="keyword">FUNCTION</span> <span class="string">`setval`</span>(seq_name <span class="built_in">VARCHAR</span>(<span class="number">50</span>), <span class="keyword">value</span> <span class="built_in">INTEGER</span>) <span class="keyword">RETURNS</span> <span class="built_in">int</span>(<span class="number">11</span>)</span><br><span class="line">    <span class="keyword">DETERMINISTIC</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">     <span class="keyword">UPDATE</span> <span class="keyword">sequence</span></span><br><span class="line">          <span class="keyword">SET</span> current_value = <span class="keyword">value</span> </span><br><span class="line">          <span class="keyword">WHERE</span> <span class="keyword">name</span> = seq_name; </span><br><span class="line">     RETURN currval(seq_name); </span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;记录&quot;&gt;&lt;a href=&quot;#记录&quot; class=&quot;headerlink&quot; title=&quot;记录&quot;&gt;&lt;/a&gt;记录&lt;/h2&gt;&lt;p&gt;在领赫这个项目当中，方便敏捷式开发的存储过程pojo-model层以及mapper的编写。  &lt;/p&gt;
&lt;h3 id=&quot;david指导&quot;&gt;&lt;
      
    
    </summary>
    
    
      <category term="领赫" scheme="https://fengshana.github.io/categories/%E9%A2%86%E8%B5%AB/"/>
    
    
      <category term="领赫" scheme="https://fengshana.github.io/tags/%E9%A2%86%E8%B5%AB/"/>
    
      <category term="存储过程" scheme="https://fengshana.github.io/tags/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B/"/>
    
      <category term="Sql" scheme="https://fengshana.github.io/tags/Sql/"/>
    
      <category term="MySql" scheme="https://fengshana.github.io/tags/MySql/"/>
    
  </entry>
  
  <entry>
    <title>前端页面双色球3</title>
    <link href="https://fengshana.github.io/2020/04/15/%E9%9D%A2%E8%AF%95%E9%A2%98/%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E6%94%B9%E8%BF%9B3/"/>
    <id>https://fengshana.github.io/2020/04/15/%E9%9D%A2%E8%AF%95%E9%A2%98/%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E6%94%B9%E8%BF%9B3/</id>
    <published>2020-04-14T19:47:56.000Z</published>
    <updated>2020-04-14T18:37:38.514Z</updated>
    
    <content type="html"><![CDATA[<h2 id="需求内容"><a href="#需求内容" class="headerlink" title="需求内容"></a>需求内容</h2><p><a href="https://github.com/fengshana/Mamai" target="_blank" rel="noopener">https://github.com/fengshana/Mamai</a>  </p><ol><li>分页加个页码</li><li>这个10出过了很多期的，最近的这一期130，4.10，到今天最新的一期不管数值多少，为止已经多少期没出了，求差值</li><li>把搜索的数字加个红色也行</li></ol><h3 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h3><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANX0OntByQ9RopVFKqFo2EAAP.w*ru3lHqrrQXKPPvOiJcpxdOfhwHYah.is4YlEKT.jSTullaIqHR6PMItPvTZnk!/r" alt="image"><br><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANX6NdBhxBRYBUy.T6WIURM8FztiZEk0bzwnUWuk2wwu0zeYpSbcbz.bcVfsU6GZo8tyfIU60tglNtx0E4zdfuFgM!/r" alt="image"><br><img src="http://r.photo.store.qq.com/psc?/V13IdniL0W0T32/TCfiP1YaPeRT4Jil9RANX.hsLuSnbnm1WocRcndLv9YK0y2Ojuh2G*eAAF14QcltwhNkZ.r8foxuxlNiqT.LK0X4HY7fncWH*Ik9RrigLc8!/r" alt="image"></p><h3 id="接触docker并部署项目"><a href="#接触docker并部署项目" class="headerlink" title="接触docker并部署项目"></a>接触docker并部署项目</h3><p>这边是将项目打包成jar包部署linux环境当中的docker容器内</p><p>参考Blog：</p><ul><li><a href="https://www.jianshu.com/p/397929dbc27d" target="_blank" rel="noopener">https://www.jianshu.com/p/397929dbc27d</a></li></ul><p>相关命令：</p><p>docker ps -a<br>docker images<br>docker stop 镜像的名称<br>docker start 镜像的名称</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">432 </span> cd ../logs/</span><br><span class="line"><span class="symbol">433 </span> tail -<span class="number">300</span>f access.<span class="keyword">log</span></span><br><span class="line"><span class="symbol">434 </span> ../sbin/nginx -s quit</span><br><span class="line"><span class="symbol">435 </span> ../sbin/nginx -s <span class="keyword">stop</span></span><br><span class="line"><span class="symbol">436 </span> cd ../conf</span><br><span class="line"><span class="symbol">437 </span> vim nginx.conf</span><br><span class="line"><span class="symbol">438 </span> ../sbin/nginx -s reload</span><br><span class="line"><span class="symbol">439 </span> /<span class="keyword">usr</span>/local/nginx/sbin/nginx -c /<span class="keyword">usr</span>/local/nginx/conf/nginx.conf</span><br><span class="line"><span class="symbol">440 </span> ../sbin/nginx -s reload</span><br><span class="line"><span class="symbol">441 </span> vim nginx.conf</span><br><span class="line"><span class="symbol">442 </span> ../sbin/nginx -s reload</span><br><span class="line"><span class="symbol">443 </span> vim nginx.conf</span><br><span class="line"><span class="symbol">444 </span> ../sbin/nginx  -s reload</span><br><span class="line"><span class="symbol">445 </span> vim nginx.conf</span><br><span class="line"><span class="symbol">446 </span> cd </span><br><span class="line"><span class="symbol">447 </span> ll</span><br><span class="line"><span class="symbol">448 </span> cd apache-tomcat-<span class="number">8.5.51</span>/</span><br><span class="line"><span class="symbol">449 </span> ll</span><br><span class="line"><span class="symbol">450 </span> ccd logs/</span><br><span class="line"><span class="symbol">451 </span> ll</span><br><span class="line"><span class="symbol">452 </span> cd logs/</span><br><span class="line"><span class="symbol">453 </span> ll</span><br><span class="line"><span class="symbol">454 </span> cd ..</span><br><span class="line"><span class="symbol">455 </span> ll</span><br><span class="line"><span class="symbol">456 </span> cd ..</span><br><span class="line"><span class="symbol">457 </span> ll</span><br><span class="line"><span class="symbol">458 </span> more install.sh </span><br><span class="line"><span class="symbol">459 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">460 </span> cd /<span class="keyword">usr</span>/local/nginx/</span><br><span class="line"><span class="symbol">461 </span> ll</span><br><span class="line"><span class="symbol">462 </span> cd conf</span><br><span class="line"><span class="symbol">463 </span> more nginx.conf</span><br><span class="line"><span class="symbol">464 </span> vim nginx.conf</span><br><span class="line"><span class="symbol">465 </span> ../sbin/nginx -s reload</span><br><span class="line"><span class="symbol">466 </span> ll</span><br><span class="line"><span class="symbol">467 </span> ps -ef |grep  java</span><br><span class="line"><span class="symbol">468 </span> <span class="keyword">kill</span> -<span class="number">9</span> <span class="number">23983</span></span><br><span class="line"><span class="symbol">469 </span> ll</span><br><span class="line"><span class="symbol">470 </span> <span class="keyword">kill</span> -<span class="number">9</span> <span class="number">23983</span></span><br><span class="line"><span class="symbol">471 </span> ps -ef |grep  java</span><br><span class="line"><span class="symbol">472 </span> <span class="keyword">kill</span> -<span class="number">9</span> <span class="number">703</span></span><br><span class="line"><span class="symbol">473 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">474 </span> ll</span><br><span class="line"><span class="symbol">475 </span> <span class="keyword">mkdir</span> docker</span><br><span class="line"><span class="symbol">476 </span> ll</span><br><span class="line"><span class="symbol">477 </span> cd docker/</span><br><span class="line"><span class="symbol">478 </span> ll</span><br><span class="line"><span class="symbol">479 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">480 </span> cd ..</span><br><span class="line"><span class="symbol">481 </span> ll</span><br><span class="line"><span class="symbol">482 </span> cp Mamai-<span class="number">1.0</span>-SNAPSHOT.jar docker/</span><br><span class="line"><span class="symbol">483 </span> ll</span><br><span class="line"><span class="symbol">484 </span> cd docker/</span><br><span class="line"><span class="symbol">485 </span> ll</span><br><span class="line"><span class="symbol">486 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">487 </span> pwd</span><br><span class="line"><span class="symbol">488 </span> ll</span><br><span class="line"><span class="symbol">489 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">490 </span> docker build -t springbootdemo4docker .</span><br><span class="line"><span class="symbol">491 </span> docker images</span><br><span class="line"><span class="symbol">492 </span> docker <span class="keyword">run</span> -d -p <span class="number">8080</span>:<span class="number">8080</span> springbootdemo4docker</span><br><span class="line"><span class="symbol">493 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">494 </span> ps -ef |grep java</span><br><span class="line"><span class="symbol">495 </span> docker logs --tail <span class="number">300</span> -f demo</span><br><span class="line"><span class="symbol">496 </span> docker ps</span><br><span class="line"><span class="symbol">497 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">498 </span> netstat -na</span><br><span class="line"><span class="symbol">499 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">500 </span> ps -ef|grep java</span><br><span class="line"><span class="symbol">501 </span> ll</span><br><span class="line"><span class="symbol">502 </span> more Dockerfile </span><br><span class="line"><span class="symbol">503 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">504 </span> docker-compose exec java bash</span><br><span class="line"><span class="symbol">505 </span> cd /<span class="keyword">usr</span>/local/bin/</span><br><span class="line"><span class="symbol">506 </span> docker-compose exec java bash</span><br><span class="line"><span class="symbol">507 </span> ll</span><br><span class="line"><span class="symbol">508 </span> netstat -lnp|grep <span class="number">8080</span></span><br><span class="line"><span class="symbol">509 </span> ll</span><br><span class="line"><span class="symbol">510 </span> cd /<span class="keyword">usr</span>/local/nginx/conf</span><br><span class="line"><span class="symbol">511 </span> vim nginx.conf</span><br><span class="line"><span class="symbol">512 </span> ../sbin/nginx -s reload</span><br><span class="line"><span class="symbol">513 </span> vim nginx.conf</span><br><span class="line"><span class="symbol">514 </span> ../sbin/nginx -s reload</span><br><span class="line"><span class="symbol">515 </span> ll</span><br><span class="line"><span class="symbol">516 </span> cd apache-tomcat-<span class="number">8.5.51</span>/</span><br><span class="line"><span class="symbol">517 </span> ll</span><br><span class="line"><span class="symbol">518 </span> cd ..</span><br><span class="line"><span class="symbol">519 </span> ll</span><br><span class="line"><span class="symbol">520 </span> rm -rf apache-tomcat-<span class="number">8.5.51</span>/</span><br><span class="line"><span class="symbol">521 </span> ll</span><br><span class="line"><span class="symbol">522 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">523 </span> ll</span><br><span class="line"><span class="symbol">524 </span> wget https://mirrors.cnnic.cn/apache/tomcat/tomcat-<span class="number">9</span>/v9.<span class="number">0.7</span>/bin/apache-tomcat-<span class="number">9.0.7.</span>tar.gz</span><br><span class="line"><span class="symbol">525 </span> wget https://archive.apache.org/dist/tomcat/tomcat-<span class="number">8</span>/v8.<span class="number">0.23</span>/bin/apache-tomcat-<span class="number">8.0.23.</span>tar.gz</span><br><span class="line"><span class="symbol">526 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">527 </span> ll</span><br><span class="line"><span class="symbol">528 </span> tar -zxvf apache-tomcat-<span class="number">8.0.23.</span>tar.gz </span><br><span class="line"><span class="symbol">529 </span> ll</span><br><span class="line"><span class="symbol">530 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">531 </span> ll</span><br><span class="line"><span class="symbol">532 </span> cd apache-tomcat-<span class="number">8.0.23</span></span><br><span class="line"><span class="symbol">533 </span> ll</span><br><span class="line"><span class="symbol">534 </span> cd webapps/</span><br><span class="line"><span class="symbol">535 </span> ll</span><br><span class="line"><span class="symbol">536 </span> rm -rf docs/</span><br><span class="line"><span class="symbol">537 </span> rm -rf examples/</span><br><span class="line"><span class="symbol">538 </span> rm -rf host-manager/</span><br><span class="line"><span class="symbol">539 </span> rm -rf manager/</span><br><span class="line"><span class="symbol">540 </span> rm -rf ROOT/</span><br><span class="line"><span class="symbol">541 </span> ll</span><br><span class="line"><span class="symbol">542 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">543 </span> ll</span><br><span class="line"><span class="symbol">544 </span> cd ..</span><br><span class="line"><span class="symbol">545 </span> ll</span><br><span class="line"><span class="symbol">546 </span> cd work/</span><br><span class="line"><span class="symbol">547 </span> ll</span><br><span class="line"><span class="symbol">548 </span> cd ..</span><br><span class="line"><span class="symbol">549 </span> cd conf/</span><br><span class="line"><span class="symbol">550 </span> ll</span><br><span class="line"><span class="symbol">551 </span> vim server.xml </span><br><span class="line"><span class="symbol">552 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">553 </span> cd ..</span><br><span class="line"><span class="symbol">554 </span> cd webapps/</span><br><span class="line"><span class="symbol">555 </span> ll</span><br><span class="line"><span class="symbol">556 </span> pwd</span><br><span class="line"><span class="symbol">557 </span> cd ..</span><br><span class="line"><span class="symbol">558 </span> cd conf/</span><br><span class="line"><span class="symbol">559 </span> vim server.xml </span><br><span class="line"><span class="symbol">560 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">561 </span> ll</span><br><span class="line"><span class="symbol">562 </span> cd ..</span><br><span class="line"><span class="symbol">563 </span> ll</span><br><span class="line"><span class="symbol">564 </span> cd bin</span><br><span class="line"><span class="symbol">565 </span> ./startup.sh </span><br><span class="line"><span class="symbol">566 </span> cd ..</span><br><span class="line"><span class="symbol">567 </span> cd logs/</span><br><span class="line"><span class="symbol">568 </span> ll</span><br><span class="line"><span class="symbol">569 </span> ls</span><br><span class="line"><span class="symbol">570 </span> cd ..</span><br><span class="line"><span class="symbol">571 </span> ls</span><br><span class="line"><span class="symbol">572 </span> cd server</span><br><span class="line"><span class="symbol">573 </span> cd www</span><br><span class="line"><span class="symbol">574 </span> cd server</span><br><span class="line"><span class="symbol">575 </span> ls</span><br><span class="line"><span class="symbol">576 </span> cd tomcat</span><br><span class="line"><span class="symbol">577 </span> ls</span><br><span class="line"><span class="symbol">578 </span> cd bin</span><br><span class="line"><span class="symbol">579 </span> ls</span><br><span class="line"><span class="symbol">580 </span> cd apache-tomcat-<span class="number">8.5.12</span>/</span><br><span class="line"><span class="symbol">581 </span> ls</span><br><span class="line"><span class="symbol">582 </span> cd bin</span><br><span class="line"><span class="symbol">583 </span> ./startup.sh</span><br><span class="line"><span class="symbol">584 </span> ls</span><br><span class="line"><span class="symbol">585 </span> ./startup.sh</span><br><span class="line"><span class="symbol">586 </span> ./shutdown.sh</span><br><span class="line"><span class="symbol">587 </span> ./startup.sh</span><br><span class="line"><span class="symbol">588 </span> ll</span><br><span class="line"><span class="symbol">589 </span> cd apache-tomcat-<span class="number">8.0.23</span></span><br><span class="line"><span class="symbol">590 </span> ll</span><br><span class="line"><span class="symbol">591 </span> cd webapps/</span><br><span class="line"><span class="symbol">592 </span> ll</span><br><span class="line"><span class="symbol">593 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">594 </span> cd ..</span><br><span class="line"><span class="symbol">595 </span> cd webapps/</span><br><span class="line"><span class="symbol">596 </span> ll</span><br><span class="line"><span class="symbol">597 </span> cd myProject</span><br><span class="line"><span class="symbol">598 </span> ll</span><br><span class="line"><span class="symbol">599 </span> cd WEB-INF/</span><br><span class="line"><span class="symbol">600 </span> ll</span><br><span class="line"><span class="symbol">601 </span> cd classes/</span><br><span class="line"><span class="symbol">602 </span> ll</span><br><span class="line"><span class="symbol">603 </span> more application.properties </span><br><span class="line"><span class="symbol">604 </span> cd ..</span><br><span class="line"><span class="symbol">605 </span> ll</span><br><span class="line"><span class="symbol">606 </span> cd ..</span><br><span class="line"><span class="symbol">607 </span> ll</span><br><span class="line"><span class="symbol">608 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">609 </span> cd META-INF/</span><br><span class="line"><span class="symbol">610 </span> ll</span><br><span class="line"><span class="symbol">611 </span> cd ..</span><br><span class="line"><span class="symbol">612 </span> ll</span><br><span class="line"><span class="symbol">613 </span> cd WEB-INF/</span><br><span class="line"><span class="symbol">614 </span> ll</span><br><span class="line"><span class="symbol">615 </span> cd classes/</span><br><span class="line"><span class="symbol">616 </span> ll</span><br><span class="line"><span class="symbol">617 </span> cd templates/</span><br><span class="line"><span class="symbol">618 </span> ll</span><br><span class="line"><span class="symbol">619 </span> cd ..</span><br><span class="line"><span class="symbol">620 </span> ll</span><br><span class="line"><span class="symbol">621 </span> cd classes/</span><br><span class="line"><span class="symbol">622 </span> ll</span><br><span class="line"><span class="symbol">623 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">624 </span> ll</span><br><span class="line"><span class="symbol">625 </span> more application.properties </span><br><span class="line"><span class="symbol">626 </span> ll</span><br><span class="line"><span class="symbol">627 </span> cd templates/</span><br><span class="line"><span class="symbol">628 </span> ll</span><br><span class="line"><span class="symbol">629 </span> cd js/</span><br><span class="line"><span class="symbol">630 </span> ll</span><br><span class="line"><span class="symbol">631 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">632 </span> vim <span class="keyword">common</span>.js </span><br><span class="line"><span class="symbol">633 </span> cd .</span><br><span class="line"><span class="symbol">634 </span> cd ..</span><br><span class="line"><span class="symbol">635 </span> cd conf/</span><br><span class="line"><span class="symbol">636 </span> more server.xml </span><br><span class="line"><span class="symbol">637 </span> cd ..</span><br><span class="line"><span class="symbol">638 </span> cd webapps/</span><br><span class="line"><span class="symbol">639 </span> ll</span><br><span class="line"><span class="symbol">640 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">641 </span> cd myProject</span><br><span class="line"><span class="symbol">642 </span> ll</span><br><span class="line"><span class="symbol">643 </span> cd WEB-INF/</span><br><span class="line"><span class="symbol">644 </span> ll</span><br><span class="line"><span class="symbol">645 </span> cd ca</span><br><span class="line"><span class="symbol">646 </span> cd classes/</span><br><span class="line"><span class="symbol">647 </span> ll</span><br><span class="line"><span class="symbol">648 </span> cd templates/</span><br><span class="line"><span class="symbol">649 </span> ll</span><br><span class="line"><span class="symbol">650 </span> cd js/</span><br><span class="line"><span class="symbol">651 </span> ll</span><br><span class="line"><span class="symbol">652 </span> vim <span class="keyword">common</span>.js </span><br><span class="line"><span class="symbol">653 </span> ps -ef |grep java</span><br><span class="line"><span class="symbol">654 </span> netstat -lnp|grep <span class="number">8082</span></span><br><span class="line"><span class="symbol">655 </span> systemctl status firewalld</span><br><span class="line"><span class="symbol">656 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">657 </span> firewall-cmd --zone=public --add-port=<span class="number">80</span>/tcp --permanent</span><br><span class="line"><span class="symbol">658 </span> firewall-cmd --zone=public --add-port=<span class="number">8082</span>/tcp --permanent</span><br><span class="line"><span class="symbol">659 </span> firewall-cmd --reload</span><br><span class="line"><span class="symbol">660 </span> firewall-cmd --zone=public --query-port=<span class="number">8082</span>/tcp</span><br><span class="line"><span class="symbol">661 </span> history </span><br><span class="line"><span class="symbol">662 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">663 </span> ll</span><br><span class="line"><span class="symbol">664 </span> cd ..</span><br><span class="line"><span class="symbol">665 </span> cd bin/</span><br><span class="line"><span class="symbol">666 </span> ./shutdown.sh </span><br><span class="line"><span class="symbol">667 </span> netstat -lnp|grep <span class="number">8080</span></span><br><span class="line"><span class="symbol">668 </span> netstat -lnp|grep <span class="number">8082</span></span><br><span class="line"><span class="symbol">669 </span> <span class="keyword">kill</span> -<span class="number">9</span> <span class="number">1109</span></span><br><span class="line"><span class="symbol">670 </span> netstat -lnp|grep <span class="number">8080</span></span><br><span class="line"><span class="symbol">671 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">672 </span> cd ..</span><br><span class="line"><span class="symbol">673 </span> cd conf/</span><br><span class="line"><span class="symbol">674 </span> ll</span><br><span class="line"><span class="symbol">675 </span> vim server.xml </span><br><span class="line"><span class="symbol">676 </span> cd ..</span><br><span class="line"><span class="symbol">677 </span> cd bin/</span><br><span class="line"><span class="symbol">678 </span> ./startup.sh </span><br><span class="line"><span class="symbol">679 </span> netstat -lnp|grep <span class="number">8080</span></span><br><span class="line"><span class="symbol">680 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">681 </span> ll</span><br><span class="line"><span class="symbol">682 </span> cd ../logs/</span><br><span class="line"><span class="symbol">683 </span> more catalina.<span class="keyword">out</span> </span><br><span class="line"><span class="symbol">684 </span> cd ../webapps/</span><br><span class="line"><span class="symbol">685 </span> cd myProject</span><br><span class="line"><span class="symbol">686 </span> ll</span><br><span class="line"><span class="symbol">687 </span> cd WEB-INF/</span><br><span class="line"><span class="symbol">688 </span> ll</span><br><span class="line"><span class="symbol">689 </span> cd classes/</span><br><span class="line"><span class="symbol">690 </span> ll</span><br><span class="line"><span class="symbol">691 </span> cd templates/</span><br><span class="line"><span class="symbol">692 </span> ll</span><br><span class="line"><span class="symbol">693 </span> cd js/</span><br><span class="line"><span class="symbol">694 </span> ll</span><br><span class="line"><span class="symbol">695 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">696 </span> ll</span><br><span class="line"><span class="symbol">697 </span> vim <span class="keyword">common</span>.js </span><br><span class="line"><span class="symbol">698 </span> cd ..</span><br><span class="line"><span class="symbol">699 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">700 </span> ll</span><br><span class="line"><span class="symbol">701 </span> cd ..</span><br><span class="line"><span class="symbol">702 </span> cd bin/</span><br><span class="line"><span class="symbol">703 </span> ./shutdown.sh </span><br><span class="line"><span class="symbol">704 </span> ll</span><br><span class="line"><span class="symbol">705 </span> cd apache-tomcat-<span class="number">8.0.23</span></span><br><span class="line"><span class="symbol">706 </span> ll</span><br><span class="line"><span class="symbol">707 </span> cd webapps/</span><br><span class="line"><span class="symbol">708 </span> ll</span><br><span class="line"><span class="symbol">709 </span> rm -rf myProject</span><br><span class="line"><span class="symbol">710 </span> rm -rf myProject.war </span><br><span class="line"><span class="symbol">711 </span> cd ..</span><br><span class="line"><span class="symbol">712 </span> cd work/</span><br><span class="line"><span class="symbol">713 </span> ll</span><br><span class="line"><span class="symbol">714 </span> cd Catalina/</span><br><span class="line"><span class="symbol">715 </span> ll</span><br><span class="line"><span class="symbol">716 </span> cd localhost/</span><br><span class="line"><span class="symbol">717 </span> ll</span><br><span class="line"><span class="symbol">718 </span> rm -rf myProject/</span><br><span class="line"><span class="symbol">719 </span> ll</span><br><span class="line"><span class="symbol">720 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">721 </span> cd ../../../</span><br><span class="line"><span class="symbol">722 </span> ll</span><br><span class="line"><span class="symbol">723 </span> cd ..</span><br><span class="line"><span class="symbol">724 </span> cd </span><br><span class="line"><span class="symbol">725 </span> ll</span><br><span class="line"><span class="symbol">726 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">727 </span> history </span><br><span class="line"><span class="symbol">728 </span> ll</span><br><span class="line"><span class="symbol">729 </span> cd docker/</span><br><span class="line"><span class="symbol">730 </span> ll</span><br><span class="line"><span class="symbol">731 </span> docker <span class="keyword">run</span> -d -p <span class="number">8080</span>:<span class="number">8080</span> springbootdemo4docker</span><br><span class="line"><span class="symbol">732 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">733 </span>  docker build -t springbootdemo4docker .</span><br><span class="line"><span class="symbol">734 </span> ll</span><br><span class="line"><span class="symbol">735 </span> more Dockerfile </span><br><span class="line"><span class="symbol">736 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">737 </span> ll</span><br><span class="line"><span class="symbol">738 </span> docker build -t springbootdemo5docker .</span><br><span class="line"><span class="symbol">739 </span> docker build -t springbootdemo4docker .</span><br><span class="line"><span class="symbol">740 </span> service docker restart</span><br><span class="line"><span class="symbol">741 </span> docker build -t springbootdemo5docker .</span><br><span class="line"><span class="symbol">742 </span> docker images</span><br><span class="line"><span class="symbol">743 </span> docker <span class="keyword">run</span> -d -p <span class="number">8080</span>:<span class="number">8080</span> springbootdemo5docker</span><br><span class="line"><span class="symbol">744 </span> docker rmi <span class="number">05</span>c655fd2bd6</span><br><span class="line"><span class="symbol">745 </span> ps -ef |grep java</span><br><span class="line"><span class="symbol">746 </span> <span class="keyword">kill</span> -<span class="number">9</span> <span class="number">2632</span></span><br><span class="line"><span class="symbol">747 </span> <span class="keyword">kill</span> -<span class="number">9</span> <span class="number">2874</span></span><br><span class="line"><span class="symbol">748 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">749 </span> cd ..</span><br><span class="line"><span class="symbol">750 </span> ll</span><br><span class="line"><span class="symbol">751 </span> pwd</span><br><span class="line"><span class="symbol">752 </span> ll</span><br><span class="line"><span class="symbol">753 </span> rm -rf Mamai-<span class="number">1.0</span>-SNAPSHOT.jar </span><br><span class="line"><span class="symbol">754 </span> ll</span><br><span class="line"><span class="symbol">755 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">756 </span> pwd</span><br><span class="line"><span class="symbol">757 </span> ll</span><br><span class="line"><span class="symbol">758 </span> cd docker/</span><br><span class="line"><span class="symbol">759 </span> ll</span><br><span class="line"><span class="symbol">760 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">761 </span> ll</span><br><span class="line"><span class="symbol">762 </span> rm -rf Mamai-<span class="number">1.0</span>-SNAPSHOT.jar </span><br><span class="line"><span class="symbol">763 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">764 </span> cp ../Mamai-<span class="number">1.0</span>-SNAPSHOT.jar  Mamai-<span class="number">1.0</span>-SNAPSHOT.jar</span><br><span class="line"><span class="symbol">765 </span> ll</span><br><span class="line"><span class="symbol">766 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">767 </span> rm -rf Mamai-<span class="number">1.0</span>-SNAPSHOT.jar </span><br><span class="line"><span class="symbol">768 </span> cd ..</span><br><span class="line"><span class="symbol">769 </span> ll</span><br><span class="line"><span class="symbol">770 </span> cear</span><br><span class="line"><span class="symbol">771 </span> rm -rf Mamai-<span class="number">1.0</span>-SNAPSHOT.jar </span><br><span class="line"><span class="symbol">772 </span> ll</span><br><span class="line"><span class="symbol">773 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">774 </span> ll</span><br><span class="line"><span class="symbol">775 </span> tail -<span class="number">300</span>f tempMaima.txt </span><br><span class="line"><span class="symbol">776 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">777 </span> ll</span><br><span class="line"><span class="symbol">778 </span> cp Mamai-<span class="number">1.0</span>-SNAPSHOT.jar ./docker/</span><br><span class="line"><span class="symbol">779 </span> ll</span><br><span class="line"><span class="symbol">780 </span> cd docker/</span><br><span class="line"><span class="symbol">781 </span> ll</span><br><span class="line"><span class="symbol">782 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">783 </span> docker images</span><br><span class="line"><span class="symbol">784 </span> docker start <span class="number">05</span>c655fd2bd6</span><br><span class="line"><span class="symbol">785 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">786 </span> docker build -t springbootdemo6docker .</span><br><span class="line"><span class="symbol">787 </span> docker images</span><br><span class="line"><span class="symbol">788 </span> docker <span class="keyword">run</span> -d -p <span class="number">8080</span>:<span class="number">8080</span> springbootdemo6docker</span><br><span class="line"><span class="symbol">789 </span> docker images</span><br><span class="line"><span class="symbol">790 </span> ll</span><br><span class="line"><span class="symbol">791 </span> cd ..</span><br><span class="line"><span class="symbol">792 </span> ll</span><br><span class="line"><span class="symbol">793 </span> tail -<span class="number">300</span>f tempMaima.txt </span><br><span class="line"><span class="symbol">794 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">795 </span> ll</span><br><span class="line"><span class="symbol">796 </span> cd docker/</span><br><span class="line"><span class="symbol">797 </span> docker images</span><br><span class="line"><span class="symbol">798 </span> docker rmi05c655fd2bd6</span><br><span class="line"><span class="symbol">799 </span> docker rmi <span class="number">05</span>c655fd2bd6</span><br><span class="line"><span class="symbol">800 </span> docker rmi springbootdemo4docker:latest </span><br><span class="line"><span class="symbol">801 </span> docker rmi -f <span class="number">05</span>c655fd2bd6</span><br><span class="line"><span class="symbol">802 </span> docker rmi springbootdemo5docker:latest</span><br><span class="line"><span class="symbol">803 </span> docker rmi -f <span class="number">05</span>c655fd2bd6</span><br><span class="line"><span class="symbol">804 </span> docker images</span><br><span class="line"><span class="symbol">805 </span> ls</span><br><span class="line"><span class="symbol">806 </span> Mamai-<span class="number">1.0</span>-SNAPSHOT.jar.sh <span class="keyword">stop</span></span><br><span class="line"><span class="symbol">807 </span> Mamai-<span class="number">1.0</span>-SNAPSHOT <span class="keyword">stop</span></span><br><span class="line"><span class="symbol">808 </span> Mamai-<span class="number">1.0</span>-SNAPSHOT.jar <span class="keyword">stop</span></span><br><span class="line"><span class="symbol">809 </span> top</span><br><span class="line"><span class="symbol">810 </span> ls</span><br><span class="line"><span class="symbol">811 </span> java -jar Mamai-<span class="number">1.0</span>-SNAPSHOT.jar </span><br><span class="line"><span class="symbol">812 </span> ls</span><br><span class="line"><span class="symbol">813 </span> ps -ef</span><br><span class="line"><span class="symbol">814 </span> ls</span><br><span class="line"><span class="symbol">815 </span> java -jar Mamai-<span class="number">1.0</span>-SNAPSHOT.jar</span><br><span class="line"><span class="symbol">816 </span> ls</span><br><span class="line"><span class="symbol">817 </span> java -jar Mamai-<span class="number">1.0</span>-SNAPSHOT.jar</span><br><span class="line"><span class="symbol">818 </span> ls</span><br><span class="line"><span class="symbol">819 </span> java -jar Mamai-<span class="number">1.0</span>-SNAPSHOT.jar</span><br><span class="line"><span class="symbol">820 </span> ll</span><br><span class="line"><span class="symbol">821 </span> tail -<span class="number">300</span>f tempMaima.txt </span><br><span class="line"><span class="symbol">822 </span> netstat -lnp|grep <span class="number">8080</span></span><br><span class="line"><span class="symbol">823 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">824 </span> docker ps</span><br><span class="line"><span class="symbol">825 </span> ll</span><br><span class="line"><span class="symbol">826 </span> cd docker/</span><br><span class="line"><span class="symbol">827 </span> ll</span><br><span class="line"><span class="symbol">828 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">829 </span> docker ps</span><br><span class="line"><span class="symbol">830 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">831 </span> ps -ef |grep java</span><br><span class="line"><span class="symbol">832 </span> ps -ef |grep <span class="number">8080</span></span><br><span class="line"><span class="symbol">833 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">834 </span> history </span><br><span class="line"><span class="symbol">835 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">836 </span> cd /</span><br><span class="line"><span class="symbol">837 </span> ll</span><br><span class="line"><span class="symbol">838 </span> cd www/</span><br><span class="line"><span class="symbol">839 </span> ll</span><br><span class="line"><span class="symbol">840 </span> cd server/</span><br><span class="line"><span class="symbol">841 </span> ll</span><br><span class="line"><span class="symbol">842 </span> cd nginx/</span><br><span class="line"><span class="symbol">843 </span> ll</span><br><span class="line"><span class="symbol">844 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">845 </span> ll</span><br><span class="line"><span class="symbol">846 </span> cd bin</span><br><span class="line"><span class="symbol">847 </span> ll</span><br><span class="line"><span class="symbol">848 </span> cd sbin/</span><br><span class="line"><span class="symbol">849 </span> ll</span><br><span class="line"><span class="symbol">850 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">851 </span> ll</span><br><span class="line"><span class="symbol">852 </span> cd .</span><br><span class="line"><span class="symbol">853 </span> cd ..</span><br><span class="line"><span class="symbol">854 </span> cd conf/</span><br><span class="line"><span class="symbol">855 </span> ll</span><br><span class="line"><span class="symbol">856 </span> cd ..</span><br><span class="line"><span class="symbol">857 </span> cd sbin</span><br><span class="line"><span class="symbol">858 </span> ./nginx -c ../conf/nginx.conf</span><br><span class="line"><span class="symbol">859 </span> cd ../conf/</span><br><span class="line"><span class="symbol">860 </span> ll</span><br><span class="line"><span class="symbol">861 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">862 </span> ../sbin/nginx -c nginx.conf</span><br><span class="line"><span class="symbol">863 </span> pwd</span><br><span class="line"><span class="symbol">864 </span> tail -<span class="number">300</span>f nginx.conf</span><br><span class="line"><span class="symbol">865 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">866 </span> cd ..</span><br><span class="line"><span class="symbol">867 </span> cd sbin/</span><br><span class="line"><span class="symbol">868 </span> ./nginx  -s reload</span><br><span class="line"><span class="symbol">869 </span> ll</span><br><span class="line"><span class="symbol">870 </span> cd ..</span><br><span class="line"><span class="symbol">871 </span> ll</span><br><span class="line"><span class="symbol">872 </span> cd logs/</span><br><span class="line"><span class="symbol">873 </span> l</span><br><span class="line"><span class="symbol">874 </span> ll</span><br><span class="line"><span class="symbol">875 </span> tail -<span class="number">300</span>f <span class="keyword">error</span>.<span class="keyword">log</span> </span><br><span class="line"><span class="symbol">876 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">877 </span> cd ..</span><br><span class="line"><span class="symbol">878 </span> ll</span><br><span class="line"><span class="symbol">879 </span> cd ..</span><br><span class="line"><span class="symbol">880 </span> cd </span><br><span class="line"><span class="symbol">881 </span> docker images</span><br><span class="line"><span class="symbol">882 </span> docker image ls</span><br><span class="line"><span class="symbol">883 </span> systemctl daemon-reload</span><br><span class="line"><span class="symbol">884 </span> docker images</span><br><span class="line"><span class="symbol">885 </span> service docker status</span><br><span class="line"><span class="symbol">886 </span> service docker start</span><br><span class="line"><span class="symbol">887 </span> systemctl  docker start</span><br><span class="line"><span class="symbol">888 </span> systemctl docker status</span><br><span class="line"><span class="symbol">889 </span> systemctl restart docker</span><br><span class="line"><span class="symbol">890 </span> systemctl status docker</span><br><span class="line"><span class="symbol">891 </span> docker ps</span><br><span class="line"><span class="symbol">892 </span> docker images</span><br><span class="line"><span class="symbol">893 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">894 </span> docker images</span><br><span class="line"><span class="symbol">895 </span> docker ps -a</span><br><span class="line"><span class="symbol">896 </span> history </span><br><span class="line"><span class="symbol">897 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">898 </span> docker images</span><br><span class="line"><span class="symbol">899 </span> docker ps</span><br><span class="line"><span class="symbol">900 </span> docker ps -a</span><br><span class="line"><span class="symbol">901 </span> docker start gifted_hamilton</span><br><span class="line"><span class="symbol">902 </span> docker ps</span><br><span class="line"><span class="symbol">903 </span> ll</span><br><span class="line"><span class="symbol">904 </span> tail -<span class="number">300</span>f tempMaima.txt </span><br><span class="line"><span class="symbol">905 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">906 </span> history </span><br><span class="line"><span class="symbol">907 </span> ll</span><br><span class="line"><span class="symbol">908 </span> docker ps -a</span><br><span class="line"><span class="symbol">909 </span> docker <span class="keyword">stop</span> gifted_hamilton</span><br><span class="line"><span class="symbol">910 </span> pwd</span><br><span class="line"><span class="symbol">911 </span> ll</span><br><span class="line"><span class="symbol">912 </span> cd docker/</span><br><span class="line"><span class="symbol">913 </span> l</span><br><span class="line"><span class="symbol">914 </span> ll</span><br><span class="line"><span class="symbol">915 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">916 </span> ll</span><br><span class="line"><span class="symbol">917 </span> rm -rf Mamai-<span class="number">1.0</span>-SNAPSHOT.jar </span><br><span class="line"><span class="symbol">918 </span> ll</span><br><span class="line"><span class="symbol">919 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">920 </span> pwd</span><br><span class="line"><span class="symbol">921 </span> docker ps -a</span><br><span class="line"><span class="symbol">922 </span> ll</span><br><span class="line"><span class="symbol">923 </span> docker start gifted_hamilton</span><br><span class="line"><span class="symbol">924 </span> docker ps -a</span><br><span class="line"><span class="symbol">925 </span> ps -ef |grep java</span><br><span class="line"><span class="symbol">926 </span> ll</span><br><span class="line"><span class="symbol">927 </span> docker ps -a</span><br><span class="line"><span class="symbol">928 </span> docker <span class="keyword">stop</span> gifted_hamilton</span><br><span class="line"><span class="symbol">929 </span> cd docker/</span><br><span class="line"><span class="symbol">930 </span> ll</span><br><span class="line"><span class="symbol">931 </span> rm -rf Mamai-<span class="number">1.0</span>-SNAPSHOT.jar </span><br><span class="line"><span class="symbol">932 </span> ll</span><br><span class="line"><span class="symbol">933 </span> pwd</span><br><span class="line"><span class="symbol">934 </span> ll</span><br><span class="line"><span class="symbol">935 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">936 </span> docker ps -a</span><br><span class="line"><span class="symbol">937 </span> docker start gifted_hamilton</span><br><span class="line"><span class="symbol">938 </span> docker ps -a</span><br><span class="line"><span class="symbol">939 </span> docker <span class="keyword">stop</span> gifted_hamilton</span><br><span class="line"><span class="symbol">940 </span> docker ps -a</span><br><span class="line"><span class="symbol">941 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">942 </span> docker ps -a</span><br><span class="line"><span class="symbol">943 </span> docker rm gifted_hamilton</span><br><span class="line"><span class="symbol">944 </span> docker ps -a</span><br><span class="line"><span class="symbol">945 </span> docker images</span><br><span class="line"><span class="symbol">946 </span> docker rmi springbootdemo6docker</span><br><span class="line"><span class="symbol">947 </span> docker iamges</span><br><span class="line"><span class="symbol">948 </span> docker images</span><br><span class="line"><span class="symbol">949 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">950 </span> ll</span><br><span class="line"><span class="symbol">951 </span> more Dockerfile </span><br><span class="line"><span class="symbol">952 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">953 </span> docker build -t mamai .</span><br><span class="line"><span class="symbol">954 </span> docker images</span><br><span class="line"><span class="symbol">955 </span> cd ..</span><br><span class="line"><span class="symbol">956 </span> ll</span><br><span class="line"><span class="symbol">957 </span> cd docker/</span><br><span class="line"><span class="symbol">958 </span> ll</span><br><span class="line"><span class="symbol">959 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">960 </span> more Dockerfile </span><br><span class="line"><span class="symbol">961 </span> docker <span class="keyword">run</span> -d -p <span class="number">8080</span>:<span class="number">8080</span> mamai</span><br><span class="line"><span class="symbol">962 </span> docker ps -a</span><br><span class="line"><span class="symbol">963 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">964 </span> ll</span><br><span class="line"><span class="symbol">965 </span> cd .</span><br><span class="line"><span class="symbol">966 </span> c d..</span><br><span class="line"><span class="symbol">967 </span> cd ..</span><br><span class="line"><span class="symbol">968 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">969 </span> ll</span><br><span class="line"><span class="symbol">970 </span> rm -rf Ma</span><br><span class="line"><span class="symbol">971 </span> rm -rf Mamai-<span class="number">1.0</span>-SNAPSHOT.jar </span><br><span class="line"><span class="symbol">972 </span> ll</span><br><span class="line"><span class="symbol">973 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">974 </span> ll</span><br><span class="line"><span class="symbol">975 </span> rm -rf apache-tomcat-<span class="number">8.0.23</span></span><br><span class="line"><span class="symbol">976 </span> rm -rf apache-tomcat-<span class="number">8.0.23.</span>tar.gz </span><br><span class="line"><span class="symbol">977 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">978 </span> ll</span><br><span class="line"><span class="symbol">979 </span> more install.sh </span><br><span class="line"><span class="symbol">980 </span> <span class="keyword">clear</span></span><br><span class="line"><span class="symbol">981 </span> docker ps -a</span><br><span class="line"><span class="symbol">982 </span> docker <span class="keyword">stop</span> agitated_brown</span><br><span class="line"><span class="symbol">983 </span> ll</span><br><span class="line"><span class="symbol">984 </span> cd docker/</span><br><span class="line"><span class="symbol">985 </span> ll</span><br><span class="line"><span class="symbol">986 </span> rm -rf Mamai-<span class="number">1.0</span>-SNAPSHOT.jar </span><br><span class="line"><span class="symbol">987 </span> ll</span><br><span class="line"><span class="symbol">988 </span> docker  images</span><br><span class="line"><span class="symbol">989 </span> docker ps -a</span><br><span class="line"><span class="symbol">990 </span> docker start agitated_brown</span><br><span class="line"><span class="symbol">991 </span> docker ps -a</span><br><span class="line"><span class="symbol">992 </span> top</span><br><span class="line"><span class="symbol">993 </span> df -h</span><br><span class="line"><span class="symbol">994 </span> top</span><br><span class="line"><span class="symbol">995 </span> ll</span><br><span class="line"><span class="symbol">996 </span> cd docker/</span><br><span class="line"><span class="symbol">997 </span> ll</span><br><span class="line"><span class="symbol">998 </span> more Dockerfile </span><br><span class="line"><span class="symbol">999 </span> history</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;需求内容&quot;&gt;&lt;a href=&quot;#需求内容&quot; class=&quot;headerlink&quot; title=&quot;需求内容&quot;&gt;&lt;/a&gt;需求内容&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/fengshana/Mamai&quot; target=&quot;_blank&quot; r
      
    
    </summary>
    
    
      <category term="前端" scheme="https://fengshana.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="javaScript" scheme="https://fengshana.github.io/tags/javaScript/"/>
    
      <category term="docker" scheme="https://fengshana.github.io/tags/docker/"/>
    
      <category term="前端" scheme="https://fengshana.github.io/tags/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="双色球" scheme="https://fengshana.github.io/tags/%E5%8F%8C%E8%89%B2%E7%90%83/"/>
    
  </entry>
  
  <entry>
    <title>Spring-Bean生命周期</title>
    <link href="https://fengshana.github.io/2020/04/14/Spring/Bean%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"/>
    <id>https://fengshana.github.io/2020/04/14/Spring/Bean%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/</id>
    <published>2020-04-14T12:01:56.000Z</published>
    <updated>2020-04-14T17:00:56.968Z</updated>
    
    <content type="html"><![CDATA[<h2 id="学习笔记"><a href="#学习笔记" class="headerlink" title="学习笔记"></a>学习笔记</h2>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;学习笔记&quot;&gt;&lt;a href=&quot;#学习笔记&quot; class=&quot;headerlink&quot; title=&quot;学习笔记&quot;&gt;&lt;/a&gt;学习笔记&lt;/h2&gt;
      
    
    </summary>
    
    
      <category term="Spring" scheme="https://fengshana.github.io/categories/Spring/"/>
    
    
      <category term="Spring" scheme="https://fengshana.github.io/tags/Spring/"/>
    
  </entry>
  
  <entry>
    <title>Spring-AOP</title>
    <link href="https://fengshana.github.io/2020/04/12/Spring/AOP1/"/>
    <id>https://fengshana.github.io/2020/04/12/Spring/AOP1/</id>
    <published>2020-04-12T12:01:56.000Z</published>
    <updated>2020-04-12T10:54:39.075Z</updated>
    
    <content type="html"><![CDATA[<h2 id="学习笔记"><a href="#学习笔记" class="headerlink" title="学习笔记"></a>学习笔记</h2><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><h4 id="面向切面的一些基本知识"><a href="#面向切面的一些基本知识" class="headerlink" title="面向切面的一些基本知识"></a>面向切面的一些基本知识</h4><h4 id="SpringAOP概览"><a href="#SpringAOP概览" class="headerlink" title="SpringAOP概览"></a>SpringAOP概览</h4><ol><li>走进面向切面编程</li></ol><h5 id="编程范式概览"><a href="#编程范式概览" class="headerlink" title="编程范式概览"></a>编程范式概览</h5><p>首先面向切面编程它是一个编程范式，<br>除了面向切面编程，还有哪几种编程范式？</p><ul><li>面向过程编程，C语言、Basic…</li><li>面向对象编程，Java、c++…</li><li>面向函数编程/函数式编程</li><li>事件驱动编程，JUI开发中常见</li><li>面向切面编程</li></ul><h5 id="AOP是什么"><a href="#AOP是什么" class="headerlink" title="AOP是什么"></a>AOP是什么</h5><ul><li>是一种编程范式，不是编程语言；AOP跟语言不是一个层次当中的；</li><li>解决特定问题，不能解决所有问题；（跟面向对象编程不是竞争关系，而是互补关系）</li><li>是OOP的补充，不是替代；</li></ul><h5 id="AOP的初衷"><a href="#AOP的初衷" class="headerlink" title="AOP的初衷"></a>AOP的初衷</h5><p>面向切面编程为什么会被提出来？<br>AOP跟面向对象编程互补，互补在哪里？<br>这就要讲到面向切面编程的一个初衷，也就是说AOP想要解决的一个问题是什么。  </p><ol><li>DRY：Don’t Repeat Yourself（代码层问题）</li><li>SoC：Separation of  Concerns（关注点分离）</li></ol><p>关注点分离：  </p><ul><li>水平分离：展示层-&gt;服务层-&gt;持久层</li><li>垂直分离：模块划分（订单、库存等，业务模块）</li><li>切面分离：分离功能性需求与非功能性需求</li></ul><p>非功能性需求从功能性需求当中剥离出来集中管理，从而实现Don’t Repeat Yourself这个功能。  </p><h5 id="使用AOP的好处"><a href="#使用AOP的好处" class="headerlink" title="使用AOP的好处"></a>使用AOP的好处</h5><ul><li>集中处理某一关注点/横切逻辑</li><li>可以很方便地添加/删除关注点</li><li>侵入性少，增强代码可读性及可维护性</li></ul><h5 id="AOP的应用场景"><a href="#AOP的应用场景" class="headerlink" title="AOP的应用场景"></a>AOP的应用场景</h5><p>在功能上属于非功能性需求<br>非常适合在AOP的应用场景  </p><ul><li>权限控制</li><li>缓存控制</li><li>事务控制，相对于数据库的事务控制</li><li>审计日志</li><li>性能监控</li><li>分布式追踪</li><li>异常处理</li></ul><h5 id="支持AOP的编程语言"><a href="#支持AOP的编程语言" class="headerlink" title="支持AOP的编程语言"></a>支持AOP的编程语言</h5><p>中间既包括了面向对象也包括了脚本语言，面向过程语言…  </p><ul><li>Java</li><li>.NET</li><li>c/c++</li><li>Ruby</li><li>Python</li><li>PHP</li><li>…</li></ul><ol start="2"><li>Spring中的AOP</li><li>小结</li></ol><h3 id="AOP使用"><a href="#AOP使用" class="headerlink" title="AOP使用"></a>AOP使用</h3><p>怎么在Spring中使用AOP</p><h3 id="AOP原理"><a href="#AOP原理" class="headerlink" title="AOP原理"></a>AOP原理</h3><p>讲述Spring  AOP的原理</p><h3 id="AOP开源运用"><a href="#AOP开源运用" class="headerlink" title="AOP开源运用"></a>AOP开源运用</h3><p>Spring AOP在一些开源项目当中的运用情况</p><h3 id="课程实战"><a href="#课程实战" class="headerlink" title="课程实战"></a>课程实战</h3><h3 id="课程总结"><a href="#课程总结" class="headerlink" title="课程总结"></a>课程总结</h3>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;学习笔记&quot;&gt;&lt;a href=&quot;#学习笔记&quot; class=&quot;headerlink&quot; title=&quot;学习笔记&quot;&gt;&lt;/a&gt;学习笔记&lt;/h2&gt;&lt;h3 id=&quot;概念&quot;&gt;&lt;a href=&quot;#概念&quot; class=&quot;headerlink&quot; title=&quot;概念&quot;&gt;&lt;/a&gt;概念&lt;/h
      
    
    </summary>
    
    
      <category term="Spring" scheme="https://fengshana.github.io/categories/Spring/"/>
    
    
      <category term="Spring" scheme="https://fengshana.github.io/tags/Spring/"/>
    
  </entry>
  
  <entry>
    <title>前端页面双色球2</title>
    <link href="https://fengshana.github.io/2020/04/09/%E9%9D%A2%E8%AF%95%E9%A2%98/%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E6%94%B9%E8%BF%9B2/"/>
    <id>https://fengshana.github.io/2020/04/09/%E9%9D%A2%E8%AF%95%E9%A2%98/%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E6%94%B9%E8%BF%9B2/</id>
    <published>2020-04-08T19:47:56.000Z</published>
    <updated>2020-04-14T18:20:55.224Z</updated>
    
    <content type="html"><![CDATA[<h2 id="需求内容"><a href="#需求内容" class="headerlink" title="需求内容"></a>需求内容</h2><p><a href="https://github.com/fengshana/Mamai" target="_blank" rel="noopener">https://github.com/fengshana/Mamai</a>  </p><p>周聪这个孽畜，自己搞不清白需求，这个需求变来变去，你以为是变色龙，这么好变。<br>不要脑子啊。  </p><p>其实想了想，好像的确不怎么要脑子,挺简单的（说白了，我也想当一回这么瞎改需求的人，整天啥事不做，哔哔哔改需求）。<br>最近看了大话数据结构，我觉得这个写的有点那个运用到数据结构的味道，不知道是不是我想的有点多的缘故？<br>我想了下，我还想看剑指offer。<br>就这样决定了，我再看看剑指offer。等结束掉大话数据结构后。<br>刷算法面试题，emm，我的脑子可能不太好使啊。<br>david推荐的刷算法的地方我看了下，竞赛啊，啥啥啥的，因为里面论坛有人推荐说是，就是面试题先推荐剑指offer。<br>「David：<a href="https://leetcode-cn.com" target="_blank" rel="noopener">https://leetcode-cn.com</a> 这个上面好的算法题，可以练练，难度比较大一点。」</p><hr><p>我到时候先过一遍剑指offer吧，经典的先刷一波。  </p><p>好了不多说了，我的树还晾着呢。<br>代码变动不大，核心代码变动了主要是。<br><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANXxuU4iMOynMQpgZWghe8iC*Hv9DIU54D9XwpBqPukpAap6RBv2zFOp*WfB.xOqeyEH4rbg9vByiV1MU7oLq7poY!/r" alt="image"></p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">这个是一段一段的</span><br><span class="line"></span><br><span class="line">第一个<span class="number">10</span>到第二个<span class="number">10</span> 没有</span><br><span class="line"></span><br><span class="line">那就是从第二个<span class="number">10</span>开始计算的</span><br><span class="line"></span><br><span class="line">是一段一段的</span><br><span class="line"></span><br><span class="line">不是说从第一个开始到结束的最后一个</span><br><span class="line"></span><br><span class="line">会分成很多段</span><br></pre></td></tr></table></figure><p>也就是说单排当中，即第一列当中如果第一个存在，第三个存在，第九个存在与查询的元素相同的元素的话，那么单排最大遗漏数是  </p><ol><li>第三个减去第一个得到一个，也就是第二个；</li><li>第九个减去第三个得到五个，也就是第四个、第五个、第六个、第七个、第八个；</li></ol><p>第二列、三列、…..、七列单排都这样。  </p><p>分段是指的是第一列当中的第一个到第三个是一段，第三个到第九个是一段；而第一个与第九个之间不会组成段。也就是相邻的相同元素之间组成的段。当前元素与下一相同元素之间组成的段。  </p><p><img src="http://r.photo.store.qq.com/psc?/V13IdniL4CDhqM/TCfiP1YaPeRT4Jil9RANX7uuHUVbVPuACfzTyR9eJsRiBmxtqPAUyvZo4RqJDM5tRKOUIoVDnT2XkRpSkRFQ5lXoVRpn0ahUJOp48IFGL.Y!/r" alt="image"></p><p>好，总排最大遗漏数就是，如果第一列当中的第一个存在，第二个存在，第六个存在；第二列当中第三个存在，第八个存在；第三列当中第三个存在，第八个存在；第四列当中第四个存在，第七个存在；那么总的遗漏数就是：</p><ol><li>总共有四列，八行。（x轴，y轴）</li><li>第一行当中，只有第一列当中的第一个存在（1，1），不进行比较；</li><li>第二行当中，只有第一列当中的第二个存在（1，2），进行与第一行当中的第一列当中的第一个（1，1）比较；得出这两个元素之间的遗漏数为0，中间没有隔元素，说白了，就是没有隔没有相同元素的行。</li><li>第三行当中，第二列（2，3）与第三列（3，3）当中存在，则与第二行的进行比较，行与行之间没有隔没有相同元素的行，所以遗漏数也是0。</li><li>第四行当中，第四列（4，4）存在相同元素，所以第三行在与第四行进行比较的时候，也是遗漏数为0。</li><li>重点来了，第五行当中不存在有相同元素。所以无法进行算端点与端点得出段的这个算这个遗漏数。</li><li>终于到了第六行，第六行当中，存在有（1，6）位置上的元素，所以此时，第六行与第四行的进行比较，不这样说吧，就是第四行的去与第六行的去进行比较，由于第五行不存在有相同元素，所以第五行是空着的，这样第六行与第四行之间就存在有遗漏数了。</li><li>说白了，也就是行与行之间的这个算了。存在有隔着的行就是有遗漏数了。跟单排一样的道理。我这个脑子没想明白。</li></ol><p>好了不说了，这个树晾了几天了。</p><blockquote><p>主要代码[ fillDataToTable ]：</p></blockquote><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 给detailData表格填充数据</span></span><br><span class="line"><span class="comment">     * @param sumArrays 所有数据</span></span><br><span class="line"><span class="comment"> * @param arrays 前端页面展示的数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> function fillDataToTable(<span class="built_in">arrays</span>,sumArrays)&#123;</span><br><span class="line"> //清空表格数据</span><br><span class="line"><span class="built_in">var</span> detailData=document.getElementById(<span class="string">"detailData"</span>);</span><br><span class="line">detailData.innerHTML=<span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">//表格插入表头数据</span><br><span class="line"><span class="built_in">var</span> <span class="built_in">row</span>=detailData.insertRow(<span class="number">0</span>);</span><br><span class="line"><span class="built_in">row</span>.<span class="built_in">style</span>.fontWeight=<span class="string">"bolder"</span>;</span><br><span class="line"><span class="built_in">var</span> cell0=<span class="built_in">row</span>.insertCell(<span class="number">0</span>);</span><br><span class="line">cell0.innerHTML=<span class="string">"期数"</span>;</span><br><span class="line"><span class="built_in">var</span> cell1=<span class="built_in">row</span>.insertCell(<span class="number">1</span>);</span><br><span class="line">cell1.innerHTML=<span class="string">"开奖日期"</span>;</span><br><span class="line"><span class="built_in">var</span> cell2=<span class="built_in">row</span>.insertCell(<span class="number">2</span>);</span><br><span class="line"> cell2.innerHTML=<span class="string">"第一位数"</span>;</span><br><span class="line"><span class="built_in">var</span> cell3=<span class="built_in">row</span>.insertCell(<span class="number">3</span>);</span><br><span class="line"> cell3.innerHTML=<span class="string">"第二位数"</span>;</span><br><span class="line"><span class="built_in">var</span> cell4=<span class="built_in">row</span>.insertCell(<span class="number">4</span>);</span><br><span class="line">cell4.innerHTML=<span class="string">"第三位数"</span>;</span><br><span class="line"><span class="built_in">var</span> cell5=<span class="built_in">row</span>.insertCell(<span class="number">5</span>);</span><br><span class="line">cell5.innerHTML=<span class="string">"第四位数"</span>;</span><br><span class="line"><span class="built_in">var</span> cell6=<span class="built_in">row</span>.insertCell(<span class="number">6</span>);</span><br><span class="line">cell6.innerHTML=<span class="string">"第五位数"</span>;</span><br><span class="line"><span class="built_in">var</span> cell7=<span class="built_in">row</span>.insertCell(<span class="number">7</span>);</span><br><span class="line">cell7.innerHTML=<span class="string">"第六位数"</span>;</span><br><span class="line"><span class="built_in">var</span> cell8=<span class="built_in">row</span>.insertCell(<span class="number">8</span>);</span><br><span class="line">cell8.innerHTML=<span class="string">"第七位数"</span>;</span><br><span class="line"><span class="built_in">var</span> cell9=<span class="built_in">row</span>.insertCell(<span class="number">9</span>);</span><br><span class="line"> cell9.innerHTML=<span class="string">"操作"</span>;</span><br><span class="line"></span><br><span class="line">//表格分页数据插入</span><br><span class="line"><span class="keyword">for</span>(<span class="built_in">var</span> i=<span class="number">0</span>;i&lt;<span class="built_in">arrays</span>.<span class="built_in">length</span>;i++)&#123;</span><br><span class="line"><span class="built_in">var</span> json=<span class="built_in">arrays</span>[i];</span><br><span class="line"><span class="built_in">var</span> row2=detailData.insertRow(i+<span class="number">1</span>);</span><br><span class="line"><span class="built_in">var</span> cell0=row2.insertCell(<span class="number">0</span>);</span><br><span class="line">cell0.innerHTML=json.number;</span><br><span class="line"><span class="built_in">var</span> cell1=row2.insertCell(<span class="number">1</span>);</span><br><span class="line">cell1.innerHTML=json.createTime;</span><br><span class="line"><span class="built_in">var</span> cell2=row2.insertCell(<span class="number">2</span>);</span><br><span class="line">cell2.innerHTML=json.oneColumn;</span><br><span class="line"><span class="built_in">var</span> cell3=row2.insertCell(<span class="number">3</span>);</span><br><span class="line">cell3.innerHTML=json.twoColumn;</span><br><span class="line"><span class="built_in">var</span> cell4=row2.insertCell(<span class="number">4</span>);</span><br><span class="line">cell4.innerHTML=json.threeColumn;</span><br><span class="line"><span class="built_in">var</span> cell5=row2.insertCell(<span class="number">5</span>);</span><br><span class="line">cell5.innerHTML=json.fourColumn;</span><br><span class="line"><span class="built_in">var</span> cell6=row2.insertCell(<span class="number">6</span>);</span><br><span class="line">cell6.innerHTML=json.fiveColumn;</span><br><span class="line"><span class="built_in">var</span> cell7=row2.insertCell(<span class="number">7</span>);</span><br><span class="line">cell7.innerHTML=json.sixColumn;</span><br><span class="line"><span class="built_in">var</span> cell8=row2.insertCell(<span class="number">8</span>);</span><br><span class="line">cell8.innerHTML=json.sevenColumn;</span><br><span class="line"><span class="built_in">var</span> cell9=row2.insertCell(<span class="number">9</span>);</span><br><span class="line">cell9.innerHTML=<span class="string">"&lt;button onclick=\"show(this,"</span>+json.id+<span class="string">")\" class=\"btn btn-primary\" data-toggle=\"modal\" data-target=\"#myModal\" &gt;编辑&lt;/button&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//单排遗漏数计算  总排遗漏数的计算应该简单，即每一排当中的最小值index，与每一排的最大值index取出来放入集合最后遍历出最小index与最大indeax进行相减即可</span><br><span class="line">//将总数据中sumArrays每一列数组分组出来形成sumArray=[oneArray[oneColumn,...],twoArray[twoColumn,...],...,sevenArray[sevenColumn,...]]</span><br><span class="line"> <span class="built_in">var</span> oneArray=[], twoArray=[], threeArray=[], fourArray=[],  fiveArray=[],  sixArray=[],  sevenArray=[], sumArray=[];</span><br><span class="line"> <span class="keyword">for</span>(<span class="built_in">var</span> i=<span class="number">0</span>;i&lt;sumArrays.<span class="built_in">length</span>;i++)&#123;</span><br><span class="line"> <span class="built_in">var</span> json=sumArrays[i];</span><br><span class="line"> oneArray.<span class="built_in">push</span>(json.oneColumn);</span><br><span class="line"> twoArray.<span class="built_in">push</span>(json.twoColumn);</span><br><span class="line"> threeArray.<span class="built_in">push</span>(json.threeColumn);</span><br><span class="line"> fourArray.<span class="built_in">push</span>(json.fourColumn);</span><br><span class="line"> fiveArray.<span class="built_in">push</span>(json.fiveColumn);</span><br><span class="line"> sixArray.<span class="built_in">push</span>(json.sixColumn);</span><br><span class="line"> sevenArray.<span class="built_in">push</span>(json.sevenColumn);</span><br><span class="line"> &#125;</span><br><span class="line"> //插入<span class="number">7</span>列数组数据</span><br><span class="line"> sumArray.<span class="built_in">push</span>(oneArray);</span><br><span class="line"> sumArray.<span class="built_in">push</span>(twoArray);</span><br><span class="line"> sumArray.<span class="built_in">push</span>(threeArray);</span><br><span class="line"> sumArray.<span class="built_in">push</span>(fourArray);</span><br><span class="line"> sumArray.<span class="built_in">push</span>(fiveArray);</span><br><span class="line"> sumArray.<span class="built_in">push</span>(sixArray);</span><br><span class="line"> sumArray.<span class="built_in">push</span>(sevenArray);</span><br><span class="line"></span><br><span class="line"> //底部表头插入</span><br><span class="line"> <span class="built_in">var</span> tr0=detailData.insertRow(<span class="built_in">arrays</span>.<span class="built_in">length</span>+<span class="number">1</span>);</span><br><span class="line"> <span class="built_in">var</span> td0=tr0.insertCell(<span class="number">0</span>);</span><br><span class="line"> td0.colSpan=<span class="number">2</span>;</span><br><span class="line"> td0.innerHTML=<span class="string">"遗漏信息"</span>;</span><br><span class="line"> td0.<span class="built_in">style</span>.fontWeight=<span class="string">"bolder"</span>;</span><br><span class="line"> <span class="built_in">var</span> td00=tr0.insertCell(<span class="number">1</span>);</span><br><span class="line"> td00.colSpan=<span class="number">8</span>;</span><br><span class="line"></span><br><span class="line"> <span class="built_in">var</span> <span class="built_in">tr</span>=detailData.insertRow(<span class="built_in">arrays</span>.<span class="built_in">length</span>+<span class="number">2</span>);</span><br><span class="line"> <span class="built_in">var</span> td=<span class="built_in">tr</span>.insertCell(<span class="number">0</span>);</span><br><span class="line"> td.<span class="built_in">style</span>.fontWeight=<span class="string">"bolder"</span>;</span><br><span class="line"> td.innerHTML=<span class="string">"数字 | 单排最大遗漏数 | 总排最大遗漏数"</span>;</span><br><span class="line"> td.colSpan=<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"> //根据所查询的number分隔逗号，计算并得到其遗漏信息(数字、单排最大遗漏数、总排最大遗漏数)</span><br><span class="line"> <span class="built_in">var</span> numbers=document.getElementById(<span class="string">"number"</span>).value.trim();</span><br><span class="line"> console.<span class="built_in">log</span>(<span class="string">"nums: "</span>+numbers.<span class="built_in">split</span>(<span class="string">","</span>));</span><br><span class="line"></span><br><span class="line">//需要查询的number为空；则不进行显示其遗漏信息</span><br><span class="line"> <span class="keyword">if</span>(numbers==null || numbers=='' || numbers==undefined)&#123;</span><br><span class="line"> <span class="built_in">var</span> td11=<span class="built_in">tr</span>.insertCell(<span class="number">1</span>);</span><br><span class="line"> td11.colSpan=<span class="number">8</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> //需要查询的number不为空；则进行显示其遗漏信息</span><br><span class="line"> <span class="keyword">else</span>&#123;</span><br><span class="line"> <span class="built_in">var</span> nums=numbers.<span class="built_in">split</span>(<span class="string">","</span>); //则遗漏信息、数字、单排最大遗漏数进行显示 循环查询每个数值的单排 总排</span><br><span class="line"></span><br><span class="line"> //需要查询的number遗漏信息数组的长度进行循环得到</span><br><span class="line"> <span class="keyword">for</span>(<span class="built_in">var</span> h=<span class="number">0</span>;h&lt;nums.<span class="built_in">length</span>;h++)&#123;</span><br><span class="line">  <span class="built_in">var</span> number=nums[h];//查询的数值</span><br><span class="line"> <span class="built_in">var</span> singleMap=<span class="built_in">new</span> Map();//关于该数值的单排最大遗漏数</span><br><span class="line"> <span class="built_in">var</span> sumList=[];</span><br><span class="line"> // <span class="built_in">var</span> minIndexMap=<span class="built_in">new</span> Map();//每一列， 每一个单排当中的最小index</span><br><span class="line"> // <span class="built_in">var</span> maxIndexMap=<span class="built_in">new</span> Map();//每一列， 每一个单排当中的最大index</span><br><span class="line"></span><br><span class="line"> <span class="keyword">for</span>(<span class="built_in">var</span> t=<span class="number">0</span>;t&lt;sumArray.<span class="built_in">length</span>;t++)&#123; //当前<span class="number">7</span>个数组当中都存有对应的关于该需要进行查询遗漏信息的数值number,循环<span class="number">7</span>次,在七列当中进行查找以及得到它们所在的index</span><br><span class="line"> <span class="built_in">var</span> arrays2=sumArray[t];//总共有<span class="number">7</span>列，当前第t，单个数组</span><br><span class="line"> <span class="built_in">var</span> <span class="built_in">map</span>=<span class="built_in">new</span> Map();</span><br><span class="line"></span><br><span class="line"> <span class="keyword">for</span>(<span class="built_in">var</span> i=<span class="number">0</span>;i&lt;arrays2.<span class="built_in">length</span>;i++) &#123; //每一列数组元素的循环</span><br><span class="line"> <span class="built_in">var</span> element = arrays2[i]; //当前七列中第t列数组当中具体的元素</span><br><span class="line"> <span class="keyword">if</span> (number == element) &#123;</span><br><span class="line"> <span class="keyword">if</span>(<span class="built_in">map</span>.<span class="built_in">get</span>(element)==null || <span class="built_in">map</span>.<span class="built_in">get</span>(element)==undefined)&#123;</span><br><span class="line"><span class="built_in">map</span>.<span class="built_in">put</span>(element, &#123;prior: null, curr: null, size: null&#125;); //<span class="built_in">map</span>.<span class="built_in">put</span>(element,<span class="number">0</span>);//放入了该列当中所有不重复元素以及其实时变化的位移index+<span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">for</span>(<span class="built_in">var</span> n=<span class="number">0</span>;n&lt;arrays2.<span class="built_in">length</span>;n++)&#123;</span><br><span class="line"> <span class="built_in">var</span> <span class="built_in">key</span>=arrays2[n]; //当前七列中第t列数组当中具体的元素</span><br><span class="line"> <span class="keyword">if</span>(<span class="built_in">key</span>!=null &amp;&amp; <span class="built_in">key</span>==element &amp;&amp; number == <span class="built_in">key</span>)&#123; //如果存在有当前循环的数组当中的取值与<span class="built_in">map</span>当中的键相同的则重新赋值，重新赋值后进行<span class="built_in">break</span>;//<span class="built_in">var</span> y=i-n;</span><br><span class="line"> sumList.<span class="built_in">push</span>(n);</span><br><span class="line"></span><br><span class="line"> //存储每一个元素他的前一位相同元素的下标；y为当前元素的下标</span><br><span class="line"> <span class="keyword">if</span>((<span class="built_in">map</span>.<span class="built_in">get</span>(element)!=null &amp;&amp; <span class="built_in">map</span>.<span class="built_in">get</span>(element)!=undefined)</span><br><span class="line"> &amp;&amp; <span class="built_in">map</span>.<span class="built_in">get</span>(element).prior==null &amp;&amp; <span class="built_in">map</span>.<span class="built_in">get</span>(element).curr==null &amp;&amp; <span class="built_in">map</span>.<span class="built_in">get</span>(element).size==null)&#123;</span><br><span class="line"> <span class="built_in">map</span>.<span class="built_in">put</span>(element,&#123;prior: n, curr: n, size: <span class="number">0</span>&#125;); //第一次遇到元素相同的时候</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">if</span>((<span class="built_in">map</span>.<span class="built_in">get</span>(element)!=null &amp;&amp; <span class="built_in">map</span>.<span class="built_in">get</span>(element)!=undefined)</span><br><span class="line"> &amp;&amp; (<span class="built_in">map</span>.<span class="built_in">get</span>(element).prior!=null &amp;&amp; <span class="built_in">map</span>.<span class="built_in">get</span>(element).curr!=null &amp;&amp; <span class="built_in">map</span>.<span class="built_in">get</span>(element).size!=null)</span><br><span class="line">  &amp;&amp; <span class="built_in">map</span>.<span class="built_in">get</span>(element).prior==<span class="built_in">map</span>.<span class="built_in">get</span>(element).curr)&#123;</span><br><span class="line"> <span class="built_in">map</span>.<span class="built_in">put</span>(element,&#123;prior: <span class="built_in">map</span>.<span class="built_in">get</span>(element).prior, curr: n, size: n-<span class="built_in">map</span>.<span class="built_in">get</span>(element).prior&#125;); //第二次遇到元素相同的时候</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">if</span>((<span class="built_in">map</span>.<span class="built_in">get</span>(element)!=null &amp;&amp; <span class="built_in">map</span>.<span class="built_in">get</span>(element)!=undefined)</span><br><span class="line"> &amp;&amp; (<span class="built_in">map</span>.<span class="built_in">get</span>(element).prior!=null &amp;&amp; <span class="built_in">map</span>.<span class="built_in">get</span>(element).curr!=null  &amp;&amp; <span class="built_in">map</span>.<span class="built_in">get</span>(element).size!=null)</span><br><span class="line"> &amp;&amp; <span class="built_in">map</span>.<span class="built_in">get</span>(element).prior!=<span class="built_in">map</span>.<span class="built_in">get</span>(element).curr) &#123;</span><br><span class="line">  // 此时 <span class="built_in">map</span> 中的 curr 即当前 <span class="built_in">key</span> 的相同元素的上一位置 prior 的 index ;取出 prior;</span><br><span class="line"> // 得到当前 <span class="built_in">key</span> index 与当前 <span class="built_in">key</span> index 的 prior 的 size；</span><br><span class="line"> // 如果当前 size较之此时<span class="built_in">map</span>当中element元素的size要大，则进行替换</span><br><span class="line"> <span class="built_in">var</span> currPrior=<span class="built_in">map</span>.<span class="built_in">get</span>(element).curr; //当前的上一位</span><br><span class="line"> <span class="built_in">var</span> currSize=n-currPrior; //当前的大小</span><br><span class="line"> <span class="built_in">var</span> priorSize=<span class="built_in">map</span>.<span class="built_in">get</span>(element).size; //上一位的大小</span><br><span class="line"> <span class="keyword">if</span>(currSize&gt;priorSize)&#123;</span><br><span class="line"> <span class="built_in">map</span>.<span class="built_in">put</span>(element,&#123;prior:currPrior, curr:n, size:currSize&#125;);</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"> continue;//跳出对于第i列数组中element元素对于当前n数组的当次循环，进入当前n数组迭代下一元素<span class="built_in">key</span>的循环</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> console.<span class="built_in">log</span>(<span class="string">"第"</span>+t+<span class="string">"列当中，每一个元素的单排最大遗漏数："</span>+JSON.stringify(<span class="built_in">map</span>));</span><br><span class="line"> <span class="keyword">if</span>(<span class="built_in">map</span>.<span class="built_in">get</span>(number)!=null || <span class="built_in">map</span>.<span class="built_in">get</span>(number)!=undefined)&#123;</span><br><span class="line"> //取值则为当前该<span class="built_in">map</span>.<span class="built_in">get</span>(number)即当前列当中的单排最大遗漏数</span><br><span class="line"> singleMap.<span class="built_in">put</span>(t,<span class="built_in">map</span>.<span class="built_in">get</span>(number).size-<span class="number">1</span>);//singleMap.<span class="built_in">put</span>(t,<span class="built_in">map</span>.<span class="built_in">get</span>(number)-<span class="number">1</span>);//<span class="built_in">key</span> t：哪一列， value 当前该数值在当前排t的最大遗漏数  <span class="built_in">map</span>.<span class="built_in">get</span>(number)需要减去<span class="number">1</span></span><br><span class="line"> &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"> //当前列取出number如果为空则说明当前列当中不存在有该数值，则替换为<span class="number">0</span></span><br><span class="line"> singleMap.<span class="built_in">put</span>(t,'当前列不存在'+number);</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> //遍历完<span class="number">7</span>个数组后得到当前查询的该数值的所有index</span><br><span class="line"> //得到当前查询的该数值的在<span class="number">7</span>列中的所有index，并进行index排序<span class="built_in">sort</span>,每一个index都与index.next进行比较得到size</span><br><span class="line"> //定义maxSize变量，并进行赋值</span><br><span class="line"> sumList.<span class="built_in">sort</span>(sortNumber);</span><br><span class="line"> <span class="built_in">var</span> sumMaxNumber=null;</span><br><span class="line"> <span class="keyword">if</span>(sumList.<span class="built_in">length</span>==<span class="number">0</span>)&#123;</span><br><span class="line"> sumMaxNumber='不存在';</span><br><span class="line"> &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"> <span class="keyword">for</span>(<span class="built_in">var</span> g=<span class="number">0</span>;g&lt;sumList.<span class="built_in">length</span>;g++)&#123;</span><br><span class="line"> <span class="keyword">if</span>(sumMaxNumber==null)&#123;</span><br><span class="line"> sumMaxNumber=sumList[g+<span class="number">1</span>]-sumList[g];</span><br><span class="line"> &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"> <span class="built_in">var</span> nextSize=sumList[g+<span class="number">1</span>]-sumList[g];</span><br><span class="line"> <span class="keyword">if</span>(nextSize&gt;sumMaxNumber)&#123;</span><br><span class="line">sumMaxNumber=nextSize;</span><br><span class="line">&#125;</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="built_in">var</span> mapArrays=singleMap.entrys();//循环之后获取得到singleMap,即单排数</span><br><span class="line"> <span class="keyword">if</span> (h == <span class="number">0</span>) &#123; //即第一个数值的时候填入行<span class="built_in">tr</span>:<span class="built_in">arrays</span>.<span class="built_in">length</span>+<span class="number">2</span></span><br><span class="line"> td.innerHTML=<span class="string">"数字: "</span>+number+<span class="string">" | 单排最大遗漏数 | 总排最大遗漏数: "</span>+sumMaxNumber;</span><br><span class="line"> <span class="keyword">for</span>(<span class="built_in">var</span> r=<span class="number">0</span>;r&lt;mapArrays.<span class="built_in">length</span>;r++) &#123;</span><br><span class="line"> <span class="built_in">var</span> td22 = <span class="built_in">tr</span>.insertCell(r+<span class="number">1</span>);//当前行处于第一行</span><br><span class="line"> td22.innerHTML = singleMap.<span class="built_in">get</span>(r);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="built_in">tr</span>.insertCell(mapArrays.<span class="built_in">length</span>+<span class="number">1</span>);</span><br><span class="line"> &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"> //新增行并插入</span><br><span class="line"> <span class="built_in">var</span> newTr=detailData.insertRow(<span class="built_in">arrays</span>.<span class="built_in">length</span>+<span class="number">2</span>+h);</span><br><span class="line"> <span class="built_in">var</span> newTd=newTr.insertCell(<span class="number">0</span>);</span><br><span class="line"> newTd.innerHTML=<span class="string">"数字: "</span>+number+<span class="string">" | 单排最大遗漏数 | 总排最大遗漏数: "</span>+sumMaxNumber;</span><br><span class="line"> newTd.<span class="built_in">style</span>.fontWeight=<span class="string">"bolder"</span>;</span><br><span class="line"> newTd.colSpan=<span class="number">2</span>;</span><br><span class="line"> <span class="keyword">for</span>(<span class="built_in">var</span> r=<span class="number">0</span>;r&lt;mapArrays.<span class="built_in">length</span>;r++) &#123;</span><br><span class="line"> <span class="built_in">var</span> td22 = newTr.insertCell(r+<span class="number">1</span>);//从第二行开始进行新增列</span><br><span class="line"> td22.innerHTML = singleMap.<span class="built_in">get</span>(r);</span><br><span class="line"> &#125;</span><br><span class="line"> newTr.insertCell(mapArrays.<span class="built_in">length</span>+<span class="number">1</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> console.<span class="built_in">log</span>(<span class="string">"================== 查询数值："</span>+number+<span class="string">" END =================="</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>下面小哥我就贴一下全部的代码哟：</p></blockquote><figure class="highlight erb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ page import=<span class="string">"com.alibaba.fastjson.JSONObject"</span> </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ page import=<span class="string">"java.util.ArrayList"</span> </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ page import=<span class="string">"java.util.HashMap"</span> </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ page import=<span class="string">"java.util.List"</span> </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ page import=<span class="string">"java.util.Map"</span> </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ page import=<span class="string">"com.maima.entity.MaiMa"</span> </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ page import=<span class="string">"com.maima.entity.TUserInfo"</span> </span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span></span><br><span class="line"><span class="ruby"> pageEncoding=<span class="string">"UTF-8"</span></span><span class="xml">%&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ page trimDirectiveWhitespaces=<span class="string">"true"</span></span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ taglib prefix=<span class="string">"c"</span> uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span></span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ taglib prefix=<span class="string">"itcast"</span> uri=<span class="string">"http://itcast.cn/common/"</span></span><span class="xml"><span class="tag">%&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span></span><br><span class="line"><span class="ruby">TUserInfo tUserInfo=(TUserInfo) request.getSession().getAttribute(<span class="string">"tUserInfo"</span>);</span></span><br><span class="line"><span class="ruby"><span class="keyword">if</span>(tUserInfo==null)&#123;</span></span><br><span class="line"><span class="ruby">String path = request.getContextPath();</span></span><br><span class="line"><span class="ruby">String basePath = request.getScheme() + <span class="string">"://"</span> + request.getServerName() + <span class="string">":"</span> + request.getServerPort()</span></span><br><span class="line"><span class="ruby">+ path + <span class="string">"/"</span>;</span></span><br><span class="line"><span class="ruby">response.sendRedirect(basePath+<span class="string">"maima/index"</span>);</span></span><br><span class="line"><span class="ruby">&#125;</span></span><br><span class="line"><span class="xml">%&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="meta-string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns</span>=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"description"</span> <span class="attr">content</span>=<span class="string">""</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"author"</span> <span class="attr">content</span>=</span></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- Bootstrap Core CSS --&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"/static/css/bootstrap.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"/static/css/metisMenu.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"/static/css/dataTables.bootstrap.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"/static/css/sb-admin-2.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"/static/css/font-awesome.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span></span></span></span><br><span class="line"><span class="xml">  type="text/css"&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"/static/css/boot-crm.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span></span></span></span><br><span class="line"><span class="xml">  type="text/css"&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"https://cdn.bootcss.com/bootstrap-datetimepicker/4.17.47/css/bootstrap-datetimepicker.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">![endif]--</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span></span><br><span class="line"><span class="xml">.inputText&#123;</span></span><br><span class="line"><span class="xml">width:200px;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">.alert &#123;</span></span><br><span class="line"><span class="xml">display: none;</span></span><br><span class="line"><span class="xml">position: fixed;</span></span><br><span class="line"><span class="xml">top: 50%;</span></span><br><span class="line"><span class="xml">left: 50%;</span></span><br><span class="line"><span class="xml">min-width: 300px;</span></span><br><span class="line"><span class="xml">max-width: 600px;</span></span><br><span class="line"><span class="xml">transform: translate(-50%,-50%);</span></span><br><span class="line"><span class="xml">z-index: 99999;</span></span><br><span class="line"><span class="xml">text-align: center;</span></span><br><span class="line"><span class="xml">padding: 15px;</span></span><br><span class="line"><span class="xml">border-radius: 3px;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">.alert-success &#123;</span></span><br><span class="line"><span class="xml">color: #3c763d;</span></span><br><span class="line"><span class="xml">background-color: #dff0d8;</span></span><br><span class="line"><span class="xml">border-color: #d6e9c6;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">.alert-info &#123;</span></span><br><span class="line"><span class="xml">color: #31708f;</span></span><br><span class="line"><span class="xml">background-color: #d9edf7;</span></span><br><span class="line"><span class="xml">border-color: #bce8f1;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">.alert-warning &#123;</span></span><br><span class="line"><span class="xml">color: #8a6d3b;</span></span><br><span class="line"><span class="xml">background-color: #fcf8e3;</span></span><br><span class="line"><span class="xml">border-color: #faebcc;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">.alert-danger &#123;</span></span><br><span class="line"><span class="xml">color: #a94442;</span></span><br><span class="line"><span class="xml">background-color: #f2dede;</span></span><br><span class="line"><span class="xml">border-color: #ebccd1;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- 模态框（Modal） --&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal fade"</span> <span class="attr">id</span>=<span class="string">"myModal"</span> <span class="attr">tabindex</span>=<span class="string">"-1"</span> <span class="attr">role</span>=<span class="string">"dialog"</span> <span class="attr">aria-labelledby</span>=<span class="string">"myModalLabel"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-dialog"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-content"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-header"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"close"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="symbol">&amp;times;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">h4</span> <span class="attr">class</span>=<span class="string">"modal-title"</span> <span class="attr">id</span>=<span class="string">"myModalLabel"</span>&gt;</span>编辑<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-body"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"number"</span>&gt;</span>编号 <span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span>  <span class="attr">class</span>=<span class="string">"form-control inputText"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"id"</span> <span class="attr">readonly</span>=<span class="string">"readonly"</span> /&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"number"</span>&gt;</span>期数 <span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span>  <span class="attr">class</span>=<span class="string">"form-control inputText"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"numberId"</span> /&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"number"</span>&gt;</span>开奖日期 <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">'input-group date'</span>  <span class="attr">style</span>=<span class="string">"width: 200px;"</span>  <span class="attr">id</span>=<span class="string">'datetimepicker3'</span> &gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">'text'</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">'createTime'</span>/&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-addon"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-calendar"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"number"</span>&gt;</span>第一位数 <span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control inputText"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"oneColumn"</span> /&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"number"</span>&gt;</span>第二位数 <span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control inputText"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"twoColumn"</span> /&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"number"</span>&gt;</span>第三位数 <span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control inputText"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"threeColumn"</span> /&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"number"</span>&gt;</span>第四位数 <span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control inputText"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"fourColumn"</span> /&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"number"</span>&gt;</span>第五位数 <span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control inputText"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"fiveColumn"</span> /&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"number"</span>&gt;</span>第六位数 <span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control inputText"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"sixColumn"</span> /&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"number"</span>&gt;</span>第七位数 <span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control inputText"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"sevenColumn"</span> /&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-footer"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span>&gt;</span>关闭<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">onclick</span>=<span class="string">"edit()"</span>&gt;</span>提交更改<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- 模态框（Modal） --&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal fade"</span> <span class="attr">id</span>=<span class="string">"myModal2"</span> <span class="attr">tabindex</span>=<span class="string">"-1"</span> <span class="attr">role</span>=<span class="string">"dialog"</span> <span class="attr">aria-labelledby</span>=<span class="string">"myModalLabel"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-dialog"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-content"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-header"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"close"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal2"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="symbol">&amp;times;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">h4</span> <span class="attr">class</span>=<span class="string">"modal-title"</span> <span class="attr">id</span>=<span class="string">"myModalLabel2"</span>&gt;</span>新增<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-body"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"number"</span>&gt;</span>期数 <span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control inputText"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"numberId2"</span> /&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"number"</span>&gt;</span>开奖日期 <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">'input-group date'</span>  <span class="attr">style</span>=<span class="string">"width: 200px;"</span>  <span class="attr">id</span>=<span class="string">'datetimepicker4'</span> &gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">'text'</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">'createTime2'</span> /&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-addon"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-calendar"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"number"</span>&gt;</span>第一位数 <span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control inputText"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"oneColumn2"</span> /&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"number"</span>&gt;</span>第二位数 <span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control inputText"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"twoColumn2"</span> /&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"number"</span>&gt;</span>第三位数 <span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control inputText"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"threeColumn2"</span> /&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"number"</span>&gt;</span>第四位数 <span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control inputText"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"fourColumn2"</span> /&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"number"</span>&gt;</span>第五位数 <span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control inputText"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"fiveColumn2"</span> /&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"number"</span>&gt;</span>第六位数 <span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control inputText"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"sixColumn2"</span> /&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"number"</span>&gt;</span>第七位数 <span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control inputText"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"sevenColumn2"</span> /&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-footer"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span>&gt;</span>关闭<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">onclick</span>=<span class="string">"add()"</span>&gt;</span>提交更改<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"alert"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"wrapper"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"page-wrapper"</span> <span class="attr">style</span>=<span class="string">"height: 100%"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel panel-default"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"number"</span>&gt;</span>数字搜索 <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"number"</span> <span class="attr">value</span>=<span class="string">"$&#123;number&#125;"</span> <span class="attr">name</span>=<span class="string">"number"</span> <span class="attr">style</span>=<span class="string">"width: 200px;"</span>/&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"page"</span> <span class="attr">value</span>=<span class="string">"$&#123;page&#125;"</span> <span class="attr">name</span>=<span class="string">"page"</span> <span class="attr">style</span>=<span class="string">"display: none;"</span> /&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"pageSize"</span> <span class="attr">value</span>=<span class="string">"$&#123;pageSize&#125;"</span> <span class="attr">name</span>=<span class="string">"pageSize"</span>  <span class="attr">style</span>=<span class="string">"display: none;"</span> /&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">label</span>&gt;</span>开始日期 <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">'input-group date'</span> <span class="attr">id</span>=<span class="string">'datetimepicker1'</span> <span class="attr">style</span>=<span class="string">"width: 200px;"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">'text'</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"createTime3"</span>/&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-addon"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-calendar"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">label</span>&gt;</span>结束日期 <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">'input-group date'</span> <span class="attr">id</span>=<span class="string">'datetimepicker2'</span> <span class="attr">style</span>=<span class="string">"width: 200px;"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">'text'</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"createTime4"</span> /&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-addon"</span>&gt;</span></span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-calendar"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">                <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"go()"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>查询<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">style</span>=<span class="string">"margin-left:10px"</span> <span class="attr">onclick</span>=<span class="string">"reset()"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>清空<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">style</span>=<span class="string">"margin-left:10px"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">data-toggle</span>=<span class="string">"modal"</span> <span class="attr">data-target</span>=<span class="string">"#myModal2"</span>&gt;</span>新增<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-lg-12"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel panel-default"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-bordered table-striped"</span> <span class="attr">id</span>=<span class="string">"detailData"</span> <span class="attr">style</span>=<span class="string">"text-align: center;"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-lg-12"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel panel-default"</span> <span class="attr">style</span>=<span class="string">"text-align: right"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">onclick</span>=<span class="string">"up()"</span>&gt;</span>上一页<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">onclick</span>=<span class="string">"down()"</span>&gt;</span>下一页<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/static/js/jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"/static/js/jquery-ui.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/static/js/bootstrap.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/static/js/metisMenu.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/static/js/jquery.dataTables.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/static/js/dataTables.bootstrap.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/static/js/sb-admin-2.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">'/static/js/stopExecutionOnTimeout.js?t=1'</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"/static/layui/layui.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"/static/js/Particleground.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"/static/js/Treatment.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"/static/js/jquery.mockjax.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcss.com/moment.js/2.24.0/moment-with-locales.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcss.com/bootstrap-datetimepicker/4.17.47/js/bootstrap-datetimepicker.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span></span><br><span class="line"><span class="xml">/**</span></span><br><span class="line"><span class="xml"> * 初始化日期组件1、2、3、4</span></span><br><span class="line"><span class="xml"> */</span></span><br><span class="line"><span class="xml">$(function () &#123;</span></span><br><span class="line"><span class="xml">for(var i=1;i<span class="tag">&lt;<span class="name">5;i++)&#123;</span></span></span></span><br><span class="line"><span class="xml">$('#datetimepicker'+i).datetimepicker(&#123;</span></span><br><span class="line"><span class="xml">format: 'YYYY-MM-DD',</span></span><br><span class="line"><span class="xml">locale: moment.locale('zh-cn')</span></span><br><span class="line"><span class="xml">&#125;);</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">&#125;);</span></span><br><span class="line"></span><br><span class="line"><span class="xml">/**</span></span><br><span class="line"><span class="xml"> * 弹出式提示框，默认1.2秒自动消失</span></span><br><span class="line"><span class="xml"> * @param message 提示信息</span></span><br><span class="line"><span class="xml"> * @param style 提示样式，有alert-success、alert-danger、alert-warning、alert-info</span></span><br><span class="line"><span class="xml"> * @param time 消失时间</span></span><br><span class="line"><span class="xml"> */</span></span><br><span class="line"><span class="xml">var prompt = function (message, style, time)</span></span><br><span class="line"><span class="xml">&#123;</span></span><br><span class="line"><span class="xml">style = (style === undefined) ? 'alert-success' : style;</span></span><br><span class="line"><span class="xml">time = (time === undefined) ? 1200 : time;</span></span><br><span class="line"><span class="xml">$('<span class="tag">&lt;<span class="name">div</span>&gt;</span>')</span></span><br><span class="line"><span class="xml">.appendTo('body')</span></span><br><span class="line"><span class="xml">.addClass('alert ' + style)</span></span><br><span class="line"><span class="xml">.html(message)</span></span><br><span class="line"><span class="xml">.show()</span></span><br><span class="line"><span class="xml">.delay(time)</span></span><br><span class="line"><span class="xml">.fadeOut();</span></span><br><span class="line"><span class="xml">&#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">/**</span></span><br><span class="line"><span class="xml"> *  成功提示 - alert-success</span></span><br><span class="line"><span class="xml"> *  失败提示 - alert-danger</span></span><br><span class="line"><span class="xml"> *  提醒 - alert-warning</span></span><br><span class="line"><span class="xml"> *  信息提示 - alert-info</span></span><br><span class="line"><span class="xml"> */</span></span><br><span class="line"><span class="xml">var success_prompt = function(message, time)</span></span><br><span class="line"><span class="xml">&#123;</span></span><br><span class="line"><span class="xml">prompt(message, 'alert-success', time);</span></span><br><span class="line"><span class="xml">&#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">/**</span></span><br><span class="line"><span class="xml"> *  添加双色球</span></span><br><span class="line"><span class="xml"> */</span></span><br><span class="line"><span class="xml">function add()&#123;</span></span><br><span class="line"><span class="xml">console.log("==============add===============");</span></span><br><span class="line"><span class="xml">var numberId2=document.getElementById("numberId2").value;</span></span><br><span class="line"><span class="xml">var createTime2=document.getElementById("createTime2").value;</span></span><br><span class="line"><span class="xml">var oneColumn2=document.getElementById("oneColumn2").value;</span></span><br><span class="line"><span class="xml">var twoColumn2=document.getElementById("twoColumn2").value;</span></span><br><span class="line"><span class="xml">var threeColumn2=document.getElementById("threeColumn2").value;</span></span><br><span class="line"><span class="xml">var fourColumn2=document.getElementById("fourColumn2").value;</span></span><br><span class="line"><span class="xml">var fiveColumn2=document.getElementById("fiveColumn2").value;</span></span><br><span class="line"><span class="xml">var sixColumn2=document.getElementById("sixColumn2").value;</span></span><br><span class="line"><span class="xml">var sevenColumn2=document.getElementById("sevenColumn2").value;</span></span><br><span class="line"><span class="xml">if((numberId2==null || numberId2=='' || numberId2==undefined) ||</span></span><br><span class="line"><span class="xml">(createTime2==null || createTime2=='' || createTime2==undefined) ||</span></span><br><span class="line"><span class="xml">(oneColumn2==null || oneColumn2=='' || oneColumn2==undefined) ||</span></span><br><span class="line"><span class="xml">(twoColumn2==null || twoColumn2=='' || twoColumn2==undefined) ||</span></span><br><span class="line"><span class="xml">(threeColumn2==null || threeColumn2=='' || threeColumn2==undefined) ||</span></span><br><span class="line"><span class="xml">(fourColumn2==null || fourColumn2=='' || fourColumn2==undefined) ||</span></span><br><span class="line"><span class="xml">(fiveColumn2==null || fiveColumn2=='' || fiveColumn2==undefined) ||</span></span><br><span class="line"><span class="xml">(sixColumn2==null || sixColumn2=='' || sixColumn2==undefined) ||</span></span><br><span class="line"><span class="xml">(sevenColumn2==null || sevenColumn2=='' || sevenColumn2==undefined)</span></span><br><span class="line"><span class="xml">)&#123;</span></span><br><span class="line"><span class="xml">console.log("数据不完整,请检查参数并重新填写");</span></span><br><span class="line"><span class="xml">&#125;else&#123;</span></span><br><span class="line"><span class="xml">//发送请求进行新增</span></span><br><span class="line"><span class="xml">var requestDataBean = &#123;</span></span><br><span class="line"><span class="xml">numberId:numberId2,</span></span><br><span class="line"><span class="xml">createTime:createTime2,</span></span><br><span class="line"><span class="xml">oneColumn:oneColumn2,</span></span><br><span class="line"><span class="xml">twoColumn:twoColumn2,</span></span><br><span class="line"><span class="xml">threeColumn:threeColumn2,</span></span><br><span class="line"><span class="xml">fourColumn:fourColumn2,</span></span><br><span class="line"><span class="xml">fiveColumn:fiveColumn2,</span></span><br><span class="line"><span class="xml">sixColumn:sixColumn2,</span></span><br><span class="line"><span class="xml">sevenColumn:sevenColumn2</span></span><br><span class="line"><span class="xml">&#125;;</span></span><br><span class="line"><span class="xml">console.log("add - requestDataBean: "+JSON.stringify(requestDataBean));</span></span><br><span class="line"><span class="xml">var url="/maima/addMaiMa";</span></span><br><span class="line"><span class="xml">AjaxPost(url, requestDataBean,</span></span><br><span class="line"><span class="xml">function () &#123;</span></span><br><span class="line"><span class="xml">//ajax加载中</span></span><br><span class="line"><span class="xml">&#125;,</span></span><br><span class="line"><span class="xml">function (data) &#123;</span></span><br><span class="line"><span class="xml">console.log("========数据获取成功======");</span></span><br><span class="line"><span class="xml">if(data!=null &amp;&amp; data.Code!=null &amp;&amp; data.Code==200 &amp;&amp; data.Status!=null &amp;&amp; data.Status=="ok")&#123;</span></span><br><span class="line"><span class="xml">success_prompt(data.Msg,2000);</span></span><br><span class="line"><span class="xml">console.log("========FLUSH======");</span></span><br><span class="line"><span class="xml">go();//flush</span></span><br><span class="line"><span class="xml">&#125;else &#123;</span></span><br><span class="line"><span class="xml">fail_prompt(data.Msg,2000);</span></span><br><span class="line"><span class="xml">AjaxErro(data);</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">&#125;)</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">/**</span></span><br><span class="line"><span class="xml"> *  编辑双色球</span></span><br><span class="line"><span class="xml"> */</span></span><br><span class="line"><span class="xml">function edit()&#123;</span></span><br><span class="line"><span class="xml">console.log("==============edit===============");</span></span><br><span class="line"><span class="xml">var id=document.getElementById("id").value;</span></span><br><span class="line"><span class="xml">var numberId2=document.getElementById("numberId").value;</span></span><br><span class="line"><span class="xml">var createTime2=document.getElementById("createTime").value;</span></span><br><span class="line"><span class="xml">var oneColumn2=document.getElementById("oneColumn").value;</span></span><br><span class="line"><span class="xml">var twoColumn2=document.getElementById("twoColumn").value;</span></span><br><span class="line"><span class="xml">var threeColumn2=document.getElementById("threeColumn").value;</span></span><br><span class="line"><span class="xml">var fourColumn2=document.getElementById("fourColumn").value;</span></span><br><span class="line"><span class="xml">var fiveColumn2=document.getElementById("fiveColumn").value;</span></span><br><span class="line"><span class="xml">var sixColumn2=document.getElementById("sixColumn").value;</span></span><br><span class="line"><span class="xml">var sevenColumn2=document.getElementById("sevenColumn").value;</span></span><br><span class="line"><span class="xml">if((id==null || id=='' || id==undefined)||</span></span><br><span class="line"><span class="xml">(numberId2==null || numberId2=='' || numberId2==undefined) ||</span></span><br><span class="line"><span class="xml">(createTime2==null || createTime2=='' || createTime2==undefined) ||</span></span><br><span class="line"><span class="xml">(oneColumn2==null || oneColumn2=='' || oneColumn2==undefined) ||</span></span><br><span class="line"><span class="xml">(twoColumn2==null || twoColumn2=='' || twoColumn2==undefined) ||</span></span><br><span class="line"><span class="xml">(threeColumn2==null || threeColumn2=='' || threeColumn2==undefined) ||</span></span><br><span class="line"><span class="xml">(fourColumn2==null || fourColumn2=='' || fourColumn2==undefined) ||</span></span><br><span class="line"><span class="xml">(fiveColumn2==null || fiveColumn2=='' || fiveColumn2==undefined) ||</span></span><br><span class="line"><span class="xml">(sixColumn2==null || sixColumn2=='' || sixColumn2==undefined) ||</span></span><br><span class="line"><span class="xml">(sevenColumn2==null || sevenColumn2=='' || sevenColumn2==undefined)</span></span><br><span class="line"><span class="xml">)&#123;</span></span><br><span class="line"><span class="xml">console.log("数据不完整,请检查参数并重新填写");</span></span><br><span class="line"><span class="xml">&#125;else&#123;</span></span><br><span class="line"><span class="xml">//发送请求进行新增</span></span><br><span class="line"><span class="xml">var requestDataBean = &#123;</span></span><br><span class="line"><span class="xml">id:id,</span></span><br><span class="line"><span class="xml">numberId:numberId2,</span></span><br><span class="line"><span class="xml">createTime:createTime2,</span></span><br><span class="line"><span class="xml">oneColumn:oneColumn2,</span></span><br><span class="line"><span class="xml">twoColumn:twoColumn2,</span></span><br><span class="line"><span class="xml">threeColumn:threeColumn2,</span></span><br><span class="line"><span class="xml">fourColumn:fourColumn2,</span></span><br><span class="line"><span class="xml">fiveColumn:fiveColumn2,</span></span><br><span class="line"><span class="xml">sixColumn:sixColumn2,</span></span><br><span class="line"><span class="xml">sevenColumn:sevenColumn2</span></span><br><span class="line"><span class="xml">&#125;;</span></span><br><span class="line"><span class="xml">console.log("edit - requestDataBean: "+JSON.stringify(requestDataBean));</span></span><br><span class="line"><span class="xml">var url="/maima/editMaiMa";</span></span><br><span class="line"><span class="xml">AjaxPost(url, requestDataBean,</span></span><br><span class="line"><span class="xml">function () &#123;</span></span><br><span class="line"><span class="xml">//ajax加载中</span></span><br><span class="line"><span class="xml">&#125;,</span></span><br><span class="line"><span class="xml">function (data) &#123;</span></span><br><span class="line"><span class="xml">console.log("========数据获取成功======");</span></span><br><span class="line"><span class="xml">if(data!=null &amp;&amp; data.Code!=null &amp;&amp; data.Code==200 &amp;&amp; data.Status!=null &amp;&amp; data.Status=="ok")&#123;</span></span><br><span class="line"><span class="xml">success_prompt(data.Msg,2000);</span></span><br><span class="line"><span class="xml">console.log("========FLUSH======");</span></span><br><span class="line"><span class="xml">go();//flush</span></span><br><span class="line"><span class="xml">&#125;else &#123;</span></span><br><span class="line"><span class="xml">fail_prompt(data.Msg,2000);</span></span><br><span class="line"><span class="xml">AjaxErro(data);</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">&#125;)</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">/**</span></span><br><span class="line"><span class="xml"> * 重置</span></span><br><span class="line"><span class="xml"> */</span></span><br><span class="line"><span class="xml">function reset()&#123;</span></span><br><span class="line"><span class="xml">document.getElementById("number").value="";</span></span><br><span class="line"><span class="xml">document.getElementById("createTime3").value="";</span></span><br><span class="line"><span class="xml">document.getElementById("createTime4").value="";</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">/**</span></span><br><span class="line"><span class="xml"> * 用于编辑显示页面填入数据</span></span><br><span class="line"><span class="xml"> * @param obj 被点击编辑的按钮</span></span><br><span class="line"><span class="xml"> * @param id 该按钮所代表的的双色球记录id</span></span><br><span class="line"><span class="xml"> */</span></span><br><span class="line"><span class="xml">function show(obj,id)&#123;</span></span><br><span class="line"><span class="xml">var value0 = $(obj).parents("td").parents("tr").children("td").eq(0).text();</span></span><br><span class="line"><span class="xml">var value1 = $(obj).parents("td").parents("tr").children("td").eq(1).text();</span></span><br><span class="line"><span class="xml">var value2 = $(obj).parents("td").parents("tr").children("td").eq(2).text();</span></span><br><span class="line"><span class="xml">var value3 = $(obj).parents("td").parents("tr").children("td").eq(3).text();</span></span><br><span class="line"><span class="xml">var value4 = $(obj).parents("td").parents("tr").children("td").eq(4).text();</span></span><br><span class="line"><span class="xml">var value5 = $(obj).parents("td").parents("tr").children("td").eq(5).text();</span></span><br><span class="line"><span class="xml">var value6 = $(obj).parents("td").parents("tr").children("td").eq(6).text();</span></span><br><span class="line"><span class="xml">var value7 = $(obj).parents("td").parents("tr").children("td").eq(7).text();</span></span><br><span class="line"><span class="xml">var value8 = $(obj).parents("td").parents("tr").children("td").eq(8).text();</span></span><br><span class="line"><span class="xml">console.log("show - [numberId: "+value0+" ，createTime: "+value1+" ，oneColumn: "+value2+" ，twoColumn: "+value3+" ，threeColumn: "+value4+" ，fourColumn: "+value5+" ，fiveColumn: "+value6+" ，sixColumn: "+value7+" ，sevenColumn: "+value8+" ]");</span></span><br><span class="line"><span class="xml">document.getElementById("id").value=id;</span></span><br><span class="line"><span class="xml">document.getElementById("numberId").value=value0;</span></span><br><span class="line"><span class="xml">document.getElementById("createTime").value=value1;</span></span><br><span class="line"><span class="xml">document.getElementById("oneColumn").value=value2;</span></span><br><span class="line"><span class="xml">document.getElementById("twoColumn").value=value3;</span></span><br><span class="line"><span class="xml">document.getElementById("threeColumn").value=value4;</span></span><br><span class="line"><span class="xml">document.getElementById("fourColumn").value=value5;</span></span><br><span class="line"><span class="xml">document.getElementById("fiveColumn").value=value6;</span></span><br><span class="line"><span class="xml">document.getElementById("sixColumn").value=value7;</span></span><br><span class="line"><span class="xml">document.getElementById("sevenColumn").value=value8;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">function Map() &#123;</span></span><br><span class="line"><span class="xml">/** 存放键的数组(遍历用到) */</span></span><br><span class="line"><span class="xml">this.keys = new Array();</span></span><br><span class="line"><span class="xml">/** 存放数据 */</span></span><br><span class="line"><span class="xml">this.data = new Object();</span></span><br><span class="line"></span><br><span class="line"><span class="xml">/**</span></span><br><span class="line"><span class="xml"> * 放入一个键值对</span></span><br><span class="line"><span class="xml"> * @param &#123;String&#125; key</span></span><br><span class="line"><span class="xml"> * @param &#123;Object&#125; value</span></span><br><span class="line"><span class="xml"> */</span></span><br><span class="line"><span class="xml">this.put = function(key, value) &#123;</span></span><br><span class="line"><span class="xml">if(this.data[key] == null)&#123;</span></span><br><span class="line"><span class="xml">this.keys.push(key);</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">this.data[key] = value;</span></span><br><span class="line"><span class="xml">&#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">/**</span></span><br><span class="line"><span class="xml"> * 获取某键对应的值</span></span><br><span class="line"><span class="xml"> * @param &#123;String&#125; key</span></span><br><span class="line"><span class="xml"> * @return &#123;Object&#125; value</span></span><br><span class="line"><span class="xml"> */</span></span><br><span class="line"><span class="xml">this.get = function(key) &#123;</span></span><br><span class="line"><span class="xml">return this.data[key];</span></span><br><span class="line"><span class="xml">&#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">/**</span></span><br><span class="line"><span class="xml"> * 删除一个键值对</span></span><br><span class="line"><span class="xml"> * @param &#123;String&#125; key</span></span><br><span class="line"><span class="xml"> */</span></span><br><span class="line"><span class="xml">this.remove = function(key) &#123;</span></span><br><span class="line"><span class="xml">this.keys.remove(key);</span></span><br><span class="line"><span class="xml">this.data[key] = null;</span></span><br><span class="line"><span class="xml">&#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">/**</span></span><br><span class="line"><span class="xml"> * 遍历Map,执行处理函数</span></span><br><span class="line"><span class="xml"> *</span></span><br><span class="line"><span class="xml"> * @param &#123;Function&#125; 回调函数 function(key,value,index)&#123;..&#125;</span></span><br><span class="line"><span class="xml"> */</span></span><br><span class="line"><span class="xml">this.each = function(fn)&#123;</span></span><br><span class="line"><span class="xml">if(typeof fn != 'function')&#123;</span></span><br><span class="line"><span class="xml">return;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">var len = this.keys.length;</span></span><br><span class="line"><span class="xml">for(var i=0;i<span class="tag">&lt;<span class="name">len;i++)&#123;</span></span></span></span><br><span class="line"><span class="xml">var k = this.keys[i];</span></span><br><span class="line"><span class="xml">fn(k,this.data[k],i);</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">&#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">/**</span></span><br><span class="line"><span class="xml"> * 获取键值数组(类似<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://lib.csdn.net/base/java"</span> <span class="attr">class</span>=<span class="string">'replace_word'</span> <span class="attr">title</span>=<span class="string">"Java 知识库"</span> <span class="attr">target</span>=<span class="string">'_blank'</span> <span class="attr">style</span>=<span class="string">'color:#df3434; font-weight:bold;'</span>&gt;</span>Java<span class="tag">&lt;/<span class="name">a</span>&gt;</span>的entrySet())</span></span><br><span class="line"><span class="xml"> * @return 键值对象&#123;key,value&#125;的数组</span></span><br><span class="line"><span class="xml"> */</span></span><br><span class="line"><span class="xml">this.entrys = function() &#123;</span></span><br><span class="line"><span class="xml">var len = this.keys.length;</span></span><br><span class="line"><span class="xml">var entrys = new Array(len);</span></span><br><span class="line"><span class="xml">for (var i = 0; i <span class="tag">&lt; <span class="attr">len</span>; <span class="attr">i</span>++) &#123;</span></span></span><br><span class="line"><span class="xml">entrys[i] = &#123;</span></span><br><span class="line"><span class="xml">key : this.keys[i],</span></span><br><span class="line"><span class="xml">value : this.data[i]</span></span><br><span class="line"><span class="xml">&#125;;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">return entrys;</span></span><br><span class="line"><span class="xml">&#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">/**</span></span><br><span class="line"><span class="xml"> * 判断Map是否为空</span></span><br><span class="line"><span class="xml"> */</span></span><br><span class="line"><span class="xml">this.isEmpty = function() &#123;</span></span><br><span class="line"><span class="xml">return this.keys.length == 0;</span></span><br><span class="line"><span class="xml">&#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">/**</span></span><br><span class="line"><span class="xml"> * 获取键值对数量</span></span><br><span class="line"><span class="xml"> */</span></span><br><span class="line"><span class="xml">this.size = function()&#123;</span></span><br><span class="line"><span class="xml">return this.keys.length;</span></span><br><span class="line"><span class="xml">&#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">/**</span></span><br><span class="line"><span class="xml"> * 重写toString</span></span><br><span class="line"><span class="xml"> */</span></span><br><span class="line"><span class="xml">this.toString = function()&#123;</span></span><br><span class="line"><span class="xml">var s = "&#123;";</span></span><br><span class="line"><span class="xml">for(var i=0;i<span class="tag">&lt;<span class="name">this.keys.length;i++,s+=',')&#123;</span></span></span></span><br><span class="line"><span class="xml">var k = this.keys[i];</span></span><br><span class="line"><span class="xml">s += k+"="+this.data[k];</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">s=s.substr(0,s.length-1);</span></span><br><span class="line"><span class="xml">s+="&#125;";</span></span><br><span class="line"><span class="xml">return s;</span></span><br><span class="line"><span class="xml">&#125;;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">/**</span></span><br><span class="line"><span class="xml"> * 上一页</span></span><br><span class="line"><span class="xml"> */</span></span><br><span class="line"><span class="xml">function up()&#123;</span></span><br><span class="line"><span class="xml">var upPage=document.getElementById("page").value;</span></span><br><span class="line"><span class="xml">var pageSize=document.getElementById("pageSize").value;</span></span><br><span class="line"><span class="xml">var number=document.getElementById("number").value;</span></span><br><span class="line"><span class="xml">if(upPage=='' || upPage==undefined || upPage==null || upPage<span class="tag">&lt;<span class="name">1)&#123;</span></span></span></span><br><span class="line"><span class="xml">upPage=0;</span></span><br><span class="line"><span class="xml">&#125;else&#123;</span></span><br><span class="line"><span class="xml">upPage=upPage*1-1;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">if(upPage<span class="tag">&lt;<span class="name">0)&#123;</span></span></span></span><br><span class="line"><span class="xml">upPage=0;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">var requestDataBean = &#123;page:upPage,pageSize:pageSize*1,number:number&#125;;</span></span><br><span class="line"><span class="xml">console.log("上一页 - requestDataBean: "+JSON.stringify(requestDataBean));</span></span><br><span class="line"><span class="xml">getData(requestDataBean);</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">/**</span></span><br><span class="line"><span class="xml"> * 下一页</span></span><br><span class="line"><span class="xml"> */</span></span><br><span class="line"><span class="xml">function down()&#123;</span></span><br><span class="line"><span class="xml">var downPage=document.getElementById("page").value;</span></span><br><span class="line"><span class="xml">var pageSize=document.getElementById("pageSize").value;</span></span><br><span class="line"><span class="xml">var number=document.getElementById("number").value;</span></span><br><span class="line"><span class="xml">if(downPage=='' || downPage==undefined || downPage==null)&#123;</span></span><br><span class="line"><span class="xml">downPage=0;</span></span><br><span class="line"><span class="xml">&#125;else&#123;</span></span><br><span class="line"><span class="xml">downPage=downPage*1+1;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">var requestDataBean = &#123;page:downPage,pageSize:pageSize*1,number:number&#125;;</span></span><br><span class="line"><span class="xml">console.log("下一页 - requestDataBean: "+JSON.stringify(requestDataBean));</span></span><br><span class="line"><span class="xml">getData(requestDataBean);</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">/**</span></span><br><span class="line"><span class="xml"> * 查询</span></span><br><span class="line"><span class="xml"> */</span></span><br><span class="line"><span class="xml">function go()&#123;</span></span><br><span class="line"><span class="xml">var page=document.getElementById("page").value;</span></span><br><span class="line"><span class="xml">var pageSize=document.getElementById("pageSize").value;</span></span><br><span class="line"><span class="xml">var number=document.getElementById("number").value;</span></span><br><span class="line"><span class="xml">var createTime1=document.getElementById("createTime3").value;</span></span><br><span class="line"><span class="xml">var createTime2=document.getElementById("createTime4").value;</span></span><br><span class="line"><span class="xml">var requestDataBean = &#123;page:page*1,pageSize:pageSize*1,number:number,createTime1:createTime1,createTime2:createTime2&#125;;</span></span><br><span class="line"><span class="xml">console.log("数据查询 - requestDataBean: "+JSON.stringify(requestDataBean));</span></span><br><span class="line"><span class="xml">getData(requestDataBean);</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">/**</span></span><br><span class="line"><span class="xml"> * 数字排序</span></span><br><span class="line"><span class="xml"> */</span></span><br><span class="line"><span class="xml">function sortNumber(a,b)</span></span><br><span class="line"><span class="xml">&#123;</span></span><br><span class="line"><span class="xml">return a - b</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">/**</span></span><br><span class="line"><span class="xml"> * 给detailData表格填充数据</span></span><br><span class="line"><span class="xml">     * @param sumArrays 所有数据</span></span><br><span class="line"><span class="xml"> * @param arrays 前端页面展示的数据</span></span><br><span class="line"><span class="xml"> */</span></span><br><span class="line"><span class="xml"> function fillDataToTable(arrays,sumArrays)&#123;</span></span><br><span class="line"><span class="xml"> //清空表格数据</span></span><br><span class="line"><span class="xml">var detailData=document.getElementById("detailData");</span></span><br><span class="line"><span class="xml">detailData.innerHTML="";</span></span><br><span class="line"></span><br><span class="line"><span class="xml">//表格插入表头数据</span></span><br><span class="line"><span class="xml">var row=detailData.insertRow(0);</span></span><br><span class="line"><span class="xml">row.style.fontWeight="bolder";</span></span><br><span class="line"><span class="xml">var cell0=row.insertCell(0);</span></span><br><span class="line"><span class="xml">cell0.innerHTML="期数";</span></span><br><span class="line"><span class="xml">var cell1=row.insertCell(1);</span></span><br><span class="line"><span class="xml">cell1.innerHTML="开奖日期";</span></span><br><span class="line"><span class="xml">var cell2=row.insertCell(2);</span></span><br><span class="line"><span class="xml"> cell2.innerHTML="第一位数";</span></span><br><span class="line"><span class="xml">var cell3=row.insertCell(3);</span></span><br><span class="line"><span class="xml"> cell3.innerHTML="第二位数";</span></span><br><span class="line"><span class="xml">var cell4=row.insertCell(4);</span></span><br><span class="line"><span class="xml">cell4.innerHTML="第三位数";</span></span><br><span class="line"><span class="xml">var cell5=row.insertCell(5);</span></span><br><span class="line"><span class="xml">cell5.innerHTML="第四位数";</span></span><br><span class="line"><span class="xml">var cell6=row.insertCell(6);</span></span><br><span class="line"><span class="xml">cell6.innerHTML="第五位数";</span></span><br><span class="line"><span class="xml">var cell7=row.insertCell(7);</span></span><br><span class="line"><span class="xml">cell7.innerHTML="第六位数";</span></span><br><span class="line"><span class="xml">var cell8=row.insertCell(8);</span></span><br><span class="line"><span class="xml">cell8.innerHTML="第七位数";</span></span><br><span class="line"><span class="xml">var cell9=row.insertCell(9);</span></span><br><span class="line"><span class="xml"> cell9.innerHTML="操作";</span></span><br><span class="line"></span><br><span class="line"><span class="xml">//表格分页数据插入</span></span><br><span class="line"><span class="xml">for(var i=0;i<span class="tag">&lt;<span class="name">arrays.length;i++)&#123;</span></span></span></span><br><span class="line"><span class="xml">var json=arrays[i];</span></span><br><span class="line"><span class="xml">var row2=detailData.insertRow(i+1);</span></span><br><span class="line"><span class="xml">var cell0=row2.insertCell(0);</span></span><br><span class="line"><span class="xml">cell0.innerHTML=json.number;</span></span><br><span class="line"><span class="xml">var cell1=row2.insertCell(1);</span></span><br><span class="line"><span class="xml">cell1.innerHTML=json.createTime;</span></span><br><span class="line"><span class="xml">var cell2=row2.insertCell(2);</span></span><br><span class="line"><span class="xml">cell2.innerHTML=json.oneColumn;</span></span><br><span class="line"><span class="xml">var cell3=row2.insertCell(3);</span></span><br><span class="line"><span class="xml">cell3.innerHTML=json.twoColumn;</span></span><br><span class="line"><span class="xml">var cell4=row2.insertCell(4);</span></span><br><span class="line"><span class="xml">cell4.innerHTML=json.threeColumn;</span></span><br><span class="line"><span class="xml">var cell5=row2.insertCell(5);</span></span><br><span class="line"><span class="xml">cell5.innerHTML=json.fourColumn;</span></span><br><span class="line"><span class="xml">var cell6=row2.insertCell(6);</span></span><br><span class="line"><span class="xml">cell6.innerHTML=json.fiveColumn;</span></span><br><span class="line"><span class="xml">var cell7=row2.insertCell(7);</span></span><br><span class="line"><span class="xml">cell7.innerHTML=json.sixColumn;</span></span><br><span class="line"><span class="xml">var cell8=row2.insertCell(8);</span></span><br><span class="line"><span class="xml">cell8.innerHTML=json.sevenColumn;</span></span><br><span class="line"><span class="xml">var cell9=row2.insertCell(9);</span></span><br><span class="line"><span class="xml">cell9.innerHTML="<span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">\</span>"<span class="attr">show</span>(<span class="attr">this</span>,"+<span class="attr">json.id</span>+")\" <span class="attr">class</span>=<span class="string">\</span>"<span class="attr">btn</span> <span class="attr">btn-primary</span>\" <span class="attr">data-toggle</span>=<span class="string">\</span>"<span class="attr">modal</span>\" <span class="attr">data-target</span>=<span class="string">\</span>"#<span class="attr">myModal</span>\" &gt;</span>编辑<span class="tag">&lt;/<span class="name">button</span>&gt;</span>";</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">//单排遗漏数计算  总排遗漏数的计算应该简单，即每一排当中的最小值index，与每一排的最大值index取出来放入集合最后遍历出最小index与最大indeax进行相减即可</span></span><br><span class="line"><span class="xml">//将总数据中sumArrays每一列数组分组出来形成sumArray=[oneArray[oneColumn,...],twoArray[twoColumn,...],...,sevenArray[sevenColumn,...]]</span></span><br><span class="line"><span class="xml"> var oneArray=[], twoArray=[], threeArray=[], fourArray=[],  fiveArray=[],  sixArray=[],  sevenArray=[], sumArray=[];</span></span><br><span class="line"><span class="xml"> for(var i=0;i<span class="tag">&lt;<span class="name">sumArrays.length;i++)&#123;</span></span></span></span><br><span class="line"><span class="xml"> var json=sumArrays[i];</span></span><br><span class="line"><span class="xml"> oneArray.push(json.oneColumn);</span></span><br><span class="line"><span class="xml"> twoArray.push(json.twoColumn);</span></span><br><span class="line"><span class="xml"> threeArray.push(json.threeColumn);</span></span><br><span class="line"><span class="xml"> fourArray.push(json.fourColumn);</span></span><br><span class="line"><span class="xml"> fiveArray.push(json.fiveColumn);</span></span><br><span class="line"><span class="xml"> sixArray.push(json.sixColumn);</span></span><br><span class="line"><span class="xml"> sevenArray.push(json.sevenColumn);</span></span><br><span class="line"><span class="xml"> &#125;</span></span><br><span class="line"><span class="xml"> //插入7列数组数据</span></span><br><span class="line"><span class="xml"> sumArray.push(oneArray);</span></span><br><span class="line"><span class="xml"> sumArray.push(twoArray);</span></span><br><span class="line"><span class="xml"> sumArray.push(threeArray);</span></span><br><span class="line"><span class="xml"> sumArray.push(fourArray);</span></span><br><span class="line"><span class="xml"> sumArray.push(fiveArray);</span></span><br><span class="line"><span class="xml"> sumArray.push(sixArray);</span></span><br><span class="line"><span class="xml"> sumArray.push(sevenArray);</span></span><br><span class="line"></span><br><span class="line"><span class="xml"> //底部表头插入</span></span><br><span class="line"><span class="xml"> var tr0=detailData.insertRow(arrays.length+1);</span></span><br><span class="line"><span class="xml"> var td0=tr0.insertCell(0);</span></span><br><span class="line"><span class="xml"> td0.colSpan=2;</span></span><br><span class="line"><span class="xml"> td0.innerHTML="遗漏信息";</span></span><br><span class="line"><span class="xml"> td0.style.fontWeight="bolder";</span></span><br><span class="line"><span class="xml"> var td00=tr0.insertCell(1);</span></span><br><span class="line"><span class="xml"> td00.colSpan=8;</span></span><br><span class="line"></span><br><span class="line"><span class="xml"> var tr=detailData.insertRow(arrays.length+2);</span></span><br><span class="line"><span class="xml"> var td=tr.insertCell(0);</span></span><br><span class="line"><span class="xml"> td.style.fontWeight="bolder";</span></span><br><span class="line"><span class="xml"> td.innerHTML="数字 | 单排最大遗漏数 | 总排最大遗漏数";</span></span><br><span class="line"><span class="xml"> td.colSpan=2;</span></span><br><span class="line"></span><br><span class="line"><span class="xml"> //根据所查询的number分隔逗号，计算并得到其遗漏信息(数字、单排最大遗漏数、总排最大遗漏数)</span></span><br><span class="line"><span class="xml"> var numbers=document.getElementById("number").value.trim();</span></span><br><span class="line"><span class="xml"> console.log("nums: "+numbers.split(","));</span></span><br><span class="line"></span><br><span class="line"><span class="xml">//需要查询的number为空；则不进行显示其遗漏信息</span></span><br><span class="line"><span class="xml"> if(numbers==null || numbers=='' || numbers==undefined)&#123;</span></span><br><span class="line"><span class="xml"> var td11=tr.insertCell(1);</span></span><br><span class="line"><span class="xml"> td11.colSpan=8;</span></span><br><span class="line"><span class="xml"> &#125;</span></span><br><span class="line"><span class="xml"> //需要查询的number不为空；则进行显示其遗漏信息</span></span><br><span class="line"><span class="xml"> else&#123;</span></span><br><span class="line"><span class="xml"> var nums=numbers.split(","); //则遗漏信息、数字、单排最大遗漏数进行显示 循环查询每个数值的单排 总排</span></span><br><span class="line"></span><br><span class="line"><span class="xml"> //需要查询的number遗漏信息数组的长度进行循环得到</span></span><br><span class="line"><span class="xml"> for(var h=0;h<span class="tag">&lt;<span class="name">nums.length;h++)&#123;</span></span></span></span><br><span class="line"><span class="xml">  var number=nums[h];//查询的数值</span></span><br><span class="line"><span class="xml"> var singleMap=new Map();//关于该数值的单排最大遗漏数</span></span><br><span class="line"><span class="xml"> var sumList=[];</span></span><br><span class="line"><span class="xml"> // var minIndexMap=new Map();//每一列， 每一个单排当中的最小index</span></span><br><span class="line"><span class="xml"> // var maxIndexMap=new Map();//每一列， 每一个单排当中的最大index</span></span><br><span class="line"></span><br><span class="line"><span class="xml"> for(var t=0;t<span class="tag">&lt;<span class="name">sumArray.length;t++)&#123;</span> //当前<span class="attr">7</span>个数组当中都存有对应的关于该需要进行查询遗漏信息的数值<span class="attr">number</span>,循环<span class="attr">7</span>次,在七列当中进行查找以及得到它们所在的<span class="attr">index</span></span></span></span><br><span class="line"><span class="xml"> var arrays2=sumArray[t];//总共有7列，当前第t，单个数组</span></span><br><span class="line"><span class="xml"> var map=new Map();</span></span><br><span class="line"></span><br><span class="line"><span class="xml"> for(var i=0;i<span class="tag">&lt;<span class="name">arrays2.length;i++)</span> &#123; //每一列数组元素的循环</span></span></span><br><span class="line"><span class="xml"> var element = arrays2[i]; //当前七列中第t列数组当中具体的元素</span></span><br><span class="line"><span class="xml"> if (number == element) &#123;</span></span><br><span class="line"><span class="xml"> if(map.get(element)==null || map.get(element)==undefined)&#123;</span></span><br><span class="line"><span class="xml">map.put(element, &#123;prior: null, curr: null, size: null&#125;); //map.put(element,0);//放入了该列当中所有不重复元素以及其实时变化的位移index+1</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml"> &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml"> for(var n=0;n<span class="tag">&lt;<span class="name">arrays2.length;n++)&#123;</span></span></span></span><br><span class="line"><span class="xml"> var key=arrays2[n]; //当前七列中第t列数组当中具体的元素</span></span><br><span class="line"><span class="xml"> if(key!=null &amp;&amp; key==element &amp;&amp; number == key)&#123; //如果存在有当前循环的数组当中的取值与map当中的键相同的则重新赋值，重新赋值后进行break;//var y=i-n;</span></span><br><span class="line"><span class="xml"> sumList.push(n);</span></span><br><span class="line"></span><br><span class="line"><span class="xml"> //存储每一个元素他的前一位相同元素的下标；y为当前元素的下标</span></span><br><span class="line"><span class="xml"> if((map.get(element)!=null &amp;&amp; map.get(element)!=undefined)</span></span><br><span class="line"><span class="xml"> &amp;&amp; map.get(element).prior==null &amp;&amp; map.get(element).curr==null &amp;&amp; map.get(element).size==null)&#123;</span></span><br><span class="line"><span class="xml"> map.put(element,&#123;prior: n, curr: n, size: 0&#125;); //第一次遇到元素相同的时候</span></span><br><span class="line"><span class="xml"> &#125;</span></span><br><span class="line"><span class="xml"> if((map.get(element)!=null &amp;&amp; map.get(element)!=undefined)</span></span><br><span class="line"><span class="xml"> &amp;&amp; (map.get(element).prior!=null &amp;&amp; map.get(element).curr!=null &amp;&amp; map.get(element).size!=null)</span></span><br><span class="line"><span class="xml">  &amp;&amp; map.get(element).prior==map.get(element).curr)&#123;</span></span><br><span class="line"><span class="xml"> map.put(element,&#123;prior: map.get(element).prior, curr: n, size: n-map.get(element).prior&#125;); //第二次遇到元素相同的时候</span></span><br><span class="line"><span class="xml"> &#125;</span></span><br><span class="line"><span class="xml"> if((map.get(element)!=null &amp;&amp; map.get(element)!=undefined)</span></span><br><span class="line"><span class="xml"> &amp;&amp; (map.get(element).prior!=null &amp;&amp; map.get(element).curr!=null  &amp;&amp; map.get(element).size!=null)</span></span><br><span class="line"><span class="xml"> &amp;&amp; map.get(element).prior!=map.get(element).curr) &#123;</span></span><br><span class="line"><span class="xml">  // 此时 map 中的 curr 即当前 key 的相同元素的上一位置 prior 的 index ;取出 prior;</span></span><br><span class="line"><span class="xml"> // 得到当前 key index 与当前 key index 的 prior 的 size；</span></span><br><span class="line"><span class="xml"> // 如果当前 size较之此时map当中element元素的size要大，则进行替换</span></span><br><span class="line"><span class="xml"> var currPrior=map.get(element).curr; //当前的上一位</span></span><br><span class="line"><span class="xml"> var currSize=n-currPrior; //当前的大小</span></span><br><span class="line"><span class="xml"> var priorSize=map.get(element).size; //上一位的大小</span></span><br><span class="line"><span class="xml"> if(currSize&gt;priorSize)&#123;</span></span><br><span class="line"><span class="xml"> map.put(element,&#123;prior:currPrior, curr:n, size:currSize&#125;);</span></span><br><span class="line"><span class="xml"> &#125;</span></span><br><span class="line"><span class="xml"> &#125;</span></span><br><span class="line"><span class="xml"> &#125;else&#123;</span></span><br><span class="line"><span class="xml"> continue;//跳出对于第i列数组中element元素对于当前n数组的当次循环，进入当前n数组迭代下一元素key的循环</span></span><br><span class="line"><span class="xml"> &#125;</span></span><br><span class="line"><span class="xml"> &#125;</span></span><br><span class="line"><span class="xml"> &#125;</span></span><br><span class="line"><span class="xml"> console.log("第"+t+"列当中，每一个元素的单排最大遗漏数："+JSON.stringify(map));</span></span><br><span class="line"><span class="xml"> if(map.get(number)!=null || map.get(number)!=undefined)&#123;</span></span><br><span class="line"><span class="xml"> //取值则为当前该map.get(number)即当前列当中的单排最大遗漏数</span></span><br><span class="line"><span class="xml"> singleMap.put(t,map.get(number).size-1);//singleMap.put(t,map.get(number)-1);//key t：哪一列， value 当前该数值在当前排t的最大遗漏数  map.get(number)需要减去1</span></span><br><span class="line"><span class="xml"> &#125;else&#123;</span></span><br><span class="line"><span class="xml"> //当前列取出number如果为空则说明当前列当中不存在有该数值，则替换为0</span></span><br><span class="line"><span class="xml"> singleMap.put(t,'当前列不存在'+number);</span></span><br><span class="line"><span class="xml"> &#125;</span></span><br><span class="line"><span class="xml"> &#125;</span></span><br><span class="line"><span class="xml"> //遍历完7个数组后得到当前查询的该数值的所有index</span></span><br><span class="line"><span class="xml"> //得到当前查询的该数值的在7列中的所有index，并进行index排序sort,每一个index都与index.next进行比较得到size</span></span><br><span class="line"><span class="xml"> //定义maxSize变量，并进行赋值</span></span><br><span class="line"><span class="xml"> sumList.sort(sortNumber);</span></span><br><span class="line"><span class="xml"> var sumMaxNumber=null;</span></span><br><span class="line"><span class="xml"> if(sumList.length==0)&#123;</span></span><br><span class="line"><span class="xml"> sumMaxNumber='不存在';</span></span><br><span class="line"><span class="xml"> &#125;else&#123;</span></span><br><span class="line"><span class="xml"> for(var g=0;g<span class="tag">&lt;<span class="name">sumList.length;g++)&#123;</span></span></span></span><br><span class="line"><span class="xml"> if(sumMaxNumber==null)&#123;</span></span><br><span class="line"><span class="xml"> sumMaxNumber=sumList[g+1]-sumList[g];</span></span><br><span class="line"><span class="xml"> &#125;else&#123;</span></span><br><span class="line"><span class="xml"> var nextSize=sumList[g+1]-sumList[g];</span></span><br><span class="line"><span class="xml"> if(nextSize&gt;sumMaxNumber)&#123;</span></span><br><span class="line"><span class="xml">sumMaxNumber=nextSize;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml"> &#125;</span></span><br><span class="line"><span class="xml"> &#125;</span></span><br><span class="line"><span class="xml"> &#125;</span></span><br><span class="line"><span class="xml"> var mapArrays=singleMap.entrys();//循环之后获取得到singleMap,即单排数</span></span><br><span class="line"><span class="xml"> if (h == 0) &#123; //即第一个数值的时候填入行tr:arrays.length+2</span></span><br><span class="line"><span class="xml"> td.innerHTML="数字: "+number+" | 单排最大遗漏数 | 总排最大遗漏数: "+sumMaxNumber;</span></span><br><span class="line"><span class="xml"> for(var r=0;r<span class="tag">&lt;<span class="name">mapArrays.length;r++)</span> &#123;</span></span></span><br><span class="line"><span class="xml"> var td22 = tr.insertCell(r+1);//当前行处于第一行</span></span><br><span class="line"><span class="xml"> td22.innerHTML = singleMap.get(r);</span></span><br><span class="line"><span class="xml"> &#125;</span></span><br><span class="line"><span class="xml"> tr.insertCell(mapArrays.length+1);</span></span><br><span class="line"><span class="xml"> &#125; else &#123;</span></span><br><span class="line"><span class="xml"> //新增行并插入</span></span><br><span class="line"><span class="xml"> var newTr=detailData.insertRow(arrays.length+2+h);</span></span><br><span class="line"><span class="xml"> var newTd=newTr.insertCell(0);</span></span><br><span class="line"><span class="xml"> newTd.innerHTML="数字: "+number+" | 单排最大遗漏数 | 总排最大遗漏数: "+sumMaxNumber;</span></span><br><span class="line"><span class="xml"> newTd.style.fontWeight="bolder";</span></span><br><span class="line"><span class="xml"> newTd.colSpan=2;</span></span><br><span class="line"><span class="xml"> for(var r=0;r<span class="tag">&lt;<span class="name">mapArrays.length;r++)</span> &#123;</span></span></span><br><span class="line"><span class="xml"> var td22 = newTr.insertCell(r+1);//从第二行开始进行新增列</span></span><br><span class="line"><span class="xml"> td22.innerHTML = singleMap.get(r);</span></span><br><span class="line"><span class="xml"> &#125;</span></span><br><span class="line"><span class="xml"> newTr.insertCell(mapArrays.length+1);</span></span><br><span class="line"><span class="xml"> &#125;</span></span><br><span class="line"><span class="xml"> console.log("================== 查询数值："+number+" END ==================");</span></span><br><span class="line"><span class="xml"> &#125;</span></span><br><span class="line"><span class="xml"> &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">/**</span></span><br><span class="line"><span class="xml"> * 获取list接口数据</span></span><br><span class="line"><span class="xml"> * @param requestDataBean</span></span><br><span class="line"><span class="xml"> */</span></span><br><span class="line"><span class="xml">function getData(requestDataBean)&#123;</span></span><br><span class="line"><span class="xml">var url="/maima/findAllByParams";</span></span><br><span class="line"><span class="xml">AjaxPost(url, requestDataBean,</span></span><br><span class="line"><span class="xml">function () &#123;</span></span><br><span class="line"><span class="xml">//ajax加载中</span></span><br><span class="line"><span class="xml">&#125;,</span></span><br><span class="line"><span class="xml">function (data) &#123;</span></span><br><span class="line"><span class="xml">console.log("========数据获取成功======");</span></span><br><span class="line"><span class="xml">//ajax返回 //认证完成</span></span><br><span class="line"><span class="xml">if(data!=null)&#123;</span></span><br><span class="line"><span class="xml">var arrays=JSON.parse(JSON.stringify(data.list));</span></span><br><span class="line"><span class="xml">var sumArrays=JSON.parse(JSON.stringify(data.list2));</span></span><br><span class="line"><span class="xml">document.getElementById("page").value=data.page;</span></span><br><span class="line"><span class="xml">document.getElementById("pageSize").value=data.pageSize;</span></span><br><span class="line"><span class="xml">if (arrays.length!=0) &#123;</span></span><br><span class="line"><span class="xml">//前端填充数据操作</span></span><br><span class="line"><span class="xml">console.log("======= 表格填充数据 - fillDataToTable =======")</span></span><br><span class="line"><span class="xml">fillDataToTable(arrays,sumArrays);</span></span><br><span class="line"><span class="xml">&#125; else &#123;</span></span><br><span class="line"><span class="xml">AjaxErro(data);</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">&#125;)</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">/**</span></span><br><span class="line"><span class="xml"> * 页面加载</span></span><br><span class="line"><span class="xml"> */</span></span><br><span class="line"><span class="xml">window.onload = function()&#123;</span></span><br><span class="line"><span class="xml">var requestDataBean = &#123;page:0,pageSize:10&#125;;</span></span><br><span class="line"><span class="xml">console.info("页面加载 - requestDataBean: "+JSON.stringify(requestDataBean));</span></span><br><span class="line"><span class="xml">getData(requestDataBean);</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">%-</span></span></span><span class="ruby">-</span></span><br><span class="line"></span><br><span class="line"><span class="ruby"> /<span class="regexp">/console.log(map.toString());</span></span></span><br><span class="line"><span class="ruby"> /<span class="regexp">/ var mapArrays=map.entrys();</span></span></span><br><span class="line"><span class="ruby"> /<span class="regexp">/ var maxValue=0;</span></span></span><br><span class="line"><span class="ruby"> /<span class="regexp">/ var maxKey=0;</span></span></span><br><span class="line"><span class="ruby"> /<span class="regexp">/ for(var i=0;i&lt;mapArrays.length;i++)&#123; /</span><span class="regexp">/当前列当中的map数组</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  var key=mapArrays[i].key;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  var value=map.get(key);</span></span></span><br><span class="line"><span class="ruby"> /<span class="regexp">/ console.log("key: "+key+" value:"+value);</span></span></span><br><span class="line"><span class="ruby"> /<span class="regexp">/ &#125;</span></span></span><br><span class="line"><span class="ruby"> /<span class="regexp">/ console.log("单排最大遗漏数为 - key:"+maxKey+"  value:"+(maxValue-1));</span></span></span><br><span class="line"><span class="ruby"> /<span class="regexp">/添加元素</span></span></span><br><span class="line"><span class="ruby"> /<span class="regexp">/ var td4=tr.insertCell(t+1);</span></span></span><br><span class="line"><span class="ruby"> /<span class="regexp">/ if(maxKey&lt;=0)&#123;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  td4.innerHTML="-";</span></span></span><br><span class="line"><span class="ruby"> /<span class="regexp">/ &#125;else&#123;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  td4.innerHTML=maxKey;</span></span></span><br><span class="line"><span class="ruby"> /<span class="regexp">/ &#125;</span></span></span><br><span class="line"><span class="ruby"> /<span class="regexp">/ var td5=tr2.insertCell(t+1);</span></span></span><br><span class="line"><span class="ruby"> /<span class="regexp">/ if((maxValue-1)&lt;=0)&#123;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  td5.innerHTML="-";</span></span></span><br><span class="line"><span class="ruby"> /<span class="regexp">/ &#125;else&#123;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  td5.innerHTML=(maxValue-1);</span></span></span><br><span class="line"><span class="ruby"> /<span class="regexp">/ &#125;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="ruby">var tr=detailData.insertRow(arrays.length+<span class="number">2</span>);</span></span><br><span class="line"><span class="ruby"> var td=tr.insertCell(<span class="number">0</span>);</span></span><br><span class="line"><span class="ruby"> td.innerHTML=<span class="string">"数字"</span>;</span></span><br><span class="line"><span class="ruby"> td.style.fontWeight=<span class="string">"bolder"</span>;</span></span><br><span class="line"><span class="ruby"> td.colSpan=<span class="number">2</span>;</span></span><br><span class="line"><span class="ruby"> var tr2=detailData.insertRow(arrays.length+<span class="number">3</span>);</span></span><br><span class="line"><span class="ruby"> var td2=tr2.insertCell(<span class="number">0</span>);</span></span><br><span class="line"><span class="ruby"> td2.innerHTML=<span class="string">"单排最大遗漏数"</span>;</span></span><br><span class="line"><span class="ruby"> td2.style.fontWeight=<span class="string">"bolder"</span>;</span></span><br><span class="line"><span class="ruby"> td2.colSpan=<span class="number">2</span>;</span></span><br><span class="line"><span class="ruby"> var tr3=detailData.insertRow(arrays.length+<span class="number">4</span>);</span></span><br><span class="line"><span class="ruby"> var td3=tr3.insertCell(<span class="number">0</span>);</span></span><br><span class="line"><span class="ruby"> td3.innerHTML=<span class="string">"总排最大遗漏数"</span>;</span></span><br><span class="line"><span class="ruby"> td3.style.fontWeight=<span class="string">"bolder"</span>;</span></span><br><span class="line"><span class="ruby"> td3.colSpan=<span class="number">2</span>;</span></span><br><span class="line"><span class="ruby">/<span class="regexp">/ /</span><span class="regexp">/当前7个数组当中都存有对应的数值</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/ for(var t=0;t&lt;sumArray.length;t++)&#123;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  /</span><span class="regexp">/ var arrays=[01,28,19,35,43,08,01,12,32,41];</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  var arrays=sumArray[t];/</span><span class="regexp">/单个数组</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  console.log(arrays);</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  var flag=true;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  var map=new Map();</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  for(var i=0;i&lt;arrays.length;i++)&#123; /</span><span class="regexp">/循环10次</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  var element=arrays[i];/</span><span class="regexp">/数组当中具体的元素</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  map.put(element,0);/</span><span class="regexp">/放入的只有9个</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  for(var n=0;n&lt;arrays.length;n++)&#123; /</span><span class="regexp">/循环10次</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  var key=arrays[n];</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  /</span><span class="regexp">/console.log("当前遍历的element: "+element+"；所处index: "+i+"  map当中循环的element: "+key+"所处index: "+n)</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  if(key!=null &amp;&amp; key==element)&#123; /</span><span class="regexp">/如果存在有当前循环的数组当中的取值与map当中的键相同的则重新赋值，重新赋值后进行下一次break;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  var y=i-n;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  /</span><span class="regexp">/console.log("key: "+key+" element:"+element+" y: "+y);</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  map.put(element,y);/</span><span class="regexp">/此处的y没有减去当前自己的位数,所以当单排最大遗漏数查询的时候还需要-1</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  break;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  &#125;else&#123;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  continue;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  &#125;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  &#125;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  &#125;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  /</span><span class="regexp">/console.log(map.toString());</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  var mapArrays=map.entrys();</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  var maxValue=0;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  var maxKey=0;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  for(var i=0;i&lt;mapArrays.length;i++)&#123;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  var key=mapArrays[i].key;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  var value=map.get(key);</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  /</span><span class="regexp">/console.log("key: "+key+" value:"+value);</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  if(maxValue&lt;value)&#123;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  maxValue=value;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  maxKey=key;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  &#125;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  &#125;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  console.log("单排最大遗漏数为 - key:"+maxKey+"  value:"+(maxValue-1));</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  /</span><span class="regexp">/添加元素</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  var td4=tr.insertCell(t+1);</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  if(maxKey&lt;=0)&#123;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  td4.innerHTML="-";</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  &#125;else&#123;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  td4.innerHTML=maxKey;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  &#125;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  var td5=tr2.insertCell(t+1);</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  if((maxValue-1)&lt;=0)&#123;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  td5.innerHTML="-";</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  &#125;else&#123;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  td5.innerHTML=(maxValue-1);</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/  &#125;</span></span></span><br><span class="line"><span class="ruby">/<span class="regexp">/ &#125;</span></span></span><br><span class="line"><span class="ruby">-</span><span class="xml">-%&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;需求内容&quot;&gt;&lt;a href=&quot;#需求内容&quot; class=&quot;headerlink&quot; title=&quot;需求内容&quot;&gt;&lt;/a&gt;需求内容&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/fengshana/Mamai&quot; target=&quot;_blank&quot; r
      
    
    </summary>
    
    
      <category term="前端" scheme="https://fengshana.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="javaScript" scheme="https://fengshana.github.io/tags/javaScript/"/>
    
      <category term="前端" scheme="https://fengshana.github.io/tags/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="双色球" scheme="https://fengshana.github.io/tags/%E5%8F%8C%E8%89%B2%E7%90%83/"/>
    
  </entry>
  
  <entry>
    <title>串</title>
    <link href="https://fengshana.github.io/2020/04/07/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E4%B8%B2-05/"/>
    <id>https://fengshana.github.io/2020/04/07/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E4%B8%B2-05/</id>
    <published>2020-04-07T04:52:56.000Z</published>
    <updated>2020-04-07T20:40:23.081Z</updated>
    
    <content type="html"><![CDATA[<h2 id="阅读笔记"><a href="#阅读笔记" class="headerlink" title="阅读笔记"></a>阅读笔记</h2><p><img src="/2020/04/07/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E4%B8%B2-05/%E4%B8%B2-05.png" alt="串-05"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;阅读笔记&quot;&gt;&lt;a href=&quot;#阅读笔记&quot; class=&quot;headerlink&quot; title=&quot;阅读笔记&quot;&gt;&lt;/a&gt;阅读笔记&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/2020/04/07/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%
      
    
    </summary>
    
    
      <category term="数据结构" scheme="https://fengshana.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    
      <category term="数据结构" scheme="https://fengshana.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="串" scheme="https://fengshana.github.io/tags/%E4%B8%B2/"/>
    
  </entry>
  
  <entry>
    <title>栈与队列</title>
    <link href="https://fengshana.github.io/2020/04/05/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97-04/"/>
    <id>https://fengshana.github.io/2020/04/05/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97-04/</id>
    <published>2020-04-05T04:52:56.000Z</published>
    <updated>2020-04-07T01:17:47.045Z</updated>
    
    <content type="html"><![CDATA[<h2 id="阅读笔记"><a href="#阅读笔记" class="headerlink" title="阅读笔记"></a>阅读笔记</h2><p><img src="/2020/04/05/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97-04/%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97-04.png" alt="栈与队列-04"></p><p><img src="/2020/04/05/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97-04/%E5%BC%80%E5%9C%BA%E7%99%BD.png" alt="开场白"></p><p><img src="/2020/04/05/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97-04/%E6%A0%88%E7%9A%84%E5%AE%9A%E4%B9%89.png" alt="栈的定义"></p><p><img src="/2020/04/05/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97-04/%E6%A0%88%E7%9A%84%E6%8A%BD%E8%B1%A1%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.png" alt="栈的抽象数据类型"></p><p><img src="/2020/04/05/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97-04/%E6%A0%88%E7%9A%84%E9%A1%BA%E5%BA%8F%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84%E5%8F%8A%E5%AE%9E%E7%8E%B0.png" alt="栈的顺序存储结构及实现"></p><p><img src="/2020/04/05/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97-04/%E4%B8%A4%E6%A0%88%E7%9A%84%E5%85%B1%E4%BA%AB%E7%A9%BA%E9%97%B4.png" alt="两栈的共享空间"></p><p><img src="/2020/04/05/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97-04/%E6%A0%88%E7%9A%84%E9%93%BE%E5%BC%8F%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84%E5%8F%8A%E5%AE%9E%E7%8E%B0.png" alt="栈的链式存储结构及实现"></p><p><img src="/2020/04/05/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97-04/%E6%A0%88%E7%9A%84%E4%BD%9C%E7%94%A8.png" alt="栈的作用"></p><p><img src="/2020/04/05/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97-04/%E6%A0%88%E7%9A%84%E5%BA%94%E7%94%A8-%E9%80%92%E5%BD%92.png" alt="栈的应用-递归"></p><p><img src="/2020/04/05/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97-04/%E6%A0%88%E7%9A%84%E5%BA%94%E7%94%A8-%E5%9B%9B%E5%88%99%E8%BF%90%E7%AE%97%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%B1%82%E5%80%BC.png" alt="栈的应用-四则运算表达式求值"></p><p><img src="/2020/04/05/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97-04/%E9%98%9F%E5%88%97%E7%9A%84%E5%AE%9A%E4%B9%89.png" alt="队列的定义"></p><p><img src="/2020/04/05/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97-04/%E9%98%9F%E5%88%97%E7%9A%84%E6%8A%BD%E8%B1%A1%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.png" alt="队列的抽象数据类型"></p><p><img src="/2020/04/05/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97-04/%E5%BE%AA%E7%8E%AF%E9%98%9F%E5%88%97.png" alt="循环队列"></p><p><img src="/2020/04/05/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97-04/%E9%98%9F%E5%88%97%E7%9A%84%E9%93%BE%E5%BC%8F%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84%E5%8F%8A%E5%AE%9E%E7%8E%B0.png" alt="队列的链式存储结构及实现"></p><p><img src="/2020/04/05/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97-04/%E6%80%BB%E7%BB%93%E5%9B%9E%E9%A1%BE.png" alt="总结回顾"></p><p><img src="/2020/04/05/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97-04/%E7%BB%93%E5%B0%BE%E8%AF%AD.png" alt="结尾语"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;阅读笔记&quot;&gt;&lt;a href=&quot;#阅读笔记&quot; class=&quot;headerlink&quot; title=&quot;阅读笔记&quot;&gt;&lt;/a&gt;阅读笔记&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/2020/04/05/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%
      
    
    </summary>
    
    
      <category term="数据结构" scheme="https://fengshana.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    
      <category term="数据结构" scheme="https://fengshana.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="栈与队列" scheme="https://fengshana.github.io/tags/%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97/"/>
    
  </entry>
  
  <entry>
    <title>社会主义接班人</title>
    <link href="https://fengshana.github.io/2020/04/03/%E9%9A%8F%E7%AC%94/%E6%88%91%E6%98%AF%E7%A4%BE%E4%BC%9A%E4%B8%BB%E4%B9%89%E6%8E%A5%E7%8F%AD%E4%BA%BA/"/>
    <id>https://fengshana.github.io/2020/04/03/%E9%9A%8F%E7%AC%94/%E6%88%91%E6%98%AF%E7%A4%BE%E4%BC%9A%E4%B8%BB%E4%B9%89%E6%8E%A5%E7%8F%AD%E4%BA%BA/</id>
    <published>2020-04-03T11:52:56.000Z</published>
    <updated>2020-04-03T11:13:32.350Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>帮我妹改改作文。</p></blockquote><p>主题：灾害到来时我该怎么做</p><ol><li>身份：新时代的青年人，是社会建设和国家发展的接班人</li><li>态度：勇敢面对，承担使命</li><li>方向：针对新冠疫情；视角要宽；</li><li>人群：90,00代的突出表现和感人事迹</li></ol><p>面临黑暗，我向阳光</p><p>  汽车的鸣笛，街道的喧闹。<br>  在蓝天白云下，在灿阳照射下，看似和谐美好的生活，也有阳光穿不透的黑暗，<br>  他们在黑暗里肆意欢笑，趁人不注意，便将罪恶的双手伸向人们，<br>  他们在变态心理的引导下剥夺了人爱阳光照耀的机会，<br>  将人无情地拉进黑暗。</p><p>  黑暗就如病毒，如同冠状病毒，从天而降，肆意传播，于是将人们的天空浸染成了黑色，<br>  雨水冲刷着人们的双眼。但总会有阳光，哪怕只剩一缕，他也会穿过乌云照向大地。<br>  新闻中不断播的着“巨婴”的行为，可以说是个反面教材了，<br>  在面对危险时，他们慌乱了手脚，将内心底的自私播出来给人们看，<br>  像跳梁小丑，引人发笑。当医生带着阳光冲向黑暗，“巨婴”们手里拿着盾牌，却站反了方向。<br>  我们理应相信那一缕阳光，将我们内心的力量融合，为医生助力。</p><p>  黑暗也如同恐惧心理，覆压人的心灵，痛打着人们的躯体，凌辱了人的自尊，却仍在暗自偷笑。<br>  校园暴力给人带来的伤痛往往是比身体的疼痛更令人刻骨铭心。<br>  但总有强大心灵带着阳光，即使”身在井隅”，却仍然”心向璀璨”。<br>  冰冷的法律中出现裂痕，投进去了温暖，扫黑，禁止校园暴力的法律的颁布，<br>  在这个社会，让人们走在街道上，没有胆怯。我们主动站出来打击黑恶势力，将力量团结在一起。<br>  黑暗骑士也没有那么可怕。</p><p>  我想阳光的力量一定可以战胜黑暗，我想，抬头暖阳春草，用拥抱将黑暗消融。<br>  阳光会穿过茂密的树枝，穿过乱窜的树枝，知道最后，千缕阳光冲破黑来前来拥抱我。</p><p>  ======================================================================</p><h2 id="面临黑暗，我向阳光"><a href="#面临黑暗，我向阳光" class="headerlink" title="面临黑暗，我向阳光"></a>面临黑暗，我向阳光</h2><p>“等到黑夜翻面之后，会是新的白昼；<br>等到海啸退去之后，只是潮起潮落；<br>别到最后你才发觉，心里头的野兽，还没到最终就已经罢休；<br>心脏没有那么脆弱，总还会有执着；<br>人生不会只有收获，总难免有伤口；<br>不要害怕生命中，不完美的角落；<br>阳光在每个裂缝中散落，不如就勇敢打破生命中的裂缝，阳光就逐渐洒满了其中。”<br>——题记</p><p>2019的尾巴到2020的开端，甚至更甚。<br>爆发的新冠状病毒，在这场看不见硝烟的抗疫战争中告诉我们，<br>这不仅仅是一场我们巍巍中华人民需要迎接且不能退缩的挑战，这更是让我们泱泱华夏子孙心与心贴在了一起的连线。</p><p>在这场抗疫当中，有着数不清的前线抗疫战士为了这场战争前继后扑。<br>贵州省黔西南州兴义市人民医院的一位呼吸科医生张恩莉争分夺秒，只为更多患者康复；<br>吉林省援鄂医疗队的一位护士长高岚守护生命，坚持到最后胜利；<br>武汉大学人民医院东院区山东医疗队的主治医生郭海鹏用仁心仁术守护生命…</p><p>不仅仅是前线的抗疫战士，就连普普通通老百姓也送上了来自他们的绵薄之力。<br>山东日照一个环卫工人捐了一万二,钱虽然不是很多，但对于他来说却是一个大数目；<br>1月28日，寿光免费赠送了300吨新鲜蔬菜。并且29日起，每天给武汉送600吨平价新鲜蔬菜，持续供应10到15天。截止到2月3日共捐赠1120吨；<br>1月29日，临沂兰陵县捐赠200吨大蒜;<br>1月31日，临沂蔬菜公司原计划捐赠100吨蔬菜，结果这个消息传到了菜农耳朵里又自愿增加60吨，共计160吨;<br>1月31日，金乡捐赠300吨大蒜;<br>2月1日，滕州捐赠66吨马铃薯;<br>2月4日，菏泽8节车厢满载着275吨优质农产品驰援武汉…</p><p>给出力量的不仅仅来自于前线、百姓、企业…<br>也有来自00后，90后那些一度被认为仍处在温室的花朵，也给予了来自他们微弱的力量。</p><p>“阿姨，您的处方单是以前的，药店说需要新的处方单才能开药，请您让主治医师再开一张过来吧”，“叔叔，您要的药没有了，看看这种行不行”，……<br>在武汉市汉阳区晴川街的一家药店，19岁的张玉欣一边跟店主报需求，一边联系居民询问购药的细节，忙的不可开交。<br>张玉欣是武汉本地的“00”后大学生，疫情发生后，她主动到社区报名，成为一名志愿者，主要负责给居民买药送药。<br>“之前有过志愿服务经验，现在我们的城市遇到困难了，我想为家乡人民出一份力。”张玉欣说。<br>张玉欣工作的汉阳晴川街龙灯社区龙灯里小区是一个老旧小区，居民大多是老年人。<br>为了满足居民多样化的用药需求，张玉欣和同事们经常从早跑到晚，遇到一些难买到的药，还得一家家药店去询问，经常饭都来不及吃。<br>“虽然只是跑腿的工作，但有些药对居民来说是‘救命药’，我们必须争分夺秒去买。”张玉欣说。<br>小区居民买高血压、糖尿病等慢性病的药物比较多，有的隔几天就需要再买一次。最多的时候，她一天要买五六十种药品，光排队就要好几个小时。<br>让张玉欣印象最深的是，一天下午，她接到居民求助：一名70多岁的危重症者急需球蛋白。她和同事立即开车外出找药，一家家药店去询问，从汉阳一路搜到汉口，辗转10多家药店，终于在快要天黑时，在一家即将打烊的药店买到了药。<br>当他们把药送到求助居民手中时，对方感动的热泪盈眶。志愿者的辛苦付出，居民都看在眼里。<br>“开始时一些居民不放心，但看到那些买药的居民不仅拿到了急需的药，零钱也一份不少，现在他们都提前写下医保卡密码，放心地交给我们购药”张玉欣欣慰地说。</p><p>“身在无间，心在桃源”。<br>前有武汉汉阳区“00”后志愿者张玉欣为居民买药送药争分夺秒，后有“90”后一线抗疫英雄谢小玉的12小时无私奉献。</p><p>过去有人说他们是娇滴滴的一代，但现在看，他们成了抗疫一线的主力军，不怕苦、不怕牺牲。抗疫一线比其他地方更能考验人。”<br>3月10日，习近平总书记来到武汉市东湖新城社区考察。听完社区志愿者代表、中国矿业大学(北京)大二学生谢小玉的工作汇报后，总书记深有感触地说。<br>　　受到总书记的肯定和鼓励，谢小玉工作起来更有干劲了。这名社区第一批参加志愿服务、唯一的大学生志愿者，已经在30栋楼值守一个多月。日前，记者来到东湖新城社区，感受了谢小玉忙碌的一天。<br>　　上午9点——主动上门问需求。<br>　　趁着上午9点物资尚未送达的待命时刻，谢小玉看望了住在30栋楼15层的80多岁的周奶奶。<br>　　“奶奶，降压药够吗?燃气卡要充值吗?”“小玉来啦，放心，都够用。”周奶奶感动地说，有一次为了帮她买降压药，谢小玉连跑了3家药店。<br>　　因为老人家不会用手机、腿脚又不方便，谢小玉就特别关心周奶奶。“周奶奶第一次接电话时，看到是陌生的手机号码，以为遇到了骗子，熟悉了以后，周奶奶经常主动打电话找我谈心。”她说，以前连对门邻居都不熟悉，这段时间却认识了很多社区邻居，有些人还给她送防护物资。<br>　　服务200多户居民不是简单事。单从买药来说，居民对生产厂家、品牌型号都有特殊要求。有时候她和其他志愿者连“逛”几天药店，才能买到某种指定的药。<br>　　上午10点——大箱小箱送快递。<br>　　“我的顺丰快递到南门了。”上午10点，30栋楼1单元一位居民在群里求助志愿者，谢小玉看到后立刻起身。<br>　　取快递是志愿者的日常工作，30栋楼离社区南门最远，来回一趟要十几分钟。一上午谢小玉就帮居民取了4次快递，看到她气喘吁吁地抱着大箱小箱，其他志愿者连忙帮她找推车。“没事，这几天，我的力气都锻炼大了。”谢小玉说。<br>　　“快递业务是从2月下旬开始逐渐增多的，最忙时一天要跑十几趟，一批快递在南门，一批在社区服务站前，收到居民通知就得赶紧取走、避免堆积。”谢小玉介绍说，居民个性化需求比较多，经常会有退换货的情况。<br>　　几天前，谢小玉向一位社区居民借了辆电瓶车。“最近取快递、取货方便多了，但小玉总是把电瓶车给我们用。”一起负责30栋楼的下沉干部毕彪说，谢小玉年纪虽小却很爱照顾人。<br>　　当然，工作中也有不顺心的时候。有一次分快递时，有居民冲她发了火，她哭了。“不只是感到委屈，更多的是觉得自己没做好。”谢小玉不好意思地说，社区工作人员和家人都在鼓励她，她也慢慢学会了调整心态。<br>　　下午5点半——挨家挨户发活鱼。<br>　　“团购活鱼到楼下了。”下午5点半，近10份活鱼在灌满清水的塑料袋里活蹦乱跳。谢小玉在群里发出通知，担心有居民没及时看到，她又一家家打电话通知。“谢谢小玉!”不到20分钟，鱼分发完了。随后，她仔细查阅笔记本上的记录，再次确认当天的物资和生活用品是否全部送到，然后继续值班。<br>　　脚踩一双粉色球鞋，外面套着一件红马甲，扎着利落的马尾辫，未满20岁的谢小玉浑身洋溢着青春的活力。她原本计划今年寒假和家人出去旅游过年，“虽然旅游没成行，但当社区志愿者也挺有意义的。”<br>　　搭档万小强说，小玉上岗时正值2月中旬寒潮来袭，爱心物资大部分是米面油，都特别沉，一周要发三四次。小玉挨家挨户敲门送货，好几次一直从傍晚忙到晚上11点。“这个‘00后’小姑娘一点也不娇气，很坚强，很有责任感。”万小强佩服地说。<br>　　“抗疫一线也是大学，志愿服务就是课堂。社区工作的经历和体验，是我课堂上学不到的。现在，我的承受能力、沟通能力、信息整合能力都增强了。”谢小玉自豪地说。</p><p>阳光会穿过茂密的树枝，投下的那些光影将斑驳这段可歌可泣的岁月，成为这程征途上熠熠生辉的勋章。<br>我知道最后，千万缕阳光会冲破黑暗前来拥抱那些需要握住阳光的人。<br>我想，其实勇敢一点，我们也能手握阳光，给予他人。</p><p>那是一个即将下着雨的午后，<br>早些时候火辣的太阳瞧得人都睁不开眼睛，<br>烤的地铁车厢的壳都想生烟，车窗外的樟树叶子被晒的都好像要反光似的，卟呤卟呤的。<br>得亏地铁中有穿堂风倒是凉快。<br>不过本来身上就发了汗，黏黏糊糊的。<br>风一吹，贴在身上的衣服与皮肉之间倒是分开了，反倒生出一股子燥意。<br>就是一冷一热夹杂搞得人有点头昏脑涨，有点崩溃。<br>说白了，就是有点晕地铁。<br>车上人多的很，一个小小的车厢挤得好像已经腾不出地儿再去容纳更多的人了。<br>周遭放眼望去就是人。<br>戴着耳机听歌看电视的，看新闻的，低头玩手机的，逗孩子乐呵的，打电话的，望向车窗外放空的，喊着借过让道的，也有些观察着别人的人。<br>总之就是人挤人，挨着站一块儿。挤一挤，位置总会有的。<br>充斥在耳旁的声音还有地铁上穿堂而过的风声，那响声绝了，感觉就像是坐在过山车上尖叫声。<br>六月的天说变就变，不过一会儿，车窗外的天空就被就大块黑漆漆的乌云给占地为王了。<br>阴沉沉的，就像考试没考好爸妈的脸色似的，跟锅底有的一拼。跟要下暴雨似的，确是有黑云压城城欲摧的气势。<br>“哕！”<br>天！我一听声音就知道离我不远。我就杵在地铁门口的地儿，估算一下离我也就两个人的距离吧，听着声音倒不像是好事。<br>看向车窗外的视线立马掉转了180度，看向了声源地，准备凑凑热闹。<br>那是一个小男孩，得到我鼻子这么高了。<br>一手捂着口，脸通红着，冒着热汗，又止不住的想要吐。<br>不是想要吐，是止不住的吐，到后面吐到没东西吐了在那里干呕。<br>中午应该是吃了带有火腿肠热狗面包一类的快餐，<br>呕出的酸臭粘液从他指缝中滑过，连着口水丝都掺有一股浓浓的感觉没有消化完全的那股味道，<br>淌了一地的污秽物，红的白的黄的浑浊搅在一起，胆汁都要给吐出来了。<br>真真是惨不忍睹，人间惨剧。<br>旁边站着一位中年女士也是急了眼，手抓着小男孩的衣领骂，伸手拍打了小男孩背部几下，像是在训斥他怎么没有忍住在公共场合给吐了，<br>那小男孩有些不满，有些抵触，又做不得声。<br>该是他的妈妈。<br>那母亲也红了脸，隔着人我都能感觉得到她满脸的尴尬之情，无以言表。<br>她忙的翻了翻挎包，挎包夹层，里里外外找了一通，都没来得及扣好挎包的扣子，又从衣服口袋里翻了翻，没翻出什么东西，又从裤口袋里翻了翻，还是没找着什么。<br>她大概是在找能够清理那些污秽物的东西。<br>我突然发现，整一我在的这节车厢，不，是这小男孩和他母亲所在的这一车厢都安静了很多。<br>地铁上的穿堂风依然呼呼疾行而过，顺路将这节车厢的酸臭味稍稍带去了些许。<br>并且最最最古怪的事是，明明之前还挤得不可开交，现在倒是成了距离那对母子所在范围一两米都没有什么人。<br>他们都捂着口鼻，神色异样，仍在惊异怎么吐了，怎么偏偏在这节车厢吐了，今天可真是倒霉。<br>呕吐物带来的酸臭味让人退避三尺。<br>那对母子希望能有人帮助他们一点点，就一节纸巾或者是一个塑料袋的善意，那一点微末的雪中送炭，却都无人问津。<br>离那对母子最近的一位农民老奶奶颤巍巍的从自己挑的篮子当中找出了个卖菜的那种塑料袋，短小粗糙泛黄的手中递出了她的一点零星善意。<br>“你拿塑料袋盛着”。<br>那母亲连声道谢，一边鞠躬一边道谢，赶紧让那小男孩拿着那塑料袋以免再吐。<br>有了老奶奶递出的那个塑料袋，旁边一些近身旁的人也纷纷从口袋里拿出一包包的纸巾。<br>那母亲一边道谢一边拿着不多的纸巾去擦地铁上小男孩吐的一片狼藉，将那一张张纸一点点包住污秽，然后放到塑料袋里面。<br>但是纸巾依然不够。<br>我知道我今天出门前特意带了卷纸出来了。但我不太好意思拿出来给那母亲用。<br>于是我从包里将卷纸扯了一大长节，再在包里尴尬的折好紧张的递了过去。<br>我朝她笑了笑，她脸仍然是红着，但是已经好些了，也朝我笑了笑，拿过纸巾，怀着歉意拘谨的道谢。<br>狼藉已经被那母亲擦拭得差不多了，小男孩也吐的差不多了，看上去脸色要舒服点了。<br>我又扯了节纸巾折好了递了过去给那小男孩。<br>“可以拿着擦手”。<br>那小男孩摇了摇手，连声道谢说不用。<br>于是我拿着那节纸巾又把手给缩了回来。<br>“要下车的乘客，请您提前做好准备”。<br>地铁停下来的时候，那对母子从我身旁经过，我将那节纸巾准备递给那母亲。<br>“可以拿着擦手”。<br>那母亲提着污秽物的塑料袋，笑笑温婉答道：“不用了，谢谢你”。<br>直到他们下了地铁后，我手里仍有些紧张的拿着那节纸巾，心底突然放松了些，畅快了许多。<br>好像突然晓得”初极狭，才通人，复行数十步，豁然开朗”是个什么滋味儿。<br>地铁上又涌上来了许多人。人依然很挤。<br>嘈杂的声音依然存在着，穿堂风也依然在疾声作响，只是忽然从耳畔淡了下去。<br>车窗外的云好像也没有那么黑了。压的人透不过气的那股子气好像也泄了了下去。<br>而最终，这场疑似暴雨的天气也没有来临。</p><p>我想，其实勇敢一点，他人不仅能获取阳光，或许还能将阳光撒的更远。</p><p>即便是一脚踏空，我也会相信会有人将你扶起；<br>我向上不再会是迷茫，也不再会是抹掉的慌张，而是抬头便是暖阳春草；<br>我向下听见你说这世界不再是空荡荡，而是看见你会伸开双手将我搂住给我拥抱。<br>踩碎了冰冷走过时光，睁开眼你就会听到人间四月芳菲始盛开的声音。</p><p>微笑向暖，清风自来；而面临黑暗，我心向阳光。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;帮我妹改改作文。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;主题：灾害到来时我该怎么做&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;身份：新时代的青年人，是社会建设和国家发展的接班人&lt;/li&gt;
&lt;li&gt;态度：勇敢面对，承担使命&lt;/li&gt;
&lt;li&gt;方向：针对新冠疫情；
      
    
    </summary>
    
    
      <category term="随笔" scheme="https://fengshana.github.io/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
      <category term="社会主义接班人" scheme="https://fengshana.github.io/tags/%E7%A4%BE%E4%BC%9A%E4%B8%BB%E4%B9%89%E6%8E%A5%E7%8F%AD%E4%BA%BA/"/>
    
  </entry>
  
  <entry>
    <title>线性表</title>
    <link href="https://fengshana.github.io/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%80%A7%E8%A1%A8-03/"/>
    <id>https://fengshana.github.io/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%80%A7%E8%A1%A8-03/</id>
    <published>2020-04-03T10:52:56.000Z</published>
    <updated>2020-04-07T01:17:39.579Z</updated>
    
    <content type="html"><![CDATA[<h2 id="阅读笔记"><a href="#阅读笔记" class="headerlink" title="阅读笔记"></a>阅读笔记</h2><p><img src="/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%80%A7%E8%A1%A8-03/%E7%BA%BF%E6%80%A7%E8%A1%A8-03.png" alt="线性表-03"></p><p><img src="/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%80%A7%E8%A1%A8-03/%E7%BA%BF%E6%80%A7%E8%A1%A8%E5%AE%9A%E4%B9%89.png" alt="线性表定义"></p><p><img src="/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%80%A7%E8%A1%A8-03/%E7%BA%BF%E6%80%A7%E8%A1%A8%E7%9A%84%E6%8A%BD%E8%B1%A1%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.png" alt="线性表的抽象数据类型"></p><p><img src="/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%80%A7%E8%A1%A8-03/%E7%BA%BF%E6%80%A7%E8%A1%A8%E7%9A%84%E9%A1%BA%E5%BA%8F%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84.png" alt="线性表的顺序存储结构"></p><p><img src="/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%80%A7%E8%A1%A8-03/%E9%A1%BA%E5%BA%8F%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84%E7%9A%84%E6%8F%92%E5%85%A5%E4%B8%8E%E5%88%A0%E9%99%A4.png" alt="顺序存储结构的插入与删除"></p><p><img src="/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%80%A7%E8%A1%A8-03/%E7%BA%BF%E6%80%A7%E8%A1%A8%E7%9A%84%E9%93%BE%E5%BC%8F%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84.png" alt="线性表的链式存储结构"></p><p><img src="/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%80%A7%E8%A1%A8-03/%E5%8D%95%E9%93%BE%E8%A1%A8%E7%9A%84%E8%AF%BB%E5%8F%96.png" alt="单链表的读取"></p><p><img src="/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%80%A7%E8%A1%A8-03/%E5%8D%95%E9%93%BE%E8%A1%A8%E7%9A%84%E6%8F%92%E5%85%A5%E4%B8%8E%E5%88%A0%E9%99%A4.png" alt="单链表的插入与删除"></p><p><img src="/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%80%A7%E8%A1%A8-03/%E5%8D%95%E9%93%BE%E8%A1%A8%E7%9A%84%E6%95%B4%E8%A1%A8%E5%88%9B%E5%BB%BA.png" alt="单链表的整表创建"></p><p><img src="/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%80%A7%E8%A1%A8-03/%E5%8D%95%E9%93%BE%E8%A1%A8%E7%9A%84%E6%95%B4%E8%A1%A8%E5%88%A0%E9%99%A4.png" alt="单链表的整表删除"></p><p><img src="/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%80%A7%E8%A1%A8-03/%E5%8D%95%E9%93%BE%E8%A1%A8%E7%BB%93%E6%9E%84%E4%B8%8E%E9%A1%BA%E5%BA%8F%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84%E4%BC%98%E7%BC%BA%E7%82%B9.png" alt="单链表结构与顺序存储结构优缺点"></p><p><img src="/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%80%A7%E8%A1%A8-03/%E9%9D%99%E6%80%81%E9%93%BE%E8%A1%A8.png" alt="静态链表"></p><p><img src="/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%80%A7%E8%A1%A8-03/%E7%BB%93%E5%B0%BE%E8%AF%AD.png" alt="结尾语"></p><p><img src="/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%80%A7%E8%A1%A8-03/%E5%BE%AA%E7%8E%AF%E9%93%BE%E8%A1%A8.png" alt="循环链表"></p><p><img src="/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%80%A7%E8%A1%A8-03/%E5%8F%8C%E5%90%91%E9%93%BE%E8%A1%A8.png" alt="双向链表"></p><p><img src="/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%80%A7%E8%A1%A8-03/%E6%80%BB%E7%BB%93%E5%9B%9E%E9%A1%BE.png" alt="总结回顾"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;阅读笔记&quot;&gt;&lt;a href=&quot;#阅读笔记&quot; class=&quot;headerlink&quot; title=&quot;阅读笔记&quot;&gt;&lt;/a&gt;阅读笔记&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%
      
    
    </summary>
    
    
      <category term="数据结构" scheme="https://fengshana.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    
      <category term="数据结构" scheme="https://fengshana.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="线性表" scheme="https://fengshana.github.io/tags/%E7%BA%BF%E6%80%A7%E8%A1%A8/"/>
    
  </entry>
  
  <entry>
    <title>树</title>
    <link href="https://fengshana.github.io/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%91-06/"/>
    <id>https://fengshana.github.io/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%91-06/</id>
    <published>2020-04-03T04:52:56.000Z</published>
    <updated>2020-04-07T01:16:54.614Z</updated>
    
    <content type="html"><![CDATA[<h2 id="阅读笔记"><a href="#阅读笔记" class="headerlink" title="阅读笔记"></a>阅读笔记</h2><p><img src="/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%91-06/%E6%A0%91-06.png" alt="树-06"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;阅读笔记&quot;&gt;&lt;a href=&quot;#阅读笔记&quot; class=&quot;headerlink&quot; title=&quot;阅读笔记&quot;&gt;&lt;/a&gt;阅读笔记&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%
      
    
    </summary>
    
    
      <category term="数据结构" scheme="https://fengshana.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    
      <category term="数据结构" scheme="https://fengshana.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="树" scheme="https://fengshana.github.io/tags/%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>查找</title>
    <link href="https://fengshana.github.io/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%9F%A5%E6%89%BE-08/"/>
    <id>https://fengshana.github.io/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%9F%A5%E6%89%BE-08/</id>
    <published>2020-04-03T04:52:56.000Z</published>
    <updated>2020-04-07T01:16:35.948Z</updated>
    
    <content type="html"><![CDATA[<h2 id="阅读笔记"><a href="#阅读笔记" class="headerlink" title="阅读笔记"></a>阅读笔记</h2><p><img src="/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%9F%A5%E6%89%BE-08/%E6%9F%A5%E6%89%BE-08.png" alt="查找-08"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;阅读笔记&quot;&gt;&lt;a href=&quot;#阅读笔记&quot; class=&quot;headerlink&quot; title=&quot;阅读笔记&quot;&gt;&lt;/a&gt;阅读笔记&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%
      
    
    </summary>
    
    
      <category term="数据结构" scheme="https://fengshana.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    
      <category term="数据结构" scheme="https://fengshana.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="查找" scheme="https://fengshana.github.io/tags/%E6%9F%A5%E6%89%BE/"/>
    
  </entry>
  
  <entry>
    <title>排序</title>
    <link href="https://fengshana.github.io/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%8E%92%E5%BA%8F-09/"/>
    <id>https://fengshana.github.io/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%8E%92%E5%BA%8F-09/</id>
    <published>2020-04-03T04:52:56.000Z</published>
    <updated>2020-04-07T01:16:45.719Z</updated>
    
    <content type="html"><![CDATA[<h2 id="阅读笔记"><a href="#阅读笔记" class="headerlink" title="阅读笔记"></a>阅读笔记</h2><p><img src="/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%8E%92%E5%BA%8F-09/%E6%8E%92%E5%BA%8F-09.png" alt="排序-09"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;阅读笔记&quot;&gt;&lt;a href=&quot;#阅读笔记&quot; class=&quot;headerlink&quot; title=&quot;阅读笔记&quot;&gt;&lt;/a&gt;阅读笔记&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%
      
    
    </summary>
    
    
      <category term="数据结构" scheme="https://fengshana.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    
      <category term="数据结构" scheme="https://fengshana.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="排序" scheme="https://fengshana.github.io/tags/%E6%8E%92%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>图</title>
    <link href="https://fengshana.github.io/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%9B%BE-07/"/>
    <id>https://fengshana.github.io/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%9B%BE-07/</id>
    <published>2020-04-03T04:52:56.000Z</published>
    <updated>2020-04-07T01:17:23.283Z</updated>
    
    <content type="html"><![CDATA[<h2 id="阅读笔记"><a href="#阅读笔记" class="headerlink" title="阅读笔记"></a>阅读笔记</h2><p><img src="/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%9B%BE-07/%E5%9B%BE-07.png" alt="图-07"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;阅读笔记&quot;&gt;&lt;a href=&quot;#阅读笔记&quot; class=&quot;headerlink&quot; title=&quot;阅读笔记&quot;&gt;&lt;/a&gt;阅读笔记&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/2020/04/03/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%
      
    
    </summary>
    
    
      <category term="数据结构" scheme="https://fengshana.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    
      <category term="图" scheme="https://fengshana.github.io/tags/%E5%9B%BE/"/>
    
      <category term="数据结构" scheme="https://fengshana.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title>算法</title>
    <link href="https://fengshana.github.io/2020/04/01/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%AE%97%E6%B3%95-02/"/>
    <id>https://fengshana.github.io/2020/04/01/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%AE%97%E6%B3%95-02/</id>
    <published>2020-04-01T04:52:56.000Z</published>
    <updated>2020-04-07T01:17:27.646Z</updated>
    
    <content type="html"><![CDATA[<h2 id="阅读笔记"><a href="#阅读笔记" class="headerlink" title="阅读笔记"></a>阅读笔记</h2><p><img src="/2020/04/01/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%AE%97%E6%B3%95-02/%E7%AE%97%E6%B3%95-02.png" alt="算法-02"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;阅读笔记&quot;&gt;&lt;a href=&quot;#阅读笔记&quot; class=&quot;headerlink&quot; title=&quot;阅读笔记&quot;&gt;&lt;/a&gt;阅读笔记&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/2020/04/01/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%
      
    
    </summary>
    
    
      <category term="数据结构" scheme="https://fengshana.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    
      <category term="数据结构" scheme="https://fengshana.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="算法" scheme="https://fengshana.github.io/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>数据结构绪论</title>
    <link href="https://fengshana.github.io/2020/03/30/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%BB%AA%E8%AE%BA-01/"/>
    <id>https://fengshana.github.io/2020/03/30/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%BB%AA%E8%AE%BA-01/</id>
    <published>2020-03-30T04:52:56.000Z</published>
    <updated>2020-04-07T01:17:02.790Z</updated>
    
    <content type="html"><![CDATA[<h2 id="阅读笔记"><a href="#阅读笔记" class="headerlink" title="阅读笔记"></a>阅读笔记</h2><p><img src="/2020/03/30/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%BB%AA%E8%AE%BA-01/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%BB%AA%E8%AE%BA-01.png" alt="数据结构绪论-01"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;阅读笔记&quot;&gt;&lt;a href=&quot;#阅读笔记&quot; class=&quot;headerlink&quot; title=&quot;阅读笔记&quot;&gt;&lt;/a&gt;阅读笔记&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/2020/03/30/%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%
      
    
    </summary>
    
    
      <category term="数据结构" scheme="https://fengshana.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    
      <category term="数据结构绪论 - 数据结构" scheme="https://fengshana.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%BB%AA%E8%AE%BA-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title>面试总结</title>
    <link href="https://fengshana.github.io/2020/03/29/%E9%9D%A2%E8%AF%95%E9%A2%98/%E4%BB%8A%E5%B9%B4%E7%AC%AC%E4%B8%80%E6%AC%A1%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/"/>
    <id>https://fengshana.github.io/2020/03/29/%E9%9D%A2%E8%AF%95%E9%A2%98/%E4%BB%8A%E5%B9%B4%E7%AC%AC%E4%B8%80%E6%AC%A1%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/</id>
    <published>2020-03-29T13:33:56.000Z</published>
    <updated>2020-03-31T15:00:10.935Z</updated>
    
    <content type="html"><![CDATA[<h2 id="面试题"><a href="#面试题" class="headerlink" title="面试题"></a>面试题</h2><ul><li>自我介绍</li><li>最熟悉的一个项目进行介绍</li><li>多线程（Thread与Runnable的不同）</li><li>重构从哪些地方入手</li><li>索引优化</li><li>为什么红黑树快，二进制为什么快（底层操作系统）</li><li>描述下计算机的底层原理</li><li>SpringBoot统一异常处理机制</li><li>SpringBoot的AOP、IOC流程，以及简单实现</li><li>SpringBoot的注解@Autowired,@Resource实现原理</li><li>Spring当中Bean的实现流程</li><li>HashMap当中红黑树为什么需要左旋右旋</li><li>Redis缓存击穿，缓存穿透，雪崩</li><li>分布式相关知识点</li><li>时间空间复杂度，O(n),二叉搜索树O(logn)</li><li>如何看待加班</li><li>SpringBoot当中事务实现</li><li>Redis底层进制实现，为什么Redis性能高</li><li>使用过哪些锁机制，有哪些锁</li><li>邮件服务，通过多线程，邮件没有发送成功如何处理</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;面试题&quot;&gt;&lt;a href=&quot;#面试题&quot; class=&quot;headerlink&quot; title=&quot;面试题&quot;&gt;&lt;/a&gt;面试题&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;自我介绍&lt;/li&gt;
&lt;li&gt;最熟悉的一个项目进行介绍&lt;/li&gt;
&lt;li&gt;多线程（Thread与Runnable的不同）&lt;
      
    
    </summary>
    
    
      <category term="面试总结" scheme="https://fengshana.github.io/categories/%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/"/>
    
    
      <category term="面试总结" scheme="https://fengshana.github.io/tags/%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/"/>
    
  </entry>
  
  <entry>
    <title>时序图测试</title>
    <link href="https://fengshana.github.io/2020/03/26/%E9%9D%A2%E8%AF%95%E9%A2%98/testMd/"/>
    <id>https://fengshana.github.io/2020/03/26/%E9%9D%A2%E8%AF%95%E9%A2%98/testMd/</id>
    <published>2020-03-26T06:21:56.000Z</published>
    <updated>2020-03-25T18:40:13.004Z</updated>
    
    <content type="html"><![CDATA[<p>测试时序图，想看下他转成html之后会不会，也是是这个样子还是只是单纯的只出现code.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">st&#x3D;&gt;start: 页面加载</span><br><span class="line">e&#x3D;&gt;end: End:&gt;http:&#x2F;&#x2F;www.google.com</span><br><span class="line">op1&#x3D;&gt;operation: get_hotel_ids|past</span><br><span class="line">op2&#x3D;&gt;operation: get_proxy|current</span><br><span class="line">sub1&#x3D;&gt;subroutine: get_proxy|current</span><br><span class="line">op3&#x3D;&gt;operation: save_comment|current</span><br><span class="line">op4&#x3D;&gt;operation: set_sentiment|current</span><br><span class="line">op5&#x3D;&gt;operation: set_record|current</span><br><span class="line"></span><br><span class="line">cond1&#x3D;&gt;condition: ids_remain空?</span><br><span class="line">cond2&#x3D;&gt;condition: proxy_list空?</span><br><span class="line">cond3&#x3D;&gt;condition: ids_got空?</span><br><span class="line">cond4&#x3D;&gt;condition: 爬取成功??</span><br><span class="line">cond5&#x3D;&gt;condition: ids_remain空?</span><br><span class="line"></span><br><span class="line">io1&#x3D;&gt;inputoutput: ids-remain</span><br><span class="line">io2&#x3D;&gt;inputoutput: proxy_list</span><br><span class="line">io3&#x3D;&gt;inputoutput: ids-got</span><br><span class="line"></span><br><span class="line">st-&gt;op1(right)-&gt;io1-&gt;cond1</span><br><span class="line">cond1(yes)-&gt;sub1-&gt;io2-&gt;cond2</span><br><span class="line">cond2(no)-&gt;op3</span><br><span class="line">cond2(yes)-&gt;sub1</span><br><span class="line">cond1(no)-&gt;op3-&gt;cond4</span><br><span class="line">cond4(yes)-&gt;io3-&gt;cond3</span><br><span class="line">cond4(no)-&gt;io1</span><br><span class="line">cond3(no)-&gt;op4</span><br><span class="line">cond3(yes, right)-&gt;cond5</span><br><span class="line">cond5(yes)-&gt;op5</span><br><span class="line">cond5(no)-&gt;cond3</span><br><span class="line">op5-&gt;e</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;测试时序图，想看下他转成html之后会不会，也是是这个样子还是只是单纯的只出现code.&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;
      
    
    </summary>
    
    
      <category term="时序图" scheme="https://fengshana.github.io/categories/%E6%97%B6%E5%BA%8F%E5%9B%BE/"/>
    
    
      <category term="时序图" scheme="https://fengshana.github.io/tags/%E6%97%B6%E5%BA%8F%E5%9B%BE/"/>
    
  </entry>
  
  <entry>
    <title>红黑树</title>
    <link href="https://fengshana.github.io/2020/03/26/%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%BA%A2%E9%BB%91%E6%A0%91/"/>
    <id>https://fengshana.github.io/2020/03/26/%E9%9D%A2%E8%AF%95%E9%A2%98/%E7%BA%A2%E9%BB%91%E6%A0%91/</id>
    <published>2020-03-25T18:14:56.000Z</published>
    <updated>2020-03-26T02:45:35.292Z</updated>
    
    <content type="html"><![CDATA[<p>最近两天看到了HashMap比较多，包括一致性Hash等。<br>基本的了解了。<br>就是不太晓得红黑树。  </p><p>要是觉得看文档实在觉得不适的话，可以建议先去b站看个视频：<a href="https://www.bilibili.com/video/BV1tE411f7tP?p=1" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1tE411f7tP?p=1</a>  </p><p>HashMap源码阅读参考：</p><ul><li><a href="https://ke.qq.com/webcourse/index.html#cid=459141&amp;term_id=100549477&amp;taid=4078067153043845&amp;vid=5285890795538344618" target="_blank" rel="noopener">https://ke.qq.com/webcourse/index.html#cid=459141&amp;term_id=100549477&amp;taid=4078067153043845&amp;vid=5285890795538344618</a>  </li></ul><p>一致性Hash:  </p><ul><li><a href="https://www.bilibili.com/video/av25184175" target="_blank" rel="noopener">https://www.bilibili.com/video/av25184175</a>  </li><li><a href="https://www.cnblogs.com/lpfuture/p/5796398.html" target="_blank" rel="noopener">https://www.cnblogs.com/lpfuture/p/5796398.html</a></li><li>Redis哈希槽：<a href="https://blog.csdn.net/z15732621582/article/details/79121213" target="_blank" rel="noopener">https://blog.csdn.net/z15732621582/article/details/79121213</a></li></ul><p>blog:</p><ul><li><a href="https://www.cnblogs.com/mfrank/p/9227097.html" target="_blank" rel="noopener">https://www.cnblogs.com/mfrank/p/9227097.html</a></li><li><a href="https://blog.csdn.net/carson_ho/article/details/79373026" target="_blank" rel="noopener">https://blog.csdn.net/carson_ho/article/details/79373026</a></li><li><a href="https://blog.csdn.net/carson_ho/article/details/79373134" target="_blank" rel="noopener">https://blog.csdn.net/carson_ho/article/details/79373134</a></li><li><a href="https://www.cnblogs.com/FCWORLD/articles/8504383.html" target="_blank" rel="noopener">https://www.cnblogs.com/FCWORLD/articles/8504383.html</a></li><li><a href="https://www.cnblogs.com/leesf456/p/5242233.html" target="_blank" rel="noopener">https://www.cnblogs.com/leesf456/p/5242233.html</a></li><li><a href="https://www.jianshu.com/p/400f3c019557" target="_blank" rel="noopener">https://www.jianshu.com/p/400f3c019557</a></li></ul><p>打算看完再睡觉。对自己蜜汁自信。  </p><p>Node是TreeNode的爷爷，而且普通节点一般来说也比TreeNode要多。  </p><ul><li>红黑树介绍</li><li>TreeNode结构</li><li>树化的过程</li><li>红黑树的左旋和右旋</li><li>TreeNode的左旋和右旋</li><li>红黑树的插入</li><li>TreeNode的插入</li><li>红黑树的删除</li><li>TreeNode的删除</li></ul><p>理论部分：红黑树部分<br>代码实践部分：TreeNode部分  </p><p>好饿啊。  </p><h2 id="红黑树介绍"><a href="#红黑树介绍" class="headerlink" title="红黑树介绍"></a>红黑树介绍</h2><blockquote><p>什么是树？  </p></blockquote><p> <img src="https://images2018.cnblogs.com/blog/1043143/201806/1043143-20180625235951335-1438523857.jpg" alt="image"></p><ul><li>A~H 都是树的节点，每个节点有零个或者多个子节点，或者说多个孩子。</li><li>但是除根节点以外，每个节点都只有一个父节点，也称只要一个父亲。</li><li>最上面的A是根节点，最下面的D、H、F、G是叶子节点。</li><li>每一个非根节点【有且只有】一个父节点；</li><li>树是具有【一层一层】的【层次】结构；</li><li>这里A位于第一层，B、C位于第二层，D、E、F、G位于第三层，H位于第四层。以此类推。</li><li>将左边的B节点部分（包括BDEH）拿出来，则又是一棵树，称为树的子树。</li></ul><blockquote><p>什么是二叉搜索树？</p></blockquote><p> <img src="https://images2018.cnblogs.com/blog/1043143/201806/1043143-20180626005359234-143383116.jpg" alt="image"></p><ul><li>二叉代表他的节点最多有两个子节点; 而且左右有顺序，不能颠倒，分别叫左孩子和右孩子；这两个节点互成为兄弟节点。</li><li>4、9互为兄弟，7是他们的父亲，9是2的叔叔，8是2的堂兄弟。</li><li>既然叫做搜索树，表示它的用途是为了【更快的搜索和查找】而设计的，所以这棵树本身满足【一定的排序规则】，即数组的【任何节点的值大于它的左孩子，且小于它的右孩子】。</li><li>任意节点的左、右子树也分别为二叉查找树。</li></ul><blockquote><p>什么是红黑树？  </p></blockquote><p> <img src="https://images2018.cnblogs.com/blog/1043143/201806/1043143-20180626004222951-1996840383.jpg" alt="image"></p><ul><li>红黑树，本质上来说是一棵二叉搜索树。</li><li>红黑树，就跟他的名字一样，又红又黑，红黑并进，理实交融，【节点是非红即黑的】。</li></ul><h3 id="红黑树的主要特性"><a href="#红黑树的主要特性" class="headerlink" title="红黑树的主要特性"></a>红黑树的主要特性</h3><ol><li>每个节点要么是黑色，要么是红色。（节点非黑继红）</li><li>根节点是黑色的。</li><li>每个叶子节点（NIL）是黑色。</li><li>如果一个节点是红色的，则它的子节点必须是黑色的。（也就是说父子节点不能同时为红色）</li><li>从一个节点到该节点的子孙节点的所有路径上包含相同数目的黑节点。（这一点是平衡的关键）</li></ol><p>其实就是一棵比较平衡的又红又黑的二叉树。  </p><h4 id="TreeNode结构"><a href="#TreeNode结构" class="headerlink" title="TreeNode结构"></a>TreeNode结构</h4><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">用于Tree bins的Entry.</span></span><br><span class="line"><span class="comment">扩展LinkedHashMap.Entry(进而扩展Node)，</span></span><br><span class="line"><span class="comment">因此可以用作常规节点或链接节点的扩展</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">static <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">TreeNode&lt;K</span>,<span class="title">V&gt;</span> <span class="keyword">extends</span> <span class="title">LinkedHashMap</span>.<span class="title">Entry&lt;K</span>,<span class="title">V&gt;</span></span>&#123;</span><br><span class="line">    <span class="type">TreeNode</span>&lt;<span class="type">K</span>,<span class="type">V</span>&gt; parent;<span class="comment">//红黑树父节点</span></span><br><span class="line">    <span class="type">TreeNode</span>&lt;<span class="type">K</span>,<span class="type">V</span>&gt; left;<span class="comment">//红黑树左节点？</span></span><br><span class="line">    <span class="type">TreeNode</span>&lt;<span class="type">K</span>,<span class="type">V</span>&gt; right;<span class="comment">//红黑树右节点？</span></span><br><span class="line">    <span class="type">TreeNode</span>&lt;<span class="type">K</span>,<span class="type">V</span>&gt; prev;<span class="comment">//红黑树前一节点，删除后需要取消链接</span></span><br><span class="line">    boolean red;<span class="comment">//是否为红色，是否为红节点</span></span><br><span class="line">    <span class="comment">//构建TreeNode所需参数</span></span><br><span class="line">    <span class="type">TreeNode</span>(int hash,<span class="type">K</span> key,<span class="type">V</span> <span class="keyword">val</span>,<span class="type">Node</span>&lt;<span class="type">K</span>,<span class="type">V</span>&gt; next)&#123;</span><br><span class="line">      <span class="keyword">super</span>(hash,key,<span class="keyword">val</span>,next);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">  <span class="comment">//省略后续代码</span></span><br></pre></td></tr></table></figure><p>TreeNode继承自LinkedHashMap中的内部类——-LinkedHashMap.Entry.<br>而这个内部类又继承自Node，所以算是Node的孙子辈了。  </p><p>属性：</p><ul><li>parent 用来指向他的父节点。</li><li>left 指向左孩子。</li><li>right 指向右孩子。</li><li>prev 则指向前一节点（原链表中的前一个节点）</li></ul><p>注意，这些字段跟Entry，Node中的字段是一样的，是使用默认访问权限的，所以子类可以直接使用父类的属性。</p><h4 id="树化的过程"><a href="#树化的过程" class="headerlink" title="树化的过程"></a>树化的过程</h4><p>当HashMap桶中的元素个数超过一定数量时，就会树化，也就是将链表转化为红黑树的结构。</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//put方法===》调用putVal方法</span></span><br><span class="line"> <span class="keyword">public</span> V put(K <span class="built_in">key</span>, V value) &#123;</span><br><span class="line">        <span class="keyword">return</span> putVal(hash(<span class="built_in">key</span>), <span class="built_in">key</span>, value, <span class="keyword">false</span>, <span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//实现hashMap的put操作</span></span><br><span class="line">    <span class="keyword">final</span> V putVal(<span class="built_in">int</span> hash, K <span class="built_in">key</span>, V value, <span class="built_in">boolean</span> onlyIfAbsent,</span><br><span class="line">                   <span class="built_in">boolean</span> evict) &#123;</span><br><span class="line">        ...省略部分代码...</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="built_in">int</span> binCount = <span class="number">0</span>; ; ++binCount) &#123;</span><br><span class="line">                    <span class="keyword">if</span> ((e = p.next) == <span class="keyword">null</span>) &#123;</span><br><span class="line">                        p.next = newNode(hash, <span class="built_in">key</span>, value, <span class="keyword">null</span>);</span><br><span class="line">                        <span class="comment">//当桶中元素个数超过阈值（8）时就进行树化</span></span><br><span class="line">                        <span class="keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="number">1</span>)</span><br><span class="line">                            treeifyBin(tab, hash);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">         ...省略部分代码...</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="红黑树的具体实现方式（重点）"><a href="#红黑树的具体实现方式（重点）" class="headerlink" title="红黑树的具体实现方式（重点）"></a>红黑树的具体实现方式（重点）</h2><p>在JDK1.8 HashMap中，转换为红黑树大致分为三个步骤  </p><ol><li>第一阶段：将链表转化为二叉树</li><li>第二节点：验证是否满足红黑树的五大特征</li><li>第三阶段：对二叉树进行左右旋转操作</li></ol><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//将链表转化为二叉树；即tab为链表</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">void</span> treeifyBin(Node&lt;K,V&gt;[] tab, <span class="built_in">int</span> hash) &#123;</span><br><span class="line">        <span class="built_in">int</span> n, index; Node&lt;K,V&gt; e;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">        如果node节点数组为空或者node节点数组的长度小于最小树化容量则进入判断进行初始化该节点数组吧应该是。或者扩容?</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">        对n进行赋值为链表的长度</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">        */</span></span></span></span><br><span class="line">        <span class="keyword">if</span> (tab == <span class="keyword">null</span> || (n = tab.length) &lt; MIN_TREEIFY_CAPACITY)</span><br><span class="line">            resize();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">        key根据算法算出得到hash,</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">        然后通过(n - 1) &amp; hash进行得到下标index位置，</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">        这里根据(n - 1) &amp; hash得到下标位置index也有一段说辞，</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">        请看视频：https://ke.qq.com/webcourse/index.html#cid=459141&amp;term_id=100549477&amp;taid=4078067153043845&amp;vid=5285890795538344618</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">        此处判断Node节点数组当中的该index下标位置上的Node是否为空</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">        如果不为空则进入判断</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">        */</span></span></span></span><br><span class="line">        <span class="comment">//重新计算hash段位，以及table节点数组的索引位，第一个节点</span></span><br><span class="line">        <span class="comment">//链表长度-1&amp;hash得到index下标取值</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((e = tab[index = (n - <span class="number">1</span>) &amp; hash]) != <span class="keyword">null</span>) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">          <span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="emphasis">*双向链表 strat*</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="emphasis">***</span>/</span></span></span><br><span class="line">          <span class="comment">//定义树节点hd为空； 树节点tl为空</span></span><br><span class="line">          <span class="comment">//hd：头节点head；tl: 为节点tail</span></span><br><span class="line">            TreeNode&lt;K,V&gt; hd = <span class="keyword">null</span>, tl = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">                将节点替换为TreeNode</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">                循环所有节点；即tab当中的所有Node(Node&lt;K,V&gt; e)</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">                获取相对应的树节点p</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">                */</span></span></span></span><br><span class="line">                TreeNode&lt;K,V&gt; p = replacementTreeNode(e, <span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//如果当前尾节点为空则将当前循环的p节点赋值给头结点</span></span><br><span class="line">                <span class="keyword">if</span> (tl == <span class="keyword">null</span>)</span><br><span class="line">　　　　　　　　　　　<span class="comment">//hd指向头结点</span></span><br><span class="line">                    hd = p;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">                    这里其实是将单链表转化成了双向链表，</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">                    tl是p的前驱，</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">                    每次循环更新指向双链表的最后一个元素，</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">                    用来和p相连，</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">                    p是当前节点</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">                    */</span></span></span></span><br><span class="line">                    p.prev = tl;</span><br><span class="line">                    tl.next = p;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//对尾节点进行赋值为当前树节点</span></span><br><span class="line">                tl = p;</span><br><span class="line"></span><br><span class="line">                <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">                如果当前执行完do后执行while,首先进行重新赋值，</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">                将e.next下一节点赋值给当前节点e，</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">                并判断该节点是否为空;</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">                不为空的情况下继续执行否则结束循环；</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">                */</span></span></span></span><br><span class="line">            &#125; <span class="keyword">while</span> ((e = e.next) != <span class="keyword">null</span>);</span><br><span class="line">          <span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="emphasis">*双向链表 end*</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="emphasis">***</span>/</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">            前面仅仅转换为双向链表，treeify才是转换红黑树的处理方法入口;</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">            第一个节点赋值为头结点，也就是根节点</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">            查询链表当中是否存在头结点hd，如果不为空存在的话即验证</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">            */</span></span></span></span><br><span class="line">            <span class="keyword">if</span> ((tab[index] = hd) != <span class="keyword">null</span>)</span><br><span class="line">                <span class="comment">//将链表进行树化；将二叉树转换为红黑树；</span></span><br><span class="line">                hd.treeify(tab);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>在treeifyBin函数中，先将所有节点替换为TreeNode，然后再将单链表转为双链表，方便之后的遍历和移动操作。<br>而最终的操作，实际上是调用了TreeNode的方法treeify进行的</p><p>看这些代码让我看得怀疑人生。仿佛又回到了当年的数学课。  </p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//树化</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">调用这个方法之前，也就是一个双向链表</span></span><br><span class="line"><span class="comment">初始进入值为 this头结点</span></span><br><span class="line"><span class="comment">将双向链表转换为红黑树</span></span><br><span class="line"><span class="comment">目标：查询root节点</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">验证是否满足红黑树的五大特征</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">final void treeify(Node&lt;K,V&gt;<span class="literal">[]</span> tab) &#123;</span><br><span class="line">            <span class="comment">//树的根节点；初始化为空；root节点</span></span><br><span class="line">            TreeNode&lt;K,V&gt; root = null;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//x是当前节点，next是后继</span></span><br><span class="line">            <span class="comment">//这里的this是树转换数组索引处的第一个链表元素</span></span><br><span class="line">            for (TreeNode&lt;K,V&gt; x = this, next; x != null; x = next) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//next 当前节点的下一个节点，对next节点进行重新赋值</span></span><br><span class="line">                next = (TreeNode&lt;K,V&gt;)x.next;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//设置左右节点为空</span></span><br><span class="line">                x.left = x.right = null;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//如果根节点为null，把当前节点设置为根节点</span></span><br><span class="line">                <span class="comment">//首次循环root根节点==null，设置当前循环的x节点为根节点</span></span><br><span class="line">                <span class="comment">//设置根节点特征</span></span><br><span class="line">                <span class="keyword">if</span> (root<span class="operator"> == </span>null) &#123;</span><br><span class="line"></span><br><span class="line">                  <span class="comment">//将根节点的父节点位置设置为空；根节点没有父节点</span></span><br><span class="line">                    x.parent = null;</span><br><span class="line">                  <span class="comment">//将根节点设置为black黑色；根节点是黑色的</span></span><br><span class="line">                    x.red = <span class="literal">false</span>;</span><br><span class="line">                  <span class="comment">//将当前节点设置为根节点，根节点重新赋值</span></span><br><span class="line">                    root = x;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//如果根节点现在不为空则当前的x节点，非根节点</span></span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                  <span class="comment">//当前节点x的键进行赋值给k</span></span><br><span class="line">                  <span class="comment">//获取当前循环节点x的Key</span></span><br><span class="line">                    K k = x.key;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">//得到当前该节点x的hash进行赋值给h</span></span><br><span class="line">                    <span class="comment">//获取当前节点x的Hash</span></span><br><span class="line">                    <span class="built_in">int</span> h = x.hash;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">//定义key所属于的class</span></span><br><span class="line">                    Class&lt;?&gt; kc = null;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">//这里循环遍历，进行二叉搜索树的插入</span></span><br><span class="line">                    <span class="comment">//从根节点开始验证</span></span><br><span class="line">                    <span class="comment">/**</span></span><br><span class="line"><span class="comment">                    循环这个红黑树，从根节点开始，也就是从上到下进行遍历</span></span><br><span class="line"><span class="comment">                    外层循环树节点也就相当于是Entry[]循环，内部是新建的，</span></span><br><span class="line"><span class="comment">                    外层循环到的当前该节点x也就相当于Entry,与构建的红黑树当中的根节点是否为空进行比较，</span></span><br><span class="line"><span class="comment">                    如果根节点不为空则说明当前遍历的x节点为非根节点，也就是左节点或者右节点，子节点</span></span><br><span class="line"><span class="comment">                    如果根节点为空则使之当前循环遍历到的x节点为根节点</span></span><br><span class="line"><span class="comment">                    */</span></span><br><span class="line">                    for (TreeNode&lt;K,V&gt; p = root;;) &#123;</span><br><span class="line"></span><br><span class="line">                        <span class="comment">/**</span></span><br><span class="line"><span class="comment">                        p指向遍历中的当前节点，</span></span><br><span class="line"><span class="comment">                        x为待插入节点，</span></span><br><span class="line"><span class="comment">                        k是x的key，</span></span><br><span class="line"><span class="comment">                        h是x的hash值，</span></span><br><span class="line"><span class="comment">                        ph是p的hash值，</span></span><br><span class="line"><span class="comment">                        dir用来指示x节点与p的比较，</span></span><br><span class="line"><span class="comment">                        -1表示比p小，</span></span><br><span class="line"><span class="comment">                        1表示比p大，</span></span><br><span class="line"><span class="comment">                        不存在相等情况，</span></span><br><span class="line"><span class="comment">                        因为HashMap中是不存在两个key完全一致的情况。</span></span><br><span class="line"><span class="comment">                        */</span></span><br><span class="line">                        <span class="built_in">int</span> dir, ph;</span><br><span class="line">                        K pk = p.key;<span class="comment">//每一个节点的key</span></span><br><span class="line"></span><br><span class="line">                        <span class="comment">/**</span></span><br><span class="line"><span class="comment">                        每个节点的hash与外层的x.hash作比较</span></span><br><span class="line"><span class="comment">                        这里做了一个赋值的操作，即当前内部循环当中循环的节点p的hash赋值给了ph;</span></span><br><span class="line"><span class="comment">                        如果当前内部循环的字节点的hash大于外层循环当中x的hash值时，则进行判断其hash大小，</span></span><br><span class="line"><span class="comment">                        通过判断hash大小，</span></span><br><span class="line"><span class="comment">                        从而可以知道节点大致位置，比如在左边还是右边</span></span><br><span class="line"><span class="comment">                        因为(n-1) &amp; hash得到index下标位置</span></span><br><span class="line"><span class="comment">                        */</span></span><br><span class="line">                        <span class="keyword">if</span> ((ph = p.hash) &gt; h)</span><br><span class="line">                        <span class="comment">/**</span></span><br><span class="line"><span class="comment">                        dir用来指示x节点与当前内部的p节点的比较，</span></span><br><span class="line"><span class="comment">                        如果dir小于0，沿左路径查找；</span></span><br><span class="line"><span class="comment">                        二叉查找树特征即为：任意节点大于左节点值，小于右节点值；</span></span><br><span class="line"><span class="comment">                        */</span></span><br><span class="line">                            dir = -<span class="number">1</span>;</span><br><span class="line">                        <span class="comment">/**</span></span><br><span class="line"><span class="comment">                        如果dir大于0，则沿右路径查找</span></span><br><span class="line"><span class="comment">                        */</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span> (ph &lt; h)</span><br><span class="line">                            dir = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                        <span class="comment">/**</span></span><br><span class="line"><span class="comment">                        如果hash值相等，</span></span><br><span class="line"><span class="comment">                        那么判断k是否实现了comparable接口，</span></span><br><span class="line"><span class="comment">                        如果实现了comparable接口就使用compareTo进行进行比较，</span></span><br><span class="line"><span class="comment">                        如果仍旧相等或者没有实现comparable接口，则在tieBreakOrder中比较</span></span><br><span class="line"><span class="comment">                        */</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span> ((kc<span class="operator"> == </span>null &amp;&amp;</span><br><span class="line">                                  (kc = comparable<span class="constructor">ClassFor(<span class="params">k</span>)</span>)<span class="operator"> == </span>null) <span class="pattern-match"><span class="operator">||</span></span></span><br><span class="line"><span class="pattern-match">                                 (dir = compare<span class="constructor">Comparables(<span class="params">kc</span>, <span class="params">k</span>, <span class="params">pk</span>)</span>) <span class="operator">==</span> 0)</span></span><br><span class="line"><span class="pattern-match">                            dir = tie<span class="constructor">BreakOrder(<span class="params">k</span>, <span class="params">pk</span>)</span>;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">                        <span class="operator">/</span><span class="operator">/</span>xp节点为内部循环遍历的节点p</span></span><br><span class="line"><span class="pattern-match">                        <span class="operator">/</span><span class="operator">/</span>p设置为x的父节点 xp</span></span><br><span class="line"><span class="pattern-match">                        <span class="constructor">TreeNode</span>&lt;<span class="constructor">K</span>,<span class="constructor">V</span>&gt; xp = p;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">                        <span class="operator">/</span><span class="operator">**</span></span></span><br><span class="line"><span class="pattern-match">                        dir默认为0；</span></span><br><span class="line"><span class="pattern-match">                        所以此处如果dir小于等于0即定义为向左</span></span><br><span class="line"><span class="pattern-match">                        沿左路径查找;</span></span><br><span class="line"><span class="pattern-match">                        如果dir小于等于0取值为内部循环节点p的左节点否则为右节点;</span></span><br><span class="line"><span class="pattern-match">                        对获取得到的该节点进行判空;</span></span><br><span class="line"><span class="pattern-match">                        内部循环也是从上往下循环节点的；</span></span><br><span class="line"><span class="pattern-match">                        所以如果当前内部循环的p节点的左节点或者右节点为空，即进行插入操作</span></span><br><span class="line"><span class="pattern-match">                        <span class="operator">*</span><span class="operator">/</span></span></span><br><span class="line"><span class="pattern-match">                        <span class="keyword">if</span> ((p = (dir &lt;= 0) ? p.left : p.right) <span class="operator">==</span> null) &#123;</span></span><br><span class="line"><span class="pattern-match">                          <span class="operator">/</span><span class="operator">/</span>将xp设置为x的父节点</span></span><br><span class="line"><span class="pattern-match">                            x.parent = xp;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">                            <span class="keyword">if</span> (dir &lt;= 0)</span></span><br><span class="line"><span class="pattern-match">                                xp.left = x;</span></span><br><span class="line"><span class="pattern-match">                            <span class="keyword">else</span></span></span><br><span class="line"><span class="pattern-match">                                xp.right = x;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">　　　　　　　　　　　　　　　　 <span class="operator">/</span><span class="operator">/</span>进行插入平衡处理</span></span><br><span class="line"><span class="pattern-match">                              <span class="operator">/</span><span class="operator">/</span>将二叉树转换为红黑树-正式转换红黑树</span></span><br><span class="line"><span class="pattern-match">                            root = balance<span class="constructor">Insertion(<span class="params">root</span>, <span class="params">x</span>)</span>;</span></span><br><span class="line"><span class="pattern-match">                            break;</span></span><br><span class="line"><span class="pattern-match">                        &#125;</span></span><br><span class="line"><span class="pattern-match">                    &#125;</span></span><br><span class="line"><span class="pattern-match">                &#125;</span></span><br><span class="line"><span class="pattern-match">            &#125;</span></span><br><span class="line"><span class="pattern-match">　　　　　　　<span class="operator">/</span><span class="operator">/</span>确保给定节点是桶中的第一个元素</span></span><br><span class="line"><span class="pattern-match">            move<span class="constructor">RootToFront(<span class="params">tab</span>, <span class="params">root</span>)</span>;</span></span><br><span class="line"><span class="pattern-match">        &#125;</span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match"></span></span><br><span class="line"><span class="pattern-match">     <span class="operator">/</span><span class="operator">/</span>这里不是为了整体排序，而是为了在插入中保持一致的顺序</span></span><br><span class="line"><span class="pattern-match">     static <span class="built_in">int</span> tie<span class="constructor">BreakOrder(Object <span class="params">a</span>, Object <span class="params">b</span>)</span> &#123;</span></span><br><span class="line"><span class="pattern-match">            <span class="built_in">int</span> d;</span></span><br><span class="line"><span class="pattern-match">            <span class="operator">/</span><span class="operator">/</span>用两者的类名进行比较，如果相同则使用对象默认的hashcode进行比较</span></span><br><span class="line"><span class="pattern-match">            <span class="keyword">if</span> (a <span class="operator">==</span> null <span class="operator">||</span> b <span class="operator">==</span> null <span class="operator">||</span></span></span><br><span class="line"><span class="pattern-match">                (d = a.get<span class="constructor">Class()</span>.get<span class="constructor">Name()</span>.</span></span><br><span class="line"><span class="pattern-match">                 compare<span class="constructor">To(<span class="params">b</span>.<span class="params">getClass</span>()</span>.get<span class="constructor">Name()</span>)) <span class="operator">==</span> 0)</span></span><br><span class="line"><span class="pattern-match">                d = (<span class="constructor">System</span>.identity<span class="constructor">HashCode(<span class="params">a</span>)</span> &lt;= <span class="constructor">System</span>.identity<span class="constructor">HashCode(<span class="params">b</span>)</span> ?</span></span><br><span class="line"><span class="pattern-match">                     -1 : 1);</span></span><br><span class="line"><span class="pattern-match">            return d;</span></span><br><span class="line"><span class="pattern-match">        &#125;</span></span><br></pre></td></tr></table></figure><p>这里的逻辑其实并不复杂，仅仅是循环遍历当前树，然后找到可以该节点可以插入的位置，依次和遍历节点比较，比他大则跟其右孩子比较，小则与其左孩子比较，依次遍历，直到找到左孩子或者右孩子为null的位置进行插入。  </p><p>真正复杂一点的地方在于balanceInsertion函数，这个函数，后欧诺个黑叔进行插入平衡处理，保证插入节点后仍保持红黑树性质。  </p><p>这个函数稍后在TreeNode的插入中进行介绍，这里先看moveRootToFront,这个函数是将root节点移动到同种的第一个元素，也就是链表的首节点，这样做是因为在判断同种元素类型的时候会对链表进行遍历，将根节点移动到链表前端可以确保类型判断时不会出现错误。</p><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 把给定节点设为桶中的第一个元素</span><br><span class="line"> */        </span><br><span class="line">    static &lt;K,V&gt; void moveRootToFront(Node&lt;K,V&gt;[] tab, TreeNode&lt;K,V&gt; root) &#123;</span><br><span class="line">            <span class="type">int</span> n;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//如果根节点不为空以及树节点数组不为空以及树节点数组长度大于0</span></span><br><span class="line">            if (root != <span class="built_in">null</span> &amp;&amp; tab != <span class="built_in">null</span> &amp;&amp; (n = tab.length) &gt; <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">               <span class="comment">//得到该根节点在该树节点数组当中的位置下标index</span></span><br><span class="line">                <span class="type">int</span> index = (n - <span class="number">1</span>) &amp; root.hash;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//first指向链表第一个节点</span></span><br><span class="line">                TreeNode&lt;K,V&gt; <span class="built_in">first</span> = (TreeNode&lt;K,V&gt;)tab[index];</span><br><span class="line"></span><br><span class="line">                <span class="comment">//判断如果根节点与index查找出来的根节点不一致则</span></span><br><span class="line">                if (root != <span class="built_in">first</span>) &#123;</span><br><span class="line">                    <span class="comment">//如果root不是第一个节点，则将root放到第一个首节点位置</span></span><br><span class="line"></span><br><span class="line">                    <span class="comment">//定义next节点应该是</span></span><br><span class="line">                    Node&lt;K,V&gt; rn;</span><br><span class="line"></span><br><span class="line">                  <span class="comment">//对index位置的节点，树节点数组进行重新赋值为指定的根节点</span></span><br><span class="line">                    tab[index] = root;</span><br><span class="line"></span><br><span class="line">                  <span class="comment">//root节点的上一个节点进行赋值给rp</span></span><br><span class="line">                    TreeNode&lt;K,V&gt; rp = root.<span class="built_in">prev</span>;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">//对rn进行重新赋值为根节点的下一节点，判空</span></span><br><span class="line">                    if ((rn = root.<span class="built_in">next</span>) != <span class="built_in">null</span>)</span><br><span class="line">                        ((TreeNode&lt;K,V&gt;)rn).<span class="built_in">prev</span> = rp;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">//对rp进行判空，即根节点的上一节点判空</span></span><br><span class="line">                    if (rp != <span class="built_in">null</span>)</span><br><span class="line">                        rp.<span class="built_in">next</span> = rn;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">//</span></span><br><span class="line">                    if (<span class="built_in">first</span> != <span class="built_in">null</span>)</span><br><span class="line">                        <span class="built_in">first</span>.<span class="built_in">prev</span> = root;</span><br><span class="line">                    root.<span class="built_in">next</span> = <span class="built_in">first</span>;</span><br><span class="line">                    root.<span class="built_in">prev</span> = <span class="built_in">null</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//这里是防御性编程，校验更改后的结构是否满足红黑树和双链表的特性</span></span><br><span class="line">                <span class="comment">//因为HashMap并没有做并发安全处理，可能在并发场景中意外破坏了结构</span></span><br><span class="line">                assert checkInvariants(root);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><h3 id="红黑树的左旋和右旋"><a href="#红黑树的左旋和右旋" class="headerlink" title="红黑树的左旋和右旋"></a>红黑树的左旋和右旋</h3><blockquote><p>左旋和右旋，顾名思义，就是将节点以某个节点向左或者向右进行旋转操作以保持二叉树的平衡</p></blockquote><h3 id="二叉树的左旋"><a href="#二叉树的左旋" class="headerlink" title="二叉树的左旋"></a>二叉树的左旋</h3><p>左旋：相当于以要旋转的节点为中心，将子树整体向左旋转，该节点变成子树的根节点，原来的父节点A变成了左孩子，如果右孩子C有左孩子D，则将其便成为A的右孩子  </p><p>当节点A向左旋转之后，C的左孩子D可以理解为因为重力问题掉到A的右孩子的位置。  </p><p> <img src="https://images2018.cnblogs.com/blog/1043143/201807/1043143-20180717135149338-1921395779.png" alt="image"></p><h3 id="二叉树的右旋"><a href="#二叉树的右旋" class="headerlink" title="二叉树的右旋"></a>二叉树的右旋</h3><p> <img src="https://images2018.cnblogs.com/blog/1043143/201807/1043143-20180717135200454-1697647783.png" alt="image"></p><h3 id="TreeNode的左旋和右旋"><a href="#TreeNode的左旋和右旋" class="headerlink" title="TreeNode的左旋和右旋"></a>TreeNode的左旋和右旋</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 左旋</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">static</span> &lt;K,V&gt; TreeNode&lt;K,V&gt; rotateLeft(TreeNode&lt;K,V&gt; root,</span><br><span class="line">                                              TreeNode&lt;K,V&gt; p) &#123;</span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">            这里的p即上图的A节点，</span></span><br><span class="line"><span class="comment">            r指向右孩子即C，</span></span><br><span class="line"><span class="comment">            rl指向右孩子的左孩子即D，</span></span><br><span class="line"><span class="comment">            pp为p的父节点</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">            TreeNode&lt;K,V&gt; r, pp, rl;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//判断A节点是否为空以及A的右节点C节点r是否不为空,满足判断即左旋</span></span><br><span class="line">            <span class="keyword">if</span> (p != <span class="keyword">null</span> &amp;&amp; (r = p.right) != <span class="keyword">null</span>) &#123;</span><br><span class="line"></span><br><span class="line">              <span class="comment">/**</span></span><br><span class="line"><span class="comment">              如果A的右节点C，</span></span><br><span class="line"><span class="comment">              C的左节点D赋值给A节点的右节点；</span></span><br><span class="line"><span class="comment">              且将A节点的右节点赋值给r1树节点</span></span><br><span class="line"><span class="comment">              */</span></span><br><span class="line">                <span class="keyword">if</span> ((rl = p.right = r.left) != <span class="keyword">null</span>)</span><br><span class="line">                <span class="comment">//将D的父节点重新赋值为A节点</span></span><br><span class="line">                    rl.<span class="keyword">parent</span> = p;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//将p的父节点的孩子节点指向r</span></span><br><span class="line">                <span class="comment">/**</span></span><br><span class="line"><span class="comment">                A的父节点重新赋值给，A节点的右节点即C节点</span></span><br><span class="line"><span class="comment">                C节点的父节点重新赋值给pp节点，进行判空</span></span><br><span class="line"><span class="comment">                如果为空则C节点重新赋值给root根节点指向，</span></span><br><span class="line"><span class="comment">                将从C节点的是否标红改为false，即根节点的颜色都是黑色的</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line">                <span class="keyword">if</span> ((pp = r.<span class="keyword">parent</span> = p.<span class="keyword">parent</span>) == <span class="keyword">null</span>)</span><br><span class="line">                    (root = r).red = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">                <span class="comment">/**</span></span><br><span class="line"><span class="comment">                如果A的父节点赋值给C的父节点，C的父节点赋值给pp节点</span></span><br><span class="line"><span class="comment">                如果pp节点的左节点为为A节点；</span></span><br><span class="line"><span class="comment">                则pp节点的左节点进行重新赋值为C节点</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (pp.left == p)</span><br><span class="line">                    pp.left = r;</span><br><span class="line"></span><br><span class="line">                <span class="comment">/**</span></span><br><span class="line"><span class="comment">                最后如果不满足以上条件则进入else判断</span></span><br><span class="line"><span class="comment">                A节点的父节点C节点的父节点pp节点的右节点改为C节点</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    pp.right = r;</span><br><span class="line">                <span class="comment">//将p置为r的左节点</span></span><br><span class="line">                r.left = p;</span><br><span class="line">                p.<span class="keyword">parent</span> = r;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> root;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 右旋</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">static</span> &lt;K,V&gt; TreeNode&lt;K,V&gt; rotateRight(TreeNode&lt;K,V&gt; root,</span><br><span class="line">                                               TreeNode&lt;K,V&gt; p) &#123;</span><br><span class="line">             <span class="comment">//这里的p即上图的A节点，l指向左孩子即C，lr指向左孩子的右孩子即E，pp为p的父节点</span></span><br><span class="line">            TreeNode&lt;K,V&gt; l, pp, lr;</span><br><span class="line">            <span class="keyword">if</span> (p != <span class="keyword">null</span> &amp;&amp; (l = p.left) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> ((lr = p.left = l.right) != <span class="keyword">null</span>)</span><br><span class="line">                    lr.<span class="keyword">parent</span> = p;</span><br><span class="line">                <span class="keyword">if</span> ((pp = l.<span class="keyword">parent</span> = p.<span class="keyword">parent</span>) == <span class="keyword">null</span>)</span><br><span class="line">                    (root = l).red = <span class="keyword">false</span>;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (pp.right == p)</span><br><span class="line">                    pp.right = l;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    pp.left = l;</span><br><span class="line">                l.right = p;</span><br><span class="line">                p.<span class="keyword">parent</span> = l;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> root;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><h3 id="红黑树的插入"><a href="#红黑树的插入" class="headerlink" title="红黑树的插入"></a>红黑树的插入</h3><p>红黑树的插入，首先找到这个节点要插入的位置。<br>即一层一层比较，大的放右边，小的放左边，直到找到为null的节点放入即可。<br>可是如何在插入的过程中保持红黑树的特性呢，其实又这么几种情况：</p><ol><li>插入的为根节点，则直接把颜色改成黑色即可。</li><li>插入的节点的父节点是黑色节点，则不需要调整，因为插入的节点会初始化为红色节点，红色节点是不会影响树的平衡的。</li><li>插入的节点的祖父节点为null，即插入的节点的父节点是根节点，直接插入即可（因为根节点肯定是黑色）。</li><li>插入的节点父节点和祖父节点都存在，并且其父节点是祖父节点的左节点。这种情况稍微麻烦一点，又分两种子情况：</li></ol><ul><li>插入节点的叔叔节点是红色，则将父亲节点和叔叔节点都改成黑色，然后祖父节点改成红色即可。</li><li>插入节点的叔叔节点是黑色或不存在：<ul><li>若插入节点是其父节点的孩子，则将其父节点左旋</li><li>若为左孩子，则将其父节点变成黑色节点，将其祖父节点变成红色节点，然后将其祖父节点右旋。</li></ul></li></ul><ol start="5"><li>插入的节点父节点和祖父节点都存在，并且其父节点是祖父节点的右节点。这种情况跟上面是类似的，分两种子情况：</li></ol><ul><li>插入节点的叔叔节点是红色，则将父亲节点和叔叔节点都改成黑色，然后祖父节点改成红色即可。</li><li>插入节点的叔叔节点是黑色或不存在：<ul><li>若插入节点是其父节点的左孩子，则将其父节点右旋。</li><li>若为右孩子，则将其父节点变成黑色节点，将其祖父节点变成红色节点，然后将其祖父节点左旋。</li></ul></li></ul><p>然后重复进行上述操作，直到变成1或2的情况时则结束变换。<br>构建一棵红黑树，假设插入的顺序为：10,5,9,3,6,7,19,32,24,17</p><p>先来插个10，为情境1，直接改成黑色即可；<br>再插入5，为情境2，比10小，放到10的左孩子位置；<br>插入9，比10小，但是比5大，放到5的右孩子位置，此时为情境4iia，左旋后变成了情境4iib，变色右旋即可完成转化；<br>插入3后为情境4i，将父节点和叔叔节点同时变色即可；<br>插入6不需要调整；<br>插入7后变为情境5i，变色即可。<br>插入19不需要调整；<br>插入32，变成了5iib，左旋变色即可；<br>插入24，变成5iia，右旋变成5i，变色即可；<br>最后插入17，完美</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">static &lt;K,V&gt; TreeNode&lt;K,V&gt; balanceInsertion(TreeNode&lt;K,V&gt; root,</span><br><span class="line">                                                    TreeNode&lt;K,V&gt; x) &#123;</span><br><span class="line">            x.<span class="attr">red</span> = <span class="literal">true</span>;</span><br><span class="line">            for (TreeNode&lt;K,V&gt; xp, xpp, xppl, xppr;;) &#123;</span><br><span class="line">                //情景<span class="number">1</span>：父节点为<span class="literal">null</span></span><br><span class="line">                <span class="keyword">if</span> ((<span class="attr">xp</span> = x.parent) == <span class="literal">null</span>) &#123;</span><br><span class="line">                    x.<span class="attr">red</span> = <span class="literal">false</span>;</span><br><span class="line">                    return x;</span><br><span class="line">                &#125;</span><br><span class="line">　　　　　　　　　 //情景<span class="number">2</span>，<span class="number">3</span>：父节点是黑色节点或者祖父节点为<span class="literal">null</span></span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (!xp.red || (<span class="attr">xpp</span> = xp.parent) == <span class="literal">null</span>)</span><br><span class="line">                    return root;</span><br><span class="line">　　　　　　　　　　//情景<span class="number">4</span>：插入的节点父节点和祖父节点都存在，并且其父节点是祖父节点的左节点</span><br><span class="line">                <span class="keyword">if</span> (<span class="attr">xp</span> == (<span class="attr">xppl</span> = xpp.left)) &#123;</span><br><span class="line">　　　　　　　　　　　　//情景<span class="number">4</span>i：插入节点的叔叔节点是红色</span><br><span class="line">                    <span class="keyword">if</span> ((<span class="attr">xppr</span> = xpp.right) != <span class="literal">null</span> &amp;&amp; xppr.red) &#123;</span><br><span class="line">                        xppr.<span class="attr">red</span> = <span class="literal">false</span>;</span><br><span class="line">                        xp.<span class="attr">red</span> = <span class="literal">false</span>;</span><br><span class="line">                        xpp.<span class="attr">red</span> = <span class="literal">true</span>;</span><br><span class="line">                        <span class="attr">x</span> = xpp;</span><br><span class="line">                    &#125;</span><br><span class="line">　　　　　　　　　　　　//情景<span class="number">4</span>ii：插入节点的叔叔节点是黑色或不存在</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">　　　　　　　　　　　　　　//情景<span class="number">4</span>iia：插入节点是其父节点的右孩子</span><br><span class="line">                        <span class="keyword">if</span> (<span class="attr">x</span> == xp.right) &#123;</span><br><span class="line">                            <span class="attr">root</span> = rotateLeft(root, <span class="attr">x</span> = xp);</span><br><span class="line">                            <span class="attr">xpp</span> = (<span class="attr">xp</span> = x.parent) == <span class="literal">null</span> ? <span class="literal">null</span> : xp.parent;</span><br><span class="line">                        &#125;</span><br><span class="line">　　　　　　　　　　　　　　//情景<span class="number">4</span>iib：插入节点是其父节点的左孩子</span><br><span class="line">                        <span class="keyword">if</span> (xp != <span class="literal">null</span>) &#123;</span><br><span class="line">                            xp.<span class="attr">red</span> = <span class="literal">false</span>;</span><br><span class="line">                            <span class="keyword">if</span> (xpp != <span class="literal">null</span>) &#123;</span><br><span class="line">                                xpp.<span class="attr">red</span> = <span class="literal">true</span>;</span><br><span class="line">                                <span class="attr">root</span> = rotateRight(root, xpp);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">　　　　　　　　　 //情景<span class="number">5</span>：插入的节点父节点和祖父节点都存在，并且其父节点是祖父节点的右节点</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">　　　　　　　　　　　　//情景<span class="number">5</span>i：插入节点的叔叔节点是红色</span><br><span class="line">                    <span class="keyword">if</span> (xppl != <span class="literal">null</span> &amp;&amp; xppl.red) &#123;</span><br><span class="line">                        xppl.<span class="attr">red</span> = <span class="literal">false</span>;</span><br><span class="line">                        xp.<span class="attr">red</span> = <span class="literal">false</span>;</span><br><span class="line">                        xpp.<span class="attr">red</span> = <span class="literal">true</span>;</span><br><span class="line">                        <span class="attr">x</span> = xpp;</span><br><span class="line">                    &#125;</span><br><span class="line">　　　　　　　　　　　　//情景<span class="number">5</span>ii：插入节点的叔叔节点是黑色或不存在</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">·　　　　　　　　　　　　　　//情景<span class="number">5</span>iia：插入节点是其父节点的左孩子　</span><br><span class="line">                        <span class="keyword">if</span> (<span class="attr">x</span> == xp.left) &#123;</span><br><span class="line">                            <span class="attr">root</span> = rotateRight(root, <span class="attr">x</span> = xp);</span><br><span class="line">                            <span class="attr">xpp</span> = (<span class="attr">xp</span> = x.parent) == <span class="literal">null</span> ? <span class="literal">null</span> : xp.parent;</span><br><span class="line">                        &#125;</span><br><span class="line">　　　　　　　　　　　　　　//情景<span class="number">5</span>iib：插入节点是其父节点的右孩子</span><br><span class="line">                        <span class="keyword">if</span> (xp != <span class="literal">null</span>) &#123;</span><br><span class="line">                            xp.<span class="attr">red</span> = <span class="literal">false</span>;</span><br><span class="line">                            <span class="keyword">if</span> (xpp != <span class="literal">null</span>) &#123;</span><br><span class="line">                                xpp.<span class="attr">red</span> = <span class="literal">true</span>;</span><br><span class="line">                                <span class="attr">root</span> = rotateLeft(root, xpp);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><h3 id="红黑树的删除"><a href="#红黑树的删除" class="headerlink" title="红黑树的删除"></a>红黑树的删除</h3><p>红黑树是一颗特殊的二叉搜索树，所以进行删除操作时，其实是先进行二叉搜索树的删除，然后再进行整理。  </p><p>所以，其实这里分为两部分内容：</p><ul><li>二叉搜索树的删除</li><li>红黑树的删除调整</li></ul><p>二叉搜索树的删除主要有这么几种情境：<br>情境一：待删除的节点五左右孩子；<br>情景二：待删除的节点只有左孩子或者右孩子；<br>情境三：待删除的节点既有左孩子又有右孩子；</p><p>对于情景一，直接删除即可；<br>情景二，则直接把该节点的父节点指向他的左孩子或者右孩子即可；<br>情境三稍微复杂一点，需要先找到其右子树的最左孩子(或者左子树的最右孩子)，即左（右）子树中序遍历时的第一个节点，然后将其与待删除的节点互换，最后再删除该节点（如果有右子树，则右子树上位）。<br>总之，就是先找到他的替代者，找到之后替换这个要删除的节点，然后再把这个节点真正删除掉。  </p><p>其实二叉搜索树的删除总体来说还是比较简单的。<br>删除完之后，如果替代者是红色节点，则不需要调整；<br>如果是黑色节点，则会导致左子树和右子树路径中黑色节点数量不一致，需要进行红黑树的调整；<br>跟上面一样，替代节点为其父节点的左孩子与右孩子的情况类似，所以这里直说其为左孩子的情景（PS：上一步的寻找替换节点使用的是右子树的最左节点，所以该节点如果右孩子，只能是右孩子）；  </p><p>情景一：只有右孩子且为红色，直接用右孩子替换该节点然后变成黑色即可。  </p><p>（D代表替代节点，即要被删除的节点，之前在经过二叉搜索树的删除之后，D节点其实已经被删除了，这里为了方便理解这个变化过程，所以把这个节点也画出来了，所以当初的初始状态是待删除节点与其替换节点互换位置与颜色字后的状态）  </p><p>情景二：只有右孩子且为黑色，那么删除该节点会导致父节点的左子树路径上黑色节点减一，此时只能去借助右子树，从右子树中借一个红色节点过来即可，具体取决于右子树的情况，这里又要分成两种情况：  </p><ul><li><p>兄弟节点是红色，则此时父节点是黑色，且兄弟节点肯定有两个孩子，且兄弟节点的左右子树路径上均有两个黑色节点，此时只需将兄弟节点与父节点颜色互换，然后将父节点左旋，左旋后，兄弟节点的左子树SL挂到了父节点p的右孩子位置，这时会导致p的右子树路径上的黑色节点比左子树多一，此时再SL置为红色即可。  </p></li><li><p>兄弟节点是黑色，那么就只能打他孩子的主意了。这里主要关注远侄子（兄弟节点的右孩子，即SR）的颜色情况，这里分成两种情况：</p><ul><li>远侄子SR是黑色，近侄子任意（白色代表颜色可以为任意颜色），现将S转为红色，然后右旋，再将SL换成P节点颜色，P土城黑色，S也涂成黑色，在进行左旋即可。<br>其实简单说就是SL上位，替换父节点位置。  </li><li>远侄子SR为红色，近侄子（该子树路径中有且有仅有一个黑色节点），则现将兄弟节点与父节点颜色互换，将SR涂成黑色，再将父节点左旋即可。  </li></ul></li></ul><h3 id="TreeNode的删除节点"><a href="#TreeNode的删除节点" class="headerlink" title="TreeNode的删除节点"></a>TreeNode的删除节点</h3><p>TreeNode删除节点其实也是两步走：  </p><ol><li>先进性二叉搜索树的删除，然后再进行红黑树的调整，跟之前的情况分析是一致的。  </li></ol><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">final void removeTreeNode(HashMap&lt;K,V&gt; <span class="built_in">map</span>, Node&lt;K,V&gt;[] tab, boolean movable) &#123;</span><br><span class="line"></span><br><span class="line">     ......</span><br><span class="line"></span><br><span class="line">     //p是待删除节点，replacement用于后续的红黑树调整，指向的是p或者p的继承者。</span><br><span class="line">     //如果p是叶子节点，<span class="attr">p==replacement，否则replacement为p的右子树中最左节点</span></span><br><span class="line">     <span class="keyword">if</span> (replacement != p) &#123;</span><br><span class="line">        //若p不是叶子节点，则让replacement的父节点指向p的父节点</span><br><span class="line">        TreeNode&lt;K,V&gt; <span class="attr">pp</span> = replacement.<span class="attr">parent</span> = p.parent;</span><br><span class="line">        <span class="keyword">if</span> (<span class="attr">pp</span> == <span class="literal">null</span>)</span><br><span class="line">            <span class="attr">root</span> = replacement;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="attr">p</span> == pp.left)</span><br><span class="line">            pp.<span class="attr">left</span> = replacement;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            pp.<span class="attr">right</span> = replacement;</span><br><span class="line">        p.<span class="attr">left</span> = p.<span class="attr">right</span> = p.<span class="attr">parent</span> = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //若待删除的节点p时红色的，则树平衡未被破坏，无需进行调整。</span><br><span class="line">    //否则删除节点后需要进行调整</span><br><span class="line">    TreeNode&lt;K,V&gt; <span class="attr">r</span> = p.red ? root : balanceDeletion(root, replacement);</span><br><span class="line"></span><br><span class="line">    //p为叶子节点，则直接将p从树中清除</span><br><span class="line">    <span class="keyword">if</span> (<span class="attr">replacement</span> == p) &#123;  // detach</span><br><span class="line">        TreeNode&lt;K,V&gt; <span class="attr">pp</span> = p.parent;</span><br><span class="line">        p.<span class="attr">parent</span> = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (pp != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="attr">p</span> == pp.left)</span><br><span class="line">                pp.<span class="attr">left</span> = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (<span class="attr">p</span> == pp.right)</span><br><span class="line">                pp.<span class="attr">right</span> = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>麻烦的地方就在删除节点后的调整了，所有逻辑都在balanceDeletion函数里，两个参数分别表示根节点和删除节点的继承者，具体实现如下：</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line">static &lt;K,V&gt; TreeNode&lt;K,V&gt; balanceDeletion(TreeNode&lt;K,V&gt; root, TreeNode&lt;K,V&gt; x) &#123;</span><br><span class="line">    for (TreeNode&lt;K,V&gt; xp, xpl, xpr;;)  &#123;</span><br><span class="line">        //x为空或x为根节点，直接返回</span><br><span class="line">        <span class="keyword">if</span> (<span class="attr">x</span> == <span class="literal">null</span> || <span class="attr">x</span> == root)</span><br><span class="line">            return root; </span><br><span class="line">        //x为根节点，染成黑色，直接返回（因为调整过后，root并不一定指向删除操作过后的根节点，如果之前删除的是root节点，则x将成为新的根节点）</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((<span class="attr">xp</span> = x.parent) == <span class="literal">null</span>) &#123;</span><br><span class="line">            x.<span class="attr">red</span> = <span class="literal">false</span>; </span><br><span class="line">            return x;</span><br><span class="line">        &#125;</span><br><span class="line">        //如果x为红色，则无需调整，返回</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (x.red) &#123;</span><br><span class="line">            x.<span class="attr">red</span> = <span class="literal">false</span>;</span><br><span class="line">            return root; </span><br><span class="line">        &#125;</span><br><span class="line">        //x为其父节点的左孩子</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((<span class="attr">xpl</span> = xp.left) == x) &#123;</span><br><span class="line">            //如果它有红色的兄弟节点xpr，那么它的父亲节点xp一定是黑色节点</span><br><span class="line">            <span class="keyword">if</span> ((<span class="attr">xpr</span> = xp.right) != <span class="literal">null</span> &amp;&amp; xpr.red) &#123; </span><br><span class="line">                xpr.<span class="attr">red</span> = <span class="literal">false</span>;</span><br><span class="line">                xp.<span class="attr">red</span> = <span class="literal">true</span>; </span><br><span class="line">                //对父节点xp做左旋转</span><br><span class="line">                <span class="attr">root</span> = rotateLeft(root, xp); </span><br><span class="line">                //重新将xp指向x的父节点，xpr指向xp新的右孩子</span><br><span class="line">                <span class="attr">xpr</span> = (<span class="attr">xp</span> = x.parent) == <span class="literal">null</span> ? <span class="literal">null</span> : xp.right; </span><br><span class="line">            &#125;</span><br><span class="line">            //如果xpr为空，则向上继续调整，将x的父节点xp作为新的x继续循环</span><br><span class="line">            <span class="keyword">if</span> (<span class="attr">xpr</span> == <span class="literal">null</span>)</span><br><span class="line">                <span class="attr">x</span> = xp; </span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                //sl和sr分别为其近侄子和远侄子</span><br><span class="line">                TreeNode&lt;K,V&gt; <span class="attr">sl</span> = xpr.left, <span class="attr">sr</span> = xpr.right;</span><br><span class="line">　　　　　　　　　　　　</span><br><span class="line">                <span class="keyword">if</span> ((<span class="attr">sr</span> == <span class="literal">null</span> || !sr.red) &amp;&amp;</span><br><span class="line">                    (<span class="attr">sl</span> == <span class="literal">null</span> || !sl.red)) &#123;</span><br><span class="line">                    xpr.<span class="attr">red</span> = <span class="literal">true</span>; //若sl和sr都为黑色或者不存在，即xpr没有红色孩子，则将xpr染红</span><br><span class="line">                    <span class="attr">x</span> = xp; //本轮结束，继续向上循环</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    //否则的话，就需要进一步调整</span><br><span class="line">                    <span class="keyword">if</span> (<span class="attr">sr</span> == <span class="literal">null</span> || !sr.red) &#123; </span><br><span class="line">                        <span class="keyword">if</span> (sl != <span class="literal">null</span>) //若左孩子为红，右孩子不存在或为黑</span><br><span class="line">                            sl.<span class="attr">red</span> = <span class="literal">false</span>; //左孩子染黑</span><br><span class="line">                        xpr.<span class="attr">red</span> = <span class="literal">true</span>; //将xpr染红</span><br><span class="line">                        <span class="attr">root</span> = rotateRight(root, xpr); //右旋</span><br><span class="line">                        <span class="attr">xpr</span> = (<span class="attr">xp</span> = x.parent) == <span class="literal">null</span> ?</span><br><span class="line">                            <span class="literal">null</span> : xp.right;  //右旋后，xpr指向xp的新右孩子，即上一步中的sl</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (xpr != <span class="literal">null</span>) &#123;</span><br><span class="line">                        xpr.<span class="attr">red</span> = (<span class="attr">xp</span> == <span class="literal">null</span>) ? <span class="literal">false</span> : xp.red; //xpr染成跟父节点一致的颜色，为后面父节点xp的左旋做准备</span><br><span class="line">                        <span class="keyword">if</span> ((<span class="attr">sr</span> = xpr.right) != <span class="literal">null</span>)</span><br><span class="line">                            sr.<span class="attr">red</span> = <span class="literal">false</span>; //xpr新的右孩子染黑，防止出现两个红色相连</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (xp != <span class="literal">null</span>) &#123;</span><br><span class="line">                        xp.<span class="attr">red</span> = <span class="literal">false</span>; //将xp染黑，并对其左旋，这样就能保证被删除的X所在的路径又多了一个黑色节点，从而达到恢复平衡的目的</span><br><span class="line">                        <span class="attr">root</span> = rotateLeft(root, xp);</span><br><span class="line">                    &#125;</span><br><span class="line">                    //到此调整已经完毕，进入下一次循环后将直接退出</span><br><span class="line">                    <span class="attr">x</span> = root;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        //x为其父节点的右孩子，跟上面类似</span><br><span class="line">        <span class="keyword">else</span> &#123; // symmetric</span><br><span class="line">            <span class="keyword">if</span> (xpl != <span class="literal">null</span> &amp;&amp; xpl.red) &#123;</span><br><span class="line">                xpl.<span class="attr">red</span> = <span class="literal">false</span>;</span><br><span class="line">                xp.<span class="attr">red</span> = <span class="literal">true</span>;</span><br><span class="line">                <span class="attr">root</span> = rotateRight(root, xp);</span><br><span class="line">                <span class="attr">xpl</span> = (<span class="attr">xp</span> = x.parent) == <span class="literal">null</span> ? <span class="literal">null</span> : xp.left;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="attr">xpl</span> == <span class="literal">null</span>)</span><br><span class="line">                <span class="attr">x</span> = xp;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                TreeNode&lt;K,V&gt; <span class="attr">sl</span> = xpl.left, <span class="attr">sr</span> = xpl.right;</span><br><span class="line">                <span class="keyword">if</span> ((<span class="attr">sl</span> == <span class="literal">null</span> || !sl.red) &amp;&amp;</span><br><span class="line">                    (<span class="attr">sr</span> == <span class="literal">null</span> || !sr.red)) &#123;</span><br><span class="line">                    xpl.<span class="attr">red</span> = <span class="literal">true</span>;</span><br><span class="line">                    <span class="attr">x</span> = xp;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="attr">sl</span> == <span class="literal">null</span> || !sl.red) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (sr != <span class="literal">null</span>)</span><br><span class="line">                            sr.<span class="attr">red</span> = <span class="literal">false</span>;</span><br><span class="line">                        xpl.<span class="attr">red</span> = <span class="literal">true</span>;</span><br><span class="line">                        <span class="attr">root</span> = rotateLeft(root, xpl);</span><br><span class="line">                        <span class="attr">xpl</span> = (<span class="attr">xp</span> = x.parent) == <span class="literal">null</span> ?</span><br><span class="line">                            <span class="literal">null</span> : xp.left;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (xpl != <span class="literal">null</span>) &#123;</span><br><span class="line">                        xpl.<span class="attr">red</span> = (<span class="attr">xp</span> == <span class="literal">null</span>) ? <span class="literal">false</span> : xp.red;</span><br><span class="line">                        <span class="keyword">if</span> ((<span class="attr">sl</span> = xpl.left) != <span class="literal">null</span>)</span><br><span class="line">                            sl.<span class="attr">red</span> = <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (xp != <span class="literal">null</span>) &#123;</span><br><span class="line">                        xp.<span class="attr">red</span> = <span class="literal">false</span>;</span><br><span class="line">                        <span class="attr">root</span> = rotateRight(root, xp);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="attr">x</span> = root;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://r.photo.store.qq.com/psc?/V11rBmNJ3kviLN/hsnfJ.a5yg7.BhItQyNwPS8WgpyOY*TnhQ6ra5OBonOaSJRRjYa.EwaeDcHd5u0Z2wMIczAx0nk6IHzpV2SuW5ZkbqYqWpEyQuGfndQv*mU!/r" alt="image"></p><p><img src="https://r.photo.store.qq.com/psc?/V11rBmNJ3kviLN/hsnfJ.a5yg7.BhItQyNwPZ0TVvbWf.6wlQibDDEU9nwepElsriUycANIyLMCH972q4*18zAQ2JnfajC3UcA3FOOYO1pY.VPGyy9Yhc5qm0U!/r" alt="image"></p><p><img src="https://r.photo.store.qq.com/psc?/V11rBmNJ3kviLN/hsnfJ.a5yg7.BhItQyNwPVrsS.2eQykh7ln*jpalRaYOuC840EjilEUf*3l1I4Uj5vN8oKglrkZSTgN9O7NMea.f2q30d9hZwhBgLkZ2pjc!/r" alt="image"></p><p><img src="https://r.photo.store.qq.com/psc?/V11rBmNJ3kviLN/hsnfJ.a5yg7.BhItQyNwPaZRzqjFpkGRmkeFlPQdsF3YnWtpVuzAnvhHE3LZZLP.CEPsRNlRt0U.WFtozxfBS3bCEjSVmbIFygRtlzEuDYY!/r" alt="image"></p><p><img src="https://r.photo.store.qq.com/psc?/V11rBmNJ3kviLN/hsnfJ.a5yg7.BhItQyNwPXdSPInQ3l8qS*.LcdHVIU3s1Gt6GVBtTa9yvpW2nENYOBAu4lPqx2**2LleuReBcgcvRMJXIU9kfBqvzwfvC1A!/r" alt="image"></p><p><img src="https://r.photo.store.qq.com/psc?/V11rBmNJ3kviLN/hsnfJ.a5yg7.BhItQyNwPek1*OE0FbhH1wkxqG3uJo4a90xtMKMRqDZROfloDawycjwz7yjR*VrmgnpyK1.DoWB9aksaXcF2svMMndLJNUU!/r" alt="image"></p><p><img src="https://r.photo.store.qq.com/psc?/V11rBmNJ3kviLN/hsnfJ.a5yg7.BhItQyNwPfeCIgjNMUSfKD8lKPVMn13P9lKi7RRo3e8RSqlAT5LwIXSns.TckldPKVuWYuAh17R7wiB9FFZTtwfrabXsmY8!/r" alt="image"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;最近两天看到了HashMap比较多，包括一致性Hash等。&lt;br&gt;基本的了解了。&lt;br&gt;就是不太晓得红黑树。  &lt;/p&gt;
&lt;p&gt;要是觉得看文档实在觉得不适的话，可以建议先去b站看个视频：&lt;a href=&quot;https://www.bilibili.com/video/BV1t
      
    
    </summary>
    
    
      <category term="数据结构" scheme="https://fengshana.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    
      <category term="数据结构" scheme="https://fengshana.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="红黑树" scheme="https://fengshana.github.io/tags/%E7%BA%A2%E9%BB%91%E6%A0%91/"/>
    
      <category term="HashMap" scheme="https://fengshana.github.io/tags/HashMap/"/>
    
  </entry>
  
</feed>
